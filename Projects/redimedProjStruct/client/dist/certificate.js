angular.module("app.loggedIn.certificate",["app.loggedIn.certificate.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.certificate",{"abstract":!0,templateUrl:"modules/certificate/views/structure.html",controller:"CertificateController"}).state("loggedIn.certificate.home",{url:"/certificate/home",views:{"main-content":{templateUrl:"modules/certificate/views/home.html",controller:"CertificateHomeController"}}}).state("loggedIn.certificate.referral",{url:"/certificate/referral",views:{"main-content":{templateUrl:"modules/certificate/views/referral.html",controller:"CertificateReferralController"}}}).state("loggedIn.certificate.scripts",{url:"/certificate/scripts",views:{"main-content":{templateUrl:"modules/certificate/views/scripts.html",controller:"CertificateScriptsController"}}})}),angular.module("app.loggedIn.certificate.controller",["app.loggedIn.certificate.home.controller","app.loggedIn.certificate.referral.controller","app.loggedIn.certificate.scripts.controller"]).controller("CertificateController",function($scope,ConfigService){}),angular.module("app.loggedIn.certificate.home.controller",[]).controller("CertificateHomeController",function($scope,ConfigService){}),angular.module("app.loggedIn.certificate.referral.controller",[]).controller("CertificateReferralController",function($scope,$state,$stateParams,$cookieStore,toastr,localStorageService,PatientService,ReceptionistService){$scope.accordion={patientDetails:!0,referral:!0};var Patient=localStorageService.get("patientTempInfo");Patient.CAL_ID=localStorageService.get("apptTempInfo").CAL_ID,$scope.referralObjectMap={patient_id:Patient.Patient_id,appointment_id:Patient.CAL_ID,CT_SCAN:0,X_RAY:0,MRI:0,ULTRASOUND:0,PATHOLOGY:0,CLINICAL_DETAILS:"",ALLERGIES:0,REQUESTING_PRACTITIONER:"",REPORT_URGENT:0,ELECTRONIC:0,FAX:0,MAIL:0,PHONE:0,RETURN_WITH_PATIENT:0,APPOINTMENT_DATE:null,Created_by:$cookieStore.get("userInfo").id,AssessmentName:"",AssessmentId:""},$scope.patient={},$scope.patient_id=0,$scope.appointment_id=0;var flag=!1,loadPage=function(){PatientService.getPatient(Patient.Patient_id).then(function(data){$scope.patient=data.data[0]}),PatientService.getReferral($scope.referralObjectMap).then(function(data){data.length>0&&($scope.referralObjectMap=data[0],flag=!0)}),$scope.isSubmited=!1};loadPage(),$scope.submitReferral=function(){0==flag?PatientService.insertReferral($scope.referralObjectMap).then(function(data){"OK"==data.status?(toastr.success("Referral created successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")}):PatientService.updateReferral($scope.referralObjectMap).then(function(data){"OK"==data.status?(toastr.success("Referral created successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")})}}),angular.module("app.loggedIn.certificate.scripts.controller",[]).controller("CertificateScriptsController",function($scope,$state,$cookieStore,toastr,PatientService,ReceptionistService,localStorageService){$scope.accordion={script:!0};var Patient=localStorageService.get("patientTempInfo");Patient.CAL_ID=localStorageService.get("apptTempInfo").CAL_ID,$scope.scriptObjectMap={patient_id:Patient.Patient_id,appointment_id:Patient.CAL_ID,prescriber:"",scriptNum:0,Medicare:"",isRefNo:0,EntitlementNo:"",isSafety:0,isConcessional:0,isPBS:0,isRPBS:0,isBrand:0,pharmacist:"",doctorSign:null,doctordate:null,patientSign:null,patientDate:"",agentAddress:"",AssessmentName:"",Created_by:$cookieStore.get("userInfo").id,AssessmentId:0},$scope.patient={},$scope.patient_id=0,$scope.appointment_id=0;var flag=!1,loadPage=function(){PatientService.getPatient(Patient.Patient_id).then(function(data){$scope.patient=data.data[0],console.log(data)}),PatientService.getScript($scope.scriptObjectMap).then(function(data){data.length>0&&($scope.scriptObjectMap=data[0],flag=!0)})};loadPage(),$scope.submitScript=function(){console.log($scope.scriptObjectMap),0==flag?PatientService.insertScript($scope.scriptObjectMap).then(function(data){"OK"==data.status?(toastr.success("Script created successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")}):PatientService.updateScript($scope.scriptObjectMap).then(function(data){"OK"==data.status?(toastr.success("Script update successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")})}}),angular.module("app.loggedIn.certificate.directive",["app.loggedIn.certificate.script.directive"]),angular.module("app.loggedIn.certificate.script.directive",[]).directive("scriptModule",function(){return{restrict:"EA",scope:{},templateUrl:"modules/certificate/directives/templates/script.html",link:function(scope,element,attrs){}}});