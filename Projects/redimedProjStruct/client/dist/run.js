function getUrlReport(){return 1==testReport?"http://localhost:3003/RedimedJavaREST/api/document":"http://testapp.redimed.com.au:3003/RedimedJavaREST/api/document"}function MyDatePaginator(selector,momentDate,callBackFunc){var options={selectedDate:momentDate.format("DD-MM-YYYY"),selectedDateFormat:"DD-MM-YYYY",onSelectedDateChanged:function(event,date){callBackFunc(date)}};$(selector).datepaginator(options)}if(function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=e.length,n=Z.type(e);return"function"===n||Z.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function i(e,t,n){if(Z.isFunction(t))return Z.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return Z.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ae.test(t))return Z.filter(t,e,n);t=Z.filter(t,e)}return Z.grep(e,function(e){return V.call(t,e)>=0!==n})}function r(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t=fe[e]={};return Z.each(e.match(pe)||[],function(e,n){t[n]=!0}),t}function s(){Q.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1),Z.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Z.expando+a.uid++}function l(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(we,"-$1").toLowerCase(),n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:ye.test(n)?Z.parseJSON(n):n}catch(r){}be.set(e,t,n)}else n=void 0;return n}function c(){return!0}function u(){return!1}function h(){try{return Q.activeElement}catch(e){}}function d(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Ne.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n=0,i=e.length;i>n;n++)ve.set(e[n],"globalEval",!t||ve.get(t[n],"globalEval"))}function m(e,t){var n,i,r,o,s,a,l,c;if(1===t.nodeType){if(ve.hasData(e)&&(o=ve.access(e),s=ve.set(t,o),c=o.events)){delete s.handle,s.events={};for(r in c)for(n=0,i=c[r].length;i>n;n++)Z.event.add(t,r,c[r][n])}be.hasData(e)&&(a=be.access(e),l=Z.extend({},a),be.set(t,l))}}function v(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],n):n}function b(e,t){var n=t.nodeName.toLowerCase();"input"===n&&$e.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function y(t,n){var i,r=Z(n.createElement(t)).appendTo(n.body),o=e.getDefaultComputedStyle&&(i=e.getDefaultComputedStyle(r[0]))?i.display:Z.css(r[0],"display");return r.detach(),o}function w(e){var t=Q,n=Ue[e];return n||(n=y(e,t),"none"!==n&&n||(je=(je||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=je[0].contentDocument,t.write(),t.close(),n=y(e,t),je.detach()),Ue[e]=n),n}function _(e,t,n){var i,r,o,s,a=e.style;return n=n||Be(e),n&&(s=n.getPropertyValue(t)||n[t]),n&&(""!==s||Z.contains(e.ownerDocument,e)||(s=Z.style(e,t)),We.test(s)&&He.test(t)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function x(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function C(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=t,r=Ke.length;r--;)if(t=Ke[r]+n,t in e)return t;return i}function $(e,t,n){var i=qe.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function k(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,s=0;4>o;o+=2)"margin"===n&&(s+=Z.css(e,n+xe[o],!0,r)),i?("content"===n&&(s-=Z.css(e,"padding"+xe[o],!0,r)),"margin"!==n&&(s-=Z.css(e,"border"+xe[o]+"Width",!0,r))):(s+=Z.css(e,"padding"+xe[o],!0,r),"padding"!==n&&(s+=Z.css(e,"border"+xe[o]+"Width",!0,r)));return s}function S(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Be(e),s="border-box"===Z.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=_(e,t,o),(0>r||null==r)&&(r=e.style[t]),We.test(r))return r;i=s&&(X.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+k(e,t,n||(s?"border":"content"),i,o)+"px"}function T(e,t){for(var n,i,r,o=[],s=0,a=e.length;a>s;s++)i=e[s],i.style&&(o[s]=ve.get(i,"olddisplay"),n=i.style.display,t?(o[s]||"none"!==n||(i.style.display=""),""===i.style.display&&Ce(i)&&(o[s]=ve.access(i,"olddisplay",w(i.nodeName)))):(r=Ce(i),"none"===n&&r||ve.set(i,"olddisplay",r?n:Z.css(i,"display"))));for(s=0;a>s;s++)i=e[s],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[s]||"":"none"));return e}function E(e,t,n,i,r){return new E.prototype.init(e,t,n,i,r)}function D(){return setTimeout(function(){Xe=void 0}),Xe=Z.now()}function A(e,t){var n,i=0,r={height:e};for(t=t?1:0;4>i;i+=2-t)n=xe[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function O(e,t,n){for(var i,r=(nt[t]||[]).concat(nt["*"]),o=0,s=r.length;s>o;o++)if(i=r[o].call(n,t,e))return i}function I(e,t,n){var i,r,o,s,a,l,c,u,h=this,d={},p=e.style,f=e.nodeType&&Ce(e),g=ve.get(e,"fxshow");n.queue||(a=Z._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,Z.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],c=Z.css(e,"display"),u="none"===c?ve.get(e,"olddisplay")||w(e.nodeName):c,"inline"===u&&"none"===Z.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(i in t)if(r=t[i],Je.exec(r)){if(delete t[i],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!g||void 0===g[i])continue;f=!0}d[i]=g&&g[i]||Z.style(e,i)}else c=void 0;if(Z.isEmptyObject(d))"inline"===("none"===c?w(e.nodeName):c)&&(p.display=c);else{g?"hidden"in g&&(f=g.hidden):g=ve.access(e,"fxshow",{}),o&&(g.hidden=!f),f?Z(e).show():h.done(function(){Z(e).hide()}),h.done(function(){var t;ve.remove(e,"fxshow");for(t in d)Z.style(e,t,d[t])});for(i in d)s=O(f?g[i]:0,i,h),i in g||(g[i]=s.start,f&&(s.end=s.start,s.start="width"===i||"height"===i?1:0))}}function M(e,t){var n,i,r,o,s;for(n in e)if(i=Z.camelCase(n),r=t[i],o=e[n],Z.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),s=Z.cssHooks[i],s&&"expand"in s){o=s.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=r)}else t[i]=r}function P(e,t,n){var i,r,o=0,s=tt.length,a=Z.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=Xe||D(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,o=1-i,s=0,l=c.tweens.length;l>s;s++)c.tweens[s].run(o);return a.notifyWith(e,[c,o,n]),1>o&&l?n:(a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:Z.extend({},t),opts:Z.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xe||D(),duration:n.duration,tweens:[],createTween:function(t,n){var i=Z.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)c.tweens[n].run(1);return t?a.resolveWith(e,[c,t]):a.rejectWith(e,[c,t]),this}}),u=c.props;for(M(u,c.opts.specialEasing);s>o;o++)if(i=tt[o].call(c,e,u,c.opts))return i;return Z.map(u,O,c),Z.isFunction(c.opts.start)&&c.opts.start.call(e,c),Z.fx.timer(Z.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function R(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(pe)||[];if(Z.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function N(e,t,n,i){function r(a){var l;return o[a]=!0,Z.each(e[a]||[],function(e,a){var c=a(t,n,i);return"string"!=typeof c||s||o[c]?s?!(l=c):void 0:(t.dataTypes.unshift(c),r(c),!1)}),l}var o={},s=e===yt;return r(t.dataTypes[0])||!o["*"]&&r("*")}function F(e,t){var n,i,r=Z.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&Z.extend(!0,e,i),e}function L(e,t,n){for(var i,r,o,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}function j(e,t,n,i){var r,o,s,a,l,c={},u=e.dataTypes.slice();if(u[1])for(s in e.converters)c[s.toLowerCase()]=e.converters[s];for(o=u.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(s=c[l+" "+o]||c["* "+o],!s)for(r in c)if(a=r.split(" "),a[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]])){s===!0?s=c[r]:c[r]!==!0&&(o=a[0],u.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(h){return{state:"parsererror",error:s?h:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function U(e,t,n,i){var r;if(Z.isArray(t))Z.each(t,function(t,r){n||$t.test(e)?i(e,r):U(e+"["+("object"==typeof r?t:"")+"]",r,n,i)});else if(n||"object"!==Z.type(t))i(e,t);else for(r in t)U(e+"["+r+"]",t[r],n,i)}function H(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var W=[],B=W.slice,z=W.concat,q=W.push,V=W.indexOf,Y={},G=Y.toString,K=Y.hasOwnProperty,X={},Q=e.document,J="2.1.3",Z=function(e,t){return new Z.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ne=/-([\da-z])/gi,ie=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:J,constructor:Z,selector:"",length:0,toArray:function(){return B.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:B.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Z.each(this,e,t)},map:function(e){return this.pushStack(Z.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(B.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:q,sort:W.sort,splice:W.splice},Z.extend=Z.fn.extend=function(){var e,t,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||Z.isFunction(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],i=e[t],s!==i&&(c&&i&&(Z.isPlainObject(i)||(r=Z.isArray(i)))?(r?(r=!1,o=n&&Z.isArray(n)?n:[]):o=n&&Z.isPlainObject(n)?n:{},s[t]=Z.extend(c,o,i)):void 0!==i&&(s[t]=i));return s},Z.extend({expando:"jQuery"+(J+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Z.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Z.type(e)||e.nodeType||Z.isWindow(e)?!1:e.constructor&&!K.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Y[G.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;e=Z.trim(e),e&&(1===e.indexOf("use strict")?(t=Q.createElement("script"),t.text=e,Q.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ne,ie)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var r,o=0,s=e.length,a=n(e);if(i){if(a)for(;s>o&&(r=t.apply(e[o],i),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],i),r===!1)break}else if(a)for(;s>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?Z.merge(i,"string"==typeof e?[e]:e):q.call(i,e)),i},inArray:function(e,t,n){return null==t?-1:V.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;n>i;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i,r=[],o=0,s=e.length,a=!n;s>o;o++)i=!t(e[o],o),i!==a&&r.push(e[o]);return r},map:function(e,t,i){var r,o=0,s=e.length,a=n(e),l=[];if(a)for(;s>o;o++)r=t(e[o],o,i),null!=r&&l.push(r);else for(o in e)r=t(e[o],o,i),null!=r&&l.push(r);return z.apply([],l)},guid:1,proxy:function(e,t){var n,i,r;return"string"==typeof t&&(n=e[t],t=e,e=n),Z.isFunction(e)?(i=B.call(arguments,2),r=function(){return e.apply(t||this,i.concat(B.call(arguments)))},r.guid=e.guid=e.guid||Z.guid++,r):void 0},now:Date.now,support:X}),Z.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Y["[object "+t+"]"]=t.toLowerCase()});var re=function(e){function t(e,t,n,i){var r,o,s,a,l,c,h,p,f,g;if((t?t.ownerDocument||t:U)!==I&&O(t),t=t||I,n=n||[],a=t.nodeType,"string"!=typeof e||!e||1!==a&&9!==a&&11!==a)return n;if(!i&&P){if(11!==a&&(r=be.exec(e)))if(s=r[1]){if(9===a){if(o=t.getElementById(s),!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&L(t,o)&&o.id===s)return n.push(o),n}else{if(r[2])return J.apply(n,t.getElementsByTagName(e)),n;if((s=r[3])&&_.getElementsByClassName)return J.apply(n,t.getElementsByClassName(s)),n}if(_.qsa&&(!R||!R.test(e))){if(p=h=j,f=t,g=1!==a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(c=k(e),(h=t.getAttribute("id"))?p=h.replace(we,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+d(c[l]);f=ye.test(e)&&u(t.parentNode)||t,g=c.join(",")}if(g)try{return J.apply(n,f.querySelectorAll(g)),n}catch(m){}finally{h||t.removeAttribute("id")}}}return T(e.replace(le,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>x.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[j]=!0,e}function r(e){var t=I.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),i=e.length;i--;)x.attrHandle[n[i]]=t}function s(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return i(function(t){return t=+t,i(function(n,i){for(var r,o=e([],n.length,t),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function u(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function h(){}function d(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function p(e,t,n){var i=t.dir,r=n&&"parentNode"===i,o=W++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,o)}:function(t,n,s){var a,l,c=[H,o];if(s){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,s))return!0}else for(;t=t[i];)if(1===t.nodeType||r){if(l=t[j]||(t[j]={}),(a=l[i])&&a[0]===H&&a[1]===o)return c[2]=a[2];if(l[i]=c,c[2]=e(t,n,s))return!0}}}function f(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function g(e,n,i){for(var r=0,o=n.length;o>r;r++)t(e,n[r],i);return i}function m(e,t,n,i,r){for(var o,s=[],a=0,l=e.length,c=null!=t;l>a;a++)(o=e[a])&&(!n||n(o,i,r))&&(s.push(o),c&&t.push(a));return s}function v(e,t,n,r,o,s){return r&&!r[j]&&(r=v(r)),o&&!o[j]&&(o=v(o,s)),i(function(i,s,a,l){var c,u,h,d=[],p=[],f=s.length,v=i||g(t||"*",a.nodeType?[a]:a,[]),b=!e||!i&&t?v:m(v,d,e,a,l),y=n?o||(i?e:f||r)?[]:s:b;if(n&&n(b,y,a,l),r)for(c=m(y,p),r(c,[],a,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(b[p[u]]=h));if(i){if(o||e){if(o){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(b[u]=h);o(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=o?ee(i,h):d[u])>-1&&(i[c]=!(s[c]=h))}}else y=m(y===s?y.splice(f,y.length):y),o?o(null,s,y,l):J.apply(s,y)})}function b(e){for(var t,n,i,r=e.length,o=x.relative[e[0].type],s=o||x.relative[" "],a=o?1:0,l=p(function(e){return e===t},s,!0),c=p(function(e){return ee(t,e)>-1},s,!0),u=[function(e,n,i){var r=!o&&(i||n!==E)||((t=n).nodeType?l(e,n,i):c(e,n,i));return t=null,r}];r>a;a++)if(n=x.relative[e[a].type])u=[p(f(u),n)];else{if(n=x.filter[e[a].type].apply(null,e[a].matches),n[j]){for(i=++a;r>i&&!x.relative[e[i].type];i++);return v(a>1&&f(u),a>1&&d(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(le,"$1"),n,i>a&&b(e.slice(a,i)),r>i&&b(e=e.slice(i)),r>i&&d(e))}u.push(n)}return f(u)}function y(e,n){var r=n.length>0,o=e.length>0,s=function(i,s,a,l,c){var u,h,d,p=0,f="0",g=i&&[],v=[],b=E,y=i||o&&x.find.TAG("*",c),w=H+=null==b?1:Math.random()||.1,_=y.length;for(c&&(E=s!==I&&s);f!==_&&null!=(u=y[f]);f++){if(o&&u){for(h=0;d=e[h++];)if(d(u,s,a)){l.push(u);break}c&&(H=w)}r&&((u=!d&&u)&&p--,i&&g.push(u))}if(p+=f,r&&f!==p){for(h=0;d=n[h++];)d(g,v,s,a);if(i){if(p>0)for(;f--;)g[f]||v[f]||(v[f]=X.call(l));v=m(v)}J.apply(l,v),c&&!i&&v.length>0&&p+n.length>1&&t.uniqueSort(l)}return c&&(H=w,E=b),g};return r?i(s):s}var w,_,x,C,$,k,S,T,E,D,A,O,I,M,P,R,N,F,L,j="sizzle"+1*new Date,U=e.document,H=0,W=0,B=n(),z=n(),q=n(),V=function(e,t){return e===t&&(A=!0),0},Y=1<<31,G={}.hasOwnProperty,K=[],X=K.pop,Q=K.push,J=K.push,Z=K.slice,ee=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=ie.replace("w","w#"),oe="\\["+ne+"*("+ie+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ne+"*\\]",se=":("+ie+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",ae=new RegExp(ne+"+","g"),le=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ce=new RegExp("^"+ne+"*,"+ne+"*"),ue=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),he=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),de=new RegExp(se),pe=new RegExp("^"+re+"$"),fe={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+se),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,be=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,we=/'|\\/g,_e=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),xe=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},Ce=function(){O()};try{J.apply(K=Z.call(U.childNodes),U.childNodes),K[U.childNodes.length].nodeType}catch($e){J={apply:K.length?function(e,t){Q.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}_=t.support={},$=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},O=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:U;return i!==I&&9===i.nodeType&&i.documentElement?(I=i,M=i.documentElement,n=i.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",Ce,!1):n.attachEvent&&n.attachEvent("onunload",Ce)),P=!$(i),_.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=r(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=ve.test(i.getElementsByClassName),_.getById=r(function(e){return M.appendChild(e).id=j,!i.getElementsByName||!i.getElementsByName(j).length}),_.getById?(x.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&P){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},x.filter.ID=function(e){var t=e.replace(_e,xe);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(_e,xe);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),x.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},x.find.CLASS=_.getElementsByClassName&&function(e,t){return P?t.getElementsByClassName(e):void 0},N=[],R=[],(_.qsa=ve.test(i.querySelectorAll))&&(r(function(e){M.appendChild(e).innerHTML="<a id='"+j+"'></a><select id='"+j+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&R.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||R.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+j+"-]").length||R.push("~="),e.querySelectorAll(":checked").length||R.push(":checked"),e.querySelectorAll("a#"+j+"+*").length||R.push(".#.+[+~]")}),r(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&R.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||R.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),R.push(",.*:")})),(_.matchesSelector=ve.test(F=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&r(function(e){_.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),N.push("!=",se)}),R=R.length&&new RegExp(R.join("|")),N=N.length&&new RegExp(N.join("|")),t=ve.test(M.compareDocumentPosition),L=t||ve.test(M.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return A=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!_.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===U&&L(U,e)?-1:t===i||t.ownerDocument===U&&L(U,t)?1:D?ee(D,e)-ee(D,t):0:4&n?-1:1)}:function(e,t){if(e===t)return A=!0,0;var n,r=0,o=e.parentNode,a=t.parentNode,l=[e],c=[t];if(!o||!a)return e===i?-1:t===i?1:o?-1:a?1:D?ee(D,e)-ee(D,t):0;if(o===a)return s(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;l[r]===c[r];)r++;return r?s(l[r],c[r]):l[r]===U?-1:c[r]===U?1:0},i):I},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==I&&O(e),n=n.replace(he,"='$1']"),!(!_.matchesSelector||!P||N&&N.test(n)||R&&R.test(n)))try{var i=F.call(e,n);if(i||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(r){}return t(n,I,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==I&&O(e),L(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==I&&O(e);var n=x.attrHandle[t.toLowerCase()],i=n&&G.call(x.attrHandle,t.toLowerCase())?n(e,t,!P):void 0;return void 0!==i?i:_.attributes||!P?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,r=0;if(A=!_.detectDuplicates,D=!_.sortStable&&e.slice(0),e.sort(V),A){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return D=null,e},C=t.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=C(t);return n},x=t.selectors={cacheLength:50,createPseudo:i,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_e,xe),e[3]=(e[3]||e[4]||e[5]||"").replace(_e,xe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&de.test(n)&&(t=k(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_e,xe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=B[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&B(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(r){var o=t.attr(r,e);return null==o?"!="===n:n?(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(ae," ")+" ").indexOf(i)>-1:"|="===n?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var c,u,h,d,p,f,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),b=!l&&!a;if(m){if(o){for(;g;){for(h=t;h=h[g];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&b){for(u=m[j]||(m[j]={}),c=u[e]||[],p=c[0]===H&&c[1],d=c[0]===H&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===t){u[e]=[H,p,d];break}}else if(b&&(c=(t[j]||(t[j]={}))[e])&&c[0]===H)d=c[1];else for(;(h=++p&&h&&h[g]||(d=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(b&&((h[j]||(h[j]={}))[e]=[H,d]),h!==t)););return d-=r,d===i||d%i===0&&d/i>=0}}},PSEUDO:function(e,n){var r,o=x.pseudos[e]||x.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[j]?o(n):o.length>1?(r=[e,e,"",n],x.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,r=o(e,n),s=r.length;s--;)i=ee(e,r[s]),e[i]=!(t[i]=r[s])}):function(e){return o(e,0,r)}):o}},pseudos:{not:i(function(e){var t=[],n=[],r=S(e.replace(le,"$1"));return r[j]?i(function(e,t,n,i){for(var o,s=r(e,null,i,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(_e,xe),function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:i(function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_e,xe).toLowerCase(),function(t){var n;do if(n=P?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===I.activeElement&&(!I.hasFocus||I.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return ge.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[0>n?n+t:n]}),even:c(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:c(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},x.pseudos.nth=x.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[w]=a(w);for(w in{submit:!0,reset:!0})x.pseudos[w]=l(w);return h.prototype=x.filters=x.pseudos,x.setFilters=new h,k=t.tokenize=function(e,n){var i,r,o,s,a,l,c,u=z[e+" "];if(u)return n?0:u.slice(0);for(a=e,l=[],c=x.preFilter;a;){(!i||(r=ce.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),i=!1,(r=ue.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(le," ")}),a=a.slice(i.length));for(s in x.filter)!(r=fe[s].exec(a))||c[s]&&!(r=c[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return n?a.length:a?t.error(e):z(e,l).slice(0)},S=t.compile=function(e,t){var n,i=[],r=[],o=q[e+" "];if(!o){for(t||(t=k(e)),n=t.length;n--;)o=b(t[n]),o[j]?i.push(o):r.push(o);o=q(e,y(r,i)),o.selector=e}return o},T=t.select=function(e,t,n,i){var r,o,s,a,l,c="function"==typeof e&&e,h=!i&&k(e=c.selector||e);if(n=n||[],1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&_.getById&&9===t.nodeType&&P&&x.relative[o[1].type]){if(t=(x.find.ID(s.matches[0].replace(_e,xe),t)||[])[0],!t)return n;c&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=fe.needsContext.test(e)?0:o.length;r--&&(s=o[r],!x.relative[a=s.type]);)if((l=x.find[a])&&(i=l(s.matches[0].replace(_e,xe),ye.test(o[0].type)&&u(t.parentNode)||t))){if(o.splice(r,1),e=i.length&&d(o),!e)return J.apply(n,i),n;break}}return(c||S(e,h))(i,t,!P,n,ye.test(e)&&u(t.parentNode)||t),n},_.sortStable=j.split("").sort(V).join("")===j,_.detectDuplicates=!!A,O(),_.sortDetached=r(function(e){return 1&e.compareDocumentPosition(I.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);Z.find=re,Z.expr=re.selectors,Z.expr[":"]=Z.expr.pseudos,Z.unique=re.uniqueSort,
Z.text=re.getText,Z.isXMLDoc=re.isXML,Z.contains=re.contains;var oe=Z.expr.match.needsContext,se=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ae=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?Z.find.matchesSelector(i,e)?[i]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,n=this.length,i=[],r=this;if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;n>t;t++)if(Z.contains(r[t],this))return!0}));for(t=0;n>t;t++)Z.find(e,r[t],i);return i=this.pushStack(n>1?Z.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&oe.test(e)?Z(e):e||[],!1).length}});var le,ce=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ue=Z.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ce.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||le).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:Q,!0)),se.test(n[1])&&Z.isPlainObject(t))for(n in t)Z.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return i=Q.getElementById(n[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=Q,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?"undefined"!=typeof le.ready?le.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this))};ue.prototype=Z.fn,le=Z(Q);var he=/^(?:parents|prev(?:Until|All))/,de={children:!0,contents:!0,next:!0,prev:!0};Z.extend({dir:function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&Z(e).is(n))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),Z.fn.extend({has:function(e){var t=Z(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,i=0,r=this.length,o=[],s=oe.test(e)||"string"!=typeof e?Z(e,t||this.context):0;r>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&Z.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?Z.unique(o):o)},index:function(e){return e?"string"==typeof e?V.call(Z(e),this[0]):V.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.unique(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Z.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Z.dir(e,"parentNode",n)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return Z.dir(e,"nextSibling")},prevAll:function(e){return Z.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Z.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Z.dir(e,"previousSibling",n)},siblings:function(e){return Z.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Z.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(e,t){Z.fn[e]=function(n,i){var r=Z.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=Z.filter(i,r)),this.length>1&&(de[e]||Z.unique(r),he.test(e)&&r.reverse()),this.pushStack(r)}});var pe=/\S+/g,fe={};Z.Callbacks=function(e){e="string"==typeof e?fe[e]||o(e):Z.extend({},e);var t,n,i,r,s,a,l=[],c=!e.once&&[],u=function(o){for(t=e.memory&&o,n=!0,a=r||0,r=0,s=l.length,i=!0;l&&s>a;a++)if(l[a].apply(o[0],o[1])===!1&&e.stopOnFalse){t=!1;break}i=!1,l&&(c?c.length&&u(c.shift()):t?l=[]:h.disable())},h={add:function(){if(l){var n=l.length;!function o(t){Z.each(t,function(t,n){var i=Z.type(n);"function"===i?e.unique&&h.has(n)||l.push(n):n&&n.length&&"string"!==i&&o(n)})}(arguments),i?s=l.length:t&&(r=n,u(t))}return this},remove:function(){return l&&Z.each(arguments,function(e,t){for(var n;(n=Z.inArray(t,l,n))>-1;)l.splice(n,1),i&&(s>=n&&s--,a>=n&&a--)}),this},has:function(e){return e?Z.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=c=t=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,t||h.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||n&&!c||(t=t||[],t=[e,t.slice?t.slice():t],i?c.push(t):u(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},Z.extend({Deferred:function(e){var t=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Z.Deferred(function(n){Z.each(t,function(t,o){var s=Z.isFunction(e[t])&&e[t];r[o[1]](function(){var e=s&&s.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===i?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Z.extend(e,i):i}},r={};return i.pipe=i.then,Z.each(t,function(e,o){var s=o[2],a=o[3];i[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=s.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,i,r=0,o=B.call(arguments),s=o.length,a=1!==s||e&&Z.isFunction(e.promise)?s:0,l=1===a?e:Z.Deferred(),c=function(e,n,i){return function(r){n[e]=this,i[e]=arguments.length>1?B.call(arguments):r,i===t?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(s>1)for(t=new Array(s),n=new Array(s),i=new Array(s);s>r;r++)o[r]&&Z.isFunction(o[r].promise)?o[r].promise().done(c(r,i,o)).fail(l.reject).progress(c(r,n,t)):--a;return a||l.resolveWith(i,o),l.promise()}});var ge;Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(e===!0?--Z.readyWait:Z.isReady)||(Z.isReady=!0,e!==!0&&--Z.readyWait>0||(ge.resolveWith(Q,[Z]),Z.fn.triggerHandler&&(Z(Q).triggerHandler("ready"),Z(Q).off("ready"))))}}),Z.ready.promise=function(t){return ge||(ge=Z.Deferred(),"complete"===Q.readyState?setTimeout(Z.ready):(Q.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1))),ge.promise(t)},Z.ready.promise();var me=Z.access=function(e,t,n,i,r,o,s){var a=0,l=e.length,c=null==n;if("object"===Z.type(n)){r=!0;for(a in n)Z.access(e,t,a,n[a],!0,o,s)}else if(void 0!==i&&(r=!0,Z.isFunction(i)||(s=!0),c&&(s?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(Z(e),n)})),t))for(;l>a;a++)t(e[a],n,s?i:i.call(e[a],a,t(e[a],n)));return r?e:c?t.call(e):l?t(e[0],n):o};Z.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},a.uid=1,a.accepts=Z.acceptData,a.prototype={key:function(e){if(!a.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=a.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,Z.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=n;else if(Z.isEmptyObject(o))Z.extend(this.cache[r],t);else for(i in t)o[i]=t[i];return o},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?(i=this.get(e,t),void 0!==i?i:this.get(e,Z.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,r,o=this.key(e),s=this.cache[o];if(void 0===t)this.cache[o]={};else{Z.isArray(t)?i=t.concat(t.map(Z.camelCase)):(r=Z.camelCase(t),t in s?i=[t,r]:(i=r,i=i in s?[i]:i.match(pe)||[])),n=i.length;for(;n--;)delete s[i[n]]}},hasData:function(e){return!Z.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var ve=new a,be=new a,ye=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,we=/([A-Z])/g;Z.extend({hasData:function(e){return be.hasData(e)||ve.hasData(e)},data:function(e,t,n){return be.access(e,t,n)},removeData:function(e,t){be.remove(e,t)},_data:function(e,t,n){return ve.access(e,t,n)},_removeData:function(e,t){ve.remove(e,t)}}),Z.fn.extend({data:function(e,t){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=be.get(o),1===o.nodeType&&!ve.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(i=s[n].name,0===i.indexOf("data-")&&(i=Z.camelCase(i.slice(5)),l(o,i,r[i])));ve.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){be.set(this,e)}):me(this,function(t){var n,i=Z.camelCase(e);if(o&&void 0===t){if(n=be.get(o,e),void 0!==n)return n;if(n=be.get(o,i),void 0!==n)return n;if(n=l(o,i,void 0),void 0!==n)return n}else this.each(function(){var n=be.get(this,i);be.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&be.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){be.remove(this,e)})}}),Z.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=ve.get(e,t),n&&(!i||Z.isArray(n)?i=ve.access(e,t,Z.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=Z.queue(e,t),i=n.length,r=n.shift(),o=Z._queueHooks(e,t),s=function(){Z.dequeue(e,t)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ve.get(e,n)||ve.access(e,n,{empty:Z.Callbacks("once memory").add(function(){ve.remove(e,[t+"queue",n])})})}}),Z.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?Z.queue(this[0],e):void 0===t?this:this.each(function(){var n=Z.queue(this,e,t);Z._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&Z.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=Z.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)n=ve.get(o[s],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(t)}});var _e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xe=["Top","Right","Bottom","Left"],Ce=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},$e=/^(?:checkbox|radio)$/i;!function(){var e=Q.createDocumentFragment(),t=e.appendChild(Q.createElement("div")),n=Q.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),X.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",X.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var ke="undefined";X.focusinBubbles="onfocusin"in e;var Se=/^key/,Te=/^(?:mouse|pointer|contextmenu)|click/,Ee=/^(?:focusinfocus|focusoutblur)$/,De=/^([^.]*)(?:\.(.+)|)$/;Z.event={global:{},add:function(e,t,n,i,r){var o,s,a,l,c,u,h,d,p,f,g,m=ve.get(e);if(m)for(n.handler&&(o=n,n=o.handler,r=o.selector),n.guid||(n.guid=Z.guid++),(l=m.events)||(l=m.events={}),(s=m.handle)||(s=m.handle=function(t){return typeof Z!==ke&&Z.event.triggered!==t.type?Z.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(pe)||[""],c=t.length;c--;)a=De.exec(t[c])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p&&(h=Z.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=Z.event.special[p]||{},u=Z.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&Z.expr.match.needsContext.test(r),namespace:f.join(".")},o),(d=l[p])||(d=l[p]=[],d.delegateCount=0,h.setup&&h.setup.call(e,i,f,s)!==!1||e.addEventListener&&e.addEventListener(p,s,!1)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,u):d.push(u),Z.event.global[p]=!0)},remove:function(e,t,n,i,r){var o,s,a,l,c,u,h,d,p,f,g,m=ve.hasData(e)&&ve.get(e);if(m&&(l=m.events)){for(t=(t||"").match(pe)||[""],c=t.length;c--;)if(a=De.exec(t[c])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=Z.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,d=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)u=d[o],!r&&g!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(d.splice(o,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(e,u));s&&!d.length&&(h.teardown&&h.teardown.call(e,f,m.handle)!==!1||Z.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)Z.event.remove(e,p+t[c],n,i,!0);Z.isEmptyObject(l)&&(delete m.handle,ve.remove(e,"events"))}},trigger:function(t,n,i,r){var o,s,a,l,c,u,h,d=[i||Q],p=K.call(t,"type")?t.type:t,f=K.call(t,"namespace")?t.namespace.split("."):[];if(s=a=i=i||Q,3!==i.nodeType&&8!==i.nodeType&&!Ee.test(p+Z.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),c=p.indexOf(":")<0&&"on"+p,t=t[Z.expando]?t:new Z.Event(p,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:Z.makeArray(n,[t]),h=Z.event.special[p]||{},r||!h.trigger||h.trigger.apply(i,n)!==!1)){if(!r&&!h.noBubble&&!Z.isWindow(i)){for(l=h.delegateType||p,Ee.test(l+p)||(s=s.parentNode);s;s=s.parentNode)d.push(s),a=s;a===(i.ownerDocument||Q)&&d.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=d[o++])&&!t.isPropagationStopped();)t.type=o>1?l:h.bindType||p,u=(ve.get(s,"events")||{})[t.type]&&ve.get(s,"handle"),u&&u.apply(s,n),u=c&&s[c],u&&u.apply&&Z.acceptData(s)&&(t.result=u.apply(s,n),t.result===!1&&t.preventDefault());return t.type=p,r||t.isDefaultPrevented()||h._default&&h._default.apply(d.pop(),n)!==!1||!Z.acceptData(i)||c&&Z.isFunction(i[p])&&!Z.isWindow(i)&&(a=i[c],a&&(i[c]=null),Z.event.triggered=p,i[p](),Z.event.triggered=void 0,a&&(i[c]=a)),t.result}},dispatch:function(e){e=Z.event.fix(e);var t,n,i,r,o,s=[],a=B.call(arguments),l=(ve.get(this,"events")||{})[e.type]||[],c=Z.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(s=Z.event.handlers.call(this,e,l),t=0;(r=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,i=((Z.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,s=[],a=t.delegateCount,l=e.target;if(a&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(i=[],n=0;a>n;n++)o=t[n],r=o.selector+" ",void 0===i[r]&&(i[r]=o.needsContext?Z(r,this).index(l)>=0:Z.find(r,this,null,[l]).length),i[r]&&i.push(o);i.length&&s.push({elem:l,handlers:i})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,o=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||Q,i=n.documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,n,i,r=e.type,o=e,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=Te.test(r)?this.mouseHooks:Se.test(r)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,e=new Z.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return e.target||(e.target=Q),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==h()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Z.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var r=Z.extend(new Z.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?Z.event.trigger(r,null,t):Z.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},Z.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},Z.Event=function(e,t){return this instanceof Z.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?c:u):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(e,t)},Z.Event.prototype={isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=c,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=c,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=c,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Z.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==i&&!Z.contains(i,r))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),X.focusinBubbles||Z.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){Z.event.simulate(t,e.target,Z.event.fix(e),!0)};Z.event.special[t]={setup:function(){var i=this.ownerDocument||this,r=ve.access(i,t);r||i.addEventListener(e,n,!0),ve.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=ve.access(i,t)-1;r?ve.access(i,t,r):(i.removeEventListener(e,n,!0),ve.remove(i,t))}}}),Z.fn.extend({on:function(e,t,n,i,r){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(s in e)this.on(s,t,n,e[s],r);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),i===!1)i=u;else if(!i)return this;return 1===r&&(o=i,i=function(e){return Z().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=Z.guid++)),this.each(function(){Z.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,Z(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=u),this.each(function(){Z.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?Z.event.trigger(e,t,n,!0):void 0}});var Ae=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Oe=/<([\w:]+)/,Ie=/<|&#?\w+;/,Me=/<(?:script|style|link)/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Re=/^$|\/(?:java|ecma)script/i,Ne=/^true\/(.*)/,Fe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Le={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Le.optgroup=Le.option,Le.tbody=Le.tfoot=Le.colgroup=Le.caption=Le.thead,Le.th=Le.td,Z.extend({clone:function(e,t,n){var i,r,o,s,a=e.cloneNode(!0),l=Z.contains(e.ownerDocument,e);if(!(X.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(s=v(a),o=v(e),i=0,r=o.length;r>i;i++)b(o[i],s[i]);if(t)if(n)for(o=o||v(e),s=s||v(a),i=0,r=o.length;r>i;i++)m(o[i],s[i]);else m(e,a);return s=v(a,"script"),s.length>0&&g(s,!l&&v(e,"script")),a},buildFragment:function(e,t,n,i){for(var r,o,s,a,l,c,u=t.createDocumentFragment(),h=[],d=0,p=e.length;p>d;d++)if(r=e[d],r||0===r)if("object"===Z.type(r))Z.merge(h,r.nodeType?[r]:r);else if(Ie.test(r)){for(o=o||u.appendChild(t.createElement("div")),s=(Oe.exec(r)||["",""])[1].toLowerCase(),a=Le[s]||Le._default,o.innerHTML=a[1]+r.replace(Ae,"<$1></$2>")+a[2],c=a[0];c--;)o=o.lastChild;Z.merge(h,o.childNodes),o=u.firstChild,o.textContent=""}else h.push(t.createTextNode(r));for(u.textContent="",d=0;r=h[d++];)if((!i||-1===Z.inArray(r,i))&&(l=Z.contains(r.ownerDocument,r),o=v(u.appendChild(r),"script"),l&&g(o),n))for(c=0;r=o[c++];)Re.test(r.type||"")&&n.push(r);return u},cleanData:function(e){for(var t,n,i,r,o=Z.event.special,s=0;void 0!==(n=e[s]);s++){if(Z.acceptData(n)&&(r=n[ve.expando],r&&(t=ve.cache[r]))){if(t.events)for(i in t.events)o[i]?Z.event.remove(n,i):Z.removeEvent(n,i,t.handle);ve.cache[r]&&delete ve.cache[r]}delete be.cache[n[be.expando]]}}}),Z.fn.extend({text:function(e){return me(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?Z.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||Z.cleanData(v(n)),n.parentNode&&(t&&Z.contains(n.ownerDocument,n)&&g(v(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return me(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Me.test(e)&&!Le[(Oe.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ae,"<$1></$2>");try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(Z.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(r){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Z.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=z.apply([],e);var n,i,r,o,s,a,l=0,c=this.length,u=this,h=c-1,d=e[0],g=Z.isFunction(d);if(g||c>1&&"string"==typeof d&&!X.checkClone&&Pe.test(d))return this.each(function(n){var i=u.eq(n);g&&(e[0]=d.call(this,n,i.html())),i.domManip(e,t)});if(c&&(n=Z.buildFragment(e,this[0].ownerDocument,!1,this),i=n.firstChild,1===n.childNodes.length&&(n=i),i)){for(r=Z.map(v(n,"script"),p),o=r.length;c>l;l++)s=n,l!==h&&(s=Z.clone(s,!0,!0),o&&Z.merge(r,v(s,"script"))),t.call(this[l],s,l);if(o)for(a=r[r.length-1].ownerDocument,Z.map(r,f),l=0;o>l;l++)s=r[l],Re.test(s.type||"")&&!ve.access(s,"globalEval")&&Z.contains(a,s)&&(s.src?Z._evalUrl&&Z._evalUrl(s.src):Z.globalEval(s.textContent.replace(Fe,"")))}return this}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Z.fn[e]=function(e){for(var n,i=[],r=Z(e),o=r.length-1,s=0;o>=s;s++)n=s===o?this:this.clone(!0),Z(r[s])[t](n),q.apply(i,n.get());return this.pushStack(i)}});var je,Ue={},He=/^margin/,We=new RegExp("^("+_e+")(?!px)[a-z%]+$","i"),Be=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",r.appendChild(o);var t=e.getComputedStyle(s,null);n="1%"!==t.top,i="4px"===t.width,r.removeChild(o)}var n,i,r=Q.documentElement,o=Q.createElement("div"),s=Q.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",X.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(s),e.getComputedStyle&&Z.extend(X,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==i&&t(),i},reliableMarginRight:function(){var t,n=s.appendChild(Q.createElement("div"));return n.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",s.style.width="1px",r.appendChild(o),t=!parseFloat(e.getComputedStyle(n,null).marginRight),r.removeChild(o),s.removeChild(n),t}}))}(),Z.swap=function(e,t,n,i){var r,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];r=n.apply(e,i||[]);for(o in t)e.style[o]=s[o];return r};var ze=/^(none|table(?!-c[ea]).+)/,qe=new RegExp("^("+_e+")(.*)$","i"),Ve=new RegExp("^([+-])=("+_e+")","i"),Ye={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"},Ke=["Webkit","O","Moz","ms"];Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=_(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s,a=Z.camelCase(t),l=e.style;return t=Z.cssProps[a]||(Z.cssProps[a]=C(l,a)),s=Z.cssHooks[t]||Z.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(r=s.get(e,!1,i))?r:l[t]:(o=typeof n,"string"===o&&(r=Ve.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(Z.css(e,t)),o="number"),void(null!=n&&n===n&&("number"!==o||Z.cssNumber[a]||(n+="px"),X.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,i))||(l[t]=n))))}},css:function(e,t,n,i){var r,o,s,a=Z.camelCase(t);return t=Z.cssProps[a]||(Z.cssProps[a]=C(e.style,a)),s=Z.cssHooks[t]||Z.cssHooks[a],s&&"get"in s&&(r=s.get(e,!0,n)),void 0===r&&(r=_(e,t,i)),"normal"===r&&t in Ge&&(r=Ge[t]),""===n||n?(o=parseFloat(r),n===!0||Z.isNumeric(o)?o||0:r):r}}),Z.each(["height","width"],function(e,t){Z.cssHooks[t]={get:function(e,n,i){return n?ze.test(Z.css(e,"display"))&&0===e.offsetWidth?Z.swap(e,Ye,function(){return S(e,t,i)}):S(e,t,i):void 0},set:function(e,n,i){var r=i&&Be(e);return $(e,n,i?k(e,t,i,"border-box"===Z.css(e,"boxSizing",!1,r),r):0)}}}),Z.cssHooks.marginRight=x(X.reliableMarginRight,function(e,t){return t?Z.swap(e,{display:"inline-block"},_,[e,"marginRight"]):void 0}),Z.each({margin:"",padding:"",border:"Width"},function(e,t){Z.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[e+xe[i]+t]=o[i]||o[i-2]||o[0];return r}},He.test(e)||(Z.cssHooks[e+t].set=$)}),Z.fn.extend({css:function(e,t){return me(this,function(e,t,n){var i,r,o={},s=0;if(Z.isArray(t)){for(i=Be(e),r=t.length;r>s;s++)o[t[s]]=Z.css(e,t[s],!1,i);return o}return void 0!==n?Z.style(e,t,n):Z.css(e,t)},e,t,arguments.length>1)},show:function(){return T(this,!0)},hide:function(){return T(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ce(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=E,E.prototype={constructor:E,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(Z.cssNumber[n]?"":"px")},cur:function(){var e=E.propHooks[this.prop];return e&&e.get?e.get(this):E.propHooks._default.get(this)},run:function(e){var t,n=E.propHooks[this.prop];return this.pos=t=this.options.duration?Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):E.propHooks._default.set(this),this}},E.prototype.init.prototype=E.prototype,E.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Z.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Z.cssProps[e.prop]]||Z.cssHooks[e.prop])?Z.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},E.propHooks.scrollTop=E.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Z.fx=E.prototype.init,Z.fx.step={};var Xe,Qe,Je=/^(?:toggle|show|hide)$/,Ze=new RegExp("^(?:([+-])=|)("+_e+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[I],nt={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),r=Ze.exec(t),o=r&&r[3]||(Z.cssNumber[e]?"":"px"),s=(Z.cssNumber[e]||"px"!==o&&+i)&&Ze.exec(Z.css(n.elem,e)),a=1,l=20;if(s&&s[3]!==o){o=o||s[3],r=r||[],s=+i||1;do a=a||".5",s/=a,Z.style(n.elem,e,s+o);while(a!==(a=n.cur()/i)&&1!==a&&--l)}return r&&(s=n.start=+s||+i||0,n.unit=o,n.end=r[1]?s+(r[1]+1)*r[2]:+r[2]),n}]};Z.Animation=Z.extend(P,{tweener:function(e,t){Z.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,r=e.length;r>i;i++)n=e[i],nt[n]=nt[n]||[],nt[n].unshift(t)},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}}),Z.speed=function(e,t,n){var i=e&&"object"==typeof e?Z.extend({},e):{complete:n||!n&&t||Z.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Z.isFunction(t)&&t};return i.duration=Z.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in Z.fx.speeds?Z.fx.speeds[i.duration]:Z.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){Z.isFunction(i.old)&&i.old.call(this),i.queue&&Z.dequeue(this,i.queue)},i},Z.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Ce).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=Z.isEmptyObject(e),o=Z.speed(t,n,i),s=function(){var t=P(this,Z.extend({},e),o);(r||ve.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=Z.timers,s=ve.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&et.test(r)&&i(s[r]);
for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));(t||!n)&&Z.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=ve.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=Z.timers,s=i?i.length:0;for(n.finish=!0,Z.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),Z.each(["toggle","show","hide"],function(e,t){var n=Z.fn[t];Z.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(A(t,!0),e,i,r)}}),Z.each({slideDown:A("show"),slideUp:A("hide"),slideToggle:A("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Z.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,n=Z.timers;for(Xe=Z.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||Z.fx.stop(),Xe=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Qe||(Qe=setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){clearInterval(Qe),Qe=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(e,t){return e=Z.fx?Z.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e=Q.createElement("input"),t=Q.createElement("select"),n=t.appendChild(Q.createElement("option"));e.type="checkbox",X.checkOn=""!==e.value,X.optSelected=n.selected,t.disabled=!0,X.optDisabled=!n.disabled,e=Q.createElement("input"),e.value="t",e.type="radio",X.radioValue="t"===e.value}();var it,rt,ot=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return me(this,Z.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,n){var i,r,o=e.nodeType;return e&&3!==o&&8!==o&&2!==o?typeof e.getAttribute===ke?Z.prop(e,t,n):(1===o&&Z.isXMLDoc(e)||(t=t.toLowerCase(),i=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?rt:it)),void 0===n?i&&"get"in i&&null!==(r=i.get(e,t))?r:(r=Z.find.attr(e,t),null==r?void 0:r):null!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):void Z.removeAttr(e,t)):void 0},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(pe);if(o&&1===e.nodeType)for(;n=o[r++];)i=Z.propFix[n]||n,Z.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!X.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),rt={set:function(e,t,n){return t===!1?Z.removeAttr(e,n):e.setAttribute(n,n),n}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ot[t]||Z.find.attr;ot[t]=function(e,t,i){var r,o;return i||(o=ot[t],ot[t]=r,r=null!=n(e,t,i)?t.toLowerCase():null,ot[t]=o),r}});var st=/^(?:input|select|textarea|button)$/i;Z.fn.extend({prop:function(e,t){return me(this,Z.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var i,r,o,s=e.nodeType;return e&&3!==s&&8!==s&&2!==s?(o=1!==s||!Z.isXMLDoc(e),o&&(t=Z.propFix[t]||t,r=Z.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]):void 0},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||st.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),X.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var at=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(e){var t,n,i,r,o,s,a="string"==typeof e&&e,l=0,c=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(pe)||[];c>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(at," "):" ")){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");s=Z.trim(i),n.className!==s&&(n.className=s)}return this},removeClass:function(e){var t,n,i,r,o,s,a=0===arguments.length||"string"==typeof e&&e,l=0,c=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(pe)||[];c>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(at," "):"")){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");s=e?Z.trim(i):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(Z.isFunction(e)?function(n){Z(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,i=0,r=Z(this),o=e.match(pe)||[];t=o[i++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(n===ke||"boolean"===n)&&(this.className&&ve.set(this,"__className__",this.className),this.className=this.className||e===!1?"":ve.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(at," ").indexOf(t)>=0)return!0;return!1}});var lt=/\r/g;Z.fn.extend({val:function(e){var t,n,i,r=this[0];return arguments.length?(i=Z.isFunction(e),this.each(function(n){var r;1===this.nodeType&&(r=i?e.call(this,n,Z(this).val()):e,null==r?r="":"number"==typeof r?r+="":Z.isArray(r)&&(r=Z.map(r,function(e){return null==e?"":e+""})),t=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))})):r?(t=Z.valHooks[r.type]||Z.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:(n=r.value,"string"==typeof n?n.replace(lt,""):null==n?"":n)):void 0}}),Z.extend({valHooks:{option:{get:function(e){var t=Z.find.attr(e,"value");return null!=t?t:Z.trim(Z.text(e))}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,s=o?null:[],a=o?r+1:i.length,l=0>r?a:o?r:0;a>l;l++)if(n=i[l],!(!n.selected&&l!==r||(X.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&Z.nodeName(n.parentNode,"optgroup"))){if(t=Z(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,i,r=e.options,o=Z.makeArray(t),s=r.length;s--;)i=r[s],(i.selected=Z.inArray(i.value,o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){return Z.isArray(t)?e.checked=Z.inArray(Z(e).val(),t)>=0:void 0}},X.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Z.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var ct=Z.now(),ut=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(i){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Z.error("Invalid XML: "+e),t};var ht=/#.*$/,dt=/([?&])_=[^&]*/,pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,ft=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,gt=/^(?:GET|HEAD)$/,mt=/^\/\//,vt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,bt={},yt={},wt="*/".concat("*"),_t=e.location.href,xt=vt.exec(_t.toLowerCase())||[];Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_t,type:"GET",isLocal:ft.test(xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?F(F(e,Z.ajaxSettings),t):F(Z.ajaxSettings,e)},ajaxPrefilter:R(bt),ajaxTransport:R(yt),ajax:function(e,t){function n(e,t,n,s){var l,u,v,b,w,x=t;2!==y&&(y=2,a&&clearTimeout(a),i=void 0,o=s||"",_.readyState=e>0?4:0,l=e>=200&&300>e||304===e,n&&(b=L(h,_,n)),b=j(h,b,_,l),l?(h.ifModified&&(w=_.getResponseHeader("Last-Modified"),w&&(Z.lastModified[r]=w),w=_.getResponseHeader("etag"),w&&(Z.etag[r]=w)),204===e||"HEAD"===h.type?x="nocontent":304===e?x="notmodified":(x=b.state,u=b.data,v=b.error,l=!v)):(v=x,(e||!x)&&(x="error",0>e&&(e=0))),_.status=e,_.statusText=(t||x)+"",l?f.resolveWith(d,[u,x,_]):f.rejectWith(d,[_,x,v]),_.statusCode(m),m=void 0,c&&p.trigger(l?"ajaxSuccess":"ajaxError",[_,h,l?u:v]),g.fireWith(d,[_,x]),c&&(p.trigger("ajaxComplete",[_,h]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,r,o,s,a,l,c,u,h=Z.ajaxSetup({},t),d=h.context||h,p=h.context&&(d.nodeType||d.jquery)?Z(d):Z.event,f=Z.Deferred(),g=Z.Callbacks("once memory"),m=h.statusCode||{},v={},b={},y=0,w="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s)for(s={};t=pt.exec(o);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=b[n]=b[n]||e,v[e]=t),this},overrideMimeType:function(e){return y||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)m[t]=[m[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||w;return i&&i.abort(t),n(0,t),this}};if(f.promise(_).complete=g.add,_.success=_.done,_.error=_.fail,h.url=((e||h.url||_t)+"").replace(ht,"").replace(mt,xt[1]+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=Z.trim(h.dataType||"*").toLowerCase().match(pe)||[""],null==h.crossDomain&&(l=vt.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===xt[1]&&l[2]===xt[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(xt[3]||("http:"===xt[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=Z.param(h.data,h.traditional)),N(bt,h,t,_),2===y)return _;c=Z.event&&h.global,c&&0===Z.active++&&Z.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!gt.test(h.type),r=h.url,h.hasContent||(h.data&&(r=h.url+=(ut.test(r)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=dt.test(r)?r.replace(dt,"$1_="+ct++):r+(ut.test(r)?"&":"?")+"_="+ct++)),h.ifModified&&(Z.lastModified[r]&&_.setRequestHeader("If-Modified-Since",Z.lastModified[r]),Z.etag[r]&&_.setRequestHeader("If-None-Match",Z.etag[r])),(h.data&&h.hasContent&&h.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",h.contentType),_.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+wt+"; q=0.01":""):h.accepts["*"]);for(u in h.headers)_.setRequestHeader(u,h.headers[u]);if(h.beforeSend&&(h.beforeSend.call(d,_,h)===!1||2===y))return _.abort();w="abort";for(u in{success:1,error:1,complete:1})_[u](h[u]);if(i=N(yt,h,t,_)){_.readyState=1,c&&p.trigger("ajaxSend",[_,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){_.abort("timeout")},h.timeout));try{y=1,i.send(v,n)}catch(x){if(!(2>y))throw x;n(-1,x)}}else n(-1,"No Transport");return _},getJSON:function(e,t,n){return Z.get(e,t,n,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,t){Z[t]=function(e,n,i,r){return Z.isFunction(n)&&(r=r||i,i=n,n=void 0),Z.ajax({url:e,type:t,dataType:r,data:n,success:i})}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Z.fn.extend({wrapAll:function(e){var t;return Z.isFunction(e)?this.each(function(t){Z(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Z(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(Z.isFunction(e)?function(t){Z(this).wrapInner(e.call(this,t))}:function(){var t=Z(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Z.isFunction(e);return this.each(function(n){Z(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Z.expr.filters.visible=function(e){return!Z.expr.filters.hidden(e)};var Ct=/%20/g,$t=/\[\]$/,kt=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,Tt=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var n,i=[],r=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){r(this.name,this.value)});else for(n in e)U(n,e[n],t,r);return i.join("&").replace(Ct,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&Tt.test(this.nodeName)&&!St.test(e)&&(this.checked||!$e.test(e))}).map(function(e,t){var n=Z(this).val();return null==n?null:Z.isArray(n)?Z.map(n,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:n.replace(kt,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Et=0,Dt={},At={0:200,1223:204},Ot=Z.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Dt)Dt[e]()}),X.cors=!!Ot&&"withCredentials"in Ot,X.ajax=Ot=!!Ot,Z.ajaxTransport(function(e){var t;return X.cors||Ot&&!e.crossDomain?{send:function(n,i){var r,o=e.xhr(),s=++Et;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)o[r]=e.xhrFields[r];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(r in n)o.setRequestHeader(r,n[r]);t=function(e){return function(){t&&(delete Dt[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?i(o.status,o.statusText):i(At[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=Dt[s]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(a){if(t)throw a}},abort:function(){t&&t()}}:void 0}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,r){t=Z("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)}),Q.head.appendChild(t[0])},abort:function(){n&&n()}}}});var It=[],Mt=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=It.pop()||Z.expando+"_"+ct++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(t,n,i){var r,o,s,a=t.jsonp!==!1&&(Mt.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Mt.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=Z.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Mt,"$1"+r):t.jsonp!==!1&&(t.url+=(ut.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||Z.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){s=arguments},i.always(function(){e[r]=o,t[r]&&(t.jsonpCallback=n.jsonpCallback,It.push(r)),s&&Z.isFunction(o)&&o(s[0]),s=o=void 0}),"script"):void 0}),Z.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||Q;var i=se.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=Z.buildFragment([e],t,r),r&&r.length&&Z(r).remove(),Z.merge([],i.childNodes))};var Pt=Z.fn.load;Z.fn.load=function(e,t,n){if("string"!=typeof e&&Pt)return Pt.apply(this,arguments);var i,r,o,s=this,a=e.indexOf(" ");return a>=0&&(i=Z.trim(e.slice(a)),e=e.slice(0,a)),Z.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&Z.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){o=arguments,s.html(i?Z("<div>").append(Z.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z.expr.filters.animated=function(e){return Z.grep(Z.timers,function(t){return e===t.elem}).length};var Rt=e.document.documentElement;Z.offset={setOffset:function(e,t,n){var i,r,o,s,a,l,c,u=Z.css(e,"position"),h=Z(e),d={};"static"===u&&(e.style.position="relative"),a=h.offset(),o=Z.css(e,"top"),l=Z.css(e,"left"),c=("absolute"===u||"fixed"===u)&&(o+l).indexOf("auto")>-1,c?(i=h.position(),s=i.top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),Z.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(d.top=t.top-a.top+s),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):h.css(d)}},Z.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Z.offset.setOffset(this,e,t)});var t,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;return o?(t=o.documentElement,Z.contains(t,i)?(typeof i.getBoundingClientRect!==ke&&(r=i.getBoundingClientRect()),n=H(o),{top:r.top+n.pageYOffset-t.clientTop,left:r.left+n.pageXOffset-t.clientLeft}):r):void 0},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===Z.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(i=e.offset()),i.top+=Z.css(e[0],"borderTopWidth",!0),i.left+=Z.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-Z.css(n,"marginTop",!0),left:t.left-i.left-Z.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Rt;e&&!Z.nodeName(e,"html")&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||Rt})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var i="pageYOffset"===n;Z.fn[t]=function(r){return me(this,function(t,r,o){var s=H(t);return void 0===o?s?s[n]:t[r]:void(s?s.scrollTo(i?e.pageXOffset:o,i?o:e.pageYOffset):t[r]=o)},t,r,arguments.length,null)}}),Z.each(["top","left"],function(e,t){Z.cssHooks[t]=x(X.pixelPosition,function(e,n){return n?(n=_(e,t),We.test(n)?Z(e).position()[t]+"px":n):void 0})}),Z.each({Height:"height",Width:"width"},function(e,t){Z.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){Z.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),s=n||(i===!0||r===!0?"margin":"border");return me(this,function(t,n,i){var r;return Z.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===i?Z.css(t,n,s):Z.style(t,n,i,s)},t,o?i:void 0,o,null)}})}),Z.fn.size=function(){return this.length},Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var Nt=e.jQuery,Ft=e.$;return Z.noConflict=function(t){return e.$===Z&&(e.$=Ft),t&&e.jQuery===Z&&(e.jQuery=Nt),Z},typeof t===ke&&(e.jQuery=e.$=Z),Z}),function(e,t){function n(t,n){var r,o,s,a=t.nodeName.toLowerCase();return"area"===a?(r=t.parentNode,o=r.name,t.href&&o&&"map"===r.nodeName.toLowerCase()?(s=e("img[usemap=#"+o+"]")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var r=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,r,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(r=parseInt(o.css("zIndex"),10),!isNaN(r)&&0!==r))return r;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function r(t,n,i,r){return e.each(o,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var o="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?a["inner"+i].call(this):this.each(function(){e(this).css(s,r(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(s,r(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n){var i,r=e.plugins[t];if(r&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return t[i]>0?!0:(t[i]=1,r=t[i]>0,t[i]=0,r)}})}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(o){}r(t)},e.widget=function(t,n,i){var r,o,s,a,l={},c=t.split(".")[0];t=t.split(".")[1],r=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[c]=e[c]||{},o=e[c][t],s=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new n,a.options=e.widget.extend({},a.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(l[t]=i)}),s.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||t:t},l,{constructor:s,namespace:c,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,s,n._proto)}),delete o._childConstructors):n._childConstructors.push(s),e.widget.bridge(t,s)},e.widget.extend=function(n){for(var r,o,s=i.call(arguments,1),a=0,l=s.length;l>a;a++)for(r in s[a])o=s[a][r],s[a].hasOwnProperty(r)&&o!==t&&(n[r]=e.isPlainObject(o)?e.isPlainObject(n[r])?e.widget.extend({},n[r],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,r){var o=r.prototype.widgetFullName||n;e.fn[n]=function(s){var a="string"==typeof s,l=i.call(arguments,1),c=this;return s=!a&&l.length?e.widget.extend.apply(null,[s].concat(l)):s,this.each(a?function(){var i,r=e.data(this,o);return r?e.isFunction(r[s])&&"_"!==s.charAt(0)?(i=r[s].apply(r,l),i!==r&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+s+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+s+"'")}:function(){var t=e.data(this,o);t?t.option(s||{})._init():e.data(this,o,new r(s,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var r,o,s,a=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(a={},r=n.split("."),n=r.shift(),r.length){for(o=a[n]=e.widget.extend({},this.options[n]),s=0;s<r.length-1;s++)o[r[s]]=o[r[s]]||{},o=o[r[s]];if(n=r.pop(),1===arguments.length)return o[n]===t?null:o[n];o[n]=i}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];a[n]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,s){function a(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+o.eventNamespace,u=l[2];u?r.delegate(u,c,a):n.bind(c,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,o,s=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(s)&&s.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){"string"==typeof r&&(r={effect:r});var s,a=r?r===!0||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),s=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),s&&e.effects&&e.effects.effect[a]?i[t](r):a!==t&&i[a]?i[a](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!n){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,r=1===t.which,o="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;
return r&&!o&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function n(e,t,n){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}function r(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,s=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(o!==t)return o;var n,i,r=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=r.children()[0];return e("body").append(r),n=s.offsetWidth,r.css("overflow","scroll"),i=s.offsetWidth,n===i&&(i=r[0].clientWidth),r.remove(),o=n-i},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),r="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,o="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:o?e.position.scrollbarWidth():0,height:r?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]),r=!!n[0]&&9===n[0].nodeType;return{element:n,isWindow:i,isDocument:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var o,p,g,m,v,b,y=e(t.of),w=e.position.getWithinInfo(t.within),_=e.position.getScrollInfo(w),x=(t.collision||"flip").split(" "),C={};return b=r(y),y[0].preventDefault&&(t.at="left top"),p=b.width,g=b.height,m=b.offset,v=e.extend({},m),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=c.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=c.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=h.exec(i[0]),n=h.exec(i[1]),C[this]=[e?e[0]:0,n?n[0]:0],t[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===t.at[0]?v.left+=p:"center"===t.at[0]&&(v.left+=p/2),"bottom"===t.at[1]?v.top+=g:"center"===t.at[1]&&(v.top+=g/2),o=n(C.at,p,g),v.left+=o[0],v.top+=o[1],this.each(function(){var r,c,u=e(this),h=u.outerWidth(),d=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),$=h+f+i(this,"marginRight")+_.width,k=d+b+i(this,"marginBottom")+_.height,S=e.extend({},v),T=n(C.my,u.outerWidth(),u.outerHeight());"right"===t.my[0]?S.left-=h:"center"===t.my[0]&&(S.left-=h/2),"bottom"===t.my[1]?S.top-=d:"center"===t.my[1]&&(S.top-=d/2),S.left+=T[0],S.top+=T[1],e.support.offsetFractions||(S.left=l(S.left),S.top=l(S.top)),r={marginLeft:f,marginTop:b},e.each(["left","top"],function(n,i){e.ui.position[x[n]]&&e.ui.position[x[n]][i](S,{targetWidth:p,targetHeight:g,elemWidth:h,elemHeight:d,collisionPosition:r,collisionWidth:$,collisionHeight:k,offset:[o[0]+T[0],o[1]+T[1]],my:t.my,at:t.at,within:w,elem:u})}),t.using&&(c=function(e){var n=m.left-S.left,i=n+p-h,r=m.top-S.top,o=r+g-d,l={target:{element:y,left:m.left,top:m.top,width:p,height:g},element:{element:u,left:S.left,top:S.top,width:h,height:d},horizontal:0>i?"left":n>0?"right":"center",vertical:0>o?"top":r>0?"bottom":"middle"};h>p&&a(n+i)<p&&(l.horizontal="center"),d>g&&a(r+o)<g&&(l.vertical="middle"),l.important=s(a(n),a(i))>s(a(r),a(o))?"horizontal":"vertical",t.using.call(this,e,l)}),u.offset(e.extend(S,{using:c}))})},e.ui.position={fit:{left:function(e,t){var n,i=t.within,r=i.isWindow?i.scrollLeft:i.offset.left,o=i.width,a=e.left-t.collisionPosition.marginLeft,l=r-a,c=a+t.collisionWidth-o-r;t.collisionWidth>o?l>0&&0>=c?(n=e.left+l+t.collisionWidth-o-r,e.left+=l-n):e.left=c>0&&0>=l?r:l>c?r+o-t.collisionWidth:r:l>0?e.left+=l:c>0?e.left-=c:e.left=s(e.left-a,e.left)},top:function(e,t){var n,i=t.within,r=i.isWindow?i.scrollTop:i.offset.top,o=t.within.height,a=e.top-t.collisionPosition.marginTop,l=r-a,c=a+t.collisionHeight-o-r;t.collisionHeight>o?l>0&&0>=c?(n=e.top+l+t.collisionHeight-o-r,e.top+=l-n):e.top=c>0&&0>=l?r:l>c?r+o-t.collisionHeight:r:l>0?e.top+=l:c>0?e.top-=c:e.top=s(e.top-a,e.top)}},flip:{left:function(e,t){var n,i,r=t.within,o=r.offset.left+r.scrollLeft,s=r.width,l=r.isWindow?r.scrollLeft:r.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,h=c+t.collisionWidth-s-l,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(n=e.left+d+p+f+t.collisionWidth-s-o,(0>n||n<a(u))&&(e.left+=d+p+f)):h>0&&(i=e.left-t.collisionPosition.marginLeft+d+p+f-l,(i>0||a(i)<h)&&(e.left+=d+p+f))},top:function(e,t){var n,i,r=t.within,o=r.offset.top+r.scrollTop,s=r.height,l=r.isWindow?r.scrollTop:r.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,h=c+t.collisionHeight-s-l,d="top"===t.my[1],p=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,g=-2*t.offset[1];0>u?(i=e.top+p+f+g+t.collisionHeight-s-o,e.top+p+f+g>u&&(0>i||i<a(u))&&(e.top+=p+f+g)):h>0&&(n=e.top-t.collisionPosition.marginTop+p+f+g-l,e.top+p+f+g>h&&(n>0||a(n)<h)&&(e.top+=p+f+g))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,r,o,s=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(s?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in i)t.style[o]=i[o];t.appendChild(a),n=s||document.documentElement,n.insertBefore(t,n.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",r=e(a).offset().left,e.support.offsetFractions=r>10&&11>r,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e,t){var n=0,i={},r={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.10.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e(),content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),void("disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)))},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,i=this.headers.length,r=this.headers.index(t.target),o=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:o=this.headers[(r+1)%i];break;case n.LEFT:case n.UP:o=this.headers[(r-1+i)%i];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:o=this.headers[0];break;case n.END:o=this.headers[i-1]}o&&(e(t.target).attr("tabIndex",-1),e(o).attr("tabIndex",0),o.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,i=this.options,r=i.heightStyle,o=this.element.parent(),s=this.accordionId="ui-accordion-"+(this.element.attr("id")||++n);this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var n=e(this),i=n.attr("id"),r=n.next(),o=r.attr("id");i||(i=s+"-header-"+t,n.attr("id",i)),o||(o=s+"-panel-"+t,r.attr("id",o)),n.attr("aria-controls",o),r.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===r?(t=o.height(),this.element.siblings(":visible").each(function(){var n=e(this),i=n.css("position");"absolute"!==i&&"fixed"!==i&&(t-=n.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===r&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n=this.options,i=this.active,r=e(t.currentTarget),o=r[0]===i[0],s=o&&n.collapsible,a=s?e():r.next(),l=i.next(),c={oldHeader:i,oldPanel:l,newHeader:s?e():r,newPanel:a};t.preventDefault(),o&&!n.collapsible||this._trigger("beforeActivate",t,c)===!1||(n.active=s?!1:this.headers.index(r),this.active=o?e():r,this._toggle(c),i.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),o||(r.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),r.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=i,this.options.animate?this._animate(n,i,t):(i.hide(),n.show(),this._toggleComplete(t)),i.attr({"aria-hidden":"true"}),i.prev().attr("aria-selected","false"),n.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):n.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),n.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,n){var o,s,a,l=this,c=0,u=e.length&&(!t.length||e.index()<t.index()),h=this.options.animate||{},d=u&&h.down||h,p=function(){l._toggleComplete(n)};return"number"==typeof d&&(a=d),"string"==typeof d&&(s=d),s=s||d.easing||h.easing,a=a||d.duration||h.duration,t.length?e.length?(o=e.show().outerHeight(),t.animate(i,{duration:a,easing:s,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(r,{duration:a,easing:s,complete:p,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?c+=n.now:"content"!==l.options.heightStyle&&(n.now=Math.round(o-t.outerHeight()-c),c=0)}})):t.animate(i,a,s,p):e.animate(r,a,s,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e,t){e.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,n,i,r=this.element[0].nodeName.toLowerCase(),o="textarea"===r,s="input"===r;this.isMultiLine=o?!0:s?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[o||s?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(r){if(this.element.prop("readOnly"))return t=!0,i=!0,void(n=!0);t=!1,i=!1,n=!1;var o=e.ui.keyCode;switch(r.keyCode){case o.PAGE_UP:t=!0,this._move("previousPage",r);break;case o.PAGE_DOWN:t=!0,this._move("nextPage",r);break;case o.UP:t=!0,this._keyEvent("previous",r);break;case o.DOWN:t=!0,this._keyEvent("next",r);break;case o.ENTER:case o.NUMPAD_ENTER:this.menu.active&&(t=!0,r.preventDefault(),this.menu.select(r));break;case o.TAB:this.menu.active&&this.menu.select(r);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(r),r.preventDefault());break;default:n=!0,this._searchTimeout(r)}},keypress:function(i){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&i.preventDefault());if(!n){var r=e.ui.keyCode;switch(i.keyCode){case r.PAGE_UP:this._move("previousPage",i);break;case r.PAGE_DOWN:this._move("nextPage",i);break;case r.UP:this._keyEvent("previous",i);break;case r.DOWN:this._keyEvent("next",i)}}},input:function(e){return i?(i=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(i){i.target===t.element[0]||i.target===n||e.contains(n,i.target)||t.close()})})},menufocus:function(t,n){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var i=n.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:i})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value):this.liveRegion.text(i.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,n,i=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,i){i(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,r){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){r(e)},error:function(){r([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty();this._renderMenu(n,t),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var i=this;e.each(n,function(e,n){i._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var i=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e,t){var n,i="ui-button ui-widget ui-state-default ui-corner-all",r="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",o=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},s=function(t){var n=t.name,i=t.form,r=e([]);return n&&(n=n.replace(/'/g,"\\'"),r=i?e(i).find("[name='"+n+"']"):e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),r};e.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,o),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,r=this.options,a="checkbox"===this.type||"radio"===this.type,l=a?"":"ui-state-active";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(i).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||e(this).removeClass(l)}).bind("click"+this.eventNamespace,function(e){r.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),a&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return r.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(r.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];s(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return r.disabled?!1:(e(this).addClass("ui-state-active"),n=this,void t.document.one("mouseup",function(){n=null}))}).bind("mouseup"+this.eventNamespace,function(){return r.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return r.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",r.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(i+" ui-state-active "+r).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.element.prop("disabled",!!t),void(t&&this.buttonElement.removeClass("ui-state-focus"))):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?s(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(r),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),i=this.options.icons,o=i.primary&&i.secondary,s=[];i.primary||i.secondary?(this.options.text&&s.push("ui-button-text-icon"+(o?"s":i.primary?"-primary":"-secondary")),i.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+i.primary+"'></span>"),i.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+i.secondary+"'></span>"),this.options.text||(s.push(o?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,
duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=i(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(o.inline?t.parent()[0]:o.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function r(t,n){e.extend(t,n);for(var i in n)null==n[i]&&(t[i]=n[i]);return t}e.extend(e.ui,{datepicker:{version:"1.10.4"}});var o,s="datepicker";e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var i,r,o;i=t.nodeName.toLowerCase(),r="div"===i||"span"===i,t.id||(this.uuid+=1,t.id="dp"+this.uuid),o=this._newInst(e(t),r),o.settings=e.extend({},n||{}),"input"===i?this._connectDatepicker(t,o):r&&this._inlineDatepicker(t,o)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?i(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var i=e(t);n.append=e([]),n.trigger=e([]),i.hasClass(this.markerClassName)||(this._attachments(i,n),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(n),e.data(t,s,n),n.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,n){var i,r,o,s=this._get(n,"appendText"),a=this._get(n,"isRTL");n.append&&n.append.remove(),s&&(n.append=e("<span class='"+this._appendClass+"'>"+s+"</span>"),t[a?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),i=this._get(n,"showOn"),("focus"===i||"both"===i)&&t.focus(this._showDatepicker),("button"===i||"both"===i)&&(r=this._get(n,"buttonText"),o=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:o,alt:r,title:r}):e("<button type='button'></button>").addClass(this._triggerClass).html(o?e("<img/>").attr({src:o,alt:r,title:r}):r)),t[a?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,i,r,o=new Date(2009,11,20),s=this._get(e,"dateFormat");s.match(/[DM]/)&&(t=function(e){for(n=0,i=0,r=0;r<e.length;r++)e[r].length>n&&(n=e[r].length,i=r);return i},o.setMonth(t(this._get(e,s.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(t(this._get(e,s.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),e.input.attr("size",this._formatDate(e,o).length)}},_inlineDatepicker:function(t,n){var i=e(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(n.dpDiv),e.data(t,s,n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block"))},_dialogDatepicker:function(t,n,i,o,a){var l,c,u,h,d,p=this._dialogInst;return p||(this.uuid+=1,l="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+l+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],s,p)),r(p.settings,o||{}),n=n&&n.constructor===Date?this._formatDate(p,n):n,this._dialogInput.val(n),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(c=document.documentElement.clientWidth,u=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[c/2-100+h,u/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],s,p),this},_destroyDatepicker:function(t){var n,i=e(t),r=e.data(t,s);i.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),e.removeData(t,s),"input"===n?(r.append.remove(),r.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===n||"span"===n)&&i.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var n,i,r=e(t),o=e.data(t,s);r.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===n||"span"===n)&&(i=r.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var n,i,r=e(t),o=e.data(t,s);r.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===n||"span"===n)&&(i=r.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,s)}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,i,o){var s,a,l,c,u=this._getInst(n);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):u?"all"===i?e.extend({},u.settings):this._get(u,i):null:(s=i||{},"string"==typeof i&&(s={},s[i]=o),void(u&&(this._curInst===u&&this._hideDatepicker(),a=this._getDateDatepicker(n,!0),l=this._getMinMaxDate(u,"min"),c=this._getMinMaxDate(u,"max"),r(u.settings,s),null!==l&&s.dateFormat!==t&&s.minDate===t&&(u.settings.minDate=this._formatDate(u,l)),null!==c&&s.dateFormat!==t&&s.maxDate===t&&(u.settings.maxDate=this._formatDate(u,c)),"disabled"in s&&(s.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),u),this._autoSize(u),this._setDate(u,a),this._updateAlternate(u),this._updateDatepicker(u))))},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,i,r,o=e.datepicker._getInst(t.target),s=!0,a=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),s=!1;break;case 13:return r=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",o.dpDiv),r[0]&&e.datepicker._selectDay(t.target,o.selectedMonth,o.selectedYear,r[0]),n=e.datepicker._get(o,"onSelect"),n?(i=e.datepicker._formatDate(o),n.apply(o.input?o.input[0]:null,[i,o])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),s=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),s=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?1:-1,"D"),s=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),s=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?-1:1,"D"),s=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),s=t.ctrlKey||t.metaKey;break;default:s=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):s=!1;s&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,i,r=e.datepicker._getInst(t.target);return e.datepicker._get(r,"constrainInput")?(n=e.datepicker._possibleChars(e.datepicker._get(r,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">i||!n||n.indexOf(i)>-1):void 0},_doKeyUp:function(t){var n,i=e.datepicker._getInst(t.target);if(i.input.val()!==i.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,e.datepicker._getFormatConfig(i)),n&&(e.datepicker._setDateFromField(i),e.datepicker._updateAlternate(i),e.datepicker._updateDatepicker(i))}catch(r){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var n,i,o,s,a,l,c;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),i=e.datepicker._get(n,"beforeShow"),o=i?i.apply(t,[t,n]):{},o!==!1&&(r(n.settings,o),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),s=!1,e(t).parents().each(function(){return s|="fixed"===e(this).css("position"),!s}),a={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),a=e.datepicker._checkOffset(n,a,s),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":s?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),n.inline||(l=e.datepicker._get(n,"showAnim"),c=e.datepicker._get(n,"duration"),n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?n.dpDiv.show(l,e.datepicker._get(n,"showOptions"),c):n.dpDiv[l||"show"](l?c:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n))}},_updateDatepicker:function(t){this.maxRows=4,o=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,i=this._getNumberOfMonths(t),r=i[1],s=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),r>1&&t.dpDiv.addClass("ui-datepicker-multi-"+r).css("width",s*r+"em"),t.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,i){var r=t.dpDiv.outerWidth(),o=t.dpDiv.outerHeight(),s=t.input?t.input.outerWidth():0,a=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(i?0:e(document).scrollLeft()),c=document.documentElement.clientHeight+(i?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?r-s:0,n.left-=i&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=i&&n.top===t.input.offset().top+a?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+r>l&&l>r?Math.abs(n.left+r-l):0),n.top-=Math.min(n.top,n.top+o>c&&c>o?Math.abs(o+a):0),n},_findPos:function(t){for(var n,i=this._getInst(t),r=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[r?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,i,r,o,a=this._curInst;!a||t&&a!==e.data(t,s)||this._datepickerShowing&&(n=this._get(a,"showAnim"),i=this._get(a,"duration"),r=function(){e.datepicker._tidyDialog(a)},e.effects&&(e.effects.effect[n]||e.effects[n])?a.dpDiv.hide(n,e.datepicker._get(a,"showOptions"),i,r):a.dpDiv["slideDown"===n?"slideUp":"fadeIn"===n?"fadeOut":"hide"](n?i:null,r),n||r(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var n=e(t.target),i=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&0===n.parents("#"+e.datepicker._mainDivId).length&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==i)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,n,i){var r=e(t),o=this._getInst(r[0]);this._isDisabledDatepicker(r[0])||(this._adjustInstDate(o,n+("M"===i?this._get(o,"showCurrentAtPos"):0),i),this._updateDatepicker(o))},_gotoToday:function(t){var n,i=e(t),r=this._getInst(i[0]);this._get(r,"gotoCurrent")&&r.currentDay?(r.selectedDay=r.currentDay,r.drawMonth=r.selectedMonth=r.currentMonth,r.drawYear=r.selectedYear=r.currentYear):(n=new Date,r.selectedDay=n.getDate(),r.drawMonth=r.selectedMonth=n.getMonth(),r.drawYear=r.selectedYear=n.getFullYear()),this._notifyChange(r),this._adjustDate(i)},_selectMonthYear:function(t,n,i){var r=e(t),o=this._getInst(r[0]);o["selected"+("M"===i?"Month":"Year")]=o["draw"+("M"===i?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(r)},_selectDay:function(t,n,i,r){var o,s=e(t);e(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(s[0])||(o=this._getInst(s[0]),o.selectedDay=o.currentDay=e("a",r).html(),o.selectedMonth=o.currentMonth=n,o.selectedYear=o.currentYear=i,this._selectDate(t,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var i,r=e(t),o=this._getInst(r[0]);n=null!=n?n:this._formatDate(o),o.input&&o.input.val(n),this._updateAlternate(o),i=this._get(o,"onSelect"),i?i.apply(o.input?o.input[0]:null,[n,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,i,r,o=this._get(t,"altField");o&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),r=this.formatDate(n,i,this._getFormatConfig(t)),e(o).each(function(){e(this).val(r)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,i){if(null==t||null==n)throw"Invalid arguments";if(n="object"==typeof n?n.toString():n+"",""===n)return null;var r,o,s,a,l=0,c=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),h=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,d=(i?i.dayNames:null)||this._defaults.dayNames,p=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,f=(i?i.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,v=-1,b=-1,y=!1,w=function(e){var n=r+1<t.length&&t.charAt(r+1)===e;return n&&r++,n},_=function(e){var t=w(e),i="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,r=new RegExp("^\\d{1,"+i+"}"),o=n.substring(l).match(r);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},x=function(t,i,r){var o=-1,s=e.map(w(t)?r:i,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(s,function(e,t){var i=t[1];return n.substr(l,i.length).toLowerCase()===i.toLowerCase()?(o=t[0],l+=i.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+l},C=function(){if(n.charAt(l)!==t.charAt(r))throw"Unexpected literal at position "+l;l++};for(r=0;r<t.length;r++)if(y)"'"!==t.charAt(r)||w("'")?C():y=!1;else switch(t.charAt(r)){case"d":v=_("d");break;case"D":x("D",h,d);break;case"o":b=_("o");break;case"m":m=_("m");break;case"M":m=x("M",p,f);break;case"y":g=_("y");break;case"@":a=new Date(_("@")),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"!":a=new Date((_("!")-this._ticksTo1970)/1e4),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"'":w("'")?C():y=!0;break;default:C()}if(l<n.length&&(s=n.substr(l),!/^\s+/.test(s)))throw"Extra/unparsed characters found in date: "+s;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=g?0:-100)),b>-1)for(m=1,v=b;o=this._getDaysInMonth(g,m-1),!(o>=v);)m++,v-=o;if(a=this._daylightSavingAdjust(new Date(g,m-1,v)),a.getFullYear()!==g||a.getMonth()+1!==m||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var i,r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,o=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,a=(n?n.monthNames:null)||this._defaults.monthNames,l=function(t){var n=i+1<e.length&&e.charAt(i+1)===t;return n&&i++,n},c=function(e,t,n){var i=""+t;if(l(e))for(;i.length<n;)i="0"+i;return i},u=function(e,t,n,i){return l(e)?i[t]:n[t]},h="",d=!1;if(t)for(i=0;i<e.length;i++)if(d)"'"!==e.charAt(i)||l("'")?h+=e.charAt(i):d=!1;else switch(e.charAt(i)){case"d":h+=c("d",t.getDate(),2);break;case"D":h+=u("D",t.getDay(),r,o);break;case"o":h+=c("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":h+=c("m",t.getMonth()+1,2);break;case"M":h+=u("M",t.getMonth(),s,a);break;case"y":h+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":h+=t.getTime();break;case"!":h+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?h+="'":d=!0;break;default:h+=e.charAt(i)}return h},_possibleChars:function(e){var t,n="",i=!1,r=function(n){var i=t+1<e.length&&e.charAt(t+1)===n;return i&&t++,i};for(t=0;t<e.length;t++)if(i)"'"!==e.charAt(t)||r("'")?n+=e.charAt(t):i=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":r("'")?n+="'":i=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var n=this._get(e,"dateFormat"),i=e.lastVal=e.input?e.input.val():null,r=this._getDefaultDate(e),o=r,s=this._getFormatConfig(e);try{o=this.parseDate(n,i,s)||r}catch(a){i=t?"":i}e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),e.currentDay=i?o.getDate():0,e.currentMonth=i?o.getMonth():0,e.currentYear=i?o.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,i){var r=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},o=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(i){}for(var r=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,o=r.getFullYear(),s=r.getMonth(),a=r.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,c=l.exec(n);c;){switch(c[2]||"d"){case"d":case"D":a+=parseInt(c[1],10);break;case"w":case"W":a+=7*parseInt(c[1],10);break;case"m":case"M":s+=parseInt(c[1],10),a=Math.min(a,e.datepicker._getDaysInMonth(o,s));break;case"y":case"Y":o+=parseInt(c[1],10),a=Math.min(a,e.datepicker._getDaysInMonth(o,s))}c=l.exec(n)}return new Date(o,s,a)},s=null==n||""===n?i:"string"==typeof n?o(n):"number"==typeof n?isNaN(n)?i:r(n):new Date(n.getTime());return s=s&&"Invalid Date"===s.toString()?i:s,s&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var i=!t,r=e.selectedMonth,o=e.selectedYear,s=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=s.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=s.getMonth(),e.drawYear=e.selectedYear=e.currentYear=s.getFullYear(),r===e.selectedMonth&&o===e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(i?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(i,-n,"M")},next:function(){e.datepicker._adjustDate(i,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(i)},selectDay:function(){return e.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(i,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,i,r,o,s,a,l,c,u,h,d,p,f,g,m,v,b,y,w,_,x,C,$,k,S,T,E,D,A,O,I,M,P,R,N,F,L,j,U=new Date,H=this._daylightSavingAdjust(new Date(U.getFullYear(),U.getMonth(),U.getDate())),W=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),z=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),Y=this._get(e,"showCurrentAtPos"),G=this._get(e,"stepMonths"),K=1!==V[0]||1!==V[1],X=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(e,"min"),J=this._getMinMaxDate(e,"max"),Z=e.drawMonth-Y,ee=e.drawYear;if(0>Z&&(Z+=12,ee--),J)for(t=this._daylightSavingAdjust(new Date(J.getFullYear(),J.getMonth()-V[0]*V[1]+1,J.getDate())),t=Q&&Q>t?Q:t;this._daylightSavingAdjust(new Date(ee,Z,1))>t;)Z--,0>Z&&(Z=11,ee--);for(e.drawMonth=Z,e.drawYear=ee,n=this._get(e,"prevText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(ee,Z-G,1)),this._getFormatConfig(e)):n,i=this._canAdjustMonth(e,-1,ee,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"e":"w")+"'>"+n+"</span></a>":z?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"e":"w")+"'>"+n+"</span></a>",r=this._get(e,"nextText"),r=q?this.formatDate(r,this._daylightSavingAdjust(new Date(ee,Z+G,1)),this._getFormatConfig(e)):r,o=this._canAdjustMonth(e,1,ee,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"w":"e")+"'>"+r+"</span></a>":z?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"w":"e")+"'>"+r+"</span></a>",s=this._get(e,"currentText"),a=this._get(e,"gotoCurrent")&&e.currentDay?X:H,s=q?this.formatDate(s,a,this._getFormatConfig(e)):s,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",c=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(W?l:"")+(this._isInRange(e,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+s+"</button>":"")+(W?"":l)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,h=this._get(e,"showWeek"),d=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),g=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),b=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),w="",x=0;x<V[0];x++){for(C="",this.maxRows=4,$=0;$<V[1];$++){if(k=this._daylightSavingAdjust(new Date(ee,Z,e.selectedDay)),S=" ui-corner-all",T="",K){if(T+="<div class='ui-datepicker-group",V[1]>1)switch($){case 0:T+=" ui-datepicker-group-first",S=" ui-corner-"+(W?"right":"left");break;case V[1]-1:T+=" ui-datepicker-group-last",S=" ui-corner-"+(W?"left":"right");break;default:T+=" ui-datepicker-group-middle",S=""}T+="'>"}for(T+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===x?W?o:i:"")+(/all|right/.test(S)&&0===x?W?i:o:"")+this._generateMonthYearHeader(e,Z,ee,Q,J,x>0||$>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",E=h?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",_=0;7>_;_++)D=(_+u)%7,E+="<th"+((_+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[D]+"'>"+p[D]+"</span></th>";for(T+=E+"</tr></thead><tbody>",A=this._getDaysInMonth(ee,Z),ee===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),O=(this._getFirstDayOfMonth(ee,Z)-u+7)%7,I=Math.ceil((O+A)/7),M=K&&this.maxRows>I?this.maxRows:I,this.maxRows=M,P=this._daylightSavingAdjust(new Date(ee,Z,1-O)),R=0;M>R;R++){for(T+="<tr>",N=h?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"",_=0;7>_;_++)F=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],L=P.getMonth()!==Z,j=L&&!b||!F[0]||Q&&Q>P||J&&P>J,N+="<td class='"+((_+u+6)%7>=5?" ui-datepicker-week-end":"")+(L?" ui-datepicker-other-month":"")+(P.getTime()===k.getTime()&&Z===e.selectedMonth&&e._keyEvent||y.getTime()===P.getTime()&&y.getTime()===k.getTime()?" "+this._dayOverClass:"")+(j?" "+this._unselectableClass+" ui-state-disabled":"")+(L&&!v?"":" "+F[1]+(P.getTime()===X.getTime()?" "+this._currentClass:"")+(P.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(L&&!v||!F[2]?"":" title='"+F[2].replace(/'/g,"&#39;")+"'")+(j?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(L&&!v?"&#xa0;":j?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===H.getTime()?" ui-state-highlight":"")+(P.getTime()===X.getTime()?" ui-state-active":"")+(L?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);T+=N+"</tr>"}Z++,Z>11&&(Z=0,ee++),T+="</tbody></table>"+(K?"</div>"+(V[0]>0&&$===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),C+=T}w+=C}return w+=c,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,i,r,o,s,a){var l,c,u,h,d,p,f,g,m=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),b=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",w="";if(o||!m)w+="<span class='ui-datepicker-month'>"+s[t]+"</span>";else{for(l=i&&i.getFullYear()===n,c=r&&r.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!l||u>=i.getMonth())&&(!c||u<=r.getMonth())&&(w+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+a[u]+"</option>");w+="</select>"}if(b||(y+=w+(!o&&m&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",o||!v)y+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(h=this._get(e,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?d+parseInt(e,10):parseInt(e,10);return isNaN(t)?d:t},f=p(h[0]),g=Math.max(f,p(h[1]||"")),f=i?Math.max(f,i.getFullYear()):f,g=r?Math.min(g,r.getFullYear()):g,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===n?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),b&&(y+=(!o&&m&&v?"":"&#xa0;")+w),y+="</div>"},_adjustInstDate:function(e,t,n){var i=e.drawYear+("Y"===n?t:0),r=e.drawMonth+("M"===n?t:0),o=Math.min(e.selectedDay,this._getDaysInMonth(i,r))+("D"===n?t:0),s=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(i,r,o)));e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),("M"===n||"Y"===n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),r=n&&n>t?n:t;return i&&r>i?i:r},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay();
},_canAdjustMonth:function(e,t,n,i){var r=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(n,i+(0>t?t:r[0]*r[1]),1));return 0>t&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(e,o)},_isInRange:function(e,t){var n,i,r=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),s=null,a=null,l=this._get(e,"yearRange");return l&&(n=l.split(":"),i=(new Date).getFullYear(),s=parseInt(n[0],10),a=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(s+=i),n[1].match(/[+\-].*/)&&(a+=i)),(!r||t.getTime()>=r.getTime())&&(!o||t.getTime()<=o.getTime())&&(!s||t.getFullYear()>=s)&&(!a||t.getFullYear()<=a)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,i){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var r=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(i,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),r,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.4"}(jQuery),function(e,t){var n={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;0>n&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n,i=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._destroyOverlay(),!this.opener.filter(":focusable").focus().length)try{n=this.document[0].activeElement,n&&"body"!==n.nodeName.toLowerCase()&&e(n).blur()}catch(r){}this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var n=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return n&&!t&&this._trigger("focus",e),n},open:function(){var t=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function n(){var t=this.document[0].activeElement,n=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);n||this._focusTabbable()}t.preventDefault(),n.call(this),this._delay(n)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB){var n=this.uiDialog.find(":tabbable"),i=n.filter(":first"),r=n.filter(":last");t.target!==r[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(r.focus(1),t.preventDefault()):(i.focus(1),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(n)||e.isArray(n)&&!n.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(e.each(n,function(n,i){var r,o;i=e.isFunction(i)?{click:i,text:n}:i,i=e.extend({type:"button"},i),r=i.click,i.click=function(){r.apply(t.element[0],arguments)},o={icons:i.icons,text:i.showText},delete i.icons,delete i.showText,e("<button></button>",i).button(o).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var n=this,i=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,r){e(this).addClass("ui-dialog-dragging"),n._blockFrames(),n._trigger("dragStart",i,t(r))},drag:function(e,i){n._trigger("drag",e,t(i))},stop:function(r,o){i.position=[o.position.left-n.document.scrollLeft(),o.position.top-n.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),n._unblockFrames(),n._trigger("dragStop",r,t(o))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var n=this,i=this.options,r=i.resizable,o=this.uiDialog.css("position"),s="string"==typeof r?r:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:this._minHeight(),handles:s,start:function(i,r){e(this).addClass("ui-dialog-resizing"),n._blockFrames(),n._trigger("resizeStart",i,t(r))},resize:function(e,i){n._trigger("resize",e,t(i))},stop:function(r,o){i.height=e(this).height(),i.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),n._unblockFrames(),n._trigger("resizeStop",r,t(o))}}).css("position",o)},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var r=this,o=!1,s={};e.each(t,function(e,t){r._setOption(e,t),e in n&&(o=!0),e in i&&(s[e]=t)}),o&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(e,t){var n,i,r=this.uiDialog;"dialogClass"===e&&r.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(n=r.is(":data(ui-draggable)"),n&&!t&&r.draggable("destroy"),!n&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(i=r.is(":data(ui-resizable)"),i&&!t&&r.resizable("destroy"),i&&"string"==typeof t&&r.resizable("option","handles",t),i||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,n,i=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),i.minWidth>i.width&&(i.width=i.minWidth),e=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),t=Math.max(0,i.minHeight-e),n="number"==typeof i.maxHeight?Math.max(0,i.maxHeight-e):"none","auto"===i.height?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,i.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=this,n=this.widgetFullName;e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(i){t._allowInteraction(i)||(i.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data(n)._focusTabbable())})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var t,n=this.options.position,i=[],r=[0,0];n?(("string"==typeof n||"object"==typeof n&&"0"in n)&&(i=n.split?n.split(" "):[n[0],n[1]],1===i.length&&(i[1]=i[0]),e.each(["left","top"],function(e,t){+i[e]===i[e]&&(r[e]=i[e],i[e]=t)}),n={my:i[0]+(r[0]<0?r[0]:"+"+r[0])+" "+i[1]+(r[1]<0?r[1]:"+"+r[1]),at:i.join(" ")}),n=e.extend({},e.ui.dialog.prototype.options.position,n)):n=e.ui.dialog.prototype.options.position,t=this.uiDialog.is(":visible"),t||this.uiDialog.show(),this.uiDialog.position(n),t||this.uiDialog.hide()}})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;return r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=e(r.containment),i=n[0],void(i&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n))):void(this.containment=null)},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(t){var n,i,r,o,s=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,c=t.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),s.grid&&(r=s.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,c=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-s.grid[1]:r+s.grid[1]:r,o=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-s.grid[0]:o+s.grid[0]:o)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("ui-draggable"),r=i.options,o=e.extend({},n,{item:i.element});i.sortables=[],e(r.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,o))})},stop:function(t,n){var i=e(this).data("ui-draggable"),r=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,r))})},drag:function(t,n){var i=e(this).data("ui-draggable"),r=this;e.each(i.sortables,function(){var o=!1,s=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==s&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(s.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("opacity")&&(r._opacity=i.css("opacity")),i.css("opacity",r.opacity)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),i=n.options,r=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),r!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){var i,r,o,s,a,l,c,u,h,d,p=e(this).data("ui-draggable"),f=p.options,g=f.snapTolerance,m=n.offset.left,v=m+p.helperProportions.width,b=n.offset.top,y=b+p.helperProportions.height;for(h=p.snapElements.length-1;h>=0;h--)a=p.snapElements[h].left,l=a+p.snapElements[h].width,c=p.snapElements[h].top,u=c+p.snapElements[h].height,a-g>v||m>l+g||c-g>y||b>u+g||!e.contains(p.snapElements[h].item.ownerDocument,p.snapElements[h].item)?(p.snapElements[h].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[h].item})),p.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(i=Math.abs(c-y)<=g,r=Math.abs(u-b)<=g,o=Math.abs(a-v)<=g,s=Math.abs(l-m)<=g,i&&(n.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),d=i||r||o||s,"outer"!==f.snapMode&&(i=Math.abs(c-b)<=g,r=Math.abs(u-y)<=g,o=Math.abs(a-m)<=g,s=Math.abs(l-v)<=g,i&&(n.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[h].snapping&&(i||r||o||s||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[h].item})),p.snapElements[h].snapping=i||r||o||s||d)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,i=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});i.length&&(t=parseInt(e(i[0]).css("zIndex"),10)||0,e(i).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+i.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("zIndex")&&(r._zIndex=i.css("zIndex")),i.css("zIndex",r.zIndex)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery),function(e,t){function n(e,t,n){return e>t&&t+n>e}e.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,n=this.options,i=n.accept;
this.isover=!1,this.isout=!0,this.accept=e.isFunction(i)?i:function(e){return e.is(i)},this.proportions=function(){return arguments.length?void(t=arguments[0]):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},e.ui.ddmanager.droppables[n.scope]=e.ui.ddmanager.droppables[n.scope]||[],e.ui.ddmanager.droppables[n.scope].push(this),n.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,n=e.ui.ddmanager.droppables[this.options.scope];t<n.length;t++)n[t]===this&&n.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){"accept"===t&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var i=n||e.ui.ddmanager.current,r=!1;return i&&(i.currentItem||i.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope===i.options.scope&&t.accept.call(t.element[0],i.currentItem||i.element)&&e.ui.intersect(i,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(r=!0,!1):void 0}),r?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(i)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,t,i){if(!t.offset)return!1;var r,o,s=(e.positionAbs||e.position.absolute).left,a=(e.positionAbs||e.position.absolute).top,l=s+e.helperProportions.width,c=a+e.helperProportions.height,u=t.offset.left,h=t.offset.top,d=u+t.proportions().width,p=h+t.proportions().height;switch(i){case"fit":return s>=u&&d>=l&&a>=h&&p>=c;case"intersect":return u<s+e.helperProportions.width/2&&l-e.helperProportions.width/2<d&&h<a+e.helperProportions.height/2&&c-e.helperProportions.height/2<p;case"pointer":return r=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,o=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,n(o,h,t.proportions().height)&&n(r,u,t.proportions().width);case"touch":return(a>=h&&p>=a||c>=h&&p>=c||h>a&&c>p)&&(s>=u&&d>=s||l>=u&&d>=l||u>s&&l>d);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var i,r,o=e.ui.ddmanager.droppables[t.options.scope]||[],s=n?n.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(i=0;i<o.length;i++)if(!(o[i].options.disabled||t&&!o[i].accept.call(o[i].element[0],t.currentItem||t.element))){for(r=0;r<a.length;r++)if(a[r]===o[i].element[0]){o[i].proportions().height=0;continue e}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===s&&o[i]._activate.call(o[i],n),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(t,n){var i=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(i=this._drop.call(this,n)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))}),i},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,r,o,s=e.ui.intersect(t,this,this.options.tolerance),a=!s&&this.isover?"isout":s&&!this.isover?"isover":null;a&&(this.options.greedy&&(r=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===r}),o.length&&(i=e.data(o[0],"ui-droppable"),i.greedyChild="isover"===a)),i&&"isover"===a&&(i.isover=!1,i.isout=!0,i._out.call(i,n)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,n),i&&"isout"===a&&(i.isout=!1,i.isover=!0,i._over.call(i,n)))}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e,t){var n="ui-effects-";e.effects={effect:{}},function(e,t){function n(e,t,n){var i=h[t.type]||{};return null==e?n||!t.def?null:t.def:(e=i.floor?~~e:parseFloat(e),isNaN(e)?t.def:i.mod?(e+i.mod)%i.mod:0>e?0:i.max<e?i.max:e)}function i(t){var n=c(),i=n._rgba=[];return t=t.toLowerCase(),f(l,function(e,r){var o,s=r.re.exec(t),a=s&&r.parse(s),l=r.space||"rgba";return a?(o=n[l](a),n[u[l].cache]=o[u[l].cache],i=n._rgba=o._rgba,!1):void 0}),i.length?("0,0,0,0"===i.join()&&e.extend(i,o.transparent),n):o[t]}function r(e,t,n){return n=(n+1)%1,1>6*n?e+(t-e)*n*6:1>2*n?t:2>3*n?e+(t-e)*(2/3-n)*6:e}var o,s="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],c=e.Color=function(t,n,i,r){return new e.Color.fn.parse(t,n,i,r)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=c.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),c.fn=e.extend(c.prototype,{parse:function(r,s,a,l){if(r===t)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=e(r).css(s),s=t);var h=this,d=e.type(r),p=this._rgba=[];return s!==t&&(r=[r,s,a,l],d="array"),"string"===d?this.parse(i(r)||o._default):"array"===d?(f(u.rgba.props,function(e,t){p[t.idx]=n(r[t.idx],t)}),this):"object"===d?(r instanceof c?f(u,function(e,t){r[t.cache]&&(h[t.cache]=r[t.cache].slice())}):f(u,function(t,i){var o=i.cache;f(i.props,function(e,t){if(!h[o]&&i.to){if("alpha"===e||null==r[e])return;h[o]=i.to(h._rgba)}h[o][t.idx]=n(r[e],t,!0)}),h[o]&&e.inArray(null,h[o].slice(0,3))<0&&(h[o][3]=1,i.from&&(h._rgba=i.from(h[o])))}),this):void 0},is:function(e){var t=c(e),n=!0,i=this;return f(u,function(e,r){var o,s=t[r.cache];return s&&(o=i[r.cache]||r.to&&r.to(i._rgba)||[],f(r.props,function(e,t){return null!=s[t.idx]?n=s[t.idx]===o[t.idx]:void 0})),n}),n},_space:function(){var e=[],t=this;return f(u,function(n,i){t[i.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var i=c(e),r=i._space(),o=u[r],s=0===this.alpha()?c("transparent"):this,a=s[o.cache]||o.to(s._rgba),l=a.slice();return i=i[o.cache],f(o.props,function(e,r){var o=r.idx,s=a[o],c=i[o],u=h[r.type]||{};null!==c&&(null===s?l[o]=c:(u.mod&&(c-s>u.mod/2?s+=u.mod:s-c>u.mod/2&&(s-=u.mod)),l[o]=n((c-s)*t+s,r)))}),this[r](l)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),r=c(t)._rgba;return c(e.map(n,function(e,t){return(1-i)*r[t]+i*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),i=n.pop();return t&&n.push(~~(255*i)),"#"+e.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,i=e[0]/255,r=e[1]/255,o=e[2]/255,s=e[3],a=Math.max(i,r,o),l=Math.min(i,r,o),c=a-l,u=a+l,h=.5*u;return t=l===a?0:i===a?60*(r-o)/c+360:r===a?60*(o-i)/c+120:60*(i-r)/c+240,n=0===c?0:.5>=h?c/u:c/(2-u),[Math.round(t)%360,n,h,null==s?1:s]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],i=e[2],o=e[3],s=.5>=i?i*(1+n):i+n-i*n,a=2*i-s;return[Math.round(255*r(a,s,t+1/3)),Math.round(255*r(a,s,t)),Math.round(255*r(a,s,t-1/3)),o]},f(u,function(i,r){var o=r.props,s=r.cache,l=r.to,u=r.from;c.fn[i]=function(i){if(l&&!this[s]&&(this[s]=l(this._rgba)),i===t)return this[s].slice();var r,a=e.type(i),h="array"===a||"object"===a?i:arguments,d=this[s].slice();return f(o,function(e,t){var i=h["object"===a?e:t.idx];null==i&&(i=d[t.idx]),d[t.idx]=n(i,t)}),u?(r=c(u(d)),r[s]=d,r):c(d)},f(o,function(t,n){c.fn[t]||(c.fn[t]=function(r){var o,s=e.type(r),l="alpha"===t?this._hsla?"hsla":"rgba":i,c=this[l](),u=c[n.idx];return"undefined"===s?u:("function"===s&&(r=r.call(this,u),s=e.type(r)),null==r&&n.empty?this:("string"===s&&(o=a.exec(r),o&&(r=u+parseFloat(o[2])*("+"===o[1]?1:-1))),c[n.idx]=r,this[l](c)))})})}),c.hook=function(t){var n=t.split(" ");f(n,function(t,n){e.cssHooks[n]={set:function(t,r){var o,s,a="";if("transparent"!==r&&("string"!==e.type(r)||(o=i(r)))){if(r=c(o||r),!d.rgba&&1!==r._rgba[3]){for(s="backgroundColor"===n?t.parentNode:t;(""===a||"transparent"===a)&&s&&s.style;)try{a=e.css(s,"backgroundColor"),s=s.parentNode}catch(l){}r=r.blend(a&&"transparent"!==a?a:"_default")}r=r.toRgbaString()}try{t.style[n]=r}catch(l){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=c(t.elem,n),t.end=c(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},c.hook(s),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(n,i){t["border"+i+"Color"]=e}),t}},o=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(t){var n,i,r=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,o={};if(r&&r.length&&r[0]&&r[r[0]])for(i=r.length;i--;)n=r[i],"string"==typeof r[n]&&(o[e.camelCase(n)]=r[n]);else for(n in r)"string"==typeof r[n]&&(o[n]=r[n]);return o}function i(t,n){var i,r,s={};for(i in n)r=n[i],t[i]!==r&&(o[i]||(e.fx.step[i]||!isNaN(parseFloat(r)))&&(s[i]=r));return s}var r=["add","remove","toggle"],o={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,n,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,o,s,a){var l=e.speed(o,s,a);return this.queue(function(){var o,s=e(this),a=s.attr("class")||"",c=l.children?s.find("*").addBack():s;c=c.map(function(){var t=e(this);return{el:t,start:n(this)}}),o=function(){e.each(r,function(e,n){t[n]&&s[n+"Class"](t[n])})},o(),c=c.map(function(){return this.end=n(this.el[0]),this.diff=i(this.start,this.end),this}),s.attr("class",a),c=c.map(function(){var t=this,n=e.Deferred(),i=e.extend({},l,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,i),n.promise()}),e.when.apply(e,c.get()).done(function(){o(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),l.complete.call(s[0])})})},e.fn.extend({addClass:function(t){return function(n,i,r,o){return i?e.effects.animateClass.call(this,{add:n},i,r,o):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(n,i,r,o){return arguments.length>1?e.effects.animateClass.call(this,{remove:n},i,r,o):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(n){return function(i,r,o,s,a){return"boolean"==typeof r||r===t?o?e.effects.animateClass.call(this,r?{add:i}:{remove:i},o,s,a):n.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},r,o,s)}}(e.fn.toggleClass),switchClass:function(t,n,i,r,o){return e.effects.animateClass.call(this,{add:n,remove:t},i,r,o)}})}(),function(){function i(t,n,i,r){return e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},null==n&&(n={}),e.isFunction(n)&&(r=n,i=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(r=i,i=n,n={}),e.isFunction(i)&&(r=i,i=null),n&&e.extend(t,n),i=i||n.duration,t.duration=e.fx.off?0:"number"==typeof i?i:i in e.fx.speeds?e.fx.speeds[i]:e.fx.speeds._default,t.complete=r||n.complete,t}function r(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.10.4",save:function(e,t){for(var i=0;i<t.length;i++)null!==t[i]&&e.data(n+t[i],e[0].style[t[i]])},restore:function(e,i){var r,o;for(o=0;o<i.length;o++)null!==i[o]&&(r=e.data(n+i[o]),r===t&&(r=""),e.css(i[o],r))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,i;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=e[1]/t.width}return{x:i,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},i=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r={width:t.width(),height:t.height()},o=document.activeElement;try{o.id}catch(s){o=document.body}return t.wrap(i),(t[0]===o||e.contains(t[0],o))&&e(o).focus(),i=t.parent(),"static"===t.css("position")?(i.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,i){n[i]=t.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(r),i.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,i,r){return r=r||{},e.each(n,function(e,n){var o=t.cssUnit(n);o[0]>0&&(r[n]=o[0]*i+o[1])}),r}}),e.fn.extend({effect:function(){function t(t){function i(){e.isFunction(o)&&o.call(r[0]),e.isFunction(t)&&t()}var r=e(this),o=n.complete,a=n.mode;(r.is(":hidden")?"hide"===a:"show"===a)?(r[a](),i()):s.call(r[0],n,i)}var n=i.apply(this,arguments),r=n.mode,o=n.queue,s=e.effects.effect[n.effect];return e.fx.off||!s?r?this[r](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):o===!1?this.each(t):this.queue(o||"fx",t)},show:function(e){return function(t){if(r(t))return e.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(t){if(r(t))return e.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(t){if(r(t)||"boolean"==typeof t)return e.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var n=this.css(t),i=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(i=[parseFloat(n),t])}),i}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?n(2*e)/2:1-n(-2*e+2)/2}})}()}(jQuery),function(e,t){var n=/up|down|vertical/,i=/up|left|vertical|horizontal/;e.effects.effect.blind=function(t,r){var o,s,a,l=e(this),c=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(l,t.mode||"hide"),h=t.direction||"up",d=n.test(h),p=d?"height":"width",f=d?"top":"left",g=i.test(h),m={},v="show"===u;l.parent().is(".ui-effects-wrapper")?e.effects.save(l.parent(),c):e.effects.save(l,c),l.show(),o=e.effects.createWrapper(l).css({overflow:"hidden"}),s=o[p](),a=parseFloat(o.css(f))||0,m[p]=v?s:0,g||(l.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),m[f]=v?a:s+a),v&&(o.css(p,0),g||o.css(f,a+s)),o.animate(m,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&l.hide(),e.effects.restore(l,c),e.effects.removeWrapper(l),r()}})}}(jQuery),function(e,t){e.effects.effect.bounce=function(t,n){var i,r,o,s=e(this),a=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(s,t.mode||"effect"),c="hide"===l,u="show"===l,h=t.direction||"up",d=t.distance,p=t.times||5,f=2*p+(u||c?1:0),g=t.duration/f,m=t.easing,v="up"===h||"down"===h?"top":"left",b="up"===h||"left"===h,y=s.queue(),w=y.length;for((u||c)&&a.push("opacity"),e.effects.save(s,a),s.show(),e.effects.createWrapper(s),d||(d=s["top"===v?"outerHeight":"outerWidth"]()/3),u&&(o={opacity:1},o[v]=0,s.css("opacity",0).css(v,b?2*-d:2*d).animate(o,g,m)),c&&(d/=Math.pow(2,p-1)),o={},o[v]=0,i=0;p>i;i++)r={},r[v]=(b?"-=":"+=")+d,s.animate(r,g,m).animate(o,g,m),d=c?2*d:d/2;c&&(r={opacity:0},r[v]=(b?"-=":"+=")+d,s.animate(r,g,m)),s.queue(function(){c&&s.hide(),e.effects.restore(s,a),e.effects.removeWrapper(s),n()}),w>1&&y.splice.apply(y,[1,0].concat(y.splice(w,f+1))),s.dequeue()}}(jQuery),function(e,t){e.effects.effect.clip=function(t,n){var i,r,o,s=e(this),a=["position","top","bottom","left","right","height","width"],l=e.effects.setMode(s,t.mode||"hide"),c="show"===l,u=t.direction||"vertical",h="vertical"===u,d=h?"height":"width",p=h?"top":"left",f={};e.effects.save(s,a),s.show(),i=e.effects.createWrapper(s).css({overflow:"hidden"}),r="IMG"===s[0].tagName?i:s,o=r[d](),c&&(r.css(d,0),r.css(p,o/2)),f[d]=c?o:0,f[p]=c?0:o/2,r.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){c||s.hide(),e.effects.restore(s,a),e.effects.removeWrapper(s),n()}})}}(jQuery),function(e,t){e.effects.effect.drop=function(t,n){var i,r=e(this),o=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),a="show"===s,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l?"pos":"neg",h={opacity:a?1:0};e.effects.save(r,o),r.show(),e.effects.createWrapper(r),i=t.distance||r["top"===c?"outerHeight":"outerWidth"](!0)/2,a&&r.css("opacity",0).css(c,"pos"===u?-i:i),h[c]=(a?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+i,r.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide(),e.effects.restore(r,o),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.explode=function(t,n){function i(){y.push(this),y.length===h*d&&r()}function r(){p.css({visibility:"visible"}),e(y).remove(),g||p.hide(),n()}var o,s,a,l,c,u,h=t.pieces?Math.round(Math.sqrt(t.pieces)):3,d=h,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),g="show"===f,m=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),b=Math.ceil(p.outerHeight()/h),y=[];for(o=0;h>o;o++)for(l=m.top+o*b,u=o-(h-1)/2,s=0;d>s;s++)a=m.left+s*v,c=s-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*v,top:-o*b}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:b,left:a+(g?c*v:0),top:l+(g?u*b:0),opacity:g?0:1}).animate({left:a+(g?0:c*v),top:l+(g?0:u*b),opacity:g?1:0},t.duration||500,t.easing,i)}}(jQuery),function(e,t){e.effects.effect.fade=function(t,n){var i=e(this),r=e.effects.setMode(i,t.mode||"toggle");i.animate({opacity:r},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e,t){e.effects.effect.fold=function(t,n){var i,r,o=e(this),s=["position","top","bottom","left","right","height","width"],a=e.effects.setMode(o,t.mode||"hide"),l="show"===a,c="hide"===a,u=t.size||15,h=/([0-9]+)%/.exec(u),d=!!t.horizFirst,p=l!==d,f=p?["width","height"]:["height","width"],g=t.duration/2,m={},v={};e.effects.save(o,s),o.show(),i=e.effects.createWrapper(o).css({overflow:"hidden"}),r=p?[i.width(),i.height()]:[i.height(),i.width()],h&&(u=parseInt(h[1],10)/100*r[c?0:1]),l&&i.css(d?{height:0,width:u}:{height:u,width:0}),m[f[0]]=l?r[0]:u,v[f[1]]=l?r[1]:0,i.animate(m,g,t.easing).animate(v,g,t.easing,function(){c&&o.hide(),e.effects.restore(o,s),e.effects.removeWrapper(o),n()})}}(jQuery),function(e,t){e.effects.effect.highlight=function(t,n){var i=e(this),r=["backgroundImage","backgroundColor","opacity"],o=e.effects.setMode(i,t.mode||"show"),s={backgroundColor:i.css("backgroundColor")};"hide"===o&&(s.opacity=0),e.effects.save(i,r),i.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(s,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&i.hide(),e.effects.restore(i,r),n()}})}}(jQuery),function(e,t){e.effects.effect.pulsate=function(t,n){var i,r=e(this),o=e.effects.setMode(r,t.mode||"show"),s="show"===o,a="hide"===o,l=s||"hide"===o,c=2*(t.times||5)+(l?1:0),u=t.duration/c,h=0,d=r.queue(),p=d.length;for((s||!r.is(":visible"))&&(r.css("opacity",0).show(),h=1),i=1;c>i;i++)r.animate({opacity:h},u,t.easing),h=1-h;r.animate({opacity:h},u,t.easing),r.queue(function(){a&&r.hide(),n()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,c+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.puff=function(t,n){var i=e(this),r=e.effects.setMode(i,t.mode||"hide"),o="hide"===r,s=parseInt(t.percent,10)||150,a=s/100,l={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:r,complete:n,percent:o?s:100,from:o?l:{height:l.height*a,width:l.width*a,outerHeight:l.outerHeight*a,outerWidth:l.outerWidth*a}}),i.effect(t)},e.effects.effect.scale=function(t,n){var i=e(this),r=e.extend(!0,{},t),o=e.effects.setMode(i,t.mode||"effect"),s=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===o?0:100),a=t.direction||"both",l=t.origin,c={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()},u={y:"horizontal"!==a?s/100:1,x:"vertical"!==a?s/100:1};r.effect="size",r.queue=!1,r.complete=n,"effect"!==o&&(r.origin=l||["middle","center"],r.restore=!0),r.from=t.from||("show"===o?{height:0,width:0,outerHeight:0,outerWidth:0}:c),r.to={height:c.height*u.y,width:c.width*u.x,outerHeight:c.outerHeight*u.y,outerWidth:c.outerWidth*u.x},r.fade&&("show"===o&&(r.from.opacity=0,r.to.opacity=1),"hide"===o&&(r.from.opacity=1,r.to.opacity=0)),i.effect(r)},e.effects.effect.size=function(t,n){var i,r,o,s=e(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],c=["width","height","overflow"],u=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(s,t.mode||"effect"),f=t.restore||"effect"!==p,g=t.scale||"both",m=t.origin||["middle","center"],v=s.css("position"),b=f?a:l,y={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&s.show(),i={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},"toggle"===t.mode&&"show"===p?(s.from=t.to||y,s.to=t.from||i):(s.from=t.from||("show"===p?y:i),s.to=t.to||("hide"===p?y:i)),o={from:{y:s.from.height/i.height,x:s.from.width/i.width},to:{y:s.to.height/i.height,x:s.to.width/i.width}},("box"===g||"both"===g)&&(o.from.y!==o.to.y&&(b=b.concat(h),s.from=e.effects.setTransition(s,h,o.from.y,s.from),s.to=e.effects.setTransition(s,h,o.to.y,s.to)),o.from.x!==o.to.x&&(b=b.concat(d),s.from=e.effects.setTransition(s,d,o.from.x,s.from),s.to=e.effects.setTransition(s,d,o.to.x,s.to))),("content"===g||"both"===g)&&o.from.y!==o.to.y&&(b=b.concat(u).concat(c),s.from=e.effects.setTransition(s,u,o.from.y,s.from),s.to=e.effects.setTransition(s,u,o.to.y,s.to)),e.effects.save(s,b),s.show(),e.effects.createWrapper(s),s.css("overflow","hidden").css(s.from),m&&(r=e.effects.getBaseline(m,i),s.from.top=(i.outerHeight-s.outerHeight())*r.y,s.from.left=(i.outerWidth-s.outerWidth())*r.x,s.to.top=(i.outerHeight-s.to.outerHeight)*r.y,s.to.left=(i.outerWidth-s.to.outerWidth)*r.x),s.css(s.from),("content"===g||"both"===g)&&(h=h.concat(["marginTop","marginBottom"]).concat(u),d=d.concat(["marginLeft","marginRight"]),c=a.concat(h).concat(d),s.find("*[width]").each(function(){var n=e(this),i={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};f&&e.effects.save(n,c),n.from={height:i.height*o.from.y,width:i.width*o.from.x,outerHeight:i.outerHeight*o.from.y,outerWidth:i.outerWidth*o.from.x},n.to={height:i.height*o.to.y,width:i.width*o.to.x,outerHeight:i.height*o.to.y,outerWidth:i.width*o.to.x},o.from.y!==o.to.y&&(n.from=e.effects.setTransition(n,h,o.from.y,n.from),n.to=e.effects.setTransition(n,h,o.to.y,n.to)),o.from.x!==o.to.x&&(n.from=e.effects.setTransition(n,d,o.from.x,n.from),n.to=e.effects.setTransition(n,d,o.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){f&&e.effects.restore(n,c)})})),s.animate(s.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===s.to.opacity&&s.css("opacity",s.from.opacity),"hide"===p&&s.hide(),e.effects.restore(s,b),f||("static"===v?s.css({position:"relative",top:s.to.top,left:s.to.left}):e.each(["top","left"],function(e,t){s.css(t,function(t,n){var i=parseInt(n,10),r=e?s.to.left:s.to.top;return"auto"===n?r+"px":i+r+"px"})})),e.effects.removeWrapper(s),n()}})}}(jQuery),function(e,t){e.effects.effect.shake=function(t,n){var i,r=e(this),o=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),a=t.direction||"left",l=t.distance||20,c=t.times||3,u=2*c+1,h=Math.round(t.duration/u),d="up"===a||"down"===a?"top":"left",p="up"===a||"left"===a,f={},g={},m={},v=r.queue(),b=v.length;for(e.effects.save(r,o),r.show(),e.effects.createWrapper(r),f[d]=(p?"-=":"+=")+l,g[d]=(p?"+=":"-=")+2*l,m[d]=(p?"-=":"+=")+2*l,r.animate(f,h,t.easing),i=1;c>i;i++)r.animate(g,h,t.easing).animate(m,h,t.easing);r.animate(g,h,t.easing).animate(f,h/2,t.easing).queue(function(){"hide"===s&&r.hide(),e.effects.restore(r,o),e.effects.removeWrapper(r),n()}),b>1&&v.splice.apply(v,[1,0].concat(v.splice(b,u+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.slide=function(t,n){var i,r=e(this),o=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),a="show"===s,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l,h={};e.effects.save(r,o),r.show(),i=t.distance||r["top"===c?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),a&&r.css(c,u?isNaN(i)?"-"+i:-i:i),h[c]=(a?u?"+=":"-=":u?"-=":"+=")+i,r.animate(h,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide(),e.effects.restore(r,o),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.transfer=function(t,n){var i=e(this),r=e(t.to),o="fixed"===r.css("position"),s=e("body"),a=o?s.scrollTop():0,l=o?s.scrollLeft():0,c=r.offset(),u={top:c.top-a,left:c.left-l,height:r.innerHeight(),width:r.innerWidth()},h=i.offset(),d=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:h.top-a,left:h.left-l,height:i.innerHeight(),width:i.innerWidth(),position:o?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){d.remove(),n()})}}(jQuery),function(e,t){e.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var n=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),n.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{
click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,r,o,s,a,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,r=this.previousFilter||"",o=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),o===r?s=!0:o=r+o,a=new RegExp("^"+n(o),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(e(this).children("a").text())}),i=s&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(o=String.fromCharCode(t.keyCode),a=new RegExp("^"+n(o),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(e(this).children("a").text())})),i.length?(this.focus(t,i),i.length>1?(this.previousFilter=o,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,i=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.prev("a"),r=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(r),t.attr("aria-labelledby",i.attr("id"))}),t=i.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var n,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&e&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,i,r,o,s,a;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,r=t.offset().top-this.activeMenu.offset().top-n-i,o=this.activeMenu.scrollTop(),s=this.activeMenu.height(),a=t.height(),0>r?this.activeMenu.scrollTop(o+r):r+a>s&&this.activeMenu.scrollTop(o+r-s+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var i=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this.activeMenu=i},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(n,i)},nextPage:function(t){var n,i,r;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i-r<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var n,i,r;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,r=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i+r>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.10.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,n=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(n.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(jQuery),function(e,t){function n(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,n,i,r,o,s=this,a=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},n=0;n<t.length;n++)i=e.trim(t[n]),o="ui-resizable-"+i,r=e("<div class='ui-resizable-handle "+o+"'></div>"),r.css({zIndex:a.zIndex}),"se"===i&&r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[i]=".ui-resizable-"+i,this.element.append(r);this._renderAxis=function(t){var n,i,r,o;t=t||this.element;for(n in this.handles)this.handles[n].constructor===String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(i=e(this.handles[n],this.element),o=/sw|ne|nw|se|n|s/.test(n)?i.outerHeight():i.outerWidth(),r=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(r,o),this._proportionallyResize()),e(this.handles[n]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){s.resizing||(this.className&&(r=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=r&&r[1]?r[1]:"se")}),a.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(e(this).removeClass("ui-resizable-autohide"),s._handles.show())}).mouseleave(function(){a.disabled||s.resizing||(e(this).addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,i,r=!1;for(n in this.handles)i=e(this.handles[n])[0],(i===t.target||e.contains(i,t.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(t){var i,r,o,s=this.options,a=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:a.top,left:a.left}),this._renderProxy(),i=n(this.helper.css("left")),r=n(this.helper.css("top")),s.containment&&(i+=e(s.containment).scrollLeft()||0,r+=e(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:r},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:i,top:r},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===o?this.axis+"-resize":o),l.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,i=this.helper,r={},o=this.originalMousePosition,s=this.axis,a=this.position.top,l=this.position.left,c=this.size.width,u=this.size.height,h=t.pageX-o.left||0,d=t.pageY-o.top||0,p=this._change[s];return p?(n=p.apply(this,[t,h,d]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==a&&(r.top=this.position.top+"px"),this.position.left!==l&&(r.left=this.position.left+"px"),this.size.width!==c&&(r.width=this.size.width+"px"),this.size.height!==u&&(r.height=this.size.height+"px"),i.css(r),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(r)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var n,i,r,o,s,a,l,c=this.options,u=this;return this._helper&&(n=this._proportionallyResizeElements,i=n.length&&/textarea/i.test(n[0].nodeName),r=i&&e.ui.hasScroll(n[0],"left")?0:u.sizeDiff.height,o=i?0:u.sizeDiff.width,s={width:u.helper.width()-o,height:u.helper.height()-r},a=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,l=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(e.extend(s,{top:l,left:a})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,r,o,s,a=this.options;s={minWidth:i(a.minWidth)?a.minWidth:0,maxWidth:i(a.maxWidth)?a.maxWidth:1/0,minHeight:i(a.minHeight)?a.minHeight:0,maxHeight:i(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||e)&&(t=s.minHeight*this.aspectRatio,r=s.minWidth/this.aspectRatio,n=s.maxHeight*this.aspectRatio,o=s.maxWidth/this.aspectRatio,t>s.minWidth&&(s.minWidth=t),r>s.minHeight&&(s.minHeight=r),n<s.maxWidth&&(s.maxWidth=n),o<s.maxHeight&&(s.maxHeight=o)),this._vBoundaries=s},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,r=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===r&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===r&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,r=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,s=i(e.width)&&t.minWidth&&t.minWidth>e.width,a=i(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,u=/sw|nw|w/.test(n),h=/nw|ne|n/.test(n);return s&&(e.width=t.minWidth),a&&(e.height=t.minHeight),r&&(e.width=t.maxWidth),o&&(e.height=t.maxHeight),s&&u&&(e.left=l-t.minWidth),r&&u&&(e.left=l-t.maxWidth),a&&h&&(e.top=c-t.minHeight),o&&h&&(e.top=c-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,n,i,r,o=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(r=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],n=[r.css("borderTopWidth"),r.css("borderRightWidth"),r.css("borderBottomWidth"),r.css("borderLeftWidth")],i=[r.css("paddingTop"),r.css("paddingRight"),r.css("paddingBottom"),r.css("paddingLeft")],t=0;t<n.length;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(i[t],10)||0);r.css({height:o.height()-this.borderDif[0]-this.borderDif[2]||0,width:o.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,i=this.originalPosition;return{left:i.left+t,width:n.width-t}},n:function(e,t,n){var i=this.originalSize,r=this.originalPosition;return{top:r.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},sw:function(t,n,i){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,i]))},ne:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,i]))},nw:function(t,n,i){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,i]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("ui-resizable"),i=n.options,r=n._proportionallyResizeElements,o=r.length&&/textarea/i.test(r[0].nodeName),s=o&&e.ui.hasScroll(r[0],"left")?0:n.sizeDiff.height,a=o?0:n.sizeDiff.width,l={width:n.size.width-a,height:n.size.height-s},c=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,u=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(l,u&&c?{top:u,left:c}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};r&&r.length&&e(r[0]).css({width:i.width,height:i.height}),n._updateCache(i),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,r,o,s,a,l,c=e(this).data("ui-resizable"),u=c.options,h=c.element,d=u.containment,p=d instanceof e?d.get(0):/parent/.test(d)?h.parent().get(0):d;p&&(c.containerElement=e(p),/document/.test(d)||d===document?(c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,r){i[e]=n(t.css("padding"+r))}),c.containerOffset=t.offset(),c.containerPosition=t.position(),c.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},r=c.containerOffset,o=c.containerSize.height,s=c.containerSize.width,a=e.ui.hasScroll(p,"left")?p.scrollWidth:s,l=e.ui.hasScroll(p)?p.scrollHeight:o,c.parentData={element:p,left:r.left,top:r.top,width:a,height:l}))},resize:function(t){var n,i,r,o,s=e(this).data("ui-resizable"),a=s.options,l=s.containerOffset,c=s.position,u=s._aspectRatio||t.shiftKey,h={top:0,left:0},d=s.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(h=l),c.left<(s._helper?l.left:0)&&(s.size.width=s.size.width+(s._helper?s.position.left-l.left:s.position.left-h.left),u&&(s.size.height=s.size.width/s.aspectRatio),s.position.left=a.helper?l.left:0),c.top<(s._helper?l.top:0)&&(s.size.height=s.size.height+(s._helper?s.position.top-l.top:s.position.top),u&&(s.size.width=s.size.height*s.aspectRatio),s.position.top=s._helper?l.top:0),s.offset.left=s.parentData.left+s.position.left,s.offset.top=s.parentData.top+s.position.top,n=Math.abs((s._helper?s.offset.left-h.left:s.offset.left-h.left)+s.sizeDiff.width),i=Math.abs((s._helper?s.offset.top-h.top:s.offset.top-l.top)+s.sizeDiff.height),r=s.containerElement.get(0)===s.element.parent().get(0),o=/relative|absolute/.test(s.containerElement.css("position")),r&&o&&(n-=Math.abs(s.parentData.left)),n+s.size.width>=s.parentData.width&&(s.size.width=s.parentData.width-n,u&&(s.size.height=s.size.width/s.aspectRatio)),i+s.size.height>=s.parentData.height&&(s.size.height=s.parentData.height-i,u&&(s.size.width=s.size.height*s.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),n=t.options,i=t.containerOffset,r=t.containerPosition,o=t.containerElement,s=e(t.helper),a=s.offset(),l=s.outerWidth()-t.sizeDiff.width,c=s.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(o.css("position"))&&e(this).css({left:a.left-r.left-i.left,width:l,height:c}),t._helper&&!n.animate&&/static/.test(o.css("position"))&&e(this).css({left:a.left-r.left-i.left,width:l,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,i=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof n.alsoResize||n.alsoResize.parentNode?i(n.alsoResize):n.alsoResize.length?(n.alsoResize=n.alsoResize[0],i(n.alsoResize)):e.each(n.alsoResize,function(e){i(e)})},resize:function(t,n){var i=e(this).data("ui-resizable"),r=i.options,o=i.originalSize,s=i.originalPosition,a={height:i.size.height-o.height||0,width:i.size.width-o.width||0,top:i.position.top-s.top||0,left:i.position.left-s.left||0},l=function(t,i){e(t).each(function(){var t=e(this),r=e(this).data("ui-resizable-alsoresize"),o={},s=i&&i.length?i:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(s,function(e,t){var n=(r[t]||0)+(a[t]||0);n&&n>=0&&(o[t]=n||null)}),t.css(o)})};"object"!=typeof r.alsoResize||r.alsoResize.nodeType?l(r.alsoResize):e.each(r.alsoResize,function(e,t){l(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),n=t.options,i=t.size,r=t.originalSize,o=t.originalPosition,s=t.axis,a="number"==typeof n.grid?[n.grid,n.grid]:n.grid,l=a[0]||1,c=a[1]||1,u=Math.round((i.width-r.width)/l)*l,h=Math.round((i.height-r.height)/c)*c,d=r.width+u,p=r.height+h,f=n.maxWidth&&n.maxWidth<d,g=n.maxHeight&&n.maxHeight<p,m=n.minWidth&&n.minWidth>d,v=n.minHeight&&n.minHeight>p;n.grid=a,m&&(d+=l),v&&(p+=c),f&&(d-=l),g&&(p-=c),/^(se|s|e)$/.test(s)?(t.size.width=d,t.size.height=p):/^(ne)$/.test(s)?(t.size.width=d,t.size.height=p,t.position.top=o.top-h):/^(sw)$/.test(s)?(t.size.width=d,t.size.height=p,t.position.left=o.left-u):(p-c>0?(t.size.height=p,t.position.top=o.top-h):(t.size.height=c,t.position.top=o.top+r.height-c),d-l>0?(t.size.width=d,t.position.left=o.left-u):(t.size.width=l,t.position.left=o.left+r.width-l))}})}(jQuery),function(e,t){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,n=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(n.options.filter,n.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this,i=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(i.filter,this.element[0]),this._trigger("start",t),e(i.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),i.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var i=e.data(this,"selectable-item");i.startselected=!0,t.metaKey||t.ctrlKey||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",t,{unselecting:i.element}))}),e(t.target).parents().addBack().each(function(){var i,r=e.data(this,"selectable-item");return r?(i=!t.metaKey&&!t.ctrlKey||!r.$element.hasClass("ui-selected"),r.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting"),r.unselecting=!i,r.selecting=i,r.selected=i,i?n._trigger("selecting",t,{selecting:r.element}):n._trigger("unselecting",t,{unselecting:r.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var n,i=this,r=this.options,o=this.opos[0],s=this.opos[1],a=t.pageX,l=t.pageY;return o>a&&(n=a,a=o,o=n),s>l&&(n=l,l=s,s=n),this.helper.css({left:o,top:s,width:a-o,height:l-s}),this.selectees.each(function(){var n=e.data(this,"selectable-item"),c=!1;n&&n.element!==i.element[0]&&("touch"===r.tolerance?c=!(n.left>a||n.right<o||n.top>l||n.bottom<s):"fit"===r.tolerance&&(c=n.left>o&&n.right<a&&n.top>s&&n.bottom<l),c?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,i._trigger("selecting",t,{selecting:n.element}))):(n.selecting&&((t.metaKey||t.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),i._trigger("unselecting",t,{unselecting:n.element}))),n.selected&&(t.metaKey||t.ctrlKey||n.startselected||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",t,{unselecting:n.element})))))}),!1}},_mouseStop:function(t){var n=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-unselecting"),i.unselecting=!1,i.startselected=!1,n._trigger("unselected",t,{unselected:i.element})}),e(".ui-selecting",this.element[0]).each(function(){var i=e.data(this,"selectable-item");i.$element.removeClass("ui-selecting").addClass("ui-selected"),i.selecting=!1,i.selected=!0,i.startselected=!0,n._trigger("selected",t,{selected:i.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,i=this.options,r=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",s=[];for(n=i.values&&i.values.length||1,r.length>n&&(r.slice(n).remove(),r=r.slice(0,n)),t=r.length;n>t;t++)s.push(o);this.handles=r.add(e(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),
this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(n+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,i,r,o,s,a,l,c,u=this,h=this.options;return h.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(n),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(i-u.values(t));(r>n||r===n&&(t===u._lastChangedValue||u.values(t)===h.min))&&(r=n,o=e(this),s=t)}),a=this._start(t,s),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=s,o.addClass("ui-state-active").focus(),l=o.offset(),c=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-l.left-o.width()/2,top:t.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,s,i),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,i,r,o;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),i=n/t,i>1&&(i=1),0>i&&(i=0),"vertical"===this.orientation&&(i=1-i),r=this._valueMax()-this._valueMin(),o=this._valueMin()+i*r,this._trimAlignValue(o)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var i,r,o;this.options.values&&this.options.values.length?(i=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>i||1===t&&i>n)&&(n=i),n!==this.values(t)&&(r=this.values(),r[t]=n,o=this._trigger("slide",e,{handle:this.handles[t],value:n,values:r}),i=this.values(t?0:1),o!==!1&&this.values(t,n))):n!==this.value()&&(o=this._trigger("slide",e,{handle:this.handles[t],value:n}),o!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,n){var i,r,o;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(i=this.options.values,r=arguments[0],o=0;o<i.length;o+=1)i[o]=this._trimAlignValue(r[o]),this._change(null,o);this._refreshValue()},_setOption:function(t,n){var i,r=0;switch("range"===t&&this.options.range===!0&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(r=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=0;r>i;i+=1)this._change(null,i);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,i;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(n=this.options.values.slice(),i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(n[i]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,i=e-n;return 2*Math.abs(n)>=t&&(i+=n>0?t:-t),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,i,r,o,s=this.options.range,a=this.options,l=this,c=this._animateOff?!1:a.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(i){n=(l.values(i)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[c?"animate":"css"](u,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===i&&l.range.stop(1,1)[c?"animate":"css"]({left:n+"%"},a.animate),1===i&&l.range[c?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:a.animate})):(0===i&&l.range.stop(1,1)[c?"animate":"css"]({bottom:n+"%"},a.animate),1===i&&l.range[c?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:a.animate}))),t=n}):(i=this.value(),r=this._valueMin(),o=this._valueMax(),n=o!==r?(i-r)/(o-r)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[c?"animate":"css"](u,a.animate),"min"===s&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:n+"%"},a.animate),"max"===s&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:a.animate}),"min"===s&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:n+"%"},a.animate),"max"===s&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(t){var i,r,o,s,a=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,a),i===!1))return}switch(s=this.options.step,r=o=this.options.values&&this.options.values.length?this.values(a):this.value(),t.keyCode){case e.ui.keyCode.HOME:o=this._valueMin();break;case e.ui.keyCode.END:o=this._valueMax();break;case e.ui.keyCode.PAGE_UP:o=this._trimAlignValue(r+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(r-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(r===this._valueMax())return;o=this._trimAlignValue(r+s);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(r===this._valueMin())return;o=this._trimAlignValue(r-s)}this._slide(t,a,o)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(e,t){function n(e,t,n){return e>t&&t+n>e}function i(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var i=null,r=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,o.widgetName+"-item")===o?(i=e(this),!1):void 0}),e.data(t.target,o.widgetName+"-item")===o&&(i=e(t.target)),i&&(!this.options.handle||n||(e(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(r=!0)}),r))?(this.currentItem=i,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,n,i){var r,o,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&"auto"!==s.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",s.cursor),this.storedStylesheet=e("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(o)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,i,r,o,s=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+s.scrollSpeed:t.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+s.scrollSpeed:t.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(t.pageY-e(document).scrollTop()<s.scrollSensitivity?a=e(document).scrollTop(e(document).scrollTop()-s.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<s.scrollSensitivity&&(a=e(document).scrollTop(e(document).scrollTop()+s.scrollSpeed)),t.pageX-e(document).scrollLeft()<s.scrollSensitivity?a=e(document).scrollLeft(e(document).scrollLeft()-s.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<s.scrollSensitivity&&(a=e(document).scrollLeft(e(document).scrollLeft()+s.scrollSpeed))),a!==!1&&e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(i=this.items[n],r=i.item[0],o=this._intersectsWithPointer(i),o&&i.instance===this.currentContainer&&r!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==r&&!e.contains(this.placeholder[0],r)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],r):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,r=this.placeholder.offset(),o=this.options.axis,s={};o&&"x"!==o||(s.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(s.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,r=i+this.helperProportions.height,o=e.left,s=o+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,u=this.offset.click.left,h="x"===this.options.axis||i+c>a&&l>i+c,d="y"===this.options.axis||t+u>o&&s>t+u,p=h&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<s&&a<i+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t="x"===this.options.axis||n(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||n(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=t&&i,o=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return r?this.floating?s&&"right"===s||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(e){var t=n(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=n(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&i||"left"===o&&!i:r&&("down"===r&&t||"up"===r&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function n(){a.push(this)}var i,r,o,s,a=[],l=[],c=this._connectWith();if(c&&t)for(i=c.length-1;i>=0;i--)for(o=e(c[i]),r=o.length-1;r>=0;r--)s=e.data(o[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&l.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=l.length-1;i>=0;i--)l[i][0].each(n);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,i,r,o,s,a,l,c,u=this.items,h=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(n=d.length-1;n>=0;n--)for(r=e(d[n]),i=r.length-1;i>=0;i--)o=e.data(r[i],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(h.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(n=h.length-1;n>=0;n--)for(s=h[n][1],a=h[n][0],i=0,c=a.length;c>i;i++)l=e(a[i]),l.data(this.widgetName+"-item",s),u.push({item:l,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,i,r,o;for(n=this.items.length-1;n>=0;n--)i=this.items[n],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=r.outerWidth(),i.height=r.outerHeight()),o=r.offset(),i.left=o.left,i.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)o=this.containers[n].element.offset(),this.containers[n].containerCache.left=o.left,this.containers[n].containerCache.top=o.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(n=i.placeholder,i.placeholder={element:function(){var i=t.currentItem[0].nodeName.toLowerCase(),r=e("<"+i+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===i?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(r)}):"img"===i&&r.attr("src",t.currentItem.attr("src")),n||r.css("visibility","hidden"),r},update:function(e,r){(!n||i.forcePlaceholderSize)&&(r.height()||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(i.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),i.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var r,o,s,a,l,c,u,h,d,p,f=null,g=null;for(r=this.containers.length-1;r>=0;r--)if(!e.contains(this.currentItem[0],this.containers[r].element[0]))if(this._intersectsWith(this.containers[r].containerCache)){if(f&&e.contains(this.containers[r].element[0],f.element[0]))continue;f=this.containers[r],g=r}else this.containers[r].containerCache.over&&(this.containers[r]._trigger("out",t,this._uiHash(this)),this.containers[r].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[g].containerCache.over||(this.containers[g]._trigger("over",t,this._uiHash(this)),this.containers[g].containerCache.over=1);else{for(s=1e4,a=null,p=f.floating||i(this.currentItem),l=p?"left":"top",c=p?"width":"height",u=this.positionAbs[l]+this.offset.click[l],o=this.items.length-1;o>=0;o--)e.contains(this.containers[g].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(!p||n(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height))&&(h=this.items[o].item.offset()[l],d=!1,Math.abs(h-u)>Math.abs(h+this.items[o][c]-u)&&(d=!0,h+=this.items[o][c]),Math.abs(h-u)<s&&(s=Math.abs(h-u),a=this.items[o],this.direction=d?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[g])return;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[g].element,!0),this._trigger("change",t,this._uiHash()),this.containers[g]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[g],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[g]._trigger("over",t,this._uiHash(this)),this.containers[g].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!i[0].style.width||n.forceHelperSize)&&i.width(this.currentItem.width()),(!i[0].style.height||n.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),("document"===r.containment||"window"===r.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===r.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===r.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(t=e(r.containment)[0],n=e(r.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(r[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:r.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:r.scrollLeft())*i}},_generatePosition:function(t){var n,i,r=this.options,o=t.pageX,s=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),r.grid&&(n=this.originalPageY+Math.round((s-this.originalPageY)/r.grid[1])*r.grid[1],s=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-r.grid[1]:n+r.grid[1]:n,i=this.originalPageX+Math.round((o-this.originalPageX)/r.grid[0])*r.grid[0],o=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-r.grid[0]:i+r.grid[0]:i)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!i)})},_clear:function(e,t){function n(e,t,n){return function(i){n._trigger(e,i,t._uiHash(t))}}this.reverting=!1;var i,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)t||r.push(n("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(n("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),
this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(i=0;i<r.length;i++)r[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.10.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,i){var r=n.attr(i);void 0!==r&&r.length&&(t[i]=r)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function n(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,n.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,i=e.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,n.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:n})===!1||(this._value(n),this.counter++)},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return-1===n?0:t.length-n-1},_adjustValue:function(e){var t,n,i=this.options;return t=null!==i.min?i.min:0,n=e-t,n=Math.round(n/i.step)*i.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),null!==i.max&&e>i.max?i.max:null!==i.min&&e<i.min?i.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var n=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(n))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;""!==e&&(n=this._parse(e),null!==n&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function n(){return++r}function i(e){return e=e.cloneNode(!1),e.hash.length>1&&decodeURIComponent(e.href.replace(o,""))===decodeURIComponent(location.href.replace(o,""))}var r=0,o=/#.*$/;e.widget("ui.tabs",{version:"1.10.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),n.active=this._initialActive(),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(n.active):e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,i=location.hash.substring(1);return null===t&&(i&&this.tabs.each(function(n,r){return e(r).attr("aria-controls")===i?(t=n,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=n?!1:0)),!n&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),i=this.tabs.index(n),r=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:i++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:r=!1,i--;break;case e.ui.keyCode.END:i=this.anchors.length-1;break;case e.ui.keyCode.HOME:i=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i===this.options.active?!1:i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,r),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){function i(){return t>r&&(t=0),0>t&&(t=r),t}for(var r=this.tabs.length-1;-1!==e.inArray(i(),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+n()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var o,s,a,l=e(r).uniqueId().attr("id"),c=e(r).closest("li"),u=c.attr("aria-controls");i(r)?(o=r.hash,s=t.element.find(t._sanitizeSelector(o))):(a=t._tabId(c),o="#"+a,s=t.element.find(o),s.length||(s=t._createPanel(a),s.insertAfter(t.panels[n-1]||t.tablist)),s.attr("aria-live","polite")),s.length&&(t.panels=t.panels.add(s)),u&&c.data("ui-tabs-aria-controls",u),c.attr({"aria-controls":o.substring(1),"aria-labelledby":l}),s.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n,i=0;n=this.tabs[i];i++)t===!0||-1!==e.inArray(i,t)?e(n).addClass("ui-state-disabled").attr("aria-disabled","true"):e(n).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,i=this.element.parent();"fill"===t?(n=i.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(n-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,i=this.active,r=e(t.currentTarget),o=r.closest("li"),s=o[0]===i[0],a=s&&n.collapsible,l=a?e():this._getPanelForTab(o),c=i.length?this._getPanelForTab(i):e(),u={oldTab:i,oldPanel:c,newTab:a?e():o,newPanel:l};t.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||s&&!n.collapsible||this._trigger("beforeActivate",t,u)===!1||(n.active=a?!1:this.tabs.index(o),this.active=s?e():o,this.xhr&&this.xhr.abort(),c.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(o),t),this._toggle(t,u))},_toggle:function(t,n){function i(){o.running=!1,o._trigger("activate",t,n)}function r(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),s.length&&o.options.show?o._show(s,o.options.show,i):(s.show(),i())}var o=this,s=n.newPanel,a=n.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),r()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),s.length&&a.length?n.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),s.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),n=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(n){var i=this.options.disabled;i!==!1&&(n===t?i=!1:(n=this._getIndex(n),i=e.isArray(i)?e.map(i,function(e){return e!==n?e:null}):e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(i))},disable:function(n){var i=this.options.disabled;if(i!==!0){if(n===t)i=!0;else{if(n=this._getIndex(n),-1!==e.inArray(n,i))return;i=e.isArray(i)?e.merge([n],i).sort():[n]}this._setupDisabled(i)}},load:function(t,n){t=this._getIndex(t);var r=this,o=this.tabs.eq(t),s=o.find(".ui-tabs-anchor"),a=this._getPanelForTab(o),l={tab:o,panel:a};i(s[0])||(this.xhr=e.ajax(this._ajaxSettings(s,n,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){a.html(e),r._trigger("load",n,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&r.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(t,n,i){var r=this;return{url:t.attr("href"),beforeSend:function(t,o){return r._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:o},i))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}})}(jQuery),function(e){function t(t,n){var i=(t.attr("aria-describedby")||"").split(/\s+/);i.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(i.join(" ")))}function n(t){var n=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),r=e.inArray(n,i);-1!==r&&i.splice(r,1),t.removeData("ui-tooltip-id"),i=e.trim(i.join(" ")),i?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")}var i=0;e.widget("ui.tooltip",{version:"1.10.4",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,n){var i=this;return"disabled"===t?(this[n?"_disable":"_enable"](),void(this.options[t]=n)):(this._super(t,n),void("content"===t&&e.each(this.tooltips,function(e,t){i._updateContent(t)})))},_disable:function(){var t=this;e.each(this.tooltips,function(n,i){var r=e.Event("blur");r.target=r.currentTarget=i[0],t.close(r,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=this,i=e(t?t.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&i.parents().each(function(){var t,i=e(this);i.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,n.close(t,!0)),i.attr("title")&&(i.uniqueId(),n.parents[this.id]={element:this,title:i.attr("title")},i.attr("title",""))}),this._updateContent(i,t))},_updateContent:function(e,t){var n,i=this.options.content,r=this,o=t?t.type:null;return"string"==typeof i?this._open(t,e,i):(n=i.call(e[0],function(n){e.data("ui-tooltip-open")&&r._delay(function(){t&&(t.type=o),this._open(t,e,n)})}),void(n&&this._open(t,e,n)))},_open:function(n,i,r){function o(e){c.of=e,s.is(":hidden")||s.position(c)}var s,a,l,c=e.extend({},this.options.position);if(r){if(s=this._find(i),s.length)return void s.find(".ui-tooltip-content").html(r);i.is("[title]")&&(n&&"mouseover"===n.type?i.attr("title",""):i.removeAttr("title")),s=this._tooltip(i),t(i,s.attr("id")),s.find(".ui-tooltip-content").html(r),this.options.track&&n&&/^mouse/.test(n.type)?(this._on(this.document,{mousemove:o}),o(n)):s.position(e.extend({of:i},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.show&&this.options.show.delay&&(l=this.delayedShow=setInterval(function(){s.is(":visible")&&(o(c.of),clearInterval(l))},e.fx.interval)),this._trigger("open",n,{tooltip:s}),a={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=i[0],this.close(n,!0)}},remove:function(){this._removeTooltip(s)}},n&&"mouseover"!==n.type||(a.mouseleave="close"),n&&"focusin"!==n.type||(a.focusout="close"),this._on(!0,i,a)}},close:function(t){var i=this,r=e(t?t.currentTarget:this.element),o=this._find(r);this.closing||(clearInterval(this.delayedShow),r.data("ui-tooltip-title")&&r.attr("title",r.data("ui-tooltip-title")),n(r),o.stop(!0),this._hide(o,this.options.hide,function(){i._removeTooltip(e(this))}),r.removeData("ui-tooltip-open"),this._off(r,"mouseleave focusout keyup"),r[0]!==this.element[0]&&this._off(r,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,n){e(n.element).attr("title",n.title),delete i.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:o}),this.closing=!1)},_tooltip:function(t){var n="ui-tooltip-"+i++,r=e("<div>").attr({id:n,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(r),r.appendTo(this.document[0].body),this.tooltips[n]=t,r},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(n,i){var r=e.Event("blur");r.target=r.currentTarget=i[0],t.close(r,!0),e("#"+n).remove(),i.data("ui-tooltip-title")&&(i.attr("title",i.data("ui-tooltip-title")),i.removeData("ui-tooltip-title"))})}})}(jQuery),function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}if(e.support.touch="ontouchend"in document,e.support.touch){var n,i=e.ui.mouse.prototype,r=i._mouseInit,o=i._mouseDestroy;i._touchStart=function(e){var i=this;!n&&i._mouseCapture(e.originalEvent.changedTouches[0])&&(n=!0,i._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},i._touchMove=function(e){n&&(this._touchMoved=!0,t(e,"mousemove"))},i._touchEnd=function(e){n&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),n=!1)},i._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),r.call(t)},i._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),o.call(t)}}}(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one("bsTransitionEnd",function(){n=!0});var r=function(){n||e(i).trigger(e.support.transition.end)};return setTimeout(r,t),this},e(function(){e.support.transition=t(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){return e(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),r=n.data("bs.alert");r||n.data("bs.alert",r=new i(this)),"string"==typeof t&&r[t].call(n)})}var n='[data-dismiss="alert"]',i=function(t){e(t).on("click",n,this.close)};i.VERSION="3.2.0",i.prototype.close=function(t){function n(){o.detach().trigger("closed.bs.alert").remove()}var i=e(this),r=i.attr("data-target");r||(r=i.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var o=e(r);t&&t.preventDefault(),o.length||(o=i.hasClass("alert")?i:i.parent()),o.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",n).emulateTransitionEnd(150):n())};var r=e.fn.alert;e.fn.alert=t,e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=r,this},e(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.button"),o="object"==typeof t&&t;r||i.data("bs.button",r=new n(this,o)),"toggle"==t?r.toggle():t&&r.setState(t)})}var n=function(t,i){this.$element=e(t),this.options=e.extend({},n.DEFAULTS,i),this.isLoading=!1};n.VERSION="3.2.0",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(t){var n="disabled",i=this.$element,r=i.is("input")?"val":"html",o=i.data();t+="Text",null==o.resetText&&i.data("resetText",i[r]()),i[r](null==o[t]?this.options[t]:o[t]),setTimeout(e.proxy(function(){"loadingText"==t?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");"radio"==n.prop("type")&&(n.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}e&&this.$element.toggleClass("active")};var i=e.fn.button;e.fn.button=t,e.fn.button.Constructor=n,e.fn.button.noConflict=function(){return e.fn.button=i,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var i=e(n.target);i.hasClass("btn")||(i=i.closest(".btn")),t.call(i,"toggle"),n.preventDefault()})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.carousel"),o=e.extend({},n.DEFAULTS,i.data(),"object"==typeof t&&t),s="string"==typeof t?t:o.slide;r||i.data("bs.carousel",r=new n(this,o)),"number"==typeof t?r.to(t):s?r[s]():o.interval&&r.pause().cycle()})}var n=function(t,n){this.$element=e(t).on("keydown.bs.carousel",e.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};n.VERSION="3.2.0",n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},n.prototype.keydown=function(e){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},n.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},n.prototype.to=function(t){var n=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){n.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(this.$items[t]))},n.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){return this.sliding?void 0:this.slide("next")},n.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},n.prototype.slide=function(t,n){var i=this.$element.find(".item.active"),r=n||i[t](),o=this.interval,s="next"==t?"left":"right",a="next"==t?"first":"last",l=this;if(!r.length){if(!this.options.wrap)return;r=this.$element.find(".item")[a]()}if(r.hasClass("active"))return this.sliding=!1;var c=r[0],u=e.Event("slide.bs.carousel",{relatedTarget:c,direction:s});if(this.$element.trigger(u),!u.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=e(this.$indicators.children()[this.getItemIndex(r)]);h&&h.addClass("active")}var d=e.Event("slid.bs.carousel",{relatedTarget:c,direction:s});return e.support.transition&&this.$element.hasClass("slide")?(r.addClass(t),r[0].offsetWidth,i.addClass(s),r.addClass(s),i.one("bsTransitionEnd",function(){r.removeClass([t,s].join(" ")).addClass("active"),i.removeClass(["active",s].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(d)},0)}).emulateTransitionEnd(1e3*i.css("transition-duration").slice(0,-1))):(i.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger(d)),o&&this.cycle(),this}};var i=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=n,e.fn.carousel.noConflict=function(){return e.fn.carousel=i,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(n){var i,r=e(this),o=e(r.attr("data-target")||(i=r.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var s=e.extend({},o.data(),r.data()),a=r.attr("data-slide-to");a&&(s.interval=!1),t.call(o,s),a&&o.data("bs.carousel").to(a),n.preventDefault()}}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var n=e(this);t.call(n,n.data())})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.collapse"),o=e.extend({},n.DEFAULTS,i.data(),"object"==typeof t&&t);!r&&o.toggle&&"show"==t&&(t=!t),r||i.data("bs.collapse",r=new n(this,o)),"string"==typeof t&&r[t]()})}var n=function(t,i){
this.$element=e(t),this.options=e.extend({},n.DEFAULTS,i),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};n.VERSION="3.2.0",n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var n=e.Event("show.bs.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){var i=this.$parent&&this.$parent.find("> .panel > .in");if(i&&i.length){var r=i.data("bs.collapse");if(r&&r.transitioning)return;t.call(i,"hide"),r||i.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var a=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(350)[o](this.$element[0][a])}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return e.support.transition?void this.$element[n](0).one("bsTransitionEnd",e.proxy(i,this)).emulateTransitionEnd(350):i.call(this)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var i=e.fn.collapse;e.fn.collapse=t,e.fn.collapse.Constructor=n,e.fn.collapse.noConflict=function(){return e.fn.collapse=i,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var i,r=e(this),o=r.attr("data-target")||n.preventDefault()||(i=r.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),s=e(o),a=s.data("bs.collapse"),l=a?"toggle":r.data(),c=r.attr("data-parent"),u=c&&e(c);a&&a.transitioning||(u&&u.find('[data-toggle="collapse"][data-parent="'+c+'"]').not(r).addClass("collapsed"),r[s.hasClass("in")?"addClass":"removeClass"]("collapsed")),t.call(s,l)})}(jQuery),+function(e){"use strict";function t(t){t&&3===t.which||(e(r).remove(),e(o).each(function(){var i=n(e(this)),r={relatedTarget:this};i.hasClass("open")&&(i.trigger(t=e.Event("hide.bs.dropdown",r)),t.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",r))}))}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&e(n);return i&&i.length?i:t.parent()}function i(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new s(this)),"string"==typeof t&&i[t].call(n)})}var r=".dropdown-backdrop",o='[data-toggle="dropdown"]',s=function(t){e(t).on("click.bs.dropdown",this.toggle)};s.VERSION="3.2.0",s.prototype.toggle=function(i){var r=e(this);if(!r.is(".disabled, :disabled")){var o=n(r),s=o.hasClass("open");if(t(),!s){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var a={relatedTarget:this};if(o.trigger(i=e.Event("show.bs.dropdown",a)),i.isDefaultPrevented())return;r.trigger("focus"),o.toggleClass("open").trigger("shown.bs.dropdown",a)}return!1}},s.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var i=e(this);if(t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled")){var r=n(i),s=r.hasClass("open");if(!s||s&&27==t.keyCode)return 27==t.which&&r.find(o).trigger("focus"),i.trigger("click");var a=" li:not(.divider):visible a",l=r.find('[role="menu"]'+a+', [role="listbox"]'+a);if(l.length){var c=l.index(l.filter(":focus"));38==t.keyCode&&c>0&&c--,40==t.keyCode&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var a=e.fn.dropdown;e.fn.dropdown=i,e.fn.dropdown.Constructor=s,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=a,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",o,s.prototype.toggle).on("keydown.bs.dropdown.data-api",o+', [role="menu"], [role="listbox"]',s.prototype.keydown)}(jQuery),+function(e){"use strict";function t(t,i){return this.each(function(){var r=e(this),o=r.data("bs.modal"),s=e.extend({},n.DEFAULTS,r.data(),"object"==typeof t&&t);o||r.data("bs.modal",o=new n(this,s)),"string"==typeof t?o[t](i):s.show&&o.show(i)})}var n=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.2.0",n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},n.prototype.show=function(t){var n=this,i=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),i&&n.$element[0].offsetWidth,n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var r=e.Event("shown.bs.modal",{relatedTarget:t});i?n.$element.find(".modal-dialog").one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(r)}).emulateTransitionEnd(300):n.$element.trigger("focus").trigger(r)}))},n.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},n.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},n.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(t){var n=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&i;if(this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(150):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){n.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(150):o()}else t&&t()},n.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},n.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},n.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var i=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=n,e.fn.modal.noConflict=function(){return e.fn.modal=i,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=e(this),r=i.attr("href"),o=e(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=o.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},o.data(),i.data());i.is("a")&&n.preventDefault(),o.one("show.bs.modal",function(e){e.isDefaultPrevented()||o.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),t.call(o,s,this)})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.tooltip"),o="object"==typeof t&&t;(r||"destroy"!=t)&&(r||i.data("bs.tooltip",r=new n(this,o)),"string"==typeof t&&r[t]())})}var n=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};n.VERSION="3.2.0",n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(t,n,i){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var r=this.options.trigger.split(" "),o=r.length;o--;){var s=r[o];if("click"==s)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focusin",l="hover"==s?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},n.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},n.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show()},n.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},n.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var n=e.contains(document.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!n)return;var i=this,r=this.tip(),o=this.getUID(this.type);this.setContent(),r.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&r.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,l=a.test(s);l&&(s=s.replace(a,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var c=this.getPosition(),u=r[0].offsetWidth,h=r[0].offsetHeight;if(l){var d=s,p=this.$element.parent(),f=this.getPosition(p);s="bottom"==s&&c.top+c.height+h-f.scroll>f.height?"top":"top"==s&&c.top-f.scroll-h<0?"bottom":"right"==s&&c.right+u>f.width?"left":"left"==s&&c.left-u<f.left?"right":s,r.removeClass(d).addClass(s)}var g=this.getCalculatedOffset(s,c,u,h);this.applyPlacement(g,s);var m=function(){i.$element.trigger("shown.bs."+i.type),i.hoverState=null};e.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",m).emulateTransitionEnd(150):m()}},n.prototype.applyPlacement=function(t,n){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,s=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),t.top=t.top+s,t.left=t.left+a,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var l=i[0].offsetWidth,c=i[0].offsetHeight;"top"==n&&c!=o&&(t.top=t.top+o-c);var u=this.getViewportAdjustedDelta(n,t,l,c);u.left?t.left+=u.left:t.top+=u.top;var h=u.left?2*u.left-r+l:2*u.top-o+c,d=u.left?"left":"top",p=u.left?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(h,i[0][p],d)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},n.prototype.hide=function(){function t(){"in"!=n.hoverState&&i.detach(),n.$element.trigger("hidden.bs."+n.type)}var n=this,i=this.tip(),r=e.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(r),r.isDefaultPrevented()?void 0:(i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],i="BODY"==n.tagName;return e.extend({},"function"==typeof n.getBoundingClientRect?n.getBoundingClientRect():null,{scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:i?e(window).width():t.outerWidth(),height:i?e(window).height():t.outerHeight()},i?{top:0,left:0}:t.offset())},n.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);if(/right|left/.test(e)){var a=t.top-o-s.scroll,l=t.top+o-s.scroll+i;a<s.top?r.top=s.top-a:l>s.top+s.height&&(r.top=s.top+s.height-l)}else{var c=t.left-o,u=t.left+o+n;c<s.left?r.left=s.left-c:u>s.width&&(r.left=s.left+s.width-u)}return r},n.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},n.prototype.getUID=function(e){do e+=~~(1e6*Math.random());while(document.getElementById(e));return e},n.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=n,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.popover"),o="object"==typeof t&&t;(r||"destroy"!=t)&&(r||i.data("bs.popover",r=new n(this,o)),"string"==typeof t&&r[t]())})}var n=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.2.0",n.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},n.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=n,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),+function(e){"use strict";function t(n,i){var r=e.proxy(this.process,this);this.$body=e("body"),this.$scrollElement=e(e(n).is("body")?window:n),this.options=e.extend({},t.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",r),this.refresh(),this.process()}function n(n){return this.each(function(){var i=e(this),r=i.data("bs.scrollspy"),o="object"==typeof n&&n;r||i.data("bs.scrollspy",r=new t(this,o)),"string"==typeof n&&r[n]()})}t.VERSION="3.2.0",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",n=0;e.isWindow(this.$scrollElement[0])||(t="position",n=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var i=this;this.$body.find(this.selector).map(function(){var i=e(this),r=i.data("target")||i.attr("href"),o=/^#./.test(r)&&e(r);return o&&o.length&&o.is(":visible")&&[[o[t]().top+n,r]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),r=this.offsets,o=this.targets,s=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),t>=i)return s!=(e=o[o.length-1])&&this.activate(e);if(s&&t<=r[0])return s!=(e=o[0])&&this.activate(e);for(e=r.length;e--;)s!=o[e]&&t>=r[e]&&(!r[e+1]||t<=r[e+1])&&this.activate(o[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=e(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")};var i=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=i,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.tab");r||i.data("bs.tab",r=new n(this)),"string"==typeof t&&r[t]()})}var n=function(t){this.element=e(t)};n.VERSION="3.2.0",n.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),i=t.data("target");if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var r=n.find(".active:last a")[0],o=e.Event("show.bs.tab",{relatedTarget:r});if(t.trigger(o),!o.isDefaultPrevented()){var s=e(i);this.activate(t.closest("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:r})})}}},n.prototype.activate=function(t,n,i){function r(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),i&&i()}var o=n.find("> .active"),s=i&&e.support.transition&&o.hasClass("fade");s?o.one("bsTransitionEnd",r).emulateTransitionEnd(150):r(),o.removeClass("in")};var i=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=n,e.fn.tab.noConflict=function(){return e.fn.tab=i,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(n){n.preventDefault(),t.call(e(this),"show")})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.affix"),o="object"==typeof t&&t;r||i.data("bs.affix",r=new n(this,o)),"string"==typeof t&&r[t]()})}var n=function(t,i){this.options=e.extend({},n.DEFAULTS,i),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.2.0",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},n.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=e(document).height(),i=this.$target.scrollTop(),r=this.$element.offset(),o=this.options.offset,s=o.top,a=o.bottom;"object"!=typeof o&&(a=s=o),"function"==typeof s&&(s=o.top(this.$element)),"function"==typeof a&&(a=o.bottom(this.$element));var l=null!=this.unpin&&i+this.unpin<=r.top?!1:null!=a&&r.top+this.$element.height()>=t-a?"bottom":null!=s&&s>=i?"top":!1;if(this.affixed!==l){null!=this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),u=e.Event(c+".bs.affix");this.$element.trigger(u),u.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(c).trigger(e.Event(c.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:t-this.$element.height()-a}))}}};var i=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=n,e.fn.affix.noConflict=function(){return e.fn.affix=i,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var n=e(this),i=n.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),t.call(n,i)})})}(jQuery),function(e){"use strict";"function"==typeof define&&define.amd?define([],function(){return e(window,document)}):"undefined"!=typeof exports?module.exports=e(window,document):window.wysiwyg=e(window,document)}(function(e,t){"use strict";var n=function(e,t,n){var i;return function(){if(i){if(!n)return;clearTimeout(i)}var r=this,o=arguments;i=setTimeout(function(){i=null,e.apply(r,o)},t)}},i=function(t,n,i,r){t.addEventListener?t.addEventListener(n,i,r?!0:!1):t.attachEvent?t.attachEvent("on"+n,i):t!=e&&(t["on"+n]=i)},r=function(t,n,i,r){t.removeEventListener?t.removeEventListener(n,i,r?!0:!1):t.detachEvent?t.detachEvent("on"+n,i):t!=e&&(t["on"+n]=null)},o=function(e,n,i,r){if(t.createEvent){var o=t.createEvent("Event");o.initEvent(n,void 0!==i?i:!0,void 0!==r?r:!1),e.dispatchEvent(o)}else if(t.createEventObject){var o=t.createEventObject();e.fireEvent("on"+n,o)}else"function"==typeof e["on"+n]&&e["on"+n]()},s=function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1},a="undefined"!=typeof Node?Node.ELEMENT_NODE:1,l="undefined"!=typeof Node?Node.TEXT_NODE:3,c=function(e,t){for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1},u=function(e,t){if(e.firstChild)return e.firstChild;for(;e;){if(e==t)return null;if(e.nextSibling)return e.nextSibling;e=e.parentNode}return null},h=function(n){if(e.getSelection){var i=e.getSelection();if(i.rangeCount>0)return i.getRangeAt(0)}else if(t.selection){var i=t.selection;return i.createRange()}return null},d=function(n,i){if(i)if(e.getSelection){var r=e.getSelection();r.removeAllRanges(),r.addRange(i)}else t.selection&&i.select()},p=function(){if(e.getSelection){var n=e.getSelection();if(!n.rangeCount)return!1;var i=n.getRangeAt(0).cloneRange();if(i.getBoundingClientRect){var r=i.getBoundingClientRect();if(r&&r.left&&r.top&&r.right&&r.bottom)return{left:parseInt(r.left),top:parseInt(r.top),width:parseInt(r.right-r.left),height:parseInt(r.bottom-r.top)};for(var o=i.getClientRects?i.getClientRects():[],s=0;s<o.length;++s){var r=o[s];if(r.left&&r.top&&r.right&&r.bottom)return{left:parseInt(r.left),top:parseInt(r.top),width:parseInt(r.right-r.left),height:parseInt(r.bottom-r.top)}}}}else if(t.selection){var n=t.selection;if("Control"!=n.type){var i=n.createRange();if(i.boundingLeft||i.boundingTop||i.boundingWidth||i.boundingHeight)return{left:i.boundingLeft,top:i.boundingTop,width:i.boundingWidth,height:i.boundingHeight}}}return!1},f=function(n){if(e.getSelection){var i=e.getSelection();return i.isCollapsed?!0:!1}if(t.selection){var i=t.selection;if("Text"==i.type){var r=t.selection.createRange(),o=t.body.createTextRange();return o.moveToElementText(n),o.setEndPoint("EndToStart",r),0==r.htmlText.length}if("Control"==i.type)return!1}return!0},g=function(n){if(e.getSelection){var i=e.getSelection();if(!i.rangeCount)return[];for(var r=[],o=0;o<i.rangeCount;++o)for(var s=i.getRangeAt(o),l=s.startContainer,h=s.endContainer;l;){if(l!=n){var d=!1;if(i.containsNode)d=i.containsNode(l,!0);else{var p=t.createRange();p.selectNodeContents(l);for(var o=0;o<i.rangeCount;++o){var s=i.getRangeAt(o);if(s.compareBoundaryPoints(s.END_TO_START,p)>=0&&s.compareBoundaryPoints(s.START_TO_END,p)<=0){d=!0;break}}}d&&r.push(l)}l=u(l,l==h?h:n)}return 0==r.length&&c(n,i.focusNode)&&i.focusNode!=n&&r.push(i.focusNode),r}if(t.selection){var i=t.selection;if("Text"==i.type){for(var r=[],f=i.createRangeCollection(),o=0;o<f.length;++o)for(var s=f[o],g=s.parentElement(),l=g;l;){var p=s.duplicate();if(p.moveToElementText(l.nodeType!=a?l.parentNode:l),p.compareEndPoints("EndToStart",s)>=0&&p.compareEndPoints("StartToEnd",s)<=0){for(var m=!1,v=0;v<r.length;++v)if(r[v]===l){m=!0;break}m||r.push(l)}l=u(l,g)}return 0==r.length&&c(n,t.activeElement)&&t.activeElement!=n&&r.push(t.activeElement),r}if("Control"==i.type){for(var r=[],s=i.createRange(),o=0;o<s.length;++o)r.push(s(o));return r}}return[]},m=function(){if(e.getSelection){var n=e.getSelection();if(!n.isCollapsed)try{n.collapseToEnd()}catch(i){}}else if(t.selection){var n=t.selection;if("Control"!=n.type){var r=n.createRange();r.collapse(!1),r.select()}}},v=function(n,i,r){if(e.getSelection){var o=e.getSelection();if(o.modify){for(var s=0;i>s;++s)o.modify("extend","backward","character");for(var s=0;r>s;++s)o.modify("extend","forward","character")}else{var a=o.getRangeAt(0);a.setStart(a.startContainer,a.startOffset-i),a.setEnd(a.endContainer,a.endOffset+r),o.removeAllRanges(),o.addRange(a)}}else if(t.selection){var o=t.selection;if("Control"!=o.type){var a=o.createRange();a.collapse(!0),a.moveStart("character",-i),a.moveEnd("character",r),a.select()}}},b=function(n){if(f(n))return null;if(e.getSelection){var i=e.getSelection();if(i.rangeCount){for(var r=t.createElement("div"),o=i.rangeCount,s=0;o>s;++s){var a=i.getRangeAt(s).cloneContents();r.appendChild(a)}return r.innerHTML}}else if(t.selection){var i=t.selection;if("Text"==i.type){var l=i.createRange();return l.htmlText}}return null},y=function(n,i){if(e.getSelection){var r=e.getSelection();if(c(n,r.anchorNode)&&c(n,r.focusNode))return!0;if(!i)return!1;var o=t.createRange();o.selectNodeContents(n),o.collapse(!1),r.removeAllRanges(),r.addRange(o)}else if(t.selection){var r=t.selection;if("Control"==r.type){var o=r.createRange();if(0!=o.length&&c(n,o(0)))return!0}else{var s=t.body.createTextRange();s.moveToElementText(n);var o=r.createRange();if(s.inRange(o))return!0}if(!i)return!1;var o=t.body.createTextRange();o.moveToElementText(n),o.setEndPoint("StartToEnd",o),o.select()}return!0},w=function(n,i){if(e.getSelection){var r=e.getSelection();if(r.getRangeAt&&r.rangeCount){var o=r.getRangeAt(0),s=t.createElement("div");s.innerHTML=i;for(var a,l,u=t.createDocumentFragment();a=s.firstChild;)l=u.appendChild(a);c(n,o.commonAncestorContainer)?(o.deleteContents(),o.insertNode(u)):n.appendChild(u),l&&(o=o.cloneRange(),o.setStartAfter(l),o.collapse(!0),r.removeAllRanges(),r.addRange(o))}}else if(t.selection){var r=t.selection;if("Control"!=r.type){var h=r.createRange();h.collapse(!0);var o=r.createRange();if(c(n,o.parentElement()))o.pasteHTML(i);else{var d=t.body.createTextRange();d.moveToElementText(n),d.collapse(!1),d.select(),d.pasteHTML(i)}o=r.createRange(),o.setEndPoint("StartToEnd",h),o.select()}}},_=function(_){_=_||{};var x=_.element||null;"string"==typeof x&&(x=t.getElementById(x));var C=_.onKeyDown||null,$=_.onKeyPress||null,k=_.onKeyUp||null,S=_.onSelection||null,T=_.onPlaceholder||null,E=_.onClosepopup||null,D=_.hijackContextmenu||!1,A=_.readOnly||!1,O="TEXTAREA"==x.nodeName||"INPUT"==x.nodeName;if(O){var I="contentEditable"in t.body;if(I){var M=navigator.userAgent.match(/(?:iPad|iPhone|Android).* AppleWebKit\/([^ ]+)/);M&&420<=parseInt(M[1])&&parseInt(M[1])<534&&(I=!1)}if(!I){var P=x,R=function(e){return e.replace(/<br[ \/]*>\n?/gi,"<br>\n")};P.value=R(P.value);var N=function(){return this},F=function(){return null};return{legacy:!0,getElement:function(){return P},getHTML:function(){return P.value},setHTML:function(e){return P.value=R(e),this},getSelectedHTML:F,sync:N,readOnly:function(e){return void 0===e?P.hasAttribute?P.hasAttribute("readonly"):!!P.getAttribute("readonly"):(e?P.setAttribute("readonly","readonly"):P.removeAttribute("readonly"),this)},collapseSelection:N,expandSelection:N,openPopup:F,closePopup:N,removeFormat:N,bold:N,italic:N,underline:N,strikethrough:N,forecolor:N,highlight:N,fontName:N,fontSize:N,subscript:N,superscript:N,align:N,format:N,indent:N,
insertLink:N,insertImage:N,insertHTML:N,insertList:N}}}var P=null,L=null;if(O){P=x,P.style.display="none",L=t.createElement("DIV"),L.innerHTML=P.value;var j=P.parentNode,U=P.nextSibling;U?j.insertBefore(L,U):j.appendChild(L)}else L=x;A||L.setAttribute("contentEditable","true");var H=t.all&&!t.addEventListener?t:e,W=null;if(O){var B=L.innerHTML;W=function(){var e=L.innerHTML;e!=B&&(P.value=e,B=e,o(P,"change",!1))}}var z;if(T){var q=!1;(z=function(){for(var e=!0,t=L;t;)if(t=u(t,L))if(t.nodeType==a){if("IMG"==t.nodeName){e=!1;break}}else if(t.nodeType==l){var n=t.nodeValue;if(n&&-1!=n.search(/[^\s]/)){e=!1;break}}q!=e&&(T(e),q=e)})()}var V=null,Y=null,G=null;S&&(Y=function(t,n,i){var r=f(L),o=g(L),s=null===t||null===n?null:{left:t,top:n,width:0,height:0},l=p();if(l&&(s=l),s){if(L.getBoundingClientRect){var c=L.getBoundingClientRect();s.left-=parseInt(c.left),s.top-=parseInt(c.top)}else{var u=L,h=0,d=0,m=!1;do h+=u.offsetLeft?parseInt(u.offsetLeft):0,d+=u.offsetTop?parseInt(u.offsetTop):0,"fixed"==u.style.position&&(m=!0);while(u=u.offsetParent);s.left-=h-(m?0:e.pageXOffset),s.top-=d-(m?0:e.pageYOffset)}s.left<0&&(s.left=0),s.top<0&&(s.top=0),s.width>L.offsetWidth&&(s.width=L.offsetWidth),s.height>L.offsetHeight&&(s.height=L.offsetHeight)}else if(o.length)for(var v=0;v<o.length;++v){var u=o[v];if(u.nodeType==a){s={left:u.offsetLeft,top:u.offsetTop,width:u.offsetWidth,height:u.offsetHeight};break}}S(r,s,o,i)},G=n(Y,1));var K=null,X=function(t){if(!t)var t=e.event;var n=t.target||t.srcElement;n.nodeType==l&&(n=n.parentNode),c(K,n)||J()},Q=function(){if(K)return K;i(H,"mousedown",X,!0),K=t.createElement("DIV");var e=L.parentNode,n=L.nextSibling;return n?e.insertBefore(K,n):e.appendChild(K),K},J=function(){K&&(K.parentNode.removeChild(K),K=null,r(H,"mousedown",X,!0),E&&E())};i(L,"focus",function(){P&&o(P,"focus",!1)}),i(L,"blur",function(){W&&W(),P&&o(P,"blur",!1)});var Z=null;if(z||W){var ee=W?n(W,250,!0):null,te=function(e){z&&z(),ee&&ee()};Z=n(te,1),i(L,"input",Z),i(L,"DOMNodeInserted",Z),i(L,"DOMNodeRemoved",Z),i(L,"DOMSubtreeModified",Z),i(L,"DOMCharacterDataModified",Z),i(L,"propertychange",Z),i(L,"textInput",Z),i(L,"paste",Z),i(L,"cut",Z),i(L,"drop",Z)}var ne=function(t,n){if(!t)var t=e.event;var i=t.which||t.keyCode,r=String.fromCharCode(i||t.charCode),o=t.shiftKey||!1,a=t.altKey||!1,l=t.ctrlKey||!1,c=t.metaKey||!1;if(1==n){if(C&&C(i,r,o,a,l,c)===!1)return s(t)}else if(2==n){if($&&$(i,r,o,a,l,c)===!1)return s(t)}else if(3==n&&k&&k(i,r,o,a,l,c)===!1)return s(t);if((2==n||3==n)&&(V=null,G&&G(null,null,!1)),2==n&&Z)switch(i){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:break;default:Z()}};i(L,"keydown",function(e){return ne(e,1)}),i(L,"keypress",function(e){return ne(e,2)}),i(L,"keyup",function(e){return ne(e,3)});var ie=function(t,n){if(!t)var t=e.event;var i=null,o=null;t.clientX&&t.clientY?(i=t.clientX,o=t.clientY):t.pageX&&t.pageY&&(i=t.pageX-e.pageXOffset,o=t.pageY-e.pageYOffset),t.which&&3==t.which?n=!0:t.button&&2==t.button&&(n=!0),r(H,"mouseup",ie),V=null,(D||!n)&&G&&G(i,o,n)};i(L,"mousedown",function(e){r(H,"mouseup",ie),i(H,"mouseup",ie)}),i(L,"mouseup",function(e){ie(e),Z&&Z()}),i(L,"dblclick",function(e){ie(e)}),i(L,"selectionchange",function(e){ie(e)}),D&&i(L,"contextmenu",function(e){return ie(e,!0),s(e)});var re=function(n,i,r){if(d(L,V),!y(L,r))return!1;if(e.getSelection)try{return t.queryCommandSupported&&!t.queryCommandSupported(n)?!1:t.execCommand(n,!1,i)}catch(o){}else if(t.selection){var s=t.selection;if("None"!=s.type){var a=s.createRange();try{return a.queryCommandEnabled(n)?a.execCommand(n,!1,i):!1}catch(o){}}}return!1},oe=null,se=function(){(t.all||e.MSInputMethodContext)&&(oe=t.createElement("DIV"),L.appendChild(oe))},ae=function(e){oe&&(L.removeChild(oe),oe=null),Z&&Z(),e?(m(),V=null):V&&(V=h(L))};return{getElement:function(){return L},getHTML:function(){return L.innerHTML},setHTML:function(e){return L.innerHTML=e,ae(!0),this},getSelectedHTML:function(){return d(L,V),y(L)?b(L):null},sync:function(){return W&&W(),this},readOnly:function(e){return void 0===e?L.hasAttribute?!L.hasAttribute("contentEditable"):!L.getAttribute("contentEditable"):(e?L.removeAttribute("contentEditable"):L.setAttribute("contentEditable","true"),this)},collapseSelection:function(){return m(),V=null,this},expandSelection:function(e,t){return d(L,V),y(L)?(v(L,e,t),V=h(L),this):this},openPopup:function(){return V||(V=h(L)),Q()},closePopup:function(){return J(),this},removeFormat:function(){return re("removeFormat"),re("unlink"),ae(),this},bold:function(){return re("bold"),ae(),this},italic:function(){return re("italic"),ae(),this},underline:function(){return re("underline"),ae(),this},strikethrough:function(){return re("strikeThrough"),ae(),this},forecolor:function(e){return re("foreColor",e),ae(),this},highlight:function(e){return re("hiliteColor",e)||re("backColor",e),ae(),this},fontName:function(e){return re("fontName",e),ae(),this},fontSize:function(e){return re("fontSize",e),ae(),this},subscript:function(){return re("subscript"),ae(),this},superscript:function(){return re("superscript"),ae(),this},align:function(e){return se(),"left"==e?re("justifyLeft"):"center"==e?re("justifyCenter"):"right"==e?re("justifyRight"):"justify"==e&&re("justifyFull"),ae(),this},format:function(e){return se(),re("formatBlock",e),ae(),this},indent:function(e){return se(),re(e?"outdent":"indent"),ae(),this},insertLink:function(e){return re("createLink",e),ae(!0),this},insertImage:function(e){return re("insertImage",e,!0),ae(!0),this},insertHTML:function(e){return re("insertHTML",e,!0)||(d(L,V),y(L,!0),w(L,e)),ae(!0),this},insertList:function(e){return se(),re(e?"insertOrderedList":"insertUnorderedList"),ae(),this}}};return _}),function(e){"use strict";if("function"==typeof define&&define.amd)define(["jquery"],function(t){return e(window,document,t)});else{if("undefined"==typeof exports)return e(window,document,jQuery);module.exports=e(window,document,require("jquery"))}}(function(e,t,n){"use strict";var i=function(e,t,n){var i,r,o,s,a,l,c,u;switch(s=Math.floor(6*e),a=6*e-s,l=n*(1-t),c=n*(1-a*t),u=n*(1-(1-a)*t),s%6){case 0:i=n,r=u,o=l;break;case 1:i=c,r=n,o=l;break;case 2:i=l,r=n,o=u;break;case 3:i=l,r=c,o=n;break;case 4:i=u,r=l,o=n;break;case 5:i=n,r=l,o=c}var h=Math.floor(255*i).toString(16),d=Math.floor(255*r).toString(16),p=Math.floor(255*o).toString(16);return"#"+(h.length<2?"0":"")+h+(d.length<2?"0":"")+d+(p.length<2?"0":"")+p},r=function(e){return e.replace(/[&<>"]/g,function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return t[e]||e})},o=function(o,s,a,l,c,u,h,d,p,f,g,m,v,b,y,w,_){var x=function(e,t){t&&(e.getSelectedHTML()?e.insertLink(t):e.insertHTML('<a href="'+r(t)+'">'+r(t)+"</a>")),e.closePopup().collapseSelection()},C=function(e,t){var i=E(u),r=n('<input type="text" value="'+(t?t.attr("href"):"")+'" />').addClass("wysiwyg-input").keypress(function(n){(10==n.which||13==n.which)&&(t?(t.attr("href",r.val()),e.closePopup().collapseSelection()):x(e,r.val()))});d&&r.attr("placeholder",d);var o=i.click(function(n){return t?(t.attr("href",r.val()),e.closePopup().collapseSelection()):x(e,r.val()),n.stopPropagation(),n.preventDefault(),!1}),s=n("<div/>").addClass("wysiwyg-toolbar-form").attr("unselectable","on");return s.append(r).append(o),s},$=function(t){var i=function(e,i){var o='<img id="wysiwyg-insert-image" src="" alt=""'+(i?' title="'+r(i)+'"':"")+" />";t.insertHTML(o).closePopup().collapseSelection();var s=n("#wysiwyg-insert-image").removeAttr("id");f&&s.css({maxWidth:f[0]+"px",maxHeight:f[1]+"px"}).load(function(){s.css({maxWidth:"",maxHeight:""});var e=s.width(),t=s.height();(e>f[0]||t>f[1])&&(e/t>f[0]/f[1]?(t=parseInt(t/e*f[0]),e=f[0]):(e=parseInt(e/t*f[1]),t=f[1]),s.attr("width",e).attr("height",t))}),s.attr("src",e)},o=n("<div/>").addClass("wysiwyg-toolbar-form").attr("unselectable","on"),s=null,a=n('<input type="file" />').css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0,cursor:"pointer"});if(!m&&e.File&&e.FileReader&&e.FileList){var l=function(e){if(e.type.match("image.*")){var t=new FileReader;t.onload=function(t){var n=t.target.result;i(n,e.name)},t.readAsDataURL(e)}};s=a.attr("draggable","true").change(function(e){for(var t=e.target.files,n=0;n<t.length;++n)l(t[n])}).on("dragover",function(e){return e.originalEvent.dataTransfer.dropEffect="copy",e.stopPropagation(),e.preventDefault(),!1}).on("drop",function(e){for(var t=e.originalEvent.dataTransfer.files,n=0;n<t.length;++n)l(t[n]);return e.stopPropagation(),e.preventDefault(),!1})}else if(g){var c=a.change(function(e){g.call(this,i)});s=n("<form/>").append(c)}s&&n("<div/>").addClass("wysiwyg-browse").html(h).append(s).appendTo(o);var p=E(u),v=n('<input type="text" value="" />').addClass("wysiwyg-input").keypress(function(e){(10==e.which||13==e.which)&&i(v.val())});d&&v.attr("placeholder",d);var b=p.click(function(e){return i(v.val()),e.stopPropagation(),e.preventDefault(),!1});return o.append(n("<div/>").append(v).append(b)),o},k=function(e){var t=function(t,i){t=n.trim(t||""),i=n.trim(i||"");var o=!1;t.length&&!i.length?o=t:-1==i.indexOf("<")&&-1==i.indexOf(">")&&i.match(/^(?:https?:\/)?\/?(?:[^:\/\s]+)(?:(?:\/\w+)*\/)(?:[\w\-\.]+[^#?\s]+)(?:.*)?(?:#[\w\-]+)?$/)&&(o=i),o&&v&&(i=v(o)||""),!i.length&&o&&(i='<video src="'+r(o)+'" />'),e.insertHTML(i).closePopup().collapseSelection()},i=n("<div/>").addClass("wysiwyg-toolbar-form").attr("unselectable","on"),o=n("<textarea>").addClass("wysiwyg-input wysiwyg-inputtextarea");p&&o.attr("placeholder",p),n("<div/>").addClass("wysiwyg-embedcode").append(o).appendTo(i);var s=E(u),a=n('<input type="text" value="" />').addClass("wysiwyg-input").keypress(function(e){(10==e.which||13==e.which)&&t(a.val())});d&&a.attr("placeholder",d);var l=s.click(function(e){return t(a.val(),o.val()),e.stopPropagation(),e.preventDefault(),!1});return i.append(n("<div/>").append(a).append(l)),i},S=function(e,t){for(var r=n("<table/>").attr("cellpadding","0").attr("cellspacing","0").attr("unselectable","on"),o=1;15>o;++o){for(var s=n("<tr/>"),a=0;25>a;++a){var l;if(24==a){var c=Math.floor(255/13*(14-o)).toString(16),u=(c.length<2?"0":"")+c;l="#"+u+u+u}else{var h=a/24,d=8>=o?o/8:1,p=o>8?(16-o)/8:1;l=i(h,d,p)}n("<td/>").addClass("wysiwyg-toolbar-color").attr("title",l).attr("unselectable","on").css({backgroundColor:l}).click(function(){var n=this.title;return t?e.forecolor(n).closePopup().collapseSelection():e.highlight(n).closePopup().collapseSelection(),!1}).appendTo(s)}r.append(s)}return r},T=function(e,t){switch(e){case"insertimage":return t?function(e){t($(N),e)}:null;case"insertvideo":return t?function(e){t(k(N),e)}:null;case"insertlink":return t?function(e){t(C(N),e)}:null;case"bold":return function(){N.bold()};case"italic":return function(){N.italic()};case"underline":return function(){N.underline()};case"strikethrough":return function(){N.strikethrough()};case"forecolor":return t?function(e){t(S(N,!0),e)}:null;case"highlight":return t?function(e){t(S(N,!1),e)}:null;case"alignleft":return function(){N.align("left")};case"aligncenter":return function(){N.align("center")};case"alignright":return function(){N.align("right")};case"alignjustify":return function(){N.align("justify")};case"subscript":return function(){N.subscript()};case"superscript":return function(){N.superscript()};case"indent":return function(){N.indent()};case"outdent":return function(){N.indent(!0)};case"orderedList":return function(){N.insertList(!0)};case"unorderedList":return function(){N.insertList()};case"removeformat":return function(){N.removeFormat().closePopup().collapseSelection()}}return null},E=function(e){return n("<a/>").addClass("wysiwyg-toolbar-icon").attr("href","javascript:void(0)").attr("title",e.title).attr("unselectable","on").append(e.image)},D=function(e,t,i,r){n.each(c,function(o,s){if(s&&!(t===!1&&"showstatic"in s&&!s.showstatic||t===!0&&"showselection"in s&&!s.showselection)){var a;a="click"in s?function(e){s.click(n(e))}:"popup"in s?function(e){var t=i(),o=s.popup(t,n(e));r(t,e,o)}:T(o,function(e,t){var n=i();n.append(e),r(n,t),n.find("input[type=text]:first").focus()});var l;a?l=E(s).click(function(e){return a(e.currentTarget),T(o)&&N.getElement().focus(),e.stopPropagation(),e.preventDefault(),!1}):s.html&&(l=n(s.html)),l&&e.append(l)}})},A=function(i,r,o,s){for(var a=r.get(0),l=a.offsetParent,c={left:0,top:0},u=!1,h=!1,d=i.width(),p=l;p;){c.left+=p.offsetLeft,c.top+=p.offsetTop;var f=n(p);"fixed"==f.css("position")&&(u=!0),"visible"!=f.css("overflow")&&(h=!0),p=p.offsetParent}var g=n(l||t.body);g.append(i),o+=a.offsetLeft,s+=a.offsetTop,(u||h)&&(o+d>g.width()-1&&(o=g.width()-d-1),1>o&&(o=1));var m=n(e).width();c.left+o+d>m-1&&(o=m-c.left-d-1);var v=u?0:n(e).scrollLeft();c.left+o<v+1&&(o=v-c.left+1),i.css({left:parseInt(o)+"px",top:parseInt(s)+"px"})},O={},I=null,M=function(e,t,i){var r=function(e,t,i,r,o,s,l){if(_){var c=I||"";switch(t){case 8:c=c.substring(0,c.length-1);case 13:case 27:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:if(e)return;i=!1;break;default:if(!e)return;c+=i}var u=_(c,t,i,r,o,s,l);if("object"!=typeof u||!u.length)return a.closePopup(),I=null,u;var h=n(a.openPopup());h.hide().addClass("wysiwyg-popup wysiwyg-popuphover").empty().append(u),I=c}},o={element:e.get(0),onKeyDown:function(e,t,n,i,o,s){if(b&&b(e,t,n,i,o,s)===!1)return!1;if(t&&!n&&!i&&o&&!s){var a=t.toLowerCase();if(!O[a])return;return O[a](),!1}return r(!1,e,t,n,i,o,s)},onKeyPress:function(e,t,n,i,o,s){return y&&y(e,t,n,i,o,s)===!1?!1:r(!0,e,t,n,i,o,s)},onKeyUp:function(e,t,n,i,r,o){return w&&w(e,t,n,i,r,o)===!1?!1:void 0},onSelection:function(e,i,r,o){var s=!0,c=null;if(e&&n.each(r,function(e,t){return 0!=n(t).parents("a").length?(c=C(a,n(t).parents("a:first")),!1):void 0}),a.readOnly()?s=!1:i?c||o||I||("selection"!=l&&"top-selection"!=l&&"bottom-selection"!=l?s=!1:e?s=!1:1==r.length&&"IMG"==r[0].nodeName&&(s=!1)):s=!1,!s)return void a.closePopup();var u,h=function(){var e=u.outerWidth(),r=t.offset(),o=n(a.getElement()).offset(),s=i.left+parseInt(i.width/2)-parseInt(e/2)+o.left-r.left,l=i.top+i.height+o.top-r.top;A(u,t,s,l)};u=n(a.openPopup()),u.hasClass("wysiwyg-popuphover")&&!u.data("special")==!c||(u=n(a.closePopup().openPopup())),I?u.show():u.hasClass("wysiwyg-popup")||(u.addClass("wysiwyg-popup wysiwyg-popuphover"),c?u.empty().append(c).data("special",!0):D(u,!0,function(){return u.empty()},h)),h()},onClosepopup:function(){I=null},hijackContextmenu:"selection"==l,readOnly:!!e.attr("readonly")};if(i){var s=n("<div/>").addClass("wysiwyg-placeholder").html(i).hide();t.prepend(s),o.onPlaceholder=function(e){e?s.show():s.hide()}}var a=wysiwyg(o);return a},P=n("<div/>").addClass("wysiwyg-container");s&&P.addClass(s),o.wrap(P),P=o.parent(".wysiwyg-container");var R=!1;a&&(R=n("<div/>").addClass("wysiwyg-wrapper").click(function(){N.getElement().focus()}),o.wrap(R),R=o.parent(".wysiwyg-wrapper"));var N=M(o,a?R:P,a);if(N.legacy){var o=n(N.getElement());o.addClass("wysiwyg-textarea"),o.is(":visible")&&o.width(P.width()-(o.outerWidth()-o.width()))}else n(N.getElement()).addClass("wysiwyg-editor");var F={};if(n.each(c,function(e,t){if(t&&t.hotkey){var n=T(e);n&&(O[t.hotkey.toLowerCase()]=n,F[e]=n)}}),"selection"!=l){var L="top"==l||"top-selection"==l,j=n("<div/>").addClass("wysiwyg-toolbar").addClass(L?"wysiwyg-toolbar-top":"wysiwyg-toolbar-bottom");D(j,!1,function(){var e=n(N.openPopup());return e.hasClass("wysiwyg-popup")&&e.hasClass("wysiwyg-popuphover")&&(e=n(N.closePopup().openPopup())),e.hasClass("wysiwyg-popup")||e.addClass("wysiwyg-popup"),e},function(e,t,i){var r=n(t),o=e.outerWidth(),s=r.offset().left-P.offset().left+parseInt(r.width()/2)-parseInt(o/2),a=r.offset().top-P.offset().top;L?a+=r.outerHeight():a-=e.outerHeight(),i&&(s=i.left,a=i.top),A(e,P,s,a)}),L?P.prepend(j):P.append(j)}return{wysiwygeditor:N,$container:P}};n.fn.wysiwyg=function(e,t){if(!e||"object"==typeof e)return e=n.extend({},e),this.each(function(){var t=n(this);if(!t.data("wysiwyg")){var i=e.classes,r=e.placeholder||t.attr("placeholder"),s=!e.toolbar||"top"!=e.toolbar&&"top-selection"!=e.toolbar&&"bottom"!=e.toolbar&&"bottom-selection"!=e.toolbar&&"selection"!=e.toolbar?"top-selection":e.toolbar,a=e.buttons,l=e.submit,c=e.selectImage,u=e.placeholderUrl||null,h=e.placeholderEmbed||null,d=e.maxImageSize||null,p=e.onImageUpload||null,f=e.forceImageUpload&&p,g=e.videoFromUrl||null,m=e.onKeyDown||null,v=e.onKeyPress||null,b=e.onKeyUp||null,y=e.onAutocomplete||null,w=o(t,i,r,s,a,l,c,u,h,d,p,f,g,m,v,b,y);t.data("wysiwyg",w)}});if(1==this.length){var i=this.data("wysiwyg");if(!i)return this;if("container"==e)return i.$container;if("shell"==e)return i.wysiwygeditor}return this}}),function(e,t,n){"use strict";function i(e){return function(){var t,n,i=arguments[0],r="["+(e?e+":":"")+i+"] ",o=arguments[1],s=arguments,a=function(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof e?"undefined":"string"!=typeof e?JSON.stringify(e):e};for(t=r+o.replace(/\{\d+\}/g,function(e){var t,n=+e.slice(1,-1);return n+2<s.length?(t=s[n+2],"function"==typeof t?t.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof t?"undefined":"string"!=typeof t?W(t):t):e}),t=t+"\nhttp://errors.angularjs.org/1.2.25/"+(e?e+"/":"")+i,n=2;n<arguments.length;n++)t=t+(2==n?"?":"&")+"p"+(n-2)+"="+encodeURIComponent(a(arguments[n]));return new Error(t)}}function r(e){if(null==e||k(e))return!1;var t=e.length;return 1===e.nodeType&&t?!0:w(e)||Dn(e)||0===t||"number"==typeof t&&t>0&&t-1 in e}function o(e,t,n){var i;if(e)if(C(e))for(i in e)"prototype"==i||"length"==i||"name"==i||e.hasOwnProperty&&!e.hasOwnProperty(i)||t.call(n,e[i],i);else if(Dn(e)||r(e))for(i=0;i<e.length;i++)t.call(n,e[i],i);else if(e.forEach&&e.forEach!==o)e.forEach(t,n);else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i);return e}function s(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.sort()}function a(e,t,n){for(var i=s(e),r=0;r<i.length;r++)t.call(n,e[i[r]],i[r]);return i}function l(e){return function(t,n){e(n,t)}}function c(){for(var e,t=En.length;t;){if(t--,e=En[t].charCodeAt(0),57==e)return En[t]="A",En.join("");if(90!=e)return En[t]=String.fromCharCode(e+1),En.join("");En[t]="0"}return En.unshift("0"),En.join("")}function u(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function h(e){var t=e.$$hashKey;return o(arguments,function(t){t!==e&&o(t,function(t,n){e[n]=t})}),u(e,t),e}function d(e){return parseInt(e,10)}function p(e,t){return h(new(h(function(){},{prototype:e})),t)}function f(){}function g(e){return e}function m(e){return function(){return e}}function v(e){return"undefined"==typeof e}function b(e){return"undefined"!=typeof e}function y(e){return null!=e&&"object"==typeof e}function w(e){return"string"==typeof e}function _(e){return"number"==typeof e}function x(e){return"[object Date]"===kn.call(e)}function C(e){return"function"==typeof e}function $(e){return"[object RegExp]"===kn.call(e)}function k(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function S(e){return e&&e.$evalAsync&&e.$watch}function T(e){return"[object File]"===kn.call(e)}function E(e){return"[object Blob]"===kn.call(e)}function D(e){return e&&C(e.then)}function A(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function O(e,t,n){var i=[];return o(e,function(e,r,o){i.push(t.call(n,e,r,o))}),i}function I(e,t){return-1!=M(e,t)}function M(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}function P(e,t){var n=M(e,t);return n>=0&&e.splice(n,1),t}function R(e,t,n,i){if(k(e)||S(e))throw Sn("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(t){if(e===t)throw Sn("cpi","Can't copy! Source and destination are identical.");if(n=n||[],i=i||[],y(e)){var r=M(n,e);if(-1!==r)return i[r];n.push(e),i.push(t)}var s;if(Dn(e)){t.length=0;for(var a=0;a<e.length;a++)s=R(e[a],null,n,i),y(e[a])&&(n.push(e[a]),i.push(s)),t.push(s)}else{var l=t.$$hashKey;Dn(t)?t.length=0:o(t,function(e,n){delete t[n]});for(var c in e)s=R(e[c],null,n,i),y(e[c])&&(n.push(e[c]),i.push(s)),t[c]=s;u(t,l)}}else t=e,e&&(Dn(e)?t=R(e,[],n,i):x(e)?t=new Date(e.getTime()):$(e)?(t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]),t.lastIndex=e.lastIndex):y(e)&&(t=R(e,{},n,i)));return t}function N(e,t){if(Dn(e)){t=t||[];for(var n=0;n<e.length;n++)t[n]=e[n]}else if(y(e)){t=t||{};for(var i in e)!fn.call(e,i)||"$"===i.charAt(0)&&"$"===i.charAt(1)||(t[i]=e[i])}return t||e}function F(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!==e&&t!==t)return!0;var i,r,o,s=typeof e,a=typeof t;if(s==a&&"object"==s){if(!Dn(e)){if(x(e))return x(t)?isNaN(e.getTime())&&isNaN(t.getTime())||e.getTime()===t.getTime():!1;if($(e)&&$(t))return e.toString()==t.toString();if(S(e)||S(t)||k(e)||k(t)||Dn(t))return!1;o={};for(r in e)if("$"!==r.charAt(0)&&!C(e[r])){if(!F(e[r],t[r]))return!1;o[r]=!0}for(r in t)if(!o.hasOwnProperty(r)&&"$"!==r.charAt(0)&&t[r]!==n&&!C(t[r]))return!1;return!0}if(!Dn(t))return!1;if((i=e.length)==t.length){for(r=0;i>r;r++)if(!F(e[r],t[r]))return!1;return!0}}return!1}function L(e,t,n){return e.concat(Cn.call(t,n))}function j(e,t){return Cn.call(e,t||0)}function U(e,t){var n=arguments.length>2?j(arguments,2):[];return!C(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,n.concat(Cn.call(arguments,0))):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function H(e,i){var r=i;return"string"==typeof e&&"$"===e.charAt(0)?r=n:k(i)?r="$WINDOW":i&&t===i?r="$DOCUMENT":S(i)&&(r="$SCOPE"),r}function W(e,t){return"undefined"==typeof e?n:JSON.stringify(e,H,t?"  ":null)}function B(e){return w(e)?JSON.parse(e):e}function z(e){if("function"==typeof e)e=!0;else if(e&&0!==e.length){var t=pn(""+e);e=!("f"==t||"0"==t||"false"==t||"no"==t||"n"==t||"[]"==t)}else e=!1;return e}function q(e){e=yn(e).clone();try{e.empty()}catch(t){}var n=3,i=yn("<div>").append(e).html();try{return e[0].nodeType===n?pn(i):i.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+pn(t)})}catch(t){return pn(i)}}function V(e){try{return decodeURIComponent(e)}catch(t){}}function Y(e){var t,n,i={};return o((e||"").split("&"),function(e){if(e&&(t=e.replace(/\+/g,"%20").split("="),n=V(t[0]),b(n))){var r=b(t[1])?V(t[1]):!0;fn.call(i,n)?Dn(i[n])?i[n].push(r):i[n]=[i[n],r]:i[n]=r}}),i}function G(e){var t=[];return o(e,function(e,n){Dn(e)?o(e,function(e){t.push(X(n,!0)+(e===!0?"":"="+X(e,!0)))}):t.push(X(n,!0)+(e===!0?"":"="+X(e,!0)))}),t.length?t.join("&"):""}function K(e){return X(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function X(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function Q(e,n){function i(e){e&&a.push(e)}var r,s,a=[e],l=["ng:app","ng-app","x-ng-app","data-ng-app"],c=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;o(l,function(n){l[n]=!0,i(t.getElementById(n)),n=n.replace(":","\\:"),e.querySelectorAll&&(o(e.querySelectorAll("."+n),i),o(e.querySelectorAll("."+n+"\\:"),i),o(e.querySelectorAll("["+n+"]"),i))}),o(a,function(e){if(!r){var t=" "+e.className+" ",n=c.exec(t);n?(r=e,s=(n[2]||"").replace(/\s+/g,",")):o(e.attributes,function(t){!r&&l[t.name]&&(r=e,s=t.value)})}}),r&&n(r,s?[s]:[])}function J(n,i){var r=function(){if(n=yn(n),n.injector()){var e=n[0]===t?"document":q(n);throw Sn("btstrpd","App Already Bootstrapped with this Element '{0}'",e.replace(/</,"&lt;").replace(/>/,"&gt;"))}i=i||[],i.unshift(["$provide",function(e){e.value("$rootElement",n)}]),i.unshift("ng");var r=Me(i);return r.invoke(["$rootScope","$rootElement","$compile","$injector","$animate",function(e,t,n,i,r){e.$apply(function(){t.data("$injector",i),n(t)(e)})}]),r},s=/^NG_DEFER_BOOTSTRAP!/;return e&&!s.test(e.name)?r():(e.name=e.name.replace(s,""),void(Tn.resumeBootstrap=function(e){o(e,function(e){i.push(e)}),r()}))}function Z(e,t){return t=t||"_",e.replace(In,function(e,n){return(n?t:"")+e.toLowerCase()})}function ee(){wn=e.jQuery,wn&&wn.fn.on?(yn=wn,h(wn.fn,{scope:Vn.scope,isolateScope:Vn.isolateScope,controller:Vn.controller,injector:Vn.injector,inheritedData:Vn.inheritedData}),ue("remove",!0,!0,!1),ue("empty",!1,!1,!1),ue("html",!1,!1,!0)):yn=fe,Tn.element=yn}function te(e,t,n){if(!e)throw Sn("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function ne(e,t,n){return n&&Dn(e)&&(e=e[e.length-1]),te(C(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function ie(e,t){if("hasOwnProperty"===e)throw Sn("badname","hasOwnProperty is not a valid {0} name",t)}function re(e,t,n){if(!t)return e;for(var i,r=t.split("."),o=e,s=r.length,a=0;s>a;a++)i=r[a],e&&(e=(o=e)[i]);return!n&&C(e)?U(o,e):e}function oe(e){var t=e[0],n=e[e.length-1];if(t===n)return yn(t);var i=t,r=[i];do{if(i=i.nextSibling,!i)break;r.push(i)}while(i!==n);return yn(r)}function se(e){function t(e,t,n){return e[t]||(e[t]=n())}var n=i("$injector"),r=i("ng"),o=t(e,"angular",Object);return o.$$minErr=o.$$minErr||i,t(o,"module",function(){var e={};return function(i,o,s){var a=function(e,t){if("hasOwnProperty"===e)throw r("badname","hasOwnProperty is not a valid {0} name",t)};return a(i,"module"),o&&e.hasOwnProperty(i)&&(e[i]=null),t(e,i,function(){function e(e,n,i){return function(){return t[i||"push"]([e,n,arguments]),l}}if(!o)throw n("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",i);var t=[],r=[],a=e("$injector","invoke"),l={_invokeQueue:t,_runBlocks:r,requires:o,name:i,provider:e("$provide","provider"),factory:e("$provide","factory"),service:e("$provide","service"),value:e("$provide","value"),constant:e("$provide","constant","unshift"),animation:e("$animateProvider","register"),filter:e("$filterProvider","register"),controller:e("$controllerProvider","register"),directive:e("$compileProvider","directive"),config:a,run:function(e){return r.push(e),this}};return s&&a(s),l})}})}function ae(t){h(t,{bootstrap:J,copy:R,extend:h,equals:F,element:yn,forEach:o,injector:Me,noop:f,bind:U,toJson:W,fromJson:B,identity:g,isUndefined:v,isDefined:b,isString:w,isFunction:C,isObject:y,isNumber:_,isElement:A,isArray:Dn,version:Mn,isDate:x,lowercase:pn,uppercase:gn,callbacks:{counter:0},$$minErr:i,$$csp:On}),_n=se(e);try{_n("ngLocale")}catch(n){_n("ngLocale",[]).provider("$locale",nt)}_n("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:Et}),e.provider("$compile",Ue).directive({a:Di,input:Ui,textarea:Ui,form:Mi,script:xr,select:kr,style:Tr,option:Sr,ngBind:Ji,ngBindHtml:er,ngBindTemplate:Zi,ngClass:tr,ngClassEven:ir,ngClassOdd:nr,ngCloak:rr,ngController:or,ngForm:Pi,ngHide:mr,ngIf:lr,ngInclude:cr,ngInit:hr,ngNonBindable:dr,ngPluralize:pr,ngRepeat:fr,ngShow:gr,ngStyle:vr,ngSwitch:br,ngSwitchWhen:yr,ngSwitchDefault:wr,ngOptions:$r,ngTransclude:_r,ngModel:Vi,ngList:Ki,ngChange:Yi,required:Gi,ngRequired:Gi,ngValue:Qi}).directive({ngInclude:ur}).directive(Ai).directive(sr),e.provider({$anchorScroll:Pe,$animate:ti,$browser:Fe,$cacheFactory:Le,$controller:Be,$document:ze,$exceptionHandler:qe,$filter:jt,$interpolate:et,$interval:tt,$http:Xe,$httpBackend:Je,$location:gt,$log:mt,$parse:Ct,$rootScope:Tt,$q:$t,$sce:Mt,$sceDelegate:It,$sniffer:Pt,$templateCache:je,$timeout:Rt,$window:Lt,$$rAF:St,$$asyncCallback:Re})}])}function le(){return++Rn}function ce(e){return e.replace(Ln,function(e,t,n,i){return i?n.toUpperCase():n}).replace(jn,"Moz$1")}function ue(e,t,n,i){function r(e){var r,s,a,l,c,u,h,d=n&&e?[this.filter(e)]:[this],p=t;if(!i||null!=e)for(;d.length;)for(r=d.shift(),s=0,a=r.length;a>s;s++)for(l=yn(r[s]),p?l.triggerHandler("$destroy"):p=!p,c=0,u=(h=l.children()).length;u>c;c++)d.push(wn(h[c]));return o.apply(this,arguments)}var o=wn.fn[e];o=o.$original||o,r.$original=o,wn.fn[e]=r}function he(e){return!Wn.test(e)}function de(e,t){var n,i,r,o,s,a,l=t.createDocumentFragment(),c=[];if(he(e))c.push(t.createTextNode(e));else{for(n=l.appendChild(t.createElement("div")),i=(Bn.exec(e)||["",""])[1].toLowerCase(),r=qn[i]||qn._default,n.innerHTML="<div>&#160;</div>"+r[1]+e.replace(zn,"<$1></$2>")+r[2],n.removeChild(n.firstChild),o=r[0];o--;)n=n.lastChild;for(s=0,a=n.childNodes.length;a>s;++s)c.push(n.childNodes[s]);n=l.firstChild,n.textContent=""}return l.textContent="",l.innerHTML="",c}function pe(e,n){n=n||t;var i;return(i=Hn.exec(e))?[n.createElement(i[1])]:de(e,n)}function fe(e){if(e instanceof fe)return e;if(w(e)&&(e=An(e)),!(this instanceof fe)){if(w(e)&&"<"!=e.charAt(0))throw Un("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new fe(e)}if(w(e)){$e(this,pe(e));var n=yn(t.createDocumentFragment());n.append(this)}else $e(this,e)}function ge(e){return e.cloneNode(!0)}function me(e){be(e);for(var t=0,n=e.childNodes||[];t<n.length;t++)me(n[t])}function ve(e,t,n,i){if(b(i))throw Un("offargs","jqLite#off() does not support the `selector` argument");var r=ye(e,"events"),s=ye(e,"handle");s&&(v(t)?o(r,function(t,n){Fn(e,n,t),delete r[n]}):o(t.split(" "),function(t){v(n)?(Fn(e,t,r[t]),delete r[t]):P(r[t]||[],n)}))}function be(e,t){var i=e.ng339,r=Pn[i];if(r){if(t)return void delete Pn[i].data[t];r.handle&&(r.events.$destroy&&r.handle({},"$destroy"),ve(e)),delete Pn[i],e.ng339=n}}function ye(e,t,n){var i=e.ng339,r=Pn[i||-1];return b(n)?(r||(e.ng339=i=le(),r=Pn[i]={}),void(r[t]=n)):r&&r[t]}function we(e,t,n){var i=ye(e,"data"),r=b(n),o=!r&&b(t),s=o&&!y(t);if(i||s||ye(e,"data",i={}),r)i[t]=n;else{if(!o)return i;if(s)return i&&i[t];h(i,t)}}function _e(e,t){return e.getAttribute?(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1:!1}function xe(e,t){t&&e.setAttribute&&o(t.split(" "),function(t){e.setAttribute("class",An((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+An(t)+" "," ")))})}function Ce(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");o(t.split(" "),function(e){e=An(e),-1===n.indexOf(" "+e+" ")&&(n+=e+" ")}),e.setAttribute("class",An(n))}}function $e(e,t){if(t){t=t.nodeName||!b(t.length)||k(t)?[t]:t;for(var n=0;n<t.length;n++)e.push(t[n])}}function ke(e,t){return Se(e,"$"+(t||"ngController")+"Controller")}function Se(e,t,i){9==e.nodeType&&(e=e.documentElement);for(var r=Dn(t)?t:[t];e;){for(var o=0,s=r.length;s>o;o++)if((i=yn.data(e,r[o]))!==n)return i;e=e.parentNode||11===e.nodeType&&e.host}}function Te(e){for(var t=0,n=e.childNodes;t<n.length;t++)me(n[t]);for(;e.firstChild;)e.removeChild(e.firstChild)}function Ee(e,t){var n=Yn[t.toLowerCase()];return n&&Gn[e.nodeName]&&n}function De(e,n){var i=function(i,r){if(i.preventDefault||(i.preventDefault=function(){i.returnValue=!1}),i.stopPropagation||(i.stopPropagation=function(){i.cancelBubble=!0}),i.target||(i.target=i.srcElement||t),v(i.defaultPrevented)){var s=i.preventDefault;i.preventDefault=function(){i.defaultPrevented=!0,s.call(i)},i.defaultPrevented=!1}i.isDefaultPrevented=function(){return i.defaultPrevented||i.returnValue===!1};var a=N(n[r||i.type]||[]);o(a,function(t){t.call(e,i)}),8>=bn?(i.preventDefault=null,i.stopPropagation=null,i.isDefaultPrevented=null):(delete i.preventDefault,delete i.stopPropagation,delete i.isDefaultPrevented)};return i.elem=e,i}function Ae(e,t){var i,r=typeof e;return"function"==r||"object"==r&&null!==e?"function"==typeof(i=e.$$hashKey)?i=e.$$hashKey():i===n&&(i=e.$$hashKey=(t||c)()):i=e,r+":"+i}function Oe(e,t){if(t){var n=0;this.nextUid=function(){return++n}}o(e,this.put,this)}function Ie(e){var t,n,i,r;return"function"==typeof e?(t=e.$inject)||(t=[],e.length&&(n=e.toString().replace(Jn,""),i=n.match(Kn),o(i[1].split(Xn),function(e){e.replace(Qn,function(e,n,i){t.push(i)})})),e.$inject=t):Dn(e)?(r=e.length-1,ne(e[r],"fn"),t=e.slice(0,r)):ne(e,"fn",!0),t}function Me(e){function t(e){return function(t,n){return y(t)?void o(t,l(e)):e(t,n)}}function n(e,t){if(ie(e,"service"),
(C(t)||Dn(t))&&(t=_.instantiate(t)),!t.$get)throw Zn("pget","Provider '{0}' must define $get factory method.",e);return b[e+p]=t}function i(e,t){return n(e,{$get:t})}function r(e,t){return i(e,["$injector",function(e){return e.instantiate(t)}])}function s(e,t){return i(e,m(t))}function a(e,t){ie(e,"constant"),b[e]=t,x[e]=t}function c(e,t){var n=_.get(e+p),i=n.$get;n.$get=function(){var e=$.invoke(i,n);return $.invoke(t,null,{$delegate:e})}}function u(e){var t,n,i,r,s=[];return o(e,function(e){if(!v.get(e)){v.put(e,!0);try{if(w(e))for(t=_n(e),s=s.concat(u(t.requires)).concat(t._runBlocks),n=t._invokeQueue,i=0,r=n.length;r>i;i++){var o=n[i],a=_.get(o[0]);a[o[1]].apply(a,o[2])}else C(e)?s.push(_.invoke(e)):Dn(e)?s.push(_.invoke(e)):ne(e,"module")}catch(l){throw Dn(e)&&(e=e[e.length-1]),l.message&&l.stack&&-1==l.stack.indexOf(l.message)&&(l=l.message+"\n"+l.stack),Zn("modulerr","Failed to instantiate module {0} due to:\n{1}",e,l.stack||l.message||l)}}}),s}function h(e,t){function n(n){if(e.hasOwnProperty(n)){if(e[n]===d)throw Zn("cdep","Circular dependency found: {0}",n+" <- "+g.join(" <- "));return e[n]}try{return g.unshift(n),e[n]=d,e[n]=t(n)}catch(i){throw e[n]===d&&delete e[n],i}finally{g.shift()}}function i(e,t,i){var r,o,s,a=[],l=Ie(e);for(o=0,r=l.length;r>o;o++){if(s=l[o],"string"!=typeof s)throw Zn("itkn","Incorrect injection token! Expected service name as string, got {0}",s);a.push(i&&i.hasOwnProperty(s)?i[s]:n(s))}return Dn(e)&&(e=e[r]),e.apply(t,a)}function r(e,t){var n,r,o=function(){};return o.prototype=(Dn(e)?e[e.length-1]:e).prototype,n=new o,r=i(e,n,t),y(r)||C(r)?r:n}return{invoke:i,instantiate:r,get:n,annotate:Ie,has:function(t){return b.hasOwnProperty(t+p)||e.hasOwnProperty(t)}}}var d={},p="Provider",g=[],v=new Oe([],!0),b={$provide:{provider:t(n),factory:t(i),service:t(r),value:t(s),constant:t(a),decorator:c}},_=b.$injector=h(b,function(){throw Zn("unpr","Unknown provider: {0}",g.join(" <- "))}),x={},$=x.$injector=h(x,function(e){var t=_.get(e+p);return $.invoke(t.$get,t)});return o(u(e),function(e){$.invoke(e||f)}),$}function Pe(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(t,n,i){function r(e){var t=null;return o(e,function(e){t||"a"!==pn(e.nodeName)||(t=e)}),t}function s(){var e,i=n.hash();i?(e=a.getElementById(i))?e.scrollIntoView():(e=r(a.getElementsByName(i)))?e.scrollIntoView():"top"===i&&t.scrollTo(0,0):t.scrollTo(0,0)}var a=t.document;return e&&i.$watch(function(){return n.hash()},function(){i.$evalAsync(s)}),s}]}function Re(){this.$get=["$$rAF","$timeout",function(e,t){return e.supported?function(t){return e(t)}:function(e){return t(e,0,!1)}}]}function Ne(e,t,i,r){function s(e){try{e.apply(null,j(arguments,1))}finally{if(b--,0===b)for(;y.length;)try{y.pop()()}catch(t){i.error(t)}}}function a(e,t){!function n(){o(x,function(e){e()}),_=t(n,e)}()}function l(){k=null,C!=c.url()&&(C=c.url(),o(S,function(e){e(c.url())}))}var c=this,u=t[0],h=e.location,d=e.history,p=e.setTimeout,g=e.clearTimeout,m={};c.isMock=!1;var b=0,y=[];c.$$completeOutstandingRequest=s,c.$$incOutstandingRequestCount=function(){b++},c.notifyWhenNoOutstandingRequests=function(e){o(x,function(e){e()}),0===b?e():y.push(e)};var _,x=[];c.addPollFn=function(e){return v(_)&&a(100,p),x.push(e),e};var C=h.href,$=t.find("base"),k=null;c.url=function(t,n){if(h!==e.location&&(h=e.location),d!==e.history&&(d=e.history),t){if(C==t)return;return C=t,r.history?n?d.replaceState(null,"",t):(d.pushState(null,"",t),$.attr("href",$.attr("href"))):(k=t,n?h.replace(t):h.href=t),c}return k||h.href.replace(/%27/g,"'")};var S=[],T=!1;c.onUrlChange=function(t){return T||(r.history&&yn(e).on("popstate",l),r.hashchange?yn(e).on("hashchange",l):c.addPollFn(l),T=!0),S.push(t),t},c.$$checkUrlChange=l,c.baseHref=function(){var e=$.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""};var E={},D="",A=c.baseHref();c.cookies=function(e,t){var r,o,s,a,l;if(!e){if(u.cookie!==D)for(D=u.cookie,o=D.split("; "),E={},a=0;a<o.length;a++)s=o[a],l=s.indexOf("="),l>0&&(e=unescape(s.substring(0,l)),E[e]===n&&(E[e]=unescape(s.substring(l+1))));return E}t===n?u.cookie=escape(e)+"=;path="+A+";expires=Thu, 01 Jan 1970 00:00:00 GMT":w(t)&&(r=(u.cookie=escape(e)+"="+escape(t)+";path="+A).length+1,r>4096&&i.warn("Cookie '"+e+"' possibly not set or overflowed because it was too large ("+r+" > 4096 bytes)!"))},c.defer=function(e,t){var n;return b++,n=p(function(){delete m[n],s(e)},t||0),m[n]=!0,n},c.defer.cancel=function(e){return m[e]?(delete m[e],g(e),s(f),!0):!1}}function Fe(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,i){return new Ne(e,i,t,n)}]}function Le(){this.$get=function(){function e(e,n){function r(e){e!=d&&(p?p==e&&(p=e.n):p=e,o(e.n,e.p),o(e,d),d=e,d.n=null)}function o(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}if(e in t)throw i("$cacheFactory")("iid","CacheId '{0}' is already taken!",e);var s=0,a=h({},n,{id:e}),l={},c=n&&n.capacity||Number.MAX_VALUE,u={},d=null,p=null;return t[e]={put:function(e,t){if(c<Number.MAX_VALUE){var n=u[e]||(u[e]={key:e});r(n)}return v(t)?void 0:(e in l||s++,l[e]=t,s>c&&this.remove(p.key),t)},get:function(e){if(c<Number.MAX_VALUE){var t=u[e];if(!t)return;r(t)}return l[e]},remove:function(e){if(c<Number.MAX_VALUE){var t=u[e];if(!t)return;t==d&&(d=t.p),t==p&&(p=t.n),o(t.n,t.p),delete u[e]}delete l[e],s--},removeAll:function(){l={},s=0,u={},d=p=null},destroy:function(){l=null,a=null,u=null,delete t[e]},info:function(){return h({},a,{size:s})}}}var t={};return e.info=function(){var e={};return o(t,function(t,n){e[n]=t.info()}),e},e.get=function(e){return t[e]},e}}function je(){this.$get=["$cacheFactory",function(e){return e("templates")}]}function Ue(e,i){var r={},s="Directive",a=/^\s*directive\:\s*([\d\w_\-]+)\s+(.*)$/,c=/(([\d\w_\-]+)(?:\:([^;]+))?;?)/,u=/^(on[a-z]+|formaction)$/;this.directive=function d(t,n){return ie(t,"directive"),w(t)?(te(n,"directiveFactory"),r.hasOwnProperty(t)||(r[t]=[],e.factory(t+s,["$injector","$exceptionHandler",function(e,n){var i=[];return o(r[t],function(r,o){try{var s=e.invoke(r);C(s)?s={compile:m(s)}:!s.compile&&s.link&&(s.compile=m(s.link)),s.priority=s.priority||0,s.index=o,s.name=s.name||t,s.require=s.require||s.controller&&s.name,s.restrict=s.restrict||"A",i.push(s)}catch(a){n(a)}}),i}])),r[t].push(n)):o(t,l(d)),this},this.aHrefSanitizationWhitelist=function(e){return b(e)?(i.aHrefSanitizationWhitelist(e),this):i.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return b(e)?(i.imgSrcSanitizationWhitelist(e),this):i.imgSrcSanitizationWhitelist()},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(e,i,l,d,f,m,v,b,_,x,$,k){function S(e,t,n,i,r){e instanceof yn||(e=yn(e)),o(e,function(t,n){3==t.nodeType&&t.nodeValue.match(/\S+/)&&(e[n]=t=yn(t).wrap("<span></span>").parent()[0])});var s=E(e,t,e,n,i,r);return T(e,"ng-scope"),function(t,n,i,r){te(t,"scope");var a=n?Vn.clone.call(e):e;o(i,function(e,t){a.data("$"+t+"Controller",e)});for(var l=0,c=a.length;c>l;l++){var u=a[l],h=u.nodeType;(1===h||9===h)&&a.eq(l).data("$scope",t)}return n&&n(a,t),s&&s(t,a,a,r),a}}function T(e,t){try{e.addClass(t)}catch(n){}}function E(e,t,i,r,o,s){function a(e,i,r,o){var s,a,l,c,u,h,d,p,g=i.length,m=new Array(g);for(u=0;g>u;u++)m[u]=i[u];for(u=0,d=0,h=f.length;h>u;d++)l=m[d],s=f[u++],a=f[u++],s?(s.scope?(c=e.$new(),yn.data(l,"$scope",c)):c=e,p=s.transcludeOnThisElement?D(e,s.transclude,o):!s.templateOnThisElement&&o?o:!o&&t?D(e,t):null,s(a,c,l,r,p)):a&&a(e,l.childNodes,n,o)}for(var l,c,u,h,d,p,f=[],g=0;g<e.length;g++)l=new K,c=A(e[g],[],l,0===g?r:n,o),u=c.length?M(c,e[g],l,t,i,null,[],[],s):null,u&&u.scope&&T(l.$$element,"ng-scope"),d=u&&u.terminal||!(h=e[g].childNodes)||!h.length?null:E(h,u?(u.transcludeOnThisElement||!u.templateOnThisElement)&&u.transclude:t),f.push(u,d),p=p||u||d,s=null;return p?a:null}function D(e,t,n){var i=function(i,r,o){var s=!1;i||(i=e.$new(),i.$$transcluded=!0,s=!0);var a=t(i,r,o,n);return s&&a.on("$destroy",function(){i.$destroy()}),a};return i}function A(e,t,n,i,r){var o,s,l=e.nodeType,u=n.$attr;switch(l){case 1:R(t,He(xn(e).toLowerCase()),"E",i,r);for(var h,d,p,f,g,m,v=e.attributes,b=0,y=v&&v.length;y>b;b++){var _=!1,x=!1;if(h=v[b],!bn||bn>=8||h.specified){d=h.name,g=An(h.value),f=He(d),(m=ee.test(f))&&(d=Z(f.substr(6),"-"));var C=f.replace(/(Start|End)$/,"");f===C+"Start"&&(_=d,x=d.substr(0,d.length-5)+"end",d=d.substr(0,d.length-6)),p=He(d.toLowerCase()),u[p]=d,(m||!n.hasOwnProperty(p))&&(n[p]=g,Ee(e,p)&&(n[p]=!0)),V(e,t,g,p),R(t,p,"A",i,r,_,x)}}if(s=e.className,w(s)&&""!==s)for(;o=c.exec(s);)p=He(o[2]),R(t,p,"C",i,r)&&(n[p]=An(o[3])),s=s.substr(o.index+o[0].length);break;case 3:B(t,e.nodeValue);break;case 8:try{o=a.exec(e.nodeValue),o&&(p=He(o[1]),R(t,p,"M",i,r)&&(n[p]=An(o[2])))}catch($){}}return t.sort(H),t}function O(e,t,n){var i=[],r=0;if(t&&e.hasAttribute&&e.hasAttribute(t)){do{if(!e)throw ni("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);1==e.nodeType&&(e.hasAttribute(t)&&r++,e.hasAttribute(n)&&r--),i.push(e),e=e.nextSibling}while(r>0)}else i.push(e);return yn(i)}function I(e,t,n){return function(i,r,o,s,a){return r=O(r[0],t,n),e(i,r,o,s,a)}}function M(e,r,s,a,c,u,h,d,p){function f(e,t,n,i){e&&(n&&(e=I(e,n,i)),e.require=x.require,e.directiveName=$,(H===x||x.$$isolateScope)&&(e=G(e,{isolateScope:!0})),h.push(e)),t&&(n&&(t=I(t,n,i)),t.require=x.require,t.directiveName=$,(H===x||x.$$isolateScope)&&(t=G(t,{isolateScope:!0})),d.push(t))}function g(e,t,n,i){var r,s="data",a=!1;if(w(t)){for(;"^"==(r=t.charAt(0))||"?"==r;)t=t.substr(1),"^"==r&&(s="inheritedData"),a=a||"?"==r;if(r=null,i&&"data"===s&&(r=i[t]),r=r||n[s]("$"+t+"Controller"),!r&&!a)throw ni("ctreq","Controller '{0}', required by directive '{1}', can't be found!",t,e);return r}return Dn(t)&&(r=[],o(t,function(t){r.push(g(e,t,n,i))})),r}function b(e,t,a,c,u){function p(e,t){var i;return arguments.length<2&&(t=e,e=n),Q&&(i=k),u(e,t,i)}var f,b,y,w,_,x,C,$,k={};if(f=r===a?s:N(s,new K(yn(a),s.$attr)),b=f.$$element,H){var S=/^\s*([@=&])(\??)\s*(\w*)\s*$/;C=t.$new(!0),!B||B!==H&&B!==H.$$originalDirective?b.data("$isolateScopeNoTemplate",C):b.data("$isolateScope",C),T(b,"ng-isolate-scope"),o(H.scope,function(e,n){var r,o,s,a,l=e.match(S)||[],c=l[3]||n,u="?"==l[2],h=l[1];switch(C.$$isolateBindings[n]=h+c,h){case"@":f.$observe(c,function(e){C[n]=e}),f.$$observers[c].$$scope=t,f[c]&&(C[n]=i(f[c])(t));break;case"=":if(u&&!f[c])return;o=m(f[c]),a=o.literal?F:function(e,t){return e===t||e!==e&&t!==t},s=o.assign||function(){throw r=C[n]=o(t),ni("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",f[c],H.name)},r=C[n]=o(t),C.$watch(function(){var e=o(t);return a(e,C[n])||(a(e,r)?s(t,e=C[n]):C[n]=e),r=e},null,o.literal);break;case"&":o=m(f[c]),C[n]=function(e){return o(t,e)};break;default:throw ni("iscp","Invalid isolate scope definition for directive '{0}'. Definition: {... {1}: '{2}' ...}",H.name,n,e)}})}for($=u&&p,R&&o(R,function(e){var n,i={$scope:e===H||e.$$isolateScope?C:t,$element:b,$attrs:f,$transclude:$};x=e.controller,"@"==x&&(x=f[e.name]),n=v(x,i),k[e.name]=n,Q||b.data("$"+e.name+"Controller",n),e.controllerAs&&(i.$scope[e.controllerAs]=n)}),y=0,w=h.length;w>y;y++)try{(_=h[y])(_.isolateScope?C:t,b,f,_.require&&g(_.directiveName,_.require,b,k),$)}catch(E){l(E,q(b))}var D=t;for(H&&(H.template||null===H.templateUrl)&&(D=C),e&&e(D,a.childNodes,n,u),y=d.length-1;y>=0;y--)try{(_=d[y])(_.isolateScope?C:t,b,f,_.require&&g(_.directiveName,_.require,b,k),$)}catch(E){l(E,q(b))}}p=p||{};for(var _,x,$,k,E,D,M=-Number.MAX_VALUE,R=p.controllerDirectives,H=p.newIsolateScopeDirective,B=p.templateDirective,z=p.nonTlbTranscludeDirective,V=!1,X=!1,Q=p.hasElementTranscludeDirective,Z=s.$$element=yn(r),ee=u,te=a,ne=0,ie=e.length;ie>ne;ne++){x=e[ne];var re=x.$$start,oe=x.$$end;if(re&&(Z=O(r,re,oe)),k=n,M>x.priority)break;if((D=x.scope)&&(_=_||x,x.templateUrl||(W("new/isolated scope",H,x,Z),y(D)&&(H=x))),$=x.name,!x.templateUrl&&x.controller&&(D=x.controller,R=R||{},W("'"+$+"' controller",R[$],x,Z),R[$]=x),(D=x.transclude)&&(V=!0,x.$$tlb||(W("transclusion",z,x,Z),z=x),"element"==D?(Q=!0,M=x.priority,k=Z,Z=s.$$element=yn(t.createComment(" "+$+": "+s[$]+" ")),r=Z[0],Y(c,j(k),r),te=S(k,a,M,ee&&ee.name,{nonTlbTranscludeDirective:z})):(k=yn(ge(r)).contents(),Z.empty(),te=S(k,a))),x.template)if(X=!0,W("template",B,x,Z),B=x,D=C(x.template)?x.template(Z,s):x.template,D=J(D),x.replace){if(ee=x,k=he(D)?[]:yn(An(D)),r=k[0],1!=k.length||1!==r.nodeType)throw ni("tplrt","Template for directive '{0}' must have exactly one root element. {1}",$,"");Y(c,Z,r);var se={$attr:{}},ae=A(r,[],se),le=e.splice(ne+1,e.length-(ne+1));H&&P(ae),e=e.concat(ae).concat(le),L(s,se),ie=e.length}else Z.html(D);if(x.templateUrl)X=!0,W("template",B,x,Z),B=x,x.replace&&(ee=x),b=U(e.splice(ne,e.length-ne),Z,s,c,V&&te,h,d,{controllerDirectives:R,newIsolateScopeDirective:H,templateDirective:B,nonTlbTranscludeDirective:z}),ie=e.length;else if(x.compile)try{E=x.compile(Z,s,te),C(E)?f(null,E,re,oe):E&&f(E.pre,E.post,re,oe)}catch(ce){l(ce,q(Z))}x.terminal&&(b.terminal=!0,M=Math.max(M,x.priority))}return b.scope=_&&_.scope===!0,b.transcludeOnThisElement=V,b.templateOnThisElement=X,b.transclude=te,p.hasElementTranscludeDirective=Q,b}function P(e){for(var t=0,n=e.length;n>t;t++)e[t]=p(e[t],{$$isolateScope:!0})}function R(t,i,o,a,c,u,h){if(i===c)return null;var d=null;if(r.hasOwnProperty(i))for(var f,g=e.get(i+s),m=0,v=g.length;v>m;m++)try{f=g[m],(a===n||a>f.priority)&&-1!=f.restrict.indexOf(o)&&(u&&(f=p(f,{$$start:u,$$end:h})),t.push(f),d=f)}catch(b){l(b)}return d}function L(e,t){var n=t.$attr,i=e.$attr,r=e.$$element;o(e,function(i,r){"$"!=r.charAt(0)&&(t[r]&&t[r]!==i&&(i+=("style"===r?";":" ")+t[r]),e.$set(r,i,!0,n[r]))}),o(t,function(t,o){"class"==o?(T(r,t),e["class"]=(e["class"]?e["class"]+" ":"")+t):"style"==o?(r.attr("style",r.attr("style")+";"+t),e.style=(e.style?e.style+";":"")+t):"$"==o.charAt(0)||e.hasOwnProperty(o)||(e[o]=t,i[o]=n[o])})}function U(e,t,n,i,r,s,a,l){var c,u,p=[],g=t[0],m=e.shift(),v=h({},m,{templateUrl:null,transclude:null,replace:null,$$originalDirective:m}),b=C(m.templateUrl)?m.templateUrl(t,n):m.templateUrl;return t.empty(),d.get(x.getTrustedResourceUrl(b),{cache:f}).success(function(h){var d,f,w,_;if(h=J(h),m.replace){if(w=he(h)?[]:yn(An(h)),d=w[0],1!=w.length||1!==d.nodeType)throw ni("tplrt","Template for directive '{0}' must have exactly one root element. {1}",m.name,b);f={$attr:{}},Y(i,t,d);var x=A(d,[],f);y(m.scope)&&P(x),e=x.concat(e),L(n,f)}else d=g,t.html(h);for(e.unshift(v),c=M(e,d,n,r,t,m,s,a,l),o(i,function(e,n){e==d&&(i[n]=t[0])}),u=E(t[0].childNodes,r);p.length;){var C=p.shift(),$=p.shift(),k=p.shift(),S=p.shift(),O=t[0];if($!==g){var I=$.className;l.hasElementTranscludeDirective&&m.replace||(O=ge(d)),Y(k,yn($),O),T(yn(O),I)}_=c.transcludeOnThisElement?D(C,c.transclude,S):S,c(u,C,O,i,_)}p=null}).error(function(e,t,n,i){throw ni("tpload","Failed to load template: {0}",i.url)}),function(e,t,n,i,r){var o=r;p?(p.push(t),p.push(n),p.push(i),p.push(o)):(c.transcludeOnThisElement&&(o=D(t,c.transclude,r)),c(u,t,n,i,o))}}function H(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function W(e,t,n,i){if(t)throw ni("multidir","Multiple directives [{0}, {1}] asking for {2} on: {3}",t.name,n.name,e,q(i))}function B(e,t){var n=i(t,!0);n&&e.push({priority:0,compile:function(e){var t=e.parent(),i=t.length;return i&&T(e.parent(),"ng-binding"),function(e,t){var r=t.parent(),o=r.data("$binding")||[];o.push(n),r.data("$binding",o),i||T(r,"ng-binding"),e.$watch(n,function(e){t[0].nodeValue=e})}}})}function z(e,t){if("srcdoc"==t)return x.HTML;var n=xn(e);return"xlinkHref"==t||"FORM"==n&&"action"==t||"IMG"!=n&&("src"==t||"ngSrc"==t)?x.RESOURCE_URL:void 0}function V(e,t,n,r){var o=i(n,!0);if(o){if("multiple"===r&&"SELECT"===xn(e))throw ni("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",q(e));t.push({priority:100,compile:function(){return{pre:function(t,n,s){var a=s.$$observers||(s.$$observers={});if(u.test(r))throw ni("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");o=i(s[r],!0,z(e,r)),o&&(s[r]=o(t),(a[r]||(a[r]=[])).$$inter=!0,(s.$$observers&&s.$$observers[r].$$scope||t).$watch(o,function(e,t){"class"===r&&e!=t?s.$updateClass(e,t):s.$set(r,e)}))}}}})}}function Y(e,n,i){var r,o,s=n[0],a=n.length,l=s.parentNode;if(e)for(r=0,o=e.length;o>r;r++)if(e[r]==s){e[r++]=i;for(var c=r,u=c+a-1,h=e.length;h>c;c++,u++)h>u?e[c]=e[u]:delete e[c];e.length-=a-1;break}l&&l.replaceChild(i,s);var d=t.createDocumentFragment();d.appendChild(s),i[yn.expando]=s[yn.expando];for(var p=1,f=n.length;f>p;p++){var g=n[p];yn(g).remove(),d.appendChild(g),delete n[p]}n[0]=i,n.length=1}function G(e,t){return h(function(){return e.apply(null,arguments)},e,t)}var K=function(e,t){this.$$element=e,this.$attr=t||{}};K.prototype={$normalize:He,$addClass:function(e){e&&e.length>0&&$.addClass(this.$$element,e)},$removeClass:function(e){e&&e.length>0&&$.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=We(e,t),i=We(t,e);0===n.length?$.removeClass(this.$$element,i):0===i.length?$.addClass(this.$$element,n):$.setClass(this.$$element,n,i)},$set:function(e,t,i,r){var s,a=Ee(this.$$element[0],e);a&&(this.$$element.prop(e,t),r=a),this[e]=t,r?this.$attr[e]=r:(r=this.$attr[e],r||(this.$attr[e]=r=Z(e,"-"))),s=xn(this.$$element),("A"===s&&"href"===e||"IMG"===s&&"src"===e)&&(this[e]=t=k(t,"src"===e)),i!==!1&&(null===t||t===n?this.$$element.removeAttr(r):this.$$element.attr(r,t));var c=this.$$observers;c&&o(c[e],function(e){try{e(t)}catch(n){l(n)}})},$observe:function(e,t){var n=this,i=n.$$observers||(n.$$observers={}),r=i[e]||(i[e]=[]);return r.push(t),b.$evalAsync(function(){r.$$inter||t(n[e])}),t}};var X=i.startSymbol(),Q=i.endSymbol(),J="{{"==X||"}}"==Q?g:function(e){return e.replace(/\{\{/g,X).replace(/}}/g,Q)},ee=/^ngAttr[A-Z]/;return S}]}function He(e){return ce(e.replace(ii,""))}function We(e,t){var n="",i=e.split(/\s+/),r=t.split(/\s+/);e:for(var o=0;o<i.length;o++){for(var s=i[o],a=0;a<r.length;a++)if(s==r[a])continue e;n+=(n.length>0?" ":"")+s}return n}function Be(){var e={},t=/^(\S+)(\s+as\s+(\w+))?$/;this.register=function(t,n){ie(t,"controller"),y(t)?h(e,t):e[t]=n},this.$get=["$injector","$window",function(n,r){return function(o,s){var a,l,c,u;if(w(o)&&(l=o.match(t),c=l[1],u=l[3],o=e.hasOwnProperty(c)?e[c]:re(s.$scope,c,!0)||re(r,c,!0),ne(o,c,!0)),a=n.instantiate(o,s),u){if(!s||"object"!=typeof s.$scope)throw i("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",c||o.name,u);s.$scope[u]=a}return a}}]}function ze(){this.$get=["$window",function(e){return yn(e.document)}]}function qe(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}function Ve(e){var t,n,i,r={};return e?(o(e.split("\n"),function(e){i=e.indexOf(":"),t=pn(An(e.substr(0,i))),n=An(e.substr(i+1)),t&&(r[t]=r[t]?r[t]+", "+n:n)}),r):r}function Ye(e){var t=y(e)?e:n;return function(n){return t||(t=Ve(e)),n?t[pn(n)]||null:t}}function Ge(e,t,n){return C(n)?n(e,t):(o(n,function(n){e=n(e,t)}),e)}function Ke(e){return e>=200&&300>e}function Xe(){var e=/^\s*(\[|\{[^\{])/,t=/[\}\]]\s*$/,i=/^\)\]\}',?\n/,r={"Content-Type":"application/json;charset=utf-8"},s=this.defaults={transformResponse:[function(n){return w(n)&&(n=n.replace(i,""),e.test(n)&&t.test(n)&&(n=B(n))),n}],transformRequest:[function(e){return!y(e)||T(e)||E(e)?e:W(e)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:N(r),put:N(r),patch:N(r)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN"},l=this.interceptors=[],c=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function(e,t,i,r,u,d){function p(e){function t(e){var t=h({},e,{data:Ge(e.data,e.headers,r.transformResponse)});return Ke(e.status)?t:u.reject(t)}function i(e){function t(e){var t;o(e,function(n,i){C(n)&&(t=n(),null!=t?e[i]=t:delete e[i])})}var n,i,r,a=s.headers,l=h({},e.headers);a=h({},a.common,a[pn(e.method)]);e:for(n in a){i=pn(n);for(r in l)if(pn(r)===i)continue e;l[n]=a[n]}return t(l),l}var r={method:"get",transformRequest:s.transformRequest,transformResponse:s.transformResponse},a=i(e);h(r,e),r.headers=a,r.method=gn(r.method);var l=function(e){a=e.headers;var n=Ge(e.data,Ye(a),e.transformRequest);return v(n)&&o(a,function(e,t){"content-type"===pn(t)&&delete a[t]}),v(e.withCredentials)&&!v(s.withCredentials)&&(e.withCredentials=s.withCredentials),m(e,n,a).then(t,t)},c=[l,n],d=u.when(r);for(o(k,function(e){(e.request||e.requestError)&&c.unshift(e.request,e.requestError),(e.response||e.responseError)&&c.push(e.response,e.responseError)});c.length;){var p=c.shift(),f=c.shift();d=d.then(p,f)}return d.success=function(e){return d.then(function(t){e(t.data,t.status,t.headers,r)}),d},d.error=function(e){return d.then(null,function(t){e(t.data,t.status,t.headers,r)}),d},d}function f(e){o(arguments,function(e){p[e]=function(t,n){return p(h(n||{},{method:e,url:t}))}})}function g(e){o(arguments,function(e){p[e]=function(t,n,i){return p(h(i||{},{method:e,url:t,data:n}))}})}function m(i,o,a){function l(e,t,n,i){d&&(Ke(e)?d.put(w,[e,t,Ve(n),i]):d.remove(w)),c(t,e,n,i),r.$$phase||r.$apply()}function c(e,t,n,r){t=Math.max(t,0),(Ke(t)?g.resolve:g.reject)({data:e,status:t,headers:Ye(n),config:i,statusText:r})}function h(){var e=M(p.pendingRequests,i);-1!==e&&p.pendingRequests.splice(e,1)}var d,f,g=u.defer(),m=g.promise,w=_(i.url,i.params);if(p.pendingRequests.push(i),m.then(h,h),!i.cache&&!s.cache||i.cache===!1||"GET"!==i.method&&"JSONP"!==i.method||(d=y(i.cache)?i.cache:y(s.cache)?s.cache:$),d)if(f=d.get(w),b(f)){if(D(f))return f.then(h,h),f;Dn(f)?c(f[1],f[0],N(f[2]),f[3]):c(f,200,{},"OK")}else d.put(w,m);if(v(f)){var x=Ft(i.url)?t.cookies()[i.xsrfCookieName||s.xsrfCookieName]:n;x&&(a[i.xsrfHeaderName||s.xsrfHeaderName]=x),e(i.method,w,o,l,a,i.timeout,i.withCredentials,i.responseType)}return m}function _(e,t){if(!t)return e;var n=[];return a(t,function(e,t){null===e||v(e)||(Dn(e)||(e=[e]),o(e,function(e){y(e)&&(e=x(e)?e.toISOString():W(e)),n.push(X(t)+"="+X(e))}))}),n.length>0&&(e+=(-1==e.indexOf("?")?"?":"&")+n.join("&")),e}var $=i("$http"),k=[];return o(l,function(e){k.unshift(w(e)?d.get(e):d.invoke(e))}),o(c,function(e,t){var n=w(e)?d.get(e):d.invoke(e);k.splice(t,0,{response:function(e){return n(u.when(e))},responseError:function(e){return n(u.reject(e))}})}),p.pendingRequests=[],f("get","delete","head","jsonp"),g("post","put"),p.defaults=s,p}]}function Qe(t){if(8>=bn&&(!t.match(/^(get|post|head|put|delete|options)$/i)||!e.XMLHttpRequest))return new e.ActiveXObject("Microsoft.XMLHTTP");if(e.XMLHttpRequest)return new e.XMLHttpRequest;throw i("$httpBackend")("noxhr","This browser does not support XMLHttpRequest.")}function Je(){this.$get=["$browser","$window","$document",function(e,t,n){return Ze(e,Qe,e.defer,t.angular.callbacks,n[0])}]}function Ze(e,t,n,i,r){function s(e,t,n){var o=r.createElement("script"),s=null;return o.type="text/javascript",o.src=e,o.async=!0,s=function(e){Fn(o,"load",s),Fn(o,"error",s),r.body.removeChild(o),o=null;var a=-1,l="unknown";e&&("load"!==e.type||i[t].called||(e={type:"error"}),l=e.type,a="error"===e.type?404:200),n&&n(a,l)},Nn(o,"load",s),Nn(o,"error",s),8>=bn&&(o.onreadystatechange=function(){w(o.readyState)&&/loaded|complete/.test(o.readyState)&&(o.onreadystatechange=null,s({type:"load"}))}),r.body.appendChild(o),s}var a=-1;return function(r,l,c,u,h,d,p,g){function m(){y=a,_&&_(),x&&x.abort()}function v(t,i,r,o,s){$&&n.cancel($),_=x=null,0===i&&(i=r?200:"file"==Nt(l).protocol?404:0),i=1223===i?204:i,s=s||"",t(i,r,o,s),e.$$completeOutstandingRequest(f)}var y;if(e.$$incOutstandingRequestCount(),l=l||e.url(),"jsonp"==pn(r)){var w="_"+(i.counter++).toString(36);i[w]=function(e){i[w].data=e,i[w].called=!0};var _=s(l.replace("JSON_CALLBACK","angular.callbacks."+w),w,function(e,t){v(u,e,i[w].data,"",t),i[w]=f})}else{var x=t(r);if(x.open(r,l,!0),o(h,function(e,t){b(e)&&x.setRequestHeader(t,e)}),x.onreadystatechange=function(){if(x&&4==x.readyState){var e=null,t=null,n="";y!==a&&(e=x.getAllResponseHeaders(),t="response"in x?x.response:x.responseText),y===a&&10>bn||(n=x.statusText),v(u,y||x.status,t,e,n)}},p&&(x.withCredentials=!0),g)try{x.responseType=g}catch(C){if("json"!==g)throw C}x.send(c||null)}if(d>0)var $=n(m,d);else D(d)&&d.then(m)}}function et(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,i,r){function o(o,l,c){for(var u,h,d,p,f=0,g=[],m=o.length,v=!1,b=[];m>f;)-1!=(u=o.indexOf(e,f))&&-1!=(h=o.indexOf(t,u+s))?(f!=u&&g.push(o.substring(f,u)),g.push(d=n(p=o.substring(u+s,h))),d.exp=p,f=h+a,v=!0):(f!=m&&g.push(o.substring(f)),f=m);if((m=g.length)||(g.push(""),m=1),c&&g.length>1)throw ri("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",o);return!l||v?(b.length=m,d=function(e){try{for(var t,n=0,s=m;s>n;n++){if("function"==typeof(t=g[n]))if(t=t(e),t=c?r.getTrusted(c,t):r.valueOf(t),null==t)t="";else switch(typeof t){case"string":break;case"number":t=""+t;break;default:t=W(t)}b[n]=t}return b.join("")}catch(a){var l=ri("interr","Can't interpolate: {0}\n{1}",o,a.toString());i(l)}},d.exp=o,d.parts=g,d):void 0}var s=e.length,a=t.length;return o.startSymbol=function(){return e},o.endSymbol=function(){return t},o}]}function tt(){this.$get=["$rootScope","$window","$q",function(e,t,n){function i(i,o,s,a){var l=t.setInterval,c=t.clearInterval,u=n.defer(),h=u.promise,d=0,p=b(a)&&!a;return s=b(s)?s:0,h.then(null,null,i),h.$$intervalId=l(function(){u.notify(d++),s>0&&d>=s&&(u.resolve(d),c(h.$$intervalId),delete r[h.$$intervalId]),p||e.$apply()},o),r[h.$$intervalId]=u,h}var r={};return i.cancel=function(e){return e&&e.$$intervalId in r?(r[e.$$intervalId].reject("canceled"),t.clearInterval(e.$$intervalId),delete r[e.$$intervalId],!0):!1},i}]}function nt(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(e){return 1===e?"one":"other"}}}}function it(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=K(t[n]);return t.join("/")}function rt(e,t,n){var i=Nt(e,n);t.$$protocol=i.protocol,t.$$host=i.hostname,t.$$port=d(i.port)||si[i.protocol]||null}function ot(e,t,n){var i="/"!==e.charAt(0);i&&(e="/"+e);var r=Nt(e,n);t.$$path=decodeURIComponent(i&&"/"===r.pathname.charAt(0)?r.pathname.substring(1):r.pathname),t.$$search=Y(r.search),t.$$hash=decodeURIComponent(r.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function st(e,t){return 0===t.indexOf(e)?t.substr(e.length):void 0}function at(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function lt(e){return e.substr(0,at(e).lastIndexOf("/")+1)}function ct(e){return e.substring(0,e.indexOf("/",e.indexOf("//")+2))}function ut(e,t){this.$$html5=!0,t=t||"";var i=lt(e);rt(e,this,e),this.$$parse=function(t){var n=st(i,t);if(!w(n))throw ai("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',t,i);ot(n,this,e),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=G(this.$$search),t=this.$$hash?"#"+K(this.$$hash):"";this.$$url=it(this.$$path)+(e?"?"+e:"")+t,this.$$absUrl=i+this.$$url.substr(1)},this.$$rewrite=function(r){var o,s;return(o=st(e,r))!==n?(s=o,(o=st(t,o))!==n?i+(st("/",o)||o):e+s):(o=st(i,r))!==n?i+o:i==r+"/"?i:void 0}}function ht(e,t){var n=lt(e);rt(e,this,e),this.$$parse=function(i){function r(e,t,n){var i,r=/^\/[A-Z]:(\/.*)/;return 0===t.indexOf(n)&&(t=t.replace(n,"")),r.exec(t)?e:(i=r.exec(e),i?i[1]:e)}var o=st(e,i)||st(n,i),s="#"==o.charAt(0)?st(t,o):this.$$html5?o:"";if(!w(s))throw ai("ihshprfx",'Invalid url "{0}", missing hash prefix "{1}".',i,t);ot(s,this,e),this.$$path=r(this.$$path,s,e),this.$$compose()},this.$$compose=function(){var n=G(this.$$search),i=this.$$hash?"#"+K(this.$$hash):"";this.$$url=it(this.$$path)+(n?"?"+n:"")+i,this.$$absUrl=e+(this.$$url?t+this.$$url:"")},this.$$rewrite=function(t){return at(e)==at(t)?t:void 0}}function dt(e,t){this.$$html5=!0,ht.apply(this,arguments);var n=lt(e);this.$$rewrite=function(i){var r;return e==at(i)?i:(r=st(n,i))?e+t+r:n===i+"/"?n:void 0},this.$$compose=function(){var n=G(this.$$search),i=this.$$hash?"#"+K(this.$$hash):"";this.$$url=it(this.$$path)+(n?"?"+n:"")+i,this.$$absUrl=e+t+this.$$url}}function pt(e){return function(){return this[e]}}function ft(e,t){return function(n){return v(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function gt(){var t="",n=!1;this.hashPrefix=function(e){return b(e)?(t=e,this):t},this.html5Mode=function(e){return b(e)?(n=e,this):n},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function(i,r,o,s){function a(e){i.$broadcast("$locationChangeSuccess",l.absUrl(),e)}var l,c,u,h=r.baseHref(),d=r.url();n?(u=ct(d)+(h||"/"),c=o.history?ut:dt):(u=at(d),c=ht),l=new c(u,"#"+t),l.$$parse(l.$$rewrite(d));var p=/^\s*(javascript|mailto):/i;s.on("click",function(n){if(!n.ctrlKey&&!n.metaKey&&2!=n.which){for(var o=yn(n.target);"a"!==pn(o[0].nodeName);)if(o[0]===s[0]||!(o=o.parent())[0])return;var a=o.prop("href");if(y(a)&&"[object SVGAnimatedString]"===a.toString()&&(a=Nt(a.animVal).href),!p.test(a)){if(c===dt){var h=o.attr("href")||o.attr("xlink:href");if(h&&h.indexOf("://")<0){var d="#"+t;if("/"==h[0])a=u+d+h;else if("#"==h[0])a=u+d+(l.path()||"/")+h;else{var f=l.path().split("/"),g=h.split("/");2!==f.length||f[1]||(f.length=1);for(var m=0;m<g.length;m++)"."!=g[m]&&(".."==g[m]?f.pop():g[m].length&&f.push(g[m]));a=u+d+f.join("/")}}}var v=l.$$rewrite(a);a&&!o.attr("target")&&v&&!n.isDefaultPrevented()&&(n.preventDefault(),v!=r.url()&&(l.$$parse(v),i.$apply(),e.angular["ff-684208-preventDefault"]=!0))}}}),l.absUrl()!=d&&r.url(l.absUrl(),!0),r.onUrlChange(function(e){l.absUrl()!=e&&(i.$evalAsync(function(){var t=l.absUrl();l.$$parse(e),i.$broadcast("$locationChangeStart",e,t).defaultPrevented?(l.$$parse(t),r.url(t)):a(t)}),i.$$phase||i.$digest())});var f=0;return i.$watch(function(){var e=r.url(),t=l.$$replace;return f&&e==l.absUrl()||(f++,i.$evalAsync(function(){i.$broadcast("$locationChangeStart",l.absUrl(),e).defaultPrevented?l.$$parse(e):(r.url(l.absUrl(),t),a(e))})),l.$$replace=!1,f}),l}]}function mt(){var e=!0,t=this;this.debugEnabled=function(t){return b(t)?(e=t,this):e},this.$get=["$window",function(n){function i(e){return e instanceof Error&&(e.stack?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}function r(e){var t=n.console||{},r=t[e]||t.log||f,s=!1;try{s=!!r.apply}catch(a){}return s?function(){var e=[];return o(arguments,function(t){e.push(i(t))}),r.apply(t,e)}:function(e,t){r(e,null==t?"":t)}}return{log:r("log"),info:r("info"),warn:r("warn"),error:r("error"),debug:function(){var n=r("debug");return function(){e&&n.apply(t,arguments);
}}()}}]}function vt(e,t){if("__defineGetter__"===e||"__defineSetter__"===e||"__lookupGetter__"===e||"__lookupSetter__"===e||"__proto__"===e)throw ci("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",t);return e}function bt(e,t){if(e){if(e.constructor===e)throw ci("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e.document&&e.location&&e.alert&&e.setInterval)throw ci("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw ci("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",t);if(e===Object)throw ci("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",t)}return e}function yt(e,t){if(e){if(e.constructor===e)throw ci("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e===hi||e===di||pi&&e===pi)throw ci("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",t)}}function wt(e,t,i,r,o){bt(e,r),o=o||{};for(var s,a=t.split("."),l=0;a.length>1;l++){s=vt(a.shift(),r);var c=bt(e[s],r);c||(c={},e[s]=c),e=c,e.then&&o.unwrapPromises&&(li(r),"$$v"in e||!function(e){e.then(function(t){e.$$v=t})}(e),e.$$v===n&&(e.$$v={}),e=e.$$v)}return s=vt(a.shift(),r),bt(e[s],r),e[s]=i,i}function _t(e,t,i,r,o,s,a){return vt(e,s),vt(t,s),vt(i,s),vt(r,s),vt(o,s),a.unwrapPromises?function(a,l){var c,u=l&&l.hasOwnProperty(e)?l:a;return null==u?u:(u=u[e],u&&u.then&&(li(s),"$$v"in u||(c=u,c.$$v=n,c.then(function(e){c.$$v=e})),u=u.$$v),t?null==u?n:(u=u[t],u&&u.then&&(li(s),"$$v"in u||(c=u,c.$$v=n,c.then(function(e){c.$$v=e})),u=u.$$v),i?null==u?n:(u=u[i],u&&u.then&&(li(s),"$$v"in u||(c=u,c.$$v=n,c.then(function(e){c.$$v=e})),u=u.$$v),r?null==u?n:(u=u[r],u&&u.then&&(li(s),"$$v"in u||(c=u,c.$$v=n,c.then(function(e){c.$$v=e})),u=u.$$v),o?null==u?n:(u=u[o],u&&u.then&&(li(s),"$$v"in u||(c=u,c.$$v=n,c.then(function(e){c.$$v=e})),u=u.$$v),u):u):u):u):u)}:function(s,a){var l=a&&a.hasOwnProperty(e)?a:s;return null==l?l:(l=l[e],t?null==l?n:(l=l[t],i?null==l?n:(l=l[i],r?null==l?n:(l=l[r],o?null==l?n:l=l[o]:l):l):l):l)}}function xt(e,t,i){if(bi.hasOwnProperty(e))return bi[e];var r,s=e.split("."),a=s.length;if(t.csp)r=6>a?_t(s[0],s[1],s[2],s[3],s[4],i,t):function(e,r){var o,l=0;do o=_t(s[l++],s[l++],s[l++],s[l++],s[l++],i,t)(e,r),r=n,e=o;while(a>l);return o};else{var l="var p;\n";o(s,function(e,n){vt(e,i),l+="if(s == null) return undefined;\ns="+(n?"s":'((k&&k.hasOwnProperty("'+e+'"))?k:s)')+'["'+e+'"];\n'+(t.unwrapPromises?'if (s && s.then) {\n pw("'+i.replace(/(["\r\n])/g,"\\$1")+'");\n if (!("$$v" in s)) {\n p=s;\n p.$$v = undefined;\n p.then(function(v) {p.$$v=v;});\n}\n s=s.$$v\n}\n':"")}),l+="return s;";var c=new Function("s","k","pw",l);c.toString=m(l),r=t.unwrapPromises?function(e,t){return c(e,t,li)}:c}return"hasOwnProperty"!==e&&(bi[e]=r),r}function Ct(){var e={},t={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0};this.unwrapPromises=function(e){return b(e)?(t.unwrapPromises=!!e,this):t.unwrapPromises},this.logPromiseWarnings=function(e){return b(e)?(t.logPromiseWarnings=e,this):t.logPromiseWarnings},this.$get=["$filter","$sniffer","$log",function(n,i,r){return t.csp=i.csp,li=function(e){t.logPromiseWarnings&&!ui.hasOwnProperty(e)&&(ui[e]=!0,r.warn("[$parse] Promise found in the expression `"+e+"`. Automatic unwrapping of promises in Angular expressions is deprecated."))},function(i){var r;switch(typeof i){case"string":if(e.hasOwnProperty(i))return e[i];var o=new mi(t),s=new vi(o,n,t);return r=s.parse(i),"hasOwnProperty"!==i&&(e[i]=r),r;case"function":return i;default:return f}}}]}function $t(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return kt(function(t){e.$evalAsync(t)},t)}]}function kt(e,t){function i(e){return e}function r(e){return c(e)}function s(e){var t=a(),n=0,i=Dn(e)?[]:{};return o(e,function(e,r){n++,l(e).then(function(e){i.hasOwnProperty(r)||(i[r]=e,--n||t.resolve(i))},function(e){i.hasOwnProperty(r)||t.reject(e)})}),0===n&&t.resolve(i),t.promise}var a=function(){var o,s,c=[];return s={resolve:function(t){if(c){var i=c;c=n,o=l(t),i.length&&e(function(){for(var e,t=0,n=i.length;n>t;t++)e=i[t],o.then(e[0],e[1],e[2])})}},reject:function(e){s.resolve(u(e))},notify:function(t){if(c){var n=c;c.length&&e(function(){for(var e,i=0,r=n.length;r>i;i++)e=n[i],e[2](t)})}},promise:{then:function(e,n,s){var l=a(),u=function(n){try{l.resolve((C(e)?e:i)(n))}catch(r){l.reject(r),t(r)}},h=function(e){try{l.resolve((C(n)?n:r)(e))}catch(i){l.reject(i),t(i)}},d=function(e){try{l.notify((C(s)?s:i)(e))}catch(n){t(n)}};return c?c.push([u,h,d]):o.then(u,h,d),l.promise},"catch":function(e){return this.then(null,e)},"finally":function(e){function t(e,t){var n=a();return t?n.resolve(e):n.reject(e),n.promise}function n(n,r){var o=null;try{o=(e||i)()}catch(s){return t(s,!1)}return D(o)?o.then(function(){return t(n,r)},function(e){return t(e,!1)}):t(n,r)}return this.then(function(e){return n(e,!0)},function(e){return n(e,!1)})}}}},l=function(t){return D(t)?t:{then:function(n){var i=a();return e(function(){i.resolve(n(t))}),i.promise}}},c=function(e){var t=a();return t.reject(e),t.promise},u=function(n){return{then:function(i,o){var s=a();return e(function(){try{s.resolve((C(o)?o:r)(n))}catch(e){s.reject(e),t(e)}}),s.promise}}},h=function(n,o,s,u){var h,d=a(),p=function(e){try{return(C(o)?o:i)(e)}catch(n){return t(n),c(n)}},f=function(e){try{return(C(s)?s:r)(e)}catch(n){return t(n),c(n)}},g=function(e){try{return(C(u)?u:i)(e)}catch(n){t(n)}};return e(function(){l(n).then(function(e){h||(h=!0,d.resolve(l(e).then(p,f,g)))},function(e){h||(h=!0,d.resolve(f(e)))},function(e){h||d.notify(g(e))})}),d.promise};return{defer:a,reject:c,when:h,all:s}}function St(){this.$get=["$window","$timeout",function(e,t){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame,i=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,r=!!n,o=r?function(e){var t=n(e);return function(){i(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};return o.supported=r,o}]}function Tt(){var e=10,t=i("$rootScope"),n=null;this.digestTtl=function(t){return arguments.length&&(e=t),e},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(i,s,a,l){function u(){this.$id=c(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$postDigestQueue=[],this.$$listeners={},this.$$listenerCount={},this.$$isolateBindings={}}function h(e){if(v.$$phase)throw t("inprog","{0} already in progress",v.$$phase);v.$$phase=e}function d(){v.$$phase=null}function p(e,t){var n=a(e);return ne(n,t),n}function g(e,t,n){do e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n];while(e=e.$parent)}function m(){}u.prototype={constructor:u,$new:function(e){var t;return e?(t=new u,t.$root=this.$root,t.$$asyncQueue=this.$$asyncQueue,t.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$id=c(),this.$$childScopeClass=null},this.$$childScopeClass.prototype=this),t=new this.$$childScopeClass),t["this"]=t,t.$parent=this,t.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=t,this.$$childTail=t):this.$$childHead=this.$$childTail=t,t},$watch:function(e,t,i){var r=this,o=p(e,"watch"),s=r.$$watchers,a={fn:t,last:m,get:o,exp:e,eq:!!i};if(n=null,!C(t)){var l=p(t||f,"listener");a.fn=function(e,t,n){l(n)}}if("string"==typeof e&&o.constant){var c=a.fn;a.fn=function(e,t,n){c.call(this,e,t,n),P(s,a)}}return s||(s=r.$$watchers=[]),s.unshift(a),function(){P(s,a),n=null}},$watchCollection:function(e,t){function n(){o=d(c);var e,t,n;if(y(o))if(r(o)){s!==p&&(s=p,m=s.length=0,h++),e=o.length,m!==e&&(h++,s.length=m=e);for(var i=0;e>i;i++)n=s[i]!==s[i]&&o[i]!==o[i],n||s[i]===o[i]||(h++,s[i]=o[i])}else{s!==f&&(s=f={},m=0,h++),e=0;for(t in o)o.hasOwnProperty(t)&&(e++,s.hasOwnProperty(t)?(n=s[t]!==s[t]&&o[t]!==o[t],n||s[t]===o[t]||(h++,s[t]=o[t])):(m++,s[t]=o[t],h++));if(m>e){h++;for(t in s)s.hasOwnProperty(t)&&!o.hasOwnProperty(t)&&(m--,delete s[t])}}else s!==o&&(s=o,h++);return h}function i(){if(g?(g=!1,t(o,o,c)):t(o,l,c),u)if(y(o))if(r(o)){l=new Array(o.length);for(var e=0;e<o.length;e++)l[e]=o[e]}else{l={};for(var n in o)fn.call(o,n)&&(l[n]=o[n])}else l=o}var o,s,l,c=this,u=t.length>1,h=0,d=a(e),p=[],f={},g=!0,m=0;return this.$watch(n,i)},$digest:function(){var i,r,o,a,c,u,p,f,g,v,b,y=this.$$asyncQueue,w=this.$$postDigestQueue,_=e,x=this,$=[];h("$digest"),l.$$checkUrlChange(),n=null;do{for(u=!1,f=x;y.length;){try{b=y.shift(),b.scope.$eval(b.expression)}catch(k){d(),s(k)}n=null}e:do{if(a=f.$$watchers)for(c=a.length;c--;)try{if(i=a[c])if((r=i.get(f))===(o=i.last)||(i.eq?F(r,o):"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))){if(i===n){u=!1;break e}}else u=!0,n=i,i.last=i.eq?R(r,null):r,i.fn(r,o===m?r:o,f),5>_&&(g=4-_,$[g]||($[g]=[]),v=C(i.exp)?"fn: "+(i.exp.name||i.exp.toString()):i.exp,v+="; newVal: "+W(r)+"; oldVal: "+W(o),$[g].push(v))}catch(k){d(),s(k)}if(!(p=f.$$childHead||f!==x&&f.$$nextSibling))for(;f!==x&&!(p=f.$$nextSibling);)f=f.$parent}while(f=p);if((u||y.length)&&!_--)throw d(),t("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",e,W($))}while(u||y.length);for(d();w.length;)try{w.shift()()}catch(k){s(k)}},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this!==v&&(o(this.$$listenerCount,U(null,g,this)),e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=null,this.$$listeners={},this.$$watchers=this.$$asyncQueue=this.$$postDigestQueue=[],this.$destroy=this.$digest=this.$apply=f,this.$on=this.$watch=function(){return f})}},$eval:function(e,t){return a(e)(this,t)},$evalAsync:function(e){v.$$phase||v.$$asyncQueue.length||l.defer(function(){v.$$asyncQueue.length&&v.$digest()}),this.$$asyncQueue.push({scope:this,expression:e})},$$postDigest:function(e){this.$$postDigestQueue.push(e)},$apply:function(e){try{return h("$apply"),this.$eval(e)}catch(t){s(t)}finally{d();try{v.$digest()}catch(t){throw s(t),t}}},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);var i=this;do i.$$listenerCount[e]||(i.$$listenerCount[e]=0),i.$$listenerCount[e]++;while(i=i.$parent);var r=this;return function(){n[M(n,t)]=null,g(r,1,e)}},$emit:function(e,t){var n,i,r,o=[],a=this,l=!1,c={name:e,targetScope:a,stopPropagation:function(){l=!0},preventDefault:function(){c.defaultPrevented=!0},defaultPrevented:!1},u=L([c],arguments,1);do{for(n=a.$$listeners[e]||o,c.currentScope=a,i=0,r=n.length;r>i;i++)if(n[i])try{n[i].apply(null,u)}catch(h){s(h)}else n.splice(i,1),i--,r--;if(l)return c;a=a.$parent}while(a);return c},$broadcast:function(e,t){for(var n,i,r,o=this,a=o,l=o,c={name:e,targetScope:o,preventDefault:function(){c.defaultPrevented=!0},defaultPrevented:!1},u=L([c],arguments,1);a=l;){for(c.currentScope=a,n=a.$$listeners[e]||[],i=0,r=n.length;r>i;i++)if(n[i])try{n[i].apply(null,u)}catch(h){s(h)}else n.splice(i,1),i--,r--;if(!(l=a.$$listenerCount[e]&&a.$$childHead||a!==o&&a.$$nextSibling))for(;a!==o&&!(l=a.$$nextSibling);)a=a.$parent}return c}};var v=new u;return v}]}function Et(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file):|data:image\/)/;this.aHrefSanitizationWhitelist=function(t){return b(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return b(e)?(t=e,this):t},this.$get=function(){return function(n,i){var r,o=i?t:e;return bn&&!(bn>=8)||(r=Nt(n).href,""===r||r.match(o))?n:"unsafe:"+r}}}function Dt(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}function At(e){if("self"===e)return e;if(w(e)){if(e.indexOf("***")>-1)throw yi("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=Dt(e).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+e+"$")}if($(e))return new RegExp("^"+e.source+"$");throw yi("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function Ot(e){var t=[];return b(e)&&o(e,function(e){t.push(At(e))}),t}function It(){this.SCE_CONTEXTS=wi;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=Ot(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=Ot(e)),t},this.$get=["$injector",function(i){function r(e,t){return"self"===e?Ft(t):!!e.exec(t.href)}function o(n){var i,o,s=Nt(n.toString()),a=!1;for(i=0,o=e.length;o>i;i++)if(r(e[i],s)){a=!0;break}if(a)for(i=0,o=t.length;o>i;i++)if(r(t[i],s)){a=!1;break}return a}function s(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}function a(e,t){var i=d.hasOwnProperty(e)?d[e]:null;if(!i)throw yi("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null===t||t===n||""===t)return t;if("string"!=typeof t)throw yi("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new i(t)}function l(e){return e instanceof h?e.$$unwrapTrustedValue():e}function c(e,t){if(null===t||t===n||""===t)return t;var i=d.hasOwnProperty(e)?d[e]:null;if(i&&t instanceof i)return t.$$unwrapTrustedValue();if(e===wi.RESOURCE_URL){if(o(t))return t;throw yi("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",t.toString())}if(e===wi.HTML)return u(t);throw yi("unsafe","Attempting to use an unsafe value in a safe context.")}var u=function(e){throw yi("unsafe","Attempting to use an unsafe value in a safe context.")};i.has("$sanitize")&&(u=i.get("$sanitize"));var h=s(),d={};return d[wi.HTML]=s(h),d[wi.CSS]=s(h),d[wi.URL]=s(h),d[wi.JS]=s(h),d[wi.RESOURCE_URL]=s(d[wi.URL]),{trustAs:a,getTrusted:c,valueOf:l}}]}function Mt(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sniffer","$sceDelegate",function(t,n,i){if(e&&n.msie&&n.msieDocumentMode<8)throw yi("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 9 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var r=N(wi);r.isEnabled=function(){return e},r.trustAs=i.trustAs,r.getTrusted=i.getTrusted,r.valueOf=i.valueOf,e||(r.trustAs=r.getTrusted=function(e,t){return t},r.valueOf=g),r.parseAs=function(e,n){var i=t(n);return i.literal&&i.constant?i:function(t,n){return r.getTrusted(e,i(t,n))}};var s=r.parseAs,a=r.getTrusted,l=r.trustAs;return o(wi,function(e,t){var n=pn(t);r[ce("parse_as_"+n)]=function(t){return s(e,t)},r[ce("get_trusted_"+n)]=function(t){return a(e,t)},r[ce("trust_as_"+n)]=function(t){return l(e,t)}}),r}]}function Pt(){this.$get=["$window","$document",function(e,t){var n,i,r={},o=d((/android (\d+)/.exec(pn((e.navigator||{}).userAgent))||[])[1]),s=/Boxee/i.test((e.navigator||{}).userAgent),a=t[0]||{},l=a.documentMode,c=/^(Moz|webkit|O|ms)(?=[A-Z])/,u=a.body&&a.body.style,h=!1,p=!1;if(u){for(var f in u)if(i=c.exec(f)){n=i[0],n=n.substr(0,1).toUpperCase()+n.substr(1);break}n||(n="WebkitOpacity"in u&&"webkit"),h=!!("transition"in u||n+"Transition"in u),p=!!("animation"in u||n+"Animation"in u),!o||h&&p||(h=w(a.body.style.webkitTransition),p=w(a.body.style.webkitAnimation))}return{history:!(!e.history||!e.history.pushState||4>o||s),hashchange:"onhashchange"in e&&(!l||l>7),hasEvent:function(e){if("input"==e&&9==bn)return!1;if(v(r[e])){var t=a.createElement("div");r[e]="on"+e in t}return r[e]},csp:On(),vendorPrefix:n,transitions:h,animations:p,android:o,msie:bn,msieDocumentMode:l}}]}function Rt(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function(e,t,n,i){function r(r,s,a){var l,c=n.defer(),u=c.promise,h=b(a)&&!a;return l=t.defer(function(){try{c.resolve(r())}catch(t){c.reject(t),i(t)}finally{delete o[u.$$timeoutId]}h||e.$apply()},s),u.$$timeoutId=l,o[l]=c,u}var o={};return r.cancel=function(e){return e&&e.$$timeoutId in o?(o[e.$$timeoutId].reject("canceled"),delete o[e.$$timeoutId],t.defer.cancel(e.$$timeoutId)):!1},r}]}function Nt(e,t){var n=e;return bn&&(_i.setAttribute("href",n),n=_i.href),_i.setAttribute("href",n),{href:_i.href,protocol:_i.protocol?_i.protocol.replace(/:$/,""):"",host:_i.host,search:_i.search?_i.search.replace(/^\?/,""):"",hash:_i.hash?_i.hash.replace(/^#/,""):"",hostname:_i.hostname,port:_i.port,pathname:"/"===_i.pathname.charAt(0)?_i.pathname:"/"+_i.pathname}}function Ft(e){var t=w(e)?Nt(e):e;return t.protocol===xi.protocol&&t.host===xi.host}function Lt(){this.$get=m(e)}function jt(e){function t(i,r){if(y(i)){var s={};return o(i,function(e,n){s[n]=t(n,e)}),s}return e.factory(i+n,r)}var n="Filter";this.register=t,this.$get=["$injector",function(e){return function(t){return e.get(t+n)}}],t("currency",Ht),t("date",Kt),t("filter",Ut),t("json",Xt),t("limitTo",Qt),t("lowercase",Ti),t("number",Wt),t("orderBy",Jt),t("uppercase",Ei)}function Ut(){return function(e,t,n){if(!Dn(e))return e;var i=typeof n,r=[];r.check=function(e){for(var t=0;t<r.length;t++)if(!r[t](e))return!1;return!0},"function"!==i&&(n="boolean"===i&&n?function(e,t){return Tn.equals(e,t)}:function(e,t){if(e&&t&&"object"==typeof e&&"object"==typeof t){for(var i in e)if("$"!==i.charAt(0)&&fn.call(e,i)&&n(e[i],t[i]))return!0;return!1}return t=(""+t).toLowerCase(),(""+e).toLowerCase().indexOf(t)>-1});var o=function(e,t){if("string"==typeof t&&"!"===t.charAt(0))return!o(e,t.substr(1));switch(typeof e){case"boolean":case"number":case"string":return n(e,t);case"object":switch(typeof t){case"object":return n(e,t);default:for(var i in e)if("$"!==i.charAt(0)&&o(e[i],t))return!0}return!1;case"array":for(var r=0;r<e.length;r++)if(o(e[r],t))return!0;return!1;default:return!1}};switch(typeof t){case"boolean":case"number":case"string":t={$:t};case"object":for(var s in t)!function(e){"undefined"!=typeof t[e]&&r.push(function(n){return o("$"==e?n:n&&n[e],t[e])})}(s);break;case"function":r.push(t);break;default:return e}for(var a=[],l=0;l<e.length;l++){var c=e[l];r.check(c)&&a.push(c)}return a}}function Ht(e){var t=e.NUMBER_FORMATS;return function(e,n){return v(n)&&(n=t.CURRENCY_SYM),Bt(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,2).replace(/\u00A4/g,n)}}function Wt(e){var t=e.NUMBER_FORMATS;return function(e,n){return Bt(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}function Bt(e,t,n,i,r){if(null==e||!isFinite(e)||y(e))return"";var o=0>e;e=Math.abs(e);var s=e+"",a="",l=[],c=!1;if(-1!==s.indexOf("e")){var u=s.match(/([\d\.]+)e(-?)(\d+)/);u&&"-"==u[2]&&u[3]>r+1?(s="0",e=0):(a=s,c=!0)}if(c)r>0&&e>-1&&1>e&&(a=e.toFixed(r));else{var h=(s.split(Ci)[1]||"").length;v(r)&&(r=Math.min(Math.max(t.minFrac,h),t.maxFrac)),e=+(Math.round(+(e.toString()+"e"+r)).toString()+"e"+-r),0===e&&(o=!1);var d=(""+e).split(Ci),p=d[0];d=d[1]||"";var f,g=0,m=t.lgSize,b=t.gSize;if(p.length>=m+b)for(g=p.length-m,f=0;g>f;f++)(g-f)%b===0&&0!==f&&(a+=n),a+=p.charAt(f);for(f=g;f<p.length;f++)(p.length-f)%m===0&&0!==f&&(a+=n),a+=p.charAt(f);for(;d.length<r;)d+="0";r&&"0"!==r&&(a+=i+d.substr(0,r))}return l.push(o?t.negPre:t.posPre),l.push(a),l.push(o?t.negSuf:t.posSuf),l.join("")}function zt(e,t,n){var i="";for(0>e&&(i="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),i+e}function qt(e,t,n,i){return n=n||0,function(r){var o=r["get"+e]();return(n>0||o>-n)&&(o+=n),0===o&&-12==n&&(o=12),zt(o,t,i)}}function Vt(e,t){return function(n,i){var r=n["get"+e](),o=gn(t?"SHORT"+e:e);return i[o][r]}}function Yt(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=zt(Math[t>0?"floor":"ceil"](t/60),2)+zt(Math.abs(t%60),2)}function Gt(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function Kt(e){function t(e){var t;if(t=e.match(n)){var i=new Date(0),r=0,o=0,s=t[8]?i.setUTCFullYear:i.setFullYear,a=t[8]?i.setUTCHours:i.setHours;t[9]&&(r=d(t[9]+t[10]),o=d(t[9]+t[11])),s.call(i,d(t[1]),d(t[2])-1,d(t[3]));var l=d(t[4]||0)-r,c=d(t[5]||0)-o,u=d(t[6]||0),h=Math.round(1e3*parseFloat("0."+(t[7]||0)));return a.call(i,l,c,u,h),i}return e}var n=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,i){var r,s,a="",l=[];if(i=i||"mediumDate",i=e.DATETIME_FORMATS[i]||i,w(n)&&(n=Si.test(n)?d(n):t(n)),_(n)&&(n=new Date(n)),!x(n))return n;for(;i;)s=ki.exec(i),s?(l=L(l,s,1),i=l.pop()):(l.push(i),i=null);return o(l,function(t){r=$i[t],a+=r?r(n,e.DATETIME_FORMATS):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),a}}function Xt(){return function(e){return W(e,!0)}}function Qt(){return function(e,t){if(!Dn(e)&&!w(e))return e;if(t=Math.abs(Number(t))===1/0?Number(t):d(t),w(e))return t?t>=0?e.slice(0,t):e.slice(t,e.length):"";var n,i,r=[];for(t>e.length?t=e.length:t<-e.length&&(t=-e.length),t>0?(n=0,i=t):(n=e.length+t,i=e.length);i>n;n++)r.push(e[n]);return r}}function Jt(e){return function(t,n,i){function o(e,t){for(var i=0;i<n.length;i++){var r=n[i](e,t);if(0!==r)return r}return 0}function s(e,t){return z(t)?function(t,n){return e(n,t)}:e}function a(e,t){var n=typeof e,i=typeof t;return n==i?(x(e)&&x(t)&&(e=e.valueOf(),t=t.valueOf()),"string"==n&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t?0:t>e?-1:1):i>n?-1:1}if(!r(t))return t;if(!n)return t;n=Dn(n)?n:[n],n=O(n,function(t){var n=!1,i=t||g;if(w(t)&&(("+"==t.charAt(0)||"-"==t.charAt(0))&&(n="-"==t.charAt(0),t=t.substring(1)),i=e(t),i.constant)){var r=i();return s(function(e,t){return a(e[r],t[r])},n)}return s(function(e,t){return a(i(e),i(t))},n)});for(var l=[],c=0;c<t.length;c++)l.push(t[c]);return l.sort(s(o,i))}}function Zt(e){return C(e)&&(e={link:e}),e.restrict=e.restrict||"AC",m(e)}function en(e,t,n,i){function r(t,n){n=n?"-"+Z(n,"-"):"",i.setClass(e,(t?Hi:Wi)+n,(t?Wi:Hi)+n)}var s=this,a=e.parent().controller("form")||Oi,l=0,c=s.$error={},u=[];s.$name=t.name||t.ngForm,s.$dirty=!1,s.$pristine=!0,s.$valid=!0,s.$invalid=!1,a.$addControl(s),e.addClass(Bi),r(!0),s.$addControl=function(e){ie(e.$name,"input"),u.push(e),e.$name&&(s[e.$name]=e)},s.$removeControl=function(e){e.$name&&s[e.$name]===e&&delete s[e.$name],o(c,function(t,n){s.$setValidity(n,!0,e)}),P(u,e)},s.$setValidity=function(e,t,n){var i=c[e];if(t)i&&(P(i,n),i.length||(l--,l||(r(t),s.$valid=!0,s.$invalid=!1),c[e]=!1,r(!0,e),a.$setValidity(e,!0,s)));else{if(l||r(t),i){if(I(i,n))return}else c[e]=i=[],l++,r(!1,e),a.$setValidity(e,!1,s);i.push(n),s.$valid=!1,s.$invalid=!0}},s.$setDirty=function(){i.removeClass(e,Bi),i.addClass(e,zi),s.$dirty=!0,s.$pristine=!1,a.$setDirty()},s.$setPristine=function(){i.removeClass(e,zi),i.addClass(e,Bi),s.$dirty=!1,s.$pristine=!0,o(u,function(e){e.$setPristine()})}}function tn(e,t,i,r){return e.$setValidity(t,i),i?r:n}function nn(e,t){var n,i;if(t)for(n=0;n<t.length;++n)if(i=t[n],e[i])return!0;return!1}function rn(e,t,n,i,r){if(y(r)){e.$$hasNativeValidators=!0;var o=function(o){return e.$error[t]||nn(r,i)||!nn(r,n)?o:void e.$setValidity(t,!1)};e.$parsers.push(o)}}function on(e,t,n,r,o,s){var a=t.prop(dn),l=t[0].placeholder,c={},u=pn(t[0].type);if(r.$$validityState=a,!o.android){var h=!1;t.on("compositionstart",function(e){h=!0}),t.on("compositionend",function(){h=!1,p()})}var p=function(i){if(!h){var o=t.val();if(bn&&"input"===(i||c).type&&t[0].placeholder!==l)return void(l=t[0].placeholder);"password"!==u&&z(n.ngTrim||"T")&&(o=An(o));var s=a&&r.$$hasNativeValidators;(r.$viewValue!==o||""===o&&s)&&(e.$root.$$phase?r.$setViewValue(o):e.$apply(function(){r.$setViewValue(o)}))}};if(o.hasEvent("input"))t.on("input",p);else{var f,g=function(){f||(f=s.defer(function(){p(),f=null}))};t.on("keydown",function(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||g()}),o.hasEvent("paste")&&t.on("paste cut",g)}t.on("change",p),r.$render=function(){t.val(r.$isEmpty(r.$viewValue)?"":r.$viewValue)};var m,v,b=n.ngPattern;if(b){var y=function(e,t){return tn(r,"pattern",r.$isEmpty(t)||e.test(t),t)};v=b.match(/^\/(.*)\/([gim]*)$/),v?(b=new RegExp(v[1],v[2]),m=function(e){return y(b,e)}):m=function(n){var r=e.$eval(b);if(!r||!r.test)throw i("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",b,r,q(t));return y(r,n)},r.$formatters.push(m),r.$parsers.push(m)}if(n.ngMinlength){var w=d(n.ngMinlength),_=function(e){return tn(r,"minlength",r.$isEmpty(e)||e.length>=w,e)};r.$parsers.push(_),r.$formatters.push(_)}if(n.ngMaxlength){var x=d(n.ngMaxlength),C=function(e){return tn(r,"maxlength",r.$isEmpty(e)||e.length<=x,e)};r.$parsers.push(C),r.$formatters.push(C)}}function sn(e,t,i,r,o,s){if(on(e,t,i,r,o,s),r.$parsers.push(function(e){var t=r.$isEmpty(e);return t||Fi.test(e)?(r.$setValidity("number",!0),""===e?null:t?e:parseFloat(e)):(r.$setValidity("number",!1),n)}),rn(r,"number",ji,null,r.$$validityState),r.$formatters.push(function(e){return r.$isEmpty(e)?"":""+e}),i.min){var a=function(e){var t=parseFloat(i.min);return tn(r,"min",r.$isEmpty(e)||e>=t,e)};r.$parsers.push(a),r.$formatters.push(a)}if(i.max){var l=function(e){var t=parseFloat(i.max);return tn(r,"max",r.$isEmpty(e)||t>=e,e)};r.$parsers.push(l),r.$formatters.push(l)}r.$formatters.push(function(e){return tn(r,"number",r.$isEmpty(e)||_(e),e)})}function an(e,t,n,i,r,o){on(e,t,n,i,r,o);var s=function(e){return tn(i,"url",i.$isEmpty(e)||Ri.test(e),e)};i.$formatters.push(s),i.$parsers.push(s)}function ln(e,t,n,i,r,o){on(e,t,n,i,r,o);var s=function(e){return tn(i,"email",i.$isEmpty(e)||Ni.test(e),e)};i.$formatters.push(s),i.$parsers.push(s)}function cn(e,t,n,i){v(n.name)&&t.attr("name",c()),t.on("click",function(){t[0].checked&&e.$apply(function(){i.$setViewValue(n.value)})}),i.$render=function(){var e=n.value;t[0].checked=e==i.$viewValue},n.$observe("value",i.$render)}function un(e,t,n,i){var r=n.ngTrueValue,o=n.ngFalseValue;w(r)||(r=!0),w(o)||(o=!1),t.on("click",function(){e.$apply(function(){i.$setViewValue(t[0].checked)})}),i.$render=function(){t[0].checked=i.$viewValue},i.$isEmpty=function(e){return e!==r},i.$formatters.push(function(e){return e===r}),i.$parsers.push(function(e){return e?r:o})}function hn(e,t){return e="ngClass"+e,["$animate",function(n){function i(e,t){var n=[];e:for(var i=0;i<e.length;i++){for(var r=e[i],o=0;o<t.length;o++)if(r==t[o])continue e;n.push(r)}return n}function r(e){if(Dn(e))return e;if(w(e))return e.split(" ");if(y(e)){var t=[];return o(e,function(e,n){e&&(t=t.concat(n.split(" ")))}),t}return e}return{restrict:"AC",link:function(s,a,l){function c(e){var t=h(e,1);l.$addClass(t)}function u(e){var t=h(e,-1);l.$removeClass(t)}function h(e,t){var n=a.data("$classCounts")||{},i=[];return o(e,function(e){(t>0||n[e])&&(n[e]=(n[e]||0)+t,n[e]===+(t>0)&&i.push(e))}),a.data("$classCounts",n),i.join(" ")}function d(e,t){var r=i(t,e),o=i(e,t);o=h(o,-1),r=h(r,1),0===r.length?n.removeClass(a,o):0===o.length?n.addClass(a,r):n.setClass(a,r,o)}function p(e){if(t===!0||s.$index%2===t){var n=r(e||[]);if(f){if(!F(e,f)){var i=r(f);d(i,n)}}else c(n)}f=N(e)}var f;s.$watch(l[e],p,!0),l.$observe("class",function(t){p(s.$eval(l[e]))}),"ngClass"!==e&&s.$watch("$index",function(n,i){var o=1&n;if(o!==(1&i)){var a=r(s.$eval(l[e]));o===t?c(a):u(a)}})}}}]}var dn="validity",pn=function(e){return w(e)?e.toLowerCase():e},fn=Object.prototype.hasOwnProperty,gn=function(e){return w(e)?e.toUpperCase():e},mn=function(e){return w(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},vn=function(e){return w(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(-33&e.charCodeAt(0))}):e};"i"!=="I".toLowerCase()&&(pn=mn,gn=vn);var bn,yn,wn,_n,xn,Cn=[].slice,$n=[].push,kn=Object.prototype.toString,Sn=i("ng"),Tn=e.angular||(e.angular={}),En=["0","0","0"];bn=d((/msie (\d+)/.exec(pn(navigator.userAgent))||[])[1]),isNaN(bn)&&(bn=d((/trident\/.*; rv:(\d+)/.exec(pn(navigator.userAgent))||[])[1])),f.$inject=[],g.$inject=[];var Dn=function(){return C(Array.isArray)?Array.isArray:function(e){return"[object Array]"===kn.call(e)}}(),An=function(){return String.prototype.trim?function(e){return w(e)?e.trim():e}:function(e){return w(e)?e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):e}}();xn=9>bn?function(e){return e=e.nodeName?e:e[0],e.scopeName&&"HTML"!=e.scopeName?gn(e.scopeName+":"+e.nodeName):e.nodeName}:function(e){return e.nodeName?e.nodeName:e[0].nodeName};var On=function(){if(b(On.isActive_))return On.isActive_;var e=!(!t.querySelector("[ng-csp]")&&!t.querySelector("[data-ng-csp]"));if(!e)try{new Function("")}catch(n){e=!0}return On.isActive_=e},In=/[A-Z]/g,Mn={full:"1.2.25",major:1,minor:2,dot:25,codeName:"hypnotic-gesticulation"};fe.expando="ng339";var Pn=fe.cache={},Rn=1,Nn=e.document.addEventListener?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)},Fn=e.document.removeEventListener?function(e,t,n){e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent("on"+t,n)},Ln=(fe._data=function(e){return this.cache[e[this.expando]]||{}},/([\:\-\_]+(.))/g),jn=/^moz([A-Z])/,Un=i("jqLite"),Hn=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Wn=/<|&#?\w+;/,Bn=/<([\w:]+)/,zn=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,qn={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};qn.optgroup=qn.option,qn.tbody=qn.tfoot=qn.colgroup=qn.caption=qn.thead,qn.th=qn.td;var Vn=fe.prototype={ready:function(n){function i(){r||(r=!0,n())}var r=!1;"complete"===t.readyState?setTimeout(i):(this.on("DOMContentLoaded",i),fe(e).on("load",i))},toString:function(){var e=[];return o(this,function(t){e.push(""+t)}),"["+e.join(", ")+"]"},eq:function(e){return yn(e>=0?this[e]:this[this.length+e])},length:0,push:$n,sort:[].sort,splice:[].splice},Yn={};o("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(e){Yn[pn(e)]=e});var Gn={};o("input,select,option,textarea,button,form,details".split(","),function(e){Gn[gn(e)]=!0}),o({data:we,removeData:be},function(e,t){fe[t]=e}),o({data:we,inheritedData:Se,scope:function(e){return yn.data(e,"$scope")||Se(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return yn.data(e,"$isolateScope")||yn.data(e,"$isolateScopeNoTemplate")},controller:ke,injector:function(e){return Se(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:_e,css:function(e,t,i){if(t=ce(t),!b(i)){var r;return 8>=bn&&(r=e.currentStyle&&e.currentStyle[t],""===r&&(r="auto")),r=r||e.style[t],8>=bn&&(r=""===r?n:r),r}e.style[t]=i},attr:function(e,t,i){var r=pn(t);if(Yn[r]){if(!b(i))return e[t]||(e.attributes.getNamedItem(t)||f).specified?r:n;i?(e[t]=!0,e.setAttribute(t,r)):(e[t]=!1,e.removeAttribute(r))}else if(b(i))e.setAttribute(t,i);else if(e.getAttribute){var o=e.getAttribute(t,2);return null===o?n:o}},prop:function(e,t,n){return b(n)?void(e[t]=n):e[t]},text:function(){function e(e,n){var i=t[e.nodeType];return v(n)?i?e[i]:"":void(e[i]=n)}var t=[];return 9>bn?(t[1]="innerText",t[3]="nodeValue"):t[1]=t[3]="textContent",e.$dv="",e}(),val:function(e,t){if(v(t)){if("SELECT"===xn(e)&&e.multiple){var n=[];return o(e.options,function(e){e.selected&&n.push(e.value||e.text)}),0===n.length?null:n}return e.value}e.value=t},html:function(e,t){if(v(t))return e.innerHTML;
for(var n=0,i=e.childNodes;n<i.length;n++)me(i[n]);e.innerHTML=t},empty:Te},function(e,t){fe.prototype[t]=function(t,i){var r,o,s=this.length;if(e!==Te&&(2==e.length&&e!==_e&&e!==ke?t:i)===n){if(y(t)){for(r=0;s>r;r++)if(e===we)e(this[r],t);else for(o in t)e(this[r],o,t[o]);return this}for(var a=e.$dv,l=a===n?Math.min(s,1):s,c=0;l>c;c++){var u=e(this[c],t,i);a=a?a+u:u}return a}for(r=0;s>r;r++)e(this[r],t,i);return this}}),o({removeData:be,dealoc:me,on:function Er(e,n,i,r){if(b(r))throw Un("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");var s=ye(e,"events"),a=ye(e,"handle");s||ye(e,"events",s={}),a||ye(e,"handle",a=De(e,s)),o(n.split(" "),function(n){var r=s[n];if(!r){if("mouseenter"==n||"mouseleave"==n){var o=t.body.contains||t.body.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1};s[n]=[];var l={mouseleave:"mouseout",mouseenter:"mouseover"};Er(e,l[n],function(e){var t=this,i=e.relatedTarget;(!i||i!==t&&!o(t,i))&&a(e,n)})}else Nn(e,n,a),s[n]=[];r=s[n]}r.push(i)})},off:ve,one:function(e,t,n){e=yn(e),e.on(t,function i(){e.off(t,n),e.off(t,i)}),e.on(t,n)},replaceWith:function(e,t){var n,i=e.parentNode;me(e),o(new fe(t),function(t){n?i.insertBefore(t,n.nextSibling):i.replaceChild(t,e),n=t})},children:function(e){var t=[];return o(e.childNodes,function(e){1===e.nodeType&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){o(new fe(t),function(t){(1===e.nodeType||11===e.nodeType)&&e.appendChild(t)})},prepend:function(e,t){if(1===e.nodeType){var n=e.firstChild;o(new fe(t),function(t){e.insertBefore(t,n)})}},wrap:function(e,t){t=yn(t)[0];var n=e.parentNode;n&&n.replaceChild(t,e),t.appendChild(e)},remove:function(e){me(e);var t=e.parentNode;t&&t.removeChild(e)},after:function(e,t){var n=e,i=e.parentNode;o(new fe(t),function(e){i.insertBefore(e,n.nextSibling),n=e})},addClass:Ce,removeClass:xe,toggleClass:function(e,t,n){t&&o(t.split(" "),function(t){var i=n;v(i)&&(i=!_e(e,t)),(i?Ce:xe)(e,t)})},parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},next:function(e){if(e.nextElementSibling)return e.nextElementSibling;for(var t=e.nextSibling;null!=t&&1!==t.nodeType;)t=t.nextSibling;return t},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:ge,triggerHandler:function(e,t,n){var i,r,s,a=t.type||t,l=(ye(e,"events")||{})[a];l&&(i={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return this.defaultPrevented===!0},stopPropagation:f,type:a,target:e},t.type&&(i=h(i,t)),r=N(l),s=n?[i].concat(n):[i],o(r,function(t){t.apply(e,s)}))}},function(e,t){fe.prototype[t]=function(t,n,i){for(var r,o=0;o<this.length;o++)v(r)?(r=e(this[o],t,n,i),b(r)&&(r=yn(r))):$e(r,e(this[o],t,n,i));return b(r)?r:this},fe.prototype.bind=fe.prototype.on,fe.prototype.unbind=fe.prototype.off}),Oe.prototype={put:function(e,t){this[Ae(e,this.nextUid)]=t},get:function(e){return this[Ae(e,this.nextUid)]},remove:function(e){var t=this[e=Ae(e,this.nextUid)];return delete this[e],t}};var Kn=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,Xn=/,/,Qn=/^\s*(_?)(\S+?)\1\s*$/,Jn=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,Zn=i("$injector"),ei=i("$animate"),ti=["$provide",function(e){this.$$selectors={},this.register=function(t,n){var i=t+"-animation";if(t&&"."!=t.charAt(0))throw ei("notcsel","Expecting class selector starting with '.' got '{0}'.",t);this.$$selectors[t.substr(1)]=i,e.factory(i,n)},this.classNameFilter=function(e){return 1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null),this.$$classNameFilter},this.$get=["$timeout","$$asyncCallback",function(e,t){function n(e){e&&t(e)}return{enter:function(e,t,i,r){i?i.after(e):(t&&t[0]||(t=i.parent()),t.append(e)),n(r)},leave:function(e,t){e.remove(),n(t)},move:function(e,t,n,i){this.enter(e,t,n,i)},addClass:function(e,t,i){t=w(t)?t:Dn(t)?t.join(" "):"",o(e,function(e){Ce(e,t)}),n(i)},removeClass:function(e,t,i){t=w(t)?t:Dn(t)?t.join(" "):"",o(e,function(e){xe(e,t)}),n(i)},setClass:function(e,t,i,r){o(e,function(e){Ce(e,t),xe(e,i)}),n(r)},enabled:f}}]}],ni=i("$compile");Ue.$inject=["$provide","$$sanitizeUriProvider"];var ii=/^(x[\:\-_]|data[\:\-_])/i,ri=i("$interpolate"),oi=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,si={http:80,https:443,ftp:21},ai=i("$location");dt.prototype=ht.prototype=ut.prototype={$$html5:!1,$$replace:!1,absUrl:pt("$$absUrl"),url:function(e){if(v(e))return this.$$url;var t=oi.exec(e);return t[1]&&this.path(decodeURIComponent(t[1])),(t[2]||t[1])&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:pt("$$protocol"),host:pt("$$host"),port:pt("$$port"),path:ft("$$path",function(e){return e=e?e.toString():"","/"==e.charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(w(e)||_(e))e=e.toString(),this.$$search=Y(e);else{if(!y(e))throw ai("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");o(e,function(t,n){null==t&&delete e[n]}),this.$$search=e}break;default:v(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:ft("$$hash",function(e){return e?e.toString():""}),replace:function(){return this.$$replace=!0,this}};var li,ci=i("$parse"),ui={},hi=Function.prototype.call,di=Function.prototype.apply,pi=Function.prototype.bind,fi={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:f,"+":function(e,t,i,r){return i=i(e,t),r=r(e,t),b(i)?b(r)?i+r:i:b(r)?r:n},"-":function(e,t,n,i){return n=n(e,t),i=i(e,t),(b(n)?n:0)-(b(i)?i:0)},"*":function(e,t,n,i){return n(e,t)*i(e,t)},"/":function(e,t,n,i){return n(e,t)/i(e,t)},"%":function(e,t,n,i){return n(e,t)%i(e,t)},"^":function(e,t,n,i){return n(e,t)^i(e,t)},"=":f,"===":function(e,t,n,i){return n(e,t)===i(e,t)},"!==":function(e,t,n,i){return n(e,t)!==i(e,t)},"==":function(e,t,n,i){return n(e,t)==i(e,t)},"!=":function(e,t,n,i){return n(e,t)!=i(e,t)},"<":function(e,t,n,i){return n(e,t)<i(e,t)},">":function(e,t,n,i){return n(e,t)>i(e,t)},"<=":function(e,t,n,i){return n(e,t)<=i(e,t)},">=":function(e,t,n,i){return n(e,t)>=i(e,t)},"&&":function(e,t,n,i){return n(e,t)&&i(e,t)},"||":function(e,t,n,i){return n(e,t)||i(e,t)},"&":function(e,t,n,i){return n(e,t)&i(e,t)},"|":function(e,t,n,i){return i(e,t)(e,t,n(e,t))},"!":function(e,t,n){return!n(e,t)}},gi={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},mi=function(e){this.options=e};mi.prototype={constructor:mi,lex:function(e){for(this.text=e,this.index=0,this.ch=n,this.lastCh=":",this.tokens=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var t=this.ch+this.peek(),i=t+this.peek(2),r=fi[this.ch],o=fi[t],s=fi[i];s?(this.tokens.push({index:this.index,text:i,fn:s}),this.index+=3):o?(this.tokens.push({index:this.index,text:t,fn:o}),this.index+=2):r?(this.tokens.push({index:this.index,text:this.ch,fn:r}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(e){return-1!==e.indexOf(this.ch)},was:function(e){return-1!==e.indexOf(this.lastCh)},peek:function(e){var t=e||1;return this.index+t<this.text.length?this.text.charAt(this.index+t):!1},isNumber:function(e){return e>="0"&&"9">=e},isWhitespace:function(e){return" "===e||"\r"===e||"	"===e||"\n"===e||""===e||" "===e},isIdent:function(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var i=b(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw ci("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,i,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=pn(this.text.charAt(this.index));if("."==n||this.isNumber(n))e+=n;else{var i=this.peek();if("e"==n&&this.isExpOperator(i))e+=n;else if(this.isExpOperator(n)&&i&&this.isNumber(i)&&"e"==e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||i&&this.isNumber(i)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}e=1*e,this.tokens.push({index:t,text:e,literal:!0,constant:!0,fn:function(){return e}})},readIdent:function(){for(var e,t,n,i,r=this,o="",s=this.index;this.index<this.text.length&&(i=this.text.charAt(this.index),"."===i||this.isIdent(i)||this.isNumber(i));)"."===i&&(e=this.index),o+=i,this.index++;if(e)for(t=this.index;t<this.text.length;){if(i=this.text.charAt(t),"("===i){n=o.substr(e-s+1),o=o.substr(0,e-s),this.index=t;break}if(!this.isWhitespace(i))break;t++}var a={index:s,text:o};if(fi.hasOwnProperty(o))a.fn=fi[o],a.literal=!0,a.constant=!0;else{var l=xt(o,this.options,this.text);a.fn=h(function(e,t){return l(e,t)},{assign:function(e,t){return wt(e,o,t,r.text,r.options)}})}this.tokens.push(a),n&&(this.tokens.push({index:e,text:"."}),this.tokens.push({index:e+1,text:n}))},readString:function(e){var t=this.index;this.index++;for(var n="",i=e,r=!1;this.index<this.text.length;){var o=this.text.charAt(this.index);if(i+=o,r){if("u"===o){var s=this.text.substring(this.index+1,this.index+5);s.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+s+"]"),this.index+=4,n+=String.fromCharCode(parseInt(s,16))}else{var a=gi[o];n+=a||o}r=!1}else if("\\"===o)r=!0;else{if(o===e)return this.index++,void this.tokens.push({index:t,text:i,string:n,literal:!0,constant:!0,fn:function(){return n}});n+=o}this.index++}this.throwError("Unterminated quote",t)}};var vi=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n};vi.ZERO=h(function(){return 0},{constant:!0}),vi.prototype={constructor:vi,parse:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t.literal=!!t.literal,t.constant=!!t.constant,t},primary:function(){var e;if(this.expect("("))e=this.filterChain(),this.consume(")");else if(this.expect("["))e=this.arrayDeclaration();else if(this.expect("{"))e=this.object();else{var t=this.expect();e=t.fn,e||this.throwError("not a primary expression",t),e.literal=!!t.literal,e.constant=!!t.constant}for(var n,i;n=this.expect("(","[",".");)"("===n.text?(e=this.functionCall(e,i),i=null):"["===n.text?(i=e,e=this.objectIndex(e)):"."===n.text?(i=e,e=this.fieldAccess(e)):this.throwError("IMPOSSIBLE");return e},throwError:function(e,t){throw ci("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},peekToken:function(){if(0===this.tokens.length)throw ci("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,i){if(this.tokens.length>0){var r=this.tokens[0],o=r.text;if(o===e||o===t||o===n||o===i||!e&&!t&&!n&&!i)return r}return!1},expect:function(e,t,n,i){var r=this.peek(e,t,n,i);return r?(this.tokens.shift(),r):!1},consume:function(e){this.expect(e)||this.throwError("is unexpected, expecting ["+e+"]",this.peek())},unaryFn:function(e,t){return h(function(n,i){return e(n,i,t)},{constant:t.constant})},ternaryFn:function(e,t,n){return h(function(i,r){return e(i,r)?t(i,r):n(i,r)},{constant:e.constant&&t.constant&&n.constant})},binaryFn:function(e,t,n){return h(function(i,r){return t(i,r,e,n)},{constant:e.constant&&n.constant})},statements:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.filterChain()),!this.expect(";"))return 1===e.length?e[0]:function(t,n){for(var i,r=0;r<e.length;r++){var o=e[r];o&&(i=o(t,n))}return i}},filterChain:function(){for(var e,t=this.expression();;){if(!(e=this.expect("|")))return t;t=this.binaryFn(t,e.fn,this.filter())}},filter:function(){for(var e=this.expect(),t=this.$filter(e.text),n=[];;){if(!(e=this.expect(":"))){var i=function(e,i,r){for(var o=[r],s=0;s<n.length;s++)o.push(n[s](e,i));return t.apply(e,o)};return function(){return i}}n.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var e,t,n=this.ternary();return(t=this.expect("="))?(n.assign||this.throwError("implies assignment but ["+this.text.substring(0,t.index)+"] can not be assigned to",t),e=this.ternary(),function(t,i){return n.assign(t,e(t,i),i)}):n},ternary:function(){var e,t,n=this.logicalOR();return(t=this.expect("?"))?(e=this.assignment(),(t=this.expect(":"))?this.ternaryFn(n,e,this.assignment()):void this.throwError("expected :",t)):n},logicalOR:function(){for(var e,t=this.logicalAND();;){if(!(e=this.expect("||")))return t;t=this.binaryFn(t,e.fn,this.logicalAND())}},logicalAND:function(){var e,t=this.equality();return(e=this.expect("&&"))&&(t=this.binaryFn(t,e.fn,this.logicalAND())),t},equality:function(){var e,t=this.relational();return(e=this.expect("==","!=","===","!=="))&&(t=this.binaryFn(t,e.fn,this.equality())),t},relational:function(){var e,t=this.additive();return(e=this.expect("<",">","<=",">="))&&(t=this.binaryFn(t,e.fn,this.relational())),t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t=this.binaryFn(t,e.fn,this.multiplicative());return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t=this.binaryFn(t,e.fn,this.unary());return t},unary:function(){var e;return this.expect("+")?this.primary():(e=this.expect("-"))?this.binaryFn(vi.ZERO,e.fn,this.unary()):(e=this.expect("!"))?this.unaryFn(e.fn,this.unary()):this.primary()},fieldAccess:function(e){var t=this,n=this.expect().text,i=xt(n,this.options,this.text);return h(function(t,n,r){return i(r||e(t,n))},{assign:function(i,r,o){var s=e(i,o);return s||e.assign(i,s={}),wt(s,n,r,t.text,t.options)}})},objectIndex:function(e){var t=this,i=this.expression();return this.consume("]"),h(function(r,o){var s,a,l=e(r,o),c=i(r,o);return vt(c,t.text),l?(s=bt(l[c],t.text),s&&s.then&&t.options.unwrapPromises&&(a=s,"$$v"in s||(a.$$v=n,a.then(function(e){a.$$v=e})),s=s.$$v),s):n},{assign:function(n,r,o){var s=vt(i(n,o),t.text),a=bt(e(n,o),t.text);return a||e.assign(n,a={}),a[s]=r}})},functionCall:function(e,t){var n=[];if(")"!==this.peekToken().text)do n.push(this.expression());while(this.expect(","));this.consume(")");var i=this;return function(r,o){for(var s=[],a=t?t(r,o):r,l=0;l<n.length;l++)s.push(bt(n[l](r,o),i.text));var c=e(r,o,a)||f;bt(a,i.text),yt(c,i.text);var u=c.apply?c.apply(a,s):c(s[0],s[1],s[2],s[3],s[4]);return bt(u,i.text)}},arrayDeclaration:function(){var e=[],t=!0;if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var n=this.expression();e.push(n),n.constant||(t=!1)}while(this.expect(","));return this.consume("]"),h(function(t,n){for(var i=[],r=0;r<e.length;r++)i.push(e[r](t,n));return i},{literal:!0,constant:t})},object:function(){var e=[],t=!0;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var n=this.expect(),i=n.string||n.text;this.consume(":");var r=this.expression();e.push({key:i,value:r}),r.constant||(t=!1)}while(this.expect(","));return this.consume("}"),h(function(t,n){for(var i={},r=0;r<e.length;r++){var o=e[r];i[o.key]=o.value(t,n)}return i},{literal:!0,constant:t})}};var bi={},yi=i("$sce"),wi={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},_i=t.createElement("a"),xi=Nt(e.location.href,!0);jt.$inject=["$provide"],Ht.$inject=["$locale"],Wt.$inject=["$locale"];var Ci=".",$i={yyyy:qt("FullYear",4),yy:qt("FullYear",2,0,!0),y:qt("FullYear",1),MMMM:Vt("Month"),MMM:Vt("Month",!0),MM:qt("Month",2,1),M:qt("Month",1,1),dd:qt("Date",2),d:qt("Date",1),HH:qt("Hours",2),H:qt("Hours",1),hh:qt("Hours",2,-12),h:qt("Hours",1,-12),mm:qt("Minutes",2),m:qt("Minutes",1),ss:qt("Seconds",2),s:qt("Seconds",1),sss:qt("Milliseconds",3),EEEE:Vt("Day"),EEE:Vt("Day",!0),a:Gt,Z:Yt},ki=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,Si=/^\-?\d+$/;Kt.$inject=["$locale"];var Ti=m(pn),Ei=m(gn);Jt.$inject=["$parse"];var Di=m({restrict:"E",compile:function(e,n){return 8>=bn&&(n.href||n.name||n.$set("href",""),e.append(t.createComment("IE fix"))),n.href||n.xlinkHref||n.name?void 0:function(e,t){var n="[object SVGAnimatedString]"===kn.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(n)||e.preventDefault()})}}}),Ai={};o(Yn,function(e,t){if("multiple"!=e){var n=He("ng-"+t);Ai[n]=function(){return{priority:100,link:function(e,i,r){e.$watch(r[n],function(e){r.$set(t,!!e)})}}}}}),o(["src","srcset","href"],function(e){var t=He("ng-"+e);Ai[t]=function(){return{priority:99,link:function(n,i,r){var o=e,s=e;"href"===e&&"[object SVGAnimatedString]"===kn.call(i.prop("href"))&&(s="xlinkHref",r.$attr[s]="xlink:href",o=null),r.$observe(t,function(t){return t?(r.$set(s,t),void(bn&&o&&i.prop(o,r[s]))):void("href"===e&&r.$set(s,null))})}}}});var Oi={$addControl:f,$removeControl:f,$setValidity:f,$setDirty:f,$setPristine:f};en.$inject=["$element","$attrs","$scope","$animate"];var Ii=function(e){return["$timeout",function(t){var i={name:"form",restrict:e?"EAC":"E",controller:en,compile:function(){return{pre:function(e,i,r,o){if(!r.action){var s=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1};Nn(i[0],"submit",s),i.on("$destroy",function(){t(function(){Fn(i[0],"submit",s)},0,!1)})}var a=i.parent().controller("form"),l=r.name||r.ngForm;l&&wt(e,l,o,l),a&&i.on("$destroy",function(){a.$removeControl(o),l&&wt(e,l,n,l),h(o,Oi)})}}}};return i}]},Mi=Ii(),Pi=Ii(!0),Ri=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,Ni=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,Fi=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,Li={text:on,number:sn,url:an,email:ln,radio:cn,checkbox:un,hidden:f,button:f,submit:f,reset:f,file:f},ji=["badInput"],Ui=["$browser","$sniffer",function(e,t){return{restrict:"E",require:"?ngModel",link:function(n,i,r,o){o&&(Li[pn(r.type)]||Li.text)(n,i,r,o,t,e)}}}],Hi="ng-valid",Wi="ng-invalid",Bi="ng-pristine",zi="ng-dirty",qi=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate",function(e,t,n,r,s,a){function l(e,t){t=t?"-"+Z(t,"-"):"",a.removeClass(r,(e?Wi:Hi)+t),a.addClass(r,(e?Hi:Wi)+t)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=n.name;var c=s(n.ngModel),u=c.assign;if(!u)throw i("ngModel")("nonassign","Expression '{0}' is non-assignable. Element: {1}",n.ngModel,q(r));this.$render=f,this.$isEmpty=function(e){return v(e)||""===e||null===e||e!==e};var h=r.inheritedData("$formController")||Oi,d=0,p=this.$error={};r.addClass(Bi),l(!0),this.$setValidity=function(e,t){p[e]!==!t&&(t?(p[e]&&d--,d||(l(!0),this.$valid=!0,this.$invalid=!1)):(l(!1),this.$invalid=!0,this.$valid=!1,d++),p[e]=!t,l(t,e),h.$setValidity(e,t,this))},this.$setPristine=function(){this.$dirty=!1,this.$pristine=!0,a.removeClass(r,zi),a.addClass(r,Bi)},this.$setViewValue=function(n){this.$viewValue=n,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,a.removeClass(r,Bi),a.addClass(r,zi),h.$setDirty()),o(this.$parsers,function(e){n=e(n)}),this.$modelValue!==n&&(this.$modelValue=n,u(e,n),o(this.$viewChangeListeners,function(e){try{e()}catch(n){t(n)}}))};var g=this;e.$watch(function(){var t=c(e);if(g.$modelValue!==t){var n=g.$formatters,i=n.length;for(g.$modelValue=t;i--;)t=n[i](t);g.$viewValue!==t&&(g.$viewValue=t,g.$render())}return t})}],Vi=function(){return{require:["ngModel","^?form"],controller:qi,link:function(e,t,n,i){var r=i[0],o=i[1]||Oi;o.$addControl(r),e.$on("$destroy",function(){o.$removeControl(r)})}}},Yi=m({require:"ngModel",link:function(e,t,n,i){i.$viewChangeListeners.push(function(){e.$eval(n.ngChange)})}}),Gi=function(){return{require:"?ngModel",link:function(e,t,n,i){if(i){n.required=!0;var r=function(e){return n.required&&i.$isEmpty(e)?void i.$setValidity("required",!1):(i.$setValidity("required",!0),e)};i.$formatters.push(r),i.$parsers.unshift(r),n.$observe("required",function(){r(i.$viewValue)})}}}},Ki=function(){return{require:"ngModel",link:function(e,t,i,r){var s=/\/(.*)\//.exec(i.ngList),a=s&&new RegExp(s[1])||i.ngList||",",l=function(e){if(!v(e)){var t=[];return e&&o(e.split(a),function(e){e&&t.push(An(e))}),t}};r.$parsers.push(l),r.$formatters.push(function(e){return Dn(e)?e.join(", "):n}),r.$isEmpty=function(e){return!e||!e.length}}}},Xi=/^(true|false|\d+)$/,Qi=function(){return{priority:100,compile:function(e,t){return Xi.test(t.ngValue)?function(e,t,n){n.$set("value",e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,function(e){n.$set("value",e)})}}}},Ji=Zt({compile:function(e){return e.addClass("ng-binding"),function(e,t,i){t.data("$binding",i.ngBind),e.$watch(i.ngBind,function(e){t.text(e==n?"":e)})}}}),Zi=["$interpolate",function(e){return function(t,n,i){var r=e(n.attr(i.$attr.ngBindTemplate));n.addClass("ng-binding").data("$binding",r),i.$observe("ngBindTemplate",function(e){n.text(e)})}}],er=["$sce","$parse",function(e,t){return{compile:function(n){return n.addClass("ng-binding"),function(n,i,r){function o(){return(s(n)||"").toString()}i.data("$binding",r.ngBindHtml);var s=t(r.ngBindHtml);n.$watch(o,function(t){i.html(e.getTrustedHtml(s(n))||"")})}}}}],tr=hn("",!0),nr=hn("Odd",0),ir=hn("Even",1),rr=Zt({compile:function(e,t){t.$set("ngCloak",n),e.removeClass("ng-cloak")}}),or=[function(){return{scope:!0,controller:"@",priority:500}}],sr={},ar={blur:!0,focus:!0};o("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(e){var t=He("ng-"+e);sr[t]=["$parse","$rootScope",function(n,i){return{compile:function(r,o){var s=n(o[t]);return function(t,n){n.on(e,function(n){var r=function(){s(t,{$event:n})};ar[e]&&i.$$phase?t.$evalAsync(r):t.$apply(r)})}}}}]});var lr=["$animate",function(e){return{transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,i,r,o,s){var a,l,c;n.$watch(r.ngIf,function(o){z(o)?l||(l=n.$new(),s(l,function(n){n[n.length++]=t.createComment(" end ngIf: "+r.ngIf+" "),a={clone:n},e.enter(n,i.parent(),i)})):(c&&(c.remove(),c=null),l&&(l.$destroy(),l=null),a&&(c=oe(a.clone),e.leave(c,function(){c=null}),a=null))})}}}],cr=["$http","$templateCache","$anchorScroll","$animate","$sce",function(e,t,n,i,r){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Tn.noop,compile:function(o,s){var a=s.ngInclude||s.src,l=s.onload||"",c=s.autoscroll;return function(o,s,u,h,d){var p,f,g,m=0,v=function(){f&&(f.remove(),f=null),p&&(p.$destroy(),p=null),g&&(i.leave(g,function(){f=null}),f=g,g=null)};o.$watch(r.parseAsResourceUrl(a),function(r){var a=function(){!b(c)||c&&!o.$eval(c)||n()},u=++m;r?(e.get(r,{cache:t}).success(function(e){if(u===m){var t=o.$new();h.template=e;var n=d(t,function(e){v(),i.enter(e,null,s,a)});p=t,g=n,p.$emit("$includeContentLoaded"),o.$eval(l)}}).error(function(){u===m&&v()}),o.$emit("$includeContentRequested")):(v(),h.template=null)})}}}}],ur=["$compile",function(e){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(t,n,i,r){n.html(r.template),e(n.contents())(t)}}}],hr=Zt({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),dr=Zt({terminal:!0,priority:1e3}),pr=["$locale","$interpolate",function(e,t){var n=/{}/g;return{restrict:"EA",link:function(i,r,s){var a=s.count,l=s.$attr.when&&r.attr(s.$attr.when),c=s.offset||0,u=i.$eval(l)||{},h={},d=t.startSymbol(),p=t.endSymbol(),f=/^when(Minus)?(.+)$/;o(s,function(e,t){f.test(t)&&(u[pn(t.replace("when","").replace("Minus","-"))]=r.attr(s.$attr[t]))}),o(u,function(e,i){h[i]=t(e.replace(n,d+a+"-"+c+p))}),i.$watch(function(){var t=parseFloat(i.$eval(a));return isNaN(t)?"":(t in u||(t=e.pluralCat(t-c)),h[t](i,r,!0))},function(e){r.text(e)})}}}],fr=["$parse","$animate",function(e,n){function s(e){return e.clone[0]}function a(e){return e.clone[e.clone.length-1]}var l="$$NG_REMOVED",c=i("ngRepeat");return{transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,link:function(i,u,h,d,p){var f,g,m,v,b,y,w,_,x,C=h.ngRepeat,$=C.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),k={$id:Ae};if(!$)throw c("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",C);if(y=$[1],w=$[2],f=$[3],f?(g=e(f),m=function(e,t,n){return x&&(k[x]=e),k[_]=t,k.$index=n,g(i,k)}):(v=function(e,t){return Ae(t)},b=function(e){return e}),$=y.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!$)throw c("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",y);_=$[3]||$[1],x=$[2];var S={};i.$watchCollection(w,function(e){var h,d,f,g,y,w,$,k,T,E,D,A,O=u[0],I={},M=[];if(r(e))E=e,T=m||v;else{T=m||b,E=[];for(w in e)e.hasOwnProperty(w)&&"$"!=w.charAt(0)&&E.push(w);E.sort()}for(g=E.length,d=M.length=E.length,h=0;d>h;h++)if(w=e===E?h:E[h],$=e[w],k=T(w,$,h),ie(k,"`track by` id"),S.hasOwnProperty(k))D=S[k],delete S[k],I[k]=D,M[h]=D;else{if(I.hasOwnProperty(k))throw o(M,function(e){e&&e.scope&&(S[e.id]=e)}),c("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",C,k,W($));M[h]={id:k},I[k]=!1}for(w in S)S.hasOwnProperty(w)&&(D=S[w],A=oe(D.clone),n.leave(A),o(A,function(e){e[l]=!0}),D.scope.$destroy());for(h=0,d=E.length;d>h;h++){if(w=e===E?h:E[h],$=e[w],D=M[h],M[h-1]&&(O=a(M[h-1])),D.scope){y=D.scope,f=O;do f=f.nextSibling;while(f&&f[l]);s(D)!=f&&n.move(oe(D.clone),null,yn(O)),O=a(D)}else y=i.$new();y[_]=$,x&&(y[x]=w),y.$index=h,y.$first=0===h,y.$last=h===g-1,y.$middle=!(y.$first||y.$last),y.$odd=!(y.$even=0===(1&h)),D.scope||p(y,function(e){e[e.length++]=t.createComment(" end ngRepeat: "+C+" "),n.enter(e,null,yn(O)),O=e,D.scope=y,D.clone=e,I[D.id]=D})}S=I})}}}],gr=["$animate",function(e){return function(t,n,i){t.$watch(i.ngShow,function(t){e[z(t)?"removeClass":"addClass"](n,"ng-hide")})}}],mr=["$animate",function(e){return function(t,n,i){t.$watch(i.ngHide,function(t){e[z(t)?"addClass":"removeClass"](n,"ng-hide")})}}],vr=Zt(function(e,t,n){e.$watch(n.ngStyle,function(e,n){n&&e!==n&&o(n,function(e,n){t.css(n,"")}),e&&t.css(e)},!0)}),br=["$animate",function(e){return{restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(t,n,i,r){var s=i.ngSwitch||i.on,a=[],l=[],c=[],u=[];t.$watch(s,function(n){var s,h;for(s=0,h=c.length;h>s;++s)c[s].remove();for(c.length=0,s=0,h=u.length;h>s;++s){var d=l[s];u[s].$destroy(),c[s]=d,e.leave(d,function(){c.splice(s,1)})}l.length=0,u.length=0,(a=r.cases["!"+n]||r.cases["?"])&&(t.$eval(i.change),o(a,function(n){var i=t.$new();u.push(i),n.transclude(i,function(t){var i=n.element;l.push(t),e.enter(t,i.parent(),i)})}))})}}}],yr=Zt({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,n,i,r){i.cases["!"+n.ngSwitchWhen]=i.cases["!"+n.ngSwitchWhen]||[],i.cases["!"+n.ngSwitchWhen].push({transclude:r,element:t})}}),wr=Zt({transclude:"element",priority:800,require:"^ngSwitch",link:function(e,t,n,i,r){i.cases["?"]=i.cases["?"]||[],i.cases["?"].push({transclude:r,element:t})}}),_r=Zt({link:function(e,t,n,r,o){if(!o)throw i("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",q(t));o(function(e){t.empty(),t.append(e)})}}),xr=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){if("text/ng-template"==n.type){var i=n.id,r=t[0].text;e.put(i,r)}}}}],Cr=i("ngOptions"),$r=m({terminal:!0}),kr=["$compile","$parse",function(e,i){var r=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,a={$setViewValue:f};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function(e,t,n){var i,r,o=this,s={},l=a;o.databound=n.ngModel,o.init=function(e,t,n){l=e,i=t,r=n},o.addOption=function(t){ie(t,'"option value"'),s[t]=!0,l.$viewValue==t&&(e.val(t),r.parent()&&r.remove())},o.removeOption=function(e){this.hasOption(e)&&(delete s[e],l.$viewValue==e&&this.renderUnknownOption(e))},o.renderUnknownOption=function(t){var n="? "+Ae(t)+" ?";r.val(n),e.prepend(r),e.val(n),r.prop("selected",!0)},o.hasOption=function(e){return s.hasOwnProperty(e)},t.$on("$destroy",function(){o.renderUnknownOption=f})}],link:function(a,l,c,u){function h(e,t,n,i){n.$render=function(){var e=n.$viewValue;i.hasOption(e)?($.parent()&&$.remove(),t.val(e),""===e&&f.prop("selected",!0)):v(e)&&f?t.val(""):i.renderUnknownOption(e)},t.on("change",function(){e.$apply(function(){$.parent()&&$.remove(),n.$setViewValue(t.val())})})}function d(e,t,n){var i;n.$render=function(){var e=new Oe(n.$viewValue);o(t.find("option"),function(t){t.selected=b(e.get(t.value))})},e.$watch(function(){F(i,n.$viewValue)||(i=N(n.$viewValue),n.$render())}),t.on("change",function(){e.$apply(function(){var e=[];o(t.find("option"),function(t){t.selected&&e.push(t.value)}),n.$setViewValue(e)})})}function p(t,o,a){function l(){var e=!1;if(y){var n=a.$modelValue;if($&&Dn(n)){e=new Oe([]);for(var i={},r=0;r<n.length;r++)i[d]=n[r],e.put($(t,i),n[r])}else e=new Oe(n)}return e}function c(){var e,n,i,r,c,u,v,w,S,T,E,D,A,O,I,M={"":[]},P=[""],R=a.$modelValue,N=m(t)||[],F=p?s(N):N,L={},j=l();for(E=0;S=F.length,S>E;E++){if(v=E,p){if(v=F[E],"$"===v.charAt(0))continue;L[p]=v}if(L[d]=N[v],e=f(t,L)||"",(n=M[e])||(n=M[e]=[],P.push(e)),y)D=b(j.remove($?$(t,L):g(t,L)));else{if($){var U={};U[d]=R,D=$(t,U)===$(t,L)}else D=R===g(t,L);j=j||D}I=h(t,L),I=b(I)?I:"",n.push({id:$?$(t,L):p?F[E]:E,label:I,selected:D})}for(y||(_||null===R?M[""].unshift({id:"",label:"",selected:!j}):j||M[""].unshift({id:"?",label:"",selected:!0})),T=0,w=P.length;w>T;T++){for(e=P[T],n=M[e],k.length<=T?(r={element:C.clone().attr("label",e),label:n.label},c=[r],k.push(c),o.append(r.element)):(c=k[T],r=c[0],r.label!=e&&r.element.attr("label",r.label=e)),A=null,E=0,S=n.length;S>E;E++)i=n[E],(u=c[E+1])?(A=u.element,u.label!==i.label&&A.text(u.label=i.label),u.id!==i.id&&A.val(u.id=i.id),A[0].selected!==i.selected&&(A.prop("selected",u.selected=i.selected),bn&&A.prop("selected",u.selected))):(""===i.id&&_?O=_:(O=x.clone()).val(i.id).prop("selected",i.selected).attr("selected",i.selected).text(i.label),c.push(u={element:O,label:i.label,id:i.id,selected:i.selected}),A?A.after(O):r.element.append(O),A=O);for(E++;c.length>E;)c.pop().element.remove()}for(;k.length>T;)k.pop()[0].element.remove()}var u;if(!(u=w.match(r)))throw Cr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",w,q(o));var h=i(u[2]||u[1]),d=u[4]||u[6],p=u[5],f=i(u[3]||""),g=i(u[2]?u[1]:d),m=i(u[7]),v=u[8],$=v?i(u[8]):null,k=[[{element:o,label:""}]];_&&(e(_)(t),_.removeClass("ng-scope"),_.remove()),o.empty(),o.on("change",function(){t.$apply(function(){var e,i,r,s,l,u,h,f,v,b=m(t)||[],w={};if(y){for(r=[],u=0,f=k.length;f>u;u++)for(e=k[u],l=1,h=e.length;h>l;l++)if((s=e[l].element)[0].selected){if(i=s.val(),p&&(w[p]=i),$)for(v=0;v<b.length&&(w[d]=b[v],$(t,w)!=i);v++);else w[d]=b[i];r.push(g(t,w))}}else if(i=o.val(),"?"==i)r=n;else if(""===i)r=null;else if($){for(v=0;v<b.length;v++)if(w[d]=b[v],$(t,w)==i){r=g(t,w);break}}else w[d]=b[i],p&&(w[p]=i),r=g(t,w);a.$setViewValue(r),c()})}),a.$render=c,t.$watchCollection(m,c),
t.$watchCollection(function(){var e={},n=m(t);if(n){for(var i=new Array(n.length),r=0,o=n.length;o>r;r++)e[d]=n[r],i[r]=h(t,e);return i}},c),y&&t.$watchCollection(function(){return a.$modelValue},c)}if(u[1]){for(var f,g=u[0],m=u[1],y=c.multiple,w=c.ngOptions,_=!1,x=yn(t.createElement("option")),C=yn(t.createElement("optgroup")),$=x.clone(),k=0,S=l.children(),T=S.length;T>k;k++)if(""===S[k].value){f=_=S.eq(k);break}g.init(m,_,$),y&&(m.$isEmpty=function(e){return!e||0===e.length}),w?p(a,l,m):y?d(a,l,m):h(a,l,m,g)}}}}],Sr=["$interpolate",function(e){var t={addOption:f,removeOption:f};return{restrict:"E",priority:100,compile:function(n,i){if(v(i.value)){var r=e(n.text(),!0);r||i.$set("value",n.text())}return function(e,n,i){var o="$selectController",s=n.parent(),a=s.data(o)||s.parent().data(o);a&&a.databound?n.prop("selected",!1):a=t,r?e.$watch(r,function(e,t){i.$set("value",e),e!==t&&a.removeOption(t),a.addOption(e)}):a.addOption(i.value),n.on("$destroy",function(){a.removeOption(i.value)})}}}}],Tr=m({restrict:"E",terminal:!0});return e.angular.bootstrap?void console.log("WARNING: Tried to load angular more than once."):(ee(),ae(Tn),void yn(t).ready(function(){Q(t,J)}))}(window,document),!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\\:form{display:block;}.ng-animate-block-transitions{transition:0s all!important;-webkit-transition:0s all!important;}.ng-hide-add-active,.ng-hide-remove{display:block!important;}</style>'),function(){"use strict";var e=angular.module("pasvaz.bindonce",[]);e.directive("bindonce",function(){var e=function(e){if(e&&0!==e.length){var t=angular.lowercase(""+e);e=!("f"===t||"0"===t||"false"===t||"no"===t||"n"===t||"[]"===t)}else e=!1;return e},t=parseInt((/msie (\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10);isNaN(t)&&(t=parseInt((/trident\/.*; rv:(\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10));var n={restrict:"AM",controller:["$scope","$element","$attrs","$interpolate",function(n,i,r,o){var s=function(t,n,i){var r="show"===n?"":"none",o="hide"===n?"":"none";t.css("display",e(i)?r:o)},a=function(e,t){if(angular.isObject(t)&&!angular.isArray(t)){var n=[];angular.forEach(t,function(e,t){e&&n.push(t)}),t=n}t&&e.addClass(angular.isArray(t)?t.join(" "):t)},l=function(e,t){e.transclude(t,function(t){var n=e.element.parent(),i=e.element&&e.element[e.element.length-1],r=n&&n[0]||i&&i.parentNode,o=i&&i.nextSibling||null;angular.forEach(t,function(e){r.insertBefore(e,o)})})},c={watcherRemover:void 0,binders:[],group:r.boName,element:i,ran:!1,addBinder:function(e){this.binders.push(e),this.ran&&this.runBinders()},setupWatcher:function(e){var t=this;this.watcherRemover=n.$watch(e,function(e){void 0!==e&&(t.removeWatcher(),t.checkBindonce(e))},!0)},checkBindonce:function(e){var t=this,n=e.$promise?e.$promise.then:e.then;"function"==typeof n?n(function(){t.runBinders()}):t.runBinders()},removeWatcher:function(){void 0!==this.watcherRemover&&(this.watcherRemover(),this.watcherRemover=void 0)},runBinders:function(){for(;this.binders.length>0;){var n=this.binders.shift();if(!this.group||this.group==n.group){var i=n.scope.$eval(n.interpolate?o(n.value):n.value);switch(n.attr){case"boIf":e(i)&&l(n,n.scope.$new());break;case"boSwitch":var r,c=n.controller[0];(r=c.cases["!"+i]||c.cases["?"])&&(n.scope.$eval(n.attrs.change),angular.forEach(r,function(e){l(e,n.scope.$new())}));break;case"boSwitchWhen":var u=n.controller[0];u.cases["!"+n.attrs.boSwitchWhen]=u.cases["!"+n.attrs.boSwitchWhen]||[],u.cases["!"+n.attrs.boSwitchWhen].push({transclude:n.transclude,element:n.element});break;case"boSwitchDefault":var u=n.controller[0];u.cases["?"]=u.cases["?"]||[],u.cases["?"].push({transclude:n.transclude,element:n.element});break;case"hide":case"show":s(n.element,n.attr,i);break;case"class":a(n.element,i);break;case"text":n.element.text(i);break;case"html":n.element.html(i);break;case"style":n.element.css(i);break;case"disabled":n.element.prop("disabled",i);break;case"src":n.element.attr(n.attr,i),t&&n.element.prop("src",i);break;case"attr":angular.forEach(n.attrs,function(e,t){var i,r;t.match(/^boAttr./)&&n.attrs[t]&&(i=t.replace(/^boAttr/,"").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=n.scope.$eval(n.attrs[t]),n.element.attr(i,r))});break;case"href":case"alt":case"title":case"id":case"value":n.element.attr(n.attr,i)}}}this.ran=!0}};angular.extend(this,c)}],link:function(e,t,n,i){var r=n.bindonce&&e.$eval(n.bindonce);void 0!==r?i.checkBindonce(r):(i.setupWatcher(n.bindonce),t.bind("$destroy",i.removeWatcher))}};return n}),angular.forEach([{directiveName:"boShow",attribute:"show"},{directiveName:"boHide",attribute:"hide"},{directiveName:"boClass",attribute:"class"},{directiveName:"boText",attribute:"text"},{directiveName:"boBind",attribute:"text"},{directiveName:"boHtml",attribute:"html"},{directiveName:"boSrcI",attribute:"src",interpolate:!0},{directiveName:"boSrc",attribute:"src"},{directiveName:"boHrefI",attribute:"href",interpolate:!0},{directiveName:"boHref",attribute:"href"},{directiveName:"boAlt",attribute:"alt"},{directiveName:"boTitle",attribute:"title"},{directiveName:"boId",attribute:"id"},{directiveName:"boStyle",attribute:"style"},{directiveName:"boDisabled",attribute:"disabled"},{directiveName:"boValue",attribute:"value"},{directiveName:"boAttr",attribute:"attr"},{directiveName:"boIf",transclude:"element",terminal:!0,priority:1e3},{directiveName:"boSwitch",require:"boSwitch",controller:function(){this.cases={}}},{directiveName:"boSwitchWhen",transclude:"element",priority:800,require:"^boSwitch"},{directiveName:"boSwitchDefault",transclude:"element",priority:800,require:"^boSwitch"}],function(t){var n=200;return e.directive(t.directiveName,function(){var e={priority:t.priority||n,transclude:t.transclude||!1,terminal:t.terminal||!1,require:["^bindonce"].concat(t.require||[]),controller:t.controller,compile:function(e,n,i){return function(e,n,r,o){var s=o[0],a=r.boParent;if(a&&s.group!==a){var l=s.element.parent();s=void 0;for(var c;9!==l[0].nodeType&&l.length;){if((c=l.data("$bindonceController"))&&c.group===a){s=c;break}l=l.parent()}if(!s)throw new Error("No bindonce controller: "+a)}s.addBinder({element:n,attr:t.attribute||t.directiveName,attrs:r,value:r[t.directiveName],interpolate:t.interpolate,group:a,transclude:i,controller:o.slice(1),scope:e})}}};return e})})}(),function(e){function t(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function n(e,t){function n(){le.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}var i=!0;return l(function(){return i&&(n(),i=!1),t.apply(this,arguments)},t)}function i(e,t){return function(n){return h(e.call(this,n),t)}}function r(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function o(){}function s(e){$(e),l(this,e)}function a(e){var t=v(e),n=t.year||0,i=t.quarter||0,r=t.month||0,o=t.week||0,s=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._milliseconds=+u+1e3*c+6e4*l+36e5*a,this._days=+s+7*o,this._months=+r+3*i+12*n,this._data={},this._bubble()}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function c(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&xe.hasOwnProperty(t)&&(n[t]=e[t]);return n}function u(e){return 0>e?Math.ceil(e):Math.floor(e)}function h(e,t,n){for(var i=""+Math.abs(e),r=e>=0;i.length<t;)i="0"+i;return(r?n?"+":"":"-")+i}function d(e,t,n,i){var r=t._milliseconds,o=t._days,s=t._months;i=null==i?!0:i,r&&e._d.setTime(+e._d+r*n),o&&ie(e,"Date",ne(e,"Date")+o*n),s&&te(e,ne(e,"Month")+s*n),i&&le.updateOffset(e,o||s)}function p(e){return"[object Array]"===Object.prototype.toString.call(e)}function f(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function g(e,t,n){var i,r=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),s=0;for(i=0;r>i;i++)(n&&e[i]!==t[i]||!n&&y(e[i])!==y(t[i]))&&s++;return s+o}function m(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=Qe[e]||Je[t]||t}return e}function v(e){var t,n,i={};for(n in e)e.hasOwnProperty(n)&&(t=m(n),t&&(i[t]=e[n]));return i}function b(t){var n,i;if(0===t.indexOf("week"))n=7,i="day";else{if(0!==t.indexOf("month"))return;n=12,i="month"}le[t]=function(r,o){var s,a,l=le.fn._lang[t],c=[];if("number"==typeof r&&(o=r,r=e),a=function(e){var t=le().utc().set(i,e);return l.call(le.fn._lang,t,r||"")},null!=o)return a(o);for(s=0;n>s;s++)c.push(a(s));return c}}function y(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function w(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function _(e,t,n){return J(le([e,11,31+t-n]),t,n).week}function x(e){return C(e)?366:365}function C(e){return e%4===0&&e%100!==0||e%400===0}function $(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[ge]<0||e._a[ge]>11?ge:e._a[me]<1||e._a[me]>w(e._a[fe],e._a[ge])?me:e._a[ve]<0||e._a[ve]>23?ve:e._a[be]<0||e._a[be]>59?be:e._a[ye]<0||e._a[ye]>59?ye:e._a[we]<0||e._a[we]>999?we:-1,e._pf._overflowDayOfYear&&(fe>t||t>me)&&(t=me),e._pf.overflow=t)}function k(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function S(e){return e?e.toLowerCase().replace("_","-"):e}function T(e,t){return t._isUTC?le(e).zone(t._offset||0):le(e).local()}function E(e,t){return t.abbr=e,_e[e]||(_e[e]=new o),_e[e].set(t),_e[e]}function D(e){delete _e[e]}function A(e){var t,n,i,r,o=0,s=function(e){if(!_e[e]&&Ce)try{require("./lang/"+e)}catch(t){}return _e[e]};if(!e)return le.fn._lang;if(!p(e)){if(n=s(e))return n;e=[e]}for(;o<e.length;){for(r=S(e[o]).split("-"),t=r.length,i=S(e[o+1]),i=i?i.split("-"):null;t>0;){if(n=s(r.slice(0,t).join("-")))return n;if(i&&i.length>=t&&g(r,i,!0)>=t-1)break;t--}o++}return le.fn._lang}function O(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function I(e){var t,n,i=e.match(Te);for(t=0,n=i.length;n>t;t++)i[t]=nt[i[t]]?nt[i[t]]:O(i[t]);return function(r){var o="";for(t=0;n>t;t++)o+=i[t]instanceof Function?i[t].call(r,e):i[t];return o}}function M(e,t){return e.isValid()?(t=P(t,e.lang()),Ze[t]||(Ze[t]=I(t)),Ze[t](e)):e.lang().invalidDate()}function P(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(Ee.lastIndex=0;i>=0&&Ee.test(e);)e=e.replace(Ee,n),Ee.lastIndex=0,i-=1;return e}function R(e,t){var n,i=t._strict;switch(e){case"Q":return je;case"DDDD":return He;case"YYYY":case"GGGG":case"gggg":return i?We:Oe;case"Y":case"G":case"g":return ze;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?Be:Ie;case"S":if(i)return je;case"SS":if(i)return Ue;case"SSS":if(i)return He;case"DDD":return Ae;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Pe;case"a":case"A":return A(t._l)._meridiemParse;case"X":return Fe;case"Z":case"ZZ":return Re;case"T":return Ne;case"SSSS":return Me;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?Ue:De;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return De;case"Do":return Le;default:return n=new RegExp(B(W(e.replace("\\","")),"i"))}}function N(e){e=e||"";var t=e.match(Re)||[],n=t[t.length-1]||[],i=(n+"").match(Ke)||["-",0,0],r=+(60*i[1])+y(i[2]);return"+"===i[0]?-r:r}function F(e,t,n){var i,r=n._a;switch(e){case"Q":null!=t&&(r[ge]=3*(y(t)-1));break;case"M":case"MM":null!=t&&(r[ge]=y(t)-1);break;case"MMM":case"MMMM":i=A(n._l).monthsParse(t),null!=i?r[ge]=i:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(r[me]=y(t));break;case"Do":null!=t&&(r[me]=y(parseInt(t,10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=y(t));break;case"YY":r[fe]=le.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":r[fe]=y(t);break;case"a":case"A":n._isPm=A(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":r[ve]=y(t);break;case"m":case"mm":r[be]=y(t);break;case"s":case"ss":r[ye]=y(t);break;case"S":case"SS":case"SSS":case"SSSS":r[we]=y(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=N(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=t)}}function L(e){var t,n,i,r,o,s,a,l,c,u,h=[];if(!e._d){for(i=U(e),e._w&&null==e._a[me]&&null==e._a[ge]&&(o=function(t){var n=parseInt(t,10);return t?t.length<3?n>68?1900+n:2e3+n:n:null==e._a[fe]?le().weekYear():e._a[fe]},s=e._w,null!=s.GG||null!=s.W||null!=s.E?a=Z(o(s.GG),s.W||1,s.E,4,1):(l=A(e._l),c=null!=s.d?K(s.d,l):null!=s.e?parseInt(s.e,10)+l._week.dow:0,u=parseInt(s.w,10)||1,null!=s.d&&c<l._week.dow&&u++,a=Z(o(s.gg),u,c,l._week.doy,l._week.dow)),e._a[fe]=a.year,e._dayOfYear=a.dayOfYear),e._dayOfYear&&(r=null==e._a[fe]?i[fe]:e._a[fe],e._dayOfYear>x(r)&&(e._pf._overflowDayOfYear=!0),n=G(r,0,e._dayOfYear),e._a[ge]=n.getUTCMonth(),e._a[me]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=h[t]=i[t];for(;7>t;t++)e._a[t]=h[t]=null==e._a[t]?2===t?1:0:e._a[t];h[ve]+=y((e._tzm||0)/60),h[be]+=y((e._tzm||0)%60),e._d=(e._useUTC?G:Y).apply(null,h)}}function j(e){var t;e._d||(t=v(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],L(e))}function U(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function H(e){e._a=[],e._pf.empty=!0;var t,n,i,r,o,s=A(e._l),a=""+e._i,l=a.length,c=0;for(i=P(e._f,s).match(Te)||[],t=0;t<i.length;t++)r=i[t],n=(a.match(R(r,e))||[])[0],n&&(o=a.substr(0,a.indexOf(n)),o.length>0&&e._pf.unusedInput.push(o),a=a.slice(a.indexOf(n)+n.length),c+=n.length),nt[r]?(n?e._pf.empty=!1:e._pf.unusedTokens.push(r),F(r,n,e)):e._strict&&!n&&e._pf.unusedTokens.push(r);e._pf.charsLeftOver=l-c,a.length>0&&e._pf.unusedInput.push(a),e._isPm&&e._a[ve]<12&&(e._a[ve]+=12),e._isPm===!1&&12===e._a[ve]&&(e._a[ve]=0),L(e),$(e)}function W(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r})}function B(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function z(e){var n,i,r,o,s;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)s=0,n=l({},e),n._pf=t(),n._f=e._f[o],H(n),k(n)&&(s+=n._pf.charsLeftOver,s+=10*n._pf.unusedTokens.length,n._pf.score=s,(null==r||r>s)&&(r=s,i=n));l(e,i||n)}function q(e){var t,n,i=e._i,r=qe.exec(i);if(r){for(e._pf.iso=!0,t=0,n=Ye.length;n>t;t++)if(Ye[t][1].exec(i)){e._f=Ye[t][0]+(r[6]||" ");break}for(t=0,n=Ge.length;n>t;t++)if(Ge[t][1].exec(i)){e._f+=Ge[t][0];break}i.match(Re)&&(e._f+="Z"),H(e)}else le.createFromInputFallback(e)}function V(t){var n=t._i,i=$e.exec(n);n===e?t._d=new Date:i?t._d=new Date(+i[1]):"string"==typeof n?q(t):p(n)?(t._a=n.slice(0),L(t)):f(n)?t._d=new Date(+n):"object"==typeof n?j(t):"number"==typeof n?t._d=new Date(n):le.createFromInputFallback(t)}function Y(e,t,n,i,r,o,s){var a=new Date(e,t,n,i,r,o,s);return 1970>e&&a.setFullYear(e),a}function G(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function K(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function X(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function Q(e,t,n){var i=pe(Math.abs(e)/1e3),r=pe(i/60),o=pe(r/60),s=pe(o/24),a=pe(s/365),l=45>i&&["s",i]||1===r&&["m"]||45>r&&["mm",r]||1===o&&["h"]||22>o&&["hh",o]||1===s&&["d"]||25>=s&&["dd",s]||45>=s&&["M"]||345>s&&["MM",pe(s/30)]||1===a&&["y"]||["yy",a];return l[2]=t,l[3]=e>0,l[4]=n,X.apply({},l)}function J(e,t,n){var i,r=n-t,o=n-e.day();return o>r&&(o-=7),r-7>o&&(o+=7),i=le(e).add("d",o),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function Z(e,t,n,i,r){var o,s,a=G(e,0,1).getUTCDay();return n=null!=n?n:r,o=r-a+(a>i?7:0)-(r>a?7:0),s=7*(t-1)+(n-r)+o+1,{year:s>0?e:e-1,dayOfYear:s>0?s:x(e-1)+s}}function ee(t){var n=t._i,i=t._f;return null===n||i===e&&""===n?le.invalid({nullInput:!0}):("string"==typeof n&&(t._i=n=A().preparse(n)),le.isMoment(n)?(t=c(n),t._d=new Date(+n._d)):i?p(i)?z(t):H(t):V(t),new s(t))}function te(e,t){var n;return"string"==typeof t&&(t=e.lang().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),w(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function ne(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function ie(e,t,n){return"Month"===t?te(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function re(e,t){return function(n){return null!=n?(ie(this,e,n),le.updateOffset(this,t),this):ne(this,e)}}function oe(e){le.duration.fn[e]=function(){return this._data[e]}}function se(e,t){le.duration.fn["as"+e]=function(){return+this/t}}function ae(e){"undefined"==typeof ender&&(ce=de.moment,de.moment=e?n("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",le):le)}for(var le,ce,ue,he="2.6.0",de="undefined"!=typeof global?global:this,pe=Math.round,fe=0,ge=1,me=2,ve=3,be=4,ye=5,we=6,_e={},xe={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},Ce="undefined"!=typeof module&&module.exports,$e=/^\/?Date\((\-?\d+)/i,ke=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Se=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Te=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Ee=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,De=/\d\d?/,Ae=/\d{1,3}/,Oe=/\d{1,4}/,Ie=/[+\-]?\d{1,6}/,Me=/\d+/,Pe=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Re=/Z|[\+\-]\d\d:?\d\d/gi,Ne=/T/i,Fe=/[\+\-]?\d+(\.\d{1,3})?/,Le=/\d{1,2}/,je=/\d/,Ue=/\d\d/,He=/\d{3}/,We=/\d{4}/,Be=/[+-]?\d{6}/,ze=/[+-]?\d+/,qe=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ve="YYYY-MM-DDTHH:mm:ssZ",Ye=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Ge=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ke=/([\+\-]|\d\d)/gi,Xe=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),Qe={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Je={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Ze={},et="DDD w W M D d".split(" "),tt="M D H h m s w W".split(" "),nt={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return h(this.year()%100,2)},YYYY:function(){return h(this.year(),4)},YYYYY:function(){return h(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+h(Math.abs(e),6)},gg:function(){return h(this.weekYear()%100,2)},gggg:function(){return h(this.weekYear(),4)},ggggg:function(){return h(this.weekYear(),5)},GG:function(){return h(this.isoWeekYear()%100,2)},GGGG:function(){return h(this.isoWeekYear(),4)},GGGGG:function(){return h(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return y(this.milliseconds()/100)},SS:function(){return h(y(this.milliseconds()/10),2)},SSS:function(){return h(this.milliseconds(),3)},SSSS:function(){return h(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+h(y(e/60),2)+":"+h(y(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+h(y(e/60),2)+h(y(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},it=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];et.length;)ue=et.pop(),nt[ue+"o"]=r(nt[ue],ue);for(;tt.length;)ue=tt.pop(),nt[ue+ue]=i(nt[ue],2);for(nt.DDDD=i(nt.DDD,3),l(o.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=le.utc([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=le([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,i):r.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return J(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),le=function(n,i,r,o){var s;return"boolean"==typeof r&&(o=r,r=e),s={},s._isAMomentObject=!0,s._i=n,s._f=i,s._l=r,s._strict=o,s._isUTC=!1,s._pf=t(),ee(s)},le.suppressDeprecationWarnings=!1,le.createFromInputFallback=n("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i)}),le.utc=function(n,i,r,o){var s;return"boolean"==typeof r&&(o=r,r=e),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=r,s._i=n,s._f=i,s._strict=o,s._pf=t(),ee(s).utc()},le.unix=function(e){return le(1e3*e)},le.duration=function(e,t){var n,i,r,o=e,s=null;return le.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(s=ke.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:y(s[me])*n,h:y(s[ve])*n,m:y(s[be])*n,s:y(s[ye])*n,ms:y(s[we])*n}):(s=Se.exec(e))&&(n="-"===s[1]?-1:1,r=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n},o={y:r(s[2]),M:r(s[3]),d:r(s[4]),h:r(s[5]),m:r(s[6]),s:r(s[7]),w:r(s[8])}),i=new a(o),le.isDuration(e)&&e.hasOwnProperty("_lang")&&(i._lang=e._lang),i},le.version=he,le.defaultFormat=Ve,le.momentProperties=xe,le.updateOffset=function(){},le.lang=function(e,t){var n;return e?(t?E(S(e),t):null===t?(D(e),e="en"):_e[e]||A(e),n=le.duration.fn._lang=le.fn._lang=A(e),n._abbr):le.fn._lang._abbr},le.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),A(e)},le.isMoment=function(e){return e instanceof s||null!=e&&e.hasOwnProperty("_isAMomentObject")},le.isDuration=function(e){return e instanceof a},ue=it.length-1;ue>=0;--ue)b(it[ue]);le.normalizeUnits=function(e){return m(e)},le.invalid=function(e){var t=le.utc(NaN);return null!=e?l(t._pf,e):t._pf.userInvalidated=!0,t},le.parseZone=function(){return le.apply(null,arguments).parseZone()},le.parseTwoDigitYear=function(e){return y(e)+(y(e)>68?1900:2e3)},l(le.fn=s.prototype,{clone:function(){return le(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=le(this).utc();return 0<e.year()&&e.year()<=9999?M(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):M(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return k(this)},isDSTShifted:function(){return this._a?this.isValid()&&g(this._a,(this._isUTC?le.utc(this._a):le(this._a)).toArray())>0:!1},parsingFlags:function(){return l({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=M(this,e||le.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?le.duration(+t,e):le.duration(e,t),d(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?le.duration(+t,e):le.duration(e,t),d(this,n,-1),this},diff:function(e,t,n){var i,r,o=T(e,this),s=6e4*(this.zone()-o.zone());return t=m(t),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+o.daysInMonth()),r=12*(this.year()-o.year())+(this.month()-o.month()),r+=(this-le(this).startOf("month")-(o-le(o).startOf("month")))/i,r-=6e4*(this.zone()-le(this).startOf("month").zone()-(o.zone()-le(o).startOf("month").zone()))/i,"year"===t&&(r/=12)):(i=this-o,r="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-s)/864e5:"week"===t?(i-s)/6048e5:i),n?r:u(r)},from:function(e,t){return le.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(le(),e)},calendar:function(){var e=T(le(),this).startOf("day"),t=this.diff(e,"days",!0),n=-6>t?"sameElse":-1>t?"lastWeek":0>t?"lastDay":1>t?"sameDay":2>t?"nextDay":7>t?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){return C(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=K(e,this.lang()),this.add({d:e-t})):t},month:re("Month",!0),startOf:function(e){switch(e=m(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=m(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+le(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+le(e).startOf(t)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+T(e,this).startOf(t)},min:function(e){return e=le.apply(null,arguments),this>e?this:e},max:function(e){return e=le.apply(null,arguments),e>this?this:e},zone:function(e,t){var n=this._offset||0;return null==e?this._isUTC?n:this._d.getTimezoneOffset():("string"==typeof e&&(e=N(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,n!==e&&(!t||this._changeInProgress?d(this,le.duration(n-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,le.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?le(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return w(this.year(),this.month())},dayOfYear:function(e){var t=pe((le(this).startOf("day")-le(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=J(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=J(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=J(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return _(this.year(),1,4)},weeksInYear:function(){var e=this._lang._week;return _(this.year(),e.dow,e.doy)},get:function(e){return e=m(e),this[e]()},set:function(e,t){return e=m(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=A(t),this)}}),le.fn.millisecond=le.fn.milliseconds=re("Milliseconds",!1),le.fn.second=le.fn.seconds=re("Seconds",!1),le.fn.minute=le.fn.minutes=re("Minutes",!1),le.fn.hour=le.fn.hours=re("Hours",!0),le.fn.date=re("Date",!0),le.fn.dates=n("dates accessor is deprecated. Use date instead.",re("Date",!0)),le.fn.year=re("FullYear",!0),le.fn.years=n("years accessor is deprecated. Use year instead.",re("FullYear",!0)),le.fn.days=le.fn.day,le.fn.months=le.fn.month,le.fn.weeks=le.fn.week,le.fn.isoWeeks=le.fn.isoWeek,le.fn.quarters=le.fn.quarter,le.fn.toJSON=le.fn.toISOString,
l(le.duration.fn=a.prototype,{_bubble:function(){var e,t,n,i,r=this._milliseconds,o=this._days,s=this._months,a=this._data;a.milliseconds=r%1e3,e=u(r/1e3),a.seconds=e%60,t=u(e/60),a.minutes=t%60,n=u(t/60),a.hours=n%24,o+=u(n/24),a.days=o%30,s+=u(o/30),a.months=s%12,i=u(s/12),a.years=i},weeks:function(){return u(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*y(this._months/12)},humanize:function(e){var t=+this,n=Q(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=le.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=le.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=m(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=m(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:le.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),i=Math.abs(this.hours()),r=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(i||r||o?"T":"")+(i?i+"H":"")+(r?r+"M":"")+(o?o+"S":""):"P0D"}});for(ue in Xe)Xe.hasOwnProperty(ue)&&(se(ue,Xe[ue]),oe(ue.toLowerCase()));se("Weeks",6048e5),le.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},le.lang("en",{ordinal:function(e){var t=e%10,n=1===y(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),Ce?module.exports=le:"function"==typeof define&&define.amd?(define("moment",function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(de.moment=ce),le}),ae(!0)):ae()}.call(this),function(e,t){"object"==typeof exports?module.exports=t(require("moment")):"function"==typeof define&&define.amd?define(["moment"],t):e.moment=t(e.moment)}(this,function(e){var t,n;return n={year:!0,month:!0,week:!0,day:!0,hour:!0,minute:!0,second:!0},t=function(){function t(t,n){this.start=e(t),this.end=e(n)}return t.prototype.contains=function(e){return e instanceof t?this.start<=e.start&&this.end>=e.end:this.start<=e&&e<=this.end},t.prototype._by_string=function(t,n){var i,r;for(i=e(this.start),r=[];this.contains(i);)n.call(this,i.clone()),r.push(i.add(1,t));return r},t.prototype._by_range=function(t,n){var i,r,o,s;if(r=Math.floor(this/t),r===1/0)return this;for(s=[],i=o=0;r>=0?r>=o:o>=r;i=r>=0?++o:--o)s.push(n.call(this,e(this.start.valueOf()+t.valueOf()*i)));return s},t.prototype.overlaps=function(e){return null!==this.intersect(e)},t.prototype.intersect=function(e){var n,i,r,o,s,a,l,c;return this.start<=(i=e.start)&&i<(n=this.end)&&n<e.end?new t(e.start,this.end):e.start<(o=this.start)&&o<(r=e.end)&&r<=this.end?new t(this.start,e.end):e.start<(a=this.start)&&a<(s=this.end)&&s<e.end?this:this.start<=(c=e.start)&&c<(l=e.end)&&l<=this.end?e:null},t.prototype.subtract=function(e){var n,i,r,o,s,a,l,c;return null===this.intersect(e)?[this]:e.start<=(i=this.start)&&i<(n=this.end)&&n<=e.end?[]:e.start<=(o=this.start)&&o<(r=e.end)&&r<this.end?[new t(e.end,this.end)]:this.start<(a=e.start)&&a<(s=this.end)&&s<=e.end?[new t(this.start,e.start)]:this.start<(c=e.start)&&c<(l=e.end)&&l<this.end?[new t(this.start,e.start),new t(e.end,this.end)]:void 0},t.prototype.by=function(e,t){return"string"==typeof e?this._by_string(e,t):this._by_range(e,t),this},t.prototype.valueOf=function(){return this.end-this.start},t.prototype.toDate=function(){return[this.start.toDate(),this.end.toDate()]},t.prototype.isSame=function(e){return this.start.isSame(e.start)&&this.end.isSame(e.end)},t.prototype.diff=function(e){return null==e&&(e=void 0),this.end.diff(this.start,e)},t}(),e.fn.range=function(i,r){return i in n?new t(e(this).startOf(i),e(this).endOf(i)):new t(i,r)},e.range=function(e,n){return new t(e,n)},e.fn.within=function(e){return e.contains(this._d)},e}),function(){angular.module("dateRangePicker",["pasvaz.bindonce"]),angular.module("dateRangePicker").directive("dateRangePicker",["$compile","$timeout",function(e,t){var n,i;return i='<div ng-show="visible" class="angular-date-range-picker__picker" ng-click="handlePickerClick($event)" ng-class="{\'angular-date-range-picker--ranged\': showRanged }">\n  <div class="angular-date-range-picker__timesheet">\n    <a ng-click="move(-1, $event)" class="angular-date-range-picker__prev-month">&#9664;</a>\n    <div bindonce ng-repeat="month in months" class="angular-date-range-picker__month">\n      <div class="angular-date-range-picker__month-name" bo-text="month.name"></div>\n      <table class="angular-date-range-picker__calendar">\n        <tr>\n          <th bindonce ng-repeat="day in month.weeks[1]" class="angular-date-range-picker__calendar-weekday" bo-text="day.date.format(\'dd\')">\n          </th>\n        </tr>\n        <tr bindonce ng-repeat="week in month.weeks">\n          <td\n              bo-class=\'{\n                "angular-date-range-picker__calendar-day": day,\n                "angular-date-range-picker__calendar-day-selected": day.selected,\n                "angular-date-range-picker__calendar-day-disabled": day.disabled,\n                "angular-date-range-picker__calendar-day-start": day.start\n              }\'\n              ng-repeat="day in week track by $index" ng-click="select(day, $event)">\n              <div class="angular-date-range-picker__calendar-day-wrapper" bo-text="day.date.date()"></div>\n          </td>\n        </tr>\n      </table>\n    </div>\n    <a ng-click="move(+1, $event)" class="angular-date-range-picker__next-month">&#9654;</a>\n  </div>\n  <div class="angular-date-range-picker__panel">\n    <div ng-show="showRanged">\n      Select range: <select ng-click="prevent_select($event)" ng-model="quick" ng-options="e.range as e.label for e in quickList"></select>\n    </div>\n    <div class="angular-date-range-picker__buttons">\n      <a ng-click="ok($event)" class="angular-date-range-picker__apply">Apply</a>\n      <a ng-click="hide($event)" class="angular-date-range-picker__cancel">cancel</a>\n    </div>\n  </div>\n</div>',n="CUSTOM",{restrict:"AE",replace:!0,template:'<span tabindex="0" ng-keydown="hide()" class="angular-date-range-picker__input">\n  <span ng-if="showRanged">\n    <span ng-show="!!model">{{ model.start.format("ll") }} - {{ model.end.format("ll") }}</span>\n    <span ng-hide="!!model">Select date range</span>\n  </span>\n  <span ng-if="!showRanged">\n    <span ng-show="!!model">{{ model.format("ll") }}</span>\n    <span ng-hide="!!model">Select date</span>\n  </span>\n</span>',scope:{model:"=ngModel",customSelectOptions:"=",ranged:"=",pastDates:"@",callback:"&"},link:function(r,o,s){var a,l,c,u,h,d;return r.quickListDefinitions=r.customSelectOptions,null==r.quickListDefinitions&&(r.quickListDefinitions=[{label:"This week",range:moment().range(moment().startOf("week").startOf("day"),moment().endOf("week").startOf("day"))},{label:"Next week",range:moment().range(moment().startOf("week").add(1,"week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This fortnight",range:moment().range(moment().startOf("week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This month",range:moment().range(moment().startOf("month").startOf("day"),moment().endOf("month").startOf("day"))},{label:"Next month",range:moment().range(moment().startOf("month").add(1,"month").startOf("day"),moment().add(1,"month").endOf("month").startOf("day"))}]),r.quick=null,r.range=null,r.selecting=!1,r.visible=!1,r.start=null,r.showRanged=void 0===r.ranged?!0:r.ranged,h=function(e){var t,i,o,s,a;if(null==e&&(e=!1),r.showRanged){for(r.quickList=[],e&&r.quickList.push({label:"Custom",range:n}),s=r.quickListDefinitions,a=[],i=0,o=s.length;o>i;i++)t=s[i],a.push(r.quickList.push(t));return a}},c=function(){var e,t;return r.showRanged?r.range=r.selection?(t=r.selection.start.clone().startOf("month").startOf("day"),e=t.clone().add(2,"months").endOf("month").startOf("day"),moment().range(t,e)):moment().range(moment().startOf("month").subtract(1,"month").startOf("day"),moment().endOf("month").add(1,"month").startOf("day")):(r.selection=!1,r.selection=r.model||!1,r.date=moment(r.model)||moment(),r.range=moment().range(moment(r.date).startOf("month"),moment(r.date).endOf("month")))},u=function(){var e,t,i,o;if(r.showRanged&&r.selection){for(o=r.quickList,t=0,i=o.length;i>t;t++)if(e=o[t],e.range!==n&&r.selection.start.startOf("day").unix()===e.range.start.startOf("day").unix()&&r.selection.end.startOf("day").unix()===e.range.end.startOf("day").unix())return r.quick=e.range,void h();return r.quick=n,h(!0)}},d=function(){var e,t,n,i,o,s;for(r.months=[],n=12*r.range.start.year()+r.range.start.month(),t=moment().startOf("week").day(),r.range.by("days",function(e){var i,o,s,a,l,c,u;return i=e.day()-t,0>i&&(i=7+i),s=12*e.year()+e.month()-n,l=parseInt((7+e.date()-i)/7),a=!1,o=!1,r.showRanged?r.start?(a=e===r.start,o=e<r.start):a=r.selection&&r.selection.contains(e):(a=e.isSame(r.selection),r.pastDates&&(o=moment().diff(e,"days")>0)),(c=r.months)[s]||(c[s]={name:e.format("MMMM YYYY"),weeks:[]}),(u=r.months[s].weeks)[l]||(u[l]=[]),r.months[s].weeks[l][i]={date:e,selected:a,disabled:o,start:r.start&&r.start.unix()===e.unix()}}),s=r.months,i=0,o=s.length;o>i;i++)e=s[i],e.weeks[0]||e.weeks.splice(0,1);return u()},r.show=function(){return r.selection=r.model,c(),d(),r.visible=!0},r.hide=function(e){return null!=e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),r.visible=!1,r.start=null},r.prevent_select=function(e){return null!=e&&"function"==typeof e.stopPropagation?e.stopPropagation():void 0},r.ok=function(e){return null!=e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),r.model=r.selection,t(function(){return r.callback?r.callback():void 0}),r.hide()},r.select=function(e,t){return null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),e.disabled?void 0:(r.showRanged?(r.selecting=!r.selecting,r.selecting?r.start=e.date:(r.selection=moment().range(r.start,e.date),r.start=null)):r.selection=moment(e.date),d())},r.move=function(e,t){return null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),r.showRanged?r.range=moment().range(r.range.start.add(e,"months").startOf("month").startOf("day"),r.range.start.clone().add(2,"months").endOf("month").startOf("day")):(r.date.add(e,"months"),r.range=moment().range(moment(r.date).startOf("month"),moment(r.date).endOf("month"))),d()},r.handlePickerClick=function(e){return null!=e&&"function"==typeof e.stopPropagation?e.stopPropagation():void 0},r.$watch("quick",function(e,t){return e&&e!==n?(r.selection=r.quick,r.selecting=!1,r.start=null,c(),d()):void 0}),r.$watch("customSelectOptions",function(e){return"undefined"!=typeof customSelectOptions&&null!==customSelectOptions?r.quickListDefinitions=e:void 0}),l=e(angular.element(i))(r),o.append(l),o.bind("click",function(e){return null!=e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),r.$apply(function(){return r.visible?r.hide():r.show()})}),a=function(e){return r.$apply(function(){return r.hide()}),!0},angular.element(document).bind("click",a),r.$on("$destroy",function(){return angular.element(document).unbind("click",a)}),h(),c(),d()}}}])}.call(this),angular.module("ngMap",[]),function(){"use strict";function camelCase(e){return e.replace(SPECIAL_CHARS_REGEXP,function(e,t,n,i){return i?n.toUpperCase():n}).replace(MOZ_HACK_REGEXP,"Moz$1")}function JSONize(e){try{return JSON.parse(e),e}catch(t){return e.replace(/([\$\w]+)\s*:/g,function(e,t){return'"'+t+'":'}).replace(/'([^']+)'/g,function(e,t){return'"'+t+'"'})}}var SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,Attr2Options=function($parse,$timeout,NavigatorGeolocation,GeoCoder){var orgAttributes=function(e){e.length>0&&(e=e[0]);for(var t={},n=0;n<e.attributes.length;n++){var i=e.attributes[n];t[i.name]=i.value}return t},toOptionValue=function(input,options){var output,key=options.key,scope=options.scope;try{var num=Number(input);if(isNaN(num))throw"Not a number";output=num}catch(err){try{if(input.match(/^[\+\-]?[0-9\.]+,[ ]*\ ?[\+\-]?[0-9\.]+$/)&&(input="["+input+"]"),output=JSON.parse(JSONize(input)),output instanceof Array){var t1stEl=output[0];if(t1stEl.constructor==Object);else if(t1stEl.constructor==Array)output=output.map(function(e){return new google.maps.LatLng(e[0],e[1])});else if(!isNaN(parseFloat(t1stEl))&&isFinite(t1stEl))return new google.maps.LatLng(output[0],output[1])}}catch(err2){if(input.match(/^[A-Z][a-zA-Z0-9]+\(.*\)$/))try{var exp="new google.maps."+input;output=eval(exp)}catch(e){output=input}else if(input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/))try{var matches=input.match(/^([A-Z][a-zA-Z0-9]+)\.([A-Z]+)$/);output=google.maps[matches[1]][matches[2]]}catch(e){output=input}else if(input.match(/^[A-Z]+$/))try{var capitalizedKey=key.charAt(0).toUpperCase()+key.slice(1);key.match(/temperatureUnit|windSpeedUnit|labelColor/)?(capitalizedKey=capitalizedKey.replace(/s$/,""),output=google.maps.weather[capitalizedKey][input]):output=google.maps[capitalizedKey][input]}catch(e){output=input}else output=input}}return output},getAttrsToObserve=function(e){var t=[];if(e["ng-repeat"]||e.ngRepeat);else for(var n in e){var i=e[n];i&&i.match(/\{\{.*\}\}/)&&t.push(camelCase(n))}return t},filter=function(e){var t={};for(var n in e)n.match(/^\$/)||n.match(/^ng[A-Z]/)||(t[n]=e[n]);return t},getOptions=function(e,t){var n={};for(var i in e)if(e[i]){if(i.match(/^on[A-Z]/))continue;if(i.match(/ControlOptions$/))continue;n[i]=toOptionValue(e[i],{scope:t,key:i})}return n},getEvents=function(e,t){var n={},i=function(e){return"_"+e.toLowerCase()},r=function(t){var n=t.match(/([^\(]+)\(([^\)]*)\)/),i=n[1],r=n[2].replace(/event[ ,]*/,""),o=$parse("["+r+"]");return function(t){function n(e,t){return e[t]}var r=o(e),s=i.split(".").reduce(n,e);s&&s.apply(this,[t].concat(r)),$timeout(function(){e.$apply()})}};for(var o in t)if(t[o]){if(!o.match(/^on[A-Z]/))continue;var s=o.replace(/^on/,"");s=s.charAt(0).toLowerCase()+s.slice(1),s=s.replace(/([A-Z])/g,i);var a=t[o];n[s]=new r(a)}return n},getControlOptions=function(e){var t={};if("object"!=typeof e)return!1;for(var n in e)if(e[n]){if(!n.match(/(.*)ControlOptions$/))continue;var i=e[n],r=i.replace(/'/g,'"');r=r.replace(/([^"]+)|("[^"]+")/g,function(e,t,n){return t?t.replace(/([a-zA-Z0-9]+?):/g,'"$1":'):n});try{var o=JSON.parse(r);for(var s in o)if(o[s]){var a=o[s];if("string"==typeof a?a=a.toUpperCase():"mapTypeIds"===s&&(a=a.map(function(e){return e.match(/^[A-Z]+$/)?google.maps.MapTypeId[e.toUpperCase()]:e})),"style"===s){var l=n.charAt(0).toUpperCase()+n.slice(1),c=l.replace(/Options$/,"")+"Style";o[s]=google.maps[c][a]}else o[s]="position"===s?google.maps.ControlPosition[a]:a}t[n]=o}catch(u){}}return t};return{camelCase:camelCase,filter:filter,getOptions:getOptions,getEvents:getEvents,getControlOptions:getControlOptions,toOptionValue:toOptionValue,getAttrsToObserve:getAttrsToObserve,orgAttributes:orgAttributes}};Attr2Options.$inject=["$parse","$timeout","NavigatorGeolocation","GeoCoder"],angular.module("ngMap").service("Attr2Options",Attr2Options)}(),function(){"use strict";var e=function(e){return{geocode:function(t){var n=e.defer(),i=new google.maps.Geocoder;return i.geocode(t,function(e,t){t==google.maps.GeocoderStatus.OK?n.resolve(e):n.reject("Geocoder failed due to: "+t)}),n.promise}}};e.$inject=["$q"],angular.module("ngMap").service("GeoCoder",e)}(),function(){"use strict";var e=function(e){return{getCurrentPosition:function(){var t=e.defer();return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t.resolve(e)},function(e){t.reject(e)}):t.reject("Browser Geolocation service failed."),t.promise},watchPosition:function(){return"TODO"},clearWatch:function(){return"TODO"}}};e.$inject=["$q"],angular.module("ngMap").service("NavigatorGeolocation",e)}(),function(){"use strict";var e=function(e){var t=function(t,n){n=n||t.getCenter();var i=e.defer(),r=new google.maps.StreetViewService;return r.getPanoramaByLocation(n||t.getCenter,100,function(e,t){i.resolve(t===google.maps.StreetViewStatus.OK?e.location.pano:!1)}),i.promise},n=function(e,t){var n=new google.maps.StreetViewPanorama(e.getDiv(),{enableCloseButton:!0});n.setPano(t)};return{getPanorama:t,setPanorama:n}};e.$inject=["$q"],angular.module("ngMap").service("StreetView",e)}(),function(){"use strict";angular.module("ngMap").directive("bicyclingLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.BicyclingLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.orgAttributes(i),a=t.filter(r),l=t.getOptions(a),c=t.getEvents(e,a),u=n(l,c);o.addObject("bicyclingLayers",u),o.observeAttrSetObj(s,r,u),i.bind("$destroy",function(){o.deleteObject("bicyclingLayers",u)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("cloudLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.weather.CloudLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.orgAttributes(i),a=t.filter(r),l=t.getOptions(a),c=t.getEvents(e,a),u=n(l,c);o.addObject("cloudLayers",u),o.observeAttrSetObj(s,r,u),i.bind("$destroy",function(){o.deleteObject("cloudLayers",u)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("customControl",["Attr2Options","$compile",function(e,t){var n=e;return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=(n.orgAttributes(i),n.filter(r)),a=n.getOptions(s,e),l=n.getEvents(e,s),c=i[0].parentElement.removeChild(i[0]);t(c.innerHTML.trim())(e);for(var u in l)google.maps.event.addDomListener(c,u,l[u]);o.addObject("customControls",c),e.$on("mapInitialized",function(e,t){var n=a.position;t.controls[google.maps.ControlPosition[n]].push(c)})}}}])}(),function(){"use strict";var e=function(e,t){e.panel&&(e.panel=document.getElementById(e.panel)||document.querySelector(e.panel));var n=new google.maps.DirectionsRenderer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n},t=function(t,n){var i=t,r=new google.maps.DirectionsService,o=function(e,t){var i=t;i.travelMode=i.travelMode||"DRIVING";var o=["origin","destination","travelMode","transitOptions","unitSystem","durationInTraffic","waypoints","optimizeWaypoints","provideRouteAlternatives","avoidHighways","avoidTolls","region"];for(var s in i)-1===o.indexOf(s)&&delete i[s];i.origin&&i.destination&&r.route(i,function(t,i){i==google.maps.DirectionsStatus.OK&&n(function(){e.setDirections(t),e.setOptions({preserveViewport:!0,suppressMarkers:!0})})})},s=function(t,n,r,s){var a=i.orgAttributes(n),l=i.filter(r),c=i.getOptions(l),u=i.getEvents(t,l),h=i.getAttrsToObserve(a),d=e(c,u);s.addObject("directionsRenderers",d),h.forEach(function(e){!function(e){r.$observe(e,function(t){if(c[e]!==t){var n=i.toOptionValue(t,{key:e});c[e]=n,o(d,c)}})}(e)}),t.$on("mapInitialized",function(){o(d,c)}),t.$on("$destroy",function(){s.deleteObject("directionsRenderers",d)})};return{restrict:"E",require:"^map",link:s}};t.$inject=["Attr2Options","$timeout"],angular.module("ngMap").directive("directions",t)}(),function(){"use strict";angular.module("ngMap").directive("drawingManager",["Attr2Options",function(e){var t=e;return{restrict:"E",require:"^map",link:function(e,n,i,r){var o=(t.orgAttributes(n),t.filter(i)),s=t.getOptions(o),a=t.getControlOptions(o),l=t.getEvents(e,o),c=new google.maps.drawing.DrawingManager({drawingMode:s.drawingmode,drawingControl:s.drawingcontrol,drawingControlOptions:a.drawingControlOptions,circleOptions:s.circleoptions,markerOptions:s.markeroptions,polygonOptions:s.polygonoptions,polylineOptions:s.polylineoptions,rectangleOptions:s.rectangleoptions}),l=t.getEvents(e,o);for(var u in l)google.maps.event.addListener(c,u,l[u]);r.addObject("mapDrawingManager",c)}}}])}(),function(){"use strict";angular.module("ngMap").directive("dynamicMapsEngineLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.visualization.DynamicMapsEngineLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.filter(r),a=t.getOptions(s),l=t.getEvents(e,s,l),c=n(a,l);o.addObject("mapsEngineLayers",c)}}}])}(),function(){"use strict";angular.module("ngMap").directive("fusionTablesLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.FusionTablesLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.filter(r),a=t.getOptions(s),l=t.getEvents(e,s,l),c=n(a,l);o.addObject("fusionTablesLayers",c)}}}])}(),function(){"use strict";angular.module("ngMap").directive("heatmapLayer",["Attr2Options","$window",function(e,t){var n=e;return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=n.filter(r),a=n.getOptions(s);if(a.data=t[r.data]||e[r.data],!(a.data instanceof Array))throw"invalid heatmap data";a.data=new google.maps.MVCArray(a.data);var l=new google.maps.visualization.HeatmapLayer(a);n.getEvents(e,s),o.addObject("heatmapLayers",l)}}}])}(),function(){"use strict";var e=function(e,t,n,i){var r=e,o=function(e,i,r){var o;!e.position||e.position instanceof google.maps.LatLng||delete e.position,o=new google.maps.InfoWindow(e),Object.keys(i).length>0;for(var s in i)s&&google.maps.event.addListener(o,s,i[s]);var a=r.html().trim();if(1!=angular.element(a).length)throw"info-window working as a template must have a container";return o.__template=a.replace(/\s?ng-non-bindable[='"]+/,""),o.__compile=function(e,n){n&&(e["this"]=n);var i=t(o.__template)(e);o.setContent(i[0]),e.$apply()},o.__open=function(e,t,i){n(function(){o.__compile(t,i),i&&i.getPosition?o.open(e,i):i&&i instanceof google.maps.LatLng?(o.open(e),o.setPosition(i)):o.open(e)})},o},s=function(e,t,n,s){t.css("display","none");var a,l=r.orgAttributes(t),c=r.filter(n),u=r.getOptions(c,e),h=r.getEvents(e,c);!u.position||u.position instanceof google.maps.LatLng||(a=u.position);var d=o(u,h,t);a&&s.getGeoLocation(a).then(function(t){d.setPosition(t),d.__open(s.map,e,t);var r=n.geoCallback;r&&i(r)(e)}),s.addObject("infoWindows",d),s.observeAttrSetObj(l,n,d),e.$on("mapInitialized",function(t,n){if(d.visible&&d.__open(n,e),d.visibleOnMarker){var i=d.visibleOnMarker;d.__open(n,e,n.markers[i])}}),e.showInfoWindow=function(t,n,i){var r=s.map.infoWindows[n],o=i?i:this.getPosition?this:null;r.__open(s.map,e,o)},e.hideInfoWindow=e.hideInfoWindow||function(e,t){var n=s.map.infoWindows[t];n.close()}};return{restrict:"E",require:"^map",link:s}};e.$inject=["Attr2Options","$compile","$timeout","$parse"],angular.module("ngMap").directive("infoWindow",e)}(),function(){"use strict";angular.module("ngMap").directive("kmlLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.KmlLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.orgAttributes(i),a=t.filter(r),l=t.getOptions(a),c=t.getEvents(e,a),u=n(l,c);o.addObject("kmlLayers",u),o.observeAttrSetObj(s,r,u),i.bind("$destroy",function(){o.deleteObject("kmlLayers",u)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("mapData",["Attr2Options",function(e){var t=e;return{restrict:"E",require:"^map",link:function(e,n,i){var r=t.filter(i),o=t.getOptions(r),s=t.getEvents(e,r,s);e.$on("mapInitialized",function(t,n){for(var i in o)if(i){var r=o[i];n.data[i]("function"==typeof e[r]?e[r]:r)}for(var a in s)s[a]&&n.data.addListener(a,s[a])})}}}])}(),function(){"use strict";var e,t,n,i,r=function(r,o){if(window.lazyLoadCallback=function(){e(function(){o.html(i),t(o.contents())(r)},100)},void 0===window.google||void 0===window.google.maps){var s=document.createElement("script");s.src=n+(n.indexOf("?")>-1?"&":"?")+"callback=lazyLoadCallback",document.body.appendChild(s)}else o.html(i),t(o.contents())(r)},o=function(e,t){return!t.mapLazyLoad&&void 0,i=e.html(),n=t.mapLazyLoad,document.querySelector('script[src="'+n+'?callback=lazyLoadCallback"]')?!1:(e.html(""),{pre:r})},s=function(n,i){return t=n,e=i,{compile:o}};angular.module("ngMap").directive("mapLazyLoad",s)}(),function(){"use strict";angular.module("ngMap").directive("mapType",["Attr2Options","$window",function(e,t){return{restrict:"E",require:"^map",link:function(e,n,i,r){var o,s=i.name;if(!s)throw"invalid map-type name";if(i.object){var a=e[i.object]?e:t;o=a[i.object],"function"==typeof o&&(o=new o)}if(!o)throw"invalid map-type object";e.$on("mapInitialized",function(e,t){t.mapTypes.set(s,o)}),r.addObject("mapTypes",o)}}}])}(),function(){"use strict";function e(e,t){var n;return e.currentStyle?n=e.currentStyle[t]:window.getComputedStyle&&(n=document.defaultView.getComputedStyle(e,null).getPropertyValue(t)),n}var t=function(t,n,i){var r=t,o=function(t,o,s,a){var l=r.orgAttributes(o);t.google=google;var c=document.createElement("div");c.style.width="100%",c.style.height="100%",o.prepend(c),"false"!==s.defaultStyle&&("block"!=e(o[0],"display")&&o.css("display","block"),e(o[0],"height").match(/^(0|auto)/)&&o.css("height","300px")),o[0].addEventListener("dragstart",function(e){return e.preventDefault(),!1});var u=function(e,r){var o=new google.maps.Map(c,{});o.markers={},o.shapes={},n(function(){google.maps.event.trigger(o,"resize")}),e.zoom=e.zoom||15;var u=e.center;u?u instanceof google.maps.LatLng||(delete e.center,a.getGeoLocation(u).then(function(e){o.setCenter(e);var n=s.geoCallback;n&&i(n)(t)},function(){o.setCenter(d.geoFallbackCenter)})):e.center=new google.maps.LatLng(0,0),o.setOptions(e);for(var h in r)h&&google.maps.event.addListener(o,h,r[h]);a.observeAttrSetObj(l,s,o),a.map=o,a.addObjects(a._objects),t.map=o,t.map.scope=t,google.maps.event.addListenerOnce(o,"idle",function(){t.$emit("mapInitialized",o),s.zoomToIncludeMarkers&&a.zoomToIncludeMarkers()})},h=r.filter(s),d=r.getOptions(h,t),p=r.getControlOptions(h),f=angular.extend(d,p),g=r.getEvents(t,h);s.initEvent?t.$on(s.initEvent,function(){!a.map&&u(f,g)}):u(f,g)};return{restrict:"AE",controller:"MapController",link:o}};angular.module("ngMap").directive("map",["Attr2Options","$timeout","$parse",t])}(),function(){"use strict";var e=function(e,t,n,i){var r=i,o=this,s=function(e,t,n){e.$observe(t,function(e){if(e){var i=r.camelCase("set-"+t),s=r.toOptionValue(e,{key:t});n[i]&&(t.match(/center|position/)&&"string"==typeof s?o.getGeoLocation(s).then(function(e){n[i](e)}):n[i](s))}})};this.map=null,this._objects=[],this.addObject=function(e,t){if(this.map){this.map[e]=this.map[e]||{};var n=Object.keys(this.map[e]).length;this.map[e][t.id||n]=t,"infoWindows"!=e&&t.setMap&&t.setMap&&t.setMap(this.map),t.centered&&t.position&&this.map.setCenter(t.position)}else t.groupName=e,this._objects.push(t)},this.deleteObject=function(e,t){if(t.map){var n=t.map[e];for(var i in n)n[i]===t&&delete n[i];t.map&&t.setMap&&t.setMap(null)}},this.addObjects=function(e){for(var t=0;t<e.length;t++){var n=e[t];n instanceof google.maps.Marker?this.addObject("markers",n):n instanceof google.maps.Circle||n instanceof google.maps.Polygon||n instanceof google.maps.Polyline||n instanceof google.maps.Rectangle||n instanceof google.maps.GroundOverlay?this.addObject("shapes",n):this.addObject(n.groupName,n)}},this.getGeoLocation=function(i){var r=e.defer();return!i||i.match(/^current/i)?t.getCurrentPosition().then(function(e){var t=e.coords.latitude,n=e.coords.longitude,i=new google.maps.LatLng(t,n);r.resolve(i)},function(e){r.reject(e)}):n.geocode({address:i}).then(function(e){r.resolve(e[0].geometry.location)},function(e){r.reject(e)}),r.promise},this.observeAttrSetObj=function(e,t,n){var i=r.getAttrsToObserve(e);Object.keys(i).length;for(var o=0;o<i.length;o++)s(t,i[o],n)},this.zoomToIncludeMarkers=function(){var e=new google.maps.LatLngBounds;for(var t in this.map.markers)e.extend(this.map.markers[t].getPosition());this.map.fitBounds(e)}};e.$inject=["$q","NavigatorGeolocation","GeoCoder","Attr2Options"],angular.module("ngMap").controller("MapController",e)}(),function(){"use strict";angular.module("ngMap").directive("mapsEngineLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.visualization.MapsEngineLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.filter(r),a=t.getOptions(s),l=t.getEvents(e,s,l),c=n(a,l);o.addObject("mapsEngineLayers",c)}}}])}(),function(){"use strict";var e=function(e,t){var n;if(e.icon instanceof Object){(""+e.icon.path).match(/^[A-Z_]+$/)&&(e.icon.path=google.maps.SymbolPath[e.icon.path]);for(var i in e.icon){var r=e.icon[i];"anchor"==i||"origin"==i?e.icon[i]=new google.maps.Point(r[0],r[1]):("size"==i||"scaledSize"==i)&&(e.icon[i]=new google.maps.Size(r[0],r[1]))}}e.position instanceof google.maps.LatLng||(e.position=new google.maps.LatLng(0,0)),n=new google.maps.Marker(e),Object.keys(t).length>0;for(var o in t)o&&google.maps.event.addListener(n,o,t[o]);return n},t=function(t,n){var i=t,r=function(t,r,o,s){var a,l=i.orgAttributes(r),c=i.filter(o),u=i.getOptions(c,t),h=i.getEvents(t,c);u.position instanceof google.maps.LatLng||(a=u.position);var d=e(u,h);s.addObject("markers",d),a&&s.getGeoLocation(a).then(function(e){d.setPosition(e),u.centered&&d.map.setCenter(e);var i=o.geoCallback;i&&n(i)(t)}),s.observeAttrSetObj(l,o,d),r.bind("$destroy",function(){s.deleteObject("markers",d)})};return{restrict:"E",require:"^map",link:r}};t.$inject=["Attr2Options","$parse"],angular.module("ngMap").directive("marker",t)}(),function(){"use strict";angular.module("ngMap").directive("overlayMapType",["Attr2Options","$window",function(e,t){return{restrict:"E",require:"^map",link:function(e,n,i,r){var o,s=i.initMethod||"insertAt";if(i.object){var a=e[i.object]?e:t;o=a[i.object],"function"==typeof o&&(o=new o)}if(!o)throw"invalid map-type object";e.$on("mapInitialized",function(e,t){if("insertAt"==s){var n=parseInt(i.index,10);t.overlayMapTypes.insertAt(n,o)}else"push"==s&&t.overlayMapTypes.push(o)}),r.addObject("overlayMapTypes",o)}}}])}(),function(){"use strict";var e=function(e,t){var n=e,i=function(e,i,r,o){var s=n.filter(r),a=n.getOptions(s),l=n.getEvents(e,s),c=new google.maps.places.Autocomplete(i[0],a);for(var u in l)google.maps.event.addListener(c,u,l[u]);i[0].addEventListener("change",function(){t(function(){o&&o.$setViewValue(i.val())},100)}),r.$observe("types",function(e){if(e){var t=n.toOptionValue(e,{key:"types"});c.setTypes(t)}})};return{restrict:"A",require:"?ngModel",link:i}};e.$inject=["Attr2Options","$timeout"],angular.module("ngMap").directive("placesAutoComplete",e)}(),function(){"use strict";var e=function(e){return new google.maps.LatLngBounds(e[0],e[1])},t=function(t,n){var i,r=t.name;if(delete t.name,t.icons)for(var o=0;o<t.icons.length;o++){var s=t.icons[o];s.icon.path.match(/^[A-Z_]+$/)&&(s.icon.path=google.maps.SymbolPath[s.icon.path])}switch(r){case"circle":t.center instanceof google.maps.LatLng||(t.center=new google.maps.LatLng(0,0)),i=new google.maps.Circle(t);break;case"polygon":i=new google.maps.Polygon(t);break;case"polyline":i=new google.maps.Polyline(t);break;case"rectangle":t.bounds&&(t.bounds=e(t.bounds)),i=new google.maps.Rectangle(t);break;case"groundOverlay":case"image":var a=t.url,l=e(t.bounds),c={opacity:t.opacity,clickable:t.clickable,id:t.id};i=new google.maps.GroundOverlay(a,l,c)}for(var u in n)n[u]&&google.maps.event.addListener(i,u,n[u]);return i},n=function(e,n){var i=e,r=function(e,r,o,s){var a,l,c=i.orgAttributes(r),u=i.filter(o),h=i.getOptions(u),d=i.getEvents(e,u);l=h.name,h.center instanceof google.maps.LatLng||(a=h.center);var p=t(h,d);s.addObject("shapes",p),a&&"circle"==l&&s.getGeoLocation(a).then(function(t){
p.setCenter(t),p.centered&&p.map.setCenter(t);var i=o.geoCallback;i&&n(i)(e)}),s.observeAttrSetObj(c,o,p),r.bind("$destroy",function(){s.deleteObject("shapes",p)})};return{restrict:"E",require:"^map",link:r}};n.$inject=["Attr2Options","$parse"],angular.module("ngMap").directive("shape",n)}(),function(){"use strict";var e=function(e){var t=e,n=function(e,t,n){var i,r;t.container&&(r=document.getElementById(t.container),r=r||document.querySelector(t.container)),r?i=new google.maps.StreetViewPanorama(r,t):(i=e.getStreetView(),i.setOptions(t));for(var o in n)o&&google.maps.event.addListener(i,o,n[o]);return i},i=function(e,i,r){var o=(t.orgAttributes(i),t.filter(r)),s=t.getOptions(o),a=t.getControlOptions(o),l=angular.extend(s,a),c=t.getEvents(e,o);e.$on("mapInitialized",function(e,t){var i=n(t,l,c);t.setStreetView(i),!i.getPosition()&&i.setPosition(t.getCenter()),google.maps.event.addListener(i,"position_changed",function(){i.getPosition()!==t.getCenter()&&t.setCenter(i.getPosition())});var r=google.maps.event.addListener(t,"center_changed",function(){i.setPosition(t.getCenter()),google.maps.event.removeListener(r)})})};return{restrict:"E",require:"^map",link:i}};e.$inject=["Attr2Options"],angular.module("ngMap").directive("streetViewPanorama",e)}(),function(){"use strict";angular.module("ngMap").directive("trafficLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.TrafficLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.orgAttributes(i),a=t.filter(r),l=t.getOptions(a),c=t.getEvents(e,a),u=n(l,c);o.addObject("trafficLayers",u),o.observeAttrSetObj(s,r,u),i.bind("$destroy",function(){o.deleteObject("trafficLayers",u)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("transitLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.TransitLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.orgAttributes(i),a=t.filter(r),l=t.getOptions(a),c=t.getEvents(e,a),u=n(l,c);o.addObject("transitLayers",u),o.observeAttrSetObj(s,r,u),i.bind("$destroy",function(){o.deleteObject("transitLayers",u)})}}}])}(),function(){"use strict";angular.module("ngMap").directive("weatherLayer",["Attr2Options",function(e){var t=e,n=function(e,t){var n=new google.maps.weather.WeatherLayer(e);for(var i in t)google.maps.event.addListener(n,i,t[i]);return n};return{restrict:"E",require:"^map",link:function(e,i,r,o){var s=t.orgAttributes(i),a=t.filter(r),l=t.getOptions(a),c=t.getEvents(e,a),u=n(l,c);o.addObject("weatherLayers",u),o.observeAttrSetObj(s,r,u),i.bind("$destroy",function(){o.deleteObject("weatherLayers",u)})}}}])}(),function(e,t,n){var i=e();e.fn.dropdownHover=function(n){return"ontouchstart"in document?this:(i=i.add(this.parent()),this.each(function(){var r,o=e(this),s=o.parent(),a={delay:500,instantlyCloseOthers:!0},l={delay:e(this).data("delay"),instantlyCloseOthers:e(this).data("close-others")},c="show.bs.dropdown",u="hide.bs.dropdown",h=e.extend(!0,{},a,n,l);s.hover(function(e){return s.hasClass("open")||o.is(e.target)?(i.find(":focus").blur(),h.instantlyCloseOthers===!0&&i.removeClass("open"),t.clearTimeout(r),s.addClass("open"),void o.trigger(c)):!0},function(){r=t.setTimeout(function(){s.removeClass("open"),o.trigger(u)},h.delay)}),o.hover(function(){i.find(":focus").blur(),h.instantlyCloseOthers===!0&&i.removeClass("open"),t.clearTimeout(r),s.addClass("open"),o.trigger(c)}),s.find(".dropdown-submenu").each(function(){var n,i=e(this);i.hover(function(){t.clearTimeout(n),i.children(".dropdown-menu").show(),i.siblings().children(".dropdown-menu").hide()},function(){var e=i.children(".dropdown-menu");n=t.setTimeout(function(){e.hide()},h.delay)})})}))},e(document).ready(function(){e('[data-hover="dropdown"]').dropdownHover()})}(jQuery,this),function(e,t,n){"use strict";function i(e){var n=[];return l(n,t.noop).chars(e),n.join("")}function r(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function o(e,n){function i(e,i,o,a){if(i=t.lowercase(i),x[i])for(;b.last()&&C[b.last()];)r("",b.last());_[i]&&b.last()==i&&r("",i),(a=w[i]||!!a)||b.push(i);var l={};o.replace(d,function(e,t,n,i,r){l[t]=s(n||i||r||"")}),n.start&&n.start(i,l,a)}function r(e,i){var r,o=0;if(i=t.lowercase(i))for(o=b.length-1;o>=0&&b[o]!=i;o--);if(o>=0){for(r=b.length-1;r>=o;r--)n.end&&n.end(b[r]);b.length=o}}"string"!=typeof e&&(e=null===e||"undefined"==typeof e?"":""+e);var o,a,l,b=[],y=e;for(b.last=function(){return b[b.length-1]};e;){if(l="",a=!0,b.last()&&$[b.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+b.last()+"[^>]*>","i"),function(e,t){return t=t.replace(g,"$1").replace(v,"$1"),n.chars&&n.chars(s(t)),""}),r("",b.last())):(0===e.indexOf("<!--")?(o=e.indexOf("--",4),o>=0&&e.lastIndexOf("-->",o)===o&&(n.comment&&n.comment(e.substring(4,o)),e=e.substring(o+3),a=!1)):m.test(e)?(o=e.match(m))&&(e=e.replace(o[0],""),a=!1):f.test(e)?(o=e.match(h))&&(e=e.substring(o[0].length),o[0].replace(h,r),a=!1):p.test(e)&&((o=e.match(u))?(o[4]&&(e=e.substring(o[0].length),o[0].replace(u,i)),a=!1):(l+="<",e=e.substring(1))),a&&(o=e.indexOf("<"),l+=0>o?e:e.substring(0,o),e=0>o?"":e.substring(o),n.chars&&n.chars(s(l)))),e==y)throw c("badparse",e);y=e}r()}function s(e){if(!e)return"";var t=D.exec(e);e=t[1];var n=t[3];return(t=t[2])&&(E.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in E?E.textContent:E.innerText),e+t+n}function a(e){return e.replace(/&/g,"&amp;").replace(b,function(e){var t=e.charCodeAt(0);return e=e.charCodeAt(1),"&#"+(1024*(t-55296)+(e-56320)+65536)+";"}).replace(y,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(e,n){var i=!1,r=t.bind(e,e.push);return{start:function(e,o,s){e=t.lowercase(e),!i&&$[e]&&(i=e),i||!0!==k[e]||(r("<"),r(e),t.forEach(o,function(i,o){var s=t.lowercase(o),l="img"===e&&"src"===s||"background"===s;!0!==T[s]||!0===S[s]&&!n(i,l)||(r(" "),r(o),r('="'),r(a(i)),r('"'))}),r(s?"/>":">"))},end:function(e){e=t.lowercase(e),i||!0!==k[e]||(r("</"),r(e),r(">")),e==i&&(i=!1)},chars:function(e){i||r(a(e))}}}var c=t.$$minErr("$sanitize"),u=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,h=/^<\/\s*([\w:-]+)[^>]*>/,d=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,p=/^</,f=/^<\//,g=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,v=/<!\[CDATA\[(.*?)]]\x3e/g,b=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,y=/([^\#-~| |!])/g,w=r("area,br,col,hr,img,wbr");e=r("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),n=r("rp,rt");var _=t.extend({},n,e),x=t.extend({},e,r("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),C=t.extend({},n,r("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),$=r("script,style"),k=t.extend({},w,x,C,_),S=r("background,cite,href,longdesc,src,usemap"),T=t.extend({},S,r("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),E=document.createElement("pre"),D=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return o(t,l(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,r=/^mailto:/;return function(o,s){function a(e){e&&p.push(i(e))}function l(e,n){p.push("<a "),t.isDefined(s)&&(p.push('target="'),p.push(s),p.push('" ')),p.push('href="'),p.push(e),p.push('">'),a(n),p.push("</a>")}if(!o)return o;for(var c,u,h,d=o,p=[];c=d.match(n);)u=c[0],c[2]==c[3]&&(u="mailto:"+u),h=c.index,a(d.substr(0,h)),l(u,c[0].replace(r,"")),d=d.substring(h+c[0].length);return a(d),e(p.join(""))}}])}(window,window.angular),window.Modernizr=function(e,t,n){function i(e){y.cssText=e}function r(e,t){return i(C.join(e+";")+(t||""))}function o(e,t){return typeof e===t}function s(e,t){return!!~(""+e).indexOf(t)}function a(e,t){for(var i in e){var r=e[i];if(!s(r,"-")&&y[r]!==n)return"pfx"==t?r:!0}return!1}function l(e,t,i){for(var r in e){var s=t[e[r]];if(s!==n)return i===!1?e[r]:o(s,"function")?s.bind(i||t):s}return!1}function c(e,t,n){var i=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+k.join(i+" ")+i).split(" ");return o(t,"string")||o(t,"undefined")?a(r,t):(r=(e+" "+S.join(i+" ")+i).split(" "),l(r,t,n))}function u(){f.input=function(n){for(var i=0,r=n.length;r>i;i++)A[n[i]]=n[i]in w;return A.list&&(A.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),A}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),f.inputtypes=function(e){for(var i,r,o,s=0,a=e.length;a>s;s++)w.setAttribute("type",r=e[s]),i="text"!==w.type,i&&(w.value=_,w.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(r)&&w.style.WebkitAppearance!==n?(m.appendChild(w),o=t.defaultView,i=o.getComputedStyle&&"textfield"!==o.getComputedStyle(w,null).WebkitAppearance&&0!==w.offsetHeight,m.removeChild(w)):/^(search|tel)$/.test(r)||(i=/^(url|email)$/.test(r)?w.checkValidity&&w.checkValidity()===!1:w.value!=_)),D[e[s]]=!!i;return D}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var h,d,p="2.6.2",f={},g=!0,m=t.documentElement,v="modernizr",b=t.createElement(v),y=b.style,w=t.createElement("input"),_=":)",x={}.toString,C=" -webkit- -moz- -o- -ms- ".split(" "),$="Webkit Moz O ms",k=$.split(" "),S=$.toLowerCase().split(" "),T={svg:"http://www.w3.org/2000/svg"},E={},D={},A={},O=[],I=O.slice,M=function(e,n,i,r){var o,s,a,l,c=t.createElement("div"),u=t.body,h=u||t.createElement("body");if(parseInt(i,10))for(;i--;)a=t.createElement("div"),a.id=r?r[i]:v+(i+1),c.appendChild(a);return o=["&#173;",'<style id="s',v,'">',e,"</style>"].join(""),c.id=v,(u?c:h).innerHTML+=o,h.appendChild(c),u||(h.style.background="",h.style.overflow="hidden",l=m.style.overflow,m.style.overflow="hidden",m.appendChild(h)),s=n(c,e),u?c.parentNode.removeChild(c):(h.parentNode.removeChild(h),m.style.overflow=l),!!s},P=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var i;return M("@media "+t+" { #"+v+" { position: absolute; } }",function(t){i="absolute"==(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position}),i},R=function(){function e(e,r){r=r||t.createElement(i[e]||"div"),e="on"+e;var s=e in r;return s||(r.setAttribute||(r=t.createElement("div")),r.setAttribute&&r.removeAttribute&&(r.setAttribute(e,""),s=o(r[e],"function"),o(r[e],"undefined")||(r[e]=n),r.removeAttribute(e))),r=null,s}var i={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),N={}.hasOwnProperty;d=o(N,"undefined")||o(N.call,"undefined")?function(e,t){return t in e&&o(e.constructor.prototype[t],"undefined")}:function(e,t){return N.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=I.call(arguments,1),i=function(){if(this instanceof i){var r=function(){};r.prototype=t.prototype;var o=new r,s=t.apply(o,n.concat(I.call(arguments)));return Object(s)===s?s:o}return t.apply(e,n.concat(I.call(arguments)))};return i}),E.flexbox=function(){return c("flexWrap")},E.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},E.canvastext=function(){return!!f.canvas&&!!o(t.createElement("canvas").getContext("2d").fillText,"function")},E.webgl=function(){return!!e.WebGLRenderingContext},E.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:M(["@media (",C.join("touch-enabled),("),v,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=9===e.offsetTop}),n},E.geolocation=function(){return"geolocation"in navigator},E.postmessage=function(){return!!e.postMessage},E.websqldatabase=function(){return!!e.openDatabase},E.indexedDB=function(){return!!c("indexedDB",e)},E.hashchange=function(){return R("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},E.history=function(){return!!e.history&&!!history.pushState},E.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},E.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},E.rgba=function(){return i("background-color:rgba(150,255,150,.5)"),s(y.backgroundColor,"rgba")},E.hsla=function(){return i("background-color:hsla(120,40%,100%,.5)"),s(y.backgroundColor,"rgba")||s(y.backgroundColor,"hsla")},E.multiplebgs=function(){return i("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(y.background)},E.backgroundsize=function(){return c("backgroundSize")},E.borderimage=function(){return c("borderImage")},E.borderradius=function(){return c("borderRadius")},E.boxshadow=function(){return c("boxShadow")},E.textshadow=function(){return""===t.createElement("div").style.textShadow},E.opacity=function(){return r("opacity:.55"),/^0.55$/.test(y.opacity)},E.cssanimations=function(){return c("animationName")},E.csscolumns=function(){return c("columnCount")},E.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",n="linear-gradient(left top,#9f9, white);";return i((e+"-webkit- ".split(" ").join(t+e)+C.join(n+e)).slice(0,-e.length)),s(y.backgroundImage,"gradient")},E.cssreflections=function(){return c("boxReflect")},E.csstransforms=function(){return!!c("transform")},E.csstransforms3d=function(){var e=!!c("perspective");return e&&"webkitPerspective"in m.style&&M("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t,n){e=9===t.offsetLeft&&3===t.offsetHeight}),e},E.csstransitions=function(){return c("transition")},E.fontface=function(){var e;return M('@font-face {font-family:"font";src:url("https://")}',function(n,i){var r=t.getElementById("smodernizr"),o=r.sheet||r.styleSheet,s=o?o.cssRules&&o.cssRules[0]?o.cssRules[0].cssText:o.cssText||"":"";e=/src/i.test(s)&&0===s.indexOf(i.split(" ")[0])}),e},E.generatedcontent=function(){var e;return M(["#",v,"{font:0/0 a}#",v,':after{content:"',_,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},E.video=function(){var e=t.createElement("video"),n=!1;try{(n=!!e.canPlayType)&&(n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(i){}return n},E.audio=function(){var e=t.createElement("audio"),n=!1;try{(n=!!e.canPlayType)&&(n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(i){}return n},E.localstorage=function(){try{return localStorage.setItem(v,v),localStorage.removeItem(v),!0}catch(e){return!1}},E.sessionstorage=function(){try{return sessionStorage.setItem(v,v),sessionStorage.removeItem(v),!0}catch(e){return!1}},E.webworkers=function(){return!!e.Worker},E.applicationcache=function(){return!!e.applicationCache},E.svg=function(){return!!t.createElementNS&&!!t.createElementNS(T.svg,"svg").createSVGRect},E.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==T.svg},E.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(x.call(t.createElementNS(T.svg,"animate")))},E.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(x.call(t.createElementNS(T.svg,"clipPath")))};for(var F in E)d(E,F)&&(h=F.toLowerCase(),f[h]=E[F](),O.push((f[h]?"":"no-")+h));return f.input||u(),f.addTest=function(e,t){if("object"==typeof e)for(var i in e)d(e,i)&&f.addTest(i,e[i]);else{if(e=e.toLowerCase(),f[e]!==n)return f;t="function"==typeof t?t():t,"undefined"!=typeof g&&g&&(m.className+=" "+(t?"":"no-")+e),f[e]=t}return f},i(""),b=w=null,function(e,t){function n(e,t){var n=e.createElement("p"),i=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",i.insertBefore(n.lastChild,i.firstChild)}function i(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function r(e){var t=m[e[f]];return t||(t={},g++,e[f]=g,m[g]=t),t}function o(e,n,i){if(n||(n=t),u)return n.createElement(e);i||(i=r(n));var o;return o=i.cache[e]?i.cache[e].cloneNode():p.test(e)?(i.cache[e]=i.createElem(e)).cloneNode():i.createElem(e),o.canHaveChildren&&!d.test(e)?i.frag.appendChild(o):o}function s(e,n){if(e||(e=t),u)return e.createDocumentFragment();n=n||r(e);for(var o=n.frag.cloneNode(),s=0,a=i(),l=a.length;l>s;s++)o.createElement(a[s]);return o}function a(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return v.shivMethods?o(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+i().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function l(e){e||(e=t);var i=r(e);return v.shivCSS&&!c&&!i.hasCSS&&(i.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),u||a(e,i),e}var c,u,h=e.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f="_html5shiv",g=0,m={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",c="hidden"in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){c=!0,u=!0}}();var v={elements:h.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:h.shivCSS!==!1,supportsUnknownElements:u,shivMethods:h.shivMethods!==!1,type:"default",shivDocument:l,createElement:o,createDocumentFragment:s};e.html5=v,l(t)}(this,t),f._version=p,f._prefixes=C,f._domPrefixes=S,f._cssomPrefixes=k,f.mq=P,f.hasEvent=R,f.testProp=function(e){return a([e])},f.testAllProps=c,f.testStyles=M,f.prefixed=function(e,t,n){return t?c(e,t,n):c(e,"pfx")},m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(g?" js "+O.join(" "):""),f}(this,this.document),function(e,t,n){function i(e){return"[object Function]"==m.call(e)}function r(e){return"string"==typeof e}function o(){}function s(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function a(){var e=v.shift();b=1,e?e.t?f(function(){("c"==e.t?d.injectCss:d.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),a()):b=0}function l(e,n,i,r,o,l,c){function u(t){if(!p&&s(h.readyState)&&(y.r=p=1,!b&&a(),h.onload=h.onreadystatechange=null,t)){"img"!=e&&f(function(){_.removeChild(h)},50);for(var i in S[n])S[n].hasOwnProperty(i)&&S[n][i].onload()}}var c=c||d.errorTimeout,h=t.createElement(e),p=0,m=0,y={t:i,s:n,e:o,a:l,x:c};1===S[n]&&(m=1,S[n]=[]),"object"==e?h.data=n:(h.src=n,h.type=e),h.width=h.height="0",h.onerror=h.onload=h.onreadystatechange=function(){u.call(this,m)},v.splice(r,0,y),"img"!=e&&(m||2===S[n]?(_.insertBefore(h,w?null:g),f(u,c)):S[n].push(h))}function c(e,t,n,i,o){return b=0,t=t||"j",r(e)?l("c"==t?C:x,e,t,this.i++,n,i,o):(v.splice(this.i++,0,e),1==v.length&&a()),this}function u(){var e=d;return e.loader={load:c,i:0},e}var h,d,p=t.documentElement,f=e.setTimeout,g=t.getElementsByTagName("script")[0],m={}.toString,v=[],b=0,y="MozAppearance"in p.style,w=y&&!!t.createRange().compareNode,_=w?p:g.parentNode,p=e.opera&&"[object Opera]"==m.call(e.opera),p=!!t.attachEvent&&!p,x=y?"object":p?"script":"img",C=p?"script":x,$=Array.isArray||function(e){return"[object Array]"==m.call(e)},k=[],S={},T={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};d=function(e){function t(e){var t,n,i,e=e.split("!"),r=k.length,o=e.pop(),s=e.length,o={url:o,origUrl:o,prefixes:e};for(n=0;s>n;n++)i=e[n].split("="),(t=T[i.shift()])&&(o=t(o,i));for(n=0;r>n;n++)o=k[n](o);return o}function s(e,r,o,s,a){var l=t(e),c=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(r&&(r=i(r)?r:r[e]||r[s]||r[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,r,o,s,a):(S[l.url]?l.noexec=!0:S[l.url]=1,o.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":n,l.noexec,l.attrs,l.timeout),(i(r)||i(c))&&o.load(function(){u(),r&&r(l.origUrl,a,s),c&&c(l.origUrl,a,s),S[l.url]=2})))}function a(e,t){function n(e,n){if(e){if(r(e))n||(h=function(){var e=[].slice.call(arguments);d.apply(this,e),p()}),s(e,h,t,0,c);else if(Object(e)===e)for(l in a=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(),e)e.hasOwnProperty(l)&&(!n&&!--a&&(i(h)?h=function(){var e=[].slice.call(arguments);d.apply(this,e),p()}:h[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(d[l])),s(e[l],h,t,l,c))}else!n&&p()}var a,l,c=!!e.test,u=e.load||e.both,h=e.callback||o,d=h,p=e.complete||o;n(c?e.yep:e.nope,!!u),u&&n(u)}var l,c,h=this.yepnope.loader;if(r(e))s(e,0,h,0);else if($(e))for(l=0;l<e.length;l++)c=e[l],r(c)?s(c,0,h,0):$(c)?d(c):Object(c)===c&&a(c,h);else Object(e)===e&&a(e,h)},d.addPrefix=function(e,t){T[e]=t},d.addFilter=function(e){k.push(e)},d.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",h=function(){t.removeEventListener("DOMContentLoaded",h,0),t.readyState="complete"},0)),e.yepnope=u(),e.yepnope.executeStack=a,e.yepnope.injectJs=function(e,n,i,r,l,c){var u,h,p=t.createElement("script"),r=r||d.errorTimeout;p.src=e;for(h in i)p.setAttribute(h,i[h]);n=c?a:n||o,p.onreadystatechange=p.onload=function(){!u&&s(p.readyState)&&(u=1,n(),p.onload=p.onreadystatechange=null)},f(function(){u||(u=1,n(1))},r),l?p.onload():g.parentNode.insertBefore(p,g)},e.yepnope.injectCss=function(e,n,i,r,s,l){var c,r=t.createElement("link"),n=l?a:n||o;r.href=e,r.rel="stylesheet",r.type="text/css";for(c in i)r.setAttribute(c,i[c]);s||(g.parentNode.insertBefore(r,g),f(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},function(e,t,n){"use strict";function i(e,n){n=n||{},t.forEach(n,function(e,t){delete n[t]});for(var i in e)!e.hasOwnProperty(i)||"$"===i.charAt(0)&&"$"===i.charAt(1)||(n[i]=e[i]);return n}var r=t.$$minErr("$resource"),o=/^(\.[a-zA-Z_$][0-9a-zA-Z_$]*)+$/;t.module("ngResource",["ng"]).provider("$resource",function(){var e=this;this.defaults={stripTrailingSlashes:!0,actions:{get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}}},this.$get=["$http","$q",function(s,a){function l(t,n){this.template=t,this.defaults=d({},e.defaults,n),this.urlParams={}}function c(g,m,v,b){function y(e,t){var i={};return t=d({},m,t),h(t,function(t,s){f(t)&&(t=t());var a;if(t&&t.charAt&&"@"==t.charAt(0)){a=e;var l=t.substr(1);if(null==l||""===l||"hasOwnProperty"===l||!o.test("."+l))throw r("badmember",l);for(var l=l.split("."),c=0,u=l.length;u>c&&a!==n;c++){var h=l[c];a=null!==a?a[h]:n}}else a=t;i[s]=a}),i}function w(e){return e.resource}function _(e){i(e||{},this)}var x=new l(g,b);return v=d({},e.defaults.actions,v),_.prototype.toJSON=function(){var e=d({},this);return delete e.$promise,delete e.$resolved,e},h(v,function(e,o){var l=/^(POST|PUT|PATCH)$/i.test(e.method);_[o]=function(o,c,g,m){var v,b,C,$={};switch(arguments.length){case 4:C=m,b=g;case 3:case 2:if(!f(c)){$=o,v=c,b=g;break}if(f(o)){b=o,C=c;break}b=c,C=g;case 1:f(o)?b=o:l?v=o:$=o;break;case 0:break;default:throw r("badargs",arguments.length)}var k=this instanceof _,S=k?v:e.isArray?[]:new _(v),T={},E=e.interceptor&&e.interceptor.response||w,D=e.interceptor&&e.interceptor.responseError||n;return h(e,function(e,t){"params"!=t&&"isArray"!=t&&"interceptor"!=t&&(T[t]=p(e))}),l&&(T.data=v),x.setUrlParams(T,d({},y(v,e.params||{}),$),e.url),$=s(T).then(function(n){var o=n.data,s=S.$promise;if(o){if(t.isArray(o)!==!!e.isArray)throw r("badcfg",e.isArray?"array":"object",t.isArray(o)?"array":"object");e.isArray?(S.length=0,h(o,function(e){S.push("object"==typeof e?new _(e):e)})):(i(o,S),S.$promise=s)}return S.$resolved=!0,n.resource=S,n},function(e){return S.$resolved=!0,(C||u)(e),a.reject(e)}),$=$.then(function(e){var t=E(e);return(b||u)(t,e.headers),t},D),k?$:(S.$promise=$,S.$resolved=!1,S)},_.prototype["$"+o]=function(e,t,n){return f(e)&&(n=t,t=e,e={}),e=_[o].call(this,e,this,t,n),e.$promise||e}}),_.bind=function(e){return c(g,d({},m,e),v)},_}var u=t.noop,h=t.forEach,d=t.extend,p=t.copy,f=t.isFunction;return l.prototype={setUrlParams:function(e,n,i){var o,s,a=this,l=i||a.template,c=a.urlParams={};h(l.split(/\W/),function(e){if("hasOwnProperty"===e)throw r("badname");!/^\d+$/.test(e)&&e&&RegExp("(^|[^\\\\]):"+e+"(\\W|$)").test(l)&&(c[e]=!0)}),l=l.replace(/\\:/g,":"),n=n||{},h(a.urlParams,function(e,i){o=n.hasOwnProperty(i)?n[i]:a.defaults[i],t.isDefined(o)&&null!==o?(s=encodeURIComponent(o).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"%20").replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+"),l=l.replace(RegExp(":"+i+"(\\W|$)","g"),function(e,t){return s+t})):l=l.replace(RegExp("(/?):"+i+"(\\W|$)","g"),function(e,t,n){return"/"==n.charAt(0)?n:t+n})}),a.defaults.stripTrailingSlashes&&(l=l.replace(/\/+$/,"")||"/"),l=l.replace(/\/\.(?=\w+($|\?))/,"."),e.url=l.replace(/\/\\\./,"/."),h(n,function(t,n){a.urlParams[n]||(e.params=e.params||{},e.params[n]=t)})}},c}]})}(window,window.angular),function(e,t,n){"use strict";function i(e,n,i){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(r,o,s,a,l){function c(){p&&(p.remove(),p=null),h&&(h.$destroy(),h=null),d&&(i.leave(d,function(){p=null}),p=d,d=null)}function u(){var s=e.current&&e.current.locals;if(t.isDefined(s&&s.$template)){var s=r.$new(),a=e.current;d=l(s,function(e){i.enter(e,null,d||o,function(){!t.isDefined(f)||f&&!r.$eval(f)||n()}),c()}),h=a.scope=s,h.$emit("$viewContentLoaded"),h.$eval(g)}else c()}var h,d,p,f=s.autoscroll,g=s.onload||"";r.$on("$routeChangeSuccess",u),u()}}}function r(e,t,n){return{restrict:"ECA",priority:-400,link:function(i,r){var o=n.current,s=o.locals;r.html(s.$template);var a=e(r.contents());o.controller&&(s.$scope=i,s=t(o.controller,s),o.controllerAs&&(i[o.controllerAs]=s),r.data("$ngControllerController",s),r.children().data("$ngControllerController",s)),a(i)}}}e=t.module("ngRoute",["ng"]).provider("$route",function(){function e(e,n){return t.extend(new(t.extend(function(){},{prototype:e})),n)}function n(e,t){var n=t.caseInsensitiveMatch,i={originalPath:e,regexp:e},r=i.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(e,t,n,i){return e="?"===i?i:null,i="*"===i?i:null,r.push({name:n,optional:!!e}),t=t||"",""+(e?"":t)+"(?:"+(e?t:"")+(i&&"(.+?)"||"([^/]+)")+(e||"")+")"+(e||"")}).replace(/([\/$\*])/g,"\\$1"),i.regexp=RegExp("^"+e+"$",n?"i":""),i}var i={};this.when=function(e,r){if(i[e]=t.extend({reloadOnSearch:!0},r,e&&n(e,r)),e){var o="/"==e[e.length-1]?e.substr(0,e.length-1):e+"/";i[o]=t.extend({redirectTo:e},n(o,r))}return this},this.otherwise=function(e){return this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache","$sce",function(n,r,s,a,l,c,u,h){function d(){var e=p(),i=m.current;e&&i&&e.$$route===i.$$route&&t.equals(e.pathParams,i.pathParams)&&!e.reloadOnSearch&&!g?(i.params=e.params,t.copy(i.params,s),n.$broadcast("$routeUpdate",i)):(e||i)&&(g=!1,n.$broadcast("$routeChangeStart",e,i),(m.current=e)&&e.redirectTo&&(t.isString(e.redirectTo)?r.path(f(e.redirectTo,e.params)).search(e.params).replace():r.url(e.redirectTo(e.pathParams,r.path(),r.search())).replace()),a.when(e).then(function(){if(e){var n,i,r=t.extend({},e.resolve);return t.forEach(r,function(e,n){r[n]=t.isString(e)?l.get(e):l.invoke(e,null,null,n)}),t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(i=e.templateUrl)&&(t.isFunction(i)&&(i=i(e.params)),i=h.getTrustedResourceUrl(i),t.isDefined(i)&&(e.loadedTemplateUrl=i,n=c.get(i,{cache:u}).then(function(e){return e.data}))),t.isDefined(n)&&(r.$template=n),a.all(r)}}).then(function(r){e==m.current&&(e&&(e.locals=r,t.copy(e.params,s)),n.$broadcast("$routeChangeSuccess",e,i))},function(t){e==m.current&&n.$broadcast("$routeChangeError",e,i,t)}))}function p(){var n,o;return t.forEach(i,function(i,s){var a;if(a=!o){var l=r.path();a=i.keys;var c={};if(i.regexp)if(l=i.regexp.exec(l)){for(var u=1,h=l.length;h>u;++u){var d=a[u-1],p=l[u];d&&p&&(c[d.name]=p)}a=c}else a=null;else a=null;a=n=a}a&&(o=e(i,{params:t.extend({},r.search(),n),pathParams:n}),o.$$route=i)}),o||i[null]&&e(i[null],{params:{},pathParams:{}})}function f(e,n){var i=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)i.push(e);else{var r=e.match(/(\w+)(.*)/),o=r[1];i.push(n[o]),i.push(r[2]||""),delete n[o]}}),i.join("")}var g=!1,m={routes:i,reload:function(){g=!0,n.$evalAsync(d)},updateParams:function(e){if(!this.current||!this.current.$$route)throw o("norout");var n={},i=this;t.forEach(Object.keys(e),function(t){i.current.pathParams[t]||(n[t]=e[t])}),e=t.extend({},this.current.params,e),r.path(f(this.current.$$route.originalPath,e)),r.search(t.extend({},r.search(),n))}};return n.$on("$locationChangeSuccess",d),m}]});var o=t.$$minErr("ngRoute");e.provider("$routeParams",function(){this.$get=function(){return{}}}),e.directive("ngView",i),e.directive("ngView",r),i.$inject=["$route","$anchorScroll","$animate"],r.$inject=["$compile","$controller","$route"]}(window,window.angular),function(e,t,n){"use strict";t.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function(e,i){var r,o={},s={},a=!1,l=t.copy,c=t.isUndefined;return i.addPollFn(function(){var t=i.cookies();r!=t&&(r=t,l(t,s),l(t,o),a&&e.$apply())})(),a=!0,e.$watch(function(){var e,r,a;for(e in s)c(o[e])&&i.cookies(e,n);for(e in o)r=o[e],t.isString(r)||(r=""+r,o[e]=r),r!==s[e]&&(i.cookies(e,r),a=!0);if(a)for(e in r=i.cookies(),o)o[e]!==r[e]&&(c(r[e])?delete o[e]:o[e]=r[e])}),o}]).factory("$cookieStore",["$cookies",function(e){return{get:function(n){return(n=e[n])?t.fromJson(n):n},put:function(n,i){e[n]=t.toJson(i)},remove:function(t){delete e[t]}}}])}(window,window.angular),!function(e,t){"use strict";function n(e){for(var t=-1,n=Object.keys(e),i=new Array(n.length);++t<n.length;)i[t]=e[n[t]];return i}function i(e){return null===e}function r(e,t){var n=Object.keys(e);return-1==n.map(function(n){return!(!t[n]||t[n]!=e[n])}).indexOf(!1)}function o(e){return function(t,i){function r(e,t){return s(t)?!1:e.some(function(e){return h(e,t)})}if(t=l(t)?n(t):t,s(i))return t.filter(function(e,t,n){return n.indexOf(e)===t});var o=[],a=e(i);return t.filter(function(e){var t=a(e);return r(o,t)?!1:(o.push(t),!0)})}}var s=(t.isDefined,t.isUndefined),a=(t.isFunction,t.isString),l=t.isObject,c=t.isArray,u=(t.forEach,t.extend),h=(t.copy,t.equals);t.module("a8m.angular",[]).filter("isUndefined",function(){return function(e){return t.isUndefined(e)}}).filter("isDefined",function(){
return function(e){return t.isDefined(e)}}).filter("isFunction",function(){return function(e){return t.isFunction(e)}}).filter("isString",function(){return function(e){return t.isString(e)}}).filter("isNumber",function(){return function(e){return t.isNumber(e)}}).filter("isArray",function(){return function(e){return t.isArray(e)}}).filter("isObject",function(){return function(e){return t.isObject(e)}}).filter("isEqual",function(){return function(e,n){return t.equals(e,n)}}),t.module("a8m.is-null",[]).filter("isNull",function(){return function(e){return i(e)}}),t.module("a8m.after-where",[]).filter("afterWhere",function(){return function(e,t){if(e=l(e)?n(e):e,!c(e)||s(t))return e;var i=e.map(function(e){return r(t,e)}).indexOf(!0);return e.slice(-1===i?0:i)}}),t.module("a8m.after",[]).filter("after",function(){return function(e,t){return e=l(e)?n(e):e,c(e)?e.slice(t):e}}),t.module("a8m.before-where",[]).filter("beforeWhere",function(){return function(e,t){if(e=l(e)?n(e):e,!c(e)||s(t))return e;var i=e.map(function(e){return r(t,e)}).indexOf(!0);return e.slice(0,-1===i?e.length:++i)}}),t.module("a8m.before",[]).filter("before",function(){return function(e,t){return e=l(e)?n(e):e,c(e)?e.slice(0,t?--t:t):e}}),t.module("a8m.concat",[]).filter("concat",[function(){return function(e,t){if(s(t))return e;if(c(e))return e.concat(l(t)?n(t):t);if(l(e)){var i=n(e);return i.concat(l(t)?n(t):t)}return e}}]),t.module("a8m.group-by",[]).filter("groupBy",["$parse",function(e){return function(t,i){var r,o={},a=e(i);return t=l(t)?n(t):t,!c(t)||s(i)?t:(t.forEach(function(e){r=a(e),o[r]||(o[r]=[]),o[r].push(e)}),o)}}]),t.module("a8m.is-empty",[]).filter("isEmpty",function(){return function(e){return l(e)?!n(e).length:!e.length}}),t.module("a8m.remove-with",[]).filter("removeWith",function(){return function(e,t){return s(t)?e:(e=l(e)?n(e):e,e.filter(function(e){return!r(t,e)}))}}),t.module("a8m.remove",[]).filter("remove",function(){return function(e){e=l(e)?n(e):e;var t=Array.prototype.slice.call(arguments,1);return c(e)?e.filter(function(e){return!t.some(function(t){return h(t,e)})}):e}}),t.module("a8m.reverse",[]).filter("reverse",[function(){return function(e){return e=l(e)?n(e):e,a(e)?e.split("").reverse().join(""):c(e)?e.reverse():e}}]),t.module("a8m.search-field",[]).filter("searchField",["$parse",function(e){return function(t){var i,r;t=l(t)?n(t):t;var o=Array.prototype.slice.call(arguments,1);return c(t)&&o.length?t.map(function(t){return r=o.map(function(n){return(i=e(n))(t)}).join(" "),u({searchField:r},t)}):t}}]),t.module("a8m.unique",[]).filter({unique:["$parse",o],uniq:["$parse",o]}),t.module("a8m.where",[]).filter("where",function(){return function(e,t){return s(t)?e:(e=l(e)?n(e):e,e.filter(function(e){return r(t,e)}))}}),t.module("a8m.math",[]).factory("$math",["$window",function(e){return e.Math}]),t.module("a8m.math.max",["a8m.math"]).filter("max",["$math",function(e){return function(t){return c(t)?e.max.apply(e,t):t}}]),t.module("a8m.math.min",["a8m.math"]).filter("min",["$math",function(e){return function(t){return c(t)?e.min.apply(e,t):t}}]),t.module("a8m.remove-spaces",[]).filter("removeSpaces",[function(){return function(e,t){var n=t||"-";return a(e)?e.replace(/\s+/g,n):e}}]),t.module("a8m.stringular",[]).filter("stringular",function(){return function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,n){return s(t[n])?e:t[n]})}}),t.module("a8m.strip-tags",[]).filter("stripTags",function(){return function(e){return a(e)?e.replace(/<\S[^><]*>/g,""):e}}),t.module("a8m.truncate",[]).filter("truncate",function(){return function(e,t,n,i){return a(e)?(t=s(t)?e.length:t,i=i||!1,n=n||"",e.substring(0,i?-1===e.indexOf(" ",t)?t:e.indexOf(" ",t):t)+n):e}}),t.module("a8m.ucfirst",[]).filter("ucfirst",[function(){return function(e){return t.isString(e)?e.split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.substring(1)}).join(" "):e}}]),t.module("a8m.uri-encode",[]).filter("uriEncode",["$window",function(e){return function(t){return a(t)?e.encodeURI(t):t}}]),t.module("angular.filter",["a8m.ucfirst","a8m.uri-encode","a8m.remove-spaces","a8m.strip-tags","a8m.stringular","a8m.truncate","a8m.concat","a8m.unique","a8m.is-empty","a8m.after","a8m.after-where","a8m.before","a8m.before-where","a8m.where","a8m.reverse","a8m.remove","a8m.remove-with","a8m.group-by","a8m.search-field","a8m.math","a8m.math.max","a8m.math.min","a8m.angular","a8m.is-null"])}(window,window.angular),!function(e,t){return"function"==typeof define&&define.amd?void define("angular-file-upload",["angular"],function(e){return t(e)}):t(e)}("undefined"==typeof angular?null:angular,function(e){var t=e.module("angularFileUpload",[]);return t.value("fileUploaderOptions",{url:"/",alias:"file",headers:{},queue:[],progress:0,autoUpload:!1,removeAfterUpload:!1,method:"POST",filters:[],formData:[],queueLimit:Number.MAX_VALUE,withCredentials:!1}).factory("FileUploader",["fileUploaderOptions","$rootScope","$http","$window","$compile",function(t,n,i,r,o){function s(n){var i=e.copy(t);e.extend(this,i,n,{isUploading:!1,_nextIndex:0,_failFilterIndex:-1,_directives:{select:[],drop:[],over:[]}}),this.filters.unshift({name:"queueLimit",fn:this._queueLimitFilter}),this.filters.unshift({name:"folder",fn:this._folderFilter})}function a(t){var n=e.isElement(t),i=n?t.value:t,r=e.isString(i)?"FakePath":"Object",o="_createFrom"+r;this[o](i)}function l(t,n,i){var r=e.isElement(n),o=r?e.element(n):null,a=r?null:n;e.extend(this,{url:t.url,alias:t.alias,headers:e.copy(t.headers),formData:e.copy(t.formData),removeAfterUpload:t.removeAfterUpload,withCredentials:t.withCredentials,method:t.method},i,{uploader:t,file:new s.FileLikeObject(n),isReady:!1,isUploading:!1,isUploaded:!1,isSuccess:!1,isCancel:!1,isError:!1,progress:0,index:null,_file:a,_input:o}),o&&this._replaceNode(o)}function c(t){e.extend(this,t),this.uploader._directives[this.prop].push(this),this._saveLinks(),this.bind()}function u(){u.super_.apply(this,arguments),this.uploader.isHTML5||this.element.removeAttr("multiple"),this.element.prop("value",null)}function h(){h.super_.apply(this,arguments)}function d(){d.super_.apply(this,arguments)}return s.prototype.isHTML5=!(!r.File||!r.FormData),s.prototype.addToQueue=function(t,n,i){var r=this.isArrayLikeObject(t)?t:[t],o=this._getFilters(i),a=this.queue.length,l=[];e.forEach(r,function(e){var t=new s.FileLikeObject(e);if(this._isValidFile(t,o,n)){var i=new s.FileItem(this,e,n);l.push(i),this.queue.push(i),this._onAfterAddingFile(i)}else{var r=this.filters[this._failFilterIndex];this._onWhenAddingFileFailed(t,r,n)}},this),this.queue.length!==a&&(this._onAfterAddingAll(l),this.progress=this._getTotalProgress()),this._render(),this.autoUpload&&this.uploadAll()},s.prototype.removeFromQueue=function(e){var t=this.getIndexOfItem(e),n=this.queue[t];n.isUploading&&n.cancel(),this.queue.splice(t,1),n._destroy(),this.progress=this._getTotalProgress()},s.prototype.clearQueue=function(){for(;this.queue.length;)this.queue[0].remove();this.progress=0},s.prototype.uploadItem=function(e){var t=this.getIndexOfItem(e),n=this.queue[t],i=this.isHTML5?"_xhrTransport":"_iframeTransport";n._prepareToUploading(),this.isUploading||(this.isUploading=!0,this[i](n))},s.prototype.cancelItem=function(e){var t=this.getIndexOfItem(e),n=this.queue[t],i=this.isHTML5?"_xhr":"_form";n&&n.isUploading&&n[i].abort()},s.prototype.uploadAll=function(){var t=this.getNotUploadedItems().filter(function(e){return!e.isUploading});t.length&&(e.forEach(t,function(e){e._prepareToUploading()}),t[0].upload())},s.prototype.cancelAll=function(){var t=this.getNotUploadedItems();e.forEach(t,function(e){e.cancel()})},s.prototype.isFile=function(e){var t=r.File;return t&&e instanceof t},s.prototype.isFileLikeObject=function(e){return e instanceof s.FileLikeObject},s.prototype.isArrayLikeObject=function(t){return e.isObject(t)&&"length"in t},s.prototype.getIndexOfItem=function(t){return e.isNumber(t)?t:this.queue.indexOf(t)},s.prototype.getNotUploadedItems=function(){return this.queue.filter(function(e){return!e.isUploaded})},s.prototype.getReadyItems=function(){return this.queue.filter(function(e){return e.isReady&&!e.isUploading}).sort(function(e,t){return e.index-t.index})},s.prototype.destroy=function(){e.forEach(this._directives,function(t){e.forEach(this._directives[t],function(e){e.destroy()},this)},this)},s.prototype.onAfterAddingAll=function(){},s.prototype.onAfterAddingFile=function(){},s.prototype.onWhenAddingFileFailed=function(){},s.prototype.onBeforeUploadItem=function(){},s.prototype.onProgressItem=function(){},s.prototype.onProgressAll=function(){},s.prototype.onSuccessItem=function(){},s.prototype.onErrorItem=function(){},s.prototype.onCancelItem=function(){},s.prototype.onCompleteItem=function(){},s.prototype.onCompleteAll=function(){},s.prototype._getTotalProgress=function(e){if(this.removeAfterUpload)return e||0;var t=this.getNotUploadedItems().length,n=t?this.queue.length-t:this.queue.length,i=100/this.queue.length,r=(e||0)*i/100;return Math.round(n*i+r)},s.prototype._getFilters=function(t){if(e.isUndefined(t))return this.filters;if(e.isArray(t))return t;var n=t.match(/[^\s,]+/g);return this.filters.filter(function(e){return-1!==n.indexOf(e.name)},this)},s.prototype._render=function(){n.$$phase||n.$apply()},s.prototype._folderFilter=function(e){return!(!e.size&&!e.type)},s.prototype._queueLimitFilter=function(){return this.queue.length<this.queueLimit},s.prototype._isValidFile=function(e,t,n){return this._failFilterIndex=-1,t.length?t.every(function(t){return this._failFilterIndex++,t.fn.call(this,e,n)},this):!0},s.prototype._isSuccessCode=function(e){return e>=200&&300>e||304===e},s.prototype._transformResponse=function(t){return e.forEach(i.defaults.transformResponse,function(e){t=e(t)}),t},s.prototype._parseHeaders=function(t){function n(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function i(e){return e.toLowerCase()}var r,o,s,a={};return t?(e.forEach(t.split("\n"),function(e){s=e.indexOf(":"),r=i(n(e.substr(0,s))),o=n(e.substr(s+1)),r&&(a[r]=a[r]?a[r]+", "+o:o)}),a):a},s.prototype._xhrTransport=function(t){var n=t._xhr=new XMLHttpRequest,i=new FormData,r=this;r._onBeforeUploadItem(t),e.forEach(t.formData,function(t){e.forEach(t,function(e,t){i.append(t,e)})}),i.append(t.alias,t._file,t.file.name),n.upload.onprogress=function(e){var n=Math.round(e.lengthComputable?100*e.loaded/e.total:0);r._onProgressItem(t,n)},n.onload=function(){var e=r._parseHeaders(n.getAllResponseHeaders()),i=r._transformResponse(n.response),o=r._isSuccessCode(n.status)?"Success":"Error",s="_on"+o+"Item";r[s](t,i,n.status,e),r._onCompleteItem(t,i,n.status,e)},n.onerror=function(){var e=r._parseHeaders(n.getAllResponseHeaders()),i=r._transformResponse(n.response);r._onErrorItem(t,i,n.status,e),r._onCompleteItem(t,i,n.status,e)},n.onabort=function(){var e=r._parseHeaders(n.getAllResponseHeaders()),i=r._transformResponse(n.response);r._onCancelItem(t,i,n.status,e),r._onCompleteItem(t,i,n.status,e)},n.open(t.method,t.url,!0),n.withCredentials=t.withCredentials,e.forEach(t.headers,function(e,t){n.setRequestHeader(t,e)}),n.send(i),this._render()},s.prototype._iframeTransport=function(t){var n=e.element('<form style="display: none;" />'),i=e.element('<iframe name="iframeTransport'+Date.now()+'">'),r=t._input,o=this;t._form&&t._form.replaceWith(r),t._form=n,o._onBeforeUploadItem(t),r.prop("name",t.alias),e.forEach(t.formData,function(t){e.forEach(t,function(t,i){n.append(e.element('<input type="hidden" name="'+i+'" value="'+t+'" />'))})}),n.prop({action:t.url,method:"POST",target:i.prop("name"),enctype:"multipart/form-data",encoding:"multipart/form-data"}),i.bind("load",function(){try{var e=i[0].contentDocument.body.innerHTML}catch(n){}var r={response:e,status:200,dummy:!0},s=o._transformResponse(r.response),a={};o._onSuccessItem(t,s,r.status,a),o._onCompleteItem(t,s,r.status,a)}),n.abort=function(){var e,s={status:0,dummy:!0},a={};i.unbind("load").prop("src","javascript:false;"),n.replaceWith(r),o._onCancelItem(t,e,s.status,a),o._onCompleteItem(t,e,s.status,a)},r.after(n),n.append(r).append(i),n[0].submit(),this._render()},s.prototype._onWhenAddingFileFailed=function(e,t,n){this.onWhenAddingFileFailed(e,t,n)},s.prototype._onAfterAddingFile=function(e){this.onAfterAddingFile(e)},s.prototype._onAfterAddingAll=function(e){this.onAfterAddingAll(e)},s.prototype._onBeforeUploadItem=function(e){e._onBeforeUpload(),this.onBeforeUploadItem(e)},s.prototype._onProgressItem=function(e,t){var n=this._getTotalProgress(t);this.progress=n,e._onProgress(t),this.onProgressItem(e,t),this.onProgressAll(n),this._render()},s.prototype._onSuccessItem=function(e,t,n,i){e._onSuccess(t,n,i),this.onSuccessItem(e,t,n,i)},s.prototype._onErrorItem=function(e,t,n,i){e._onError(t,n,i),this.onErrorItem(e,t,n,i)},s.prototype._onCancelItem=function(e,t,n,i){e._onCancel(t,n,i),this.onCancelItem(e,t,n,i)},s.prototype._onCompleteItem=function(t,n,i,r){t._onComplete(n,i,r),this.onCompleteItem(t,n,i,r);var o=this.getReadyItems()[0];return this.isUploading=!1,e.isDefined(o)?void o.upload():(this.onCompleteAll(),this.progress=this._getTotalProgress(),void this._render())},s.isFile=s.prototype.isFile,s.isFileLikeObject=s.prototype.isFileLikeObject,s.isArrayLikeObject=s.prototype.isArrayLikeObject,s.isHTML5=s.prototype.isHTML5,s.inherit=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.super_=t},s.FileLikeObject=a,s.FileItem=l,s.FileDirective=c,s.FileSelect=u,s.FileDrop=h,s.FileOver=d,a.prototype._createFromFakePath=function(e){this.lastModifiedDate=null,this.size=null,this.type="like/"+e.slice(e.lastIndexOf(".")+1).toLowerCase(),this.name=e.slice(e.lastIndexOf("/")+e.lastIndexOf("\\")+2)},a.prototype._createFromObject=function(t){this.lastModifiedDate=e.copy(t.lastModifiedDate),this.size=t.size,this.type=t.type,this.name=t.name},l.prototype.upload=function(){this.uploader.uploadItem(this)},l.prototype.cancel=function(){this.uploader.cancelItem(this)},l.prototype.remove=function(){this.uploader.removeFromQueue(this)},l.prototype.onBeforeUpload=function(){},l.prototype.onProgress=function(){},l.prototype.onSuccess=function(){},l.prototype.onError=function(){},l.prototype.onCancel=function(){},l.prototype.onComplete=function(){},l.prototype._onBeforeUpload=function(){this.isReady=!0,this.isUploading=!0,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.onBeforeUpload()},l.prototype._onProgress=function(e){this.progress=e,this.onProgress(e)},l.prototype._onSuccess=function(e,t,n){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!0,this.isCancel=!1,this.isError=!1,this.progress=100,this.index=null,this.onSuccess(e,t,n)},l.prototype._onError=function(e,t,n){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!1,this.isCancel=!1,this.isError=!0,this.progress=0,this.index=null,this.onError(e,t,n)},l.prototype._onCancel=function(e,t,n){this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!0,this.isError=!1,this.progress=0,this.index=null,this.onCancel(e,t,n)},l.prototype._onComplete=function(e,t,n){this.onComplete(e,t,n),this.removeAfterUpload&&this.remove()},l.prototype._destroy=function(){this._input&&this._input.remove(),this._form&&this._form.remove(),delete this._form,delete this._input},l.prototype._prepareToUploading=function(){this.index=this.index||++this.uploader._nextIndex,this.isReady=!0},l.prototype._replaceNode=function(e){var t=o(e.clone())(e.scope());t.prop("value",null),e.css("display","none"),e.after(t)},c.prototype.events={},c.prototype.bind=function(){for(var e in this.events){var t=this.events[e];this.element.bind(e,this[t])}},c.prototype.unbind=function(){for(var e in this.events)this.element.unbind(e,this.events[e])},c.prototype.destroy=function(){var e=this.uploader._directives[this.prop].indexOf(this);this.uploader._directives[this.prop].splice(e,1),this.unbind()},c.prototype._saveLinks=function(){for(var e in this.events){var t=this.events[e];this[t]=this[t].bind(this)}},s.inherit(u,c),u.prototype.events={$destroy:"destroy",change:"onChange"},u.prototype.prop="select",u.prototype.getOptions=function(){},u.prototype.getFilters=function(){},u.prototype.isEmptyAfterSelection=function(){return!!this.element.attr("multiple")},u.prototype.onChange=function(){var e=this.uploader.isHTML5?this.element[0].files:this.element[0],t=this.getOptions(),n=this.getFilters();this.uploader.isHTML5||this.destroy(),this.uploader.addToQueue(e,t,n),this.isEmptyAfterSelection()&&this.element.prop("value",null)},s.inherit(h,c),h.prototype.events={$destroy:"destroy",drop:"onDrop",dragover:"onDragOver",dragleave:"onDragLeave"},h.prototype.prop="drop",h.prototype.getOptions=function(){},h.prototype.getFilters=function(){},h.prototype.onDrop=function(t){var n=this._getTransfer(t);if(n){var i=this.getOptions(),r=this.getFilters();this._preventAndStop(t),e.forEach(this.uploader._directives.over,this._removeOverClass,this),this.uploader.addToQueue(n.files,i,r)}},h.prototype.onDragOver=function(t){var n=this._getTransfer(t);this._haveFiles(n.types)&&(n.dropEffect="copy",this._preventAndStop(t),e.forEach(this.uploader._directives.over,this._addOverClass,this))},h.prototype.onDragLeave=function(t){t.target===this.element[0]&&(this._preventAndStop(t),e.forEach(this.uploader._directives.over,this._removeOverClass,this))},h.prototype._getTransfer=function(e){return e.dataTransfer?e.dataTransfer:e.originalEvent.dataTransfer},h.prototype._preventAndStop=function(e){e.preventDefault(),e.stopPropagation()},h.prototype._haveFiles=function(e){return e?e.indexOf?-1!==e.indexOf("Files"):e.contains?e.contains("Files"):!1:!1},h.prototype._addOverClass=function(e){e.addOverClass()},h.prototype._removeOverClass=function(e){e.removeOverClass()},s.inherit(d,c),d.prototype.events={$destroy:"destroy"},d.prototype.prop="over",d.prototype.overClass="nv-file-over",d.prototype.addOverClass=function(){this.element.addClass(this.getOverClass())},d.prototype.removeOverClass=function(){this.element.removeClass(this.getOverClass())},d.prototype.getOverClass=function(){return this.overClass},s}]).directive("nvFileSelect",["$parse","FileUploader",function(e,t){return{link:function(n,i,r){var o=n.$eval(r.uploader);if(!(o instanceof t))throw new TypeError('"Uploader" must be an instance of FileUploader');var s=new t.FileSelect({uploader:o,element:i});s.getOptions=e(r.options).bind(s,n),s.getFilters=function(){return r.filters}}}}]).directive("nvFileDrop",["$parse","FileUploader",function(e,t){return{link:function(n,i,r){var o=n.$eval(r.uploader);if(!(o instanceof t))throw new TypeError('"Uploader" must be an instance of FileUploader');if(o.isHTML5){var s=new t.FileDrop({uploader:o,element:i});s.getOptions=e(r.options).bind(s,n),s.getFilters=function(){return r.filters}}}}}]).directive("nvFileOver",["FileUploader",function(e){return{link:function(t,n,i){var r=t.$eval(i.uploader);if(!(r instanceof e))throw new TypeError('"Uploader" must be an instance of FileUploader');var o=new e.FileOver({uploader:r,element:n});o.getOverClass=function(){return i.overClass||this.overClass}}}}]),t}),angular.module("uz.mailto",[]).factory("Mailto",[function(){var e={};return e.url=function(e,t){var n="mailto:";n+=window.encodeURIComponent(e);var i=[];return angular.forEach(t,function(e,t){i.push(t.toLowerCase()+"="+window.encodeURIComponent(e))}),i.length>0&&(n+="?"+i.join("&")),n},e}]),angular.module("ui.bootstrap",["ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(e,t,n){function i(e){for(var t in e)if(void 0!==o.style[t])return e[t]}var r=function(i,o,s){s=s||{};var a=e.defer(),l=r[s.animation?"animationEndEventName":"transitionEndEventName"],c=function(){n.$apply(function(){i.unbind(l,c),a.resolve(i)})};return l&&i.bind(l,c),t(function(){angular.isString(o)?i.addClass(o):angular.isFunction(o)?o(i):angular.isObject(o)&&i.css(o),l||a.resolve(i)}),a.promise.cancel=function(){l&&i.unbind(l,c),a.reject("Transition cancelled")},a.promise},o=document.createElement("trans"),s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},a={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return r.transitionEndEventName=i(s),r.animationEndEventName=i(a),r}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(e){return{link:function(t,n,i){function r(t){function i(){c===r&&(c=void 0)}var r=e(n,t);return c&&c.cancel(),c=r,r.then(i,i),r}function o(){u?(u=!1,s()):(n.removeClass("collapse").addClass("collapsing"),r({height:n[0].scrollHeight+"px"}).then(s))}function s(){n.removeClass("collapsing"),n.addClass("collapse in"),n.css({height:"auto"})}function a(){u?(u=!1,l(),n.css({height:0})):(n.css({height:n[0].scrollHeight+"px"}),n[0].offsetWidth,n.removeClass("collapse in").addClass("collapsing"),r({height:0}).then(l))}function l(){n.removeClass("collapsing"),n.addClass("collapse")}var c,u=!0;t.$watch(i.collapse,function(e){e?a():o()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(e,t,n){this.groups=[],this.closeOthers=function(i){var r=angular.isDefined(t.closeOthers)?e.$eval(t.closeOthers):n.closeOthers;r&&angular.forEach(this.groups,function(e){e!==i&&(e.isOpen=!1)})},this.addGroup=function(e){var t=this;this.groups.push(e),e.$on("$destroy",function(){t.removeGroup(e)})},this.removeGroup=function(e){var t=this.groups.indexOf(e);-1!==t&&this.groups.splice(t,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(e){this.heading=e}},link:function(e,t,n,i){i.addGroup(e),e.$watch("isOpen",function(t){t&&i.closeOthers(e)}),e.toggleOpen=function(){e.isDisabled||(e.isOpen=!e.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(e,t,n,i,r){i.setHeading(r(e,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(e,t,n,i){e.$watch(function(){return i[n.accordionTransclude]},function(e){e&&(t.html(""),t.append(e))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(e,t){e.closeable="close"in t}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(e,t,n){t.addClass("ng-binding").data("$binding",n.bindHtmlUnsafe),e.$watch(n.bindHtmlUnsafe,function(e){t.html(e||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(e,t,n,i){var r=i[0],o=i[1];o.$render=function(){t.toggleClass(r.activeClass,angular.equals(o.$modelValue,e.$eval(n.btnRadio)))},t.bind(r.toggleEvent,function(){var i=t.hasClass(r.activeClass);(!i||angular.isDefined(n.uncheckable))&&e.$apply(function(){o.$setViewValue(i?null:e.$eval(n.btnRadio)),o.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(e,t,n,i){function r(){return s(n.btnCheckboxTrue,!0)}function o(){return s(n.btnCheckboxFalse,!1)}function s(t,n){var i=e.$eval(t);return angular.isDefined(i)?i:n}var a=i[0],l=i[1];l.$render=function(){t.toggleClass(a.activeClass,angular.equals(l.$modelValue,r()))},t.bind(a.toggleEvent,function(){e.$apply(function(){l.$setViewValue(t.hasClass(a.activeClass)?o():r()),l.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(e,t,n){function i(){r();var n=+e.interval;!isNaN(n)&&n>=0&&(s=t(o,n))}function r(){s&&(t.cancel(s),s=null)}function o(){a?(e.next(),i()):e.pause()}var s,a,l=this,c=l.slides=e.slides=[],u=-1;l.currentSlide=null;var h=!1;l.select=e.select=function(r,o){function s(){h||(l.currentSlide&&angular.isString(o)&&!e.noTransition&&r.$element?(r.$element.addClass(o),r.$element[0].offsetWidth,angular.forEach(c,function(e){angular.extend(e,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(r,{direction:o,active:!0,entering:!0}),angular.extend(l.currentSlide||{},{direction:o,leaving:!0}),e.$currentTransition=n(r.$element,{}),function(t,n){e.$currentTransition.then(function(){a(t,n)},function(){a(t,n)})}(r,l.currentSlide)):a(r,l.currentSlide),l.currentSlide=r,u=d,i())}function a(t,n){angular.extend(t,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(n||{},{direction:"",active:!1,leaving:!1,entering:!1}),e.$currentTransition=null}var d=c.indexOf(r);void 0===o&&(o=d>u?"next":"prev"),r&&r!==l.currentSlide&&(e.$currentTransition?(e.$currentTransition.cancel(),t(s)):s())},e.$on("$destroy",function(){h=!0}),l.indexOfSlide=function(e){return c.indexOf(e)},e.next=function(){var t=(u+1)%c.length;return e.$currentTransition?void 0:l.select(c[t],"next")},e.prev=function(){var t=0>u-1?c.length-1:u-1;return e.$currentTransition?void 0:l.select(c[t],"prev")},e.isActive=function(e){return l.currentSlide===e},e.$watch("interval",i),e.$on("$destroy",r),e.play=function(){a||(a=!0,i())},e.pause=function(){e.noPause||(a=!1,r())},l.addSlide=function(t,n){t.$element=n,c.push(t),1===c.length||t.active?(l.select(c[c.length-1]),1==c.length&&e.play()):t.active=!1},l.removeSlide=function(e){var t=c.indexOf(e);c.splice(t,1),c.length>0&&e.active?l.select(t>=c.length?c[t-1]:c[t]):u>t&&u--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(e,t,n,i){i.addSlide(e,t),e.$on("$destroy",function(){i.removeSlide(e)}),e.$watch("active",function(t){t&&i.select(e)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(e,t){function n(e){var n=[],i=e.split("");return angular.forEach(r,function(t,r){var o=e.indexOf(r);if(o>-1){e=e.split(""),i[o]="("+t.regex+")",e[o]="$";for(var s=o+1,a=o+r.length;a>s;s++)i[s]="",e[s]="$";e=e.join(""),n.push({index:o,apply:t.apply})}}),{regex:new RegExp("^"+i.join("")+"$"),map:t(n,"index")}}function i(e,t,n){return 1===t&&n>28?29===n&&(e%4===0&&e%100!==0||e%400===0):3===t||5===t||8===t||10===t?31>n:!0}this.parsers={};var r={yyyy:{regex:"\\d{4}",apply:function(e){this.year=+e}},yy:{regex:"\\d{2}",apply:function(e){this.year=+e+2e3}},y:{regex:"\\d{1,4}",apply:function(e){this.year=+e}},MMMM:{regex:e.DATETIME_FORMATS.MONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.MONTH.indexOf(t)}},MMM:{regex:e.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.SHORTMONTH.indexOf(t)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1}},M:{regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},EEEE:{regex:e.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:e.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(t,r){if(!angular.isString(t)||!r)return t;r=e.DATETIME_FORMATS[r]||r,this.parsers[r]||(this.parsers[r]=n(r));var o=this.parsers[r],s=o.regex,a=o.map,l=t.match(s);if(l&&l.length){for(var c,u={year:1900,month:0,date:1,hours:0},h=1,d=l.length;d>h;h++){var p=a[h-1];p.apply&&p.apply.call(u,l[h])}return i(u.year,u.month,u.date)&&(c=new Date(u.year,u.month,u.date,u.hours)),c}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(e,t){function n(e,n){return e.currentStyle?e.currentStyle[n]:t.getComputedStyle?t.getComputedStyle(e)[n]:e.style[n]}function i(e){return"static"===(n(e,"position")||"static")}var r=function(t){for(var n=e[0],r=t.offsetParent||n;r&&r!==n&&i(r);)r=r.offsetParent;return r||n};return{position:function(t){var n=this.offset(t),i={top:0,left:0},o=r(t[0]);o!=e[0]&&(i=this.offset(angular.element(o)),i.top+=o.clientTop-o.scrollTop,i.left+=o.clientLeft-o.scrollLeft);var s=t[0].getBoundingClientRect();return{width:s.width||t.prop("offsetWidth"),height:s.height||t.prop("offsetHeight"),top:n.top-i.top,left:n.left-i.left}},offset:function(n){var i=n[0].getBoundingClientRect();return{width:i.width||n.prop("offsetWidth"),height:i.height||n.prop("offsetHeight"),top:i.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:i.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}},positionElements:function(e,t,n,i){var r,o,s,a,l=n.split("-"),c=l[0],u=l[1]||"center";r=i?this.offset(e):this.position(e),o=t.prop("offsetWidth"),s=t.prop("offsetHeight");var h={center:function(){return r.left+r.width/2-o/2},left:function(){return r.left},right:function(){return r.left+r.width}},d={center:function(){return r.top+r.height/2-s/2},top:function(){return r.top},bottom:function(){return r.top+r.height}};switch(c){case"right":a={top:d[u](),left:h[c]()};break;case"left":a={top:d[u](),left:r.left-o};break;case"bottom":a={top:d[c](),left:h[u]()};break;default:a={top:r.top-s,left:h[u]()}}return a}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(e,t,n,i,r,o,s,a){var l=this,c={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(n,r){l[n]=angular.isDefined(t[n])?8>r?i(t[n])(e.$parent):e.$parent.$eval(t[n]):a[n]}),angular.forEach(["minDate","maxDate"],function(i){t[i]?e.$parent.$watch(n(t[i]),function(e){l[i]=e?new Date(e):null,l.refreshView()}):l[i]=a[i]?new Date(a[i]):null}),e.datepickerMode=e.datepickerMode||a.datepickerMode,e.uniqueId="datepicker-"+e.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(t.initDate)?e.$parent.$eval(t.initDate):new Date,e.isActive=function(t){return 0===l.compare(t.date,l.activeDate)?(e.activeDateId=t.uid,
!0):!1},this.init=function(e){c=e,c.$render=function(){l.render()}},this.render=function(){if(c.$modelValue){var e=new Date(c.$modelValue),t=!isNaN(e);t?this.activeDate=e:o.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),c.$setValidity("date",t)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var e=c.$modelValue?new Date(c.$modelValue):null;c.$setValidity("date-disabled",!e||this.element&&!this.isDisabled(e))}},this.createDateObject=function(e,t){var n=c.$modelValue?new Date(c.$modelValue):null;return{date:e,label:s(e,t),selected:n&&0===this.compare(e,n),disabled:this.isDisabled(e),current:0===this.compare(e,new Date)}},this.isDisabled=function(n){return this.minDate&&this.compare(n,this.minDate)<0||this.maxDate&&this.compare(n,this.maxDate)>0||t.dateDisabled&&e.dateDisabled({date:n,mode:e.datepickerMode})},this.split=function(e,t){for(var n=[];e.length>0;)n.push(e.splice(0,t));return n},e.select=function(t){if(e.datepickerMode===l.minMode){var n=c.$modelValue?new Date(c.$modelValue):new Date(0,0,0,0,0,0,0);n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),c.$setViewValue(n),c.$render()}else l.activeDate=t,e.datepickerMode=l.modes[l.modes.indexOf(e.datepickerMode)-1]},e.move=function(e){var t=l.activeDate.getFullYear()+e*(l.step.years||0),n=l.activeDate.getMonth()+e*(l.step.months||0);l.activeDate.setFullYear(t,n,1),l.refreshView()},e.toggleMode=function(t){t=t||1,e.datepickerMode===l.maxMode&&1===t||e.datepickerMode===l.minMode&&-1===t||(e.datepickerMode=l.modes[l.modes.indexOf(e.datepickerMode)+t])},e.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var u=function(){r(function(){l.element[0].focus()},0,!1)};e.$on("datepicker.focus",u),e.keydown=function(t){var n=e.keys[t.which];if(n&&!t.shiftKey&&!t.altKey)if(t.preventDefault(),t.stopPropagation(),"enter"===n||"space"===n){if(l.isDisabled(l.activeDate))return;e.select(l.activeDate),u()}else!t.ctrlKey||"up"!==n&&"down"!==n?(l.handleKeyDown(n,t),l.refreshView()):(e.toggleMode("up"===n?1:-1),u())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(e,t,n,i){var r=i[0],o=i[1];o&&r.init(o)}}}).directive("daypicker",["dateFilter",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(t,n,i,r){function o(e,t){return 1!==t||e%4!==0||e%100===0&&e%400!==0?l[t]:29}function s(e,t){var n=new Array(t),i=new Date(e),r=0;for(i.setHours(12);t>r;)n[r++]=new Date(i),i.setDate(i.getDate()+1);return n}function a(e){var t=new Date(e);t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1}t.showWeeks=r.showWeeks,r.step={months:1},r.element=n;var l=[31,28,31,30,31,30,31,31,30,31,30,31];r._refreshView=function(){var n=r.activeDate.getFullYear(),i=r.activeDate.getMonth(),o=new Date(n,i,1),l=r.startingDay-o.getDay(),c=l>0?7-l:-l,u=new Date(o);c>0&&u.setDate(-c+1);for(var h=s(u,42),d=0;42>d;d++)h[d]=angular.extend(r.createDateObject(h[d],r.formatDay),{secondary:h[d].getMonth()!==i,uid:t.uniqueId+"-"+d});t.labels=new Array(7);for(var p=0;7>p;p++)t.labels[p]={abbr:e(h[p].date,r.formatDayHeader),full:e(h[p].date,"EEEE")};if(t.title=e(r.activeDate,r.formatDayTitle),t.rows=r.split(h,7),t.showWeeks){t.weekNumbers=[];for(var f=a(t.rows[0][0].date),g=t.rows.length;t.weekNumbers.push(f++)<g;);}},r.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},r.handleKeyDown=function(e){var t=r.activeDate.getDate();if("left"===e)t-=1;else if("up"===e)t-=7;else if("right"===e)t+=1;else if("down"===e)t+=7;else if("pageup"===e||"pagedown"===e){var n=r.activeDate.getMonth()+("pageup"===e?-1:1);r.activeDate.setMonth(n,1),t=Math.min(o(r.activeDate.getFullYear(),r.activeDate.getMonth()),t)}else"home"===e?t=1:"end"===e&&(t=o(r.activeDate.getFullYear(),r.activeDate.getMonth()));r.activeDate.setDate(t)},r.refreshView()}}}]).directive("monthpicker",["dateFilter",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(t,n,i,r){r.step={years:1},r.element=n,r._refreshView=function(){for(var n=new Array(12),i=r.activeDate.getFullYear(),o=0;12>o;o++)n[o]=angular.extend(r.createDateObject(new Date(i,o,1),r.formatMonth),{uid:t.uniqueId+"-"+o});t.title=e(r.activeDate,r.formatMonthTitle),t.rows=r.split(n,3)},r.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth())-new Date(t.getFullYear(),t.getMonth())},r.handleKeyDown=function(e){var t=r.activeDate.getMonth();if("left"===e)t-=1;else if("up"===e)t-=3;else if("right"===e)t+=1;else if("down"===e)t+=3;else if("pageup"===e||"pagedown"===e){var n=r.activeDate.getFullYear()+("pageup"===e?-1:1);r.activeDate.setFullYear(n)}else"home"===e?t=0:"end"===e&&(t=11);r.activeDate.setMonth(t)},r.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(e,t,n,i){function r(e){return parseInt((e-1)/o,10)*o+1}var o=i.yearRange;i.step={years:o},i.element=t,i._refreshView=function(){for(var t=new Array(o),n=0,s=r(i.activeDate.getFullYear());o>n;n++)t[n]=angular.extend(i.createDateObject(new Date(s+n,0,1),i.formatYear),{uid:e.uniqueId+"-"+n});e.title=[t[0].label,t[o-1].label].join(" - "),e.rows=i.split(t,5)},i.compare=function(e,t){return e.getFullYear()-t.getFullYear()},i.handleKeyDown=function(e){var t=i.activeDate.getFullYear();"left"===e?t-=1:"up"===e?t-=5:"right"===e?t+=1:"down"===e?t+=5:"pageup"===e||"pagedown"===e?t+=("pageup"===e?-1:1)*i.step.years:"home"===e?t=r(i.activeDate.getFullYear()):"end"===e&&(t=r(i.activeDate.getFullYear())+o-1),i.activeDate.setFullYear(t)},i.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(e,t,n,i,r,o,s){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(a,l,c,u){function h(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function d(e){if(e){if(angular.isDate(e)&&!isNaN(e))return u.$setValidity("date",!0),e;if(angular.isString(e)){var t=o.parse(e,p)||new Date(e);return isNaN(t)?void u.$setValidity("date",!1):(u.$setValidity("date",!0),t)}return void u.$setValidity("date",!1)}return u.$setValidity("date",!0),null}var p,f=angular.isDefined(c.closeOnDateSelection)?a.$parent.$eval(c.closeOnDateSelection):s.closeOnDateSelection,g=angular.isDefined(c.datepickerAppendToBody)?a.$parent.$eval(c.datepickerAppendToBody):s.appendToBody;a.showButtonBar=angular.isDefined(c.showButtonBar)?a.$parent.$eval(c.showButtonBar):s.showButtonBar,a.getText=function(e){return a[e+"Text"]||s[e+"Text"]},c.$observe("datepickerPopup",function(e){p=e||s.datepickerPopup,u.$render()});var m=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");m.attr({"ng-model":"date","ng-change":"dateSelection()"});var v=angular.element(m.children()[0]);c.datepickerOptions&&angular.forEach(a.$parent.$eval(c.datepickerOptions),function(e,t){v.attr(h(t),e)}),a.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(e){if(c[e]){var n=t(c[e]);if(a.$parent.$watch(n,function(t){a.watchData[e]=t}),v.attr(h(e),"watchData."+e),"datepickerMode"===e){var i=n.assign;a.$watch("watchData."+e,function(e,t){e!==t&&i(a.$parent,e)})}}}),c.dateDisabled&&v.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),u.$parsers.unshift(d),a.dateSelection=function(e){angular.isDefined(e)&&(a.date=e),u.$setViewValue(a.date),u.$render(),f&&(a.isOpen=!1,l[0].focus())},l.bind("input change keyup",function(){a.$apply(function(){a.date=u.$modelValue})}),u.$render=function(){var e=u.$viewValue?r(u.$viewValue,p):"";l.val(e),a.date=d(u.$modelValue)};var b=function(e){a.isOpen&&e.target!==l[0]&&a.$apply(function(){a.isOpen=!1})},y=function(e){a.keydown(e)};l.bind("keydown",y),a.keydown=function(e){27===e.which?(e.preventDefault(),e.stopPropagation(),a.close()):40!==e.which||a.isOpen||(a.isOpen=!0)},a.$watch("isOpen",function(e){e?(a.$broadcast("datepicker.focus"),a.position=g?i.offset(l):i.position(l),a.position.top=a.position.top+l.prop("offsetHeight"),n.bind("click",b)):n.unbind("click",b)}),a.select=function(e){if("today"===e){var t=new Date;angular.isDate(u.$modelValue)?(e=new Date(u.$modelValue),e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate())):e=new Date(t.setHours(0,0,0,0))}a.dateSelection(e)},a.close=function(){a.isOpen=!1,l[0].focus()};var w=e(m)(a);m.remove(),g?n.find("body").append(w):l.after(w),a.$on("$destroy",function(){w.remove(),l.unbind("keydown",y),n.unbind("click",b)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(e,t){t.bind("click",function(e){e.preventDefault(),e.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(e){var t=null;this.open=function(r){t||(e.bind("click",n),e.bind("keydown",i)),t&&t!==r&&(t.isOpen=!1),t=r},this.close=function(r){t===r&&(t=null,e.unbind("click",n),e.unbind("keydown",i))};var n=function(e){var n=t.getToggleElement();e&&n&&n[0].contains(e.target)||t.$apply(function(){t.isOpen=!1})},i=function(e){27===e.which&&(t.focusToggleElement(),n())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(e,t,n,i,r,o){var s,a=this,l=e.$new(),c=i.openClass,u=angular.noop,h=t.onToggle?n(t.onToggle):angular.noop;this.init=function(i){a.$element=i,t.isOpen&&(s=n(t.isOpen),u=s.assign,e.$watch(s,function(e){l.isOpen=!!e}))},this.toggle=function(e){return l.isOpen=arguments.length?!!e:!l.isOpen},this.isOpen=function(){return l.isOpen},l.getToggleElement=function(){return a.toggleElement},l.focusToggleElement=function(){a.toggleElement&&a.toggleElement[0].focus()},l.$watch("isOpen",function(t,n){o[t?"addClass":"removeClass"](a.$element,c),t?(l.focusToggleElement(),r.open(l)):r.close(l),u(e,t),angular.isDefined(t)&&t!==n&&h(e,{open:!!t})}),e.$on("$locationChangeSuccess",function(){l.isOpen=!1}),e.$on("$destroy",function(){l.$destroy()})}]).directive("dropdown",function(){return{restrict:"CA",controller:"DropdownController",link:function(e,t,n,i){i.init(t)}}}).directive("dropdownToggle",function(){return{restrict:"CA",require:"?^dropdown",link:function(e,t,n,i){if(i){i.toggleElement=t;var r=function(r){r.preventDefault(),t.hasClass("disabled")||n.disabled||e.$apply(function(){i.toggle()})};t.bind("click",r),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(i.isOpen,function(e){t.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){t.unbind("click",r)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t==e[n].key)return e[n]},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){for(var n=-1,i=0;i<e.length;i++)if(t==e[i].key){n=i;break}return e.splice(n,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("modalBackdrop",["$timeout",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(t,n,i){t.backdropClass=i.backdropClass||"",t.animate=!1,e(function(){t.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(e,t){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(e,t){return t.templateUrl||"template/modal/window.html"},link:function(n,i,r){i.addClass(r.windowClass||""),n.size=r.size,t(function(){n.animate=!0,i[0].querySelectorAll("[autofocus]").length||i[0].focus()}),n.close=function(t){var n=e.getTop();n&&n.value.backdrop&&"static"!=n.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(e,t,n,i,r){r(e.$parent,function(e){t.empty(),t.append(e)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(e,t,n,i,r,o){function s(){for(var e=-1,t=p.keys(),n=0;n<t.length;n++)p.get(t[n]).value.backdrop&&(e=n);return e}function a(e){var t=n.find("body").eq(0),i=p.get(e).value;p.remove(e),c(i.modalDomEl,i.modalScope,300,function(){i.modalScope.$destroy(),t.toggleClass(d,p.length()>0),l()})}function l(){if(u&&-1==s()){var e=h;c(u,h,150,function(){e.$destroy(),e=null}),u=void 0,h=void 0}}function c(n,i,r,o){function s(){s.done||(s.done=!0,n.remove(),o&&o())}i.animate=!1;var a=e.transitionEndEventName;if(a){var l=t(s,r);n.bind(a,function(){t.cancel(l),s(),i.$apply()})}else t(s)}var u,h,d="modal-open",p=o.createNew(),f={};return r.$watch(s,function(e){h&&(h.index=e)}),n.bind("keydown",function(e){var t;27===e.which&&(t=p.top(),t&&t.value.keyboard&&(e.preventDefault(),r.$apply(function(){f.dismiss(t.key,"escape key press")})))}),f.open=function(e,t){p.add(e,{deferred:t.deferred,modalScope:t.scope,backdrop:t.backdrop,keyboard:t.keyboard});var o=n.find("body").eq(0),a=s();if(a>=0&&!u){h=r.$new(!0),h.index=a;var l=angular.element("<div modal-backdrop></div>");l.attr("backdrop-class",t.backdropClass),u=i(l)(h),o.append(u)}var c=angular.element("<div modal-window></div>");c.attr({"template-url":t.windowTemplateUrl,"window-class":t.windowClass,size:t.size,index:p.length()-1,animate:"animate"}).html(t.content);var f=i(c)(t.scope);p.top().value.modalDomEl=f,o.append(f),o.addClass(d)},f.close=function(e,t){var n=p.get(e);n&&(n.value.deferred.resolve(t),a(e))},f.dismiss=function(e,t){var n=p.get(e);n&&(n.value.deferred.reject(t),a(e))},f.dismissAll=function(e){for(var t=this.getTop();t;)this.dismiss(t.key,e),t=this.getTop()},f.getTop=function(){return p.top()},f}]).provider("$modal",function(){var e={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(t,n,i,r,o,s,a){function l(e){return e.template?i.when(e.template):r.get(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl,{cache:o}).then(function(e){return e.data})}function c(e){var n=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&n.push(i.when(t.invoke(e)))}),n}var u={};return u.open=function(t){var r=i.defer(),o=i.defer(),u={result:r.promise,opened:o.promise,close:function(e){a.close(u,e)},dismiss:function(e){a.dismiss(u,e)}};if(t=angular.extend({},e.options,t),t.resolve=t.resolve||{},!t.template&&!t.templateUrl)throw new Error("One of template or templateUrl options is required.");var h=i.all([l(t)].concat(c(t.resolve)));return h.then(function(e){var i=(t.scope||n).$new();i.$close=u.close,i.$dismiss=u.dismiss;var o,l={},c=1;t.controller&&(l.$scope=i,l.$modalInstance=u,angular.forEach(t.resolve,function(t,n){l[n]=e[c++]}),o=s(t.controller,l),t.controllerAs&&(i[t.controllerAs]=o)),a.open(u,{scope:i,deferred:r,content:e[0],backdrop:t.backdrop,keyboard:t.keyboard,backdropClass:t.backdropClass,windowClass:t.windowClass,windowTemplateUrl:t.windowTemplateUrl,size:t.size})},function(e){r.reject(e)}),h.then(function(){o.resolve(!0)},function(){o.reject(!1)}),u},u}]};return e}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(e,t,n){var i=this,r={$setViewValue:angular.noop},o=t.numPages?n(t.numPages).assign:angular.noop;this.init=function(o,s){r=o,this.config=s,r.$render=function(){i.render()},t.itemsPerPage?e.$parent.$watch(n(t.itemsPerPage),function(t){i.itemsPerPage=parseInt(t,10),e.totalPages=i.calculateTotalPages()}):this.itemsPerPage=s.itemsPerPage},this.calculateTotalPages=function(){var t=this.itemsPerPage<1?1:Math.ceil(e.totalItems/this.itemsPerPage);return Math.max(t||0,1)},this.render=function(){e.page=parseInt(r.$viewValue,10)||1},e.selectPage=function(t){e.page!==t&&t>0&&t<=e.totalPages&&(r.$setViewValue(t),r.$render())},e.getText=function(t){return e[t+"Text"]||i.config[t+"Text"]},e.noPrevious=function(){return 1===e.page},e.noNext=function(){return e.page===e.totalPages},e.$watch("totalItems",function(){e.totalPages=i.calculateTotalPages()}),e.$watch("totalPages",function(t){o(e.$parent,t),e.page>t?e.selectPage(t):r.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(e,t){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(n,i,r,o){function s(e,t,n){return{number:e,text:t,active:n}}function a(e,t){var n=[],i=1,r=t,o=angular.isDefined(u)&&t>u;o&&(h?(i=Math.max(e-Math.floor(u/2),1),r=i+u-1,r>t&&(r=t,i=r-u+1)):(i=(Math.ceil(e/u)-1)*u+1,r=Math.min(i+u-1,t)));for(var a=i;r>=a;a++){var l=s(a,a,a===e);n.push(l)}if(o&&!h){if(i>1){var c=s(i-1,"...",!1);n.unshift(c)}if(t>r){var d=s(r+1,"...",!1);n.push(d)}}return n}var l=o[0],c=o[1];if(c){var u=angular.isDefined(r.maxSize)?n.$parent.$eval(r.maxSize):t.maxSize,h=angular.isDefined(r.rotate)?n.$parent.$eval(r.rotate):t.rotate;n.boundaryLinks=angular.isDefined(r.boundaryLinks)?n.$parent.$eval(r.boundaryLinks):t.boundaryLinks,n.directionLinks=angular.isDefined(r.directionLinks)?n.$parent.$eval(r.directionLinks):t.directionLinks,l.init(c,t),r.maxSize&&n.$parent.$watch(e(r.maxSize),function(e){u=parseInt(e,10),l.render()});var d=l.render;l.render=function(){d(),n.page>0&&n.page<=n.totalPages&&(n.pages=a(n.page,n.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(e){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(t,n,i,r){var o=r[0],s=r[1];s&&(t.align=angular.isDefined(i.align)?t.$parent.$eval(i.align):e.align,o.init(s,e))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function e(e){var t=/[A-Z]/g,n="-";return e.replace(t,function(e,t){return(t?n:"")+e.toLowerCase()})}var t={placement:"top",animation:!0,popupDelay:0},n={mouseenter:"mouseleave",click:"click",focus:"blur"},i={};this.options=function(e){angular.extend(i,e)},this.setTriggers=function(e){angular.extend(n,e)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(r,o,s,a,l,c,u){return function(r,h,d){function p(e){var t=e||f.trigger||d,i=n[t]||t;return{show:t,hide:i}}var f=angular.extend({},t,i),g=e(r),m=u.startSymbol(),v=u.endSymbol(),b="<div "+g+'-popup title="'+m+"tt_title"+v+'" content="'+m+"tt_content"+v+'" placement="'+m+"tt_placement"+v+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var e=o(b);return function(t,n,i){function o(){t.tt_isOpen?d():u()}function u(){(!$||t.$eval(i[h+"Enable"]))&&(t.tt_popupDelay?_||(_=s(g,t.tt_popupDelay,!1),_.then(function(e){e()})):g()())}function d(){t.$apply(function(){m()})}function g(){return _=null,w&&(s.cancel(w),w=null),t.tt_content?(v(),y.css({top:0,left:0,display:"block"}),x?l.find("body").append(y):n.after(y),k(),t.tt_isOpen=!0,t.$digest(),k):angular.noop}function m(){t.tt_isOpen=!1,s.cancel(_),_=null,t.tt_animation?w||(w=s(b,500)):b()}function v(){y&&b(),y=e(t,function(){}),t.$digest()}function b(){w=null,y&&(y.remove(),y=null)}var y,w,_,x=angular.isDefined(f.appendToBody)?f.appendToBody:!1,C=p(void 0),$=angular.isDefined(i[h+"Enable"]),k=function(){var e=c.positionElements(n,y,t.tt_placement,x);e.top+="px",e.left+="px",y.css(e)};t.tt_isOpen=!1,i.$observe(r,function(e){t.tt_content=e,!e&&t.tt_isOpen&&m()}),i.$observe(h+"Title",function(e){t.tt_title=e}),i.$observe(h+"Placement",function(e){t.tt_placement=angular.isDefined(e)?e:f.placement}),i.$observe(h+"PopupDelay",function(e){var n=parseInt(e,10);t.tt_popupDelay=isNaN(n)?f.popupDelay:n});var S=function(){n.unbind(C.show,u),n.unbind(C.hide,d)};i.$observe(h+"Trigger",function(e){S(),C=p(e),C.show===C.hide?n.bind(C.show,o):(n.bind(C.show,u),n.bind(C.hide,d))});var T=t.$eval(i[h+"Animation"]);t.tt_animation=angular.isDefined(T)?!!T:f.animation,i.$observe(h+"AppendToBody",function(e){x=angular.isDefined(e)?a(e)(t):x}),x&&t.$on("$locationChangeSuccess",function(){t.tt_isOpen&&m()}),t.$on("$destroy",function(){s.cancel(w),s.cancel(_),S(),b()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(e){return e("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(e){return e("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(e){return e("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(e,t,n){var i=this,r=angular.isDefined(t.animate)?e.$parent.$eval(t.animate):n.animate;this.bars=[],e.max=angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max,this.addBar=function(t,n){r||n.css({transition:"none"}),this.bars.push(t),t.$watch("value",function(n){t.percent=+(100*n/e.max).toFixed(2)}),t.$on("$destroy",function(){n=null,i.removeBar(t)})},this.removeBar=function(e){this.bars.splice(this.bars.indexOf(e),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(e,t,n,i){i.addBar(e,t)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(e,t,n,i){i.addBar(e,angular.element(t.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(e,t,n){var i={$setViewValue:angular.noop};this.init=function(r){i=r,i.$render=this.render,this.stateOn=angular.isDefined(t.stateOn)?e.$parent.$eval(t.stateOn):n.stateOn,this.stateOff=angular.isDefined(t.stateOff)?e.$parent.$eval(t.stateOff):n.stateOff;var o=angular.isDefined(t.ratingStates)?e.$parent.$eval(t.ratingStates):new Array(angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max);e.range=this.buildTemplateObjects(o)},this.buildTemplateObjects=function(e){for(var t=0,n=e.length;n>t;t++)e[t]=angular.extend({index:t},{stateOn:this.stateOn,stateOff:this.stateOff},e[t]);return e},e.rate=function(t){!e.readonly&&t>=0&&t<=e.range.length&&(i.$setViewValue(t),i.$render())},e.enter=function(t){e.readonly||(e.value=t),e.onHover({value:t})},e.reset=function(){e.value=i.$viewValue,e.onLeave()},e.onKeydown=function(t){/(37|38|39|40)/.test(t.which)&&(t.preventDefault(),t.stopPropagation(),e.rate(e.value+(38===t.which||39===t.which?1:-1)))},this.render=function(){e.value=i.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(e,t,n,i){var r=i[0],o=i[1];o&&r.init(o)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(e){var t=this,n=t.tabs=e.tabs=[];t.select=function(e){angular.forEach(n,function(t){t.active&&t!==e&&(t.active=!1,t.onDeselect())}),e.active=!0,e.onSelect()},t.addTab=function(e){n.push(e),1===n.length?e.active=!0:e.active&&t.select(e)},t.removeTab=function(e){var i=n.indexOf(e);if(e.active&&n.length>1){var r=i==n.length-1?i-1:i+1;t.select(n[r])}n.splice(i,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(e,t,n){e.vertical=angular.isDefined(n.vertical)?e.$parent.$eval(n.vertical):!1,e.justified=angular.isDefined(n.justified)?e.$parent.$eval(n.justified):!1}}}).directive("tab",["$parse",function(e){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(t,n,i){return function(t,n,r,o){t.$watch("active",function(e){e&&o.select(t)}),t.disabled=!1,r.disabled&&t.$parent.$watch(e(r.disabled),function(e){t.disabled=!!e}),t.select=function(){t.disabled||(t.active=!0)},o.addTab(t),t.$on("$destroy",function(){o.removeTab(t)}),t.$transcludeFn=i}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(e,t){e.$watch("headingElement",function(e){e&&(t.html(""),t.append(e))})}}}]).directive("tabContentTransclude",function(){function e(e){return e.tagName&&(e.hasAttribute("tab-heading")||e.hasAttribute("data-tab-heading")||"tab-heading"===e.tagName.toLowerCase()||"data-tab-heading"===e.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(t,n,i){var r=t.$eval(i.tabContentTransclude);r.$transcludeFn(r.$parent,function(t){angular.forEach(t,function(t){e(t)?r.headingElement=t:n.append(t)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(e,t,n,i,r,o){function s(){var t=parseInt(e.hours,10),n=e.showMeridian?t>0&&13>t:t>=0&&24>t;return n?(e.showMeridian&&(12===t&&(t=0),e.meridian===g[1]&&(t+=12)),t):void 0}function a(){var t=parseInt(e.minutes,10);return t>=0&&60>t?t:void 0}function l(e){return angular.isDefined(e)&&e.toString().length<2?"0"+e:e}function c(e){u(),f.$setViewValue(new Date(p)),h(e)}function u(){f.$setValidity("time",!0),e.invalidHours=!1,e.invalidMinutes=!1}function h(t){var n=p.getHours(),i=p.getMinutes();e.showMeridian&&(n=0===n||12===n?12:n%12),e.hours="h"===t?n:l(n),e.minutes="m"===t?i:l(i),e.meridian=p.getHours()<12?g[0]:g[1]}function d(e){var t=new Date(p.getTime()+6e4*e);p.setHours(t.getHours(),t.getMinutes()),c()}var p=new Date,f={$setViewValue:angular.noop},g=angular.isDefined(t.meridians)?e.$parent.$eval(t.meridians):o.meridians||r.DATETIME_FORMATS.AMPMS;this.init=function(n,i){f=n,f.$render=this.render;var r=i.eq(0),s=i.eq(1),a=angular.isDefined(t.mousewheel)?e.$parent.$eval(t.mousewheel):o.mousewheel;a&&this.setupMousewheelEvents(r,s),e.readonlyInput=angular.isDefined(t.readonlyInput)?e.$parent.$eval(t.readonlyInput):o.readonlyInput,this.setupInputEvents(r,s)};var m=o.hourStep;t.hourStep&&e.$parent.$watch(n(t.hourStep),function(e){m=parseInt(e,10)});var v=o.minuteStep;t.minuteStep&&e.$parent.$watch(n(t.minuteStep),function(e){v=parseInt(e,10)}),e.showMeridian=o.showMeridian,t.showMeridian&&e.$parent.$watch(n(t.showMeridian),function(t){if(e.showMeridian=!!t,f.$error.time){var n=s(),i=a();angular.isDefined(n)&&angular.isDefined(i)&&(p.setHours(n),c())}else h()}),this.setupMousewheelEvents=function(t,n){var i=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||t>0};t.bind("mousewheel wheel",function(t){e.$apply(i(t)?e.incrementHours():e.decrementHours()),t.preventDefault()}),n.bind("mousewheel wheel",function(t){e.$apply(i(t)?e.incrementMinutes():e.decrementMinutes()),t.preventDefault()})},this.setupInputEvents=function(t,n){if(e.readonlyInput)return e.updateHours=angular.noop,void(e.updateMinutes=angular.noop);var i=function(t,n){f.$setViewValue(null),f.$setValidity("time",!1),angular.isDefined(t)&&(e.invalidHours=t),angular.isDefined(n)&&(e.invalidMinutes=n)};e.updateHours=function(){var e=s();angular.isDefined(e)?(p.setHours(e),c("h")):i(!0)},t.bind("blur",function(){!e.invalidHours&&e.hours<10&&e.$apply(function(){e.hours=l(e.hours)})}),e.updateMinutes=function(){var e=a();angular.isDefined(e)?(p.setMinutes(e),c("m")):i(void 0,!0)},n.bind("blur",function(){!e.invalidMinutes&&e.minutes<10&&e.$apply(function(){e.minutes=l(e.minutes)})})},this.render=function(){var e=f.$modelValue?new Date(f.$modelValue):null;isNaN(e)?(f.$setValidity("time",!1),i.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(e&&(p=e),u(),h())},e.incrementHours=function(){d(60*m)},e.decrementHours=function(){d(60*-m)},e.incrementMinutes=function(){d(v)},e.decrementMinutes=function(){d(-v)},e.toggleMeridian=function(){d(720*(p.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(e,t,n,i){var r=i[0],o=i[1];o&&r.init(o,t.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(n){var i=n.match(t);if(!i)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+n+'".');return{itemName:i[3],source:e(i[4]),viewMapper:e(i[2]||i[1]),modelMapper:e(i[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(e,t,n,i,r,o,s){var a=[9,13,27,38,40];return{require:"ngModel",link:function(l,c,u,h){var d,p=l.$eval(u.typeaheadMinLength)||1,f=l.$eval(u.typeaheadWaitMs)||0,g=l.$eval(u.typeaheadEditable)!==!1,m=t(u.typeaheadLoading).assign||angular.noop,v=t(u.typeaheadOnSelect),b=u.typeaheadInputFormatter?t(u.typeaheadInputFormatter):void 0,y=u.typeaheadAppendToBody?l.$eval(u.typeaheadAppendToBody):!1,w=t(u.ngModel).assign,_=s.parse(u.typeahead),x=l.$new();l.$on("$destroy",function(){x.$destroy()});var C="typeahead-"+x.$id+"-"+Math.floor(1e4*Math.random());c.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":C
});var $=angular.element("<div typeahead-popup></div>");$.attr({id:C,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(u.typeaheadTemplateUrl)&&$.attr("template-url",u.typeaheadTemplateUrl);var k=function(){x.matches=[],x.activeIdx=-1,c.attr("aria-expanded",!1)},S=function(e){return C+"-option-"+e};x.$watch("activeIdx",function(e){0>e?c.removeAttr("aria-activedescendant"):c.attr("aria-activedescendant",S(e))});var T=function(e){var t={$viewValue:e};m(l,!0),n.when(_.source(l,t)).then(function(n){var i=e===h.$viewValue;if(i&&d)if(n.length>0){x.activeIdx=0,x.matches.length=0;for(var r=0;r<n.length;r++)t[_.itemName]=n[r],x.matches.push({id:S(r),label:_.viewMapper(x,t),model:n[r]});x.query=e,x.position=y?o.offset(c):o.position(c),x.position.top=x.position.top+c.prop("offsetHeight"),c.attr("aria-expanded",!0)}else k();i&&m(l,!1)},function(){k(),m(l,!1)})};k(),x.query=void 0;var E,D=function(e){E=i(function(){T(e)},f)},A=function(){E&&i.cancel(E)};h.$parsers.unshift(function(e){return d=!0,e&&e.length>=p?f>0?(A(),D(e)):T(e):(m(l,!1),A(),k()),g?e:e?void h.$setValidity("editable",!1):(h.$setValidity("editable",!0),e)}),h.$formatters.push(function(e){var t,n,i={};return b?(i.$model=e,b(l,i)):(i[_.itemName]=e,t=_.viewMapper(l,i),i[_.itemName]=void 0,n=_.viewMapper(l,i),t!==n?t:e)}),x.select=function(e){var t,n,r={};r[_.itemName]=n=x.matches[e].model,t=_.modelMapper(l,r),w(l,t),h.$setValidity("editable",!0),v(l,{$item:n,$model:t,$label:_.viewMapper(l,r)}),k(),i(function(){c[0].focus()},0,!1)},c.bind("keydown",function(e){0!==x.matches.length&&-1!==a.indexOf(e.which)&&(e.preventDefault(),40===e.which?(x.activeIdx=(x.activeIdx+1)%x.matches.length,x.$digest()):38===e.which?(x.activeIdx=(x.activeIdx?x.activeIdx:x.matches.length)-1,x.$digest()):13===e.which||9===e.which?x.$apply(function(){x.select(x.activeIdx)}):27===e.which&&(e.stopPropagation(),k(),x.$digest()))}),c.bind("blur",function(){d=!1});var O=function(e){c[0]!==e.target&&(k(),x.$digest())};r.bind("click",O),l.$on("$destroy",function(){r.unbind("click",O)});var I=e($)(x);y?r.find("body").append(I):c.after(I)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(e,t,n){e.templateUrl=n.templateUrl,e.isOpen=function(){return e.matches.length>0},e.isActive=function(t){return e.active==t},e.selectActive=function(t){e.active=t},e.selectMatch=function(t){e.select({activeIdx:t})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(e,t,n,i){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(r,o,s){var a=i(s.templateUrl)(r.$parent)||"template/typeahead/typeahead-match.html";e.get(a,{cache:t}).success(function(e){o.replaceWith(n(e.trim())(r))})}}}]).filter("typeaheadHighlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,n){return n?(""+t).replace(new RegExp(e(n),"gi"),"<strong>$&</strong>"):t}}),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(e,t,n){function i(e){for(var t in e)if(void 0!==o.style[t])return e[t]}var r=function(i,o,s){s=s||{};var a=e.defer(),l=r[s.animation?"animationEndEventName":"transitionEndEventName"],c=function(){n.$apply(function(){i.unbind(l,c),a.resolve(i)})};return l&&i.bind(l,c),t(function(){angular.isString(o)?i.addClass(o):angular.isFunction(o)?o(i):angular.isObject(o)&&i.css(o),l||a.resolve(i)}),a.promise.cancel=function(){l&&i.unbind(l,c),a.reject("Transition cancelled")},a.promise},o=document.createElement("trans"),s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},a={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return r.transitionEndEventName=i(s),r.animationEndEventName=i(a),r}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(e){return{link:function(t,n,i){function r(t){function i(){c===r&&(c=void 0)}var r=e(n,t);return c&&c.cancel(),c=r,r.then(i,i),r}function o(){u?(u=!1,s()):(n.removeClass("collapse").addClass("collapsing"),r({height:n[0].scrollHeight+"px"}).then(s))}function s(){n.removeClass("collapsing"),n.addClass("collapse in"),n.css({height:"auto"})}function a(){u?(u=!1,l(),n.css({height:0})):(n.css({height:n[0].scrollHeight+"px"}),n[0].offsetWidth,n.removeClass("collapse in").addClass("collapsing"),r({height:0}).then(l))}function l(){n.removeClass("collapsing"),n.addClass("collapse")}var c,u=!0;t.$watch(i.collapse,function(e){e?a():o()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(e,t,n){this.groups=[],this.closeOthers=function(i){var r=angular.isDefined(t.closeOthers)?e.$eval(t.closeOthers):n.closeOthers;r&&angular.forEach(this.groups,function(e){e!==i&&(e.isOpen=!1)})},this.addGroup=function(e){var t=this;this.groups.push(e),e.$on("$destroy",function(){t.removeGroup(e)})},this.removeGroup=function(e){var t=this.groups.indexOf(e);-1!==t&&this.groups.splice(t,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(e){this.heading=e}},link:function(e,t,n,i){i.addGroup(e),e.$watch("isOpen",function(t){t&&i.closeOthers(e)}),e.toggleOpen=function(){e.isDisabled||(e.isOpen=!e.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(e,t,n,i,r){i.setHeading(r(e,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(e,t,n,i){e.$watch(function(){return i[n.accordionTransclude]},function(e){e&&(t.html(""),t.append(e))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(e,t){e.closeable="close"in t}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(e,t,n){t.addClass("ng-binding").data("$binding",n.bindHtmlUnsafe),e.$watch(n.bindHtmlUnsafe,function(e){t.html(e||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(e,t,n,i){var r=i[0],o=i[1];o.$render=function(){t.toggleClass(r.activeClass,angular.equals(o.$modelValue,e.$eval(n.btnRadio)))},t.bind(r.toggleEvent,function(){var i=t.hasClass(r.activeClass);(!i||angular.isDefined(n.uncheckable))&&e.$apply(function(){o.$setViewValue(i?null:e.$eval(n.btnRadio)),o.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(e,t,n,i){function r(){return s(n.btnCheckboxTrue,!0)}function o(){return s(n.btnCheckboxFalse,!1)}function s(t,n){var i=e.$eval(t);return angular.isDefined(i)?i:n}var a=i[0],l=i[1];l.$render=function(){t.toggleClass(a.activeClass,angular.equals(l.$modelValue,r()))},t.bind(a.toggleEvent,function(){e.$apply(function(){l.$setViewValue(t.hasClass(a.activeClass)?o():r()),l.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(e,t,n){function i(){r();var n=+e.interval;!isNaN(n)&&n>=0&&(s=t(o,n))}function r(){s&&(t.cancel(s),s=null)}function o(){a?(e.next(),i()):e.pause()}var s,a,l=this,c=l.slides=e.slides=[],u=-1;l.currentSlide=null;var h=!1;l.select=e.select=function(r,o){function s(){h||(l.currentSlide&&angular.isString(o)&&!e.noTransition&&r.$element?(r.$element.addClass(o),r.$element[0].offsetWidth,angular.forEach(c,function(e){angular.extend(e,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(r,{direction:o,active:!0,entering:!0}),angular.extend(l.currentSlide||{},{direction:o,leaving:!0}),e.$currentTransition=n(r.$element,{}),function(t,n){e.$currentTransition.then(function(){a(t,n)},function(){a(t,n)})}(r,l.currentSlide)):a(r,l.currentSlide),l.currentSlide=r,u=d,i())}function a(t,n){angular.extend(t,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(n||{},{direction:"",active:!1,leaving:!1,entering:!1}),e.$currentTransition=null}var d=c.indexOf(r);void 0===o&&(o=d>u?"next":"prev"),r&&r!==l.currentSlide&&(e.$currentTransition?(e.$currentTransition.cancel(),t(s)):s())},e.$on("$destroy",function(){h=!0}),l.indexOfSlide=function(e){return c.indexOf(e)},e.next=function(){var t=(u+1)%c.length;return e.$currentTransition?void 0:l.select(c[t],"next")},e.prev=function(){var t=0>u-1?c.length-1:u-1;return e.$currentTransition?void 0:l.select(c[t],"prev")},e.isActive=function(e){return l.currentSlide===e},e.$watch("interval",i),e.$on("$destroy",r),e.play=function(){a||(a=!0,i())},e.pause=function(){e.noPause||(a=!1,r())},l.addSlide=function(t,n){t.$element=n,c.push(t),1===c.length||t.active?(l.select(c[c.length-1]),1==c.length&&e.play()):t.active=!1},l.removeSlide=function(e){var t=c.indexOf(e);c.splice(t,1),c.length>0&&e.active?l.select(t>=c.length?c[t-1]:c[t]):u>t&&u--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(e,t,n,i){i.addSlide(e,t),e.$on("$destroy",function(){i.removeSlide(e)}),e.$watch("active",function(t){t&&i.select(e)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(e,t){function n(e){var n=[],i=e.split("");return angular.forEach(r,function(t,r){var o=e.indexOf(r);if(o>-1){e=e.split(""),i[o]="("+t.regex+")",e[o]="$";for(var s=o+1,a=o+r.length;a>s;s++)i[s]="",e[s]="$";e=e.join(""),n.push({index:o,apply:t.apply})}}),{regex:new RegExp("^"+i.join("")+"$"),map:t(n,"index")}}function i(e,t,n){return 1===t&&n>28?29===n&&(e%4===0&&e%100!==0||e%400===0):3===t||5===t||8===t||10===t?31>n:!0}this.parsers={};var r={yyyy:{regex:"\\d{4}",apply:function(e){this.year=+e}},yy:{regex:"\\d{2}",apply:function(e){this.year=+e+2e3}},y:{regex:"\\d{1,4}",apply:function(e){this.year=+e}},MMMM:{regex:e.DATETIME_FORMATS.MONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.MONTH.indexOf(t)}},MMM:{regex:e.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(t){this.month=e.DATETIME_FORMATS.SHORTMONTH.indexOf(t)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1}},M:{regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e}},EEEE:{regex:e.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:e.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(t,r){if(!angular.isString(t)||!r)return t;r=e.DATETIME_FORMATS[r]||r,this.parsers[r]||(this.parsers[r]=n(r));var o=this.parsers[r],s=o.regex,a=o.map,l=t.match(s);if(l&&l.length){for(var c,u={year:1900,month:0,date:1,hours:0},h=1,d=l.length;d>h;h++){var p=a[h-1];p.apply&&p.apply.call(u,l[h])}return i(u.year,u.month,u.date)&&(c=new Date(u.year,u.month,u.date,u.hours)),c}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(e,t){function n(e,n){return e.currentStyle?e.currentStyle[n]:t.getComputedStyle?t.getComputedStyle(e)[n]:e.style[n]}function i(e){return"static"===(n(e,"position")||"static")}var r=function(t){for(var n=e[0],r=t.offsetParent||n;r&&r!==n&&i(r);)r=r.offsetParent;return r||n};return{position:function(t){var n=this.offset(t),i={top:0,left:0},o=r(t[0]);o!=e[0]&&(i=this.offset(angular.element(o)),i.top+=o.clientTop-o.scrollTop,i.left+=o.clientLeft-o.scrollLeft);var s=t[0].getBoundingClientRect();return{width:s.width||t.prop("offsetWidth"),height:s.height||t.prop("offsetHeight"),top:n.top-i.top,left:n.left-i.left}},offset:function(n){var i=n[0].getBoundingClientRect();return{width:i.width||n.prop("offsetWidth"),height:i.height||n.prop("offsetHeight"),top:i.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:i.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}},positionElements:function(e,t,n,i){var r,o,s,a,l=n.split("-"),c=l[0],u=l[1]||"center";r=i?this.offset(e):this.position(e),o=t.prop("offsetWidth"),s=t.prop("offsetHeight");var h={center:function(){return r.left+r.width/2-o/2},left:function(){return r.left},right:function(){return r.left+r.width}},d={center:function(){return r.top+r.height/2-s/2},top:function(){return r.top},bottom:function(){return r.top+r.height}};switch(c){case"right":a={top:d[u](),left:h[c]()};break;case"left":a={top:d[u](),left:r.left-o};break;case"bottom":a={top:d[c](),left:h[u]()};break;default:a={top:r.top-s,left:h[u]()}}return a}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(e,t,n,i,r,o,s,a){var l=this,c={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(n,r){l[n]=angular.isDefined(t[n])?8>r?i(t[n])(e.$parent):e.$parent.$eval(t[n]):a[n]}),angular.forEach(["minDate","maxDate"],function(i){t[i]?e.$parent.$watch(n(t[i]),function(e){l[i]=e?new Date(e):null,l.refreshView()}):l[i]=a[i]?new Date(a[i]):null}),e.datepickerMode=e.datepickerMode||a.datepickerMode,e.uniqueId="datepicker-"+e.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(t.initDate)?e.$parent.$eval(t.initDate):new Date,e.isActive=function(t){return 0===l.compare(t.date,l.activeDate)?(e.activeDateId=t.uid,!0):!1},this.init=function(e){c=e,c.$render=function(){l.render()}},this.render=function(){if(c.$modelValue){var e=new Date(c.$modelValue),t=!isNaN(e);t?this.activeDate=e:o.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),c.$setValidity("date",t)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var e=c.$modelValue?new Date(c.$modelValue):null;c.$setValidity("date-disabled",!e||this.element&&!this.isDisabled(e))}},this.createDateObject=function(e,t){var n=c.$modelValue?new Date(c.$modelValue):null;return{date:e,label:s(e,t),selected:n&&0===this.compare(e,n),disabled:this.isDisabled(e),current:0===this.compare(e,new Date)}},this.isDisabled=function(n){return this.minDate&&this.compare(n,this.minDate)<0||this.maxDate&&this.compare(n,this.maxDate)>0||t.dateDisabled&&e.dateDisabled({date:n,mode:e.datepickerMode})},this.split=function(e,t){for(var n=[];e.length>0;)n.push(e.splice(0,t));return n},e.select=function(t){if(e.datepickerMode===l.minMode){var n=c.$modelValue?new Date(c.$modelValue):new Date(0,0,0,0,0,0,0);n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),c.$setViewValue(n),c.$render()}else l.activeDate=t,e.datepickerMode=l.modes[l.modes.indexOf(e.datepickerMode)-1]},e.move=function(e){var t=l.activeDate.getFullYear()+e*(l.step.years||0),n=l.activeDate.getMonth()+e*(l.step.months||0);l.activeDate.setFullYear(t,n,1),l.refreshView()},e.toggleMode=function(t){t=t||1,e.datepickerMode===l.maxMode&&1===t||e.datepickerMode===l.minMode&&-1===t||(e.datepickerMode=l.modes[l.modes.indexOf(e.datepickerMode)+t])},e.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var u=function(){r(function(){l.element[0].focus()},0,!1)};e.$on("datepicker.focus",u),e.keydown=function(t){var n=e.keys[t.which];if(n&&!t.shiftKey&&!t.altKey)if(t.preventDefault(),t.stopPropagation(),"enter"===n||"space"===n){if(l.isDisabled(l.activeDate))return;e.select(l.activeDate),u()}else!t.ctrlKey||"up"!==n&&"down"!==n?(l.handleKeyDown(n,t),l.refreshView()):(e.toggleMode("up"===n?1:-1),u())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(e,t,n,i){var r=i[0],o=i[1];o&&r.init(o)}}}).directive("daypicker",["dateFilter",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(t,n,i,r){function o(e,t){return 1!==t||e%4!==0||e%100===0&&e%400!==0?l[t]:29}function s(e,t){var n=new Array(t),i=new Date(e),r=0;for(i.setHours(12);t>r;)n[r++]=new Date(i),i.setDate(i.getDate()+1);return n}function a(e){var t=new Date(e);t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1}t.showWeeks=r.showWeeks,r.step={months:1},r.element=n;var l=[31,28,31,30,31,30,31,31,30,31,30,31];r._refreshView=function(){var n=r.activeDate.getFullYear(),i=r.activeDate.getMonth(),o=new Date(n,i,1),l=r.startingDay-o.getDay(),c=l>0?7-l:-l,u=new Date(o);c>0&&u.setDate(-c+1);for(var h=s(u,42),d=0;42>d;d++)h[d]=angular.extend(r.createDateObject(h[d],r.formatDay),{secondary:h[d].getMonth()!==i,uid:t.uniqueId+"-"+d});t.labels=new Array(7);for(var p=0;7>p;p++)t.labels[p]={abbr:e(h[p].date,r.formatDayHeader),full:e(h[p].date,"EEEE")};if(t.title=e(r.activeDate,r.formatDayTitle),t.rows=r.split(h,7),t.showWeeks){t.weekNumbers=[];for(var f=a(t.rows[0][0].date),g=t.rows.length;t.weekNumbers.push(f++)<g;);}},r.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},r.handleKeyDown=function(e){var t=r.activeDate.getDate();if("left"===e)t-=1;else if("up"===e)t-=7;else if("right"===e)t+=1;else if("down"===e)t+=7;else if("pageup"===e||"pagedown"===e){var n=r.activeDate.getMonth()+("pageup"===e?-1:1);r.activeDate.setMonth(n,1),t=Math.min(o(r.activeDate.getFullYear(),r.activeDate.getMonth()),t)}else"home"===e?t=1:"end"===e&&(t=o(r.activeDate.getFullYear(),r.activeDate.getMonth()));r.activeDate.setDate(t)},r.refreshView()}}}]).directive("monthpicker",["dateFilter",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(t,n,i,r){r.step={years:1},r.element=n,r._refreshView=function(){for(var n=new Array(12),i=r.activeDate.getFullYear(),o=0;12>o;o++)n[o]=angular.extend(r.createDateObject(new Date(i,o,1),r.formatMonth),{uid:t.uniqueId+"-"+o});t.title=e(r.activeDate,r.formatMonthTitle),t.rows=r.split(n,3)},r.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth())-new Date(t.getFullYear(),t.getMonth())},r.handleKeyDown=function(e){var t=r.activeDate.getMonth();if("left"===e)t-=1;else if("up"===e)t-=3;else if("right"===e)t+=1;else if("down"===e)t+=3;else if("pageup"===e||"pagedown"===e){var n=r.activeDate.getFullYear()+("pageup"===e?-1:1);r.activeDate.setFullYear(n)}else"home"===e?t=0:"end"===e&&(t=11);r.activeDate.setMonth(t)},r.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(e,t,n,i){function r(e){return parseInt((e-1)/o,10)*o+1}var o=i.yearRange;i.step={years:o},i.element=t,i._refreshView=function(){for(var t=new Array(o),n=0,s=r(i.activeDate.getFullYear());o>n;n++)t[n]=angular.extend(i.createDateObject(new Date(s+n,0,1),i.formatYear),{uid:e.uniqueId+"-"+n});e.title=[t[0].label,t[o-1].label].join(" - "),e.rows=i.split(t,5)},i.compare=function(e,t){return e.getFullYear()-t.getFullYear()},i.handleKeyDown=function(e){var t=i.activeDate.getFullYear();"left"===e?t-=1:"up"===e?t-=5:"right"===e?t+=1:"down"===e?t+=5:"pageup"===e||"pagedown"===e?t+=("pageup"===e?-1:1)*i.step.years:"home"===e?t=r(i.activeDate.getFullYear()):"end"===e&&(t=r(i.activeDate.getFullYear())+o-1),i.activeDate.setFullYear(t)},i.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(e,t,n,i,r,o,s){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(a,l,c,u){function h(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function d(e){if(e){if(angular.isDate(e)&&!isNaN(e))return u.$setValidity("date",!0),e;if(angular.isString(e)){var t=o.parse(e,p)||new Date(e);return isNaN(t)?void u.$setValidity("date",!1):(u.$setValidity("date",!0),t)}return void u.$setValidity("date",!1)}return u.$setValidity("date",!0),null}var p,f=angular.isDefined(c.closeOnDateSelection)?a.$parent.$eval(c.closeOnDateSelection):s.closeOnDateSelection,g=angular.isDefined(c.datepickerAppendToBody)?a.$parent.$eval(c.datepickerAppendToBody):s.appendToBody;a.showButtonBar=angular.isDefined(c.showButtonBar)?a.$parent.$eval(c.showButtonBar):s.showButtonBar,a.getText=function(e){return a[e+"Text"]||s[e+"Text"]},c.$observe("datepickerPopup",function(e){p=e||s.datepickerPopup,u.$render()});var m=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");m.attr({"ng-model":"date","ng-change":"dateSelection()"});var v=angular.element(m.children()[0]);c.datepickerOptions&&angular.forEach(a.$parent.$eval(c.datepickerOptions),function(e,t){v.attr(h(t),e)}),a.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(e){if(c[e]){var n=t(c[e]);if(a.$parent.$watch(n,function(t){a.watchData[e]=t}),v.attr(h(e),"watchData."+e),"datepickerMode"===e){var i=n.assign;a.$watch("watchData."+e,function(e,t){e!==t&&i(a.$parent,e)})}}}),c.dateDisabled&&v.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),u.$parsers.unshift(d),a.dateSelection=function(e){angular.isDefined(e)&&(a.date=e),u.$setViewValue(a.date),u.$render(),f&&(a.isOpen=!1,l[0].focus())},l.bind("input change keyup",function(){a.$apply(function(){a.date=u.$modelValue})}),u.$render=function(){var e=u.$viewValue?r(u.$viewValue,p):"";l.val(e),a.date=d(u.$modelValue)};var b=function(e){a.isOpen&&e.target!==l[0]&&a.$apply(function(){a.isOpen=!1})},y=function(e){a.keydown(e)};l.bind("keydown",y),a.keydown=function(e){27===e.which?(e.preventDefault(),e.stopPropagation(),a.close()):40!==e.which||a.isOpen||(a.isOpen=!0)},a.$watch("isOpen",function(e){e?(a.$broadcast("datepicker.focus"),a.position=g?i.offset(l):i.position(l),a.position.top=a.position.top+l.prop("offsetHeight"),n.bind("click",b)):n.unbind("click",b)}),a.select=function(e){if("today"===e){var t=new Date;angular.isDate(u.$modelValue)?(e=new Date(u.$modelValue),e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate())):e=new Date(t.setHours(0,0,0,0))}a.dateSelection(e)},a.close=function(){a.isOpen=!1,l[0].focus()};var w=e(m)(a);m.remove(),g?n.find("body").append(w):l.after(w),a.$on("$destroy",function(){w.remove(),l.unbind("keydown",y),n.unbind("click",b)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(e,t){t.bind("click",function(e){e.preventDefault(),e.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(e){var t=null;this.open=function(r){t||(e.bind("click",n),e.bind("keydown",i)),t&&t!==r&&(t.isOpen=!1),t=r},this.close=function(r){t===r&&(t=null,e.unbind("click",n),e.unbind("keydown",i))};var n=function(e){var n=t.getToggleElement();e&&n&&n[0].contains(e.target)||t.$apply(function(){t.isOpen=!1})},i=function(e){27===e.which&&(t.focusToggleElement(),n())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(e,t,n,i,r,o){var s,a=this,l=e.$new(),c=i.openClass,u=angular.noop,h=t.onToggle?n(t.onToggle):angular.noop;this.init=function(i){a.$element=i,t.isOpen&&(s=n(t.isOpen),u=s.assign,e.$watch(s,function(e){l.isOpen=!!e}))},this.toggle=function(e){return l.isOpen=arguments.length?!!e:!l.isOpen},this.isOpen=function(){return l.isOpen},l.getToggleElement=function(){return a.toggleElement},l.focusToggleElement=function(){a.toggleElement&&a.toggleElement[0].focus()},l.$watch("isOpen",function(t,n){o[t?"addClass":"removeClass"](a.$element,c),t?(l.focusToggleElement(),r.open(l)):r.close(l),u(e,t),angular.isDefined(t)&&t!==n&&h(e,{open:!!t})}),e.$on("$locationChangeSuccess",function(){l.isOpen=!1}),e.$on("$destroy",function(){l.$destroy()})}]).directive("dropdown",function(){return{restrict:"CA",controller:"DropdownController",link:function(e,t,n,i){i.init(t)}}}).directive("dropdownToggle",function(){return{restrict:"CA",require:"?^dropdown",link:function(e,t,n,i){if(i){i.toggleElement=t;var r=function(r){r.preventDefault(),t.hasClass("disabled")||n.disabled||e.$apply(function(){i.toggle()})};t.bind("click",r),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(i.isOpen,function(e){t.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){t.unbind("click",r)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t==e[n].key)return e[n]},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){for(var n=-1,i=0;i<e.length;i++)if(t==e[i].key){n=i;break}return e.splice(n,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("modalBackdrop",["$timeout",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(t,n,i){t.backdropClass=i.backdropClass||"",t.animate=!1,e(function(){t.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(e,t){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(e,t){return t.templateUrl||"template/modal/window.html"},link:function(n,i,r){i.addClass(r.windowClass||""),n.size=r.size,t(function(){n.animate=!0,i[0].querySelectorAll("[autofocus]").length||i[0].focus()}),n.close=function(t){var n=e.getTop();n&&n.value.backdrop&&"static"!=n.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(e,t,n,i,r){r(e.$parent,function(e){t.empty(),t.append(e)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(e,t,n,i,r,o){function s(){for(var e=-1,t=p.keys(),n=0;n<t.length;n++)p.get(t[n]).value.backdrop&&(e=n);return e}function a(e){var t=n.find("body").eq(0),i=p.get(e).value;p.remove(e),c(i.modalDomEl,i.modalScope,300,function(){i.modalScope.$destroy(),t.toggleClass(d,p.length()>0),l()})}function l(){if(u&&-1==s()){var e=h;c(u,h,150,function(){e.$destroy(),e=null}),u=void 0,h=void 0}}function c(n,i,r,o){function s(){s.done||(s.done=!0,n.remove(),o&&o())}i.animate=!1;var a=e.transitionEndEventName;if(a){var l=t(s,r);n.bind(a,function(){t.cancel(l),s(),i.$apply()})}else t(s)}var u,h,d="modal-open",p=o.createNew(),f={};return r.$watch(s,function(e){h&&(h.index=e)}),n.bind("keydown",function(e){var t;27===e.which&&(t=p.top(),t&&t.value.keyboard&&(e.preventDefault(),r.$apply(function(){f.dismiss(t.key,"escape key press")})))}),f.open=function(e,t){p.add(e,{deferred:t.deferred,modalScope:t.scope,backdrop:t.backdrop,keyboard:t.keyboard});var o=n.find("body").eq(0),a=s();if(a>=0&&!u){h=r.$new(!0),h.index=a;var l=angular.element("<div modal-backdrop></div>");l.attr("backdrop-class",t.backdropClass),u=i(l)(h),o.append(u)}var c=angular.element("<div modal-window></div>");c.attr({"template-url":t.windowTemplateUrl,"window-class":t.windowClass,size:t.size,index:p.length()-1,animate:"animate"}).html(t.content);var f=i(c)(t.scope);p.top().value.modalDomEl=f,o.append(f),o.addClass(d)},f.close=function(e,t){var n=p.get(e);n&&(n.value.deferred.resolve(t),a(e))},f.dismiss=function(e,t){var n=p.get(e);n&&(n.value.deferred.reject(t),a(e))},f.dismissAll=function(e){for(var t=this.getTop();t;)this.dismiss(t.key,e),t=this.getTop()},f.getTop=function(){return p.top()},f}]).provider("$modal",function(){var e={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(t,n,i,r,o,s,a){function l(e){return e.template?i.when(e.template):r.get(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl,{cache:o}).then(function(e){return e.data})}function c(e){var n=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&n.push(i.when(t.invoke(e)))}),n}var u={};return u.open=function(t){var r=i.defer(),o=i.defer(),u={result:r.promise,opened:o.promise,close:function(e){a.close(u,e)},dismiss:function(e){a.dismiss(u,e)}};if(t=angular.extend({},e.options,t),t.resolve=t.resolve||{},
!t.template&&!t.templateUrl)throw new Error("One of template or templateUrl options is required.");var h=i.all([l(t)].concat(c(t.resolve)));return h.then(function(e){var i=(t.scope||n).$new();i.$close=u.close,i.$dismiss=u.dismiss;var o,l={},c=1;t.controller&&(l.$scope=i,l.$modalInstance=u,angular.forEach(t.resolve,function(t,n){l[n]=e[c++]}),o=s(t.controller,l),t.controllerAs&&(i[t.controllerAs]=o)),a.open(u,{scope:i,deferred:r,content:e[0],backdrop:t.backdrop,keyboard:t.keyboard,backdropClass:t.backdropClass,windowClass:t.windowClass,windowTemplateUrl:t.windowTemplateUrl,size:t.size})},function(e){r.reject(e)}),h.then(function(){o.resolve(!0)},function(){o.reject(!1)}),u},u}]};return e}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(e,t,n){var i=this,r={$setViewValue:angular.noop},o=t.numPages?n(t.numPages).assign:angular.noop;this.init=function(o,s){r=o,this.config=s,r.$render=function(){i.render()},t.itemsPerPage?e.$parent.$watch(n(t.itemsPerPage),function(t){i.itemsPerPage=parseInt(t,10),e.totalPages=i.calculateTotalPages()}):this.itemsPerPage=s.itemsPerPage},this.calculateTotalPages=function(){var t=this.itemsPerPage<1?1:Math.ceil(e.totalItems/this.itemsPerPage);return Math.max(t||0,1)},this.render=function(){e.page=parseInt(r.$viewValue,10)||1},e.selectPage=function(t){e.page!==t&&t>0&&t<=e.totalPages&&(r.$setViewValue(t),r.$render())},e.getText=function(t){return e[t+"Text"]||i.config[t+"Text"]},e.noPrevious=function(){return 1===e.page},e.noNext=function(){return e.page===e.totalPages},e.$watch("totalItems",function(){e.totalPages=i.calculateTotalPages()}),e.$watch("totalPages",function(t){o(e.$parent,t),e.page>t?e.selectPage(t):r.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(e,t){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(n,i,r,o){function s(e,t,n){return{number:e,text:t,active:n}}function a(e,t){var n=[],i=1,r=t,o=angular.isDefined(u)&&t>u;o&&(h?(i=Math.max(e-Math.floor(u/2),1),r=i+u-1,r>t&&(r=t,i=r-u+1)):(i=(Math.ceil(e/u)-1)*u+1,r=Math.min(i+u-1,t)));for(var a=i;r>=a;a++){var l=s(a,a,a===e);n.push(l)}if(o&&!h){if(i>1){var c=s(i-1,"...",!1);n.unshift(c)}if(t>r){var d=s(r+1,"...",!1);n.push(d)}}return n}var l=o[0],c=o[1];if(c){var u=angular.isDefined(r.maxSize)?n.$parent.$eval(r.maxSize):t.maxSize,h=angular.isDefined(r.rotate)?n.$parent.$eval(r.rotate):t.rotate;n.boundaryLinks=angular.isDefined(r.boundaryLinks)?n.$parent.$eval(r.boundaryLinks):t.boundaryLinks,n.directionLinks=angular.isDefined(r.directionLinks)?n.$parent.$eval(r.directionLinks):t.directionLinks,l.init(c,t),r.maxSize&&n.$parent.$watch(e(r.maxSize),function(e){u=parseInt(e,10),l.render()});var d=l.render;l.render=function(){d(),n.page>0&&n.page<=n.totalPages&&(n.pages=a(n.page,n.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(e){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(t,n,i,r){var o=r[0],s=r[1];s&&(t.align=angular.isDefined(i.align)?t.$parent.$eval(i.align):e.align,o.init(s,e))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function e(e){var t=/[A-Z]/g,n="-";return e.replace(t,function(e,t){return(t?n:"")+e.toLowerCase()})}var t={placement:"top",animation:!0,popupDelay:0},n={mouseenter:"mouseleave",click:"click",focus:"blur"},i={};this.options=function(e){angular.extend(i,e)},this.setTriggers=function(e){angular.extend(n,e)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(r,o,s,a,l,c,u){return function(r,h,d){function p(e){var t=e||f.trigger||d,i=n[t]||t;return{show:t,hide:i}}var f=angular.extend({},t,i),g=e(r),m=u.startSymbol(),v=u.endSymbol(),b="<div "+g+'-popup title="'+m+"tt_title"+v+'" content="'+m+"tt_content"+v+'" placement="'+m+"tt_placement"+v+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var e=o(b);return function(t,n,i){function o(){t.tt_isOpen?d():u()}function u(){(!$||t.$eval(i[h+"Enable"]))&&(t.tt_popupDelay?_||(_=s(g,t.tt_popupDelay,!1),_.then(function(e){e()})):g()())}function d(){t.$apply(function(){m()})}function g(){return _=null,w&&(s.cancel(w),w=null),t.tt_content?(v(),y.css({top:0,left:0,display:"block"}),x?l.find("body").append(y):n.after(y),k(),t.tt_isOpen=!0,t.$digest(),k):angular.noop}function m(){t.tt_isOpen=!1,s.cancel(_),_=null,t.tt_animation?w||(w=s(b,500)):b()}function v(){y&&b(),y=e(t,function(){}),t.$digest()}function b(){w=null,y&&(y.remove(),y=null)}var y,w,_,x=angular.isDefined(f.appendToBody)?f.appendToBody:!1,C=p(void 0),$=angular.isDefined(i[h+"Enable"]),k=function(){var e=c.positionElements(n,y,t.tt_placement,x);e.top+="px",e.left+="px",y.css(e)};t.tt_isOpen=!1,i.$observe(r,function(e){t.tt_content=e,!e&&t.tt_isOpen&&m()}),i.$observe(h+"Title",function(e){t.tt_title=e}),i.$observe(h+"Placement",function(e){t.tt_placement=angular.isDefined(e)?e:f.placement}),i.$observe(h+"PopupDelay",function(e){var n=parseInt(e,10);t.tt_popupDelay=isNaN(n)?f.popupDelay:n});var S=function(){n.unbind(C.show,u),n.unbind(C.hide,d)};i.$observe(h+"Trigger",function(e){S(),C=p(e),C.show===C.hide?n.bind(C.show,o):(n.bind(C.show,u),n.bind(C.hide,d))});var T=t.$eval(i[h+"Animation"]);t.tt_animation=angular.isDefined(T)?!!T:f.animation,i.$observe(h+"AppendToBody",function(e){x=angular.isDefined(e)?a(e)(t):x}),x&&t.$on("$locationChangeSuccess",function(){t.tt_isOpen&&m()}),t.$on("$destroy",function(){s.cancel(w),s.cancel(_),S(),b()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(e){return e("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(e){return e("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(e){return e("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(e,t,n){var i=this,r=angular.isDefined(t.animate)?e.$parent.$eval(t.animate):n.animate;this.bars=[],e.max=angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max,this.addBar=function(t,n){r||n.css({transition:"none"}),this.bars.push(t),t.$watch("value",function(n){t.percent=+(100*n/e.max).toFixed(2)}),t.$on("$destroy",function(){n=null,i.removeBar(t)})},this.removeBar=function(e){this.bars.splice(this.bars.indexOf(e),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(e,t,n,i){i.addBar(e,t)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(e,t,n,i){i.addBar(e,angular.element(t.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(e,t,n){var i={$setViewValue:angular.noop};this.init=function(r){i=r,i.$render=this.render,this.stateOn=angular.isDefined(t.stateOn)?e.$parent.$eval(t.stateOn):n.stateOn,this.stateOff=angular.isDefined(t.stateOff)?e.$parent.$eval(t.stateOff):n.stateOff;var o=angular.isDefined(t.ratingStates)?e.$parent.$eval(t.ratingStates):new Array(angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max);e.range=this.buildTemplateObjects(o)},this.buildTemplateObjects=function(e){for(var t=0,n=e.length;n>t;t++)e[t]=angular.extend({index:t},{stateOn:this.stateOn,stateOff:this.stateOff},e[t]);return e},e.rate=function(t){!e.readonly&&t>=0&&t<=e.range.length&&(i.$setViewValue(t),i.$render())},e.enter=function(t){e.readonly||(e.value=t),e.onHover({value:t})},e.reset=function(){e.value=i.$viewValue,e.onLeave()},e.onKeydown=function(t){/(37|38|39|40)/.test(t.which)&&(t.preventDefault(),t.stopPropagation(),e.rate(e.value+(38===t.which||39===t.which?1:-1)))},this.render=function(){e.value=i.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(e,t,n,i){var r=i[0],o=i[1];o&&r.init(o)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(e){var t=this,n=t.tabs=e.tabs=[];t.select=function(e){angular.forEach(n,function(t){t.active&&t!==e&&(t.active=!1,t.onDeselect())}),e.active=!0,e.onSelect()},t.addTab=function(e){n.push(e),1===n.length?e.active=!0:e.active&&t.select(e)},t.removeTab=function(e){var i=n.indexOf(e);if(e.active&&n.length>1){var r=i==n.length-1?i-1:i+1;t.select(n[r])}n.splice(i,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(e,t,n){e.vertical=angular.isDefined(n.vertical)?e.$parent.$eval(n.vertical):!1,e.justified=angular.isDefined(n.justified)?e.$parent.$eval(n.justified):!1}}}).directive("tab",["$parse",function(e){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(t,n,i){return function(t,n,r,o){t.$watch("active",function(e){e&&o.select(t)}),t.disabled=!1,r.disabled&&t.$parent.$watch(e(r.disabled),function(e){t.disabled=!!e}),t.select=function(){t.disabled||(t.active=!0)},o.addTab(t),t.$on("$destroy",function(){o.removeTab(t)}),t.$transcludeFn=i}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(e,t){e.$watch("headingElement",function(e){e&&(t.html(""),t.append(e))})}}}]).directive("tabContentTransclude",function(){function e(e){return e.tagName&&(e.hasAttribute("tab-heading")||e.hasAttribute("data-tab-heading")||"tab-heading"===e.tagName.toLowerCase()||"data-tab-heading"===e.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(t,n,i){var r=t.$eval(i.tabContentTransclude);r.$transcludeFn(r.$parent,function(t){angular.forEach(t,function(t){e(t)?r.headingElement=t:n.append(t)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(e,t,n,i,r,o){function s(){var t=parseInt(e.hours,10),n=e.showMeridian?t>0&&13>t:t>=0&&24>t;return n?(e.showMeridian&&(12===t&&(t=0),e.meridian===g[1]&&(t+=12)),t):void 0}function a(){var t=parseInt(e.minutes,10);return t>=0&&60>t?t:void 0}function l(e){return angular.isDefined(e)&&e.toString().length<2?"0"+e:e}function c(e){u(),f.$setViewValue(new Date(p)),h(e)}function u(){f.$setValidity("time",!0),e.invalidHours=!1,e.invalidMinutes=!1}function h(t){var n=p.getHours(),i=p.getMinutes();e.showMeridian&&(n=0===n||12===n?12:n%12),e.hours="h"===t?n:l(n),e.minutes="m"===t?i:l(i),e.meridian=p.getHours()<12?g[0]:g[1]}function d(e){var t=new Date(p.getTime()+6e4*e);p.setHours(t.getHours(),t.getMinutes()),c()}var p=new Date,f={$setViewValue:angular.noop},g=angular.isDefined(t.meridians)?e.$parent.$eval(t.meridians):o.meridians||r.DATETIME_FORMATS.AMPMS;this.init=function(n,i){f=n,f.$render=this.render;var r=i.eq(0),s=i.eq(1),a=angular.isDefined(t.mousewheel)?e.$parent.$eval(t.mousewheel):o.mousewheel;a&&this.setupMousewheelEvents(r,s),e.readonlyInput=angular.isDefined(t.readonlyInput)?e.$parent.$eval(t.readonlyInput):o.readonlyInput,this.setupInputEvents(r,s)};var m=o.hourStep;t.hourStep&&e.$parent.$watch(n(t.hourStep),function(e){m=parseInt(e,10)});var v=o.minuteStep;t.minuteStep&&e.$parent.$watch(n(t.minuteStep),function(e){v=parseInt(e,10)}),e.showMeridian=o.showMeridian,t.showMeridian&&e.$parent.$watch(n(t.showMeridian),function(t){if(e.showMeridian=!!t,f.$error.time){var n=s(),i=a();angular.isDefined(n)&&angular.isDefined(i)&&(p.setHours(n),c())}else h()}),this.setupMousewheelEvents=function(t,n){var i=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||t>0};t.bind("mousewheel wheel",function(t){e.$apply(i(t)?e.incrementHours():e.decrementHours()),t.preventDefault()}),n.bind("mousewheel wheel",function(t){e.$apply(i(t)?e.incrementMinutes():e.decrementMinutes()),t.preventDefault()})},this.setupInputEvents=function(t,n){if(e.readonlyInput)return e.updateHours=angular.noop,void(e.updateMinutes=angular.noop);var i=function(t,n){f.$setViewValue(null),f.$setValidity("time",!1),angular.isDefined(t)&&(e.invalidHours=t),angular.isDefined(n)&&(e.invalidMinutes=n)};e.updateHours=function(){var e=s();angular.isDefined(e)?(p.setHours(e),c("h")):i(!0)},t.bind("blur",function(){!e.invalidHours&&e.hours<10&&e.$apply(function(){e.hours=l(e.hours)})}),e.updateMinutes=function(){var e=a();angular.isDefined(e)?(p.setMinutes(e),c("m")):i(void 0,!0)},n.bind("blur",function(){!e.invalidMinutes&&e.minutes<10&&e.$apply(function(){e.minutes=l(e.minutes)})})},this.render=function(){var e=f.$modelValue?new Date(f.$modelValue):null;isNaN(e)?(f.$setValidity("time",!1),i.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(e&&(p=e),u(),h())},e.incrementHours=function(){d(60*m)},e.decrementHours=function(){d(60*-m)},e.incrementMinutes=function(){d(v)},e.decrementMinutes=function(){d(-v)},e.toggleMeridian=function(){d(720*(p.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(e,t,n,i){var r=i[0],o=i[1];o&&r.init(o,t.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(n){var i=n.match(t);if(!i)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+n+'".');return{itemName:i[3],source:e(i[4]),viewMapper:e(i[2]||i[1]),modelMapper:e(i[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(e,t,n,i,r,o,s){var a=[9,13,27,38,40];return{require:"ngModel",link:function(l,c,u,h){var d,p=l.$eval(u.typeaheadMinLength)||1,f=l.$eval(u.typeaheadWaitMs)||0,g=l.$eval(u.typeaheadEditable)!==!1,m=t(u.typeaheadLoading).assign||angular.noop,v=t(u.typeaheadOnSelect),b=u.typeaheadInputFormatter?t(u.typeaheadInputFormatter):void 0,y=u.typeaheadAppendToBody?l.$eval(u.typeaheadAppendToBody):!1,w=t(u.ngModel).assign,_=s.parse(u.typeahead),x=l.$new();l.$on("$destroy",function(){x.$destroy()});var C="typeahead-"+x.$id+"-"+Math.floor(1e4*Math.random());c.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":C});var $=angular.element("<div typeahead-popup></div>");$.attr({id:C,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(u.typeaheadTemplateUrl)&&$.attr("template-url",u.typeaheadTemplateUrl);var k=function(){x.matches=[],x.activeIdx=-1,c.attr("aria-expanded",!1)},S=function(e){return C+"-option-"+e};x.$watch("activeIdx",function(e){0>e?c.removeAttr("aria-activedescendant"):c.attr("aria-activedescendant",S(e))});var T=function(e){var t={$viewValue:e};m(l,!0),n.when(_.source(l,t)).then(function(n){var i=e===h.$viewValue;if(i&&d)if(n.length>0){x.activeIdx=0,x.matches.length=0;for(var r=0;r<n.length;r++)t[_.itemName]=n[r],x.matches.push({id:S(r),label:_.viewMapper(x,t),model:n[r]});x.query=e,x.position=y?o.offset(c):o.position(c),x.position.top=x.position.top+c.prop("offsetHeight"),c.attr("aria-expanded",!0)}else k();i&&m(l,!1)},function(){k(),m(l,!1)})};k(),x.query=void 0;var E,D=function(e){E=i(function(){T(e)},f)},A=function(){E&&i.cancel(E)};h.$parsers.unshift(function(e){return d=!0,e&&e.length>=p?f>0?(A(),D(e)):T(e):(m(l,!1),A(),k()),g?e:e?void h.$setValidity("editable",!1):(h.$setValidity("editable",!0),e)}),h.$formatters.push(function(e){var t,n,i={};return b?(i.$model=e,b(l,i)):(i[_.itemName]=e,t=_.viewMapper(l,i),i[_.itemName]=void 0,n=_.viewMapper(l,i),t!==n?t:e)}),x.select=function(e){var t,n,r={};r[_.itemName]=n=x.matches[e].model,t=_.modelMapper(l,r),w(l,t),h.$setValidity("editable",!0),v(l,{$item:n,$model:t,$label:_.viewMapper(l,r)}),k(),i(function(){c[0].focus()},0,!1)},c.bind("keydown",function(e){0!==x.matches.length&&-1!==a.indexOf(e.which)&&(e.preventDefault(),40===e.which?(x.activeIdx=(x.activeIdx+1)%x.matches.length,x.$digest()):38===e.which?(x.activeIdx=(x.activeIdx?x.activeIdx:x.matches.length)-1,x.$digest()):13===e.which||9===e.which?x.$apply(function(){x.select(x.activeIdx)}):27===e.which&&(e.stopPropagation(),k(),x.$digest()))}),c.bind("blur",function(){d=!1});var O=function(e){c[0]!==e.target&&(k(),x.$digest())};r.bind("click",O),l.$on("$destroy",function(){r.unbind("click",O)});var I=e($)(x);y?r.find("body").append(I):c.after(I)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(e,t,n){e.templateUrl=n.templateUrl,e.isOpen=function(){return e.matches.length>0},e.isActive=function(t){return e.active==t},e.selectActive=function(t){e.active=t},e.selectMatch=function(t){e.select({activeIdx:t})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(e,t,n,i){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(r,o,s){var a=i(s.templateUrl)(r.$parent)||"template/typeahead/typeahead-match.html";e.get(a,{cache:t}).success(function(e){o.replaceWith(n(e.trim())(r))})}}}]).filter("typeaheadHighlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,n){return n?(""+t).replace(new RegExp(e(n),"gi"),"<strong>$&</strong>"):t}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function(e){e.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function(e){e.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function(e){e.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(e){e.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(e){e.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(e){e.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(e){e.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(e){e.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(e){e.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(e){e.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function(e){e.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function(e){e.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function(e){e.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function(e){e.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>');
}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function(e){e.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(e){e.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(e){e.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(e){e.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(e){e.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(e){e.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(e,t,n){"use strict";function i(e,t){return R(new(R(function(){},{prototype:e})),t)}function r(e){return P(arguments,function(t){t!==e&&P(t,function(t,n){e.hasOwnProperty(n)||(e[n]=t)})}),e}function o(e,t){var n=[];for(var i in e.path){if(e.path[i]!==t.path[i])break;n.push(e.path[i])}return n}function s(e){if(Object.keys)return Object.keys(e);var n=[];return t.forEach(e,function(e,t){n.push(t)}),n}function a(e,t){if(Array.prototype.indexOf)return e.indexOf(t,Number(arguments[2])||0);var n=e.length>>>0,i=Number(arguments[2])||0;for(i=0>i?Math.ceil(i):Math.floor(i),0>i&&(i+=n);n>i;i++)if(i in e&&e[i]===t)return i;return-1}function l(e,t,n,i){var r,l=o(n,i),c={},u=[];for(var h in l)if(l[h].params&&(r=s(l[h].params),r.length))for(var d in r)a(u,r[d])>=0||(u.push(r[d]),c[r[d]]=e[r[d]]);return R({},c,t)}function c(e,t,n){if(!n){n=[];for(var i in e)n.push(i)}for(var r=0;r<n.length;r++){var o=n[r];if(e[o]!=t[o])return!1}return!0}function u(e,t){var n={};return P(e,function(e){n[e]=t[e]}),n}function h(e,t){var i=1,o=2,s={},a=[],l=s,c=R(e.when(s),{$$promises:s,$$values:s});this.study=function(s){function u(e,n){if(f[n]!==o){if(p.push(n),f[n]===i)throw p.splice(0,p.indexOf(n)),new Error("Cyclic dependency: "+p.join(" -> "));if(f[n]=i,O(e))d.push(n,[function(){return t.get(e)}],a);else{var r=t.annotate(e);P(r,function(e){e!==n&&s.hasOwnProperty(e)&&u(s[e],e)}),d.push(n,e,r)}p.pop(),f[n]=o}}function h(e){return I(e)&&e.then&&e.$$promises}if(!I(s))throw new Error("'invocables' must be an object");var d=[],p=[],f={};return P(s,u),s=p=f=null,function(i,o,s){function a(){--b||(y||r(v,o.$$values),g.$$values=v,g.$$promises=!0,delete g.$$inheritedValues,f.resolve(v))}function u(e){g.$$failure=e,f.reject(e)}function p(n,r,o){function l(e){h.reject(e),u(e)}function c(){if(!D(g.$$failure))try{h.resolve(t.invoke(r,s,v)),h.promise.then(function(e){v[n]=e,a()},l)}catch(e){l(e)}}var h=e.defer(),d=0;P(o,function(e){m.hasOwnProperty(e)&&!i.hasOwnProperty(e)&&(d++,m[e].then(function(t){v[e]=t,--d||c()},l))}),d||c(),m[n]=h.promise}if(h(i)&&s===n&&(s=o,o=i,i=null),i){if(!I(i))throw new Error("'locals' must be an object")}else i=l;if(o){if(!h(o))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else o=c;var f=e.defer(),g=f.promise,m=g.$$promises={},v=R({},i),b=1+d.length/3,y=!1;if(D(o.$$failure))return u(o.$$failure),g;o.$$inheritedValues&&r(v,o.$$inheritedValues),o.$$values?(y=r(v,o.$$values),g.$$inheritedValues=o.$$values,a()):(o.$$inheritedValues&&(g.$$inheritedValues=o.$$inheritedValues),R(m,o.$$promises),o.then(a,u));for(var w=0,_=d.length;_>w;w+=3)i.hasOwnProperty(d[w])?a():p(d[w],d[w+1],d[w+2]);return g}},this.resolve=function(e,t,n,i){return this.study(e)(t,n,i)}}function d(e,t,n){this.fromConfig=function(e,t,n){return D(e.template)?this.fromString(e.template,t):D(e.templateUrl)?this.fromUrl(e.templateUrl,t):D(e.templateProvider)?this.fromProvider(e.templateProvider,t,n):null},this.fromString=function(e,t){return A(e)?e(t):e},this.fromUrl=function(n,i){return A(n)&&(n=n(i)),null==n?null:e.get(n,{cache:t}).then(function(e){return e.data})},this.fromProvider=function(e,t,i){return n.invoke(e,null,i||{params:t})}}function p(e,i){function r(e){return D(e)?this.type.decode(e):g.$$getDefaultValue(this)}function o(t,n,i){if(!/^\w+(-+\w+)*$/.test(t))throw new Error("Invalid parameter name '"+t+"' in pattern '"+e+"'");if(p[t])throw new Error("Duplicate parameter name '"+t+"' in pattern '"+e+"'");p[t]=R({type:n||new f,$value:r},i)}function s(e,t,n){var i=e.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!t)return i;var r=n?"?":"";return i+r+"("+t+")"+r}function a(e){if(!i.params||!i.params[e])return{};var t=i.params[e];return I(t)?t:{value:t}}i=t.isObject(i)?i:{};var l,c=/([:*])(\w+)|\{(\w+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,u="^",h=0,d=this.segments=[],p=this.params={};this.source=e;for(var m,v,b,y,w;(l=c.exec(e))&&(m=l[2]||l[3],v=l[4]||("*"==l[1]?".*":"[^/]*"),b=e.substring(h,l.index),y=this.$types[v]||new f({pattern:new RegExp(v)}),w=a(m),!(b.indexOf("?")>=0));)u+=s(b,y.$subPattern(),D(w.value)),o(m,y,w),d.push(b),h=c.lastIndex;b=e.substring(h);var _=b.indexOf("?");if(_>=0){var x=this.sourceSearch=b.substring(_);b=b.substring(0,_),this.sourcePath=e.substring(0,h+_),P(x.substring(1).split(/[&?]/),function(e){o(e,null,a(e))})}else this.sourcePath=e,this.sourceSearch="";u+=s(b)+(i.strict===!1?"/?":"")+"$",d.push(b),this.regexp=new RegExp(u,i.caseInsensitive?"i":n),this.prefix=d[0]}function f(e){R(this,e)}function g(){function e(){return{strict:o,caseInsensitive:r}}function t(e){return A(e)||M(e)&&A(e[e.length-1])}function n(){P(a,function(e){if(p.prototype.$types[e.name])throw new Error("A type named '"+e.name+"' has already been defined.");var n=new f(t(e.def)?i.invoke(e.def):e.def);p.prototype.$types[e.name]=n})}var i,r=!1,o=!0,s=!0,a=[],l={"int":{decode:function(e){return parseInt(e,10)},is:function(e){return D(e)?this.decode(e.toString())===e:!1},pattern:/\d+/},bool:{encode:function(e){return e?1:0},decode:function(e){return 0===parseInt(e,10)?!1:!0},is:function(e){return e===!0||e===!1},pattern:/0|1/},string:{pattern:/[^\/]*/},date:{equals:function(e,t){return e.toISOString()===t.toISOString()},decode:function(e){return new Date(e)},encode:function(e){return[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-")},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/}};g.$$getDefaultValue=function(e){if(!t(e.value))return e.value;if(!i)throw new Error("Injectable functions cannot be called at configuration time");return i.invoke(e.value)},this.caseInsensitive=function(e){r=e},this.strictMode=function(e){o=e},this.compile=function(t,n){return new p(t,R(e(),n))},this.isMatcher=function(e){if(!I(e))return!1;var t=!0;return P(p.prototype,function(n,i){A(n)&&(t=t&&D(e[i])&&A(e[i]))}),t},this.type=function(e,t){return D(t)?(a.push({name:e,def:t}),s||n(),this):p.prototype.$types[e]},this.$get=["$injector",function(e){return i=e,s=!1,p.prototype.$types={},n(),P(l,function(e,t){p.prototype.$types[t]||(p.prototype.$types[t]=new f(e))}),this}]}function m(e,t){function i(e){var t=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(e.source);return null!=t?t[1].replace(/\\(.)/g,"$1"):""}function r(e,t){return e.replace(/\$(\$|\d{1,2})/,function(e,n){return t["$"===n?0:Number(n)]})}function o(e,t,n){if(!n)return!1;var i=e.invoke(t,t,{$match:n});return D(i)?i:!0}function s(t,n,i,r){function o(e,t,n){return"/"===d?e:t?d.slice(0,-1)+e:n?d.slice(1)+e:e}function s(e){function n(e){var n=e(i,t);return n?(O(n)&&t.replace().url(n),!0):!1}if(!e||!e.defaultPrevented){var r,o=l.length;for(r=0;o>r;r++)if(n(l[r]))return;c&&n(c)}}function h(){return a=a||n.$on("$locationChangeSuccess",s)}var d=r.baseHref(),p=t.url();return u||h(),{sync:function(){s()},listen:function(){return h()},update:function(e){return e?void(p=t.url()):void(t.url()!==p&&(t.url(p),t.replace()))},push:function(e,n,i){t.url(e.format(n||{})),i&&i.replace&&t.replace()},href:function(n,i,r){if(!n.validates(i))return null;var s=e.html5Mode(),a=n.format(i);if(r=r||{},s||null===a||(a="#"+e.hashPrefix()+a),a=o(a,s,r.absolute),!r.absolute||!a)return a;var l=!s&&a?"/":"",c=t.port();return c=80===c||443===c?"":":"+c,[t.protocol(),"://",t.host(),c,l,a].join("")}}}var a,l=[],c=null,u=!1;this.rule=function(e){if(!A(e))throw new Error("'rule' must be a function");return l.push(e),this},this.otherwise=function(e){if(O(e)){var t=e;e=function(){return t}}else if(!A(e))throw new Error("'rule' must be a function");return c=e,this},this.when=function(e,n){var s,a=O(n);if(O(e)&&(e=t.compile(e)),!a&&!A(n)&&!M(n))throw new Error("invalid 'handler' in when()");var l={matcher:function(e,n){return a&&(s=t.compile(n),n=["$match",function(e){return s.format(e)}]),R(function(t,i){return o(t,n,e.exec(i.path(),i.search()))},{prefix:O(e.prefix)?e.prefix:""})},regex:function(e,t){if(e.global||e.sticky)throw new Error("when() RegExp must not be global or sticky");return a&&(s=t,t=["$match",function(e){return r(s,e)}]),R(function(n,i){return o(n,t,e.exec(i.path()))},{prefix:i(e)})}},c={matcher:t.isMatcher(e),regex:e instanceof RegExp};for(var u in c)if(c[u])return this.rule(l[u](e,n));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(e){e===n&&(e=!0),u=e},this.$get=s,s.$inject=["$location","$rootScope","$injector","$browser"]}function v(e,r){function o(e){return 0===e.indexOf(".")||0===e.indexOf("^")}function a(e,t){if(!e)return n;var i=O(e),r=i?e:e.name,s=o(r);if(s){if(!t)throw new Error("No reference point given for path '"+r+"'");for(var a=r.split("."),l=0,c=a.length,u=t;c>l;l++)if(""!==a[l]||0!==l){if("^"!==a[l])break;if(!u.parent)throw new Error("Path '"+r+"' not valid for state '"+t.name+"'");u=u.parent}else u=t;a=a.slice(l).join("."),r=u.name+(u.name&&a?".":"")+a}var h=_[r];return!h||!i&&(i||h!==e&&h.self!==e)?n:h}function h(e,t){x[e]||(x[e]=[]),x[e].push(t)}function d(t){t=i(t,{self:t,resolve:t.resolve||{},toString:function(){return this.name}});var n=t.name;if(!O(n)||n.indexOf("@")>=0)throw new Error("State must have a valid name");if(_.hasOwnProperty(n))throw new Error("State '"+n+"'' is already defined");var r=-1!==n.indexOf(".")?n.substring(0,n.lastIndexOf(".")):O(t.parent)?t.parent:"";if(r&&!_[r])return h(r,t.self);for(var o in $)A($[o])&&(t[o]=$[o](t,$.$delegates[o]));if(_[n]=t,!t[C]&&t.url&&e.when(t.url,["$match","$stateParams",function(e,n){w.$current.navigable==t&&c(e,n)||w.transitionTo(t,e,{location:!1})}]),x[n])for(var s=0;s<x[n].length;s++)d(x[n][s]);return t}function p(e){return e.indexOf("*")>-1}function f(e){var t=e.split("."),n=w.$current.name.split(".");if("**"===t[0]&&(n=n.slice(n.indexOf(t[1])),n.unshift("**")),"**"===t[t.length-1]&&(n.splice(n.indexOf(t[t.length-2])+1,Number.MAX_VALUE),n.push("**")),t.length!=n.length)return!1;for(var i=0,r=t.length;r>i;i++)"*"===t[i]&&(n[i]="*");return n.join("")===t.join("")}function g(e,t){return O(e)&&!D(t)?$[e]:A(t)&&O(e)?($[e]&&!$.$delegates[e]&&($.$delegates[e]=$[e]),$[e]=t,this):this}function m(e,t){return I(e)?t=e:t.name=e,d(t),this}function v(e,r,o,h,d,g,m){function v(t,n,i,o){var s=e.$broadcast("$stateNotFound",t,n,i);if(s.defaultPrevented)return m.update(),S;if(!s.retry)return null;if(o.$retry)return m.update(),T;var a=w.transition=r.when(s.retry);return a.then(function(){return a!==w.transition?$:(t.options.$retry=!0,w.transitionTo(t.to,t.toParams,t.options))},function(){return S}),m.update(),a}function x(e,n,i,a,l){var c=i?n:u(s(e.params),n),p={$stateParams:c};l.resolve=d.resolve(e.resolve,p,l.resolve,e);var f=[l.resolve.then(function(e){l.globals=e})];return a&&f.push(a),P(e.views,function(n,i){var r=n.resolve&&n.resolve!==e.resolve?n.resolve:{};r.$template=[function(){return o.load(i,{view:n,locals:p,params:c})||""}],f.push(d.resolve(r,p,l.resolve,e).then(function(o){if(A(n.controllerProvider)||M(n.controllerProvider)){var s=t.extend({},r,p);o.$$controller=h.invoke(n.controllerProvider,null,s)}else o.$$controller=n.controller;o.$$state=e,o.$$controllerAs=n.controllerAs,l[i]=o}))}),r.all(f).then(function(){return l})}var $=r.reject(new Error("transition superseded")),k=r.reject(new Error("transition prevented")),S=r.reject(new Error("transition aborted")),T=r.reject(new Error("transition failed"));return y.locals={resolve:null,globals:{$stateParams:{}}},w={params:{},current:y.self,$current:y,transition:null},w.reload=function(){w.transitionTo(w.current,g,{reload:!0,inherit:!1,notify:!1})},w.go=function(e,t,n){return w.transitionTo(e,t,R({inherit:!0,relative:w.$current},n))},w.transitionTo=function(t,n,o){n=n||{},o=R({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},o||{});var d,p=w.$current,f=w.params,_=p.path,S=a(t,o.relative);if(!D(S)){var T={to:t,toParams:n,options:o},E=v(T,p.self,f,o);if(E)return E;if(t=T.to,n=T.toParams,o=T.options,S=a(t,o.relative),!D(S)){if(!o.relative)throw new Error("No such state '"+t+"'");throw new Error("Could not resolve '"+t+"' from state '"+o.relative+"'")}}if(S[C])throw new Error("Cannot transition to abstract state '"+t+"'");o.inherit&&(n=l(g,n||{},w.$current,S)),t=S;var A=t.path,O=0,I=A[O],M=y.locals,P=[];if(!o.reload)for(;I&&I===_[O]&&c(n,f,I.ownParams);)M=P[O]=I.locals,O++,I=A[O];if(b(t,p,M,o))return t.self.reloadOnSearch!==!1&&m.update(),w.transition=null,r.when(w.current);if(n=u(s(t.params),n||{}),o.notify&&e.$broadcast("$stateChangeStart",t.self,n,p.self,f).defaultPrevented)return m.update(),k;for(var F=r.when(M),L=O;L<A.length;L++,I=A[L])M=P[L]=i(M),F=x(I,n,I===t,F,M);var j=w.transition=F.then(function(){var i,r,s;if(w.transition!==j)return $;for(i=_.length-1;i>=O;i--)s=_[i],s.self.onExit&&h.invoke(s.self.onExit,s.self,s.locals.globals),s.locals=null;for(i=O;i<A.length;i++)r=A[i],r.locals=P[i],r.self.onEnter&&h.invoke(r.self.onEnter,r.self,r.locals.globals);return w.transition!==j?$:(w.$current=t,w.current=t.self,w.params=n,N(w.params,g),w.transition=null,o.location&&t.navigable&&m.push(t.navigable.url,t.navigable.locals.globals.$stateParams,{replace:"replace"===o.location}),o.notify&&e.$broadcast("$stateChangeSuccess",t.self,n,p.self,f),m.update(!0),w.current)},function(i){return w.transition!==j?$:(w.transition=null,d=e.$broadcast("$stateChangeError",t.self,n,p.self,f,i),d.defaultPrevented||m.update(),r.reject(i))});return j},w.is=function(e,i){var r=a(e);return D(r)?w.$current!==r?!1:D(i)&&null!==i?t.equals(g,i):!0:n},w.includes=function(e,t){if(O(e)&&p(e)){if(!f(e))return!1;e=w.$current.name}var i=a(e);return D(i)?D(w.$current.includes[i.name])?c(t,g):!1:n},w.href=function(e,t,n){n=R({lossy:!0,inherit:!0,absolute:!1,relative:w.$current},n||{});var i=a(e,n.relative);if(!D(i))return null;n.inherit&&(t=l(g,t||{},w.$current,i));var r=i&&n.lossy?i.navigable:i;return r&&r.url?m.href(r.url,u(s(i.params),t||{}),{absolute:n.absolute}):null},w.get=function(e,t){if(0===arguments.length)return s(_).map(function(e){return _[e].self});var n=a(e,t);return n&&n.self?n.self:null},w}function b(e,t,n,i){return e!==t||(n!==t.locals||i.reload)&&e.self.reloadOnSearch!==!1?void 0:!0}var y,w,_={},x={},C="abstract",$={parent:function(e){if(D(e.parent)&&e.parent)return a(e.parent);var t=/^(.+)\.[^.]+$/.exec(e.name);return t?a(t[1]):y},data:function(e){return e.parent&&e.parent.data&&(e.data=e.self.data=R({},e.parent.data,e.data)),e.data},url:function(e){var t=e.url,n={params:e.params||{}};if(O(t))return"^"==t.charAt(0)?r.compile(t.substring(1),n):(e.parent.navigable||y).url.concat(t,n);if(!t||r.isMatcher(t))return t;throw new Error("Invalid url '"+t+"' in state '"+e+"'")},navigable:function(e){return e.url?e:e.parent?e.parent.navigable:null},params:function(e){return e.params?e.params:e.url?e.url.params:e.parent.params},views:function(e){var t={};return P(D(e.views)?e.views:{"":e},function(n,i){i.indexOf("@")<0&&(i+="@"+e.parent.name),t[i]=n}),t},ownParams:function(e){if(e.params=e.params||{},!e.parent)return s(e.params);var t={};P(e.params,function(e,n){t[n]=!0}),P(e.parent.params,function(n,i){if(!t[i])throw new Error("Missing required parameter '"+i+"' in state '"+e.name+"'");t[i]=!1});var n=[];return P(t,function(e,t){e&&n.push(t)}),n},path:function(e){return e.parent?e.parent.path.concat(e):[]},includes:function(e){var t=e.parent?R({},e.parent.includes):{};return t[e.name]=!0,t},$delegates:{}};y=d({name:"",url:"^",views:null,"abstract":!0}),y.navigable=null,this.decorator=g,this.state=m,this.$get=v,v.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter"]}function b(){function e(e,t){return{load:function(n,i){var r,o={template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}};return i=R(o,i),i.view&&(r=t.fromConfig(i.view,i.params,i.locals)),r&&i.notify&&e.$broadcast("$viewContentLoading",i),r}}}this.$get=e,e.$inject=["$rootScope","$templateFactory"]}function y(){var e=!1;this.useAnchorScroll=function(){e=!0},this.$get=["$anchorScroll","$timeout",function(t,n){return e?t:function(e){n(function(){e[0].scrollIntoView()},0,!1)}}]}function w(e,n,i){function r(){return n.has?function(e){return n.has(e)?n.get(e):null}:function(e){try{return n.get(e)}catch(t){return null}}}function o(e,t){var n=function(){return{enter:function(e,t,n){t.after(e),n()},leave:function(e,t){e.remove(),t()}}};if(l)return{enter:function(e,t,n){l.enter(e,null,t,n)},leave:function(e,t){l.leave(e,t)}};if(a){var i=a&&a(t,e);return{enter:function(e,t,n){i.enter(e,null,t),n()},leave:function(e,t){i.leave(e),t()}}}return n()}var s=r(),a=s("$animator"),l=s("$animate"),c={restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(n,r,s){return function(n,r,a){function l(){u&&(u.remove(),u=null),d&&(d.$destroy(),d=null),h&&(m.leave(h,function(){u=null}),u=h,h=null)}function c(o){var c,u=x(a,r.inheritedData("$uiView")),v=u&&e.$current&&e.$current.locals[u];if(o||v!==p){c=n.$new(),p=e.$current.locals[u];var b=s(c,function(e){m.enter(e,r,function(){(t.isDefined(g)&&!g||n.$eval(g))&&i(e)}),l()});h=b,d=c,d.$emit("$viewContentLoaded"),d.$eval(f)}}var u,h,d,p,f=a.onload||"",g=a.autoscroll,m=o(a,n);n.$on("$stateChangeSuccess",function(){c(!1)}),n.$on("$viewContentLoading",function(){c(!1)}),c(!0)}}};return c}function _(e,t,n){return{restrict:"ECA",priority:-400,compile:function(i){var r=i.html();return function(i,o,s){var a=n.$current,l=x(s,o.inheritedData("$uiView")),c=a&&a.locals[l];if(c){o.data("$uiView",{name:l,state:c.$$state}),o.html(c.$template?c.$template:r);var u=e(o.contents());if(c.$$controller){c.$scope=i;var h=t(c.$$controller,c);c.$$controllerAs&&(i[c.$$controllerAs]=h),o.data("$ngControllerController",h),o.children().data("$ngControllerController",h)}u(i)}}}}}function x(e,t){var n=e.uiView||e.name||"";return n.indexOf("@")>=0?n:n+"@"+(t?t.state.name:"")}function C(e,t){var n,i=e.match(/^\s*({[^}]*})\s*$/);if(i&&(e=t+"("+i[1]+")"),n=e.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/),!n||4!==n.length)throw new Error("Invalid state ref '"+e+"'");return{state:n[1],paramExpr:n[3]||null}}function $(e){var t=e.parent().inheritedData("$uiView");return t&&t.state&&t.state.name?t.state:void 0}function k(e,n){var i=["location","inherit","reload"];return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(r,o,s,a){var l=C(s.uiSref,e.current.name),c=null,u=$(o)||e.$current,h="FORM"===o[0].nodeName,d=h?"action":"href",p=!0,f={relative:u,inherit:!0},g=r.$eval(s.uiSrefOpts)||{};t.forEach(i,function(e){e in g&&(f[e]=g[e])});var m=function(t){if(t&&(c=t),p){var n=e.href(l.state,c,f),i=a[1]||a[0];return i&&i.$$setStateInfo(l.state,c),null===n?(p=!1,!1):void(o[0][d]=n)}};l.paramExpr&&(r.$watch(l.paramExpr,function(e){e!==c&&m(e)},!0),c=r.$eval(l.paramExpr)),m(),h||o.bind("click",function(t){var i=t.which||t.button;if(!(i>1||t.ctrlKey||t.metaKey||t.shiftKey||o.attr("target"))){var r=n(function(){e.go(l.state,c,f)});t.preventDefault(),t.preventDefault=function(){n.cancel(r)}}})}}}function S(e,t,n){return{restrict:"A",controller:["$scope","$element","$attrs",function(i,r,o){function s(){a()?r.addClass(d):r.removeClass(d)}function a(){return"undefined"!=typeof o.uiSrefActiveEq?e.$current.self===u&&l():e.includes(u.name)&&l()}function l(){return!h||c(h,t)}var u,h,d;d=n(o.uiSrefActiveEq||o.uiSrefActive||"",!1)(i),this.$$setStateInfo=function(t,n){u=e.get(t,$(r)),h=n,s()},i.$on("$stateChangeSuccess",s)}]}}function T(e){return function(t){return e.is(t)}}function E(e){return function(t){return e.includes(t)}}var D=t.isDefined,A=t.isFunction,O=t.isString,I=t.isObject,M=t.isArray,P=t.forEach,R=t.extend,N=t.copy;t.module("ui.router.util",["ng"]),t.module("ui.router.router",["ui.router.util"]),t.module("ui.router.state",["ui.router.router","ui.router.util"]),t.module("ui.router",["ui.router.state"]),t.module("ui.router.compat",["ui.router"]),h.$inject=["$q","$injector"],t.module("ui.router.util").service("$resolve",h),d.$inject=["$http","$templateCache","$injector"],t.module("ui.router.util").service("$templateFactory",d),p.prototype.concat=function(e,t){return new p(this.sourcePath+e+this.sourceSearch,t)},p.prototype.toString=function(){return this.source},p.prototype.exec=function(e,t){var n=this.regexp.exec(e);if(!n)return null;t=t||{};var i,r,o,s=this.parameters(),a=s.length,l=this.segments.length-1,c={};if(l!==n.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(i=0;l>i;i++)o=s[i],r=this.params[o],c[o]=r.$value(n[i+1]);for(;a>i;i++)o=s[i],r=this.params[o],c[o]=r.$value(t[o]);return c},p.prototype.parameters=function(e){return D(e)?this.params[e]||null:s(this.params)},p.prototype.validates=function(e){var t,n,i=!0,r=this;return P(e,function(e,o){r.params[o]&&(n=r.params[o],t=!e&&D(n.value),i=i&&(t||n.type.is(e)))}),i},p.prototype.format=function(e){var t=this.segments,n=this.parameters();if(!e)return t.join("").replace("//","/");var i,r,o,s,a,l,c=t.length-1,u=n.length,h=t[0];if(!this.validates(e))return null;for(i=0;c>i;i++)s=n[i],o=e[s],a=this.params[s],(D(o)||"/"!==t[i]&&"/"!==t[i+1])&&(null!=o&&(h+=encodeURIComponent(a.type.encode(o))),h+=t[i+1]);for(;u>i;i++)s=n[i],o=e[s],null!=o&&(l=M(o),l&&(o=o.map(encodeURIComponent).join("&"+s+"=")),h+=(r?"&":"?")+s+"="+(l?o:encodeURIComponent(o)),r=!0);return h},p.prototype.$types={},f.prototype.is=function(){return!0},f.prototype.encode=function(e){return e},f.prototype.decode=function(e){return e},f.prototype.equals=function(e,t){return e==t},f.prototype.$subPattern=function(){var e=this.pattern.toString();return e.substr(1,e.length-2)},f.prototype.pattern=/.*/,t.module("ui.router.util").provider("$urlMatcherFactory",g),m.$inject=["$locationProvider","$urlMatcherFactoryProvider"],t.module("ui.router.router").provider("$urlRouter",m),v.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],t.module("ui.router.state").value("$stateParams",{}).provider("$state",v),b.$inject=[],t.module("ui.router.state").provider("$view",b),t.module("ui.router.state").provider("$uiViewScroll",y),w.$inject=["$state","$injector","$uiViewScroll"],_.$inject=["$compile","$controller","$state"],t.module("ui.router.state").directive("uiView",w),t.module("ui.router.state").directive("uiView",_),k.$inject=["$state","$timeout"],S.$inject=["$state","$stateParams","$interpolate"],t.module("ui.router.state").directive("uiSref",k).directive("uiSrefActive",S).directive("uiSrefActiveEq",S),T.$inject=["$state"],E.$inject=["$state"],t.module("ui.router.state").filter("isState",T).filter("includedByState",E)}(window,window.angular),jQuery&&function(e){function t(t,n){var i=e('<div class="minicolors" />'),r=e.minicolors.defaults;t.data("minicolors-initialized")||(n=e.extend(!0,{},r,n),i.addClass("minicolors-theme-"+n.theme).toggleClass("minicolors-with-opacity",n.opacity).toggleClass("minicolors-no-data-uris",n.dataUris!==!0),void 0!==n.position&&e.each(n.position.split(" "),function(){i.addClass("minicolors-position-"+this)}),t.addClass("minicolors-input").data("minicolors-initialized",!1).data("minicolors-settings",n).prop("size",7).wrap(i).after('<div class="minicolors-panel minicolors-slider-'+n.control+'"><div class="minicolors-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-opacity-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-grid minicolors-sprite"><div class="minicolors-grid-inner"></div><div class="minicolors-picker"><div></div></div></div></div>'),n.inline||(t.after('<span class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></span>'),t.next(".minicolors-swatch").on("click",function(e){e.preventDefault(),t.focus()})),t.parent().find(".minicolors-panel").on("selectstart",function(){return!1}).end(),n.inline&&t.parent().addClass("minicolors-inline"),a(t,!1),t.data("minicolors-initialized",!0))}function n(e){var t=e.parent();e.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input"),t.before(e).remove()}function i(e){var t=e.parent(),n=t.find(".minicolors-panel"),i=e.data("minicolors-settings");!e.data("minicolors-initialized")||e.prop("disabled")||t.hasClass("minicolors-inline")||t.hasClass("minicolors-focus")||(r(),t.addClass("minicolors-focus"),n.stop(!0,!0).fadeIn(i.showSpeed,function(){i.show&&i.show.call(e.get(0))}))}function r(){e(".minicolors-focus").each(function(){var t=e(this),n=t.find(".minicolors-input"),i=t.find(".minicolors-panel"),r=n.data("minicolors-settings");i.fadeOut(r.hideSpeed,function(){r.hide&&r.hide.call(n.get(0)),t.removeClass("minicolors-focus")})})}function o(e,t,n){var i,r,o,a,l=e.parents(".minicolors").find(".minicolors-input"),c=l.data("minicolors-settings"),u=e.find("[class$=-picker]"),h=e.offset().left,d=e.offset().top,p=Math.round(t.pageX-h),f=Math.round(t.pageY-d),g=n?c.animationSpeed:0;t.originalEvent.changedTouches&&(p=t.originalEvent.changedTouches[0].pageX-h,f=t.originalEvent.changedTouches[0].pageY-d),0>p&&(p=0),0>f&&(f=0),p>e.width()&&(p=e.width()),f>e.height()&&(f=e.height()),e.parent().is(".minicolors-slider-wheel")&&u.parent().is(".minicolors-grid")&&(i=75-p,r=75-f,o=Math.sqrt(i*i+r*r),a=Math.atan2(r,i),0>a&&(a+=2*Math.PI),o>75&&(o=75,p=75-75*Math.cos(a),f=75-75*Math.sin(a)),p=Math.round(p),f=Math.round(f)),e.is(".minicolors-grid")?u.stop(!0).animate({top:f+"px",left:p+"px"},g,c.animationEasing,function(){s(l,e)}):u.stop(!0).animate({top:f+"px"},g,c.animationEasing,function(){s(l,e)})}function s(e,t){function n(e,t){var n,i;return e.length&&t?(n=e.offset().left,i=e.offset().top,{x:n-t.offset().left+e.outerWidth()/2,y:i-t.offset().top+e.outerHeight()/2}):null}var i,r,o,s,a,c,u,d=e.val(),f=e.attr("data-opacity"),g=e.parent(),v=e.data("minicolors-settings"),b=g.find(".minicolors-swatch"),y=g.find(".minicolors-grid"),w=g.find(".minicolors-slider"),_=g.find(".minicolors-opacity-slider"),x=y.find("[class$=-picker]"),C=w.find("[class$=-picker]"),$=_.find("[class$=-picker]"),k=n(x,y),S=n(C,w),T=n($,_);if(t.is(".minicolors-grid, .minicolors-slider")){switch(v.control){case"wheel":s=y.width()/2-k.x,a=y.height()/2-k.y,c=Math.sqrt(s*s+a*a),u=Math.atan2(a,s),0>u&&(u+=2*Math.PI),c>75&&(c=75,k.x=69-75*Math.cos(u),k.y=69-75*Math.sin(u)),r=p(c/.75,0,100),i=p(180*u/Math.PI,0,360),o=p(100-Math.floor(S.y*(100/w.height())),0,100),d=m({h:i,s:r,b:o}),w.css("backgroundColor",m({h:i,s:r,b:100}));break;case"saturation":i=p(parseInt(k.x*(360/y.width()),10),0,360),r=p(100-Math.floor(S.y*(100/w.height())),0,100),o=p(100-Math.floor(k.y*(100/y.height())),0,100),d=m({h:i,s:r,b:o}),w.css("backgroundColor",m({h:i,s:100,b:o})),g.find(".minicolors-grid-inner").css("opacity",r/100);break;case"brightness":i=p(parseInt(k.x*(360/y.width()),10),0,360),r=p(100-Math.floor(k.y*(100/y.height())),0,100),o=p(100-Math.floor(S.y*(100/w.height())),0,100),d=m({h:i,s:r,b:o}),w.css("backgroundColor",m({h:i,s:r,b:100})),g.find(".minicolors-grid-inner").css("opacity",1-o/100);break;default:i=p(360-parseInt(S.y*(360/w.height()),10),0,360),r=p(Math.floor(k.x*(100/y.width())),0,100),o=p(100-Math.floor(k.y*(100/y.height())),0,100),d=m({h:i,s:r,b:o}),y.css("backgroundColor",m({h:i,s:100,b:100}))}e.val(h(d,v.letterCase))}t.is(".minicolors-opacity-slider")&&(f=v.opacity?parseFloat(1-T.y/_.height()).toFixed(2):1,v.opacity&&e.attr("data-opacity",f)),b.find("SPAN").css({backgroundColor:d,opacity:f}),l(e,d,f)}function a(e,t){var n,i,r,o,s,a,c,u=e.parent(),f=e.data("minicolors-settings"),g=u.find(".minicolors-swatch"),b=u.find(".minicolors-grid"),y=u.find(".minicolors-slider"),w=u.find(".minicolors-opacity-slider"),_=b.find("[class$=-picker]"),x=y.find("[class$=-picker]"),C=w.find("[class$=-picker]");switch(n=h(d(e.val(),!0),f.letterCase),n||(n=h(d(f.defaultValue,!0),f.letterCase)),i=v(n),t||e.val(n),f.opacity&&(r=""===e.attr("data-opacity")?1:p(parseFloat(e.attr("data-opacity")).toFixed(2),0,1),isNaN(r)&&(r=1),e.attr("data-opacity",r),g.find("SPAN").css("opacity",r),s=p(w.height()-w.height()*r,0,w.height()),C.css("top",s+"px")),g.find("SPAN").css("backgroundColor",n),f.control){case"wheel":a=p(Math.ceil(.75*i.s),0,b.height()/2),c=i.h*Math.PI/180,o=p(75-Math.cos(c)*a,0,b.width()),s=p(75-Math.sin(c)*a,0,b.height()),
_.css({top:s+"px",left:o+"px"}),s=150-i.b/(100/b.height()),""===n&&(s=0),x.css("top",s+"px"),y.css("backgroundColor",m({h:i.h,s:i.s,b:100}));break;case"saturation":o=p(5*i.h/12,0,150),s=p(b.height()-Math.ceil(i.b/(100/b.height())),0,b.height()),_.css({top:s+"px",left:o+"px"}),s=p(y.height()-i.s*(y.height()/100),0,y.height()),x.css("top",s+"px"),y.css("backgroundColor",m({h:i.h,s:100,b:i.b})),u.find(".minicolors-grid-inner").css("opacity",i.s/100);break;case"brightness":o=p(5*i.h/12,0,150),s=p(b.height()-Math.ceil(i.s/(100/b.height())),0,b.height()),_.css({top:s+"px",left:o+"px"}),s=p(y.height()-i.b*(y.height()/100),0,y.height()),x.css("top",s+"px"),y.css("backgroundColor",m({h:i.h,s:i.s,b:100})),u.find(".minicolors-grid-inner").css("opacity",1-i.b/100);break;default:o=p(Math.ceil(i.s/(100/b.width())),0,b.width()),s=p(b.height()-Math.ceil(i.b/(100/b.height())),0,b.height()),_.css({top:s+"px",left:o+"px"}),s=p(y.height()-i.h/(360/y.height()),0,y.height()),x.css("top",s+"px"),b.css("backgroundColor",m({h:i.h,s:100,b:100}))}e.data("minicolors-initialized")&&l(e,n,r)}function l(e,t,n){var i=e.data("minicolors-settings"),r=e.data("minicolors-lastChange");r&&r.hex===t&&r.opacity===n||(e.data("minicolors-lastChange",{hex:t,opacity:n}),i.change&&(i.changeDelay?(clearTimeout(e.data("minicolors-changeTimeout")),e.data("minicolors-changeTimeout",setTimeout(function(){i.change.call(e.get(0),t,n)},i.changeDelay))):i.change.call(e.get(0),t,n)),e.trigger("change").trigger("input"))}function c(t){var n=d(e(t).val(),!0),i=y(n),r=e(t).attr("data-opacity");return i?(void 0!==r&&e.extend(i,{a:parseFloat(r)}),i):null}function u(t,n){var i=d(e(t).val(),!0),r=y(i),o=e(t).attr("data-opacity");return r?(void 0===o&&(o=1),n?"rgba("+r.r+", "+r.g+", "+r.b+", "+parseFloat(o)+")":"rgb("+r.r+", "+r.g+", "+r.b+")"):null}function h(e,t){return"uppercase"===t?e.toUpperCase():e.toLowerCase()}function d(e,t){return e=e.replace(/[^A-F0-9]/gi,""),3!==e.length&&6!==e.length?"":(3===e.length&&t&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),"#"+e)}function p(e,t,n){return t>e&&(e=t),e>n&&(e=n),e}function f(e){var t={},n=Math.round(e.h),i=Math.round(255*e.s/100),r=Math.round(255*e.b/100);if(0===i)t.r=t.g=t.b=r;else{var o=r,s=(255-i)*r/255,a=(o-s)*(n%60)/60;360===n&&(n=0),60>n?(t.r=o,t.b=s,t.g=s+a):120>n?(t.g=o,t.b=s,t.r=o-a):180>n?(t.g=o,t.r=s,t.b=s+a):240>n?(t.b=o,t.r=s,t.g=o-a):300>n?(t.b=o,t.g=s,t.r=s+a):360>n?(t.r=o,t.g=s,t.b=o-a):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}function g(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(n,function(e,t){1===t.length&&(n[e]="0"+t)}),"#"+n.join("")}function m(e){return g(f(e))}function v(e){var t=b(y(e));return 0===t.s&&(t.h=360),t}function b(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),i=Math.max(e.r,e.g,e.b),r=i-n;return t.b=i,t.s=0!==i?255*r/i:0,t.h=0!==t.s?e.r===i?(e.g-e.b)/r:e.g===i?2+(e.b-e.r)/r:4+(e.r-e.g)/r:-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t}function y(e){return e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16),{r:e>>16,g:(65280&e)>>8,b:255&e}}e.minicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",dataUris:!0,defaultValue:"",hide:null,hideSpeed:100,inline:!1,letterCase:"lowercase",opacity:!1,position:"bottom left",show:null,showSpeed:100,theme:"default"}},e.extend(e.fn,{minicolors:function(o,s){switch(o){case"destroy":return e(this).each(function(){n(e(this))}),e(this);case"hide":return r(),e(this);case"opacity":return void 0===s?e(this).attr("data-opacity"):(e(this).each(function(){a(e(this).attr("data-opacity",s))}),e(this));case"rgbObject":return c(e(this),"rgbaObject"===o);case"rgbString":case"rgbaString":return u(e(this),"rgbaString"===o);case"settings":return void 0===s?e(this).data("minicolors-settings"):(e(this).each(function(){var t=e(this).data("minicolors-settings")||{};n(e(this)),e(this).minicolors(e.extend(!0,t,s))}),e(this));case"show":return i(e(this).eq(0)),e(this);case"value":return void 0===s?e(this).val():(e(this).each(function(){a(e(this).val(s))}),e(this));default:return"create"!==o&&(s=o),e(this).each(function(){t(e(this),s)}),e(this)}}}),e(document).on("mousedown.minicolors touchstart.minicolors",function(t){e(t.target).parents().add(t.target).hasClass("minicolors")||r()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(t){var n=e(this);t.preventDefault(),e(document).data("minicolors-target",n),o(n,t,!0)}).on("mousemove.minicolors touchmove.minicolors",function(t){var n=e(document).data("minicolors-target");n&&o(n,t)}).on("mouseup.minicolors touchend.minicolors",function(){e(this).removeData("minicolors-target")}).on("mousedown.minicolors touchstart.minicolors",".minicolors-swatch",function(t){var n=e(this).parent().find(".minicolors-input");t.preventDefault(),i(n)}).on("focus.minicolors",".minicolors-input",function(){var t=e(this);t.data("minicolors-initialized")&&i(t)}).on("blur.minicolors",".minicolors-input",function(){var t=e(this),n=t.data("minicolors-settings");t.data("minicolors-initialized")&&(t.val(d(t.val(),!0)),""===t.val()&&t.val(d(n.defaultValue,!0)),t.val(h(t.val(),n.letterCase)))}).on("keydown.minicolors",".minicolors-input",function(t){var n=e(this);if(n.data("minicolors-initialized"))switch(t.keyCode){case 9:r();break;case 13:case 27:r(),n.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var t=e(this);t.data("minicolors-initialized")&&a(t,!0)}).on("paste.minicolors",".minicolors-input",function(){var t=e(this);t.data("minicolors-initialized")&&setTimeout(function(){a(t,!0)},1)})}(jQuery),function(e){"use strict";var t={},n=Math.max,i=Math.min;t.c={},t.c.d=e(document),t.c.t=function(e){return e.originalEvent.touches.length-1},t.o=function(){var n=this;this.o=null,this.$=null,this.i=null,this.g=null,this.v=null,this.cv=null,this.x=0,this.y=0,this.w=0,this.h=0,this.$c=null,this.c=null,this.t=0,this.isInit=!1,this.fgColor=null,this.pColor=null,this.dH=null,this.cH=null,this.eH=null,this.rH=null,this.scale=1,this.relative=!1,this.relativeWidth=!1,this.relativeHeight=!1,this.$div=null,this.run=function(){var t=function(e,t){var i;for(i in t)n.o[i]=t[i];n._carve().init(),n._configure()._draw()};if(!this.$.data("kontroled")){if(this.$.data("kontroled",!0),this.extend(),this.o=e.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:this.$.data("cursor")===!0&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null==this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(e){return e},parse:function(e){return parseFloat(e)}},this.o),this.o.flip="anticlockwise"===this.o.rotation||"acw"===this.o.rotation,this.o.inputColor||(this.o.inputColor=this.o.fgColor),this.$.is("fieldset")?(this.v={},this.i=this.$.find("input"),this.i.each(function(t){var i=e(this);n.i[t]=i,n.v[t]=n.o.parse(i.val()),i.bind("change blur",function(){var e={};e[t]=i.val(),n.val(e)})}),this.$.find("legend").remove()):(this.i=this.$,this.v=this.o.parse(this.$.val()),""===this.v&&(this.v=this.o.min),this.$.bind("change blur",function(){n.val(n._validate(n.o.parse(n.$.val())))})),!this.o.displayInput&&this.$.hide(),this.$c=e(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height}),this.$div=e('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>'),this.$.wrap(this.$div).before(this.$c),this.$div=this.$.parent(),"undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.$c[0]),this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null,!this.c)throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}};return this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1),this.relativeWidth=this.o.width%1!==0&&this.o.width.indexOf("%"),this.relativeHeight=this.o.height%1!==0&&this.o.height.indexOf("%"),this.relative=this.relativeWidth||this.relativeHeight,this._carve(),this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=this.v,this.$.bind("configure",t).parent().bind("configure",t),this._listen()._configure()._xy().init(),this.isInit=!0,this.$.val(this.o.format(this.v)),this._draw(),this}},this._carve=function(){if(this.relative){var e=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),t=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(e,t)}else this.w=this.o.width,this.h=this.o.height;return this.$div.css({width:this.w+"px",height:this.h+"px"}),this.$c.attr({width:this.w,height:this.h}),1!==this.scale&&(this.$c[0].width=this.$c[0].width*this.scale,this.$c[0].height=this.$c[0].height*this.scale,this.$c.width(this.w),this.$c.height(this.h)),this},this._draw=function(){var e=!0;n.g=n.c,n.clear(),n.dH&&(e=n.dH()),e!==!1&&n.draw()},this._touch=function(e){var i=function(e){var t=n.xy2val(e.originalEvent.touches[n.t].pageX,e.originalEvent.touches[n.t].pageY);t!=n.cv&&(n.cH&&n.cH(t)===!1||(n.change(n._validate(t)),n._draw()))};return this.t=t.c.t(e),i(e),t.c.d.bind("touchmove.k",i).bind("touchend.k",function(){t.c.d.unbind("touchmove.k touchend.k"),n.val(n.cv)}),this},this._mouse=function(e){var i=function(e){var t=n.xy2val(e.pageX,e.pageY);t!=n.cv&&(n.cH&&n.cH(t)===!1||(n.change(n._validate(t)),n._draw()))};return i(e),t.c.d.bind("mousemove.k",i).bind("keyup.k",function(e){if(27===e.keyCode){if(t.c.d.unbind("mouseup.k mousemove.k keyup.k"),n.eH&&n.eH()===!1)return;n.cancel()}}).bind("mouseup.k",function(e){t.c.d.unbind("mousemove.k mouseup.k keyup.k"),n.val(n.cv)}),this},this._xy=function(){var e=this.$c.offset();return this.x=e.left,this.y=e.top,this},this._listen=function(){return this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(e){e.preventDefault(),n._xy()._mouse(e)}).bind("touchstart",function(e){e.preventDefault(),n._xy()._touch(e)}),this.listen()),this.relative&&e(window).resize(function(){n._carve().init(),n._draw()}),this},this._configure=function(){return this.o.draw&&(this.dH=this.o.draw),this.o.change&&(this.cH=this.o.change),this.o.cancel&&(this.eH=this.o.cancel),this.o.release&&(this.rH=this.o.release),this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.4"),this.fgColor=this.h2rgba(this.o.fgColor,"0.6")):this.fgColor=this.o.fgColor,this},this._clear=function(){this.$c[0].width=this.$c[0].width},this._validate=function(e){return~~((0>e?-.5:.5)+e/this.o.step)*this.o.step},this.listen=function(){},this.extend=function(){},this.init=function(){},this.change=function(e){},this.val=function(e){},this.xy2val=function(e,t){},this.draw=function(){},this.clear=function(){this._clear()},this.h2rgba=function(e,t){var n;return e=e.substring(1,7),n=[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)],"rgba("+n[0]+","+n[1]+","+n[2]+","+t+")"},this.copy=function(e,t){for(var n in e)t[n]=e[n]}},t.Dial=function(){t.o.call(this),this.startAngle=null,this.xy=null,this.radius=null,this.lineWidth=null,this.cursorExt=null,this.w2=null,this.PI2=2*Math.PI,this.extend=function(){this.o=e.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)},this.val=function(e,t){return null==e?this.v:(e=this.o.parse(e),void(t!==!1&&e!=this.v&&this.rH&&this.rH(e)===!1||(this.cv=this.o.stopper?n(i(e,this.o.max),this.o.min):e,this.v=this.cv,this.$.val(this.o.format(this.v)),this._draw())))},this.xy2val=function(e,t){var r,o;return r=Math.atan2(e-(this.x+this.w2),-(t-this.y-this.w2))-this.angleOffset,this.o.flip&&(r=this.angleArc-r-this.PI2),this.angleArc!=this.PI2&&0>r&&r>-.5?r=0:0>r&&(r+=this.PI2),o=~~(.5+r*(this.o.max-this.o.min)/this.angleArc)+this.o.min,this.o.stopper&&(o=n(i(o,this.o.max),this.o.min)),o},this.listen=function(){var t,r,o=this,s=1,a={37:-o.o.step,38:o.o.step,39:o.o.step,40:-o.o.step};this.$.bind("keydown",function(l){var c=l.keyCode;if(c>=96&&105>=c&&(c=l.keyCode=c-48),t=parseInt(String.fromCharCode(c)),isNaN(t)&&(13!==c&&8!==c&&9!==c&&189!==c&&(190!==c||o.$.val().match(/\./))&&l.preventDefault(),e.inArray(c,[37,38,39,40])>-1)){l.preventDefault();var u=o.o.parse(o.$.val())+a[c]*s;o.o.stopper&&(u=n(i(u,o.o.max),o.o.min)),o.change(u),o._draw(),r=window.setTimeout(function(){s*=2},30)}}).bind("keyup",function(e){isNaN(t)?r&&(window.clearTimeout(r),r=null,s=1,o.val(o.$.val())):o.$.val()>o.o.max&&o.$.val(o.o.max)||o.$.val()<o.o.min&&o.$.val(o.o.min)})},this.init=function(){(this.v<this.o.min||this.v>this.o.max)&&(this.v=this.o.min),this.$.val(this.v),this.w2=this.w/2,this.cursorExt=this.o.cursor/100,this.xy=this.w2*this.scale,this.lineWidth=this.xy*this.o.thickness,this.lineCap=this.o.lineCap,this.radius=this.xy-this.lineWidth/2,this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset),this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc),this.angleOffset=this.o.angleOffset*Math.PI/180,this.angleArc=this.o.angleArc*Math.PI/180,this.startAngle=1.5*Math.PI+this.angleOffset,this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var e=n(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(3*this.w/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/e>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})},this.change=function(e){this.cv=e,this.$.val(this.o.format(e))},this.angle=function(e){return(e-this.o.min)*this.angleArc/(this.o.max-this.o.min)},this.arc=function(e){var t,n;return e=this.angle(e),this.o.flip?(t=this.endAngle+1e-5,n=t-e-1e-5):(t=this.startAngle-1e-5,n=t+e+1e-5),this.o.cursor&&(t=n-this.cursorExt)&&(n+=this.cursorExt),{s:t,e:n,d:this.o.flip&&!this.o.cursor}},this.draw=function(){var e,t=this.g,n=this.arc(this.cv),i=1;t.lineWidth=this.lineWidth,t.lineCap=this.lineCap,t.beginPath(),t.strokeStyle=this.o.bgColor,t.arc(this.xy,this.xy,this.radius,this.endAngle-1e-5,this.startAngle+1e-5,!0),t.stroke(),this.o.displayPrevious&&(e=this.arc(this.v),t.beginPath(),t.strokeStyle=this.pColor,t.arc(this.xy,this.xy,this.radius,e.s,e.e,e.d),t.stroke(),i=this.cv==this.v),t.beginPath(),t.strokeStyle=i?this.o.fgColor:this.fgColor,t.arc(this.xy,this.xy,this.radius,n.s,n.e,n.d),t.stroke()},this.cancel=function(){this.val(this.v)}},e.fn.dial=e.fn.knob=function(n){return this.each(function(){var i=new t.Dial;i.o=n,i.$=e(this),i.run()}).parent()}}(jQuery),function(){function e(e,t,n){n=(n||0)-1;for(var i=e?e.length:0;++n<i;)if(e[n]===t)return n;return-1}function t(t,n){var i=typeof n;if(t=t.l,"boolean"==i||null==n)return t[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var r="number"==i?n:y+n;return t=(t=t[i])&&t[r],"object"==i?t&&-1<e(t,n)?0:-1:t?0:-1}function n(e){var t=this.l,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?e:y+e,t=t[n]||(t[n]={});"object"==n?(t[i]||(t[i]=[])).push(e):t[i]=!0}}function i(e){return e.charCodeAt(0)}function r(e,t){for(var n=e.m,i=t.m,r=-1,o=n.length;++r<o;){var s=n[r],a=i[r];if(s!==a){if(s>a||"undefined"==typeof s)return 1;if(a>s||"undefined"==typeof a)return-1}}return e.n-t.n}function o(e){var t=-1,i=e.length,r=e[0],o=e[i/2|0],s=e[i-1];if(r&&"object"==typeof r&&o&&"object"==typeof o&&s&&"object"==typeof s)return!1;for(r=l(),r["false"]=r["null"]=r["true"]=r.undefined=!1,o=l(),o.k=e,o.l=r,o.push=n;++t<i;)o.push(e[t]);return o}function s(e){return"\\"+J[e]}function a(){return g.pop()||[]}function l(){return m.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function c(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}function u(e){e.length=0,g.length<_&&g.push(e)}function h(e){var t=e.l;t&&h(t),e.k=e.l=e.m=e.object=e.number=e.string=e.o=null,m.length<_&&m.push(e)}function d(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);var i=-1;n=n-t||0;for(var r=Array(0>n?0:n);++i<n;)r[i]=e[t+i];return r}function p(n){function g(e){return e&&"object"==typeof e&&!Ht(e)&&_t.call(e,"__wrapped__")?e:new m(e)}function m(e,t){this.__chain__=!!t,this.__wrapped__=e}function _(e){function t(){if(i){var e=d(i);xt.apply(e,arguments)}if(this instanceof t){var o=ee(n.prototype),e=n.apply(o,e||arguments);return Ce(e)?e:o}return n.apply(r,e||arguments)}var n=e[0],i=e[2],r=e[4];return Ut(t,e),t}function J(e,t,n,i,r){if(n){var o=n(e);if("undefined"!=typeof o)return o}if(!Ce(e))return e;var s=ft.call(e);if(!Y[s]||!jt.nodeClass&&c(e))return e;var l=Ft[s];switch(s){case j:case U:return new l(+e);case B:case V:return new l(e);case q:return o=l(e.source,E.exec(e)),o.lastIndex=e.lastIndex,o}if(s=Ht(e),t){var h=!i;i||(i=a()),r||(r=a());for(var p=i.length;p--;)if(i[p]==e)return r[p];o=s?l(e.length):{}}else o=s?d(e):Jt({},e);return s&&(_t.call(e,"index")&&(o.index=e.index),_t.call(e,"input")&&(o.input=e.input)),t?(i.push(e),r.push(o),(s?Qt:tn)(e,function(e,s){o[s]=J(e,t,n,i,r)}),h&&(u(i),u(r)),o):o}function ee(e){return Ce(e)?Et(e):{}}function te(e,t,n){if("function"!=typeof e)return Ge;if("undefined"==typeof t||!("prototype"in e))return e;var i=e.__bindData__;if("undefined"==typeof i&&(jt.funcNames&&(i=!e.name),i=i||!jt.funcDecomp,!i)){var r=yt.call(e);jt.funcNames||(i=!D.test(r)),i||(i=M.test(r),Ut(e,i))}if(!1===i||!0!==i&&1&i[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}}return Ve(e,t)}function ne(e){function t(){var e=l?s:this;if(r){var f=d(r);xt.apply(f,arguments)}return(o||u)&&(f||(f=d(arguments)),o&&xt.apply(f,o),u&&f.length<a)?(i|=16,ne([n,h?i:-4&i,f,null,s,a])):(f||(f=arguments),c&&(n=e[p]),this instanceof t?(e=ee(n.prototype),f=n.apply(e,f),Ce(f)?f:e):n.apply(e,f))}var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=1&i,c=2&i,u=4&i,h=8&i,p=n;return Ut(t,e),t}function ie(n,i){var r=-1,s=fe(),a=n?n.length:0,l=a>=w&&s===e,c=[];if(l){var u=o(i);u?(s=t,i=u):l=!1}for(;++r<a;)u=n[r],0>s(i,u)&&c.push(u);return l&&h(i),c}function oe(e,t,n,i){i=(i||0)-1;for(var r=e?e.length:0,o=[];++i<r;){var s=e[i];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Ht(s)||be(s))){t||(s=oe(s,t,n));var a=-1,l=s.length,c=o.length;for(o.length+=l;++a<l;)o[c++]=s[a]}else n||o.push(s)}return o}function se(e,t,n,i,r,o){if(n){var s=n(e,t);if("undefined"!=typeof s)return!!s}if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&Q[typeof e]||t&&Q[typeof t]))return!1;if(null==e||null==t)return e===t;var l=ft.call(e),h=ft.call(t);if(l==F&&(l=z),h==F&&(h=z),l!=h)return!1;switch(l){case j:case U:return+e==+t;case B:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case q:case V:return e==at(t)}if(h=l==L,!h){var d=_t.call(e,"__wrapped__"),p=_t.call(t,"__wrapped__");if(d||p)return se(d?e.__wrapped__:e,p?t.__wrapped__:t,n,i,r,o);if(l!=z||!jt.nodeClass&&(c(e)||c(t)))return!1;if(l=!jt.argsObject&&be(e)?ot:e.constructor,d=!jt.argsObject&&be(t)?ot:t.constructor,l!=d&&!(xe(l)&&l instanceof l&&xe(d)&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}for(l=!r,r||(r=a()),o||(o=a()),d=r.length;d--;)if(r[d]==e)return o[d]==t;var f=0,s=!0;if(r.push(e),o.push(t),h){if(d=e.length,f=t.length,(s=f==d)||i)for(;f--;)if(h=d,p=t[f],i)for(;h--&&!(s=se(e[h],p,n,i,r,o)););else if(!(s=se(e[f],p,n,i,r,o)))break}else en(t,function(t,a,l){return _t.call(l,a)?(f++,s=_t.call(e,a)&&se(e[a],t,n,i,r,o)):void 0}),s&&!i&&en(e,function(e,t,n){return _t.call(n,t)?s=-1<--f:void 0});return r.pop(),o.pop(),l&&(u(r),u(o)),s}function ae(e,t,n,i,r){(Ht(t)?Oe:tn)(t,function(t,o){var s,a,l=t,c=e[o];if(t&&((a=Ht(t))||nn(t))){for(l=i.length;l--;)if(s=i[l]==t){c=r[l];break}if(!s){var u;n&&(l=n(c,t),u="undefined"!=typeof l)&&(c=l),u||(c=a?Ht(c)?c:[]:nn(c)?c:{}),i.push(t),r.push(c),u||ae(c,t,n,i,r)}}else n&&(l=n(c,t),"undefined"==typeof l&&(l=t)),"undefined"!=typeof l&&(c=l);e[o]=c})}function le(e,t){return e+bt(Nt()*(t-e+1))}function ce(n,i,r){var s=-1,l=fe(),c=n?n.length:0,d=[],p=!i&&c>=w&&l===e,f=r||p?a():d;for(p&&(f=o(f),l=t);++s<c;){var g=n[s],m=r?r(g,s,n):g;(i?!s||f[f.length-1]!==m:0>l(f,m))&&((r||p)&&f.push(m),d.push(g))}return p?(u(f.k),h(f)):r&&u(f),d}function ue(e){return function(t,n,i){var r={};if(n=g.createCallback(n,i,3),Ht(t)){i=-1;for(var o=t.length;++i<o;){var s=t[i];e(r,s,n(s,i,t),t)}}else Qt(t,function(t,i,o){e(r,t,n(t,i,o),o)});return r}}function he(e,t,n,i,r,o){var s=1&t,a=4&t,l=16&t,c=32&t;if(!(2&t||xe(e)))throw new lt;l&&!n.length&&(t&=-17,l=n=!1),c&&!i.length&&(t&=-33,c=i=!1);var u=e&&e.__bindData__;return u&&!0!==u?(u=d(u),u[2]&&(u[2]=d(u[2])),u[3]&&(u[3]=d(u[3])),!s||1&u[1]||(u[4]=r),!s&&1&u[1]&&(t|=8),!a||4&u[1]||(u[5]=o),l&&xt.apply(u[2]||(u[2]=[]),n),c&&St.apply(u[3]||(u[3]=[]),i),u[1]|=t,he.apply(null,u)):(1==t||17===t?_:ne)([e,t,n,i,r,o])}function de(){X.h=N,X.b=X.c=X.g=X.i="",X.e="t",X.j=!0;for(var e,t=0;e=arguments[t];t++)for(var n in e)X[n]=e[n];t=X.a,X.d=/^[^,]+/.exec(t)[0],e=nt,t="return function("+t+"){",n=X;var i="var n,t="+n.d+",E="+n.e+";if(!t)return E;"+n.i+";";n.b?(i+="var u=t.length;n=-1;if("+n.b+"){",jt.unindexedChars&&(i+="if(s(t)){t=t.split('')}"),i+="while(++n<u){"+n.g+";}}else{"):jt.nonEnumArgs&&(i+="var u=t.length;n=-1;if(u&&p(t)){while(++n<u){n+='';"+n.g+";}}else{"),jt.enumPrototypes&&(i+="var G=typeof t=='function';"),jt.enumErrorProps&&(i+="var F=t===k||t instanceof Error;");var r=[];if(jt.enumPrototypes&&r.push('!(G&&n=="prototype")'),jt.enumErrorProps&&r.push('!(F&&(n=="message"||n=="name"))'),n.j&&n.f)i+="var C=-1,D=B[typeof t]&&v(t),u=D?D.length:0;while(++C<u){n=D[C];",r.length&&(i+="if("+r.join("&&")+"){"),i+=n.g+";",r.length&&(i+="}"),i+="}";else if(i+="for(n in t){",n.j&&r.push("m.call(t, n)"),r.length&&(i+="if("+r.join("&&")+"){"),i+=n.g+";",r.length&&(i+="}"),i+="}",jt.nonEnumShadows){for(i+="if(t!==A){var i=t.constructor,r=t===(i&&i.prototype),f=t===J?I:t===k?j:L.call(t),x=y[f];",k=0;7>k;k++)i+="n='"+n.h[k]+"';if((!(r&&x[n])&&m.call(t,n))",n.j||(i+="||(!x[n]&&t[n]!==A[n])"),i+="){"+n.g+"}";i+="}"}return(n.b||jt.nonEnumArgs)&&(i+="}"),i+=n.c+";return E",e("d,j,k,m,o,p,q,s,v,A,B,y,I,J,L",t+i+"}")(te,H,ut,_t,b,be,Ht,ke,X.f,ht,Q,Lt,V,dt,ft)}function pe(e){return Yt[e]}function fe(){var t=(t=g.indexOf)===Ue?e:t;return t}function ge(e){return"function"==typeof e&&gt.test(e)}function me(e){var t,n;return!e||ft.call(e)!=z||(t=e.constructor,xe(t)&&!(t instanceof t))||!jt.argsClass&&be(e)||!jt.nodeClass&&c(e)?!1:jt.ownLast?(en(e,function(e,t,i){return n=_t.call(i,t),!1}),!1!==n):(en(e,function(e,t){n=t}),"undefined"==typeof n||_t.call(e,n))}function ve(e){return Gt[e]}function be(e){return e&&"object"==typeof e&&"number"==typeof e.length&&ft.call(e)==F||!1}function ye(e,t,n){var i=Bt(e),r=i.length;for(t=te(t,n,3);r--&&(n=i[r],!1!==t(e[n],n,e)););return e}function we(e){var t=[];return en(e,function(e,n){xe(e)&&t.push(n)}),t.sort()}function _e(e){for(var t=-1,n=Bt(e),i=n.length,r={};++t<i;){var o=n[t];r[e[o]]=o}return r}function xe(e){return"function"==typeof e}function Ce(e){return!(!e||!Q[typeof e])}function $e(e){return"number"==typeof e||e&&"object"==typeof e&&ft.call(e)==B||!1}function ke(e){return"string"==typeof e||e&&"object"==typeof e&&ft.call(e)==V||!1}function Se(e){for(var t=-1,n=Bt(e),i=n.length,r=Ze(i);++t<i;)r[t]=e[n[t]];return r}function Te(e,t,n){var i=-1,r=fe(),o=e?e.length:0,s=!1;return n=(0>n?Mt(0,o+n):n)||0,Ht(e)?s=-1<r(e,t,n):"number"==typeof o?s=-1<(ke(e)?e.indexOf(t,n):r(e,t,n)):Qt(e,function(e){return++i<n?void 0:!(s=e===t)}),s}function Ee(e,t,n){var i=!0;if(t=g.createCallback(t,n,3),Ht(e)){n=-1;for(var r=e.length;++n<r&&(i=!!t(e[n],n,e)););}else Qt(e,function(e,n,r){return i=!!t(e,n,r)});return i}function De(e,t,n){var i=[];if(t=g.createCallback(t,n,3),Ht(e)){n=-1;for(var r=e.length;++n<r;){var o=e[n];t(o,n,e)&&i.push(o)}}else Qt(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function Ae(e,t,n){if(t=g.createCallback(t,n,3),!Ht(e)){var i;return Qt(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}n=-1;for(var r=e.length;++n<r;){var o=e[n];if(t(o,n,e))return o}}function Oe(e,t,n){if(t&&"undefined"==typeof n&&Ht(e)){n=-1;for(var i=e.length;++n<i&&!1!==t(e[n],n,e););}else Qt(e,t,n);return e}function Ie(e,t,n){var i=e,r=e?e.length:0;if(t=t&&"undefined"==typeof n?t:te(t,n,3),Ht(e))for(;r--&&!1!==t(e[r],r,e););else{if("number"!=typeof r)var o=Bt(e),r=o.length;else jt.unindexedChars&&ke(e)&&(i=e.split(""));Qt(e,function(e,n,s){return n=o?o[--r]:--r,t(i[n],n,s)})}return e}function Me(e,t,n){var i=-1,r=e?e.length:0,o=Ze("number"==typeof r?r:0);if(t=g.createCallback(t,n,3),Ht(e))for(;++i<r;)o[i]=t(e[i],i,e);else Qt(e,function(e,n,r){o[++i]=t(e,n,r)});return o}function Pe(e,t,n){var r=-1/0,o=r;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&Ht(e)){n=-1;for(var s=e.length;++n<s;){var a=e[n];a>o&&(o=a)}}else t=null==t&&ke(e)?i:g.createCallback(t,n,3),Qt(e,function(e,n,i){n=t(e,n,i),n>r&&(r=n,o=e)});return o}function Re(e,t,n,i){var r=3>arguments.length;if(t=g.createCallback(t,i,4),Ht(e)){var o=-1,s=e.length;for(r&&(n=e[++o]);++o<s;)n=t(n,e[o],o,e)}else Qt(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)});return n}function Ne(e,t,n,i){var r=3>arguments.length;return t=g.createCallback(t,i,4),Ie(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function Fe(e){var t=-1,n=e?e.length:0,i=Ze("number"==typeof n?n:0);return Oe(e,function(e){var n=le(0,++t);i[t]=i[n],i[n]=e}),i}function Le(e,t,n){var i;if(t=g.createCallback(t,n,3),Ht(e)){n=-1;for(var r=e.length;++n<r&&!(i=t(e[n],n,e)););}else Qt(e,function(e,n,r){return!(i=t(e,n,r))});return!!i}function je(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=-1;for(t=g.createCallback(t,n,3);++o<r&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[0]:f;return d(e,0,Pt(Mt(0,i),r))}function Ue(t,n,i){if("number"==typeof i){var r=t?t.length:0;i=0>i?Mt(0,r+i):i||0}else if(i)return i=We(t,n),t[i]===n?i:-1;return e(t,n,i)}function He(e,t,n){if("number"!=typeof t&&null!=t){var i=0,r=-1,o=e?e.length:0;for(t=g.createCallback(t,n,3);++r<o&&t(e[r],r,e);)i++}else i=null==t||n?1:Mt(0,t);return d(e,i)}function We(e,t,n,i){var r=0,o=e?e.length:r;for(n=n?g.createCallback(n,i,1):Ge,t=n(t);o>r;)i=r+o>>>1,n(e[i])<t?r=i+1:o=i;return r}function Be(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(n=g.createCallback(n,i,3)),ce(e,t,n)}function ze(){for(var e=1<arguments.length?arguments:arguments[0],t=-1,n=e?Pe(an(e,"length")):0,i=Ze(0>n?0:n);++t<n;)i[t]=an(e,t);return i}function qe(e,t){var n=-1,i=e?e.length:0,r={};for(t||!i||Ht(e[0])||(t=[]);++n<i;){var o=e[n];t?r[o]=t[n]:o&&(r[o[0]]=o[1])}return r}function Ve(e,t){return 2<arguments.length?he(e,17,d(arguments,2),null,t):he(e,1,null,null,t)}function Ye(e,t,n){var i,r,o,s,a,l,c,u=0,h=!1,d=!0;if(!xe(e))throw new lt;if(t=Mt(0,t)||0,!0===n)var p=!0,d=!1;else Ce(n)&&(p=n.leading,h="maxWait"in n&&(Mt(t,n.maxWait)||0),d="trailing"in n?n.trailing:d);var g=function(){var n=t-(ln()-s);n>0?l=$t(g,n):(r&&vt(r),n=c,r=l=c=f,n&&(u=ln(),o=e.apply(a,i),l||r||(i=a=null)))},m=function(){l&&vt(l),r=l=c=f,(d||h!==t)&&(u=ln(),o=e.apply(a,i),l||r||(i=a=null))};return function(){if(i=arguments,s=ln(),a=this,c=d&&(l||!p),!1===h)var n=p&&!l;else{r||p||(u=s);var f=h-(s-u),v=0>=f;v?(r&&(r=vt(r)),u=s,o=e.apply(a,i)):r||(r=$t(m,f))}return v&&l?l=vt(l):l||t===h||(l=$t(g,t)),n&&(v=!0,o=e.apply(a,i)),!v||l||r||(i=a=null),o}}function Ge(e){return e}function Ke(e,t,n){var i=!0,r=t&&we(t);t&&(n||r.length)||(null==n&&(n=t),o=m,t=e,e=g,r=we(t)),!1===n?i=!1:Ce(n)&&"chain"in n&&(i=n.chain);var o=e,s=xe(o);Oe(r,function(n){var r=e[n]=t[n];s&&(o.prototype[n]=function(){var t=this.__chain__,n=this.__wrapped__,s=[n];if(xt.apply(s,arguments),s=r.apply(e,s),i||t){if(n===s&&Ce(s))return this;s=new o(s),s.__chain__=t}return s})})}function Xe(){}function Qe(e){return function(t){return t[e]}}function Je(){return this.__wrapped__}n=n?re.defaults(Z.Object(),n,re.pick(Z,R)):Z;var Ze=n.Array,et=n.Boolean,tt=n.Date,nt=n.Function,it=n.Math,rt=n.Number,ot=n.Object,st=n.RegExp,at=n.String,lt=n.TypeError,ct=[],ut=n.Error.prototype,ht=ot.prototype,dt=at.prototype,pt=n._,ft=ht.toString,gt=st("^"+at(ft).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),mt=it.ceil,vt=n.clearTimeout,bt=it.floor,yt=nt.prototype.toString,wt=ge(wt=ot.getPrototypeOf)&&wt,_t=ht.hasOwnProperty,xt=ct.push,Ct=ht.propertyIsEnumerable,$t=n.setTimeout,kt=ct.splice,St=ct.unshift,Tt=function(){try{var e={},t=ge(t=ot.defineProperty)&&t,n=t(e,e,e)&&t}catch(i){}return n}(),Et=ge(Et=ot.create)&&Et,Dt=ge(Dt=Ze.isArray)&&Dt,At=n.isFinite,Ot=n.isNaN,It=ge(It=ot.keys)&&It,Mt=it.max,Pt=it.min,Rt=n.parseInt,Nt=it.random,Ft={};Ft[L]=Ze,Ft[j]=et,Ft[U]=tt,Ft[W]=nt,Ft[z]=ot,Ft[B]=rt,Ft[q]=st,Ft[V]=at;var Lt={};Lt[L]=Lt[U]=Lt[B]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Lt[j]=Lt[V]={constructor:!0,toString:!0,valueOf:!0},Lt[H]=Lt[W]=Lt[q]={constructor:!0,toString:!0},Lt[z]={constructor:!0},function(){for(var e=N.length;e--;){var t,n=N[e];for(t in Lt)_t.call(Lt,t)&&!_t.call(Lt[t],n)&&(Lt[t][n]=!1)}}(),m.prototype=g.prototype;var jt=g.support={};!function(){var e=function(){this.x=1},t={0:1,length:1},i=[];e.prototype={valueOf:1,y:1};for(var r in new e)i.push(r);for(r in arguments);jt.argsClass=ft.call(arguments)==F,jt.argsObject=arguments.constructor==ot&&!(arguments instanceof Ze),jt.enumErrorProps=Ct.call(ut,"message")||Ct.call(ut,"name"),jt.enumPrototypes=Ct.call(e,"prototype"),jt.funcDecomp=!ge(n.WinRTError)&&M.test(p),jt.funcNames="string"==typeof nt.name,jt.nonEnumArgs=0!=r,jt.nonEnumShadows=!/valueOf/.test(i),jt.ownLast="x"!=i[0],jt.spliceObjects=(ct.splice.call(t,0,1),!t[0]),jt.unindexedChars="xx"!="x"[0]+ot("x")[0];try{jt.nodeClass=!(ft.call(document)==z&&!({toString:0}+""))}catch(o){jt.nodeClass=!0}}(1),g.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:A,variable:"",imports:{_:g}},Et||(ee=function(){function e(){}return function(t){if(Ce(t)){e.prototype=t;var i=new e;e.prototype=null}return i||n.Object()}}());var Ut=Tt?function(e,t){K.value=t,Tt(e,"__bindData__",K)}:Xe;jt.argsClass||(be=function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&_t.call(e,"callee")&&!Ct.call(e,"callee")||!1});var Ht=Dt||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&ft.call(e)==L||!1},Wt=de({a:"z",e:"[]",i:"if(!(B[typeof z]))return E",g:"E.push(n)"}),Bt=It?function(e){return Ce(e)?jt.enumPrototypes&&"function"==typeof e||jt.nonEnumArgs&&e.length&&be(e)?Wt(e):It(e):[]}:Wt,zt={a:"g,e,K",i:"e=e&&typeof K=='undefined'?e:d(e,K,3)",b:"typeof u=='number'",v:Bt,g:"if(e(t[n],n,g)===false)return E"},qt={a:"z,H,l",i:"var a=arguments,b=0,c=typeof l=='number'?2:a.length;while(++b<c){t=a[b];if(t&&B[typeof t]){",
v:Bt,g:"if(typeof E[n]=='undefined')E[n]=t[n]",c:"}}"},Vt={i:"if(!B[typeof t])return E;"+zt.i,b:!1},Yt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gt=_e(Yt),Kt=st("("+Bt(Gt).join("|")+")","g"),Xt=st("["+Bt(Yt).join("")+"]","g"),Qt=de(zt),Jt=de(qt,{i:qt.i.replace(";",";if(c>3&&typeof a[c-2]=='function'){var e=d(a[--c-1],a[c--],2)}else if(c>2&&typeof a[c-1]=='function'){e=a[--c]}"),g:"E[n]=e?e(E[n],t[n]):t[n]"}),Zt=de(qt),en=de(zt,Vt,{j:!1}),tn=de(zt,Vt);xe(/x/)&&(xe=function(e){return"function"==typeof e&&ft.call(e)==W});var nn=wt?function(e){if(!e||ft.call(e)!=z||!jt.argsClass&&be(e))return!1;var t=e.valueOf,n=ge(t)&&(n=wt(t))&&wt(n);return n?e==n||wt(e)==n:me(e)}:me,rn=ue(function(e,t,n){_t.call(e,n)?e[n]++:e[n]=1}),on=ue(function(e,t,n){(_t.call(e,n)?e[n]:e[n]=[]).push(t)}),sn=ue(function(e,t,n){e[n]=t}),an=Me,ln=ge(ln=tt.now)&&ln||function(){return(new tt).getTime()},cn=8==Rt(x+"08")?Rt:function(e,t){return Rt(ke(e)?e.replace(O,""):e,t||0)};return g.after=function(e,t){if(!xe(t))throw new lt;return function(){return 1>--e?t.apply(this,arguments):void 0}},g.assign=Jt,g.at=function(e){var t=arguments,n=-1,i=oe(t,!0,!1,1),t=t[2]&&t[2][t[1]]===e?1:i.length,r=Ze(t);for(jt.unindexedChars&&ke(e)&&(e=e.split(""));++n<t;)r[n]=e[i[n]];return r},g.bind=Ve,g.bindAll=function(e){for(var t=1<arguments.length?oe(arguments,!0,!1,1):we(e),n=-1,i=t.length;++n<i;){var r=t[n];e[r]=he(e[r],1,null,null,e)}return e},g.bindKey=function(e,t){return 2<arguments.length?he(t,19,d(arguments,2),null,e):he(t,3,null,null,e)},g.chain=function(e){return e=new m(e),e.__chain__=!0,e},g.compact=function(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var r=e[t];r&&i.push(r)}return i},g.compose=function(){for(var e=arguments,t=e.length;t--;)if(!xe(e[t]))throw new lt;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},g.constant=function(e){return function(){return e}},g.countBy=rn,g.create=function(e,t){var n=ee(e);return t?Jt(n,t):n},g.createCallback=function(e,t,n){var i=typeof e;if(null==e||"function"==i)return te(e,t,n);if("object"!=i)return Qe(e);var r=Bt(e),o=r[0],s=e[o];return 1!=r.length||s!==s||Ce(s)?function(t){for(var n=r.length,i=!1;n--&&(i=se(t[r[n]],e[r[n]],null,!0)););return i}:function(e){return e=e[o],s===e&&(0!==s||1/s==1/e)}},g.curry=function(e,t){return t="number"==typeof t?t:+t||e.length,he(e,4,null,null,null,t)},g.debounce=Ye,g.defaults=Zt,g.defer=function(e){if(!xe(e))throw new lt;var t=d(arguments,1);return $t(function(){e.apply(f,t)},1)},g.delay=function(e,t){if(!xe(e))throw new lt;var n=d(arguments,2);return $t(function(){e.apply(f,n)},t)},g.difference=function(e){return ie(e,oe(arguments,!0,!0,1))},g.filter=De,g.flatten=function(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(e=Me(e,n,i)),oe(e,t)},g.forEach=Oe,g.forEachRight=Ie,g.forIn=en,g.forInRight=function(e,t,n){var i=[];en(e,function(e,t){i.push(t,e)});var r=i.length;for(t=te(t,n,3);r--&&!1!==t(i[r--],i[r],e););return e},g.forOwn=tn,g.forOwnRight=ye,g.functions=we,g.groupBy=on,g.indexBy=sn,g.initial=function(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=g.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else i=null==t||n?1:t||i;return d(e,0,Pt(Mt(0,r-i),r))},g.intersection=function(){for(var n=[],i=-1,r=arguments.length,s=a(),l=fe(),c=l===e,d=a();++i<r;){var p=arguments[i];(Ht(p)||be(p))&&(n.push(p),s.push(c&&p.length>=w&&o(i?n[i]:d)))}var c=n[0],f=-1,g=c?c.length:0,m=[];e:for(;++f<g;){var v=s[0],p=c[f];if(0>(v?t(v,p):l(d,p))){for(i=r,(v||d).push(p);--i;)if(v=s[i],0>(v?t(v,p):l(n[i],p)))continue e;m.push(p)}}for(;r--;)(v=s[r])&&h(v);return u(s),u(d),m},g.invert=_e,g.invoke=function(e,t){var n=d(arguments,2),i=-1,r="function"==typeof t,o=e?e.length:0,s=Ze("number"==typeof o?o:0);return Oe(e,function(e){s[++i]=(r?t:e[t]).apply(e,n)}),s},g.keys=Bt,g.map=Me,g.mapValues=function(e,t,n){var i={};return t=g.createCallback(t,n,3),tn(e,function(e,n,r){i[n]=t(e,n,r)}),i},g.max=Pe,g.memoize=function(e,t){if(!xe(e))throw new lt;var n=function(){var i=n.cache,r=t?t.apply(this,arguments):y+arguments[0];return _t.call(i,r)?i[r]:i[r]=e.apply(this,arguments)};return n.cache={},n},g.merge=function(e){var t=arguments,n=2;if(!Ce(e))return e;if("number"!=typeof t[2]&&(n=t.length),n>3&&"function"==typeof t[n-2])var i=te(t[--n-1],t[n--],2);else n>2&&"function"==typeof t[n-1]&&(i=t[--n]);for(var t=d(arguments,1,n),r=-1,o=a(),s=a();++r<n;)ae(e,t[r],i,o,s);return u(o),u(s),e},g.min=function(e,t,n){var r=1/0,o=r;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&Ht(e)){n=-1;for(var s=e.length;++n<s;){var a=e[n];o>a&&(o=a)}}else t=null==t&&ke(e)?i:g.createCallback(t,n,3),Qt(e,function(e,n,i){n=t(e,n,i),r>n&&(r=n,o=e)});return o},g.omit=function(e,t,n){var i={};if("function"!=typeof t){var r=[];en(e,function(e,t){r.push(t)});for(var r=ie(r,oe(arguments,!0,!1,1)),o=-1,s=r.length;++o<s;){var a=r[o];i[a]=e[a]}}else t=g.createCallback(t,n,3),en(e,function(e,n,r){t(e,n,r)||(i[n]=e)});return i},g.once=function(e){var t,n;if(!xe(e))throw new lt;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},g.pairs=function(e){for(var t=-1,n=Bt(e),i=n.length,r=Ze(i);++t<i;){var o=n[t];r[t]=[o,e[o]]}return r},g.partial=function(e){return he(e,16,d(arguments,1))},g.partialRight=function(e){return he(e,32,null,d(arguments,1))},g.pick=function(e,t,n){var i={};if("function"!=typeof t)for(var r=-1,o=oe(arguments,!0,!1,1),s=Ce(e)?o.length:0;++r<s;){var a=o[r];a in e&&(i[a]=e[a])}else t=g.createCallback(t,n,3),en(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i},g.pluck=an,g.property=Qe,g.pull=function(e){for(var t=arguments,n=0,i=t.length,r=e?e.length:0;++n<i;)for(var o=-1,s=t[n];++o<r;)e[o]===s&&(kt.call(e,o--,1),r--);return e},g.range=function(e,t,n){e=+e||0,n="number"==typeof n?n:+n||1,null==t&&(t=e,e=0);var i=-1;t=Mt(0,mt((t-e)/(n||1)));for(var r=Ze(t);++i<t;)r[i]=e,e+=n;return r},g.reject=function(e,t,n){return t=g.createCallback(t,n,3),De(e,function(e,n,i){return!t(e,n,i)})},g.remove=function(e,t,n){var i=-1,r=e?e.length:0,o=[];for(t=g.createCallback(t,n,3);++i<r;)n=e[i],t(n,i,e)&&(o.push(n),kt.call(e,i--,1),r--);return o},g.rest=He,g.shuffle=Fe,g.sortBy=function(e,t,n){var i=-1,o=Ht(t),s=e?e.length:0,c=Ze("number"==typeof s?s:0);for(o||(t=g.createCallback(t,n,3)),Oe(e,function(e,n,r){var s=c[++i]=l();o?s.m=Me(t,function(t){return e[t]}):(s.m=a())[0]=t(e,n,r),s.n=i,s.o=e}),s=c.length,c.sort(r);s--;)e=c[s],c[s]=e.o,o||u(e.m),h(e);return c},g.tap=function(e,t){return t(e),e},g.throttle=function(e,t,n){var i=!0,r=!0;if(!xe(e))throw new lt;return!1===n?i=!1:Ce(n)&&(i="leading"in n?n.leading:i,r="trailing"in n?n.trailing:r),G.leading=i,G.maxWait=t,G.trailing=r,Ye(e,t,G)},g.times=function(e,t,n){e=-1<(e=+e)?e:0;var i=-1,r=Ze(e);for(t=te(t,n,1);++i<e;)r[i]=t(i);return r},g.toArray=function(e){return e&&"number"==typeof e.length?jt.unindexedChars&&ke(e)?e.split(""):d(e):Se(e)},g.transform=function(e,t,n,i){var r=Ht(e);if(null==n)if(r)n=[];else{var o=e&&e.constructor;n=ee(o&&o.prototype)}return t&&(t=g.createCallback(t,i,4),(r?Qt:tn)(e,function(e,i,r){return t(n,e,i,r)})),n},g.union=function(){return ce(oe(arguments,!0,!0))},g.uniq=Be,g.values=Se,g.where=De,g.without=function(e){return ie(e,d(arguments,1))},g.wrap=function(e,t){return he(t,16,[e])},g.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(Ht(n)||be(n))var i=i?ce(ie(i,n).concat(ie(n,i))):n}return i||[]},g.zip=ze,g.zipObject=qe,g.collect=Me,g.drop=He,g.each=Oe,g.eachRight=Ie,g.extend=Jt,g.methods=we,g.object=qe,g.select=De,g.tail=He,g.unique=Be,g.unzip=ze,Ke(g),g.clone=function(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),J(e,t,"function"==typeof n&&te(n,i,1))},g.cloneDeep=function(e,t,n){return J(e,!0,"function"==typeof t&&te(t,n,1))},g.contains=Te,g.escape=function(e){return null==e?"":at(e).replace(Xt,pe)},g.every=Ee,g.find=Ae,g.findIndex=function(e,t,n){var i=-1,r=e?e.length:0;for(t=g.createCallback(t,n,3);++i<r;)if(t(e[i],i,e))return i;return-1},g.findKey=function(e,t,n){var i;return t=g.createCallback(t,n,3),tn(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i},g.findLast=function(e,t,n){var i;return t=g.createCallback(t,n,3),Ie(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i},g.findLastIndex=function(e,t,n){var i=e?e.length:0;for(t=g.createCallback(t,n,3);i--;)if(t(e[i],i,e))return i;return-1},g.findLastKey=function(e,t,n){var i;return t=g.createCallback(t,n,3),ye(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i},g.has=function(e,t){return e?_t.call(e,t):!1},g.identity=Ge,g.indexOf=Ue,g.isArguments=be,g.isArray=Ht,g.isBoolean=function(e){return!0===e||!1===e||e&&"object"==typeof e&&ft.call(e)==j||!1},g.isDate=function(e){return e&&"object"==typeof e&&ft.call(e)==U||!1},g.isElement=function(e){return e&&1===e.nodeType||!1},g.isEmpty=function(e){var t=!0;if(!e)return t;var n=ft.call(e),i=e.length;return n==L||n==V||(jt.argsClass?n==F:be(e))||n==z&&"number"==typeof i&&xe(e.splice)?!i:(tn(e,function(){return t=!1}),t)},g.isEqual=function(e,t,n,i){return se(e,t,"function"==typeof n&&te(n,i,2))},g.isFinite=function(e){return At(e)&&!Ot(parseFloat(e))},g.isFunction=xe,g.isNaN=function(e){return $e(e)&&e!=+e},g.isNull=function(e){return null===e},g.isNumber=$e,g.isObject=Ce,g.isPlainObject=nn,g.isRegExp=function(e){return e&&Q[typeof e]&&ft.call(e)==q||!1},g.isString=ke,g.isUndefined=function(e){return"undefined"==typeof e},g.lastIndexOf=function(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(0>n?Mt(0,i+n):Pt(n,i-1))+1);i--;)if(e[i]===t)return i;return-1},g.mixin=Ke,g.noConflict=function(){return n._=pt,this},g.noop=Xe,g.now=ln,g.parseInt=cn,g.random=function(e,t,n){var i=null==e,r=null==t;return null==n&&("boolean"==typeof e&&r?(n=e,e=1):r||"boolean"!=typeof t||(n=t,r=!0)),i&&r&&(t=1),e=+e||0,r?(t=e,e=0):t=+t||0,n||e%1||t%1?(n=Nt(),Pt(e+n*(t-e+parseFloat("1e-"+((n+"").length-1))),t)):le(e,t)},g.reduce=Re,g.reduceRight=Ne,g.result=function(e,t){if(e){var n=e[t];return xe(n)?e[t]():n}},g.runInContext=p,g.size=function(e){var t=e?e.length:0;return"number"==typeof t?t:Bt(e).length},g.some=Le,g.sortedIndex=We,g.template=function(e,t,n){var i=g.templateSettings;e=at(e||""),n=Zt({},n,i);var r,o=Zt({},n.imports,i.imports),i=Bt(o),o=Se(o),a=0,l=n.interpolate||I,c="__p+='",l=st((n.escape||I).source+"|"+l.source+"|"+(l===A?T:I).source+"|"+(n.evaluate||I).source+"|$","g");e.replace(l,function(t,n,i,o,l,u){return i||(i=o),c+=e.slice(a,u).replace(P,s),n&&(c+="'+__e("+n+")+'"),l&&(r=!0,c+="';"+l+";\n__p+='"),i&&(c+="'+((__t=("+i+"))==null?'':__t)+'"),a=u+t.length,t}),c+="';",l=n=n.variable,l||(n="obj",c="with("+n+"){"+c+"}"),c=(r?c.replace(C,""):c).replace($,"$1").replace(S,"$1;"),c="function("+n+"){"+(l?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(r?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+c+"return __p}";try{var u=nt(i,"return "+c).apply(f,o)}catch(h){throw h.source=c,h}return t?u(t):(u.source=c,u)},g.unescape=function(e){return null==e?"":at(e).replace(Kt,ve)},g.uniqueId=function(e){var t=++v;return at(null==e?"":e)+t},g.all=Ee,g.any=Le,g.detect=Ae,g.findWhere=Ae,g.foldl=Re,g.foldr=Ne,g.include=Te,g.inject=Re,Ke(function(){var e={};return tn(g,function(t,n){g.prototype[n]||(e[n]=t)}),e}(),!1),g.first=je,g.last=function(e,t,n){var i=0,r=e?e.length:0;if("number"!=typeof t&&null!=t){var o=r;for(t=g.createCallback(t,n,3);o--&&t(e[o],o,e);)i++}else if(i=t,null==i||n)return e?e[r-1]:f;return d(e,Mt(0,r-i))},g.sample=function(e,t,n){return e&&"number"!=typeof e.length?e=Se(e):jt.unindexedChars&&ke(e)&&(e=e.split("")),null==t||n?e?e[le(0,e.length-1)]:f:(e=Fe(e),e.length=Pt(Mt(0,t),e.length),e)},g.take=je,g.head=je,tn(g,function(e,t){var n="sample"!==t;g.prototype[t]||(g.prototype[t]=function(t,i){var r=this.__chain__,o=e(this.__wrapped__,t,i);return r||null!=t&&(!i||n&&"function"==typeof t)?new m(o,r):o})}),g.VERSION="2.4.1",g.prototype.chain=function(){return this.__chain__=!0,this},g.prototype.toString=function(){return at(this.__wrapped__)},g.prototype.value=Je,g.prototype.valueOf=Je,Qt(["join","pop","shift"],function(e){var t=ct[e];g.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new m(n,e):n}}),Qt(["push","reverse","sort","unshift"],function(e){var t=ct[e];g.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Qt(["concat","slice","splice"],function(e){var t=ct[e];g.prototype[e]=function(){return new m(t.apply(this.__wrapped__,arguments),this.__chain__)}}),jt.spliceObjects||Qt(["pop","shift","splice"],function(e){var t=ct[e],n="splice"==e;g.prototype[e]=function(){var e=this.__chain__,i=this.__wrapped__,r=t.apply(i,arguments);return 0===i.length&&delete i[0],e||n?new m(r,e):r}}),g}var f,g=[],m=[],v=0,b={},y=+new Date+"",w=75,_=40,x=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",C=/\b__p\+='';/g,$=/\b(__p\+=)''\+/g,S=/(__e\(.*?\)|\b__t\))\+'';/g,T=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,E=/\w*$/,D=/^\s*function[ \n\r\t]+\w/,A=/<%=([\s\S]+?)%>/g,O=RegExp("^["+x+"]*0+(?=.$)"),I=/($^)/,M=/\bthis\b/,P=/['\n\r\t\u2028\u2029\\]/g,R="Array Boolean Date Error Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),F="[object Arguments]",L="[object Array]",j="[object Boolean]",U="[object Date]",H="[object Error]",W="[object Function]",B="[object Number]",z="[object Object]",q="[object RegExp]",V="[object String]",Y={};Y[W]=!1,Y[F]=Y[L]=Y[j]=Y[U]=Y[B]=Y[z]=Y[q]=Y[V]=!0;var G={leading:!1,maxWait:0,trailing:!1},K={configurable:!1,enumerable:!1,value:null,writable:!1},X={a:"",b:null,c:"",d:"",e:"",v:null,g:"",h:null,support:null,i:"",j:!1},Q={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},J={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},Z=Q[typeof window]&&window||this,ee=Q[typeof exports]&&exports&&!exports.nodeType&&exports,te=Q[typeof module]&&module&&!module.nodeType&&module,ne=te&&te.exports===ee&&ee,ie=Q[typeof global]&&global;!ie||ie.global!==ie&&ie.window!==ie||(Z=ie);var re=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Z._=re,define(function(){return re})):ee&&te?ne?(te.exports=re)._=re:ee._=re:Z._=re}.call(this),!function(){var e=angular.module("restangular",[]);e.provider("Restangular",function(){var e={};e.init=function(e,t){function n(e,t,n,i){var r={};return _.each(_.keys(i),function(o){var s=i[o];s.params=_.extend({},s.params,e.defaultRequestParams[s.method.toLowerCase()]),_.isEmpty(s.params)&&delete s.params,r[o]=e.isSafe(s.method)?function(){return t(_.extend(s,{url:n}))}:function(e){return t(_.extend(s,{url:n,data:e}))}}),r}e.configuration=t;var i=["get","head","options","trace","getlist"];t.isSafe=function(e){return _.contains(i,e.toLowerCase())};var r=/^https?:\/\//i;t.isAbsoluteUrl=function(e){return _.isUndefined(t.absoluteUrl)||_.isNull(t.absoluteUrl)?e&&r.test(e):t.absoluteUrl},t.absoluteUrl=_.isUndefined(t.absoluteUrl)?!0:t.absoluteUrl,e.setSelfLinkAbsoluteUrl=function(e){t.absoluteUrl=e},t.baseUrl=_.isUndefined(t.baseUrl)?"":t.baseUrl,e.setBaseUrl=function(e){return t.baseUrl=/\/$/.test(e)?e.substring(0,e.length-1):e,this},t.extraFields=t.extraFields||[],e.setExtraFields=function(e){return t.extraFields=e,this},t.defaultHttpFields=t.defaultHttpFields||{},e.setDefaultHttpFields=function(e){return t.defaultHttpFields=e,this},t.withHttpValues=function(e,n){return _.defaults(n,e,t.defaultHttpFields)},t.encodeIds=_.isUndefined(t.encodeIds)?!0:t.encodeIds,e.setEncodeIds=function(e){t.encodeIds=e},t.defaultRequestParams=t.defaultRequestParams||{get:{},post:{},put:{},remove:{},common:{}},e.setDefaultRequestParams=function(e,n){var i=[],r=n||e;return _.isUndefined(n)?i.push("common"):_.isArray(e)?i=e:i.push(e),_.each(i,function(e){t.defaultRequestParams[e]=r}),this},e.requestParams=t.defaultRequestParams,t.defaultHeaders=t.defaultHeaders||{},e.setDefaultHeaders=function(n){return t.defaultHeaders=n,e.defaultHeaders=t.defaultHeaders,this},e.defaultHeaders=t.defaultHeaders,t.methodOverriders=t.methodOverriders||[],e.setMethodOverriders=function(e){var n=_.extend([],e);return t.isOverridenMethod("delete",n)&&n.push("remove"),t.methodOverriders=n,this},t.jsonp=_.isUndefined(t.jsonp)?!1:t.jsonp,e.setJsonp=function(e){t.jsonp=e},t.isOverridenMethod=function(e,n){var i=n||t.methodOverriders;return!_.isUndefined(_.find(i,function(t){return t.toLowerCase()===e.toLowerCase()}))},t.urlCreator=t.urlCreator||"path",e.setUrlCreator=function(e){if(!_.has(t.urlCreatorFactory,e))throw new Error("URL Path selected isn't valid");return t.urlCreator=e,this},t.restangularFields=t.restangularFields||{id:"id",route:"route",parentResource:"parentResource",restangularCollection:"restangularCollection",cannonicalId:"__cannonicalId",etag:"restangularEtag",selfLink:"href",get:"get",getList:"getList",put:"put",post:"post",remove:"remove",head:"head",trace:"trace",options:"options",patch:"patch",getRestangularUrl:"getRestangularUrl",getRequestedUrl:"getRequestedUrl",putElement:"putElement",addRestangularMethod:"addRestangularMethod",getParentList:"getParentList",clone:"clone",ids:"ids",httpConfig:"_$httpConfig",reqParams:"reqParams",one:"one",all:"all",several:"several",oneUrl:"oneUrl",allUrl:"allUrl",customPUT:"customPUT",customPOST:"customPOST",customDELETE:"customDELETE",customGET:"customGET",customGETLIST:"customGETLIST",customOperation:"customOperation",doPUT:"doPUT",doPOST:"doPOST",doDELETE:"doDELETE",doGET:"doGET",doGETLIST:"doGETLIST",fromServer:"fromServer",withConfig:"withConfig",withHttpConfig:"withHttpConfig",singleOne:"singleOne",plain:"plain",save:"save"},e.setRestangularFields=function(e){return t.restangularFields=_.extend(t.restangularFields,e),this},t.isRestangularized=function(e){return!!e[t.restangularFields.one]||!!e[t.restangularFields.all]},t.setFieldToElem=function(e,t,n){var i=e.split("."),r=t;return _.each(_.initial(i),function(e){r[e]={},r=r[e]}),r[_.last(i)]=n,this},t.getFieldFromElem=function(e,t){var n=e.split("."),i=t;return _.each(n,function(e){i&&(i=i[e])}),angular.copy(i)},t.setIdToElem=function(e,n){return t.setFieldToElem(t.restangularFields.id,e,n),this},t.getIdFromElem=function(e){return t.getFieldFromElem(t.restangularFields.id,e)},t.isValidId=function(e){return""!==e&&!_.isUndefined(e)&&!_.isNull(e)},t.setUrlToElem=function(e,n){return t.setFieldToElem(t.restangularFields.selfLink,e,n),this},t.getUrlFromElem=function(e){return t.getFieldFromElem(t.restangularFields.selfLink,e)},t.useCannonicalId=_.isUndefined(t.useCannonicalId)?!1:t.useCannonicalId,e.setUseCannonicalId=function(e){return t.useCannonicalId=e,this},t.getCannonicalIdFromElem=function(e){var n=e[t.restangularFields.cannonicalId],i=t.isValidId(n)?n:t.getIdFromElem(e);return i},t.responseInterceptors=t.responseInterceptors||[],t.defaultResponseInterceptor=function(e){return e},t.responseExtractor=function(e,n,i,r,o,s){var a=angular.copy(t.responseInterceptors);a.push(t.defaultResponseInterceptor);var l=e;return _.each(a,function(e){l=e(l,n,i,r,o,s)}),l},e.addResponseInterceptor=function(e){return t.responseInterceptors.push(e),this},e.setResponseInterceptor=e.addResponseInterceptor,e.setResponseExtractor=e.addResponseInterceptor,t.requestInterceptors=t.requestInterceptors||[],t.defaultInterceptor=function(e,t,n,i,r,o,s){return{element:e,headers:r,params:o,httpConfig:s}},t.fullRequestInterceptor=function(e,n,i,r,o,s,a){var l=angular.copy(t.requestInterceptors),c=t.defaultInterceptor(e,n,i,r,o,s,a);return _.reduce(l,function(e,t){return _.extend(e,t(e.element,n,i,r,e.headers,e.params,e.httpConfig))},c)},e.addRequestInterceptor=function(e){return t.requestInterceptors.push(function(t,n,i,r,o,s,a){return{headers:o,params:s,element:e(t,n,i,r),httpConfig:a}}),this},e.setRequestInterceptor=e.addRequestInterceptor,e.addFullRequestInterceptor=function(e){return t.requestInterceptors.push(e),this},e.setFullRequestInterceptor=e.addFullRequestInterceptor,t.errorInterceptor=t.errorInterceptor||function(){},e.setErrorInterceptor=function(e){return t.errorInterceptor=e,this},t.onBeforeElemRestangularized=t.onBeforeElemRestangularized||function(e){return e},e.setOnBeforeElemRestangularized=function(e){return t.onBeforeElemRestangularized=e,this},t.onElemRestangularized=t.onElemRestangularized||function(e){return e},e.setOnElemRestangularized=function(e){return t.onElemRestangularized=e,this},t.shouldSaveParent=t.shouldSaveParent||function(){return!0},e.setParentless=function(e){return _.isArray(e)?t.shouldSaveParent=function(t){return!_.contains(e,t)}:_.isBoolean(e)&&(t.shouldSaveParent=function(){return!e}),this},t.suffix=_.isUndefined(t.suffix)?null:t.suffix,e.setRequestSuffix=function(e){return t.suffix=e,this},t.transformers=t.transformers||{},e.addElementTransformer=function(n,i,r){var o=null,s=null;2===arguments.length?s=i:(s=r,o=i);var a=t.transformers[n];return a||(a=t.transformers[n]=[]),a.push(function(e,t){return _.isNull(o)||e==o?s(t):t}),e},e.extendCollection=function(t,n){return e.addElementTransformer(t,!0,n)},e.extendModel=function(t,n){return e.addElementTransformer(t,!1,n)},t.transformElem=function(e,n,i,r,o){if(!o&&!t.transformLocalElements&&!e[t.restangularFields.fromServer])return e;var s=t.transformers[i],a=e;return s&&_.each(s,function(e){a=e(n,a)}),t.onElemRestangularized(a,n,i,r)},t.transformLocalElements=_.isUndefined(t.transformLocalElements)?!1:t.transformLocalElements,e.setTransformOnlyServerElements=function(e){t.transformLocalElements=!e},t.fullResponse=_.isUndefined(t.fullResponse)?!1:t.fullResponse,e.setFullResponse=function(e){return t.fullResponse=e,this},t.urlCreatorFactory={};var o=function(){};o.prototype.setConfig=function(e){return this.config=e,this},o.prototype.parentsArray=function(e){for(var t=[];e;)t.push(e),e=e[this.config.restangularFields.parentResource];return t.reverse()},o.prototype.resource=function(e,i,r,o,s,a,l,c){var u=_.defaults(s||{},this.config.defaultRequestParams.common),h=_.defaults(o||{},this.config.defaultHeaders);l&&(t.isSafe(c)?h["If-None-Match"]=l:h["If-Match"]=l);var d=this.base(e);if(a){var p="";/\/$/.test(d)||(p+="/"),p+=a,d+=p}return this.config.suffix&&-1===d.indexOf(this.config.suffix,d.length-this.config.suffix.length)&&!this.config.getUrlFromElem(e)&&(d+=this.config.suffix),e[this.config.restangularFields.httpConfig]=void 0,n(this.config,i,d,{getList:this.config.withHttpValues(r,{method:"GET",params:u,headers:h}),get:this.config.withHttpValues(r,{method:"GET",params:u,headers:h}),jsonp:this.config.withHttpValues(r,{method:"jsonp",params:u,headers:h}),put:this.config.withHttpValues(r,{method:"PUT",params:u,headers:h}),post:this.config.withHttpValues(r,{method:"POST",params:u,headers:h}),remove:this.config.withHttpValues(r,{method:"DELETE",params:u,headers:h}),head:this.config.withHttpValues(r,{method:"HEAD",params:u,headers:h}),trace:this.config.withHttpValues(r,{method:"TRACE",params:u,headers:h}),options:this.config.withHttpValues(r,{method:"OPTIONS",params:u,headers:h}),patch:this.config.withHttpValues(r,{method:"PATCH",params:u,headers:h})})};var s=function(){};s.prototype=new o,s.prototype.base=function(e){var n=this;return _.reduce(this.parentsArray(e),function(e,i){var r,o=n.config.getUrlFromElem(i);if(o){if(n.config.isAbsoluteUrl(o))return o;r=o}else if(r=i[n.config.restangularFields.route],i[n.config.restangularFields.restangularCollection]){var s=i[n.config.restangularFields.ids];s&&(r+="/"+s.join(","))}else{var a;a=n.config.useCannonicalId?n.config.getCannonicalIdFromElem(i):n.config.getIdFromElem(i),t.isValidId(a)&&!i.singleOne&&(r+="/"+(n.config.encodeIds?encodeURIComponent(a):a))}return e.replace(/\/$/,"")+"/"+r},this.config.baseUrl)},s.prototype.fetchUrl=function(e,t){var n=this.base(e);return t&&(n+="/"+t),n},s.prototype.fetchRequestedUrl=function(e,n){function i(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.sort()}function r(e,t,n){for(var r=i(e),o=0;o<r.length;o++)t.call(n,e[r[o]],r[o]);return r}function o(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}var s=this.fetchUrl(e,n),a=e[t.restangularFields.reqParams];if(!a)return s;var l=[];return r(a,function(e,t){null!=e&&void 0!=e&&(angular.isArray(e)||(e=[e]),angular.forEach(e,function(e){angular.isObject(e)&&(e=angular.toJson(e)),l.push(o(t)+"="+o(e))}))}),s+(this.config.suffix||"")+(-1===s.indexOf("?")?"?":"&")+l.join("&")},t.urlCreatorFactory.path=s};var t={};e.init(this,t),this.$get=["$http","$q",function(n,i){function r(t){function o(e,n,i,r,o){if(n[t.restangularFields.route]=i,n[t.restangularFields.getRestangularUrl]=_.bind(W.fetchUrl,W,n),n[t.restangularFields.getRequestedUrl]=_.bind(W.fetchRequestedUrl,W,n),n[t.restangularFields.addRestangularMethod]=_.bind(L,n),n[t.restangularFields.clone]=_.bind(v,n,n),n[t.restangularFields.reqParams]=_.isEmpty(r)?null:r,n[t.restangularFields.withHttpConfig]=_.bind(S,n),n[t.restangularFields.plain]=_.bind(g,n,n),n[t.restangularFields.one]=_.bind(s,n,n),n[t.restangularFields.all]=_.bind(a,n,n),n[t.restangularFields.several]=_.bind(l,n,n),n[t.restangularFields.oneUrl]=_.bind(c,n,n),n[t.restangularFields.allUrl]=_.bind(u,n,n),n[t.restangularFields.fromServer]=!!o,e&&t.shouldSaveParent(i)){var h=t.getIdFromElem(e),d=t.getUrlFromElem(e),p=_.union(_.values(_.pick(t.restangularFields,["route","singleOne","parentResource"])),t.extraFields),f=_.pick(e,p);t.isValidId(h)&&t.setIdToElem(f,h),t.isValidId(d)&&t.setUrlToElem(f,d),n[t.restangularFields.parentResource]=f}else n[t.restangularFields.parentResource]=null;return n}function s(e,n,i,r){if(_.isNumber(n)||_.isNumber(e)){var o="You're creating a Restangular entity with the number ";throw o+="instead of the route or the parent. You can't call .one(12)",new Error(o)}var s={};return t.setIdToElem(s,i),t.setFieldToElem(t.restangularFields.singleOne,s,r),b(e,s,n,!1)}function a(e,t){return y(e,[],t,!1)}function l(e,n){var i=[];return i[t.restangularFields.ids]=Array.prototype.splice.call(arguments,2),y(e,i,n,!1)}function c(e,n,i){if(!n)throw new Error("Route is mandatory when creating new Restangular objects.");var r={};return t.setUrlToElem(r,i,n),b(e,r,n,!1)}function u(e,n,i){if(!n)throw new Error("Route is mandatory when creating new Restangular objects.");var r={};return t.setUrlToElem(r,i,n),y(e,r,n,!1)}function h(e,n,i){return e.call=_.bind(d,e),e.get=_.bind(p,e),e[t.restangularFields.restangularCollection]=n,n&&(e.push=_.bind(d,e,"push")),e.$object=i,e}function d(e){var n=i.defer(),r=arguments,o={};return this.then(function(t){var i=Array.prototype.slice.call(r,1),s=t[e];s.apply(t,i),o=t,n.resolve(t)}),h(n.promise,this[t.restangularFields.restangularCollection],o)}function p(e){var n=i.defer(),r={};return this.then(function(t){r=t[e],n.resolve(r)}),h(n.promise,this[t.restangularFields.restangularCollection],r)}function f(e,n,i,r){return _.extend(r,i),t.fullResponse?e.resolve(_.extend(n,{data:i})):void e.resolve(i)}function g(e){if(_.isArray(e)){var n=[];return _.each(e,function(e){n.push(g(e))}),n}return _.omit(e,_.values(_.omit(t.restangularFields,"id")))}function m(e){e[t.restangularFields.customOperation]=_.bind(F,e),_.each(["put","post","get","delete"],function(t){_.each(["do","custom"],function(n){var i,r="delete"===t?"remove":t,o=n+t.toUpperCase();i="put"!==r&&"post"!==r?F:function(e,t,n,i,r){return _.bind(F,this)(e,n,i,r,t)},e[o]=_.bind(i,e,r)})}),e[t.restangularFields.customGETLIST]=_.bind(k,e),e[t.restangularFields.doGETLIST]=e[t.restangularFields.customGETLIST]}function v(e,n){var i=angular.copy(e,n);return b(i[t.restangularFields.parentResource],i,i[t.restangularFields.route],!0)}function b(e,n,i,r,s,a){var l=t.onBeforeElemRestangularized(n,!1,i),c=o(e,l,i,a,r);return t.useCannonicalId&&(c[t.restangularFields.cannonicalId]=t.getIdFromElem(c)),s&&(c[t.restangularFields.getParentList]=function(){return s}),c[t.restangularFields.restangularCollection]=!1,c[t.restangularFields.get]=_.bind(D,c),c[t.restangularFields.getList]=_.bind(k,c),c[t.restangularFields.put]=_.bind(O,c),c[t.restangularFields.post]=_.bind(I,c),c[t.restangularFields.remove]=_.bind(A,c),c[t.restangularFields.head]=_.bind(M,c),c[t.restangularFields.trace]=_.bind(P,c),c[t.restangularFields.options]=_.bind(R,c),c[t.restangularFields.patch]=_.bind(N,c),c[t.restangularFields.save]=_.bind(T,c),m(c),t.transformElem(c,!1,i,H,!0)}function y(e,n,i,r,s){var a=t.onBeforeElemRestangularized(n,!0,i),l=o(e,a,i,s,r);return l[t.restangularFields.restangularCollection]=!0,l[t.restangularFields.post]=_.bind(I,l,null),l[t.restangularFields.remove]=_.bind(A,l),l[t.restangularFields.head]=_.bind(M,l),l[t.restangularFields.trace]=_.bind(P,l),l[t.restangularFields.putElement]=_.bind(C,l),l[t.restangularFields.options]=_.bind(R,l),l[t.restangularFields.patch]=_.bind(N,l),l[t.restangularFields.get]=_.bind(x,l),l[t.restangularFields.getList]=_.bind(k,l,null),m(l),t.transformElem(l,!0,i,H,!0)}function w(e,t,n){var i=y(e,t,n,!1);return _.each(i,function(t){b(e,t,n,!1)}),i}function x(e,t,n){return this.customGET(e.toString(),t,n)}function C(e,n,r){var o=this,s=this[e],a=i.defer(),l=[];return l=t.transformElem(l,!0,s[t.restangularFields.route],H),s.put(n,r).then(function(t){var n=v(o);n[e]=t,l=n,a.resolve(n)},function(e){a.reject(e)}),h(a.promise,!0,l)}function $(e,n,i,r,o,s){var a=t.responseExtractor(e,n,i,r,o,s),l=o.headers("ETag");return a&&l&&(a[t.restangularFields.etag]=l),a}function k(e,r,o){var s=this,a=i.defer(),l="getList",c=W.fetchUrl(this,e),u=e||s[t.restangularFields.route],d=t.fullRequestInterceptor(null,l,u,c,o||{},r||{},this[t.restangularFields.httpConfig]||{}),p=[];p=t.transformElem(p,!0,u,H);var g="getList";return t.jsonp&&(g="jsonp"),W.resource(this,n,d.httpConfig,d.headers,d.params,e,this[t.restangularFields.etag],l)[g]().then(function(n){var i=n.data,r=n.config.params,o=$(i,l,u,c,n,a);if((_.isUndefined(o)||""===o)&&(o=[]),!_.isArray(o))throw new Error("Response for getList SHOULD be an array and not an object or something else");var h=_.map(o,function(n){return s[t.restangularFields.restangularCollection]?b(s[t.restangularFields.parentResource],n,s[t.restangularFields.route],!0,o):b(s,n,e,!0,o)});h=_.extend(o,h),s[t.restangularFields.restangularCollection]?f(a,n,y(s[t.restangularFields.parentResource],h,s[t.restangularFields.route],!0,r),p):f(a,n,y(s,h,e,!0,r),p)},function(e){304===e.status&&s[t.restangularFields.restangularCollection]?f(a,e,s,p):t.errorInterceptor(e,a)!==!1&&a.reject(e)}),h(a.promise,!0,p)}function S(e){return this[t.restangularFields.httpConfig]=e,this}function T(e,n){return this[t.restangularFields.fromServer]?this[t.restangularFields.put](e,n):_.bind(E,this)("post",void 0,e,void 0,n)}function E(e,r,o,s,a){var l=this,c=i.defer(),u=o||{},d=r||this[t.restangularFields.route],p=W.fetchUrl(this,r),m=s||this,v=m[t.restangularFields.etag]||("post"!=e?this[t.restangularFields.etag]:null);_.isObject(m)&&t.isRestangularized(m)&&(m=g(m));var y=t.fullRequestInterceptor(m,e,d,p,a||{},u||{},this[t.restangularFields.httpConfig]||{}),w={};w=t.transformElem(w,!1,d,H);var x=function(n){var i=n.data,o=n.config.params,s=$(i,e,d,p,n,c);s?"post"!==e||l[t.restangularFields.restangularCollection]?(data=b(l[t.restangularFields.parentResource],s,l[t.restangularFields.route],!0,null,o),data[t.restangularFields.singleOne]=l[t.restangularFields.singleOne],f(c,n,data,w)):f(c,n,b(l,s,r,!0,null,o),w):f(c,n,void 0,w)},C=function(n){304===n.status&&t.isSafe(e)?f(c,n,l,w):t.errorInterceptor(n,c)!==!1&&c.reject(n)},k=e,S=_.extend({},y.headers),T=t.isOverridenMethod(e);return T?(k="post",S=_.extend(S,{"X-HTTP-Method-Override":"remove"===e?"DELETE":e})):t.jsonp&&"get"===k&&(k="jsonp"),t.isSafe(e)?T?W.resource(this,n,y.httpConfig,S,y.params,r,v,k)[k]({}).then(x,C):W.resource(this,n,y.httpConfig,S,y.params,r,v,k)[k]().then(x,C):W.resource(this,n,y.httpConfig,S,y.params,r,v,k)[k](y.element).then(x,C),
h(c.promise,!1,w)}function D(e,t){return _.bind(E,this)("get",void 0,e,void 0,t)}function A(e,t){return _.bind(E,this)("remove",void 0,e,void 0,t)}function O(e,t){return _.bind(E,this)("put",void 0,e,void 0,t)}function I(e,t,n,i){return _.bind(E,this)("post",e,n,t,i)}function M(e,t){return _.bind(E,this)("head",void 0,e,void 0,t)}function P(e,t){return _.bind(E,this)("trace",void 0,e,void 0,t)}function R(e,t){return _.bind(E,this)("options",void 0,e,void 0,t)}function N(e,t,n){return _.bind(E,this)("patch",void 0,t,e,n)}function F(e,t,n,i,r){return _.bind(E,this)(e,t,n,r,i)}function L(e,n,i,r,o,s){var a;a="getList"===n?_.bind(k,this,i):_.bind(F,this,n,i);var l=function(e,t,n){var i=_.defaults({params:e,headers:t,elem:n},{params:r,headers:o,elem:s});return a(i.params,i.headers,i.elem)};this[e]=t.isSafe(n)?l:function(e,t,n){return l(t,n,e)}}function j(n){var i=angular.copy(_.omit(t,"configuration"));return e.init(i,i),n(i),r(i)}function U(e,t){var n={},i=(t||H).all(e);return n.one=_.bind(s,t||H,t,e),n.post=_.bind(i.post,i),n.getList=_.bind(i.getList,i),n}var H={},W=new t.urlCreatorFactory[t.urlCreator];return W.setConfig(t),e.init(H,t),H.copy=_.bind(v,H),H.service=_.bind(U,H),H.withConfig=_.bind(j,H),H.one=_.bind(s,H,null),H.all=_.bind(a,H,null),H.several=_.bind(l,H,null),H.oneUrl=_.bind(c,H,null),H.allUrl=_.bind(u,H,null),H.stripRestangular=_.bind(g,H),H.restangularizeElement=_.bind(b,H),H.restangularizeCollection=_.bind(w,H),H}return r(t)}]})}(),function(e,t){function n(t,n){var r,o,s,a=t.nodeName.toLowerCase();return"area"===a?(r=t.parentNode,o=r.name,t.href&&o&&"map"===r.nodeName.toLowerCase()?(s=e("img[usemap=#"+o+"]")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var r=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.10.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"==typeof t?this.each(function(){var i=this;setTimeout(function(){e(i).focus(),n&&n.call(i)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,r,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(r=parseInt(o.css("zIndex"),10),!isNaN(r)&&0!==r))return r;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function r(t,n,i,r){return e.each(o,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var o="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?a["inner"+i].call(this):this.each(function(){e(this).css(s,r(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(s,r(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n){var i,r=e.plugins[t];if(r&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return t[i]>0?!0:(t[i]=1,r=t[i]>0,t[i]=0,r)}}))}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(o){}r(t)},e.widget=function(t,n,i){var r,o,s,a,l={},c=t.split(".")[0];t=t.split(".")[1],r=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[c]=e[c]||{},o=e[c][t],s=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new n,a.options=e.widget.extend({},a.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(l[t]=i)}),s.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix:t},l,{constructor:s,namespace:c,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,s,n._proto)}),delete o._childConstructors):n._childConstructors.push(s),e.widget.bridge(t,s)},e.widget.extend=function(n){for(var r,o,s=i.call(arguments,1),a=0,l=s.length;l>a;a++)for(r in s[a])o=s[a][r],s[a].hasOwnProperty(r)&&o!==t&&(n[r]=e.isPlainObject(o)?e.isPlainObject(n[r])?e.widget.extend({},n[r],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,r){var o=r.prototype.widgetFullName||n;e.fn[n]=function(s){var a="string"==typeof s,l=i.call(arguments,1),c=this;return s=!a&&l.length?e.widget.extend.apply(null,[s].concat(l)):s,this.each(a?function(){var i,r=e.data(this,o);return r?e.isFunction(r[s])&&"_"!==s.charAt(0)?(i=r[s].apply(r,l),i!==r&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+s+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+s+"'")}:function(){var t=e.data(this,o);t?t.option(s||{})._init():e.data(this,o,new r(s,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var r,o,s,a=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(a={},r=n.split("."),n=r.shift(),r.length){for(o=a[n]=e.widget.extend({},this.options[n]),s=0;s<r.length-1;s++)o[r[s]]=o[r[s]]||{},o=o[r[s]];if(n=r.pop(),i===t)return o[n]===t?null:o[n];o[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];a[n]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,s){function a(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+o.eventNamespace,u=l[2];u?r.delegate(u,c,a):n.bind(c,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,o,s=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(s)&&s.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){"string"==typeof r&&(r={effect:r});var s,a=r?r===!0||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),s=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),s&&e.effects&&e.effects.effect[a]?i[t](r):a!==t&&i[a]?i[a](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}})}(jQuery),function(e,t){function n(){return++r}function i(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(o,""))===decodeURIComponent(location.href.replace(o,""))}var r=0,o=/#.*$/;e.widget("ui.tabs",{version:"1.10.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),n.active=this._initialActive(),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(n.active):e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,i=location.hash.substring(1);return null===t&&(i&&this.tabs.each(function(n,r){return e(r).attr("aria-controls")===i?(t=n,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=n?!1:0)),!n&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),i=this.tabs.index(n),r=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:i++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:r=!1,i--;break;case e.ui.keyCode.END:i=this.anchors.length-1;break;case e.ui.keyCode.HOME:i=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i===this.options.active?!1:i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,r),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){function i(){return t>r&&(t=0),0>t&&(t=r),t}for(var r=this.tabs.length-1;-1!==e.inArray(i(),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),!t&&this.options.active===!1&&this._activate(0)),"event"===e&&this._setupEvents(t),void("heightStyle"===e&&this._setupHeightStyle(t)))},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+n()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var o,s,a,l=e(r).uniqueId().attr("id"),c=e(r).closest("li"),u=c.attr("aria-controls");i(r)?(o=r.hash,s=t.element.find(t._sanitizeSelector(o))):(a=t._tabId(c),o="#"+a,s=t.element.find(o),s.length||(s=t._createPanel(a),s.insertAfter(t.panels[n-1]||t.tablist)),s.attr("aria-live","polite")),s.length&&(t.panels=t.panels.add(s)),u&&c.data("ui-tabs-aria-controls",u),c.attr({"aria-controls":o.substring(1),"aria-labelledby":l}),s.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n,i=0;n=this.tabs[i];i++)t===!0||-1!==e.inArray(i,t)?e(n).addClass("ui-state-disabled").attr("aria-disabled","true"):e(n).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,i=this.element.parent();"fill"===t?(n=i.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),i=t.css("position");"absolute"!==i&&"fixed"!==i&&(n-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,i=this.active,r=e(t.currentTarget),o=r.closest("li"),s=o[0]===i[0],a=s&&n.collapsible,l=a?e():this._getPanelForTab(o),c=i.length?this._getPanelForTab(i):e(),u={oldTab:i,oldPanel:c,newTab:a?e():o,newPanel:l};t.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||s&&!n.collapsible||this._trigger("beforeActivate",t,u)===!1||(n.active=a?!1:this.tabs.index(o),this.active=s?e():o,this.xhr&&this.xhr.abort(),!c.length&&!l.length&&e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(o),t),this._toggle(t,u))},_toggle:function(t,n){function i(){o.running=!1,o._trigger("activate",t,n)}function r(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),s.length&&o.options.show?o._show(s,o.options.show,i):(s.show(),i())}var o=this,s=n.newPanel,a=n.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),r()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),s.length&&a.length?n.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),s.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),n=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(n){var i=this.options.disabled;i!==!1&&(n===t?i=!1:(n=this._getIndex(n),i=e.isArray(i)?e.map(i,function(e){return e!==n?e:null}):e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(i))},disable:function(n){var i=this.options.disabled;if(i!==!0){if(n===t)i=!0;else{if(n=this._getIndex(n),-1!==e.inArray(n,i))return;i=e.isArray(i)?e.merge([n],i).sort():[n]}this._setupDisabled(i)}},load:function(t,n){t=this._getIndex(t);var r=this,o=this.tabs.eq(t),s=o.find(".ui-tabs-anchor"),a=this._getPanelForTab(o),l={tab:o,panel:a};i(s[0])||(this.xhr=e.ajax(this._ajaxSettings(s,n,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(o.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){a.html(e),r._trigger("load",n,l)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&r.panels.stop(!1,!0),o.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(t,n,i){var r=this;return{url:t.attr("href"),beforeSend:function(t,o){return r._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:o},i))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}})}(jQuery),function(e,t){function n(e,t,n){return[parseInt(e[0],10)*(p.test(e[0])?t/100:1),parseInt(e[1],10)*(p.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}function r(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,s=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,h=/[\+\-]\d+%?/,d=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(o!==t)return o;var n,i,r=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),s=r.children()[0];return e("body").append(r),n=s.offsetWidth,r.css("overflow","scroll"),i=s.offsetWidth,n===i&&(i=r[0].clientWidth),r.remove(),o=n-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),i=t.isWindow?"":t.element.css("overflow-y"),r="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,o="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:r?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]);return{element:n,isWindow:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var o,p,g,m,v,b,y=e(t.of),w=e.position.getWithinInfo(t.within),_=e.position.getScrollInfo(w),x=(t.collision||"flip").split(" "),C={};return b=r(y),y[0].preventDefault&&(t.at="left top"),p=b.width,g=b.height,m=b.offset,v=e.extend({},m),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=c.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=c.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=h.exec(i[0]),n=h.exec(i[1]),C[this]=[e?e[0]:0,n?n[0]:0],t[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===t.at[0]?v.left+=p:"center"===t.at[0]&&(v.left+=p/2),"bottom"===t.at[1]?v.top+=g:"center"===t.at[1]&&(v.top+=g/2),o=n(C.at,p,g),v.left+=o[0],v.top+=o[1],this.each(function(){var r,c,u=e(this),h=u.outerWidth(),d=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),$=h+f+i(this,"marginRight")+_.width,k=d+b+i(this,"marginBottom")+_.height,S=e.extend({},v),T=n(C.my,u.outerWidth(),u.outerHeight());"right"===t.my[0]?S.left-=h:"center"===t.my[0]&&(S.left-=h/2),"bottom"===t.my[1]?S.top-=d:"center"===t.my[1]&&(S.top-=d/2),S.left+=T[0],S.top+=T[1],e.support.offsetFractions||(S.left=l(S.left),S.top=l(S.top)),r={marginLeft:f,marginTop:b},e.each(["left","top"],function(n,i){e.ui.position[x[n]]&&e.ui.position[x[n]][i](S,{targetWidth:p,targetHeight:g,elemWidth:h,elemHeight:d,collisionPosition:r,collisionWidth:$,collisionHeight:k,offset:[o[0]+T[0],o[1]+T[1]],my:t.my,at:t.at,within:w,elem:u})}),t.using&&(c=function(e){var n=m.left-S.left,i=n+p-h,r=m.top-S.top,o=r+g-d,l={target:{element:y,left:m.left,top:m.top,width:p,height:g},element:{element:u,left:S.left,top:S.top,width:h,height:d},horizontal:0>i?"left":n>0?"right":"center",vertical:0>o?"top":r>0?"bottom":"middle"};h>p&&a(n+i)<p&&(l.horizontal="center"),d>g&&a(r+o)<g&&(l.vertical="middle"),l.important=s(a(n),a(i))>s(a(r),a(o))?"horizontal":"vertical",t.using.call(this,e,l)}),u.offset(e.extend(S,{using:c}))})},e.ui.position={fit:{left:function(e,t){var n,i=t.within,r=i.isWindow?i.scrollLeft:i.offset.left,o=i.width,a=e.left-t.collisionPosition.marginLeft,l=r-a,c=a+t.collisionWidth-o-r;t.collisionWidth>o?l>0&&0>=c?(n=e.left+l+t.collisionWidth-o-r,e.left+=l-n):e.left=c>0&&0>=l?r:l>c?r+o-t.collisionWidth:r:l>0?e.left+=l:c>0?e.left-=c:e.left=s(e.left-a,e.left)},top:function(e,t){var n,i=t.within,r=i.isWindow?i.scrollTop:i.offset.top,o=t.within.height,a=e.top-t.collisionPosition.marginTop,l=r-a,c=a+t.collisionHeight-o-r;t.collisionHeight>o?l>0&&0>=c?(n=e.top+l+t.collisionHeight-o-r,e.top+=l-n):e.top=c>0&&0>=l?r:l>c?r+o-t.collisionHeight:r:l>0?e.top+=l:c>0?e.top-=c:e.top=s(e.top-a,e.top)}},flip:{left:function(e,t){var n,i,r=t.within,o=r.offset.left+r.scrollLeft,s=r.width,l=r.isWindow?r.scrollLeft:r.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,h=c+t.collisionWidth-s-l,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(n=e.left+d+p+f+t.collisionWidth-s-o,(0>n||n<a(u))&&(e.left+=d+p+f)):h>0&&(i=e.left-t.collisionPosition.marginLeft+d+p+f-l,(i>0||a(i)<h)&&(e.left+=d+p+f))},top:function(e,t){var n,i,r=t.within,o=r.offset.top+r.scrollTop,s=r.height,l=r.isWindow?r.scrollTop:r.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,h=c+t.collisionHeight-s-l,d="top"===t.my[1],p=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,g=-2*t.offset[1];0>u?(i=e.top+p+f+g+t.collisionHeight-s-o,e.top+p+f+g>u&&(0>i||i<a(u))&&(e.top+=p+f+g)):h>0&&(n=e.top-t.collisionPosition.marginTop+p+f+g-l,e.top+p+f+g>h&&(n>0||a(n)<h)&&(e.top+=p+f+g))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,r,o,s=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(s?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},s&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in i)t.style[o]=i[o];t.appendChild(a),n=s||document.documentElement,n.insertBefore(t,n.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",r=e(a).offset().left,e.support.offsetFractions=r>10&&11>r,t.innerHTML="",n.removeChild(t)}()}(jQuery),function($){function Timepicker(){this.debug=!0,this._curInst=null,this._disabledInputs=[],this._timepickerShowing=!1,this._inDialog=!1,this._dialogClass="ui-timepicker-dialog",this._mainDivId="ui-timepicker-div",this._inlineClass="ui-timepicker-inline",this._currentClass="ui-timepicker-current",this._dayOverClass="ui-timepicker-days-cell-over",this.regional=[],this.regional[""]={hourText:"Hour",minuteText:"Minute",amPmText:["AM","PM"],closeButtonText:"Done",nowButtonText:"Now",deselectButtonText:"Deselect"},this._defaults={showOn:"focus",button:null,showAnim:"fadeIn",showOptions:{},appendText:"",beforeShow:null,onSelect:null,onClose:null,timeSeparator:":",periodSeparator:" ",showPeriod:!1,showPeriodLabels:!0,showLeadingZero:!0,showMinutesLeadingZero:!0,altField:"",defaultTime:"now",myPosition:"left top",atPosition:"left bottom",onHourShow:null,onMinuteShow:null,hours:{starts:0,ends:23},minutes:{starts:0,ends:55,interval:5,manual:[]},rows:4,showHours:!0,showMinutes:!0,optionalMinutes:!1,showCloseButton:!1,showNowButton:!1,showDeselectButton:!1,maxTime:{hour:null,minute:null},minTime:{hour:null,minute:null}},$.extend(this._defaults,this.regional[""]),this.tpDiv=$('<div id="'+this._mainDivId+'" class="ui-timepicker ui-widget ui-helper-clearfix ui-corner-all " style="display: none"></div>')}function extendRemove(e,t){$.extend(e,t);for(var n in t)(null==t[n]||void 0==t[n])&&(e[n]=t[n]);return e}$.extend($.ui,{timepicker:{version:"0.3.3"}});var PROP_NAME="timepicker",tpuuid=(new Date).getTime();$.extend(Timepicker.prototype,{markerClassName:"hasTimepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetTimepicker:function(){return this.tpDiv},setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_attachTimepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("time:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline="div"==nodeName||"span"==nodeName;target.id||(this.uuid+=1,target.id="tp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),"input"==nodeName?(this._connectTimepicker(target,inst),this._setTimeFromField(inst)):inline&&this._inlineTimepicker(target,inst);
},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:n,input:e,inline:t,tpDiv:t?$('<div class="'+this._inlineClass+' ui-timepicker ui-widget  ui-helper-clearfix"></div>'):this.tpDiv}},_connectTimepicker:function(e,t){var n=$(e);t.append=$([]),t.trigger=$([]),n.hasClass(this.markerClassName)||(this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keyup(this._doKeyUp).bind("setData.timepicker",function(e,n,i){t.settings[n]=i}).bind("getData.timepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t))},_doKeyDown:function(e){var t=$.timepicker._getInst(e.target),n=!0;if(t._keyEvent=!0,$.timepicker._timepickerShowing)switch(e.keyCode){case 9:$.timepicker._hideTimepicker(),n=!1;break;case 13:return $.timepicker._updateSelectedValue(t),$.timepicker._hideTimepicker(),!1;case 27:$.timepicker._hideTimepicker();break;default:n=!1}else 36==e.keyCode&&e.ctrlKey?$.timepicker._showTimepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyUp:function(e){var t=$.timepicker._getInst(e.target);$.timepicker._setTimeFromField(t),$.timepicker._updateTimepicker(t)},_attachments:function(e,t){var n=this._get(t,"appendText"),i=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=$('<span class="'+this._appendClass+'">'+n+"</span>"),e[i?"before":"after"](t.append)),e.unbind("focus.timepicker",this._showTimepicker),e.unbind("click.timepicker",this._adjustZIndex),t.trigger&&t.trigger.remove();var r=this._get(t,"showOn");if(("focus"==r||"both"==r)&&(e.bind("focus.timepicker",this._showTimepicker),e.bind("click.timepicker",this._adjustZIndex)),"button"==r||"both"==r){var o=this._get(t,"button");null==o&&(o=$('<button class="ui-timepicker-trigger" type="button">...</button>'),e.after(o)),$(o).bind("click.timepicker",function(){return $.timepicker._timepickerShowing&&$.timepicker._lastInput==e[0]?$.timepicker._hideTimepicker():t.input.is(":disabled")||$.timepicker._showTimepicker(e[0]),!1})}},_inlineTimepicker:function(e,t){var n=$(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(t.tpDiv).bind("setData.timepicker",function(e,n,i){t.settings[n]=i}).bind("getData.timepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t),this._setTimeFromField(t),this._updateTimepicker(t),t.tpDiv.show())},_adjustZIndex:function(e){e=e.target||e;var t=$.timepicker._getInst(e);t.tpDiv.css("zIndex",$.timepicker._getZIndex(e)+1)},_showTimepicker:function(e){if(e=e.target||e,"input"!=e.nodeName.toLowerCase()&&(e=$("input",e.parentNode)[0]),!$.timepicker._isDisabledTimepicker(e)&&$.timepicker._lastInput!=e){$.timepicker._hideTimepicker();var t=$.timepicker._getInst(e);$.timepicker._curInst&&$.timepicker._curInst!=t&&$.timepicker._curInst.tpDiv.stop(!0,!0);var n=$.timepicker._get(t,"beforeShow");extendRemove(t.settings,n?n.apply(e,[e,t]):{}),t.lastVal=null,$.timepicker._lastInput=e,$.timepicker._setTimeFromField(t),$.timepicker._inDialog&&(e.value=""),$.timepicker._pos||($.timepicker._pos=$.timepicker._findPos(e),$.timepicker._pos[1]+=e.offsetHeight);var i=!1;$(e).parents().each(function(){return i|="fixed"==$(this).css("position"),!i});var r={left:$.timepicker._pos[0],top:$.timepicker._pos[1]};if($.timepicker._pos=null,t.tpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.timepicker._updateTimepicker(t),!t.inline&&"object"==typeof $.ui.position){t.tpDiv.position({of:t.input,my:$.timepicker._get(t,"myPosition"),at:$.timepicker._get(t,"atPosition"),collision:"flip"});var r=t.tpDiv.offset();$.timepicker._pos=[r.top,r.left]}if(t._hoursClicked=!1,t._minutesClicked=!1,r=$.timepicker._checkOffset(t,r,i),t.tpDiv.css({position:$.timepicker._inDialog&&$.blockUI?"static":i?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),!t.inline){var o=$.timepicker._get(t,"showAnim"),s=$.timepicker._get(t,"duration"),a=function(){$.timepicker._timepickerShowing=!0;var e=$.timepicker._getBorders(t.tpDiv);t.tpDiv.find("iframe.ui-timepicker-cover").css({left:-e[0],top:-e[1],width:t.tpDiv.outerWidth(),height:t.tpDiv.outerHeight()})};$.timepicker._adjustZIndex(e),$.effects&&$.effects[o]?t.tpDiv.show(o,$.timepicker._get(t,"showOptions"),s,a):t.tpDiv.show(o?s:null,a),o&&s||a(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),$.timepicker._curInst=t}}},_getZIndex:function(e){for(var t,n,i=$(e),r=0;i.length&&i[0]!==document;)t=i.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(n=parseInt(i.css("zIndex"),10),isNaN(n)||0===n||n>r&&(r=n)),i=i.parent();return r},_refreshTimepicker:function(e){var t=this._getInst(e);t&&this._updateTimepicker(t)},_updateTimepicker:function(e){e.tpDiv.empty().append(this._generateHTML(e)),this._rebindDialogEvents(e)},_rebindDialogEvents:function(e){var t=$.timepicker._getBorders(e.tpDiv),n=this;e.tpDiv.find("iframe.ui-timepicker-cover").css({left:-t[0],top:-t[1],width:e.tpDiv.outerWidth(),height:e.tpDiv.outerHeight()}).end().find(".ui-timepicker-minute-cell").unbind().bind("click",{fromDoubleClick:!1},$.proxy($.timepicker.selectMinutes,this)).bind("dblclick",{fromDoubleClick:!0},$.proxy($.timepicker.selectMinutes,this)).end().find(".ui-timepicker-hour-cell").unbind().bind("click",{fromDoubleClick:!1},$.proxy($.timepicker.selectHours,this)).bind("dblclick",{fromDoubleClick:!0},$.proxy($.timepicker.selectHours,this)).end().find(".ui-timepicker td a").unbind().bind("mouseout",function(){$(this).removeClass("ui-state-hover"),-1!=this.className.indexOf("ui-timepicker-prev")&&$(this).removeClass("ui-timepicker-prev-hover"),-1!=this.className.indexOf("ui-timepicker-next")&&$(this).removeClass("ui-timepicker-next-hover")}).bind("mouseover",function(){n._isDisabledTimepicker(e.inline?e.tpDiv.parent()[0]:e.input[0])||($(this).parents(".ui-timepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-timepicker-prev")&&$(this).addClass("ui-timepicker-prev-hover"),-1!=this.className.indexOf("ui-timepicker-next")&&$(this).addClass("ui-timepicker-next-hover"))}).end().find("."+this._dayOverClass+" a").trigger("mouseover").end().find(".ui-timepicker-now").bind("click",function(e){$.timepicker.selectNow(e)}).end().find(".ui-timepicker-deselect").bind("click",function(e){$.timepicker.deselectTime(e)}).end().find(".ui-timepicker-close").bind("click",function(e){$.timepicker._hideTimepicker()}).end()},_generateHTML:function(e){var t,n,i,r,o=1==this._get(e,"showPeriod"),s=1==this._get(e,"showPeriodLabels"),a=1==this._get(e,"showLeadingZero"),l=1==this._get(e,"showHours"),c=1==this._get(e,"showMinutes"),u=this._get(e,"amPmText"),h=this._get(e,"rows"),d=0,p=0,f=0,g=0,m=0,v=0,b=Array(),y=this._get(e,"hours"),w=null,_=0,x=this._get(e,"hourText"),C=this._get(e,"showCloseButton"),$=this._get(e,"closeButtonText"),k=this._get(e,"showNowButton"),S=this._get(e,"nowButtonText"),T=this._get(e,"showDeselectButton"),E=this._get(e,"deselectButtonText"),D=C||k||T;for(t=y.starts;t<=y.ends;t++)b.push(t);if(w=Math.ceil(b.length/h),s){for(_=0;_<b.length;_++)b[_]<12?f++:g++;_=0,d=Math.floor(f/b.length*h),p=Math.floor(g/b.length*h),h!=d+p&&(f&&(!g||!d||p&&f/d>=g/p)?d++:p++),m=Math.min(d,1),v=d+1,w=Math.ceil(0==d?g/p:0==p?f/d:Math.max(f/d,g/p))}if(r='<table class="ui-timepicker-table ui-widget-content ui-corner-all"><tr>',l){for(r+='<td class="ui-timepicker-hours"><div class="ui-timepicker-title ui-widget-header ui-helper-clearfix ui-corner-all">'+x+'</div><table class="ui-timepicker">',n=1;h>=n;n++){for(r+="<tr>",n==m&&s&&(r+='<th rowspan="'+d.toString()+'" class="periods" scope="row">'+u[0]+"</th>"),n==v&&s&&(r+='<th rowspan="'+p.toString()+'" class="periods" scope="row">'+u[1]+"</th>"),i=1;w>=i;i++)s&&v>n&&b[_]>=12?r+=this._generateHTMLHourCell(e,void 0,o,a):(r+=this._generateHTMLHourCell(e,b[_],o,a),_++);r+="</tr>"}r+="</table></td>"}if(c&&(r+='<td class="ui-timepicker-minutes">',r+=this._generateHTMLMinutes(e),r+="</td>"),r+="</tr>",D){var A='<tr><td colspan="3"><div class="ui-timepicker-buttonpane ui-widget-content">';k&&(A+='<button type="button" class="ui-timepicker-now ui-state-default ui-corner-all"  data-timepicker-instance-id="#'+e.id.replace(/\\\\/g,"\\")+'" >'+S+"</button>"),T&&(A+='<button type="button" class="ui-timepicker-deselect ui-state-default ui-corner-all"  data-timepicker-instance-id="#'+e.id.replace(/\\\\/g,"\\")+'" >'+E+"</button>"),C&&(A+='<button type="button" class="ui-timepicker-close ui-state-default ui-corner-all"  data-timepicker-instance-id="#'+e.id.replace(/\\\\/g,"\\")+'" >'+$+"</button>"),r+=A+"</div></td></tr>"}return r+="</table>"},_updateMinuteDisplay:function(e){var t=this._generateHTMLMinutes(e);e.tpDiv.find("td.ui-timepicker-minutes").html(t),this._rebindDialogEvents(e)},_generateHTMLMinutes:function(e){var t,n,r="",o=this._get(e,"rows"),s=Array(),a=this._get(e,"minutes"),l=null,c=0,u=1==this._get(e,"showMinutesLeadingZero"),h=this._get(e,"onMinuteShow"),d=this._get(e,"minuteText");for(a.starts||(a.starts=0),a.ends||(a.ends=59),a.manual||(a.manual=[]),t=a.starts;t<=a.ends;t+=a.interval)s.push(t);for(i=0;i<a.manual.length;i++){var p=a.manual[i];"number"!=typeof p||0>p||p>59||$.inArray(p,s)>=0||s.push(p)}if(s.sort(function(e,t){return e-t}),l=Math.round(s.length/o+.49),h&&0==h.apply(e.input?e.input[0]:null,[e.hours,e.minutes]))for(c=0;c<s.length;c+=1)if(t=s[c],h.apply(e.input?e.input[0]:null,[e.hours,t])){e.minutes=t;break}for(r+='<div class="ui-timepicker-title ui-widget-header ui-helper-clearfix ui-corner-all">'+d+'</div><table class="ui-timepicker">',c=0,n=1;o>=n;n++){for(r+="<tr>";n*l>c;){var t=s[c],f="";void 0!==t&&(f=10>t&&u?"0"+t.toString():t.toString()),r+=this._generateHTMLMinuteCell(e,t,f),c++}r+="</tr>"}return r+="</table>"},_generateHTMLHourCell:function(e,t,n,i){var r=t;t>12&&n&&(r=t-12),0==r&&n&&(r=12),10>r&&i&&(r="0"+r);var o="",s=!0,a=this._get(e,"onHourShow"),l=this._get(e,"maxTime"),c=this._get(e,"minTime");return void 0==t?o='<td><span class="ui-state-default ui-state-disabled">&nbsp;</span></td>':(a&&(s=a.apply(e.input?e.input[0]:null,[t])),s&&(!isNaN(parseInt(l.hour))&&t>l.hour&&(s=!1),!isNaN(parseInt(c.hour))&&t<c.hour&&(s=!1)),o=s?'<td class="ui-timepicker-hour-cell" data-timepicker-instance-id="#'+e.id.replace(/\\\\/g,"\\")+'" data-hour="'+t.toString()+'"><a class="ui-state-default '+(t==e.hours?"ui-state-active":"")+'">'+r.toString()+"</a></td>":'<td><span class="ui-state-default ui-state-disabled '+(t==e.hours?" ui-state-active ":" ")+'">'+r.toString()+"</span></td>")},_generateHTMLMinuteCell:function(e,t,n){var i="",r=!0,o=e.hours,s=this._get(e,"onMinuteShow"),a=this._get(e,"maxTime"),l=this._get(e,"minTime");return s&&(r=s.apply(e.input?e.input[0]:null,[e.hours,t])),void 0==t?i='<td><span class="ui-state-default ui-state-disabled">&nbsp;</span></td>':(r&&null!==o&&(!isNaN(parseInt(a.hour))&&!isNaN(parseInt(a.minute))&&o>=a.hour&&t>a.minute&&(r=!1),!isNaN(parseInt(l.hour))&&!isNaN(parseInt(l.minute))&&o<=l.hour&&t<l.minute&&(r=!1)),i=r?'<td class="ui-timepicker-minute-cell" data-timepicker-instance-id="#'+e.id.replace(/\\\\/g,"\\")+'" data-minute="'+t.toString()+'" ><a class="ui-state-default '+(t==e.minutes?"ui-state-active":"")+'" >'+n+"</a></td>":'<td><span class="ui-state-default ui-state-disabled" >'+n+"</span></td>")},_destroyTimepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME),"input"==i?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus.timepicker",this._showTimepicker).unbind("click.timepicker",this._adjustZIndex)):("div"==i||"span"==i)&&t.removeClass(this.markerClassName).empty()}},_enableTimepicker:function(e){var t=$(e),n=t.attr("id"),i=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var r=e.nodeName.toLowerCase();if("input"==r){e.disabled=!1;var o=this._get(i,"button");$(o).removeClass("ui-state-disabled").disabled=!1,i.trigger.filter("button").each(function(){this.disabled=!1}).end()}else if("div"==r||"span"==r){var s=t.children("."+this._inlineClass);s.children().removeClass("ui-state-disabled"),s.find("button").each(function(){this.disabled=!1})}this._disabledInputs=$.map(this._disabledInputs,function(e){return e==n?null:e})}},_disableTimepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(t.hasClass(this.markerClassName)){var i=e.nodeName.toLowerCase();if("input"==i){var r=this._get(n,"button");$(r).addClass("ui-state-disabled").disabled=!0,e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end()}else if("div"==i||"span"==i){var o=t.children("."+this._inlineClass);o.children().addClass("ui-state-disabled"),o.find("button").each(function(){this.disabled=!0})}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=t.attr("id")}},_isDisabledTimepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_checkOffset:function(e,t,n){var i=e.tpDiv.outerWidth(),r=e.tpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,s=e.input?e.input.outerHeight():0,a=document.documentElement.clientWidth+$(document).scrollLeft(),l=document.documentElement.clientHeight+$(document).scrollTop();return t.left-=this._get(e,"isRTL")?i-o:0,t.left-=n&&t.left==e.input.offset().left?$(document).scrollLeft():0,t.top-=n&&t.top==e.input.offset().top+s?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+i>a&&a>i?Math.abs(t.left+i-a):0),t.top-=Math.min(t.top,t.top+r>l&&l>r?Math.abs(r+s):0),t},_findPos:function(e){for(var t=this._getInst(e),n=this._get(t,"isRTL");e&&("hidden"==e.type||1!=e.nodeType);)e=e[n?"previousSibling":"nextSibling"];var i=$(e).offset();return[i.left,i.top]},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkExternalClick:function(e){if($.timepicker._curInst){var t=$(e.target);t[0].id==$.timepicker._mainDivId||0!=t.parents("#"+$.timepicker._mainDivId).length||t.hasClass($.timepicker.markerClassName)||t.hasClass($.timepicker._triggerClass)||!$.timepicker._timepickerShowing||$.timepicker._inDialog&&$.blockUI||$.timepicker._hideTimepicker()}},_hideTimepicker:function(e){var t=this._curInst;if(t&&(!e||t==$.data(e,PROP_NAME))&&this._timepickerShowing){var n=this._get(t,"showAnim"),i=this._get(t,"duration"),r=function(){$.timepicker._tidyDialog(t),this._curInst=null};$.effects&&$.effects[n]?t.tpDiv.hide(n,$.timepicker._get(t,"showOptions"),i,r):t.tpDiv["slideDown"==n?"slideUp":"fadeIn"==n?"fadeOut":"hide"](n?i:null,r),n||r(),this._timepickerShowing=!1,this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.tpDiv))),this._inDialog=!1;var o=this._get(t,"onClose");o&&o.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t])}},_tidyDialog:function(e){e.tpDiv.removeClass(this._dialogClass).unbind(".ui-timepicker")},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this timepicker"}},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setTimeFromField:function(e){if(e.input.val()!=e.lastVal){var t=this._get(e,"defaultTime"),n="now"==t?this._getCurrentTimeRounded(e):t;if(0==e.inline&&""!=e.input.val()&&(n=e.input.val()),n instanceof Date)e.hours=n.getHours(),e.minutes=n.getMinutes();else{var i=e.lastVal=n;if(""==n)e.hours=-1,e.minutes=-1;else{var r=this.parseTime(e,i);e.hours=r.hours,e.minutes=r.minutes}}$.timepicker._updateTimepicker(e)}},_optionTimepicker:function(e,t,n){var i=this._getInst(e);if(2==arguments.length&&"string"==typeof t)return"defaults"==t?$.extend({},$.timepicker._defaults):i?"all"==t?$.extend({},i.settings):this._get(i,t):null;var r=t||{};"string"==typeof t&&(r={},r[t]=n),i&&(extendRemove(i.settings,r),this._curInst==i&&(this._hideTimepicker(),this._updateTimepicker(i)),i.inline&&this._updateTimepicker(i))},_setTimeTimepicker:function(e,t){var n=this._getInst(e);n&&(this._setTime(n,t),this._updateTimepicker(n),this._updateAlternate(n,t))},_setTime:function(e,t,n){var i=e.hours,r=e.minutes;if(t instanceof Date)e.hours=t.getHours(),e.minutes=t.getMinutes();else{var t=this.parseTime(e,t);e.hours=t.hours,e.minutes=t.minutes}i==e.hours&&r==e.minutes||n||e.input.trigger("change"),this._updateTimepicker(e),this._updateSelectedValue(e)},_getCurrentTimeRounded:function(e){var t=new Date,n=t.getMinutes(),i=this._get(e,"minutes"),r=Math.round(n/i.interval)*i.interval;return t.setMinutes(r),t},parseTime:function(e,t){var n=new Object;if(n.hours=-1,n.minutes=-1,!t)return"";var i=this._get(e,"timeSeparator"),r=this._get(e,"amPmText"),o=this._get(e,"showHours"),s=this._get(e,"showMinutes"),a=this._get(e,"optionalMinutes"),l=1==this._get(e,"showPeriod"),c=t.indexOf(i);if(-1!=c?(n.hours=parseInt(t.substr(0,c),10),n.minutes=parseInt(t.substr(c+1),10)):!o||s&&!a?!o&&s&&(n.minutes=parseInt(t,10)):n.hours=parseInt(t,10),o){var u=t.toUpperCase();n.hours<12&&l&&-1!=u.indexOf(r[1].toUpperCase())&&(n.hours+=12),12==n.hours&&l&&-1!=u.indexOf(r[0].toUpperCase())&&(n.hours=0)}return n},selectNow:function(e){var t=$(e.target).attr("data-timepicker-instance-id"),n=$(t),i=this._getInst(n[0]),r=new Date;i.hours=r.getHours(),i.minutes=r.getMinutes(),this._updateSelectedValue(i),this._updateTimepicker(i),this._hideTimepicker()},deselectTime:function(e){var t=$(e.target).attr("data-timepicker-instance-id"),n=$(t),i=this._getInst(n[0]);i.hours=-1,i.minutes=-1,this._updateSelectedValue(i),this._hideTimepicker()},selectHours:function(e){var t=$(e.currentTarget),n=t.attr("data-timepicker-instance-id"),i=parseInt(t.attr("data-hour")),r=e.data.fromDoubleClick,o=$(n),s=this._getInst(o[0]),a=1==this._get(s,"showMinutes");if($.timepicker._isDisabledTimepicker(o.attr("id")))return!1;t.parents(".ui-timepicker-hours:first").find("a").removeClass("ui-state-active"),t.children("a").addClass("ui-state-active"),s.hours=i;var l=this._get(s,"onMinuteShow"),c=this._get(s,"maxTime"),u=this._get(s,"minTime");return(l||c.minute||u.minute)&&this._updateMinuteDisplay(s),this._updateSelectedValue(s),s._hoursClicked=!0,(s._minutesClicked||r||0==a)&&$.timepicker._hideTimepicker(),!1},selectMinutes:function(e){var t=$(e.currentTarget),n=t.attr("data-timepicker-instance-id"),i=parseInt(t.attr("data-minute")),r=e.data.fromDoubleClick,o=$(n),s=this._getInst(o[0]),a=1==this._get(s,"showHours");return $.timepicker._isDisabledTimepicker(o.attr("id"))?!1:(t.parents(".ui-timepicker-minutes:first").find("a").removeClass("ui-state-active"),t.children("a").addClass("ui-state-active"),s.minutes=i,this._updateSelectedValue(s),s._minutesClicked=!0,s._hoursClicked||r||0==a?($.timepicker._hideTimepicker(),!1):!1)},_updateSelectedValue:function(e){var t=this._getParsedTime(e);e.input&&(e.input.val(t),e.input.trigger("change"));var n=this._get(e,"onSelect");return n&&n.apply(e.input?e.input[0]:null,[t,e]),this._updateAlternate(e,t),t},_getParsedTime:function(e){if(-1==e.hours&&-1==e.minutes)return"";(e.hours<e.hours.starts||e.hours>e.hours.ends)&&(e.hours=0),(e.minutes<e.minutes.starts||e.minutes>e.minutes.ends)&&(e.minutes=0);var t="",n=1==this._get(e,"showPeriod"),i=1==this._get(e,"showLeadingZero"),r=1==this._get(e,"showHours"),o=1==this._get(e,"showMinutes"),s=1==this._get(e,"optionalMinutes"),a=this._get(e,"amPmText"),l=e.hours?e.hours:0,c=e.minutes?e.minutes:0,u=l?l:0,h="";-1==u&&(u=0),-1==c&&(c=0),n&&(0==e.hours&&(u=12),e.hours<12?t=a[0]:(t=a[1],u>12&&(u-=12)));var d=u.toString();i&&10>u&&(d="0"+d);var p=c.toString();return 10>c&&(p="0"+p),r&&(h+=d),!r||!o||s&&0==p||(h+=this._get(e,"timeSeparator")),!o||s&&0==p||(h+=p),r&&t.length>0&&(h+=this._get(e,"periodSeparator")+t),h},_updateAlternate:function(e,t){var n=this._get(e,"altField");n&&$(n).each(function(e,n){$(n).val(t)})},_getTimeAsDateTimepicker:function(e){var t=this._getInst(e);return-1==t.hours&&-1==t.minutes?"":((t.hours<t.hours.starts||t.hours>t.hours.ends)&&(t.hours=0),(t.minutes<t.minutes.starts||t.minutes>t.minutes.ends)&&(t.minutes=0),new Date(0,0,0,t.hours,t.minutes,0))},_getTimeTimepicker:function(e){var t=this._getInst(e);return this._getParsedTime(t)},_getHourTimepicker:function(e){var t=this._getInst(e);return void 0==t?-1:t.hours},_getMinuteTimepicker:function(e){var t=this._getInst(e);return void 0==t?-1:t.minutes}}),$.fn.timepicker=function(e){$.timepicker.initialized||($(document).mousedown($.timepicker._checkExternalClick),$.timepicker.initialized=!0),0===$("#"+$.timepicker._mainDivId).length&&$("body").append($.timepicker.tpDiv);var t=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"getTime"!=e&&"getTimeAsDate"!=e&&"getHour"!=e&&"getMinute"!=e?"option"==e&&2==arguments.length&&"string"==typeof arguments[1]?$.timepicker["_"+e+"Timepicker"].apply($.timepicker,[this[0]].concat(t)):this.each(function(){"string"==typeof e?$.timepicker["_"+e+"Timepicker"].apply($.timepicker,[this].concat(t)):$.timepicker._attachTimepicker(this,e)}):$.timepicker["_"+e+"Timepicker"].apply($.timepicker,[this[0]].concat(t))},$.timepicker=new Timepicker,$.timepicker.initialized=!1,$.timepicker.uuid=(new Date).getTime(),$.timepicker.version="0.3.3",window["TP_jQuery_"+tpuuid]=$}(jQuery),function(e,t,n){"use strict";t.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function(e,i){var r,o={},s={},a=!1,l=t.copy,c=t.isUndefined;return i.addPollFn(function(){var t=i.cookies();r!=t&&(r=t,l(t,s),l(t,o),a&&e.$apply())})(),a=!0,e.$watch(function(){var e,r,a;for(e in s)c(o[e])&&i.cookies(e,n);for(e in o)r=o[e],t.isString(r)||(r=""+r,o[e]=r),r!==s[e]&&(i.cookies(e,r),a=!0);if(a)for(e in r=i.cookies(),o)o[e]!==r[e]&&(c(r[e])?delete o[e]:o[e]=r[e])}),o}]).factory("$cookieStore",["$cookies",function(e){return{get:function(n){return(n=e[n])?t.fromJson(n):n},put:function(n,i){e[n]=t.toJson(i)},remove:function(t){delete e[t]}}}])}(window,window.angular),!function(e,t){"use strict";function n(e){return/^-?\d+\.?\d*$/.test(e.replace(/["']/g,""))}var i=t.isDefined,r=t.isUndefined,o=t.isNumber,s=t.isObject,a=t.isArray,l=t.extend,c=t.toJson,u=t.fromJson,h=t.module("LocalStorageModule",[]);h.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){return this.prefix=e,this},this.setStorageType=function(e){return this.storageType=e,this},this.setStorageCookie=function(e,t){return this.cookie={expiry:e,path:t},this},this.setStorageCookieDomain=function(e){return this.cookie.domain=e,this},this.setNotify=function(e,t){return this.notify={setItem:e,removeItem:t},this},this.$get=["$rootScope","$window","$document","$parse",function(e,t,h,d){var p,f=this,g=f.prefix,m=f.cookie,v=f.notify,b=f.storageType;h?h[0]&&(h=h[0]):h=document,"."!==g.substr(-1)&&(g=g?g+".":"");var y=function(e){return g+e},w=function(){try{var n=b in t&&null!==t[b],i=y("__"+Math.round(1e7*Math.random()));return n&&(p=t[b],p.setItem(i,""),p.removeItem(i)),n}catch(r){return b="cookie",e.$broadcast("LocalStorageModule.notification.error",r.message),!1}}(),_=function(t,n){if(r(n)?n=null:(s(n)||a(n)||o(+n||n))&&(n=c(n)),!w||"cookie"===f.storageType)return w||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),v.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:n,storageType:"cookie"}),T(t,n);try{(s(n)||a(n))&&(n=c(n)),p&&p.setItem(y(t),n),v.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:n,storageType:f.storageType})}catch(i){return e.$broadcast("LocalStorageModule.notification.error",i.message),T(t,n)}return!0},x=function(t){if(!w||"cookie"===f.storageType)return w||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),E(t);var i=p?p.getItem(y(t)):null;return i&&"null"!==i?"{"===i.charAt(0)||"["===i.charAt(0)||n(i)?u(i):i:null},C=function(t){if(!w||"cookie"===f.storageType)return w||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),v.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:"cookie"}),D(t);try{p.removeItem(y(t)),v.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:f.storageType})}catch(n){return e.$broadcast("LocalStorageModule.notification.error",n.message),D(t)}return!0},$=function(){if(!w)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var t=g.length,n=[];for(var i in p)if(i.substr(0,t)===g)try{n.push(i.substr(t))}catch(r){return e.$broadcast("LocalStorageModule.notification.error",r.Description),[]}return n},k=function(t){t=t||"";var n=g.slice(0,-1),i=new RegExp(n+"."+t);if(!w||"cookie"===f.storageType)return w||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A();var r=g.length;for(var o in p)if(i.test(o))try{C(o.substr(r))}catch(s){return e.$broadcast("LocalStorageModule.notification.error",s.message),A()}return!0},S=function(){try{return t.navigator.cookieEnabled||"cookie"in h&&(h.cookie.length>0||(h.cookie="test").indexOf.call(h.cookie,"test")>-1)}catch(n){return e.$broadcast("LocalStorageModule.notification.error",n.message),!1}}(),T=function(t,n){if(r(n))return!1;if((a(n)||s(n))&&(n=c(n)),!S)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var i="",o=new Date,l="";if(null===n?(o.setTime(o.getTime()+-864e5),i="; expires="+o.toGMTString(),n=""):0!==m.expiry&&(o.setTime(o.getTime()+24*m.expiry*60*60*1e3),i="; expires="+o.toGMTString()),t){var u="; path="+m.path;m.domain&&(l="; domain="+m.domain),h.cookie=y(t)+"="+encodeURIComponent(n)+i+u+l}}catch(d){return e.$broadcast("LocalStorageModule.notification.error",d.message),!1}return!0},E=function(t){if(!S)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var n=h.cookie&&h.cookie.split(";")||[],i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(y(t)+"=")){var o=decodeURIComponent(r.substring(g.length+t.length+1,r.length));try{var s=JSON.parse(o);return u(s)}catch(a){return o}}}return null},D=function(e){T(e,null)},A=function(){for(var e=null,t=g.length,n=h.cookie.split(";"),i=0;i<n.length;i++){for(e=n[i];" "===e.charAt(0);)e=e.substring(1,e.length);var r=e.substring(t,e.indexOf("="));D(r)}},O=function(){return b},I=function(e,t,n,r){r=r||t;var o=x(r);return null===o&&i(n)?o=n:s(o)&&s(n)&&(o=l(n,o)),d(t).assign(e,o),e.$watch(t,function(e){_(r,e)},s(e[t]))},M=function(){for(var e=0,n=t[b],i=0;i<n.length;i++)0===n.key(i).indexOf(g)&&e++;return e};return{isSupported:w,getStorageType:O,set:_,add:_,get:x,keys:$,remove:C,clearAll:k,bind:I,deriveKey:y,length:M,cookie:{isSupported:S,set:T,add:T,get:E,remove:D,clearAll:A}}}]})}(window,window.angular),function(){var e,t={}.hasOwnProperty;e=angular.module("fcsa-number",[]),e.directive("fcsaNumber",["fcsaNumberConfig",function(e){var n,i,r,o,s,a,l,c,u,h,d,p,f;return r=e.defaultOptions,o=function(e){var n,i,o,s;if(i=angular.copy(r),null!=e.options){s=e.$eval(e.options);for(n in s)t.call(s,n)&&(o=s[n],i[n]=o)}return i},c=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},l=function(e){return 44>e||e>57||47===e},i=[0,8,13],a=function(e){return-1===i.indexOf(e)},s=function(e){return null!=e&&e.toString().split(".").length>2},h=function(e){var t,n;return t=e>0?"^-?\\d*\\.?\\d{0,"+e+"}$":"^-?\\d*$",n=new RegExp(t),function(e){return n.test(e)}},p=function(e){return function(t,n){return e>=n}},f=function(e){return function(t,n){return n>=e}},d=function(e){var t;return t=new RegExp("^-?\\d{0,"+e+"}(\\.\\d*)?$"),function(e){return t.test(e)}},u=function(e){var t;return t=[],null!=e.maxDecimals&&t.push(h(e.maxDecimals)),null!=e.max&&t.push(p(e.max)),null!=e.min&&t.push(f(e.min)),null!=e.maxDigits&&t.push(d(e.maxDigits)),function(e){var n,i,r,o;if(!c(e))return!1;if(s(e))return!1;for(i=Number(e),n=r=0,o=t.length;o>=0?o>r:r>o;n=o>=0?++r:--r)if(!t[n](e,i))return!1;return!0}},n=function(e){var t,n,i;return n=-1==e.indexOf(".")?"":e.replace(/^-?\d+(?=\.)/,""),i=e.replace(/(\.\d+)$/,""),t=i.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),""+t+n},{restrict:"A",require:"ngModel",scope:{options:"@fcsaNumber"},link:function(e,t,i,r){var s,c;return c=o(e),s=u(c),r.$parsers.unshift(function(e){var t;return t=e.replace(/,/g,""),s(t)||!t?(r.$setValidity("fcsaNumber",!0),t):void r.$setValidity("fcsaNumber",!1)}),r.$formatters.push(function(e){return null==c.nullDisplay||e&&""!==e?null!=e&&s(e)?(r.$setValidity("fcsaNumber",!0),e=n(e.toString()),null!=c.prepend&&(e=""+c.prepend+e),null!=c.append&&(e=""+e+c.append),e):e:c.nullDisplay}),t.on("blur",function(){var e,t,n,i,o;if(t=r.$modelValue,null!=t&&s(t)){for(o=r.$formatters,n=0,i=o.length;i>n;n++)e=o[n],t=e(t);return r.$viewValue=t,r.$render()}}),t.on("focus",function(){var e;return e=t.val(),null!=c.prepend&&(e=e.replace(c.prepend,"")),null!=c.append&&(e=e.replace(c.append,"")),t.val(e.replace(/,/g,"")),t[0].select()}),c.preventInvalidInput===!0?t.on("keypress",function(e){return l(e.which)&&a(e.which)?e.preventDefault():void 0}):void 0}}}]),e.provider("fcsaNumberConfig",function(){var e;e={},this.setDefaultOptions=function(t){return e=t},this.$get=function(){return{defaultOptions:e}}})}.call(this),!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(e){var t=["$q","$cacheFactory","$timeout","$rootScope","cfpLoadingBar",function(t,n,i,r,o){function s(){i.cancel(l),o.complete(),u=0,c=0}function a(t){var i,r=n.get("$http"),o=e.defaults;!t.cache&&!o.cache||t.cache===!1||"GET"!==t.method&&"JSONP"!==t.method||(i=angular.isObject(t.cache)?t.cache:angular.isObject(o.cache)?o.cache:r);var s=void 0!==i?void 0!==i.get(t.url):!1;return void 0!==t.cached&&s!==t.cached?t.cached:(t.cached=s,s)}var l,c=0,u=0,h=o.latencyThreshold;return{request:function(e){return e.ignoreLoadingBar||a(e)||(r.$broadcast("cfpLoadingBar:loading",{url:e.url}),0===c&&(l=i(function(){o.start()},h)),c++,o.set(u/c)),e},response:function(e){return e.config.ignoreLoadingBar||a(e.config)||(u++,r.$broadcast("cfpLoadingBar:loaded",{url:e.config.url}),u>=c?s():o.set(u/c)),e},responseError:function(e){return e.config.ignoreLoadingBar||a(e.config)||(u++,r.$broadcast("cfpLoadingBar:loaded",{url:e.config.url}),u>=c?s():o.set(u/c)),t.reject(e)}}}];e.interceptors.push(t)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(e,t,n,i){function r(){u||(u=e.get("$animate"));var r=t.find(p).eq(0);n.cancel(d),v||(i.$broadcast("cfpLoadingBar:started"),v=!0,w&&u.enter(f,r),y&&u.enter(m,r),o(_))}function o(e){if(v){var t=100*e+"%";g.css("width",t),b=e,n.cancel(h),h=n(function(){s()},250)}}function s(){if(!(a()>=1)){var e=0,t=a();e=t>=0&&.25>t?(3*Math.random()+3)/100:t>=.25&&.65>t?3*Math.random()/100:t>=.65&&.9>t?2*Math.random()/100:t>=.9&&.99>t?.005:0;var n=a()+e;o(n)}}function a(){return b}function l(){b=0,v=!1}function c(){u||(u=e.get("$animate")),i.$broadcast("cfpLoadingBar:completed"),o(1),n.cancel(d),d=n(function(){var e=u.leave(f,l);e&&e.then&&e.then(l),u.leave(m)},500)}var u,h,d,p=this.parentSelector,f=angular.element(this.loadingBarTemplate),g=f.find("div").eq(0),m=angular.element(this.spinnerTemplate),v=!1,b=0,y=this.includeSpinner,w=this.includeBar,_=this.startSize;
return{start:r,set:o,status:a,inc:s,complete:c,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}(),angular.module("pascalprecht.translate",["ng"]).run(["$translate",function(e){var t=e.storageKey(),n=e.storage();n?n.get(t)?e.use(n.get(t)):angular.isString(e.preferredLanguage())?e.use(e.preferredLanguage()):n.set(t,e.use()):angular.isString(e.preferredLanguage())&&e.use(e.preferredLanguage())}]),angular.module("pascalprecht.translate").provider("$translate",["$STORAGE_KEY",function(e){var t,n,i,r,o,s,a,l,c,u,h,d,p,f,g={},m=[],v=e,b=[],y=!1,w="translate-cloak",_=!1,x=".",C=function(){var e=window.navigator;return(e.language||e.browserLanguage||e.systemLanguage||e.userLanguage||"").split("-").join("_")},$=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},k=function(){return this.replace(/^\s+|\s+$/g,"")},S=function(e){for(var t=[],i=angular.lowercase(e),r=0,o=m.length;o>r;r++)t.push(angular.lowercase(m[r]));if($(t,i)>-1)return e;if(n){var s;for(var a in n){var l=!1,c=Object.prototype.hasOwnProperty.call(n,a)&&angular.lowercase(a)===angular.lowercase(e);if("*"===a.slice(-1)&&(l=a.slice(0,-1)===e.slice(0,a.length-1)),(c||l)&&(s=n[a],$(t,angular.lowercase(s))>-1))return s}}var u=e.split("_");return u.length>1&&$(t,angular.lowercase(u[0]))>-1?u[0]:e},T=function(e,t){if(!e&&!t)return g;if(e&&!t){if(angular.isString(e))return g[e]}else angular.isObject(g[e])||(g[e]={}),angular.extend(g[e],E(t));return this};this.translations=T,this.cloakClassName=function(e){return e?(w=e,this):w};var E=function(e,t,n,i){var r,o,s,a;t||(t=[]),n||(n={});for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(a=e[r],angular.isObject(a)?E(a,t.concat(r),n,r):(o=t.length?""+t.join(x)+x+r:r,t.length&&r===i&&(s=""+t.join(x),n[s]="@:"+o),n[o]=a));return n};this.addInterpolation=function(e){return b.push(e),this},this.useMessageFormatInterpolation=function(){return this.useInterpolation("$translateMessageFormatInterpolation")},this.useInterpolation=function(e){return u=e,this},this.useSanitizeValueStrategy=function(e){return y=e,this},this.preferredLanguage=function(e){return D(e),this};var D=function(e){return e&&(t=e),t};this.translationNotFoundIndicator=function(e){return this.translationNotFoundIndicatorLeft(e),this.translationNotFoundIndicatorRight(e),this},this.translationNotFoundIndicatorLeft=function(e){return e?(p=e,this):p},this.translationNotFoundIndicatorRight=function(e){return e?(f=e,this):f},this.fallbackLanguage=function(e){return A(e),this};var A=function(e){return e?(angular.isString(e)?(r=!0,i=[e]):angular.isArray(e)&&(r=!1,i=e),angular.isString(t)&&$(i,t)<0&&i.push(t),this):r?i[0]:i};this.use=function(e){if(e){if(!g[e]&&!h)throw new Error("$translateProvider couldn't find translationTable for langKey: '"+e+"'");return o=e,this}return o};var O=function(e){return e?void(v=e):l?l+v:v};this.storageKey=O,this.useUrlLoader=function(e){return this.useLoader("$translateUrlLoader",{url:e})},this.useStaticFilesLoader=function(e){return this.useLoader("$translateStaticFilesLoader",e)},this.useLoader=function(e,t){return h=e,d=t||{},this},this.useLocalStorage=function(){return this.useStorage("$translateLocalStorage")},this.useCookieStorage=function(){return this.useStorage("$translateCookieStorage")},this.useStorage=function(e){return a=e,this},this.storagePrefix=function(e){return e?(l=e,this):e},this.useMissingTranslationHandlerLog=function(){return this.useMissingTranslationHandler("$translateMissingTranslationHandlerLog")},this.useMissingTranslationHandler=function(e){return c=e,this},this.usePostCompiling=function(e){return _=!!e,this},this.determinePreferredLanguage=function(e){var n=e&&angular.isFunction(e)?e():C();return t=m.length?S(n):n,this},this.registerAvailableLanguageKeys=function(e,t){return e?(m=e,t&&(n=t),this):m},this.$get=["$log","$injector","$rootScope","$q",function(e,n,l,m){var x,C,I,M=n.get(u||"$translateDefaultInterpolation"),P=!1,R={},N={},F=function(e,n,r){if(angular.isArray(e)){var s=function(e){for(var t={},i=[],o=function(e){var i=m.defer(),o=function(n){t[e]=n,i.resolve([e,n])};return F(e,n,r).then(o,o),i.promise},s=0,a=e.length;a>s;s++)i.push(o(e[s]));return m.all(i).then(function(){return t})};return s(e)}var l=m.defer();e&&(e=k.apply(e));var c=function(){var e=t?N[t]:N[o];if(C=0,a&&!e){var n=x.get(v);if(e=N[n],i&&i.length){var r=$(i,n);C=r>-1?r+=1:0,i.push(t)}}return e}();return c?c.then(function(){K(e,n,r).then(l.resolve,l.reject)},l.reject):K(e,n,r).then(l.resolve,l.reject),l.promise},L=function(e){return p&&(e=[p,e].join(" ")),f&&(e=[e,f].join(" ")),e},j=function(e){o=e,l.$emit("$translateChangeSuccess"),a&&x.set(F.storageKey(),o),M.setLocale(o),angular.forEach(R,function(e,t){R[t].setLocale(o)}),l.$emit("$translateChangeEnd")},U=function(e){if(!e)throw"No language key specified for loading.";var t=m.defer();return l.$emit("$translateLoadingStart"),P=!0,n.get(h)(angular.extend(d,{key:e})).then(function(n){var i={};l.$emit("$translateLoadingSuccess"),angular.isArray(n)?angular.forEach(n,function(e){angular.extend(i,E(e))}):angular.extend(i,E(n)),P=!1,t.resolve({key:e,table:i}),l.$emit("$translateLoadingEnd")},function(e){l.$emit("$translateLoadingError"),t.reject(e),l.$emit("$translateLoadingEnd")}),t.promise};if(a&&(x=n.get(a),!x.get||!x.set))throw new Error("Couldn't use storage '"+a+"', missing get() or set() method!");angular.isFunction(M.useSanitizeValueStrategy)&&M.useSanitizeValueStrategy(y),b.length&&angular.forEach(b,function(e){var i=n.get(e);i.setLocale(t||o),angular.isFunction(i.useSanitizeValueStrategy)&&i.useSanitizeValueStrategy(y),R[i.getInterpolationIdentifier()]=i});var H=function(e){var t=m.defer();return Object.prototype.hasOwnProperty.call(g,e)?(t.resolve(g[e]),t.promise):(N[e].then(function(e){T(e.key,e.table),t.resolve(e.table)},t.reject),t.promise)},W=function(e,t,n,i){var r=m.defer();return H(e).then(function(s){Object.prototype.hasOwnProperty.call(s,t)?(i.setLocale(e),r.resolve(i.interpolate(s[t],n)),i.setLocale(o)):r.reject()},r.reject),r.promise},B=function(e,t,n,i){var r,s=g[e];return Object.prototype.hasOwnProperty.call(s,t)&&(i.setLocale(e),r=i.interpolate(s[t],n),i.setLocale(o)),r},z=function(e){if(c){var t=n.get(c)(e,o);return void 0!==t?t:e}return e},q=function(e,t,n,r){var o=m.defer();if(e<i.length){var s=i[e];W(s,t,n,r).then(function(e){o.resolve(e)},function(){var i=q(e+1,t,n,r);o.resolve(i)})}else o.resolve(z(t));return o.promise},V=function(e,t,n,r){var o;if(e<i.length){var s=i[e];o=B(s,t,n,r),o||(o=V(e+1,t,n,r))}return o},Y=function(e,t,n){return q(I>0?I:C,e,t,n)},G=function(e,t,n){return V(I>0?I:C,e,t,n)},K=function(e,t,n){var r=m.defer(),s=o?g[o]:g,a=n?R[n]:M;if(s&&Object.prototype.hasOwnProperty.call(s,e)){var l=s[e];"@:"===l.substr(0,2)?F(l.substr(2),t,n).then(r.resolve,r.reject):r.resolve(a.interpolate(l,t))}else{var u;c&&!P&&(u=z(e)),o&&i&&i.length?Y(e,t,a).then(function(e){r.resolve(e)},function(e){r.reject(L(e))}):c&&!P&&u?r.resolve(u):r.reject(L(e))}return r.promise},X=function(e,t,n){var r,s=o?g[o]:g,a=n?R[n]:M;if(s&&Object.prototype.hasOwnProperty.call(s,e)){var l=s[e];r="@:"===l.substr(0,2)?X(l.substr(2),t,n):a.interpolate(l,t)}else{var u;c&&!P&&(u=z(e)),o&&i&&i.length?(C=0,r=G(e,t,a)):r=c&&!P&&u?u:L(e)}return r};if(F.preferredLanguage=function(e){return e&&D(e),t},F.cloakClassName=function(){return w},F.fallbackLanguage=function(e){if(void 0!==e&&null!==e){if(A(e),h&&i&&i.length)for(var t=0,n=i.length;n>t;t++)N[i[t]]||(N[i[t]]=U(i[t]));F.use(F.use())}return r?i[0]:i},F.useFallbackLanguage=function(e){if(void 0!==e&&null!==e)if(e){var t=$(i,e);t>-1&&(I=t)}else I=0},F.proposedLanguage=function(){return s},F.storage=function(){return x},F.use=function(e){if(!e)return o;var t=m.defer();l.$emit("$translateChangeStart");var n=S(e);return n&&(e=n),g[e]||!h||N[e]?(t.resolve(e),j(e)):(s=e,N[e]=U(e).then(function(n){T(n.key,n.table),t.resolve(n.key),s===e&&(j(n.key),s=void 0)},function(e){s=void 0,l.$emit("$translateChangeError"),t.reject(e),l.$emit("$translateChangeEnd")})),t.promise},F.storageKey=function(){return O()},F.isPostCompilingEnabled=function(){return _},F.refresh=function(e){function t(){r.resolve(),l.$emit("$translateRefreshEnd")}function n(){r.reject(),l.$emit("$translateRefreshEnd")}if(!h)throw new Error("Couldn't refresh translation table, no loader registered!");var r=m.defer();if(l.$emit("$translateRefreshStart"),e)g[e]?U(e).then(function(n){T(n.key,n.table),e===o&&j(o),t()},n):n();else{var s=[];if(i&&i.length)for(var a=0,c=i.length;c>a;a++)s.push(U(i[a]));o&&s.push(U(o)),m.all(s).then(function(e){angular.forEach(e,function(e){g[e.key]&&delete g[e.key],T(e.key,e.table)}),o&&j(o),t()})}return r.promise},F.instant=function(e,n,r){if(null===e||angular.isUndefined(e))return e;if(angular.isArray(e)){for(var s={},a=0,l=e.length;l>a;a++)s[e[a]]=F.instant(e[a],n,r);return s}if(angular.isString(e)&&e.length<1)return e;e&&(e=k.apply(e));var u,h=[];t&&h.push(t),o&&h.push(o),i&&i.length&&(h=h.concat(i));for(var d=0,p=h.length;p>d;d++){var f=h[d];if(g[f]&&"undefined"!=typeof g[f][e]&&(u=X(e,n,r)),"undefined"!=typeof u)break}return u||""===u||(u=e,c&&!P&&(u=z(e))),u},h&&(angular.equals(g,{})&&F.use(F.use()),i&&i.length))for(var Q=function(e){T(e.key,e.table)},J=0,Z=i.length;Z>J;J++)N[i[J]]=U(i[J]).then(Q);return F}]}]),angular.module("pascalprecht.translate").factory("$translateDefaultInterpolation",["$interpolate",function(e){var t,n={},i="default",r=null,o={escaped:function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=angular.element("<div></div>").text(e[n]).html());return t}},s=function(e){var t;return t=angular.isFunction(o[r])?o[r](e):e};return n.setLocale=function(e){t=e},n.getInterpolationIdentifier=function(){return i},n.useSanitizeValueStrategy=function(e){return r=e,this},n.interpolate=function(t,n){return r&&(n=s(n)),e(t)(n||{})},n}]),angular.module("pascalprecht.translate").constant("$STORAGE_KEY","NG_TRANSLATE_LANG_KEY"),angular.module("pascalprecht.translate").directive("translate",["$translate","$q","$interpolate","$compile","$parse","$rootScope",function(e,t,n,i,r,o){return{restrict:"AE",scope:!0,compile:function(t,s){var a=s.translateValues?s.translateValues:void 0,l=s.translateInterpolation?s.translateInterpolation:void 0,c=t[0].outerHTML.match(/translate-value-+/i),u="^(.*)("+n.startSymbol()+".*"+n.endSymbol()+")(.*)";return function(t,h,d){if(t.interpolateParams={},t.preText="",t.postText="",d.$observe("translate",function(e){if(angular.equals(e,"")||!angular.isDefined(e)){var i=h.text().match(u);angular.isArray(i)?(t.preText=i[1],t.postText=i[3],t.translationId=n(i[2])(t.$parent)):t.translationId=h.text().replace(/^\s+|\s+$/g,"")}else t.translationId=e}),d.$observe("translateDefault",function(e){t.defaultText=e}),a&&d.$observe("translateValues",function(e){e&&t.$parent.$watch(function(){angular.extend(t.interpolateParams,r(e)(t.$parent))})}),c){var p=function(e){d.$observe(e,function(n){t.interpolateParams[angular.lowercase(e.substr(14,1))+e.substr(15)]=n})};for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&"translateValue"===f.substr(0,14)&&"translateValues"!==f&&p(f)}var g=function(t,n,r){r||"undefined"==typeof n.defaultText||(t=n.defaultText),h.html(n.preText+t+n.postText);var o=e.isPostCompilingEnabled(),a="undefined"!=typeof s.translateCompile,l=a&&"false"!==s.translateCompile;(o&&!a||l)&&i(h.contents())(n)},m=function(){return a||c?function(){var n=function(){t.translationId&&t.interpolateParams&&e(t.translationId,t.interpolateParams,l).then(function(e){g(e,t,!0)},function(e){g(e,t,!1)})};t.$watch("interpolateParams",n,!0),t.$watch("translationId",n)}:function(){var n=t.$watch("translationId",function(i){t.translationId&&i&&e(i,{},l).then(function(e){g(e,t,!0),n()},function(e){g(e,t,!1),n()})},!0)}}(),v=o.$on("$translateChangeSuccess",m);m(),t.$on("$destroy",v)}}}}]),angular.module("pascalprecht.translate").directive("translateCloak",["$rootScope","$translate",function(e,t){return{compile:function(n){var i=e.$on("$translateChangeEnd",function(){n.removeClass(t.cloakClassName()),i(),i=null});n.addClass(t.cloakClassName())}}}]),angular.module("pascalprecht.translate").filter("translate",["$parse","$translate",function(e,t){return function(n,i,r){return angular.isObject(i)||(i=e(i)(this)),t.instant(n,i,r)}}]),angular.module("pascalprecht.translate").factory("$translateStaticFilesLoader",["$q","$http",function(e,t){return function(n){if(!n||!angular.isString(n.prefix)||!angular.isString(n.suffix))throw new Error("Couldn't load static files, no prefix or suffix specified!");var i=e.defer();return t({url:[n.prefix,n.key,n.suffix].join(""),method:"GET",params:""}).success(function(e){i.resolve(e)}).error(function(){i.reject(n.key)}),i.promise}}]),function(e){function t(t,n){var i;return e.Notification?i=new e.Notification(t,{icon:b(n.icon)?n.icon:n.icon.x32,body:n.body||f,tag:n.tag||f}):e.webkitNotifications?(i=e.webkitNotifications.createNotification(n.icon,t,n.body),i.show()):navigator.mozNotification?(i=navigator.mozNotification.createNotification(t,n.body,n.icon),i.show()):e.external&&e.external.msIsSiteMode()&&(e.external.msSiteModeClearIconOverlay(),e.external.msSiteModeSetIconOverlay(b(n.icon)?n.icon:n.icon.x16,t),e.external.msSiteModeActivate(),i={ieVerification:m+1}),i}function n(t){return{close:function(){t&&(t.close?t.close():t.cancel?t.cancel():e.external&&e.external.msIsSiteMode()&&t.ieVerification===m&&e.external.msSiteModeClearIconOverlay())}}}function i(t){if(g){var n=v(t)?t:_;e.webkitNotifications&&e.webkitNotifications.checkPermission?e.webkitNotifications.requestPermission(n):e.Notification&&e.Notification.requestPermission&&e.Notification.requestPermission(n)}}function r(){var t;return g?(e.Notification&&e.Notification.permissionLevel?t=e.Notification.permissionLevel():e.webkitNotifications&&e.webkitNotifications.checkPermission?t=h[e.webkitNotifications.checkPermission()]:e.Notification&&e.Notification.permission?t=e.Notification.permission:navigator.mozNotification?t=c:e.external&&void 0!==e.external.msIsSiteMode()&&(t=e.external.msIsSiteMode()?c:l),t):void 0}function o(e){return e&&y(e)&&w(x,e),x}function s(){return x.pageVisibility?document.hidden||document.msHidden||document.mozHidden||document.webkitHidden:!0}function a(i,o){var a,l;return g&&s()&&b(i)&&o&&(b(o.icon)||y(o.icon))&&r()===c&&(a=t(i,o)),l=n(a),x.autoClose&&a&&!a.ieVerification&&a.addEventListener&&a.addEventListener("show",function(){var t=l;e.setTimeout(function(){t.close()},x.autoClose)}),l}var l="default",c="granted",u="denied",h=[c,l,u],d={pageVisibility:!1,autoClose:0},p={},f="",g=function(){var t=!1;try{t=!!(e.Notification||e.webkitNotifications||navigator.mozNotification||e.external&&void 0!==e.external.msIsSiteMode())}catch(n){}return t}(),m=Math.floor(10*Math.random()+1),v=function(e){return e&&e.constructor===Function},b=function(e){return e&&e.constructor===String},y=function(e){return e&&e.constructor===Object},w=function(e,t){var n,i;for(n in t)i=t[n],n in e&&(e[n]===i||n in p&&p[n]===i)||(e[n]=i);return e},_=function(){},x=d;e.notify={PERMISSION_DEFAULT:l,PERMISSION_GRANTED:c,PERMISSION_DENIED:u,isSupported:g,config:o,createNotification:a,permissionLevel:r,requestPermission:i},v(Object.seal)&&Object.seal(e.notify)}(window),!function(e){!function(e,t,n){function i(e){if("string"==typeof e)return e;var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&").replace(/\+/g,"%20")}function r(e,t){return t?u.hasCapabilities("classList")?e.classList.contains(t):e.className.indexOf(t)>-1:!1}function o(e,t){if(t&&0!==t.length&&1===e.nodeType){var n=t.length,i=0;if(u.hasCapabilities("classList"))for(;n>i;++i)e.classList.toggle(t[i]);else{for(var o=(" "+e.className+" ").replace(/[\s+]/," ");n>i;++i)r(e,t[i])?o=o.replace(" "+t[i]+" "," "):o+=t[i]+" ";e.className=u.trim(o)}}}function s(e,t){if(t&&0!==t.length&&1===e.nodeType){var n=t.length,i=0;if(u.hasCapabilities("classList"))for(;n>i;++i)e.classList.add(t[i]);else if(e.className||1!==t.length){for(var r=" "+e.className+" ";n>i;++i)~r.indexOf(" "+t[i]+" ")||(r+=t[i]+" ");e.className=u.trim(r)}else e.className=t.join(" ")}}function a(e,t){if(t&&0!==t.length&&1===e.nodeType){var n=t.length,i=0;if(u.hasCapabilities("classList"))for(;n>i;++i)e.classList.remove(t[i]);else{for(var r=(" "+e.className+" ").replace(/[\s+]/," ");n>i;++i)r=r.replace(" "+t[i]+" "," ");e.className=u.trim(r)}}}var l=Array.prototype.slice,c=/^#([\w-]*)$/,t=function(n,i){var r=[];if("string"==typeof n){var o=c.exec(n);if(i=i||document,o&&o[1]){var s=i.getElementById(o[1]);s&&r.push(s)}else r=i.querySelectorAll(n)}else n&&(n.nodeType||e.XMLHttpRequest&&n instanceof XMLHttpRequest)?(r=[n],i=n):t.isArray(n)&&(r=n.slice(),i=null);return new d(r,i)},u=t,h=function(e){if("IE"!==u.env.name||u.env.version>9)return l.call(e);for(var t=[],n=0,i=e.length;i>n;++n)t.push(e[n]);return t},d=function(e,t){var n=h(e);this.context=t,this.toArray=function(){return n},this.length=n.length,this.first=n[0],this.last=n[n.length-1],this.get=function(e){return void 0===e?n:n[e]}};d.prototype.some=function(e,t){return u.some(this.get(),e,t)},d.prototype.forEach=function(e,t){return u.forEach(this.get(),e,t),this},d.prototype.map=function(e,t){return new d(u.map(this.get(),e,t),this.context)},d.prototype.filter=function(e,t){return new d(u.filter(this.get(),e,t),this.context)},d.prototype.find=function(e){return u(e,this.first)};var p=e.OTHelpers;e.OTHelpers=t,e.___othelpers=!0,t.keys=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t};var f=Array.prototype.forEach||function(e,t){for(var n=0,i=this.length||0;i>n;++n)n in this&&e.call(t,this[n],n)};t.forEach=function(e,t,n){return f.call(e,t,n)};var g=Array.prototype.map||function(e,t){var n=[];return f.call(this,function(i,r){n.push(e.call(t,i,r))}),n};t.map=function(e,t){return g.call(e,t)};var m=Array.prototype.filter||function(e,t){var n=[];return f.call(this,function(i,r){e.call(t,i,r)&&n.push(i)}),n};t.filter=function(e,t,n){return m.call(e,t,n)};var v=Array.prototype.some||function(e,t){for(var n=!1,i=0,r=this.length||0;r>i;++i)if(i in this&&e.call(t,this[i],i)){n=!0;break}return n};t.find=function(e,t,n){if(!u.isFunction(t))throw new TypeError("iter must be a function");for(var i=void 0,r=0,o=e.length||0;o>r;++r)if(r in e&&t.call(n,e[r],r)){i=e[r];break}return i},t.findIndex=function(e,t,n){if(!u.isFunction(t))throw new TypeError("iter must be a function");for(var i=0,r=e.length||0;r>i;++i)if(i in e&&t.call(n,e[i],i,e))return i;return-1},t.some=function(e,t,n){return v.call(e,t,n)};var b=Array.prototype.indexOf||function(e,t){var n,i,r=t?t:0;if(!this)throw new TypeError;if(i=this.length,0===i||r>=i)return-1;for(0>r&&(r=i-Math.abs(r)),n=r;i>n;n++)if(this[n]===e)return n;return-1};t.arrayIndexOf=function(e,t,n){return b.call(e,t,n)};var y=Function.prototype.bind||function(){var e=l.call(arguments),t=e.shift(),n=this;return function(){return n.apply(t,e.concat(l.call(arguments)))}};t.bind=function(){var e=l.call(arguments),t=e.shift();return y.apply(t,e)};var w=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};t.trim=function(e){return w.call(e)},t.noConflict=function(){return t.noConflict=function(){return t},e.OTHelpers=p,t},t.isNone=function(e){return void 0===e||null===e},t.isObject=function(e){return e===Object(e)},t.isFunction=function(e){return!!e&&(-1!==e.toString().indexOf("()")||"[object Function]"===Object.prototype.toString.call(e))},t.isArray=t.isFunction(Array.isArray)&&Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isEmpty=function(e){if(null===e||void 0===e)return!0;if(t.isArray(e)||"string"==typeof e)return 0===e.length;for(var n in e)if(e.hasOwnProperty(n))return!1;return!0},t.extend=function(){var e=l.call(arguments),n=e.shift();return t.forEach(e,function(e){for(var t in e)n[t]=e[t]}),n},t.defaults=function(){var e=l.call(arguments),n=e.shift();return t.forEach(e,function(e){for(var t in e)void 0===n[t]&&(n[t]=e[t])}),n},t.clone=function(e){return t.isObject(e)?t.isArray(e)?e.slice():t.extend({},e):e},t.noop=function(){},t.now=function(){var n,i=e.performance||{},r=i.now||i.mozNow||i.msNow||i.oNow||i.webkitNow;return r?(r=t.bind(r,i),n=i.timing.navigationStart,function(){return n+r()}):function(){return(new Date).getTime()}}(),t.canDefineProperty=!0;try{Object.defineProperty({},"x",{})}catch(_){t.canDefineProperty=!1}t.defineGetters=function(e,n,i){var r={};void 0===i&&(i=!1);for(var o in n)r[o]={get:n[o],enumerable:i};t.defineProperties(e,r)};var x=function(e,t,n){return t&&!n?function(){return t.call(e)}:t&&n?function(i){return void 0!==i&&n.call(e,i),t.call(e)}:function(t){void 0!==t&&n.call(e,t)}};t.defineProperties=function(e,t){for(var n in t)e[n]=x(e,t[n].get,t[n].set)},Object.create||(Object.create=function(e){function t(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return t.prototype=e,new t}),t.invert=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t},t.Event=function(){return function(e,i){this.type=e,this.cancelable=i!==n?i:!0;var r=!1;this.preventDefault=function(){this.cancelable?r=!0:t.warn("Event.preventDefault :: Trying to preventDefault on an Event that isn't cancelable")},this.isDefaultPrevented=function(){return r}}},t.statable=function(e,n,i,r,o){var s,a=e.currentState=i,l=function(i){if(a!==i){if(-1===t.arrayIndexOf(n,i))return void(o&&t.isFunction(o)&&o("invalidState",i));e.previousState=s=a,e.currentState=a=i,r&&t.isFunction(r)&&r(i,s)}};return e.is=function(){return-1!==t.arrayIndexOf(arguments,a)},e.isNot=function(){return-1===t.arrayIndexOf(arguments,a)},l},function(){function n(e,t,n){var i=t&&n||0,r=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>r&&(t[i+r++]=d[e])});16>r;)t[i+r++]=0;return t}function i(e,t){var n=t||0,i=h;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new u(16):null,e=null),e=e||{};var o=e.random||(e.rng||c)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;16>s;s++)t[r+s]=o[s];return t||i(o)}var o,s,a=new Array(16);if(o=function(){var e,t=a,n=0;for(n=0;16>n;n++)0===(3&n)&&(e=4294967296*Math.random()),t[n]=e>>>((3&n)<<3)&255;return t},e.crypto&&crypto.getRandomValues){var l=new Uint32Array(4);s=function(){crypto.getRandomValues(l);for(var e=0;16>e;e++)a[e]=l[e>>2]>>>8*(3&e)&255;return a}}for(var c=s||o,u="function"==typeof Buffer?Buffer:Array,h=[],d={},p=0;256>p;p++)h[p]=(p+256).toString(16).substr(1),d[h[p]]=p;var f=r;f.v4=r,f.parse=n,f.unparse=i,f.BufferClass=u,f.mathRNG=o,f.whatwgRNG=s,t.uuid=f}(),function(){"use strict";function i(e){return"function"==typeof e||"object"==typeof e&&null!==e}function r(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(){}function a(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1}function l(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t}function c(e,t){return"onerror"===e?void $e.on("error",t):2!==arguments.length?$e[e]:void($e[e]=t)}function u(){setTimeout(function(){for(var e,t=0;t<ke.length;t++){e=ke[t];var n=e.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),$e.trigger(e.name,e.payload)}ke.length=0},50)}function h(e,t,n){1===ke.push({name:e,payload:{key:t._guidKey,id:t._id,eventName:e,detail:t._result,childId:n&&n._id,label:t._label,timeStamp:_e(),error:$e["instrument-with-stack"]?new Error(t._label):null}})&&u()}function d(){return new TypeError("A promises callback cannot return that same promise.")}function p(){}function f(e){try{return e.then}catch(t){return Ae.error=t,Ae}}function g(e,t,n,i){try{e.call(t,n,i)}catch(r){return r}}function m(e,t,n){$e.async(function(e){var i=!1,r=g(n,t,function(n){i||(i=!0,t!==n?y(e,n):_(e,n))},function(t){i||(i=!0,x(e,t))},"Settle: "+(e._label||" unknown promise"));!i&&r&&(i=!0,x(e,r))},e)}function v(e,t){t._state===Ee?_(e,t._result):t._state===De?(t._onError=null,x(e,t._result)):C(t,n,function(n){t!==n?y(e,n):_(e,n)},function(t){x(e,t)})}function b(e,t){if(t.constructor===e.constructor)v(e,t);else{var i=f(t);i===Ae?x(e,Ae.error):i===n?_(e,t):r(i)?m(e,t,i):_(e,t)}}function y(e,t){e===t?_(e,t):i(t)?b(e,t):_(e,t)}function w(e){e._onError&&e._onError(e._result),$(e)}function _(e,t){e._state===Te&&(e._result=t,e._state=Ee,0===e._subscribers.length?$e.instrument&&Se("fulfilled",e):$e.async($,e))}function x(e,t){e._state===Te&&(e._state=De,e._result=t,$e.async(w,e))}function C(e,t,n,i){var r=e._subscribers,o=r.length;e._onError=null,r[o]=t,r[o+Ee]=n,r[o+De]=i,0===o&&e._state&&$e.async($,e)}function $(e){var t=e._subscribers,n=e._state;if($e.instrument&&Se(n===Ee?"fulfilled":"rejected",e),0!==t.length){for(var i,r,o=e._result,s=0;s<t.length;s+=3)i=t[s],r=t[s+n],i?T(n,i,r,o):r(o);e._subscribers.length=0}}function k(){this.error=null}function S(e,t){try{return e(t)}catch(n){return Oe.error=n,Oe}}function T(e,t,n,i){var o,s,a,l,c=r(n);if(c){if(o=S(n,i),o===Oe?(l=!0,s=o.error,o=null):a=!0,t===o)return void x(t,d())}else o=i,a=!0;t._state!==Te||(c&&a?y(t,o):l?x(t,s):e===Ee?_(t,o):e===De&&x(t,o))}function E(e,t){var n=!1;try{t(function(t){n||(n=!0,y(e,t))},function(t){n||(n=!0,x(e,t))})}catch(i){x(e,i)}}function D(e,t,n){return e===Ee?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function A(e,t,n,i){this._instanceConstructor=e,this.promise=new e(p,i),this._abortOnReject=n,this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?_(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&_(this.promise,this._result))):x(this.promise,this._validationError())}function O(e,t){return new Ie(this,e,!0,t).promise}function I(e,t){function i(e){y(s,e)}function r(e){x(s,e)}var o=this,s=new o(p,t);if(!we(e))return x(s,new TypeError("You must pass an array to race.")),s;for(var a=e.length,l=0;s._state===Te&&a>l;l++)C(o.resolve(e[l]),n,i,r);return s}function M(e,t){var n=this;if(e&&"object"==typeof e&&e.constructor===n)return e;var i=new n(p,t);return y(i,e),i}function P(e,t){var n=this,i=new n(p,t);return x(i,e),i}function R(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function F(e,t){this._id=Le++,this._label=t,this._state=n,this._result=n,this._subscribers=[],$e.instrument&&Se("created",this),p!==e&&(r(e)||R(),this instanceof F||N(),E(this,e))}function L(e,t,n){this._superConstructor(e,t,!1,n)}function j(e,t){return new L(je,e,t).promise}function U(e,t){return je.all(e,t)}function H(e,t){Qe[ze]=e,Qe[ze+1]=t,ze+=2,2===ze&&He()}function W(){var e=process.nextTick,t=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(t)&&"0"===t[1]&&"10"===t[2]&&(e=setImmediate),function(){e(Y)}}function B(){return function(){Ue(Y)}}function z(){var e=0,t=new Ge(Y),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function q(){var e=new MessageChannel;return e.port1.onmessage=Y,function(){e.port2.postMessage(0)}}function V(){return function(){setTimeout(Y,1)}}function Y(){for(var e=0;ze>e;e+=2){var t=Qe[e],i=Qe[e+1];t(i),Qe[e]=n,Qe[e+1]=n}ze=0}function G(){try{var e=require,t=e("vertx");return Ue=t.runOnLoop||t.runOnContext,B()}catch(n){return V()}}function K(e){var t={};return t.promise=new je(function(e,n){t.resolve=e,t.reject=n},e),t}function X(e,t,n){return je.all(e,n).then(function(e){if(!r(t))throw new TypeError("You must pass a function as filter's second argument.");for(var i=e.length,o=new Array(i),s=0;i>s;s++)o[s]=t(e[s]);return je.all(o,n).then(function(t){for(var n=new Array(i),r=0,o=0;i>o;o++)t[o]&&(n[r]=e[o],r++);return n.length=r,n})})}function Q(e,t,n){this._superConstructor(e,t,!0,n)}function J(e,t,n){this._superConstructor(e,t,!1,n)}function Z(e,t){return new J(je,e,t).promise}function ee(e,t){return new et(je,e,t).promise}function te(e,t,n){return je.all(e,n).then(function(e){if(!r(t))throw new TypeError("You must pass a function as map's second argument.");for(var i=e.length,o=new Array(i),s=0;i>s;s++)o[s]=t(e[s]);return je.all(o,n)})}function ne(){this.value=n}function ie(e){try{return e.then}catch(t){return rt.value=t,rt}}function re(e,t,n){try{e.apply(t,n)}catch(i){return rt.value=i,rt}}function oe(e,t){for(var n,i,r={},o=e.length,s=new Array(o),a=0;o>a;a++)s[a]=e[a];for(i=0;i<t.length;i++)n=t[i],r[n]=s[i+1];return r}function se(e){for(var t=e.length,n=new Array(t-1),i=1;t>i;i++)n[i-1]=e[i];return n}function ae(e,t){return{then:function(n,i){return e.call(t,n,i)}}}function le(e,t){var i=function(){for(var i,r=this,o=arguments.length,s=new Array(o+1),a=!1,l=0;o>l;++l){if(i=arguments[l],!a){if(a=he(i),a===ot){var c=new je(p);return x(c,ot.value),c}a&&a!==!0&&(i=ae(a,i))}s[l]=i}var u=new je(p);return s[o]=function(e,i){e?x(u,e):t===n?y(u,i):t===!0?y(u,se(arguments)):we(t)?y(u,oe(arguments,t)):y(u,i)},a?ue(u,s,e,r):ce(u,s,e,r)};return i.__proto__=e,i}function ce(e,t,n,i){var r=re(n,i,t);return r===rt&&x(e,r.value),e}function ue(e,t,n,i){return je.all(t).then(function(t){var r=re(n,i,t);return r===rt&&x(e,r.value),e})}function he(e){return e&&"object"==typeof e?e.constructor===je?!0:ie(e):!1}function de(e,t){return je.race(e,t)}function pe(e,t){return je.reject(e,t)}function fe(e,t){return je.resolve(e,t)}function ge(e){throw setTimeout(function(){throw e}),e}function me(e,t){$e.async(e,t)}function ve(){$e.on.apply($e,arguments)}function be(){$e.off.apply($e,arguments)}var ye;ye=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var we=ye,_e=Date.now||function(){return(new Date).getTime()},xe=Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return s.prototype=e,new s},Ce={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=n,e},on:function(e,t){var n,i=l(this);n=i[e],n||(n=i[e]=[]),-1===a(n,t)&&n.push(t)},off:function(e,t){var n,i,r=l(this);return t?(n=r[e],i=a(n,t),void(-1!==i&&n.splice(i,1))):void(r[e]=[])},trigger:function(e,t){var n,i,r=l(this);if(n=r[e])for(var o=0;o<n.length;o++)(i=n[o])(t)}},$e={instrument:!1};Ce.mixin($e);var ke=[],Se=h,Te=void 0,Ee=1,De=2,Ae=new k,Oe=new k,Ie=A;A.prototype._validateInput=function(e){return we(e)},A.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},A.prototype._init=function(){this._result=new Array(this.length)},A.prototype._enumerate=function(){for(var e=this.length,t=this.promise,n=this._input,i=0;t._state===Te&&e>i;i++)this._eachEntry(n[i],i)},A.prototype._eachEntry=function(e,t){var n=this._instanceConstructor;o(e)?e.constructor===n&&e._state!==Te?(e._onError=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(n.resolve(e),t):(this._remaining--,this._result[t]=this._makeResult(Ee,t,e))},A.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===Te&&(this._remaining--,this._abortOnReject&&e===De?x(i,n):this._result[t]=this._makeResult(e,t,n)),0===this._remaining&&_(i,this._result)},A.prototype._makeResult=function(e,t,n){return n},A.prototype._willSettleAt=function(e,t){var i=this;C(e,n,function(e){i._settledAt(Ee,t,e)},function(e){i._settledAt(De,t,e)})};var Me=O,Pe=I,Re=M,Ne=P,Fe="rsvp_"+_e()+"-",Le=0,je=F;F.cast=Re,F.all=Me,F.race=Pe,F.resolve=Re,F.reject=Ne,F.prototype={constructor:F,_guidKey:Fe,
_onError:function(e){$e.async(function(t){setTimeout(function(){t._onError&&$e.trigger("error",e)},0)},this)},then:function(e,t,n){var i=this,r=i._state;if(r===Ee&&!e||r===De&&!t)return $e.instrument&&Se("chained",this,this),this;i._onError=null;var o=new this.constructor(p,n),s=i._result;if($e.instrument&&Se("chained",i,o),r){var a=arguments[r-1];$e.async(function(){T(r,o,a,s)})}else C(i,o,e,t);return o},"catch":function(e,t){return this.then(null,e,t)},"finally":function(e,t){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})},t)}},L.prototype=xe(Ie.prototype),L.prototype._superConstructor=Ie,L.prototype._makeResult=D,L.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Ue,He,We=j,Be=U,ze=0,qe=({}.toString,H),Ve="undefined"!=typeof e?e:n,Ye=Ve||{},Ge=Ye.MutationObserver||Ye.WebKitMutationObserver,Ke="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Xe="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Qe=new Array(1e3);He=Ke?W():Ge?z():Xe?q():Ve===n&&"function"==typeof require?G():V();var Je=K,Ze=X,et=Q;Q.prototype=xe(Ie.prototype),Q.prototype._superConstructor=Ie,Q.prototype._init=function(){this._result={}},Q.prototype._validateInput=function(e){return e&&"object"==typeof e},Q.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},Q.prototype._enumerate=function(){var e=this.promise,t=this._input,n=[];for(var i in t)e._state===Te&&t.hasOwnProperty(i)&&n.push({position:i,entry:t[i]});var r=n.length;this._remaining=r;for(var o,s=0;e._state===Te&&r>s;s++)o=n[s],this._eachEntry(o.entry,o.position)},J.prototype=xe(et.prototype),J.prototype._superConstructor=Ie,J.prototype._makeResult=D,J.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var tt=Z,nt=ee,it=te,rt=new ne,ot=new ne,st=le,at=de,lt=pe,ct=fe,ut=ge;if($e.async=qe,"undefined"!=typeof e&&"object"==typeof e.__PROMISE_INSTRUMENTATION__){var ht=e.__PROMISE_INSTRUMENTATION__;c("instrument",!0);for(var dt in ht)ht.hasOwnProperty(dt)&&ve(dt,ht[dt])}var pt={race:at,Promise:je,allSettled:We,hash:nt,hashSettled:tt,denodeify:st,on:ve,off:be,map:it,filter:Ze,resolve:ct,reject:lt,all:Be,rethrow:ut,defer:Je,EventTarget:Ce,configure:c,async:me};t.RSVP=pt}.call(this);var C,$=["description","fileName","lineNumber","message","name","number","stack"];t.Error=function(e,t,n){switch(arguments.length){case 1:u.isObject(e)&&(n=e,t=void 0,e=void 0);break;case 2:u.isObject(t)&&(n=t,t=void 0)}if(n instanceof Error)for(var i=0,r=$.length;r>i;++i)this[$[i]]=n[$[i]];else if(u.isObject(n))for(var o in n)n.hasOwnProperty(o)&&(this[o]=n[o]);if(!(this.fileName&&this.lineNumber&&this.columnNumber&&this.stack)){var s=C();!this.fileName&&s.fileName&&(this.fileName=s.fileName),!this.lineNumber&&s.lineNumber&&(this.lineNumber=s.lineNumber),!this.columnNumber&&s.columnNumber&&(this.columnNumber=s.columnNumber),!this.stack&&s.stack&&(this.stack=s.stack)}!this.message&&e&&(this.message=e),!this.name&&t&&(this.name=t)},t.Error.prototype.toString=t.Error.prototype.valueOf=function(){var e="";return this.fileName&&(e+=" "+this.fileName),this.lineNumber&&(e+=" "+this.lineNumber,this.columnNumber&&(e+=":"+this.columnNumber)),"<"+(this.name?this.name+" ":"")+this.message+e+">"};var k=function(e,t){return u.map(t.slice(2),function(e){var t={fileName:e.getFileName(),linenumber:e.getLineNumber(),columnNumber:e.getColumnNumber()};return e.getFunctionName()&&(t.functionName=e.getFunctionName()),e.getMethodName()&&(t.methodName=e.getMethodName()),e.getThis()&&(t.self=e.getThis()),t})};C=function(){var t,n,i,r={};switch(u.env.name){case"Firefox":case"Safari":case"IE":if("IE"===u.env.name)i=new Error;else try{e.call.js.is.explody}catch(o){i=o}t=i.stack.split("\n"),t.shift(),t.shift(),r.stack=t,"IE"===u.env.name&&(r.stack.shift(),r.stack=u.map(t,function(e){return e.replace(/^\s+at\s+/g,"")})),n=/@(.+?):([0-9]+)(:([0-9]+))?$/.exec(t[0]),n&&(r.fileName=n[1],r.lineNumber=parseInt(n[2],10),n.length>3&&(r.columnNumber=parseInt(n[4],10)));break;case"Chrome":case"Node":case"Opera":var s=Error.prepareStackTrace;Error.prepareStackTrace=k,i=new Error,r.stack=i.stack,Error.prepareStackTrace=s;var a=r.stack[0];r.lineNumber=a.lineNumber,r.columnNumber=a.columnNumber,r.fileName=a.fileName,a.functionName&&(r.functionName=a.functionName),a.methodName&&(r.methodName=a.methodName),a.self&&(r.self=a.self);break;default:i=new Error,i.stack&&(r.stack=i.stack.split("\n"))}return i.message&&(r.message=i.message),r},function(){var n=-1,i=function(e){if(e===n)return!0;if("number"==typeof e&&"number"==typeof n)return e>n;for(var t=e.split("."),i=n.split("."),r=(t.length>i.length?i:t).length,o=0;r>o;++o)if(parseInt(t[o],10)>parseInt(i[o],10))return!0;return o<t.length?!0:!1},r=function(){if("undefined"!=typeof process&&"undefined"!=typeof process.versions&&"string"==typeof process.versions.node)return n=process.versions.node,"v"===n.substr(1)&&(n=n.substr(1)),{name:"Node",version:n,userAgent:"Node "+n,iframeNeedsLoad:!1,versionGreaterThan:i};var t,r=e.navigator.userAgent.toLowerCase(),o=e.navigator.appName,s="unknown";return r.indexOf("opera")>-1||r.indexOf("opr")>-1?(s="Opera",null!==/opr\/([0-9]{1,}[\.0-9]{0,})/.exec(r)&&(n=parseFloat(RegExp.$1))):r.indexOf("firefox")>-1?(s="Firefox",null!==/firefox\/([0-9]{1,}[\.0-9]{0,})/.exec(r)&&(n=parseFloat(RegExp.$1))):"Microsoft Internet Explorer"===o?(s="IE",null!==/msie ([0-9]{1,}[\.0-9]{0,})/.exec(r)&&(n=parseFloat(RegExp.$1))):"Netscape"===o&&r.indexOf("trident")>-1?(s="IE",null!==/trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(r)&&(n=parseFloat(RegExp.$1))):r.indexOf("chrome")>-1?(s="Chrome",null!==/chrome\/([0-9]{1,}[\.0-9]{0,})/.exec(r)&&(n=parseFloat(RegExp.$1))):(t=e.navigator.vendor)&&t.toLowerCase().indexOf("apple")>-1&&(s="Safari",null!==/version\/([0-9]{1,}[\.0-9]{0,})/.exec(r)&&(n=parseFloat(RegExp.$1))),{name:s,version:n,userAgent:e.navigator.userAgent,iframeNeedsLoad:r.indexOf("webkit")<0,versionGreaterThan:i}}();t.env=r,t.browser=function(){return t.env.name},t.browserVersion=function(){return t.env}}();var S;"Node"===u.env.name&&!function(){var e=require("events").EventEmitter,t=require("util"),n=function(){e.call(this),this.events={}};t.inherits(n,e),S=function(){var e=new n,t=e.on,i=e.removeListener;return e.addListeners=function(n,i,r,o){var s={handler:i};r&&(s.context=r),o&&(s.closure=o),u.forEach(n,function(n){e.events[n]||(e.events[n]=[]),e.events[n].push(s),t(n,i);var r=n+":added";e.events[r]&&e.emit(r,e.events[n].length)})},e.removeAllListenersNamed=function(t){var n=t.split(" ");e.removeAllListeners(n),u.forEach(n,function(t){e.events[t]&&delete e.events[t]})},e.removeListeners=function(t,n,r){function o(e){return!(e.handler===n&&e.closure===r)}u.forEach(t.split(" "),function(t){if(e.events[t]){i(t,n),e.events[t]=u.filter(e.events[t],o),0===e.events[t].length&&delete e.events[t];var r=t+":removed";e.events[r]&&e.emit(r,e.events[t]?e.events[t].length:0)}})},e.removeAllListeners=function(){e.events={},e.removeAllListeners()},e.dispatchEvent=function(e,t){this.emit(e.type,e),t&&t.call(null,e)},e.trigger=u.bind(e.emit,e),e}}();var T;if("Node"!==u.env.name&&(T=function(e,t){function n(e,t){e&&e.apply(null,t.slice())}function i(e,t,i){var r=o.events[e];if(r&&0!==r.length){var s=r.length;u.forEach(r,function(r){function a(e){return e.handler===r.handler}u.callAsync(function(){try{o.events[e]&&u.some(o.events[e],a)&&(r.closure||r.handler).apply(r.context||null,t)}finally{s--,0===s&&n(i,t)}})})}}function r(e,t){var n=o.events[e];n&&0!==n.length&&u.forEach(n,function(e){(e.closure||e.handler).apply(e.context||null,t)})}var o={events:{}},s=t===!0?r:i;return o.addListeners=function(e,t,n,i){var r={handler:t};n&&(r.context=n),i&&(r.closure=i),u.forEach(e,function(e){o.events[e]||(o.events[e]=[]),o.events[e].push(r);var t=e+":added";o.events[t]&&s(t,[o.events[e].length])})},o.removeListeners=function(e,t,n){function i(e){var i=e.handler.originalHandler===t||e.handler===t;return!(i&&e.context===n)}u.forEach(e,function(e){if(o.events[e]){o.events[e]=u.filter(o.events[e],i),0===o.events[e].length&&delete o.events[e];var t=e+":removed";o.events[t]&&s(t,[o.events[e]?o.events[e].length:0])}})},o.removeAllListenersNamed=function(e){u.forEach(e,function(e){o.events[e]&&delete o.events[e]})},o.removeAllListeners=function(){o.events={}},o.dispatchEvent=function(e,t){return o.events[e.type]&&0!==o.events[e.type].length?void s(e.type,[e],t):void n(t,[e])},o.trigger=function(e,t){o.events[e]&&0!==o.events[e].length&&s(e,t)},o}),"Node"===e.OTHelpers.env.name){var E=require("request");t.request=function(e,t,n){var i=function(e,t,i){var r={response:t,body:i};!e&&t.statusCode>=200&&(t.statusCode<300||304===t.statusCode)?n(null,r):n(e,r)};"get"===t.method.toLowerCase()?E.get(e,i):E.post(e,t.body,i)},t.getJSON=function(e,t,n){var i=require("underscore").extend({Accept:"application/json"},t.headers||{});E.get({url:e,headers:i,json:!0},function(e,t){n(e,t&&t.body)})}}"Node"!==e.OTHelpers.env.name&&(t.xdomainRequest=function(e,t,n){function r(e,t){o.onload=o.onerror=o.ontimeout=function(){},o=void 0,n(e,t)}var o=new XDomainRequest,s=t||{},a=s.method.toLowerCase();return a?(a=a.toUpperCase(),"GET"!==a&&"POST"!==a?void n(new Error("HTTP method can only be ")):(o.onload=function(){r(null,{target:{responseText:o.responseText,headers:{"content-type":o.contentType}}})},o.onerror=function(){r(new Error("XDomainRequest of "+e+" failed"))},o.ontimeout=function(){r(new Error("XDomainRequest of "+e+" timed out"))},o.open(a,e),void o.send(t.body&&i(t.body)))):void n(new Error("No HTTP method specified in options"))},t.request=function(e,n,r){var o=new XMLHttpRequest,s=n||{},a=s.method;if(!a)return void r(new Error("No HTTP method specified in options"));r&&(t.on(o,"load",function(e){var t=e.target.status;t>=200&&(300>t||304===t)?r(null,e):r(e)}),t.on(o,"error",r)),o.open(n.method,e,!0),s.headers||(s.headers={});for(var l in s.headers)o.setRequestHeader(l,s.headers[l]);o.send(n.body&&i(n.body))},t.getJSON=function(e,n,i){n=n||{};var r=function(e,t){if(e)i(e,t&&t.target&&t.target.responseText);else{var n;try{n=JSON.parse(t.target.responseText)}catch(r){return void i(r,t&&t.target&&t.target.responseText)}i(null,n,t)}};if(n.xdomainrequest)t.xdomainRequest(e,{method:"GET"},r);else{var o=t.extend({Accept:"application/json"},n.headers||{});t.get(e,t.extend(n||{},{headers:o}),r)}});var D=5,A=4,O=3,I=2,M=1,P=0,R=P,N=function(e){return R="number"==typeof e?e:0};t.useLogHelpers=function(n){function i(t,i,r){return function(){if(n.shouldLog(i)){var o=e.console,s=d(arguments);if(o&&o[t])o[t].apply||u?(o[t].apply||(o[t]=Function.prototype.bind.call(o[t],o)),o[t].apply(o,s)):o[t](s);else if(r)return void r.apply(n,s);a(t,d(arguments))}}}function r(){var e=new Date;return e.toLocaleTimeString()+e.getMilliseconds()}function o(e){try{return JSON.stringify(e)}catch(t){return e.toString()}}function s(e){var n=[];if("undefined"==typeof e);else if(null===e)n.push("NULL");else if(t.isArray(e))for(var i=0;i<e.length;++i)n.push(o(e[i]));else if(t.isObject(e))for(var r in e){var s;t.isFunction(e[r])?e.hasOwnProperty(r)&&(s="function "+r+"()"):s=o(e[r]),n.push(r+": "+s)}else if(t.isFunction(e))try{n.push(e.toString())}catch(a){n.push("function()")}else n.push(e.toString());return n.join(", ")}function a(e,t){if(t){var n=s(t);n.length<=2||c.push([e,r(),n])}}n.DEBUG=D,n.LOG=A,n.INFO=O,n.WARN=I,n.ERROR=M,n.NONE=P;var c=[],u=!0;try{Function.prototype.bind.call(e.console.log,e.console)}catch(h){u=!1}var d=function(e){return e};"IE"===t.env.name&&(d=function(e){return[s(l.apply(e))]}),n.log=i("log",n.LOG),n.debug=i("debug",n.DEBUG,n.log),n.info=i("info",n.INFO,n.log),n.warn=i("warn",n.WARN,n.log),n.error=i("error",n.ERROR,n.log),n.setLogLevel=function(e){return n.debug("TB.setLogLevel("+R+")"),N(e)},n.getLogs=function(){return c},n.shouldLog=function(e){return R>=e}},t.useLogHelpers(t),t.setLogLevel(t.ERROR),d.prototype.on=function(e,t){return this.forEach(function(n){if(n.addEventListener)n.addEventListener(e,t,!1);else if(n.attachEvent)n.attachEvent("on"+e,t);else{var i=n["on"+e];n["on"+e]=function(){t.apply(this,arguments),i&&i.apply(this,arguments)}}})},d.prototype.off=function(e,t){return this.forEach(function(n){n.removeEventListener?n.removeEventListener(e,t,!1):n.detachEvent&&n.detachEvent("on"+e,t)})},d.prototype.once=function(e,t){var n=u.bind(function(){this.off(e,n),t.apply(null,arguments)},this);return this.on(e,n)},t.on=function(e,t,n){return u(e).on(t,n)},t.off=function(e,t,n){return u(e).off(t,n)},t.once=function(e,t,n){return u(e).once(t,n)},function(){var n="undefined"==typeof document||"complete"===document.readyState||"interactive"===document.readyState&&document.body,i=[],r=[],o=!1,s=function(){n=!0,"undefined"!=typeof document&&(document.addEventListener?(document.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1)):(document.detachEvent("onreadystatechange",s),e.detachEvent("onload",s))),t.on(e,"unload",a),t.forEach(i,function(e){e[0].call(e[1])}),i=[]},a=function(){o=!0,t.forEach(r,function(e){e[0].call(e[1])}),r=[]};t.onDOMLoad=function(e,n){return t.isReady()?void e.call(n):void i.push([e,n])},t.onDOMUnload=function(e,t){return this.isDOMUnloaded()?void e.call(t):void r.push([e,t])},t.isReady=function(){return!o&&n},t.isDOMUnloaded=function(){return o},n?s():"undefined"!=typeof document&&(document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&s()}),e.attachEvent("onload",s)))}(),t.setCookie=function(e,t){try{localStorage.setItem(e,t)}catch(n){var i=new Date;i.setTime(i.getTime()+31536e6);var r="; expires="+i.toGMTString();document.cookie=e+"="+t+r+"; path=/"}},t.getCookie=function(e){var t;try{return t=localStorage.getItem(e)}catch(n){for(var i=e+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var s=r[o];" "===s.charAt(0);)s=s.substring(1,s.length);0===s.indexOf(i)&&(t=s.substring(i.length,s.length))}if(t)return t}return null},t.Collection=function(e){var n=[],i={},r=e||"id";t.eventing(this,!0);var o=function(e,n){return t.isFunction(e[n])?e[n]():e[n]},s=t.bind(function(e){this.trigger("update",e),this.trigger("update:"+e.target.id,e)},this),a=t.bind(function(e){this.remove(e.target,e.reason)},this);this.reset=function(){t.forEach(n,function(e){e.off("updated",s,this),e.off("destroyed",a,this)},this),n=[],i={}},this.destroy=function(e){t.forEach(n,function(t){t&&"function"==typeof t.destroy&&t.destroy(e,!0)}),this.reset(),this.off()},this.get=function(e){return e&&void 0!==i[e]?n[i[e]]:void 0},this.has=function(e){return e&&void 0!==i[e]},this.toString=function(){return n.toString()},this.where=function(e,i){return t.isFunction(e)?t.filter(n,e,i):t.filter(n,function(t){for(var n in e)if(e.hasOwnProperty(n)&&o(t,n)!==e[n])return!1;return!0})},this.find=function(e,i){var r;r=t.isFunction(e)?e:function(t){for(var n in e)if(e.hasOwnProperty(n)&&o(t,n)!==e[n])return!1;return!0},r=t.bind(r,i);for(var s=0;s<n.length;++s)if(r(n[s])===!0)return n[s];return null},this.add=function(e){var l=o(e,r);return this.has(l)?(t.warn("Model "+l+" is already in the collection",n),this):(i[l]=n.push(e)-1,e.on("updated",s,this),e.on("destroyed",a,this),this.trigger("add",e),this.trigger("add:"+l,e),this)},this.remove=function(e,t){var l=o(e,r);n.splice(i[l],1);for(var c=i[l];c<n.length;++c)i[n[c][r]]=c;return delete i[l],e.off("updated",s,this),e.off("destroyed",a,this),this.trigger("remove",e,t),this.trigger("remove:"+l,e,t),this},this._triggerAddEvents=function(){var e=this.where.apply(this,arguments);t.forEach(e,function(e){this.trigger("add",e),this.trigger("add:"+o(e,r),e)},this)},this.length=function(){return n.length}},t.castToBoolean=function(e,t){return e===n?t:"true"===e||e===!0},t.roundFloat=function(e,t){return Number(e.toFixed(t))},function(){var e={};t.registerCapability=function(i,r){var o=i.toLowerCase();return e.hasOwnProperty(o)?void t.error("Attempted to register",i,"capability more than once"):t.isFunction(r)?void n(o,r):void t.error("Attempted to register",i,"capability with a callback that isn' a function")};var n=function(t,n){e[t]=function(){var i=n();return e[t]=function(){return i},i}},i=function(t){return e[t]()};t.hasCapabilities=function(){for(var n,r=l.call(arguments),o=0;o<r.length;++o){if(n=r[o].toLowerCase(),!e.hasOwnProperty(n))return t.error("hasCapabilities was called with an unknown capability: "+n),!1;if(i(n)===!1)return!1}return!0}}(),t.registerCapability("websockets",function(){return"WebSocket"in e&&void 0!==e.WebSocket}),function(){var n,i=function(){if(e.postMessage){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}();if(i){var r=[],o="OTHelpers."+t.uuid.v4()+".zero-timeout",s=function(){r=[],e.removeEventListener?e.removeEventListener("message",a):e.detachEvent&&e.detachEvent("onmessage",a)},a=function(n){if(n.source===e&&n.data===o){if(t.isFunction(n.stopPropagation)&&n.stopPropagation(),n.cancelBubble=!0,!e.___othelpers)return void s();if(r.length>0){var i=r.shift(),a=i.shift();a.apply(null,i)}}};t.on(e,"unload",s),e.addEventListener?e.addEventListener("message",a,!0):e.attachEvent&&e.attachEvent("onmessage",a),n=function(){r.push(l.call(arguments)),e.postMessage(o,"*")}}else n=function(){var e=l.call(arguments),t=e.shift();setTimeout(function(){t.apply(null,e)},0)};t.callAsync=n,t.createAsyncHandler=function(e){return function(){var n=l.call(arguments);t.callAsync(function(){e.apply(null,n)})}}}(),t.eventing=function(e,t){var n=(S||T)(this,t);return e.on=function(e,t,i){if("string"==typeof e&&t)n.addListeners(e.split(" "),t,i);else for(var r in e)e.hasOwnProperty(r)&&n.addListeners([r],e[r],t);return this},e.off=function(e,t,i){if("string"==typeof e)t&&u.isFunction(t)?n.removeListeners(e.split(" "),t,i):n.removeAllListenersNamed(e.split(" "));else if(e)for(var r in e)e.hasOwnProperty(r)&&n.removeListeners([r],e[r],i);else n.removeAllListeners();return this},e.once=function(t,n,i){var r=function(){e.off(t,r,i),n.apply(i,arguments)};return r.originalHandler=n,e.on(t,r,i),this},e.dispatchEvent=function(e,t){if(!e.type)throw u.error("OTHelpers.Eventing.dispatchEvent: Event has no type"),u.error(e),new Error("OTHelpers.Eventing.dispatchEvent: Event has no type");return e.target||(e.target=this),n.dispatchEvent(e,t),this},e.trigger=function(){var e=l.call(arguments);return n.trigger(e.shift(),e),this},e.emit=e.trigger,e.addEventListener=function(t,n,i){return u.warn("The addEventListener() method is deprecated. Use on() or once() instead."),e.on(t,n,i)},e.removeEventListener=function(t,n,i){return u.warn("The removeEventListener() method is deprecated. Use off() instead."),e.off(t,n,i)},e},t.createElement=function(e,t,n,i){var r=(i||document).createElement(e);if(t)for(var o in t)if("object"==typeof t[o]){r[o]||(r[o]={});var s=t[o];for(var a in s)r[o][a]=s[a]}else"className"===o?r.className=t[o]:r.setAttribute(o,t[o]);var l=function(e){"string"==typeof e?r.innerHTML=r.innerHTML+e:r.appendChild(e)};return u.isArray(n)?u.forEach(n,l):n&&l(n),r},t.createButton=function(e,t,n){var i=u.createElement("button",t,e);if(n){for(var r in n)n.hasOwnProperty(r)&&u.on(i,r,n[r]);i._boundEvents=n}return i};var F;F="undefined"!=typeof document&&void 0!==document.createElement("div").firstElementChild?function(e){return e.firstElementChild}:function(e){var t=e.firstChild;do{if(1===t.nodeType)return t;t=t.nextSibling}while(t);return null},d.prototype.appendTo=function(e){if(!e)throw new Error("appendTo requires a DOMElement to append to.");return this.forEach(function(t){e.appendChild(t)})},d.prototype.append=function(){var e=this.first;return e?(u.forEach(l.call(arguments),function(t){e.appendChild(t)}),this):this},d.prototype.prepend=function(){if(0===arguments.length)return this;var e,t=this.first;return t?(e=l.call(arguments),F(t)||t.appendChild(e.shift()),u.forEach(e,function(e){t.insertBefore(e,F(t))}),this):this},d.prototype.after=function(e){if(!e)throw new Error("after requires a DOMElement to insert after");return this.forEach(function(t){t.parentElement&&(e!==t.parentNode.lastChild?t.parentElement.insertBefore(t,e):t.parentElement.appendChild(t))})},d.prototype.before=function(e){if(!e)throw new Error("before requires a DOMElement to insert before");return this.forEach(function(t){t.parentElement&&t.parentElement.insertBefore(t,e)})},d.prototype.remove=function(){return this.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},d.prototype.empty=function(){return this.forEach(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})},d.prototype.isDisplayNone=function(){return this.some(function(e){return 0!==e.offsetWidth&&0!==e.offsetHeight||"none"!==u(e).css("display")?e.parentNode&&e.parentNode.style?u(e.parentNode).isDisplayNone():void 0:!0})},d.prototype.findElementWithDisplayNone=function(e){return u.findElementWithDisplayNone(e)},t.isElementNode=function(e){return e&&"object"==typeof e&&1===e.nodeType},t.removeElement=function(e){u(e).remove()},t.removeElementById=function(e){return u("#"+e).remove()},t.removeElementsByType=function(e,t){return u(t,e).remove()},t.emptyElement=function(e){return u(e).empty()},t.isDisplayNone=function(e){return u(e).isDisplayNone()},t.findElementWithDisplayNone=function(e){return 0!==e.offsetWidth&&0!==e.offsetHeight||"none"!==u.css(e,"display")?e.parentNode&&e.parentNode.style?u.findElementWithDisplayNone(e.parentNode):null:e},t.Modal=function(e){t.eventing(this,!0);var n=arguments[arguments.length-1];if(!t.isFunction(n))throw new Error("OTHelpers.Modal2 must be given a callback");arguments.length<2&&(e={});var i=document.createElement("iframe");i.id=e.id||t.uuid(),i.style.position="absolute",i.style.position="fixed",i.style.height="100%",i.style.width="100%",i.style.top="0px",i.style.left="0px",i.style.right="0px",i.style.bottom="0px",i.style.zIndex=1e3,i.style.border="0";try{i.style.backgroundColor="rgba(0,0,0,0.2)"}catch(r){i.style.backgroundColor="transparent",i.setAttribute("allowTransparency","true")}i.scrolling="no",i.setAttribute("scrolling","no");var o='<!DOCTYPE html><html><head><meta http-equiv="x-ua-compatible" content="IE=Edge"><meta http-equiv="Content-type" content="text/html; charset=utf-8"><title></title></head><body></body></html>',s=function(){var e=i.contentDocument||i.contentWindow.document;t.env.iframeNeedsLoad&&(e.body.style.backgroundColor="transparent",e.body.style.border="none","IE"!==t.env.name&&(e.open(),e.write(o),e.close())),n(i.contentWindow,e)};document.body.appendChild(i),t.env.iframeNeedsLoad?("IE"===t.env.name&&(i.contentWindow.contents=o,i.src='javascript:window["contents"]'),t.on(i,"load",s)):setTimeout(s,0),this.close=function(){return t.removeElement(i),this.trigger("closed"),this.element=i=null,this},this.element=i},function(){function e(t,n,i,r){var o,s=n[i],a=parseFloat(s),l=s.split(/\d/)[0];return r=null!=r?r:/%|em/.test(l)&&t.parentElement?e(t.parentElement,t.parentElement.currentStyle,"fontSize",null):16,o="fontSize"===i?r:/width/i.test(i)?t.clientWidth:t.clientHeight,"em"===l?a*r:"in"===l?96*a:"pt"===l?96*a/72:"%"===l?a/100*o:a}function n(e,t){var n="border"===t?"Width":"",i=t+"Top"+n,r=t+"Right"+n,o=t+"Bottom"+n,s=t+"Left"+n;e[t]=(e[i]===e[r]===e[o]===e[s]?[e[i]]:e[i]===e[o]&&e[s]===e[r]?[e[i],e[r]]:e[s]===e[r]?[e[i],e[r],e[o]]:[e[i],e[r],e[o],e[s]]).join(" ")}function i(t){var i,r=t.currentStyle,o=this,s=e(t,r,"fontSize",null);for(i in r)/width|height|margin.|padding.|border.+W/.test(i)&&"auto"!==o[i]?o[i]=e(t,r,i,s)+"px":"styleFloat"===i?o["float"]=r[i]:o[i]=r[i];return n(o,"margin"),n(o,"padding"),n(o,"border"),o.fontSize=s+"px",o}function r(e){return new i(e)}i.prototype={constructor:i,getPropertyPriority:function(){},getPropertyValue:function(e){return this[e]||""},item:function(){},removeProperty:function(){},setProperty:function(){},getPropertyCSSValue:function(){}},t.getComputedStyle=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle(e):r(e)}}();var L=function(e,t,n){var i={},r=function(t){switch(t){case"width":return u(e).width();case"height":return u(e).height();default:return u(e).css(t)}};u.forEach(t,function(e){i[e]=r(e)});var o=new MutationObserver(function(o){var s={};u.forEach(o,function(n){if("style"===n.attributeName){var o=u.isDisplayNone(e);u.forEach(t,function(e){if(!o||"width"!==e&&"height"!==e){var t=r(e);t!==i[e]&&(s[e]=[i[e],t],i[e]=t)}})}}),u.isEmpty(s)||u.callAsync(function(){n.call(null,s)})});return o.observe(e,{attributes:!0,attributeFilter:["style"],childList:!1,characterData:!1,subtree:!1}),o},j=function(e,t){var n=new MutationObserver(function(e){var n=[];u.forEach(e,function(e){e.removedNodes.length&&(n=n.concat(l.call(e.removedNodes)))}),n.length&&u.callAsync(function(){t(u(n))})});return n.observe(e,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),n},U=function(e,t){var n={width:0,height:0},i=setInterval(function(){var i=e.getBoundingClientRect();(n.width!==i.width||n.height!==i.height)&&(t(i,n),n={width:i.width,height:i.height})},200);return{disconnect:function(){clearInterval(i)}}};d.prototype.observeStyleChanges=function(e,t){var n=[];return this.forEach(function(i){n.push(L(i,e,t))}),n},d.prototype.observeNodeOrChildNodeRemoval=function(e){var t=[];return this.forEach(function(n){t.push(j(n,e))}),t},d.prototype.observeSize=function(e){var t=[];return this.forEach(function(n){t.push(U(n,e))}),t},t.observeStyleChanges=function(e,t,n){return u(e).observeStyleChanges(t,n)[0]},t.observeNodeOrChildNodeRemoval=function(e,t){return u(e).observeNodeOrChildNodeRemoval(t)[0]},t.registerCapability("classList",function(){return"undefined"!=typeof document&&"classList"in document.createElement("a")}),d.prototype.addClass=function(e){if(e){var t=u.trim(e).split(/\s+/);this.forEach(function(e){s(e,t)})}return this},d.prototype.removeClass=function(e){if(e){var t=u.trim(e).split(/\s+/);this.forEach(function(e){a(e,t)})}return this},d.prototype.toggleClass=function(e){if(e){var t=u.trim(e).split(/\s+/);this.forEach(function(e){o(e,t)})}return this},d.prototype.hasClass=function(e){return this.some(function(t){return r(t,e)})},t.addClass=function(e,t){return u(e).addClass(t)},t.removeClass=function(e,t){return u(e).removeClass(t)};var H={"for":"htmlFor","class":"className"};d.prototype.attr=function(e,n){if(t.isObject(e)){var i;for(var r in e)i=H[r]||r,this.first.setAttribute(i,e[r])}else{if(void 0===n)return this.first.getAttribute(H[e]||e);this.first.setAttribute(H[e]||e,n)}return this},d.prototype.removeAttr=function(e){var t=H[e]||e;return this.forEach(function(e){e.removeAttribute(t)}),this},d.prototype.html=function(e){return void 0!==e&&(this.first.innerHTML=e),this.first.innerHTML},d.prototype.center=function(e,t){var n;return this.forEach(function(i){n=u(i),e||(e=parseInt(n.width(),10)),t||(t=parseInt(n.height(),10));var r=-.5*e+"px",o=-.5*t+"px";n.css("margin",o+" 0 0 "+r).addClass("OT_centered")}),this},t.centerElement=function(e,t,n){return u(e).center(t,n)},function(){var e=function(e){return e.offsetWidth>0?e.offsetWidth+"px":u(e).css("width")},n=function(e){return e.offsetHeight>0?e.offsetHeight+"px":u(e).css("height")};d.prototype.width=function(t){return t?(this.css("width",t),this):this.isDisplayNone()?this.makeVisibleAndYield(function(t){return e(t)})[0]:e(this.get(0))},d.prototype.height=function(e){return e?(this.css("height",e),this):this.isDisplayNone()?this.makeVisibleAndYield(function(e){return n(e)})[0]:n(this.get(0))},t.width=function(e,n){var i=u(e).width(n);return n?t:i},t.height=function(e,n){var i=u(e).height(n);return n?t:i}}(),function(){var e={},i={},r=function(e){if(i[e.ownerDocument]&&i[e.ownerDocument][e.nodeName])return i[e.ownerDocument][e.nodeName];i[e.ownerDocument]||(i[e.ownerDocument]={});var t,n=e.ownerDocument.createElement(e.nodeName);return e.ownerDocument.body.appendChild(n),t=i[e.ownerDocument][e.nodeName]=u(n).css("display"),u(n).remove(),n=null,t},o=function(e){var t=u.getComputedStyle(e);return"none"===t.getPropertyValue("display")},s=function(e,t){var n=e.style;for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},a=function(e,t,n){e.style[t]=n},l=function(e,t){var n=t.replace(/([A-Z]|^ms)/g,"-$1").toLowerCase(),i=u.getComputedStyle(e),r=i.getPropertyValue(n);return""===r&&(r=e.style[n]),r},c=function(e,t,n){var i,r,o={};for(i in t)t.hasOwnProperty(i)&&(o[i]=e.style[i],u(e).css(i,t[i]));r=n(e);for(i in t)t.hasOwnProperty(i)&&u(e).css(i,o[i]||"");return r};d.prototype.show=function(){return this.forEach(function(t){var n=t.style.display;(""===n||"none"===n)&&(t.style.display=e[t]||"",delete e[t]),o(t)&&(e[t]="none",t.style.display=r(t))})},d.prototype.hide=function(){return this.forEach(function(t){"none"!==t.style.display&&(e[t]=t.style.display,t.style.display="none")})},d.prototype.css=function(e,t){return 0!==this.length?"string"!=typeof e?this.forEach(function(t){s(t,e)}):t!==n?this.forEach(function(n){a(n,e,t)}):l(this.first,e,t):void 0},d.prototype.applyCSS=function(e,t){var n=[];return this.forEach(function(i){n.push(c(i,e,t))}),n},d.prototype.makeVisibleAndYield=function(e){var t={display:"block",visibility:"hidden"},n=[];return this.forEach(function(i){var r=u.findElementWithDisplayNone(i);n.push(r?c(r,t,e):void 0)}),n},t.show=function(e){return u(e).show()},t.hide=function(e){return u(e).hide()},t.css=function(e,t,n){return u(e).css(t,n)},t.applyCSS=function(e,t,n){return u(e).applyCSS(t,n)},t.makeVisibleAndYield=function(e,t){return u(e).makeVisibleAndYield(t)}}(),function(){t.setImmediate=function(){return"undefined"!=typeof process&&process.nextTick?"undefined"!=typeof setImmediate?setImmediate:process.nextTick:"function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){setTimeout(e,0)}}(),t.iterator=function(e){var t=function(n){var i=function(){return e.length&&e[n].apply(null,arguments),i.next()};return i.next=function(){return n<e.length-1?t(n+1):null},i};return t(0)},t.waterfall=function(e,n){if(n=n||function(){},e.constructor!==Array)return n(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return n();var i=function(e){return function(r){if(r)n.apply(null,arguments),n=function(){};else{var o=l.call(arguments,1),s=e.next();o.push(s?i(s):n),t.setImmediate(function(){e.apply(null,o)})}}};i(t.iterator(e))()}}(),function(){var n=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame;if(n)n=t.bind(n,e);else{var i=0,r=t.now();n=function(n){var o=t.now(),s=Math.max(0,16-(o-i)),a=e.setTimeout(function(){n(o-r)},s);return i=o+s,a}}t.requestAnimationFrame=n}(),function(){var e=[],i=!1;t.Analytics=function(r,o){var s=r+"/logging/ClientEvent",a=r+"/logging/ClientQos",l={},c=function(e,n,i){t.post((n?a:s)+"?_="+t.uuid.v4(),{body:e,xdomainrequest:"IE"===u.env.name&&u.env.version<10,headers:{"Content-Type":"application/json"}},i)},h=function(){if(!i&&e.length>0){i=!0;var t=e[0],n=function(){e.shift(),i=!1,h()};t&&c(t.data,t.isQos,function(e){if(e){var i="Failed to send ClientEvent, moving on to the next item.";o?o(i):console.log(i)}else t.onComplete();setTimeout(n,50)})}},d=function(t,n,i){e.push({data:t,onComplete:n,isQos:i}),h()},p=function(e,t,i){if(!i)return!1;var r=[i,t,e].join("_"),o=100;return null===o||o===n?!1:(l[r]||0)<=o};this.logError=function(e,n,i,r,o){o||(o={});var s=o.partnerId;if(!p(e,n,s)){var a=[s,n,e].join("_"),c=r?r:null;l[a]="undefined"!=typeof l[a]?l[a]+1:1,this.logEvent(t.extend(o,{action:n+"."+e,payload:c}),!1)}},this.logEvent=function(e,t,n){if(t||(t=!1),!(n&&!isNaN(n)&&Math.random()>n)){
for(var i in e)e.hasOwnProperty(i)&&null===e[i]&&delete e[i];e=JSON.stringify(e);var r=function(){};d(e,r,t)}},this.logQOS=function(e){this.logEvent(e,!0)}}}(),t.get=function(e,n,i){var r=t.extend(n||{},{method:"GET"});t.request(e,r,i)},t.post=function(e,n,i){var r=t.extend(n||{},{method:"POST"});r.xdomainrequest?t.xdomainRequest(e,r,i):t.request(e,r,i)}}(e,e.OTHelpers),function(t){if(void 0===t.OTPlugin){var n=OTHelpers,i="Safari"===n.env.name||"IE"===n.env.name&&n.env.version>=8&&-1===n.env.userAgent.indexOf("x64"),r=!1,o={isSupported:function(){return i},isReady:function(){return r},meta:{mimeType:"application/x-opentokie,version=0.4.0.10",activeXName:"TokBox.OpenTokIE.0.4.0.10",version:"0.4.0.10"},useLoggingFrom:function(e){o.log=n.bind(e.log,e),o.debug=n.bind(e.debug,e),o.info=n.bind(e.info,e),o.warn=n.bind(e.warn,e),o.error=n.bind(e.error,e)}};if(n.useLogHelpers(o),t.OTPlugin=o,n.registerCapability("otplugin",function(){return o.isInstalled()}),!o.isSupported())return void(o.isInstalled=function(){return!1});var s=function(){Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n,i,r=t?t:0;if(!this)throw new TypeError;if(i=this.length,0===i||r>=i)return-1;for(0>r&&(r=i-Math.abs(r)),n=r;i>n;n++)if(this[n]===e)return n;return-1}),Array.prototype.map||(Array.prototype.map=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=new Array(n),r=arguments.length>=2?arguments[1]:void 0,o=0;n>o;o++)o in t&&(i[o]=e.call(r,t[o],o,t));return i})},a=function(e,t){var i,r,s,a=function(){},l=new a,c=!1;try{i=e._.RumorInit(t,"")}catch(u){o.error("Error creating the Rumor Socket: ",u.message)}if(!i)throw new Error("Could not initialise OTPlugin rumor connection");return l.open=function(){c=!0,e._.RumorOpen(i)},l.close=function(t,n){c&&(c=!1,e._.RumorClose(i,t,n)),e.removeRef(l)},l.destroy=function(){this.close()},l.send=function(t){e._.RumorSend(i,t.type,t.toAddress,JSON.parse(JSON.stringify(t.headers)),t.data)},l.onOpen=function(e){r=e},l.onClose=function(e){s=e},l.onError=function(t){e._.SetOnRumorError(i,d(t))},l.onMessage=function(t){e._.SetOnRumorMessage(i,d(t))},e.addRef(l),e._.SetOnRumorOpen(i,d(function(){r&&n.isFunction(r)&&r.call(null)})),e._.SetOnRumorClose(i,d(function(t){s(t),e.removeRef(l)})),l},l=function(e){var t=[];e.addRef=function(n){return t.push(n),e},e.removeRef=function(n){if(0!==t.length){var i=t.indexOf(n);return-1!==i&&t.splice(i,1),0===t.length&&e.destroy(),e}},e.removeAllRefs=function(){for(;t.length;)t.shift().destroy()}},c=function(e){var t={},i=function(){var t=Array.prototype.slice.call(arguments);e.emit(t.shift(),t)};e.on=function(n,i,r){return t.hasOwnProperty(n)||(t[n]=[]),t[n].push([i,r]),e},e.off=function(i,r,o){return t.hasOwnProperty(i)&&0!==t[i].length?(n.filter(t[i],function(e){return e[0]===r&&e[1]===o}),e):void 0},e.once=function(t,n,i){var r=function(){return e.off(t,r),n.apply(i,arguments)};return e.on(t,r),e},e.emit=function(i,r){return n.callAsync(function(){(t.hasOwnProperty(i)||!t[i].length)&&n.forEach(t[i],function(e){e[0].apply(e[1],r)})}),e};var r=function(t){e._.on&&e._.on(-1,{customEvent:d(i)}),e._.initialise?(e.on("ready",d(t)),e._.initialise()):t.call(e)};return function(t){r(function(n){return n?(o.error("Error while starting up plugin "+e.uuid+": "+n),void t(n)):(o.debug("Plugin "+e.id+" is loaded"),void t(void 0,e))})}},u=5e3,h={},d=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e),n.callAsync.apply(n,t)}},p=function(e){if(e&&(h[e]&&(clearTimeout(h[e]),h[e]=null),t[e]))try{delete t[e]}catch(n){t[e]=void 0}},f=function(e,n){h[e]=setTimeout(function(){p(e),n("The object timed out while loading.")},u),t[e]=function(){p(e);var t=Array.prototype.slice.call(arguments);t.unshift(null),n.apply(null,t)}},g=function(){return"OTPlugin_loaded_"+n.uuid().replace(/\-+/g,"")},m=function(e,t){t=t||{};var i=[],r=['type="'+t.mimeType+'"','id="'+e+'_obj"','tb_callback_id="'+e+'"','width="0" height="0"'],o={userAgent:n.env.userAgent.toLowerCase(),windowless:t.windowless,onload:e};t.isVisible!==!0&&r.push('visibility="hidden"'),i.push("<object "+r.join(" ")+">");for(var s in o)o.hasOwnProperty(s)&&i.push('<param name="'+s+'" value="'+o[s]+'" />');return i.push("</object>"),i.join("")},v=function(e,n,i){n=n||{};var r=m(e,n),o=n.doc||t.document;o.body.insertAdjacentHTML("beforeend",r);var s=o.body.querySelector("#"+e+"_obj");i(void 0,s)},b=function(e,t){var i=function(){},r=new i,o=c(r);l(r);var s=function(e){e?(r._=e,r.parentElement=e.parentElement,r.$=n(e)):(r._=null,r.parentElement=null,r.$=n())};return r.uuid=g(),r.isValid=function(){return r._.valid},r.destroy=function(){r.removeAllRefs(),s(null),r.emit("destroy")},s(null),f(r.uuid,function(n){return n?(t("The plugin with the mimeType of "+e.mimeType+" timed out while loading: "+n),void r.destroy()):(r._.setAttribute("id","tb_plugin_"+r._.uuid),r._.removeAttribute("tb_callback_id"),r.uuid=r._.uuid,r.id=r._.id,void o(function(e){return e?(t("Error while starting up plugin "+r.uuid+": "+e),void r.destroy()):void t(void 0,r)}))}),v(r.uuid,e,function(e,t){s(t)}),r},y=function(e){return e.selectSources=function(){return e._.selectSources.apply(e._,arguments)},e},w=function(e){return e.setStream=function(t,i){if(e._.setStream(t),i)if(t.hasVideo()){var r=function(){return e._?void(e._.videoWidth>0?setTimeout(i,200):setTimeout(r,500)):void i(new n.Error("The plugin went away before the stream could be bound."))};setTimeout(r,500)}else setTimeout(i,200);return e},e},_=function(e,t){var i=function(){},r=new i;return r.domElement=e._,r.$=n(e._),r.parentElement=e._.parentNode,e.addRef(r),r.appendTo=function(t){t&&e._.parentNode!==t&&(o.debug("VideoContainer appendTo",t),t.appendChild(e._),r.parentElement=t)},r.show=function(i){return o.debug("VideoContainer show"),e._.removeAttribute("width"),e._.removeAttribute("height"),e.setStream(t,i),n.show(e._),r},r.setSize=function(t,n){return e._.setAttribute("width",t),e._.setAttribute("height",n),r},r.width=function(t){return void 0!==t&&(o.debug("VideoContainer set width to "+t),e._.setAttribute("width",t)),e._.getAttribute("width")},r.height=function(t){return void 0!==t&&(o.debug("VideoContainer set height to "+t),e._.setAttribute("height",t)),e._.getAttribute("height")},r.volume=function(e){return o.debug(void 0!==e?"VideoContainer setVolume not implemented: called with "+e:"VideoContainer getVolume not implemented"),.5},r.getImgData=function(){return e._.getImgData("image/png")},r.videoWidth=function(){return e._.videoWidth},r.videoHeight=function(){return e._.videoHeight},r.destroy=function(){e._.setStream(null),e.removeRef(r)},r},x=function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t])};x.prototype.forEach=function(e,t){for(var n in this)this.hasOwnProperty(n)&&e.call(t,this[n])};var C=function(){var e=function(){},t=new e,i={},r=function(e){t.mediaCapturer&&t.mediaCapturer.id===e.id?t.mediaCapturer=null:i.hasOwnProperty(e.id)&&delete i[e.id],e.$&&e.$.remove()};return t.mediaCapturer=null,t.removeAll=function(){for(var e in i)i.hasOwnProperty(e)&&i[e].destroy();t.mediaCapturer&&t.mediaCapturer.destroy()},t.create=function(e,t){var n=b(e,t);return i[n.uuid]=n,n.on("destroy",function(){r(n)}),n},t.createMediaPeer=function(e,r){n.isFunction(e)&&(r=e,e={});var s=t.create(n.extend(e||{},{mimeType:o.meta.mimeType,isVisible:!0,windowless:!0}),function(e){return e?void r.call(o,e):(i[s.id]=s,void r.call(o,void 0,s))});w(s)},t.createMediaCapturer=function(e){return t.mediaCapturer?(e.call(o,void 0,t.mediaCapturer),t):(t.mediaCapturer=t.create({mimeType:o.meta.mimeType,isVisible:!1,windowless:!1},function(n){e.call(o,n,t.mediaCapturer)}),void y(t.mediaCapturer))},t}(),$=function(e,t,i,r){var s,a=function(){},l=new a,c=n.uuid(),u=!1,h=!1,p=[],f=!1,g=[];i.addRef(l),s={addstream:[],removestream:[],icecandidate:[],signalingstatechange:[],iceconnectionstatechange:[]};var m=function(){},v=function(e){o.error("Failed to process candidate"),o.error(e)},b=function(){for(var e=0;e<p.length;++e)i._.addIceCandidate(c,p[e],m,v)},y=function(e){return function(){return f===!0?e.apply(l,arguments):void g.push([e,arguments])}},w=function(){for(var e;e=g.shift();)e[0].apply(l,e[1])},_=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return s.hasOwnProperty(t)?void n.forEach(s[t],function(t){t.apply(null,e)}):void o.error("PeerConnection does not have an event called: "+t)},C=function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=d(e[t]));i._.on(c,e)},$=function(e){setTimeout(function(){var t=S.fromJson(e,i),r={stream:t,target:l};l.onaddstream&&n.isFunction(l.onaddstream)&&n.callAsync(l.onaddstream,r),_("addstream",r)},3e3)},k=function(e){var t=S.fromJson(e,i),r={stream:t,target:l};l.onremovestream&&n.isFunction(l.onremovestream)&&n.callAsync(l.onremovestream,r),_("removestream",r)},T=function(e,t,i){var r=new o.RTCIceCandidate({candidate:e,sdpMid:t,sdpMLineIndex:i}),s={candidate:r,target:l};l.onicecandidate&&n.isFunction(l.onicecandidate)&&n.callAsync(l.onicecandidate,s),_("icecandidate",s)},E=function(e){l.signalingState=e;var t={state:e,target:l};l.onsignalingstatechange&&n.isFunction(l.onsignalingstatechange)&&n.callAsync(l.onsignalingstatechange,t),_("signalingstate",t)},D=function(e){l.iceConnectionState=e;var t={state:e,target:l};l.oniceconnectionstatechange&&n.isFunction(l.oniceconnectionstatechange)&&n.callAsync(l.oniceconnectionstatechange,t),_("iceconnectionstatechange",t)};return l.createOffer=y(function(e,t,n){o.debug("createOffer",n),i._.createOffer(c,function(t,n){e(new o.RTCSessionDescription({type:t,sdp:n}))},t,n||{})}),l.createAnswer=y(function(e,t,n){o.debug("createAnswer",n),i._.createAnswer(c,function(t,n){e(new o.RTCSessionDescription({type:t,sdp:n}))},t,n||{})}),l.setLocalDescription=y(function(e,t,n){o.debug("setLocalDescription"),i._.setLocalDescription(c,e,function(){u=!0,h&&b(),t&&t.call(null)},n)}),l.setRemoteDescription=y(function(e,t,n){o.debug("setRemoteDescription"),i._.setRemoteDescription(c,e,function(){h=!0,u&&b(),t&&t.call(null)},n)}),l.addIceCandidate=y(function(e){o.debug("addIceCandidate"),u&&h?i._.addIceCandidate(c,e,m,v):p.push(e)}),l.addStream=y(function(e){var t={};i._.addStream(c,e,t)}),l.removeStream=y(function(e){i._.removeStream(c,e)}),l.getRemoteStreams=function(){return n.map(i._.getRemoteStreams(c),function(e){return S.fromJson(e,i)})},l.getLocalStreams=function(){return n.map(i._.getLocalStreams(c),function(e){return S.fromJson(e,i)})},l.getStreamById=function(e){return S.fromJson(i._.getStreamById(c,e),i)},l.getStats=y(function(e,t,n){i._.getStats(c,e||null,d(function(e){var n=new x(JSON.parse(e));t(n)}),n)}),l.close=function(){i._.destroyPeerConnection(c),i.removeRef(this)},l.destroy=function(){l.close()},l.addEventListener=function(e,t){return void 0===s[e]?(o.error('Could not bind invalid event "'+e+'" to PeerConnection. The valid event types are:'),void o.error("	"+n.keys(s).join(", "))):void s[e].push(t)},l.removeEventListener=function(e,t){return void 0===s[e]?(o.error('Could not unbind invalid event "'+e+'" to PeerConnection. The valid event types are:'),void o.error("	"+n.keys(s).join(", "))):void(s[e]=n.filter(s[e],t))},l.onaddstream=null,l.onremovestream=null,l.onicecandidate=null,l.onsignalingstatechange=null,l.oniceconnectionstatechange=null,n.forEach(e.iceServers,function(e){e.username||(e.username=""),e.credential||(e.credential="")}),i._.initPeerConnection(c,e,t)?(C({addStream:$,removeStream:k,iceCandidate:T,signalingStateChange:E,iceConnectionChange:D}),f=!0,w(),r(void 0,l),l):void r(new n.error("Failed to initialise PeerConnection"))};$.create=function(e,t,n,i){new $(e,t,n,i)};var k=function(e,t,i){var r=function(){},o=new r;return o.id=t.id,o.kind=t.kind,o.label=t.label,o.enabled=n.castToBoolean(t.enabled),o.streamId=e,o.setEnabled=function(t){o.enabled=n.castToBoolean(t),o.enabled?i._.enableMediaStreamTrack(e,o.id):i._.disableMediaStreamTrack(e,o.id)},o},S=function(e,t){var i=function(){},r=new i,o=[],s=[];r.id=e.id,t.addRef(r),e.videoTracks&&e.videoTracks.map(function(n){s.push(new k(e.id,n,t))}),e.audioTracks&&e.audioTracks.map(function(n){o.push(new k(e.id,n,t))});var a=function(e){var t="video"===e?s:o;return n.some(t,function(e){return e.enabled})};return r.getVideoTracks=function(){return s},r.getAudioTracks=function(){return o},r.getTrackById=function(e){return s.concat(o).forEach(function(t){return t.id===e?t:void 0}),null},r.hasVideo=function(){return a("video")},r.hasAudio=function(){return a("audio")},r.addTrack=function(){},r.removeTrack=function(){},r.stop=function(){t._.stopMediaStream(r.id),t.removeRef(r)},r.destroy=function(){r.stop()},r._={plugin:t,render:function(){return new _(t,r)}},r};S.fromJson=function(e,t){return e?new S(JSON.parse(e),t):null};var T,E=function(e){var t=n.clone(e);this.hasVideo=void 0!==t.video&&t.video!==!1,this.hasAudio=void 0!==t.audio&&t.audio!==!1,t.video===!0&&(t.video={}),t.audio===!0&&(t.audio={}),this.hasVideo&&!t.video.mandatory&&(t.video.mandatory={}),this.hasAudio&&!t.audio.mandatory&&(t.audio.mandatory={}),this.screenSharing=this.hasVideo&&("screen"===t.video.mandatory.chromeMediaSource||"window"===t.video.mandatory.chromeMediaSource),this.audio=t.audio,this.video=t.video,this.setVideoSource=function(e){void 0!==e?t.video.mandatory.sourceId=e:delete t.video},this.setAudioSource=function(e){void 0!==e?t.audio.mandatory.sourceId=e:delete t.audio},this.toHash=function(){return t}};!function(){var t,i,r=-1,s=function(e,t){if(e===t)return!1;if(-1===e)return t;if(-1===t)return e;if(-1===e.indexOf(".")&&-1===t.indexOf("."))return e>t;for(var n=e.split("."),i=t.split("."),r=(n.length>i.length?i:n).length,o=0;r>o;++o)if(parseInt(n[o],10)>parseInt(i[o],10))return!0;return o<n.length?!0:!1},a=function(){if(void 0!==i)return i;var e="TokBox.otiePluginInstaller",t="otiePluginInstaller",o="application/x-otieplugininstaller",a=navigator.plugins[e]||navigator.plugins[t];if(r=-1,a)for(var l,c,u=a.length,h=new RegExp(o.replace("-","\\-")+",version=([0-9a-zA-Z-_.]+)","i"),d=0;u>d;++d)l=a[d],l&&l.enabledPlugin&&l.enabledPlugin.name===a.name&&-1!==l.type.indexOf(o)&&(c=h.exec(l.type),null!==c&&s(c[1],r)&&(r=c[1]));else if("IE"===n.env.name)try{a=new ActiveXObject(e),r=a.getMasterVersion()}catch(p){}i=-1!==r?o+",version="+r:null},l=function(){return void 0===i&&a(),i},c=function(){return void 0===r&&a(),r},u=function(){var e="0.4.0.9"===c()||!s(c(),"0.4.0.4");return u=function(){return e},e};T=function(){var t,i=function(e){return function(){return t?e(void 0,arguments):void C.create({mimeType:l(),isVisible:!1,windowless:!1},function(n,i){return t=i,n?void o.error("Error while loading the AutoUpdater: "+n):e.apply(void 0,arguments)})}};this.isOutOfDate=function(){return s(o.meta.version,c())},this.autoUpdate=i(function(){var i=OT.Dialogs.Plugin.updateInProgress(),r=new OT.Analytics,s={ieVersion:n.env.version,pluginOldVersion:o.installedVersion(),pluginNewVersion:o.version()},a=d(function(){r.logEvent({action:"OTPluginAutoUpdate",variation:"Success",partnerId:OT.APIKEY,payload:JSON.stringify(s)}),t.destroy(),i.close(),OT.Dialogs.Plugin.updateComplete().on({reload:function(){e.location.reload()}})}),l=d(function(e,n,a){s.errorCode=e,s.systemErrorCode=a,r.logEvent({action:"OTPluginAutoUpdate",variation:"Failure",partnerId:OT.APIKEY,payload:JSON.stringify(s)}),t.destroy(),i.close();var l=n+" ("+e+"). Please restart your browser and try again.";i=OT.Dialogs.Plugin.updateComplete(l).on({reload:function(){i.close()}}),o.error("autoUpdate failed: "+n+" ("+e+"). Please restart your browser and try again.")}),c=d(function(e){i.setUpdateProgress(e.toFixed())});t._.updatePlugin(o.pathToInstaller(),a,l,c)}),this.destroy=function(){t&&t.destroy()},navigator.plugins&&navigator.plugins.refresh(!1)},T.get=function(e){if(!t){if(!this.isinstalled())return void e.call(null,"Plugin was not installed");t=new T}e.call(null,void 0,t)},T.isinstalled=function(){return null!==l()&&!u()},T.installedVersion=function(){return c()}}();var D=[],A=function(){C.removeAll()},O=function(e){D.push(e)},I=function(e){for(var t;(t=D.pop())&&n.isFunction(t);)t.call(o,e)},M=function(){T.get(function(e,t){return e?(o.error("Error while loading the AutoUpdater: "+e),void I("Error while loading the AutoUpdater: "+e)):t.isOutOfDate()?void t.autoUpdate():void C.createMediaCapturer(function(e){e||!C.mediaCapturer||C.mediaCapturer.isValid()||(e="The TB Plugin failed to load properly"),r=!0,I(e),n.onDOMUnload(A)})})};o.isInstalled=function(){return this.isSupported()?T.isinstalled():!1},o.version=function(){return o.meta.version},o.installedVersion=function(){return T.installedVersion()},o.pathToInstaller=function(){return"https://s3.amazonaws.com/otplugin.tokbox.com/v"+o.meta.version+"/otiePluginMain.msi"},o.ready=function(e){if(o.isReady()){var t;C.mediaCapturer&&C.mediaCapturer.isValid()||(t="The TB Plugin failed to load properly"),e.call(o,t)}else O(e)};var P=function(e,t,n){C.createMediaPeer(function(i,r){return i?void n.call(o,i):void r._.getUserMedia(e.toHash(),function(e){t.call(o,S.fromJson(e,r))},n)})};o.getUserMedia=function(e,t,n){var i=new E(e);if(i.screenSharing)P(i,t,n);else{var r=[];i.hasVideo&&r.push("video"),i.hasAudio&&r.push("audio"),C.mediaCapturer.selectSources(r,function(e){for(var r in e)e.hasOwnProperty(r)&&o.debug(r+" Capture Device: "+e[r]);i.setVideoSource(e.video),i.setAudioSource(e.audio),P(i,t,n)},n)}},o.initRumorSocket=function(e,t){o.ready(function(n){n?t(n):t(null,new a(C.mediaCapturer,e))})},o.initPeerConnection=function(e,t,n,i){var r=function(n,r){return n?void i.call(o,n):(o.debug("Got PeerConnection for "+r.id),void $.create(e,t,r,function(e,t){return e?void i.call(o,e):void i.call(o,null,t)}))};n&&n._.plugin?r(null,n._.plugin):C.createMediaPeer(r)},o.RTCSessionDescription=function(e){this.type=e.type,this.sdp=e.sdp},o.RTCIceCandidate=function(e){this.sdpMid=e.sdpMid,this.sdpMLineIndex=parseInt(e.sdpMLineIndex,10),this.candidate=e.candidate},s(),n.onDOMLoad(M)}}(this),!function(e,t){function n(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i<e.length;++i)n[i]=e[i];return t}function i(e){function n(e){var n=new XMLHttpRequest,i=new t.$.RSVP.Promise(function(t,i){function r(e){return 8e3*e/(Date.now()-o)}var o=Date.now(),s=0;n.addEventListener("load",function(e){t(r(e.loaded))}),n.addEventListener("abort",function(){t(r(s))}),n.addEventListener("error",function(e){i(e)}),n.addEventListener("progress",function(e){s=e.loaded}),n.open("GET",e+"?_"+Math.random()),n.send()});return{promise:i,abort:function(){n.abort()}}}function i(e,n){var i=new XMLHttpRequest,r=new t.$.RSVP.Promise(function(t,r){var o,s,a;i.upload.addEventListener("progress",function(e){o||(o=Date.now()),a=e.loaded}),i.addEventListener("load",function(){s=Date.now(),t(8e3*a/(s-o))}),i.addEventListener("error",function(e){r(e)}),i.addEventListener("abort",function(){r()}),i.open("POST",e),i.send(n)});return{promise:r,abort:function(){i.abort()}}}function r(e,t){var i=n(e);return setTimeout(function(){i.abort()},t),i.promise}function o(e,n,r){return new t.$.RSVP.Promise(function(t){function o(t){s=i(e,new ArrayBuffer(t/8)),s.promise.then(function(e){a=e,o(2*t)})}var s,a=0;setTimeout(function(){s.abort(),t(a)},r),o(n)})}var s=e.httpConfig;return t.$.RSVP.Promise.all([r(s.downloadUrl,1e3*s.duration),o(s.uploadUrl,s.uploadSize,1e3*s.duration)]).then(function(e){return{downloadBandwidth:e[0],uploadBandwidth:e[1]}})}function r(e){return e.hasOwnProperty("googFrameWidthReceived")||e.hasOwnProperty("googFrameWidthInput")||"video"===e.mediaType}function o(e){return e.hasOwnProperty("audioInputLevel")||e.hasOwnProperty("audioOutputLevel")||"audio"===e.mediaType}function s(e){return e.hasOwnProperty("bytesReceived")}function a(e){var t={packetsLost:0,packetsReceived:0,bytesReceived:0};return e.hasOwnProperty("packetsReceived")&&(t.packetsReceived=parseInt(e.packetsReceived,10)),e.hasOwnProperty("packetsLost")&&(t.packetsLost=parseInt(e.packetsLost,10)),e.hasOwnProperty("bytesReceived")&&(t.bytesReceived+=parseInt(e.bytesReceived,10)),t}function l(e){return t.$.isObject(e)&&"getTime"in e?e.getTime():e}function c(){function e(e,t){e.getStats(function(e){var n=[];e.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,n.push(t)}),t(null,n)})}function n(e,t){e.getStats(null,function(e){var n=[];e.forEach(function(e){n.push(e)}),t(null,n)},t)}return"Firefox"===t.$.browserVersion().name||OTPlugin.isInstalled()?n:e}function u(n){function i(e){return-1!==e.candidate.indexOf("relay")}function r(){var e=new t.VideoElement({attributes:{muted:!0}});return e.domElement().style.position="absolute",e.domElement().style.top="-9999%",e.appendTo(document.body),e}function o(){return new t.$.RSVP.Promise(function(e,n){t.$.createPeerConnection({iceServers:y.iceServers},{},null,function(i,r){i?n(new t.$.Error("createPeerConnection failed",1600,i)):e(r)})})}function s(e){return new t.$.RSVP.Promise(function(t,n){e.createOffer(t,n)})}function a(e,n){return new t.$.RSVP.Promise(function(i,r){e.bindToStream(n,function(e){e?r(new t.$.Error("bindToStream failed",1600,e)):i()})})}function l(e,n){return new t.$.RSVP.Promise(function(t,i){e.addIceCandidate(new v({sdpMLineIndex:n.sdpMLineIndex,candidate:n.candidate}),t,i)})}function c(e,n){return new t.$.RSVP.Promise(function(i,r){e.setLocalDescription(n,i,function(e){r(new t.$.Error("setLocalDescription failed",1600,e))})})}function u(e,n){return new t.$.RSVP.Promise(function(i,r){e.setRemoteDescription(n,i,function(e){r(new t.$.Error("setRemoteDescription failed",1600,e))})})}function h(e){return new t.$.RSVP.Promise(function(n,i){e.createAnswer(n,function(e){i(new t.$.Error("createAnswer failed",1600,e))})})}function d(e){return new t.$.RSVP.Promise(function(n,i){b(e,function(e,r){e?i(new t.$.Error("geStats failed",1600,e)):n(r)})})}function p(e){return function(n){n.candidate&&i(n.candidate)&&l(e,n.candidate)["catch"](function(){t.warn("An error occurred while adding a ICE candidate during webrtc test")})}}function f(e){return 8*(e.videoBytesReceived+e.audioBytesReceived)/(t.$.now()-e.startTs)*1e3}function g(e,n){var i=1e3;return new t.$.RSVP.Promise(function(r){function o(){t.$.RSVP.Promise.all([d(e).then(function(e){t.$.forEach(e,function(e){if(t.getStatsHelpers.isVideoStat(e)){var n=null;e.hasOwnProperty("googRtt")?n=parseInt(e.googRtt,10):e.hasOwnProperty("mozRtt")&&(n=e.mozRtt),null!==n&&n>-1&&(l.roundTripTimeSamplesCount++,l.roundTripTime+=n)}})}),d(n).then(function(e){t.$.forEach(e,function(e){if(t.getStatsHelpers.isVideoStat(e)){if(e.hasOwnProperty("packetsReceived")&&e.hasOwnProperty("packetsLost")){var n=parseInt(e.packetsLost,10),i=parseInt(e.packetsReceived,10);n>=0&&i>0&&(l.packetLostRatioSamplesCount++,l.packetLostRatio+=100*n/i)}e.hasOwnProperty("bytesReceived")&&(l.videoBytesReceived=parseInt(e.bytesReceived,10))}else t.getStatsHelpers.isAudioStat(e)&&e.hasOwnProperty("bytesReceived")&&(l.audioBytesReceived=parseInt(e.bytesReceived,10))})})]).then(function(){setTimeout(function(){a&&o()},i)})}function s(e){a=!1;var t={packetLostRatio:l.packetLostRatioSamplesCount>0?l.packetLostRatio/=100*l.packetLostRatioSamplesCount:null,roundTripTime:l.roundTripTimeSamplesCount>0?l.roundTripTime/=l.roundTripTimeSamplesCount:null,bandwidth:f(l),extended:e};r(t)}var a=!0,l={startTs:t.$.now(),packetLostRatioSamplesCount:0,packetLostRatio:0,roundTripTimeSamplesCount:0,roundTripTime:0,videoBytesReceived:0,audioBytesReceived:0};o(),setTimeout(function(){f(l)<y.thresholdBitsPerSecond?setTimeout(function(){s(!0)},1e3*y.extendedDuration):s(!1)},1e3*y.duration)})}var m,v,b=t.getStatsAdpater(),y=n.mediaConfig,w=n.localStream;return OTPlugin.isInstalled()?(m=OTPlugin.RTCSessionDescription,v=OTPlugin.RTCIceCandidate):(m=e.mozRTCSessionDescription||e.RTCSessionDescription,v=e.mozRTCIceCandidate||e.RTCIceCandidate),t.$.RSVP.Promise.all([o(),o()]).then(function(e){function n(){l.destroy(),d.destroy(),i.close(),o.close()}var i=e[0],o=e[1],l=r(),d=r();a(l,w),i.addStream(w);var f;return o.onaddstream=function(e){f=e.stream,a(d,f)},i.onicecandidate=p(o),o.onicecandidate=p(i),s(i).then(function(e){return t.$.RSVP.Promise.all([c(i,e),u(o,e)])}).then(function(){return h(o)}).then(function(e){return t.$.RSVP.Promise.all([c(o,e),u(i,e)])}).then(function(){return g(i,o)}).then(function(e){return n(),e},function(e){throw n(),e})})}function h(e,t){this.code=e,this.message=t,this.reason=t}"file:"===location.protocol&&alert("You cannot test a page using WebRTC through the file system due to browser permissions. You must run it over a web server.");var t=e.OT||{};t.APIKEY=function(){var e=function(){var e=document.getElementsByTagName("script");return e=e[e.length-1],e=e.getAttribute("src")||e.src}(),t=e.match(/[\?\&]apikey=([^&]+)/i);return t?t[1]:""}(),e.OT||(e.OT=t),e.TB||(e.TB=t),t.properties={version:"v2.5.1",build:"23265fa",debug:"false",websiteURL:"http://www.tokbox.com",cdnURL:"http://static.opentok.com",loggingURL:"http://hlg.tokbox.com/prod",apiURL:"http://anvil.opentok.com",messagingProtocol:"wss",messagingPort:443,supportSSL:"true",cdnURLSSL:"https://static.opentok.com",loggingURLSSL:"https://hlg.tokbox.com/prod",apiURLSSL:"https://anvil.opentok.com",minimumVersion:{firefox:parseFloat("29"),chrome:parseFloat("34")}},t.$=e.OTHelpers,t.$.eventing(t),t.$.defineGetters=function(e,t,n){var i={};void 0===n&&(n=!1);for(var r in t)t.hasOwnProperty(r)&&(i[r]={get:t[r],enumerable:n});Object.defineProperties(e,i)},t.Modal=t.$.Modal,t.$.useLogHelpers(t);var d=!1,p=t.setLogLevel;t.setLogLevel=function(e){t.$.setLogLevel(e);var n=p.call(t,e);return t.shouldLog(t.DEBUG)&&!d&&(t.debug("OpenTok JavaScript library "+t.properties.version),t.debug("Release notes: "+t.properties.websiteURL+"/opentok/webrtc/docs/js/release-notes.html"),t.debug("Known issues: "+t.properties.websiteURL+"/opentok/webrtc/docs/js/release-notes.html#knownIssues"),d=!0),t.debug("OT.setLogLevel("+n+")"),n};var f="true"===t.properties.debug||t.properties.debug===!0;t.setLogLevel(f?t.DEBUG:t.ERROR),OTPlugin&&OTPlugin.isInstalled()&&(t.$.env.userAgent+="; OTPlugin "+OTPlugin.version()),t.$.userAgent=function(){return t.$.env.userAgent},t.Rumor={MessageType:{SUBSCRIBE:0,UNSUBSCRIBE:1,MESSAGE:2,CONNECT:3,DISCONNECT:4,PING:7,PONG:8,STATUS:9}},!function(){t.Rumor.PluginSocket=function(e,n){var i,r="initializing";OTPlugin.initRumorSocket(e,t.$.bind(function(e,o){e?(r="closed",n.onClose({code:4999})):"initializing"===r?(i=o,i.onOpen(function(){r="open",n.onOpen()}),i.onClose(function(e){r="closed",n.onClose({code:e})}),i.onError(function(e){r="closed",n.onError(e),n.onClose({code:e})}),i.onMessage(function(e,i,r,o){var s=new t.Rumor.Message(e,i,r,o);n.onMessage(s)}),i.open()):this.close()},this)),this.close=function(){return"initializing"===r||"closed"===r?void(r="closed"):void i.close(1e3,"")},this.send=function(e){"open"===r&&i.send(e)},this.isClosed=function(){return"closed"===r}}}(this),function(e){"use strict";function n(e,t,n){return e>=t&&n>=e}function i(e,t){return Math.floor(e/t)}function r(e){var t=0;this.get=function(){return t>=e.length?v:Number(e[t])},this.offset=function(n){if(t+=n,0>t)throw new Error("Seeking past start of the buffer");if(t>e.length)throw new Error("Seeking past EOF")},this.match=function(n){if(n.length>t+e.length)return!1;var i;for(i=0;i<n.length;i+=1)if(Number(e[t+i])!==n[i])return!1;return!0}}function o(e){var t=0;this.emit=function(n){var i,r=v;for(i=0;i<arguments.length;++i)r=Number(arguments[i]),e[t++]=r;return r}}function s(e){function t(e){for(var t=[],i=0,r=e.length;i<e.length;){var o=e.charCodeAt(i);if(n(o,55296,57343))if(n(o,56320,57343))t.push(65533);else if(i===r-1)t.push(65533);else{var s=e.charCodeAt(i+1);if(n(s,56320,57343)){var a=1023&o,l=1023&s;i+=1,t.push(65536+(a<<10)+l)}else t.push(65533)}else t.push(o);i+=1}return t}var i=0,r=t(e);this.offset=function(e){if(i+=e,0>i)throw new Error("Seeking past start of the buffer");if(i>r.length)throw new Error("Seeking past EOF")},this.get=function(){return i>=r.length?b:r[i]}}function a(){var e="";this.string=function(){return e},this.emit=function(t){65535>=t?e+=String.fromCharCode(t):(t-=65536,e+=String.fromCharCode(55296+(t>>10&1023)),e+=String.fromCharCode(56320+(1023&t)))}}function l(e){this.name="EncodingError",this.message=e,this.code=0}function c(e,t){if(e)throw new l("Decoder error");return t||65533}function u(e){throw new l("The code point "+e+" could not be encoded.")}function h(e){return e=String(e).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(_,e)?_[e]:null}function d(e){var t=e.fatal,i=0,r=0,o=0,s=0;this.decode=function(e){var a=e.get();if(a===v)return 0!==r?c(t):b;if(e.offset(1),0===r){if(n(a,0,127))return a;if(n(a,194,223))r=1,s=128,i=a-192;else if(n(a,224,239))r=2,s=2048,i=a-224;else{if(!n(a,240,244))return c(t);r=3,s=65536,i=a-240}return i*=Math.pow(64,r),null}if(!n(a,128,191))return i=0,r=0,o=0,s=0,e.offset(-1),c(t);if(o+=1,i+=(a-128)*Math.pow(64,r-o),o!==r)return null;var l=i,u=s;return i=0,r=0,o=0,s=0,n(l,u,1114111)&&!n(l,55296,57343)?l:c(t)}}function p(e){e.fatal,this.encode=function(e,t){var r=t.get();if(r===b)return v;if(t.offset(1),n(r,55296,57343))return u(r);if(n(r,0,127))return e.emit(r);var o,s;n(r,128,2047)?(o=1,s=192):n(r,2048,65535)?(o=2,s=224):n(r,65536,1114111)&&(o=3,s=240);for(var a=e.emit(i(r,Math.pow(64,o))+s);o>0;){var l=i(r,Math.pow(64,o-1));a=e.emit(128+l%64),o-=1}return a}}function f(e,t){return t.match([255,254])&&"utf-16"===e?void t.offset(2):t.match([254,255])&&"utf-16be"==e?void t.offset(2):t.match([239,187,191])&&"utf-8"==e?void t.offset(3):void 0}function g(t,n){if(!this||this===e)return new g(t,n);if(t=t?String(t):x,n=Object(n),this._encoding=h(t),null===this._encoding||"utf-8"!==this._encoding.name&&"utf-16"!==this._encoding.name&&"utf-16be"!==this._encoding.name)throw new TypeError("Unknown encoding: "+t);return this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(n.fatal)},Object.defineProperty?Object.defineProperty(this,"encoding",{get:function(){return this._encoding.name}}):this.encoding=this._encoding.name,this}function m(t,n){if(!this||this===e)return new m(t,n);if(t=t?String(t):x,n=Object(n),this._encoding=h(t),null===this._encoding)throw new TypeError("Unknown encoding: "+t);return this._streaming=!1,this._decoder=null,this._options={fatal:Boolean(n.fatal)},Object.defineProperty?Object.defineProperty(this,"encoding",{get:function(){return this._encoding.name}}):this.encoding=this._encoding.name,this}if(!(t.$.env&&"IE"===t.$.env.name&&t.$.env.version<10||void 0!==e.TextEncoder&&void 0!==e.TextDecoder)){var v=-1,b=-1;l.prototype=Error.prototype;var y=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"utf-8"}],heading:"The Encoding"},{encodings:[{labels:["cp864","ibm864"],name:"ibm864"},{labels:["cp866","ibm866"],name:"ibm866"},{labels:["csisolatin2","iso-8859-2","iso-ir-101","iso8859-2","iso_8859-2","l2","latin2"],name:"iso-8859-2"},{labels:["csisolatin3","iso-8859-3","iso_8859-3","iso-ir-109","l3","latin3"],name:"iso-8859-3"},{labels:["csisolatin4","iso-8859-4","iso_8859-4","iso-ir-110","l4","latin4"],name:"iso-8859-4"},{labels:["csisolatincyrillic","cyrillic","iso-8859-5","iso_8859-5","iso-ir-144"],name:"iso-8859-5"},{labels:["arabic","csisolatinarabic","ecma-114","iso-8859-6","iso_8859-6","iso-ir-127"],name:"iso-8859-6"},{labels:["csisolatingreek","ecma-118","elot_928","greek","greek8","iso-8859-7","iso_8859-7","iso-ir-126"],
name:"iso-8859-7"},{labels:["csisolatinhebrew","hebrew","iso-8859-8","iso-8859-8-i","iso-ir-138","iso_8859-8","visual"],name:"iso-8859-8"},{labels:["csisolatin6","iso-8859-10","iso-ir-157","iso8859-10","l6","latin6"],name:"iso-8859-10"},{labels:["iso-8859-13"],name:"iso-8859-13"},{labels:["iso-8859-14","iso8859-14"],name:"iso-8859-14"},{labels:["iso-8859-15","iso_8859-15"],name:"iso-8859-15"},{labels:["iso-8859-16"],name:"iso-8859-16"},{labels:["koi8-r","koi8_r"],name:"koi8-r"},{labels:["koi8-u"],name:"koi8-u"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:["iso-8859-11","tis-620","windows-874"],name:"windows-874"},{labels:["windows-1250","x-cp1250"],name:"windows-1250"},{labels:["windows-1251","x-cp1251"],name:"windows-1251"},{labels:["ascii","ansi_x3.4-1968","csisolatin1","iso-8859-1","iso8859-1","iso_8859-1","l1","latin1","us-ascii","windows-1252"],name:"windows-1252"},{labels:["cp1253","windows-1253"],name:"windows-1253"},{labels:["csisolatin5","iso-8859-9","iso-ir-148","l5","latin5","windows-1254"],name:"windows-1254"},{labels:["cp1255","windows-1255"],name:"windows-1255"},{labels:["cp1256","windows-1256"],name:"windows-1256"},{labels:["windows-1257"],name:"windows-1257"},{labels:["cp1258","windows-1258"],name:"windows-1258"},{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:["chinese","csgb2312","csiso58gb231280","gb2312","gbk","gb_2312","gb_2312-80","iso-ir-58","x-gbk"],name:"gbk"},{labels:["gb18030"],name:"gb18030"},{labels:["hz-gb-2312"],name:"hz-gb-2312"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese","euc-jp","x-euc-jp"],name:"euc-jp"},{labels:["csiso2022jp","iso-2022-jp"],name:"iso-2022-jp"},{labels:["csshiftjis","ms_kanji","shift-jis","shift_jis","sjis","windows-31j","x-sjis"],name:"shift_jis"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:["cseuckr","csksc56011987","euc-kr","iso-ir-149","korean","ks_c_5601-1987","ks_c_5601-1989","ksc5601","ksc_5601","windows-949"],name:"euc-kr"},{labels:["csiso2022kr","iso-2022-kr"],name:"iso-2022-kr"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["utf-16","utf-16le"],name:"utf-16"},{labels:["utf-16be"],name:"utf-16be"}],heading:"Legacy utf-16 encodings"}],w={},_={};y.forEach(function(e){e.encodings.forEach(function(e){w[e.name]=e,e.labels.forEach(function(t){_[t]=e})})}),e["encoding-indexes"]||{},w["utf-8"].getEncoder=function(e){return new p(e)},w["utf-8"].getDecoder=function(e){return new d(e)};var x="utf-8";g.prototype={encode:function(e,t){e=e?String(e):"",t=Object(t),this._streaming||(this._encoder=this._encoding.getEncoder(this._options)),this._streaming=Boolean(t.stream);for(var n=[],i=new o(n),r=new s(e);r.get()!==b;)this._encoder.encode(i,r);if(!this._streaming){var a;do a=this._encoder.encode(i,r);while(a!==v);this._encoder=null}return new Uint8Array(n)}},m.prototype={decode:function(e,t){if(e&&!("buffer"in e&&"byteOffset"in e&&"byteLength"in e))throw new TypeError("Expected ArrayBufferView");e||(e=new Uint8Array(0)),t=Object(t),this._streaming||(this._decoder=this._encoding.getDecoder(this._options)),this._streaming=Boolean(t.stream);var n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i=new r(n);this._BOMseen||(this._BOMseen=!0,f(this._encoding.name,i));for(var o,s=new a;i.get()!==v;)o=this._decoder.decode(i),null!==o&&o!==b&&s.emit(o);if(!this._streaming){do o=this._decoder.decode(i),null!==o&&o!==b&&s.emit(o);while(o!==b&&i.get()!=v);this._decoder=null}return s.string()}},e.TextEncoder=e.TextEncoder||g,e.TextDecoder=e.TextDecoder||m}}(this),t.Rumor.Message=function(e,t,n,i){this.type=e,this.toAddress=t,this.headers=n,this.data=i,this.transactionId=this.headers["TRANSACTION-ID"],this.status=this.headers.STATUS,this.isError=!(this.status&&"2"===this.status[0])},t.Rumor.Message.prototype.serialize=function(){var e,t,n,i,r=8,o=7,s=[],a=[],l=[];for(o++,n=0;n<this.toAddress.length;n++)s.push(new TextEncoder("utf-8").encode(this.toAddress[n])),o+=2,o+=s[n].length;o++,n=0;for(var c in this.headers)this.headers.hasOwnProperty(c)&&(a.push(new TextEncoder("utf-8").encode(c)),l.push(new TextEncoder("utf-8").encode(this.headers[c])),o+=4,o+=a[n].length,o+=l[n].length,n++);t=new TextEncoder("utf-8").encode(this.data),o+=t.length;var u=new ArrayBuffer(o),h=new Uint8Array(u,0,o);for(o-=4,h[0]=(4278190080&o)>>>24,h[1]=(16711680&o)>>>16,h[2]=(65280&o)>>>8,h[3]=(255&o)>>>0,h[4]=0,h[5]=0,h[6]=this.type,h[7]=this.toAddress.length,n=0;n<s.length;n++)for(e=s[n],h[r++]=e.length>>8&255,h[r++]=e.length>>0&255,i=0;i<e.length;i++)h[r++]=e[i];for(h[r++]=a.length,n=0;n<a.length;n++){for(e=a[n],h[r++]=e.length>>8&255,h[r++]=e.length>>0&255,i=0;i<e.length;i++)h[r++]=e[i];for(e=l[n],h[r++]=e.length>>8&255,h[r++]=e.length>>0&255,i=0;i<e.length;i++)h[r++]=e[i]}for(n=0;n<t.length;n++)h[r++]=t[n];return u},t.Rumor.Message.deserialize=function(e){"undefined"!=typeof Buffer&&Buffer.isBuffer(e)&&(e=n(e));var i,r,o,s,a,l,c,u,h=0,d=8,p=new Uint8Array(e);h+=p[0]<<24,h+=p[1]<<16,h+=p[2]<<8,h+=p[3]<<0,i=p[6];var f=[];for(u=0;u<p[7];u++)c=p[d++]<<8,c+=p[d++],r=new Uint8Array(e,d,c),f[u]=new TextDecoder("utf-8").decode(r),d+=c;for(o=p[d++],s={},u=0;o>u;u++)c=p[d++]<<8,c+=p[d++],r=new Uint8Array(e,d,c),a=new TextDecoder("utf-8").decode(r),d+=c,c=p[d++]<<8,c+=p[d++],r=new Uint8Array(e,d,c),l=new TextDecoder("utf-8").decode(r),s[a]=l,d+=c;var g=new Uint8Array(e,d),m=new TextDecoder("utf-8").decode(g);return new t.Rumor.Message(i,f,s,m)},t.Rumor.Message.Connect=function(e,n){var i={uniqueId:e,notifyDisconnectAddress:n};return new t.Rumor.Message(t.Rumor.MessageType.CONNECT,[],i,"")},t.Rumor.Message.Disconnect=function(){return new t.Rumor.Message(t.Rumor.MessageType.DISCONNECT,[],{},"")},t.Rumor.Message.Subscribe=function(e){return new t.Rumor.Message(t.Rumor.MessageType.SUBSCRIBE,e,{},"")},t.Rumor.Message.Unsubscribe=function(e){return new t.Rumor.Message(t.Rumor.MessageType.UNSUBSCRIBE,e,{},"")},t.Rumor.Message.Publish=function(e,n,i){return new t.Rumor.Message(t.Rumor.MessageType.MESSAGE,e,i||{},n||"")},t.Rumor.Message.Ping=function(){return new t.Rumor.Message(t.Rumor.MessageType.PING,[],{},"")},!function(){var e=100,n=10;t.Rumor.NativeSocket=function(i,r,o){var s,a,l,c;s=new i(r),s.binaryType="arraybuffer",s.onopen=o.onOpen,s.onclose=o.onClose,s.onerror=o.onError,s.onmessage=function(e){if(t){var n=t.Rumor.Message.deserialize(e.data);o.onMessage(n)}},a=function u(t){s&&(void 0===t&&(t=0),l&&clearTimeout(l),s.bufferedAmount>0&&n>=t+1?l=setTimeout(u,e,t+1):c())},c=function(){s.close()},this.close=function(e){e?a():c()},this.send=function(e){s.send(e.serialize())},this.isClosed=function(){return 3===s.readyState}}}(this);var g,m=9e3,v=5*m-100;g={1002:"The endpoint is terminating the connection due to a protocol error. (CLOSE_PROTOCOL_ERROR)",1003:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data). (CLOSE_UNSUPPORTED)",1004:"The endpoint is terminating the connection because a data frame was received that is too large. (CLOSE_TOO_LARGE)",1005:"Indicates that no status code was provided even though one was expected. (CLOSE_NO_STATUS)",1006:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected. (CLOSE_ABNORMAL)",1007:"Indicates that an endpoint is terminating the connection because it has received data within a message that was not consistent with the type of the message (e.g., non-UTF-8 [RFC3629] data within a text message)",1008:"Indicates that an endpoint is terminating the connection because it has received a message that violates its policy.  This is a generic status code that can be returned when there is no other more suitable status code (e.g., 1003 or 1009) or if there is a need to hide specific details about the policy",1009:"Indicates that an endpoint is terminating the connection because it has received a message that is too big for it to process",1011:"Indicates that a server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request",4001:"Connectivity loss was detected as it was too long since the socket received the last PONG message"},t.Rumor.SocketError=function(e,t){this.code=e,this.message=t},t.Rumor.Socket=function(n,i,r){var o,s,a,l,c,u,h,d,p,f,b=["disconnected","error","connected","connecting","disconnecting"],y=function(e){switch(e){case"disconnected":case"error":if(o=null,c){var t;C()&&(t=new Error(g[4001]),t.code=4001),c(t)}}},w=t.$.statable(this,b,"disconnected",y),_=function(e,n){if(null===n||!t.$.isFunction(n))throw new Error("The Rumor.Socket "+e+" callback must be a valid function or null")},x=t.$.bind(function(e){t.error("Rumor.Socket: "+e);var n=new t.Rumor.SocketError(null,e||"Unknown Socket Error");d&&clearTimeout(d),w("error"),"connecting"===this.previousState&&h&&(h(n,void 0),h=null),l&&l(n)},this),C=function(){return p?t.$.now()-p>=v:!1},$=t.$.bind(function(){this.is("connected")&&(C()?D({code:4001}):(o.send(t.Rumor.Message.Ping()),f=setTimeout($,m)))},this),k=function(){return!e.OT},S=t.$.bind(function(){return d&&clearTimeout(d),this.isNot("connecting")?void t.debug("webSocketConnected reached in state other than connecting"):(o.send(t.Rumor.Message.Connect(s,i)),w("connected"),h&&(h(void 0,s),h=null),a&&a(s),void(f=setTimeout(function(){p=t.$.now(),$()},m)))},this),T=function(){var e=o;x("Timed out while waiting for the Rumor socket to connect.");try{e.close()}catch(t){}},E=function(){},D=t.$.bind(function(e){if(d&&clearTimeout(d),f&&clearTimeout(f),!k()){if(1e3!==e.code&&1001!==e.code){var t=e.reason||e.message;!t&&g.hasOwnProperty(e.code)&&(t=g[e.code]),x("Rumor Socket Disconnected: "+t)}this.isNot("error")&&w("disconnected")}},this),A=function(e){p=t.$.now(),u&&e.type!==t.Rumor.MessageType.PONG&&u(e)};this.publish=function(e,n,i){o.send(t.Rumor.Message.Publish(e,n,i))},this.subscribe=function(e){o.send(t.Rumor.Message.Subscribe(e))},this.unsubscribe=function(e){o.send(t.Rumor.Message.Unsubscribe(e))},this.connect=function(i,a){if(this.is("connecting","connected"))return void a(new t.Rumor.SocketError(null,"Rumor.Socket cannot connect when it is already connecting or connected."));s=i,h=a,w("connecting");var l=r||e.WebSocket,c={onOpen:S,onClose:D,onError:E,onMessage:A};try{o="undefined"!=typeof l?new t.Rumor.NativeSocket(l,n,c):new t.Rumor.PluginSocket(n,c),d=setTimeout(T,t.Rumor.Socket.CONNECT_TIMEOUT)}catch(u){t.error(u),x("Could not connect to the Rumor socket, possibly because of a blocked port.")}},this.disconnect=function(e){return d&&clearTimeout(d),f&&clearTimeout(f),o?void(o.isClosed()?this.isNot("error")&&w("disconnected"):(this.is("connected")&&o.send(t.Rumor.Message.Disconnect()),o.close(e))):void(this.isNot("error")&&w("disconnected"))},t.$.defineProperties(this,{id:{get:function(){return s}},onOpen:{set:function(e){_("onOpen",e),a=e},get:function(){return a}},onError:{set:function(e){_("onError",e),l=e},get:function(){return l}},onClose:{set:function(e){_("onClose",e),c=e},get:function(){return c}},onMessage:{set:function(e){_("onMessage",e),u=e},get:function(){return u}}})},t.Rumor.Socket.CONNECT_TIMEOUT=15e3,t.Raptor={Actions:{CONNECT:100,CREATE:101,UPDATE:102,DELETE:103,STATE:104,FORCE_DISCONNECT:105,FORCE_UNPUBLISH:106,SIGNAL:107,CREATE_ARCHIVE:108,CLOSE_ARCHIVE:109,START_RECORDING_SESSION:110,STOP_RECORDING_SESSION:111,START_RECORDING_STREAM:112,STOP_RECORDING_STREAM:113,LOAD_ARCHIVE:114,START_PLAYBACK:115,STOP_PLAYBACK:116,APPSTATE_PUT:117,APPSTATE_DELETE:118,OFFER:119,ANSWER:120,PRANSWER:121,CANDIDATE:122,SUBSCRIBE:123,UNSUBSCRIBE:124,QUERY:125,SDP_ANSWER:126,PONG:127,REGISTER:128,QUALITY_CHANGED:129},Types:{RPC_REQUEST:100,RPC_RESPONSE:101,STREAM:102,ARCHIVE:103,CONNECTION:104,APPSTATE:105,CONNECTIONCOUNT:106,MODERATION:107,SIGNAL:108,SUBSCRIBER:110,JSEP:109}},t.Raptor.serializeMessage=function(e){return JSON.stringify(e)},t.Raptor.deserializeMessage=function(e){if(0===e.length)return{};var t=JSON.parse(e),n=t.uri.substr(1).split("/");n.shift(),""===n[n.length-1]&&n.pop(),t.params={};for(var i=0,r=n.length;r-1>i;i+=2)t.params[n[i]]=n[i+1];return t.resource=n.length%2===0?"channel"===n[n.length-2]&&n.length>6?n[n.length-4]+"_"+n[n.length-2]:n[n.length-2]:"channel"===n[n.length-1]&&n.length>5?n[n.length-3]+"_"+n[n.length-1]:n[n.length-1],t.signature=t.resource+"#"+t.method,t},t.Raptor.unboxFromRumorMessage=function(e){var n=t.Raptor.deserializeMessage(e.data);return n.transactionId=e.transactionId,n.fromAddress=e.headers["X-TB-FROM-ADDRESS"],n},t.Raptor.parseIceServers=function(e){try{return JSON.parse(e.data).content.iceServers}catch(t){return[]}},t.Raptor.Message={},t.Raptor.Message.offer=function(e,n){return t.Raptor.serializeMessage({method:"offer",uri:e,content:{sdp:n}})},t.Raptor.Message.connections={},t.Raptor.Message.connections.create=function(e,n,i){return t.Raptor.serializeMessage({method:"create",uri:"/v2/partner/"+e+"/session/"+n+"/connection/"+i,content:{userAgent:t.$.env.userAgent}})},t.Raptor.Message.connections.destroy=function(e,n,i){return t.Raptor.serializeMessage({method:"delete",uri:"/v2/partner/"+e+"/session/"+n+"/connection/"+i,content:{}})},t.Raptor.Message.sessions={},t.Raptor.Message.sessions.get=function(e,n){return t.Raptor.serializeMessage({method:"read",uri:"/v2/partner/"+e+"/session/"+n,content:{}})},t.Raptor.Message.streams={},t.Raptor.Message.streams.get=function(e,n,i){return t.Raptor.serializeMessage({method:"read",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i,content:{}})},t.Raptor.Message.streams.channelFromOTChannel=function(e){var t={id:e.id,type:e.type,active:e.active};return"video"===e.type&&(t.width=e.width,t.height=e.height,t.orientation=e.orientation,t.frameRate=e.frameRate,"default"!==e.source&&(t.source=e.source),t.fitMode=e.fitMode),t},t.Raptor.Message.streams.create=function(e,n,i,r,o,s,a,l){var c={id:i,name:r,audioFallbackEnabled:o,channel:t.$.map(s,function(e){return t.Raptor.Message.streams.channelFromOTChannel(e)})};return a&&(c.minBitrate=a),l&&(c.maxBitrate=l),t.Raptor.serializeMessage({method:"create",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i,content:c})},t.Raptor.Message.streams.destroy=function(e,n,i){return t.Raptor.serializeMessage({method:"delete",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i,content:{}})},t.Raptor.Message.streams.answer=function(e,n,i,r){return t.Raptor.serializeMessage({method:"answer",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i,content:{sdp:r}})},t.Raptor.Message.streams.candidate=function(e,n,i,r){return t.Raptor.serializeMessage({method:"candidate",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i,content:r})},t.Raptor.Message.streamChannels={},t.Raptor.Message.streamChannels.update=function(e,n,i,r,o){return t.Raptor.serializeMessage({method:"update",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i+"/channel/"+r,content:o})},t.Raptor.Message.subscribers={},t.Raptor.Message.subscribers.create=function(e,n,i,r,o,s){var a={id:r,connection:o,keyManagementMethod:t.$.supportedCryptoScheme(),bundleSupport:t.$.hasCapabilities("bundle"),rtcpMuxSupport:t.$.hasCapabilities("RTCPMux")};return s&&(a.channel=s),t.Raptor.serializeMessage({method:"create",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i+"/subscriber/"+r,content:a})},t.Raptor.Message.subscribers.destroy=function(e,n,i,r){return t.Raptor.serializeMessage({method:"delete",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i+"/subscriber/"+r,content:{}})},t.Raptor.Message.subscribers.update=function(e,n,i,r,o){return t.Raptor.serializeMessage({method:"update",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i+"/subscriber/"+r,content:o})},t.Raptor.Message.subscribers.candidate=function(e,n,i,r,o){return t.Raptor.serializeMessage({method:"candidate",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i+"/subscriber/"+r,content:o})},t.Raptor.Message.subscribers.answer=function(e,n,i,r,o){return t.Raptor.serializeMessage({method:"answer",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i+"/subscriber/"+r,content:{sdp:o}})},t.Raptor.Message.subscriberChannels={},t.Raptor.Message.subscriberChannels.update=function(e,n,i,r,o,s){return t.Raptor.serializeMessage({method:"update",uri:"/v2/partner/"+e+"/session/"+n+"/stream/"+i+"/subscriber/"+r+"/channel/"+o,content:s})},t.Raptor.Message.signals={},t.Raptor.Message.signals.create=function(e,n,i,r,o){var s={};return void 0!==r&&(s.type=r),void 0!==o&&(s.data=o),t.Raptor.serializeMessage({method:"signal",uri:"/v2/partner/"+e+"/session/"+n+(void 0!==i?"/connection/"+i:"")+"/signal/"+t.$.uuid(),content:s})},!function(){var e;e={409:"This P2P session already has 2 participants.",410:"The session already has four participants.",1004:"The token passed is invalid."},t.Raptor.Dispatcher=function(){t.$.eventing(this,!0),this.callbacks={}},t.Raptor.Dispatcher.prototype.registerCallback=function(e,t){this.callbacks[e]=t},t.Raptor.Dispatcher.prototype.triggerCallback=function(e){if(e){var n=this.callbacks[e];if(n&&t.$.isFunction(n)){var i=Array.prototype.slice.call(arguments);i.shift(),n.apply(null,i)}delete this.callbacks[e]}},t.Raptor.Dispatcher.prototype.onClose=function(e){this.emit("close",e)},t.Raptor.Dispatcher.prototype.dispatch=function(e){if(e.type===t.Rumor.MessageType.STATUS){t.debug("OT.Raptor.dispatch: STATUS"),t.debug(e);var n;return e.isError&&(n=new t.Error(e.status)),void this.triggerCallback(e.transactionId,n,e)}var i=t.Raptor.unboxFromRumorMessage(e);switch(t.debug("OT.Raptor.dispatch "+i.signature),t.debug(e.data),i.resource){case"session":this.dispatchSession(i);break;case"connection":this.dispatchConnection(i);break;case"stream":this.dispatchStream(i);break;case"stream_channel":this.dispatchStreamChannel(i);break;case"subscriber":this.dispatchSubscriber(i);break;case"subscriber_channel":this.dispatchSubscriberChannel(i);break;case"signal":this.dispatchSignal(i);break;case"archive":this.dispatchArchive(i);break;default:t.warn("OT.Raptor.dispatch: Type "+i.resource+" is not currently implemented")}},t.Raptor.Dispatcher.prototype.dispatchSession=function(e){switch(e.method){case"read":this.emit("session#read",e.content,e.transactionId);break;default:t.warn("OT.Raptor.dispatch: "+e.signature+" is not currently implemented")}},t.Raptor.Dispatcher.prototype.dispatchConnection=function(e){switch(e.method){case"created":this.emit("connection#created",e.content);break;case"deleted":this.emit("connection#deleted",e.params.connection,e.reason);break;default:t.warn("OT.Raptor.dispatch: "+e.signature+" is not currently implemented")}},t.Raptor.Dispatcher.prototype.dispatchStream=function(e){switch(e.method){case"created":this.emit("stream#created",e.content,e.transactionId);break;case"deleted":this.emit("stream#deleted",e.params.stream,e.reason);break;case"updated":this.emit("stream#updated",e.params.stream,e.content);break;case"generateoffer":case"answer":case"pranswer":case"offer":case"candidate":this.dispatchJsep(e.method,e);break;default:t.warn("OT.Raptor.dispatch: "+e.signature+" is not currently implemented")}},t.Raptor.Dispatcher.prototype.dispatchStreamChannel=function(e){switch(e.method){case"updated":this.emit("streamChannel#updated",e.params.stream,e.params.channel,e.content);break;default:t.warn("OT.Raptor.dispatch: "+e.signature+" is not currently implemented")}},t.Raptor.Dispatcher.prototype.dispatchJsep=function(e,t){this.emit("jsep#"+e,t.params.stream,t.fromAddress,t)},t.Raptor.Dispatcher.prototype.dispatchSubscriberChannel=function(e){switch(e.method){case"updated":this.emit("subscriberChannel#updated",e.params.stream,e.params.channel,e.content);break;case"update":this.emit("subscriberChannel#update",e.params.subscriber,e.params.stream,e.content);break;default:t.warn("OT.Raptor.dispatch: "+e.signature+" is not currently implemented")}},t.Raptor.Dispatcher.prototype.dispatchSubscriber=function(e){switch(e.method){case"created":this.emit("subscriber#created",e.params.stream,e.fromAddress,e.content.id);break;case"deleted":this.dispatchJsep("unsubscribe",e),this.emit("subscriber#deleted",e.params.stream,e.fromAddress);break;case"generateoffer":case"answer":case"pranswer":case"offer":case"candidate":this.dispatchJsep(e.method,e);break;default:t.warn("OT.Raptor.dispatch: "+e.signature+" is not currently implemented")}},t.Raptor.Dispatcher.prototype.dispatchSignal=function(e){return"signal"!==e.method?void t.warn("OT.Raptor.dispatch: "+e.signature+" is not currently implemented"):void this.emit("signal",e.fromAddress,e.content.type,e.content.data)},t.Raptor.Dispatcher.prototype.dispatchArchive=function(e){switch(e.method){case"created":this.emit("archive#created",e.content);break;case"updated":this.emit("archive#updated",e.params.archive,e.content)}}}(this),function(e){function n(e,n){var i=e.channel.map(function(e){return new t.StreamChannel(e)}),r=e.connectionId?e.connectionId:e.connection.id;return new t.Stream(e.id,e.name,e.creationTime,n.connections.get(r),n,i)}function i(e,t){if(!t.streams.has(e.id)){var i=n(e,t);return t.streams.add(i),i}}function r(e){return new t.Archive(e.id,e.name,e.status)}function o(e,t){if(!t.archives.has(e.id)){var n=r(e);return t.archives.add(n),n}}t.publishers=new t.$.Collection("guid"),t.subscribers=new t.$.Collection("widgetId"),t.sessions=new t.$.Collection;var s=function(e){var t=[];this.enqueue=function(){t.push(Array.prototype.slice.call(arguments))},this.triggerAll=function(){for(var n;n=t.shift();)e.trigger.apply(e,n)}},a=function(e){var n={};this.enqueue=function(){var t=arguments[0],i=Array.prototype.slice.call(arguments,1);n[t]||(n[t]=new s(e)),n[t].enqueue.apply(n[t],i)},this.triggerConnectionCreated=function(e){n["connectionCreated"+e.id]&&n["connectionCreated"+e.id].triggerAll()},this.triggerSessionConnected=function(e){n.sessionConnected&&n.sessionConnected.triggerAll(),t.$.forEach(e,function(e){this.triggerConnectionCreated(e)})}},l={};e.OT.SessionDispatcher=function(e){var n=new t.Raptor.Dispatcher,r=!1,s=new a(n);n.on("close",function(n){var i=e.connection;return i?i.destroyedReason()?void t.debug("OT.Raptor.Socket: Socket was closed but the connection had already been destroyed. Reason: "+i.destroyedReason()):void i.destroy(n):void 0});var c=function(n,r){return n=t.Connection.fromHash(n),(r||e.connection&&n.id!==e.connection.id)&&(e.connections.add(n),s.triggerConnectionCreated(n)),t.$.forEach(t.$.keys(l),function(t){var o=l[t];if(o&&n.id===o.connection.id){i(o,e),delete l[o.id];var s={debug:r?"connection came in session#read":"connection came in connection#created",streamId:o.id,connectionId:n.id};e.logEvent("streamCreated","warning",s)}}),n};n.on("session#read",function(a,l){var u,h={};h.streams=[],h.connections=[],h.archives=[],t.$.forEach(a.connection,function(e){u=c(e,!0),h.connections.push(u)}),t.$.forEach(a.stream,function(t){h.streams.push(i(t,e))}),t.$.forEach(a.archive||a.archives,function(t){h.archives.push(o(t,e))}),e._.subscriberMap={},n.triggerCallback(l,null,h),r=!0,s.triggerSessionConnected(e.connections)}),n.on("connection#created",function(e){c(e)}),n.on("connection#deleted",function(t,n){t=e.connections.get(t),t.destroy(n)}),n.on("stream#created",function(t,r){var o=t.connectionId?t.connectionId:t.connection.id;if(e.connections.has(o))t=i(t,e);else{l[t.id]=t;var s={debug:"eventOrderError -- streamCreated event before connectionCreated",streamId:t.id};e.logEvent("streamCreated","warning",s)}t.publisher&&t.publisher.setStream(t),n.triggerCallback(r,null,t)}),n.on("stream#deleted",function(n,i){var r=e.streams.get(n);return r?void r.destroy(i):void t.error("OT.Raptor.dispatch: A stream does not exist with the id of "+n+", for stream#deleted message!")}),n.on("stream#updated",function(n,i){var r=e.streams.get(n);return r?void r._.update(i):void t.error("OT.Raptor.dispatch: A stream does not exist with the id of "+n+", for stream#updated message!")}),n.on("streamChannel#updated",function(n,i,r){var o;return n&&(o=e.streams.get(n))?void o._.updateChannel(i,r):void t.error("OT.Raptor.dispatch: Unable to determine streamId, or the stream does not exist, for streamChannel message!")});var u=function(e,n,i,r){var o,s;switch(e){case"offer":s=[];var a=t.subscribers.find({streamId:n});a&&s.push(a);break;case"answer":case"pranswer":case"generateoffer":case"unsubscribe":s=t.publishers.where({streamId:n});break;case"candidate":s=t.publishers.where({streamId:n}).concat(t.subscribers.where({streamId:n}));break;default:return void t.warn("OT.Raptor.dispatch: jsep#"+e+" is not currently implemented")}if(0!==s.length){if(o=s[0].session.connections.get(i),!o&&i.match(/^symphony\./))o=t.Connection.fromHash({id:i,creationTime:Math.floor(t.$.now())}),s[0].session.connections.add(o);else if(!o)return void t.warn("OT.Raptor.dispatch: Messsage comes from a connection ("+i+") that we do not know about. The message was ignored.");t.$.forEach(s,function(t){t.processMessage(e,o,r)})}};return n.on("jsep#offer",t.$.bind(u,null,"offer")),n.on("jsep#answer",t.$.bind(u,null,"answer")),n.on("jsep#pranswer",t.$.bind(u,null,"pranswer")),n.on("jsep#generateoffer",t.$.bind(u,null,"generateoffer")),n.on("jsep#unsubscribe",t.$.bind(u,null,"unsubscribe")),n.on("jsep#candidate",t.$.bind(u,null,"candidate")),n.on("subscriberChannel#updated",function(n,i,r){return n&&e.streams.has(n)?void e.streams.get(n)._.updateChannel(i,r):void t.error("OT.Raptor.dispatch: Unable to determine streamId, or the stream does not exist, for subscriberChannel#updated message!")}),n.on("subscriberChannel#update",function(n,i,r){return i&&e.streams.has(i)?t.subscribers.has(n)?void t.subscribers.get(n).disableVideo(r.active):void t.error("OT.Raptor.dispatch: Unable to determine subscriberId, or the subscriber does not exist, for subscriberChannel#update message!"):void t.error("OT.Raptor.dispatch: Unable to determine streamId, or the stream does not exist, for subscriberChannel#update message!")}),n.on("subscriber#created",function(n,i,r){var o=n?e.streams.get(n):null;return o?void(e._.subscriberMap[i+"_"+o.id]=r):void t.error("OT.Raptor.dispatch: Unable to determine streamId, or the stream does not exist, for subscriber#created message!")}),n.on("subscriber#deleted",function(n,i){var r=n?e.streams.get(n):null;return r?void delete e._.subscriberMap[i+"_"+r.id]:void t.error("OT.Raptor.dispatch: Unable to determine streamId, or the stream does not exist, for subscriber#created message!")}),n.on("signal",function(t,n,i){var o=e.connections.get(t);e.connection&&t===e.connection.connectionId?r?e._.dispatchSignal(o,n,i):s.enqueue("sessionConnected","signal",t,n,i):e.connections.get(t)?e._.dispatchSignal(o,n,i):s.enqueue("connectionCreated"+t,"signal",t,n,i)}),n.on("archive#created",function(t){o(t,e)}),n.on("archive#updated",function(n,i){var r=e.archives.get(n);return r?void r._.update(i):void t.error("OT.Raptor.dispatch: An archive does not exist with the id of "+n+", for archive#updated message!")}),n}}(e),t.httpTest=i;var b={getMLineIndex:function(e,n){var i="m="+n;return t.$.findIndex(e,function(e){return-1!==e.indexOf(i)?!0:!1})},getMLinePayloadTypes:function(e,n){var i=new RegExp("^m="+n+" \\d+(/\\d+)? [a-zA-Z0-9/]+(( [a-zA-Z0-9/]+)+)$","i"),r=e.match(i);return!r||r.length<2?[]:t.$.trim(r[2]).split(" ")},removeTypesFromMLine:function(e,n){return t.$.trim(e.replace(new RegExp(" "+n.join(" |"),"ig")," ").replace(/\s+/g," "))},removeMediaEncoding:function(e,n,i){var r,o,s=e.split("\r\n"),a=b.getMLineIndex(s,n),l=a>-1?s[a]:void 0,c=[];if(-1===a)return s.join("\r\n");if(r=b.getMLinePayloadTypes(l,n),0===r.length)return s.join("\r\n");var u=new RegExp("a=rtpmap:("+r.join("|")+") "+i+"\\/\\d+","i");return s=t.$.filter(s,function(e,t){return o=e.match(u),null===o?!0:(c.push(o[1]),a>t&&a--,!1)}),c.length>0&&a>-1&&(s[a]=b.removeTypesFromMLine(l,c)),s.join("\r\n")},removeComfortNoise:function(e){return b.removeMediaEncoding(e,"audio","CN")},removeVideoCodec:function(e,t){return b.removeMediaEncoding(e,"video",t)}},y={};y.isVideoStat=r,y.isAudioStat=o,y.isInboundStat=s,y.parseStatCategory=a,y.normalizeTimestamp=l,t.getStatsHelpers=y,t.getStatsAdpater=c,t.webrtcTest=u,t.Chrome=function(e){var n=!1,i={},r=function(t,n){n.parent=this,n.appendTo(e.parent),i[t]=n,this[t]=n};e.parent&&(t.$.eventing(this),this.destroy=function(){this.off(),this.hideWhileLoading();for(var e in i)i[e].destroy()},this.showAfterLoading=function(){n=!0;for(var e in i)i[e].showAfterLoading()},this.hideWhileLoading=function(){n=!1;for(var e in i)i[e].hideWhileLoading()},this.set=function(e,t){if("string"==typeof e&&t)r.call(this,e,t);else for(var n in e)e.hasOwnProperty(n)&&r.call(this,n,e[n]);return this})},t.Chrome.Behaviour||(t.Chrome.Behaviour={}),t.Chrome.Behaviour.Widget=function(e,n){var i,r,o=n||{},s="auto";e.setDisplayMode=function(e){var n=e||"auto";i!==n&&(t.$.removeClass(this.domElement,"OT_mode-"+i),t.$.addClass(this.domElement,"OT_mode-"+n),"off"===n&&(s=i),i=n)},e.getDisplayMode=function(){return i},e.show=function(){return i!==s&&(this.setDisplayMode(s),o.onShow&&o.onShow()),this},e.showAfterLoading=function(){this.setDisplayMode(r)},e.hide=function(){return"off"!==i&&(this.setDisplayMode("off"),o.onHide&&o.onHide()),this},e.hideWhileLoading=function(){r=i,this.setDisplayMode("off")},e.destroy=function(){return o.onDestroy&&o.onDestroy(this.domElement),this.domElement&&t.$.removeElement(this.domElement),e},e.appendTo=function(n){return this.domElement=t.$.createElement(o.nodeName||"div",o.htmlAttributes,o.htmlContent),o.onCreate&&o.onCreate(this.domElement),e.setDisplayMode(o.mode),"auto"===o.mode&&(t.$.addClass(e.domElement,"OT_mode-on-hold"),setTimeout(function(){t.$.removeClass(e.domElement,"OT_mode-on-hold")},2e3)),n.appendChild(this.domElement),e}},t.Chrome.VideoDisabledIndicator=function(e){var n,i=!1,r=!1;n=t.$.bind(function(e){i?t.$.addClass(e,"OT_video-disabled"):t.$.removeClass(e,"OT_video-disabled"),r?t.$.addClass(e,"OT_video-disabled-warning"):t.$.removeClass(e,"OT_video-disabled-warning"),!i&&!r||"auto"!==this.getDisplayMode()&&"on"!==this.getDisplayMode()?t.$.removeClass(e,"OT_active"):t.$.addClass(e,"OT_active")},this),this.disableVideo=function(e){i=e,e===!0&&(r=!1),n(this.domElement)},this.setWarning=function(e){r=e,n(this.domElement)},t.Chrome.Behaviour.Widget(this,{mode:e.mode||"auto",nodeName:"div",htmlAttributes:{className:"OT_video-disabled-indicator"}});var o=t.$.bind(this.setDisplayMode,this);this.setDisplayMode=function(e){o(e),n(this.domElement)}},t.Chrome.NamePanel=function(e){var n=e.name;n&&""!==t.$.trim(n).length||(n=null,e.mode="off"),this.setName=t.$.bind(function(e){n||this.setDisplayMode("auto"),n=e,this.domElement.innerHTML=n}),t.Chrome.Behaviour.Widget(this,{mode:e.mode,nodeName:"h1",htmlContent:n,htmlAttributes:{className:"OT_name OT_edge-bar-item"}})},t.Chrome.MuteButton=function(e){var n,i,r,o,s,a=e.muted||!1;i=t.$.bind(function(){a?t.$.addClass(this.domElement,"OT_active"):t.$.removeClass(this.domElement,"OT_active ")},this),r=function(e){n=t.$.bind(s,this),t.$.on(e,"click",n)},o=function(e){n=null,t.$.off(e,"click",n)},s=function(){return a=!a,i(),a?this.parent.trigger("muted",this):this.parent.trigger("unmuted",this),!1},t.$.defineProperties(this,{muted:{get:function(){return a},set:function(e){a=e,i()}}});var l=a?"OT_edge-bar-item OT_mute OT_active":"OT_edge-bar-item OT_mute";t.Chrome.Behaviour.Widget(this,{mode:e.mode,nodeName:"button",htmlContent:"Mute",htmlAttributes:{className:l},onCreate:t.$.bind(r,this),onDestroy:t.$.bind(o,this)})},t.Chrome.BackingBar=function(e){function n(){return"on"===i||"on"===r?"on":"mini"===i||"mini"===r?"mini":"mini-auto"===i||"mini-auto"===r?"mini-auto":"auto"===i||"auto"===r?"auto":"off"}var i=e.nameMode,r=e.muteMode;t.Chrome.Behaviour.Widget(this,{mode:n(),nodeName:"div",htmlContent:"",
htmlAttributes:{className:"OT_bar OT_edge-bar-item"}}),this.setNameMode=function(e){i=e,this.setDisplayMode(n())},this.setMuteMode=function(e){r=e,this.setDisplayMode(n())}},t.Chrome.AudioLevelMeter=function(e){function n(){r=t.$.createElement("div",{className:"OT_audio-level-meter__bar"},""),s=t.$.createElement("div",{className:"OT_audio-level-meter__value"},""),o=t.$.createElement("div",{className:"OT_audio-level-meter__audio-only-img"},""),l.domElement.appendChild(r),l.domElement.appendChild(o),l.domElement.appendChild(s)}function i(){var e=100*a/(c-u);s.style.width=s.style.height=2*e+"%",s.style.top=s.style.right=-e+"%"}var r,o,s,a,l=this,c=e.maxValue||1,u=e.minValue||0,h={mode:e?e.mode:"auto",nodeName:"div",htmlAttributes:{className:"OT_audio-level-meter"},onCreate:n};t.Chrome.Behaviour.Widget(this,h);var d=t.$.bind(l.setDisplayMode,l);l.setDisplayMode=function(t){d(t),"off"===t?e.onPassivate&&e.onPassivate():e.onActivate&&e.onActivate()},l.setValue=function(e){a=e,i()}},t.Chrome.Archiving=function(e){var n,i,r,o,s,a,l,c=e.archiving,u=e.archivingStarted||"Archiving on",h=e.archivingEnded||"Archiving off",d=!0;a=function(e){o.nodeValue=e,n.setAttribute("title",e)},l=t.$.bind(function(){s&&(clearTimeout(s),s=null),c?t.$.addClass(i,"OT_active"):t.$.removeClass(i,"OT_active"),t.$.removeClass(this.domElement,"OT_archiving-"+(c?"off":"on")),t.$.addClass(this.domElement,"OT_archiving-"+(c?"on":"off")),e.show&&c?(a(u),t.$.addClass(r,"OT_mode-on"),t.$.removeClass(r,"OT_mode-auto"),this.setDisplayMode("on"),s=setTimeout(function(){t.$.addClass(r,"OT_mode-auto"),t.$.removeClass(r,"OT_mode-on")},5e3)):e.show&&!d?(t.$.addClass(r,"OT_mode-on"),t.$.removeClass(r,"OT_mode-auto"),this.setDisplayMode("on"),a(h),s=setTimeout(t.$.bind(function(){this.setDisplayMode("off")},this),5e3)):this.setDisplayMode("off")},this),t.Chrome.Behaviour.Widget(this,{mode:c&&e.show&&"on"||"off",nodeName:"h1",htmlAttributes:{className:"OT_archiving OT_edge-bar-item OT_edge-bottom"},onCreate:t.$.bind(function(){n=t.$.createElement("div",{className:"OT_archiving-light-box"},""),i=t.$.createElement("div",{className:"OT_archiving-light"},""),n.appendChild(i),r=t.$.createElement("div",{className:"OT_archiving-status OT_mode-on OT_edge-bar-item OT_edge-bottom"},""),o=document.createTextNode(""),r.appendChild(o),this.domElement.appendChild(n),this.domElement.appendChild(r),l()},this)}),this.setShowArchiveStatus=t.$.bind(function(t){e.show=t,this.domElement&&l.call(this)},this),this.setArchiving=t.$.bind(function(e){c=e,d=!1,this.domElement&&l.call(this)},this)},!function(e){if(e&&"undefined"!=typeof navigator){var n=e.webkitRTCPeerConnection||e.mozRTCPeerConnection;navigator.webkitGetUserMedia?(webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks}),webkitMediaStream.prototype.getAudioTracks||(webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams}),webkitRTCPeerConnection.prototype.getRemoteStreams||(webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})):navigator.mozGetUserMedia&&(MediaStream.prototype.getVideoTracks||(MediaStream.prototype.getVideoTracks=function(){return[]}),MediaStream.prototype.getAudioTracks||(MediaStream.prototype.getAudioTracks=function(){return[]})),"undefined"!=typeof e.MediaStreamTrack&&(e.MediaStreamTrack.prototype.setEnabled||(e.MediaStreamTrack.prototype.setEnabled=function(e){this.enabled=t.$.castToBoolean(e)})),!e.URL&&e.webkitURL&&(e.URL=e.webkitURL),t.$.createPeerConnection=function(e,t,i,r){if(OTPlugin.isInstalled())OTPlugin.initPeerConnection(e,t,i,r);else{var o;try{o=new n(e,t)}catch(s){return void r(s.message)}r(null,o)}}}t.$.supportedCryptoScheme=function(){return"Chrome"===t.$.env.name&&t.$.env.version<25?"SDES_SRTP":"DTLS_SRTP"}}(e);var w,_=function(e,n,i){var r,o;r=function(e,n){return function(r){t.error(e),t.error(r),i&&i(e,r,n)}},o=function(t){t.sdp=b.removeComfortNoise(t.sdp),t.sdp=b.removeVideoCodec(t.sdp,"ulpfec"),t.sdp=b.removeVideoCodec(t.sdp,"red"),e.setLocalDescription(t,function(){n(t)},r("Error while setting LocalDescription","SetLocalDescription"))},e.createOffer(o,r("Error while creating Offer","CreateOffer"),{})},x=function(e,n,i,r){var o,s,a;if(o=function(e,n){return function(i){t.error(e),t.error(i),r&&r(e,i,n)}},s=function(t){t.sdp=b.removeComfortNoise(t.sdp),t.sdp=b.removeVideoCodec(t.sdp,"ulpfec"),t.sdp=b.removeVideoCodec(t.sdp,"red"),e.setLocalDescription(t,function(){i(t)},o("Error while setting LocalDescription","SetLocalDescription"))},a=function(){e.createAnswer(s,o("Error while setting createAnswer","CreateAnswer"),null,!1)},-1===n.sdp.indexOf("a=rtcp-fb")){var l="a=rtcp-fb:* ccm fir\r\na=rtcp-fb:* nack ";n.sdp=n.sdp.replace(/^m=video(.*)$/gim,"m=video$1\r\n"+l)}e.setRemoteDescription(n,a,o("Error while setting RemoteDescription","SetRemoteDescription"))};w=OTPlugin.isInstalled()?OTPlugin.RTCIceCandidate:e.mozRTCIceCandidate||e.RTCIceCandidate;var C,$=function(){var e=[],t=null;this.setPeerConnection=function(e){t=e},this.process=function(n){var i=new w(n.content);t?t.addIceCandidate(i):e.push(i)},this.processPending=function(){for(;e.length;)t.addIceCandidate(e.shift())}},k=function(e){this.data=e.data,this.source=e.source,this.lastEventId=e.lastEventId,this.origin=e.origin,this.timeStamp=e.timeStamp,this.type=e.type,this.ports=e.ports,this.path=e.path},S=function(e){var n={},i=[],r=function(e){return i.push(e),n},o=function(t){return e.send(t),n},s=function(){for(var e;e=i.shift();)n.send(e)},a=function(){n.send=o,s()},l=function(e){n.send=r,n.trigger("close",e)},c=function(e){t.error("Data Channel Error:",e)},u=function(e){var t=new k(e);n.trigger("message",t)};return t.$.eventing(n,!0),n.label=e.label,n.id=e.id,n.reliable=e.reliable,n.negotiated=e.negotiated,n.ordered=e.ordered,n.protocol=e.protocol,n._channel=e,n.close=function(){e.close()},n.equals=function(e,t){if(n.label!==e)return!1;for(var i in t)if(t.hasOwnProperty(i)&&n[i]!==t[i])return!1;return!0},n.send=r,e.addEventListener("open",a,!1),e.addEventListener("close",l,!1),e.addEventListener("error",c,!1),e.addEventListener("message",u,!1),n},T=function(e){var n=[],i={},r=function(e){t.$.filter(n,function(t){return e!==t})},o=function(e){var t=new S(e);return n.push(t),t.on("close",function(){r(t)}),t};return i.add=function(t,n){return o(e.createDataChannel(t,n))},i.addMany=function(e){for(var t in e)e.hasOwnProperty(t)&&i.add(t,e[t])},i.get=function(e,i){return t.$.find(n,function(t){return t.equals(e,i)})},i.getOrAdd=function(e,t){var n=i.get(e,t);return n||(n=i.add(e,t)),n},i.destroy=function(){t.$.forEach(n,function(e){e.close()}),n=[]},e.addEventListener("datachannel",function(e){o(e.channel)},!1),i},E=function(e){var n,i,r=t.$.now(),o=[],s=function(){var i=t.$.now(),r=o[o.length-1],s={delta:n?i-n:0};r&&r.iceConnection===e.iceConnectionState||(s.iceConnectionState=e.iceConnectionState),r&&r.signalingState===e.signalingState||(s.signalingState=e.signalingState),r&&r.iceGatheringState===e.iceGatheringState||(s.iceGathering=e.iceGatheringState),t.debug(s),o.push(s),n=i};return e.addEventListener("iceconnectionstatechange",s,!1),e.addEventListener("signalingstatechange",s,!1),e.addEventListener("icegatheringstatechange",s,!1),{stop:function(){e.removeEventListener("iceconnectionstatechange",s,!1),e.removeEventListener("signalingstatechange",s,!1),e.removeEventListener("icegatheringstatechange",s,!1),i=!0;var a={type:"PeerConnectionWorkflow",success:i,startTime:r,finishTime:n,states:o};t.debug(a)}}};C=OTPlugin.isInstalled()?OTPlugin.RTCSessionDescription:e.mozRTCSessionDescription||e.RTCSessionDescription;var D=function(e){return function(n){n.candidate?e(t.Raptor.Actions.CANDIDATE,{candidate:n.candidate.candidate,sdpMid:n.candidate.sdpMid||"",sdpMLineIndex:n.candidate.sdpMLineIndex||0}):t.debug("IceCandidateForwarder: No more ICE candidates.")}};t.PeerConnection=function(e){var n,i,r,o,s,a=[],l=new $,c=t.getStatsAdpater(),u="new",h=[],d={};t.$.eventing(d),e.iceServers||(e.iceServers=[]);var p=function(e,t,n){h.length&&h[0](e,t,n)},f=function(i,r){if(n)return void i.call(null,null,n);if(a.push(i),!(a.length>1)){var o={optional:[{DtlsSrtpKeyAgreement:!0},{googIPv6:!1}]};t.debug('Creating peer connection config "'+JSON.stringify(e)+'".'),e.iceServers&&0!==e.iceServers.length||t.error("No ice servers present"),t.$.createPeerConnection(e,o,r,g)}},g=function(o,s){if(o)return P("Failed to create PeerConnection, exception: "+o.toString(),"NewPeerConnection"),void(a=[]);if(t.debug("OT attachEventsToPeerConnection"),n=s,r=E(n),i=new T(n),e.channels&&i.addMany(e.channels),n.addEventListener("icecandidate",D(p),!1),n.addEventListener("addstream",k,!1),n.addEventListener("removestream",S,!1),n.addEventListener("signalingstatechange",b,!1),void 0!==n.oniceconnectionstatechange){var l;n.addEventListener("iceconnectionstatechange",function(e){"failed"===e.target.iceConnectionState&&(l&&clearTimeout(l),l=setTimeout(function(){"failed"===e.target.iceConnectionState&&P("The stream was unable to connect due to a network error. Make sure your connection isn't blocked by a firewall.","ICEWorkflow")},5e3))},!1)}m(null)},m=function(){for(;a.length;)a.shift().call(null)},v=function(){l&&l.setPeerConnection(null),r&&r.stop(),N.stopCollecting(),null!==n&&(n.destroy&&n.destroy(),n=null,d.trigger("close"))},b=function(){var e=n.signalingState;if(e&&e!==u)switch(u=e,t.debug("PeerConnection.stateChange: "+u),u){case"closed":v()}},y=function(e){d.trigger("qos",e)},w=function(){var e;if(n.getRemoteStreams)e=n.getRemoteStreams();else{if(!n.remoteStreams)throw new Error("Invalid Peer Connection object implements no method for retrieving remote streams");e=n.remoteStreams}return Array.prototype.slice.call(e)},k=function(e){d.trigger("streamAdded",e.stream)},S=function(e){d.trigger("streamRemoved",e.stream)},A=function(e,t,n){p(e,t,n)},O=function(e){var i=new C({type:"offer",sdp:e.content.sdp}),r=function(e){l.setPeerConnection(n),l.processPending(),A(t.Raptor.Actions.ANSWER,e),N.startCollecting(n)},o=function(e,t,n){P("PeerConnection.offerProcessor "+e+": "+t,n)};f(function(){x(n,i,r,o)})},I=function(e){return e.content.sdp?(s=new C({type:"answer",sdp:e.content.sdp}),n.setRemoteDescription(s,function(){t.debug("setRemoteDescription Success")},function(e){P("Error while setting RemoteDescription "+e,"SetRemoteDescription")}),l.setPeerConnection(n),l.processPending(),void N.startCollecting(n)):void t.error("PeerConnection.processMessage: Weird answer message, no SDP.")},M=function(e){if(t.debug("PeerConnection.processSubscribe: Sending offer to subscriber."),!n)throw new Error("PeerConnection broke!");f(function(){_(n,function(n){o=n,A(t.Raptor.Actions.OFFER,o,e.uri)},function(e,t,n){P("PeerConnection.subscribeProcessor "+e+": "+t,n)})})},P=function(e,n){t.error(e),d.trigger("error",e,n)};d.addLocalStream=function(e){f(function(){n.addStream(e)},e)},d.getSenders=function(){return n.getSenders()},d.disconnect=function(){l=null,n&&n.signalingState&&"closed"!==n.signalingState.toLowerCase()&&(n.close(),"Firefox"===t.$.env.name&&t.$.callAsync(v)),d.off()},d.processMessage=function(e,n){switch(t.debug("PeerConnection.processMessage: Received "+e+" from "+n.fromAddress),t.debug(n),e){case"generateoffer":M(n);break;case"offer":O(n);break;case"answer":case"pranswer":I(n);break;case"candidate":l.process(n);break;default:t.debug("PeerConnection.processMessage: Received an unexpected message of type "+e+" from "+n.fromAddress+": "+JSON.stringify(n))}return d},d.setIceServers=function(t){t&&(e.iceServers=t)},d.registerMessageDelegate=function(e){return h.push(e)},d.unregisterMessageDelegate=function(e){var n=t.$.arrayIndexOf(h,e);return-1!==n&&h.splice(n,1),h.length},d.remoteStreams=function(){return n?w():[]},d.getStats=function(e){f(function(){c(n,e)})};var R=function F(e,n,r,o){var s,a=i.get(n,r);if(!a){if(e>0)return void setTimeout(t.$.bind(F,null,e-1,n,r,o),200);s=new t.$.Error("A channel with that label and options could not be found. Label:"+n+". Options: "+JSON.stringify(r))}o(s,a)};d.getDataChannel=function(e,t,n){f(function(){R(100,e,t,n)})};var N=new t.PeerConnection.QOS(y);return d},!function(){var e=function(e,t,n,i){var r=function(e){return e.stat("googFrameRateSent")?(n.videoSentBytes=Number(e.stat("bytesSent")),n.videoSentPackets=Number(e.stat("packetsSent")),n.videoSentPacketsLost=Number(e.stat("packetsLost")),n.videoRtt=Number(e.stat("googRtt")),n.videoFrameRate=Number(e.stat("googFrameRateInput")),n.videoWidth=Number(e.stat("googFrameWidthSent")),n.videoHeight=Number(e.stat("googFrameHeightSent")),n.videoCodec=e.stat("googCodecName")):e.stat("googFrameRateReceived")&&(n.videoRecvBytes=Number(e.stat("bytesReceived")),n.videoRecvPackets=Number(e.stat("packetsReceived")),n.videoRecvPacketsLost=Number(e.stat("packetsLost")),n.videoFrameRate=Number(e.stat("googFrameRateOutput")),n.videoWidth=Number(e.stat("googFrameWidthReceived")),n.videoHeight=Number(e.stat("googFrameHeightReceived")),n.videoCodec=e.stat("googCodecName")),null},o=function(e){e.stat("audioInputLevel")?(n.audioSentPackets=Number(e.stat("packetsSent")),n.audioSentPacketsLost=Number(e.stat("packetsLost")),n.audioSentBytes=Number(e.stat("bytesSent")),n.audioCodec=e.stat("googCodecName"),n.audioRtt=Number(e.stat("googRtt"))):e.stat("audioOutputLevel")&&(n.audioRecvPackets=Number(e.stat("packetsReceived")),n.audioRecvPacketsLost=Number(e.stat("packetsLost")),n.audioRecvBytes=Number(e.stat("bytesReceived")),n.audioCodec=e.stat("googCodecName"))},s=function(e){if(e.result)for(var t=e.result(),s=0;s<t.length;s++){var a=t[s];a.stat&&("true"===a.stat("googActiveConnection")&&(n.localCandidateType=a.stat("googLocalCandidateType"),n.remoteCandidateType=a.stat("googRemoteCandidateType"),n.transportType=a.stat("googTransportType")),o(a),r(a))}i(null,n)};e.getStats(s)},n=function(e,t,n,i){var r=function(e){i(e)},o=function(e){var i,r=t.audioBytesTransferred||0;e.audioInputLevel?(n.audioSentBytes=Number(e.bytesSent),n.audioSentPackets=Number(e.packetsSent),n.audioSentPacketsLost=Number(e.packetsLost),n.audioRtt=Number(e.googRtt),n.audioCodec=e.googCodecName):e.audioOutputLevel&&(n.audioBytesTransferred=Number(e.bytesReceived),n.audioCodec=e.googCodecName),n.audioBytesTransferred&&(i=n.audioBytesTransferred-r,n.avgAudioBitrate=Math.round(8*i/(n.period/1e3)))},s=function(e){var i,r=t.videoBytesTransferred||0;e.googFrameHeightSent?(n.videoSentBytes=Number(e.bytesSent),n.videoSentPackets=Number(e.packetsSent),n.videoSentPacketsLost=Number(e.packetsLost),n.videoRtt=Number(e.googRtt),n.videoCodec=e.googCodecName,n.videoWidth=Number(e.googFrameWidthSent),n.videoHeight=Number(e.googFrameHeightSent)):e.googFrameHeightReceived&&(n.videoRecvBytes=Number(e.bytesReceived),n.videoRecvPackets=Number(e.packetsReceived),n.videoRecvPacketsLost=Number(e.packetsLost),n.videoRtt=Number(e.googRtt),n.videoCodec=e.googCodecName,n.videoWidth=Number(e.googFrameWidthReceived),n.videoHeight=Number(e.googFrameHeightReceived)),n.videoBytesTransferred&&(i=n.videoBytesTransferred-r,n.avgVideoBitrate=Math.round(8*i/(n.period/1e3))),e.googFrameRateSent?n.videoFrameRate=Number(e.googFrameRateSent):e.googFrameRateReceived&&(n.videoFrameRate=Number(e.googFrameRateReceived))},a=function(e){return void 0!==e.googFrameHeightSent||void 0!==e.googFrameHeightReceived||void 0!==n.videoBytesTransferred||void 0!==e.googFrameRateSent},l=function(e){return"true"===e.googActiveConnection};e.getStats(null,function(e){e.forEach(function(e){l(e)?(n.localCandidateType=e.googLocalCandidateType,n.remoteCandidateType=e.googRemoteCandidateType,n.transportType=e.googTransportType):a(e)?s(e):o(e)}),i(null,n)},r)},i=function(e,t,n,i){var r=function(e){i(e)},o=function(e){"outboundrtp"===e.type?(n.audioSentPackets=e.packetsSent,n.audioSentPacketsLost=e.packetsLost,n.audioSentBytes=e.bytesSent):"inboundrtp"===e.type&&(n.audioRecvPackets=e.packetsReceived,n.audioRecvPacketsLost=e.packetsLost,n.audioRecvBytes=e.bytesReceived)},s=function(e){"outboundrtp"===e.type?(n.videoSentPackets=e.packetsSent,n.videoSentPacketsLost=e.packetsLost,n.videoSentBytes=e.bytesSent):"inboundrtp"===e.type&&(n.videoRecvPackets=e.packetsReceived,n.videoRecvPacketsLost=e.packetsLost,n.videoRecvBytes=e.bytesReceived)};e.getStats(null,function(e){for(var t in e)if(e.hasOwnProperty(t)&&("outboundrtp"===e[t].type||"inboundrtp"===e[t].type)){var r=e[t];-1!==r.id.indexOf("rtp")&&(-1!==r.id.indexOf("audio")?o(r):-1!==r.id.indexOf("video")&&s(r))}i(null,n)},r)},r=function(o,s,a,l){return OTPlugin.isInstalled()?(r=n,n(o,s,a,l)):"Firefox"===t.$.env.name&&t.$.env.version>=27?(r=i,i(o,s,a,l)):(r=e,e(o,s,a,l))};t.PeerConnection.QOS=function(e){var n,i=t.$.now(),o=t.$.bind(function s(o){if(n){var a=t.$.now(),l={timeStamp:a,duration:Math.round(a-i),period:Math.round(a-o.timeStamp)},c=function(n,i){return n?void t.error("Failed to Parse QOS Stats: "+JSON.stringify(n)):(e(i,o),void setTimeout(t.$.bind(s,null,i),t.PeerConnection.QOS.INTERVAL))};r(n,o,l,c)}},this);this.startCollecting=function(e){e&&e.getStats&&(n=e,o({timeStamp:t.$.now()}))},this.stopCollecting=function(){n=null}},t.PeerConnection.QOS.INTERVAL=3e4}(),t.PeerConnections=function(){var e={};return{add:function(n,i,r){var o=n.id+"_"+i,s=e[o];return s||(s=e[o]={count:0,pc:new t.PeerConnection(r)}),s.count+=1,s.pc},remove:function(t,n){var i=t.id+"_"+n,r=e[i];r&&(r.count-=1,0===r.count&&(r.pc.disconnect(),delete e[i]))}}}(),t.SubscriberPeerConnection=function(e,n,i,r,o){var s,a,l,c,u,h,d,p,f=!1,g=!1;a=function(){this.destroy(),this.trigger("disconnected",this)},l=function(e){this.trigger("remoteStreamAdded",e,this)},c=function(e){this.trigger("remoteStreamRemoved",e,this)},u=function(e,t){this.trigger("error",null,e,this,t)},h=t.$.bind(function(e,o){if(!g){var s=e===t.Raptor.Actions.CANDIDATE||e===t.Raptor.Actions.OFFER||e===t.Raptor.Actions.ANSWER||e===t.Raptor.Actions.PRANSWER;if(s){var a=e===t.Raptor.Actions.CANDIDATE?o.candidate:o.sdp;g=-1!==a.indexOf("typ relay")}}switch(e){case t.Raptor.Actions.ANSWER:case t.Raptor.Actions.PRANSWER:this.trigger("connected"),n._.jsepAnswerP2p(i.id,r.widgetId,o.sdp);break;case t.Raptor.Actions.OFFER:n._.jsepOfferP2p(i.id,r.widgetId,o.sdp);break;case t.Raptor.Actions.CANDIDATE:n._.jsepCandidateP2p(i.id,r.widgetId,o)}},this),d=function(e){var t="get"+(e?"Video":"Audio")+"Tracks";return function(e){var n,i,r=s.remoteStreams();if(0!==r.length&&r[0][t])for(var o=0,a=r.length;a>o;++o){i=r[o],n=i[t]();for(var l=0,c=n.length;c>l;++l)n[l].enabled!==e&&n[l].setEnabled(e)}}},p=t.$.bind(function(e,t){this.trigger("qos",e,t)},this),t.$.eventing(this),this.destroy=function(){if(!f){if(f=!0,s){var o=s.unregisterMessageDelegate(h);0===o&&(n&&n.isConnected()&&i&&!i.destroyed&&n._.subscriberDestroy(i,r),this.subscribeToAudio(!1)),t.PeerConnections.remove(e,i.id)}s=null,this.off()}},this.getDataChannel=function(e,t,n){s.getDataChannel(e,t,n)},this.processMessage=function(e,t){s.processMessage(e,t)},this.getStats=function(e){s?s.getStats(e):e(new t.$.Error("Subscriber is not connected cannot getStats",1015))},this.subscribeToAudio=d(!1),this.subscribeToVideo=d(!0),this.hasRelayCandidates=function(){return g},this.init=function(){s=t.PeerConnections.add(e,i.streamId,{}),s.on({close:a,streamAdded:l,streamRemoved:c,error:u,qos:p},this);var d=s.registerMessageDelegate(h);if(s.remoteStreams().length>0)t.$.forEach(s.remoteStreams(),l,this);else if(1===d){var f;if(o.subscribeToVideo||o.subscribeToAudio){var g=i.getChannelsOfType("audio"),m=i.getChannelsOfType("video");f=t.$.map(g,function(e){return{id:e.id,type:e.type,active:o.subscribeToAudio}}).concat(t.$.map(m,function(e){return{id:e.id,type:e.type,active:o.subscribeToVideo,restrictFrameRate:void 0!==o.restrictFrameRate?o.restrictFrameRate:!1}}))}n._.subscriberCreate(i,r,f,t.$.bind(function(e,n){e&&this.trigger("error",e.message,this,"Subscribe"),s&&s.setIceServers(t.Raptor.parseIceServers(n))},this))}}},t.PublisherPeerConnection=function(e,n,i,r,o){var s,a,l,c,u,h=!1,d=n._.subscriberMap[e.id+"_"+i];a=function(){this.destroy(),this.trigger("disconnected",this)},l=function(e,t){this.trigger("error",null,e,this,t),this.destroy()},c=t.$.bind(function(e,r,o){if(!h){var s=e===t.Raptor.Actions.CANDIDATE||e===t.Raptor.Actions.OFFER||e===t.Raptor.Actions.ANSWER||e===t.Raptor.Actions.PRANSWER;if(s){var a=e===t.Raptor.Actions.CANDIDATE?r.candidate:r.sdp;h=-1!==a.indexOf("typ relay")}}switch(e){case t.Raptor.Actions.ANSWER:case t.Raptor.Actions.PRANSWER:n.sessionInfo.p2pEnabled?n._.jsepAnswerP2p(i,d,r.sdp):n._.jsepAnswer(i,r.sdp);break;case t.Raptor.Actions.OFFER:this.trigger("connected"),n._.jsepOffer(o,r.sdp);break;case t.Raptor.Actions.CANDIDATE:n.sessionInfo.p2pEnabled?n._.jsepCandidateP2p(i,d,r):n._.jsepCandidate(i,r)}},this),u=t.$.bind(function(t,n){this.trigger("qos",e,t,n)},this),t.$.eventing(this),this.getDataChannel=function(e,t,n){s.getDataChannel(e,t,n)},this.destroy=function(){s&&(s.off(),t.PeerConnections.remove(e,i)),s=null},this.processMessage=function(e,t){s.processMessage(e,t)},this.init=function(n){s=t.PeerConnections.add(e,i,{iceServers:n,channels:o}),s.on({close:a,error:l,qos:u},this),s.registerMessageDelegate(c),s.addLocalStream(r),this.remoteConnection=function(){return e},this.hasRelayCandidates=function(){return h}},this.getSenders=function(){return s.getSenders()}};var A=function(t,n){function i(){a||((o!==n.videoWidth||s!==n.videoHeight)&&(t.trigger("videoDimensionsChanged",{width:o,height:s},{width:n.videoWidth,height:n.videoHeight}),o=n.videoWidth,s=n.videoHeight),r())}function r(){t.whenTimeIncrements(function(){e.requestAnimationFrame(i)})}var o=n.videoWidth,s=n.videoHeight,a=!0;t.startObservingSize=function(){a=!1,r()},t.stopObservingSize=function(){a=!0}};if(function(e){function n(e,t){var n=document.createElement("video");if(n.setAttribute("autoplay",""),n.innerHTML=e,t){t.muted===!0&&(delete t.muted,n.muted="true");for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i])}return n}function i(e){return d[parseInt(e,10)]||"An unknown error occurred."}function r(n,r,s){var a,l="Chrome"===t.$.env.name?1:0,c=r.getVideoTracks().length>l?"timeupdate":"loadedmetadata",u=function(){clearTimeout(a),n.removeEventListener(c,h,!1),n.removeEventListener("error",d,!1),r.onended=null},h=function(){u(),s(null)},d=function(e){u(),o(n),s("There was an unexpected problem with the Video Stream: "+i(e.target.error.code))},p=function(){u(),o(n),s("Stream ended while trying to bind it to a video element.")};n.addEventListener(c,h,!1),n.addEventListener("error",d,!1),r.onended=p,void 0!==n.srcObject?n.srcObject=r:void 0!==n.mozSrcObject?n.mozSrcObject=r:n.src=e.URL.createObjectURL(r)}function o(t){void 0!==t.srcObject?t.srcObject=null:void 0!==t.mozSrcObject?t.mozSrcObject=null:e.URL.revokeObjectURL(t.src)}var s={0:"rotate(0deg)",270:"rotate(90deg)",90:"rotate(-90deg)",180:"rotate(180deg)"};t.VideoOrientation={ROTATED_NORMAL:0,ROTATED_LEFT:270,ROTATED_RIGHT:90,ROTATED_UPSIDE_DOWN:180};var a=50,l=2*Math.PI/360;t.VideoElement=function(e){var n,i,r=t.$.defaults(e&&!t.$.isFunction(e)?e:{},{fallbackText:"Sorry, Web RTC is not available in your browser"}),o=t.$.isFunction(arguments[arguments.length-1])?arguments[arguments.length-1]:void 0,s=t.$.bind(function(e){this.trigger("orientationChanged",e)},this),a=OTPlugin.isInstalled()?new c(r,o,s):new u(r,o,s),l=!1;t.$.eventing(this),a.on("videoDimensionsChanged",t.$.bind(function(e,t){this.trigger("videoDimensionsChanged",e,t)},this)),a.on("mediaStopped",t.$.bind(function(){this.trigger("mediaStopped")},this)),t.$.defineProperties(this,{domElement:{get:function(){return a.domElement()}},videoWidth:{get:function(){return a["video"+(this.isRotated()?"Height":"Width")]()}},videoHeight:{get:function(){return a["video"+(this.isRotated()?"Width":"Height")]()}},aspectRatio:{get:function(){return(this.videoWidth()+0)/this.videoHeight()}},isRotated:{get:function(){return a.isRotated()}},orientation:{get:function(){return a.orientation()},set:function(e){a.orientation(e)}},audioChannelType:{get:function(){return a.audioChannelType()},set:function(e){a.audioChannelType(e)}}}),this.imgData=function(){return a.imgData()},this.appendTo=function(e){return a.appendTo(e),this},this.bindToStream=function(e,r){return l=!1,n=e,a.bindToStream(e,t.$.bind(function(e){return e?void r(e):(l=!0,i&&(this.setAudioVolume(i),i=null),a.on("aspectRatioAvailable",t.$.bind(this.trigger,this,"aspectRatioAvailable")),void r(null))},this)),this},this.unbindStream=function(){return n?(n=null,a.unbindStream(),this):this},this.setAudioVolume=function(e){return l?a.setAudioVolume(t.$.roundFloat(e/100,2)):i=e,this},this.getAudioVolume=function(){return l?parseInt(100*a.getAudioVolume(),10):i||50},this.whenTimeIncrements=function(e,t){return a.whenTimeIncrements(e,t),this},this.onRatioAvailable=function(e){return a.onRatioAvailable(e),this},this.destroy=function(){return this.off(),void a.destroy()}};var c=function(e,n,i){var r,o,s=!1,l=[];t.$.eventing(this),h(this,function(){return r.domElement},i),this.domElement=function(){return r?r.domElement:void 0},this.videoWidth=function(){return r?r.videoWidth():void 0},this.videoHeight=function(){return r?r.videoHeight():void 0},this.imgData=function(){return r?r.getImgData():null},this.appendTo=function(e){return o=e,this},this.bindToStream=function(e,t){return o?(r=e._.render(),r.appendTo(o),r.show(function(e){if(!e){s=!0;for(var n;n=l.shift();)n()}t(e)}),this):void t("The VideoElement must attached to a DOM node before a stream can be bound")},this.unbindStream=function(){return r&&(r.destroy(),o=null,r=null),this},this.setAudioVolume=function(e){r&&r.volume(e)},this.getAudioVolume=function(){return r?r.volume():a},this.audioChannelType=function(){return"unknown"},this.whenTimeIncrements=function(e,n){t.$.callAsync(t.$.bind(e,n))},this.onRatioAvailable=function(e){s?e():l.push(e)},this.destroy=function(){return void this.unbindStream()}},u=function(e,s,l){var c,u=!1;t.$.eventing(this);var d=t.$.bind(function(e){var t="There was an unexpected problem with the Video Stream: "+i(e.target.error.code);s(t,this,"VideoElement")},this),p=function(){u||(t.warn("Video element paused, auto-resuming. If you intended to do this, use publishVideo(false) or subscribeToVideo(false) instead."),u=!0),c.play()};c=n(e.fallbackText,e.attributes);var f=!1,g=[];c.addEventListener("timeupdate",function m(){if(!c)return void event.target.removeEventListener("timeupdate",m);var e=c.videoWidth/c.videoHeight;if(!isNaN(e)){c.removeEventListener("timeupdate",m),f=!0;for(var t;t=g.shift();)t()}}),c.addEventListener("pause",p),A(this,c),h(this,function(){return c},l),this.domElement=function(){return c},this.videoWidth=function(){return c?c.videoWidth:0},this.videoHeight=function(){return c?c.videoHeight:0},this.imgData=function(){var e=t.$.createElement("canvas",{width:c.videoWidth,height:c.videoHeight,style:{display:"none"}});document.body.appendChild(e);try{e.getContext("2d").drawImage(c,0,0,e.width,e.height)}catch(n){return t.warn("Cannot get image data yet"),null}var i=e.toDataURL("image/png");return t.$.removeElement(e),t.$.trim(i.replace("data:image/png;base64,",""))},this.appendTo=function(e){return e.appendChild(c),this},this.bindToStream=function(e,t){var n=this;return r(c,e,function(i){return i?void t(i):(n.startObservingSize(),e.onended=function(){n.trigger("mediaStopped",this)},c&&c.addEventListener("error",d,!1),void t(null))}),this},this.unbindStream=function(){return c&&o(c),this.stopObservingSize(),this},this.setAudioVolume=function(e){c&&(c.volume=e)},this.getAudioVolume=function(){return c?c.volume:a},this.audioChannelType=function(e){return void 0!==e&&(c.mozAudioChannelType=e),"mozAudioChannelType"in c?c.mozAudioChannelType:"unknown"},this.whenTimeIncrements=function(e,n){if(c){var i,r;r=t.$.bind(function(){c&&(!i||i>=c.currentTime?i=c.currentTime:(c.removeEventListener("timeupdate",r,!1),e.call(n,this)))},this),c.addEventListener("timeupdate",r,!1)}},this.destroy=function(){return this.unbindStream(),void(c&&(c.removeEventListener("pause",p),t.$.removeElement(c),c=null))},this.onRatioAvailable=function(e){f?e():g.push(e)}},h=function(e,n,i,r){var o=r;t.$.defineProperties(e,{isRotated:{get:function(){return this.orientation()&&(270===this.orientation().videoOrientation||90===this.orientation().videoOrientation)}},orientation:{get:function(){return o},set:function(e){o=e;var r=s[e.videoOrientation]||s.ROTATED_NORMAL;switch(t.$.env.name){case"Chrome":case"Safari":n().style.webkitTransform=r;break;case"IE":if(t.$.env.version>=9)n().style.msTransform=r;else{var a=e.videoOrientation*l,c=n(),u=Math.cos(a),h=Math.sin(a);c.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+u+",M12="+-h+",M21="+h+",M22="+u+",SizingMethod='auto expand')"}break;default:n().style.transform=r}i(o)}},audioChannelType:{get:function(){return"mozAudioChannelType"in this.domElement?this.domElement.mozAudioChannelType:"unknown"},set:function(e){"mozAudioChannelType"in this.domElement&&(this.domElement.mozAudioChannelType=e)}}})},d={};e.MediaError&&(d[e.MediaError.MEDIA_ERR_ABORTED]="The fetching process for the media resource was aborted by the user agent at the user's request.",d[e.MediaError.MEDIA_ERR_NETWORK]="A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.",d[e.MediaError.MEDIA_ERR_DECODE]="An error of some description occurred while decoding the media resource, after the resource was established to be  usable.",d[e.MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED]="The media resource indicated by the src attribute was not suitable.")}(e),!function(){function e(e,n,i,o,s){var a=t.$(".OT_video-element",e);if(a.length>0){var l={left:"",top:""};if(OTPlugin.isInstalled())l.width="100%",l.height="100%";else{o=o||r,o=s?1/o:o;var c,u,h=n/i;s?(u=n,c=u*o,l.width=c+"px",l.height=u+"px",l.top=(c+i)/2+"px"):h>o?(c=n,u=c/o,l.width=c+"px",l.height=u+"px",l.top=(-u+i)/2+"px"):(u=i,c=u*o,l.width=c+"px",l.height=u+"px",l.left=(-c+n)/2+"px")}a.css(l)}}function n(e,n,i,o,s){var a=t.$(".OT_video-element",e);if(a.length>0){var l={left:"",top:""};if(OTPlugin.isInstalled()){o=o||r;var c,u,h=n/i;h>o?(u=i,c=i*o,l.width=c+"px",l.height=u+"px",l.left=(n-c)/2+"px"):(c=n,u=c/o,l.width=c+"px",l.height=u+"px",l.top=(i-u)/2+"px")}else s?(l.width=i+"px",l.height=n+"px",l.top=i+"px"):(l.width="100%",l.height="100%");a.css(l)}}function i(e,n,i){var r=parseInt(n,10),c=parseInt(i,10);a>r||l>c?t.$.addClass(e,"OT_micro"):t.$.removeClass(e,"OT_micro"),o>r||s>c?t.$.addClass(e,"OT_mini"):t.$.removeClass(e,"OT_mini")}var r=4/3,o=128,s=128,a=64,l=64,c=function(e,n){var i,r;if(e&&e.nodeName?(i=e,i.getAttribute("id")&&0!==i.getAttribute("id").length||i.setAttribute("id","OT_"+t.$.uuid()),r=i.getAttribute("id")):e&&(i=t.$("#"+e).get(0),i&&(r=e)),r||(r="OT_"+t.$.uuid().replace(/-/g,"_")),i)if(null!=n&&"replace"!==n){var o=document.createElement("div");o.id="OT_"+t.$.uuid(),"append"===n?(i.appendChild(o),i=o):"before"===n?(i.parentNode.insertBefore(o,i),i=o):"after"===n&&(i.parentNode.insertBefore(o,i.nextSibling),i=o)}else t.$.emptyElement(i);else i=t.$.createElement("div",{id:r}),i.style.backgroundColor="#000000",document.body.appendChild(i);return i};t.WidgetView=function(r,o){var s,a,l,u,h,d,p,f={},g=c(r,o&&o.insertMode),m=document.createElement("div"),v={},b=!0,y=!1,w="cover",_=e;t.$.eventing(f),o&&(d=o.width,p=o.height,d&&"number"==typeof d&&(d+="px"),p&&"number"==typeof p&&(p+="px"),g.style.width=d?d:"264px",g.style.height=p?p:"198px",g.style.overflow="hidden",i(g,d||"264px",p||"198px"),(void 0===o.mirror||o.mirror)&&t.$.addClass(g,"OT_mirrored"),"contain"===o.fitMode?(w="contain",_=n):"cover"!==o.fitMode&&t.warn('Invalid fit value "'+o.fitMode+'" passed. Only "contain" and "cover" can be used.')),o.classNames&&t.$.addClass(g,o.classNames),
t.$(g).addClass("OT_loading OT_fit-mode-"+w),t.$.addClass(m,"OT_widget-container"),m.style.width="100%",m.style.height="100%",g.appendChild(m),h=document.createElement("div"),t.$.addClass(h,"OT_video-loading"),m.appendChild(h),u=document.createElement("div"),t.$.addClass(u,"OT_video-poster"),m.appendChild(u),v.width=g.offsetWidth,v.height=g.offsetHeight,OTPlugin.isInstalled()||(s=t.$(g).observeSize(function(e){var t=e.width,n=e.height;i(g,t,n),a&&_(m,t,n,a.aspectRatio(),a.isRotated())})[0],l=t.$.observeNodeOrChildNodeRemoval(g,function(e){if(a){var n=t.$.some(e,function(e){return e===m||"VIDEO"===e.nodeName});n&&(a.destroy(),a=null),m&&(t.$.removeElement(m),m=null),s&&(s.disconnect(),s=null),l&&(l.disconnect(),l=null)}}));var x=function(){a&&_(m,g.offsetWidth,g.offsetHeight,a.aspectRatio(),a.isRotated())};return f.destroy=function(){s&&(s.disconnect(),s=null),l&&(l.disconnect(),l=null),a&&(a.destroy(),a=null),g&&(t.$.removeElement(g),g=null)},f.setBackgroundImageURI=function(e){"http:"!==e.substr(0,5)&&"https:"!==e.substr(0,6)&&"data:image/png;base64,"!==e.substr(0,22)&&(e="data:image/png;base64,"+e),t.$.css(u,"backgroundImage","url("+e+")"),t.$.css(u,"backgroundSize","contain"),t.$.css(u,"opacity","1.0")},o&&o.style&&o.style.backgroundImageURI&&f.setBackgroundImageURI(o.style.backgroundImageURI),f.bindVideo=function(e,n,i){a&&(a.destroy(),a=null);var r=n&&n.error?n.error:void 0;delete n.error;var o=new t.VideoElement({attributes:n},r);return n.audioVolume&&o.setAudioVolume(n.audioVolume),o.audioChannelType("telephony"),o.appendTo(m).bindToStream(e,function(e){return e?(o.destroy(),void i(e)):(a=o,o.domElement()&&t.$.css(o.domElement(),"height",""),o.on({orientationChanged:x,videoDimensionsChanged:function(e,t){x(),f.trigger("videoDimensionsChanged",e,t)},mediaStopped:function(){f.trigger("mediaStopped")}}),o.onRatioAvailable(x),void i(null,o))}),t.$.addClass(o.domElement(),"OT_video-element"),t.$.css(o.domElement(),"height","1px"),o},t.$.defineProperties(f,{video:{get:function(){return a}},showPoster:{get:function(){return!t.$.isDisplayNone(u)},set:function(e){e?t.$.show(u):t.$.hide(u)}},poster:{get:function(){return t.$.css(u,"backgroundImage")},set:function(e){t.$.css(u,"backgroundImage","url("+e+")")}},loading:{get:function(){return b},set:function(e){b=e,b?t.$.addClass(g,"OT_loading"):t.$.removeClass(g,"OT_loading")}},audioOnly:{get:function(){return y},set:function(e){y=e,y?t.$.addClass(g,"OT_audio-only"):t.$.removeClass(g,"OT_audio-only"),OTPlugin.isInstalled()&&setTimeout(x,0)}},domId:{get:function(){return g.getAttribute("id")}}}),f.domElement=g,f.addError=function(e,n,i){g.innerHTML="<p>"+e+(n?' <span class="ot-help-message">'+n+"</span>":"")+"</p>",t.$.addClass(g,i||"OT_subscriber_error"),g.querySelector("p").offsetHeight>g.offsetHeight&&(g.querySelector("span").style.display="none")},f}}(e),!t.properties)throw new Error("OT.properties does not exist, please ensure that you include a valid properties file.");t.useSSL=function(){return t.properties.supportSSL&&(e.location.protocol.indexOf("https")>=0||e.location.protocol.indexOf("chrome-extension")>=0)},t.properties=function(n){var i=t.$.clone(n);i.debug="true"===n.debug||n.debug===!0,i.supportSSL="true"===n.supportSSL||n.supportSSL===!0,e.OTProperties&&(e.OTProperties.cdnURL&&(i.cdnURL=e.OTProperties.cdnURL),e.OTProperties.cdnURLSSL&&(i.cdnURLSSL=e.OTProperties.cdnURLSSL),e.OTProperties.configURL&&(i.configURL=e.OTProperties.configURL),e.OTProperties.assetURL&&(i.assetURL=e.OTProperties.assetURL),e.OTProperties.cssURL&&(i.cssURL=e.OTProperties.cssURL)),i.assetURL||(i.assetURL=t.useSSL()?i.cdnURLSSL+"/webrtc/"+i.version:i.cdnURL+"/webrtc/"+i.version);var r="IE"===t.$.env.name&&t.$.env.version<=9;return r&&e.location.protocol.indexOf("https")<0||(i.apiURL=i.apiURLSSL,i.loggingURL=i.loggingURLSSL),i.configURL||(i.configURL=i.assetURL+"/js/dynamic_config.min.js"),i.cssURL||(i.cssURL=i.assetURL+"/css/TB.min.css"),i}(t.properties),!function(){var e,n,i=function(e){return!(t.$.isFunction(e.get)&&t.$.isFunction(e.set))},r=function(t){return n?void t(null,n):void e.get(t)};t.overrideGuidStorage=function(r){if(i(r))throw new Error("The storageInterface argument does not seem to be valid, it must implement get and set methods");e!==r&&(e=r,n&&e.set(n,function(e){e&&t.error("Failed to send initial Guid value ("+n+") to the newly assigned Guid Storage. The error was: "+e)}))},t._||(t._={}),t._.getClientGuid=function(i){r(function(r,o){return r?void i(r):(o?n||(n=o):(o=t.$.uuid(),e.set(o,function(e){return e?void i(e):void(n=o)})),void i(null,n))})},t.overrideGuidStorage({get:function(e){e(null,t.$.getCookie("opentok_client_id"))},set:function(e,n){t.$.setCookie("opentok_client_id",e),n(null)}})}(e),!function(){var e,n,i,r,o,s;e=function(){return navigator.getUserMedia?t.$.bind(navigator.getUserMedia,navigator):navigator.mozGetUserMedia?t.$.bind(navigator.mozGetUserMedia,navigator):navigator.webkitGetUserMedia?t.$.bind(navigator.webkitGetUserMedia,navigator):OTPlugin.isInstalled()?t.$.bind(OTPlugin.getUserMedia,OTPlugin):void 0}(),n={PERMISSION_DENIED:"PermissionDeniedError",NOT_SUPPORTED_ERROR:"NotSupportedError",MANDATORY_UNSATISFIED_ERROR:" ConstraintNotSatisfiedError",NO_DEVICES_FOUND:"NoDevicesFoundError",HARDWARE_UNAVAILABLE:"HardwareUnavailableError",TrackStartError:"HardwareUnavailableError"},i={PermissionDeniedError:"End-user denied permission to hardware devices",PermissionDismissedError:"End-user dismissed permission to hardware devices",NotSupportedError:"A constraint specified is not supported by the browser.",ConstraintNotSatisfiedError:"It's not possible to satisfy one or more constraints passed into the getUserMedia function",OverconstrainedError:"Due to changes in the environment, one or more mandatory constraints can no longer be satisfied.",NoDevicesFoundError:"No voice or video input devices are available on this machine.",HardwareUnavailableError:"The selected voice or video devices are unavailable. Verify that the chosen devices are not in use by another application."},r=function(e,t){var n,r;return n=t.hasOwnProperty(e)?t[e]:e,r=i.hasOwnProperty(n)?i[n]:"Unknown Error while getting user media",{name:n,message:r}},o=function(e){var i;return t.$.isObject(e)&&e.name?(i=r(e.name,n),i.constraintName=e.constraintName):i="string"==typeof e?r(e,n):{message:"Unknown Error type while getting media"},i},s=function(e){if(!e||!t.$.isObject(e))return!0;for(var n in e)if(e.hasOwnProperty(n)&&e[n])return!1;return!0},t.$.getUserMedia=function(n,i,r,a,l,c,u){var h=e;if(t.$.isFunction(u)&&(h=u),s(n))return t.error("Couldn't get UserMedia: All constraints were false"),void r.call(null,{name:"NO_VALID_CONSTRAINTS",message:"Video and Audio was disabled, you need to enabled at least one"});var d=null,p=!1,f=function(){d&&clearTimeout(d),p&&l&&l()},g=function(){d=null,p=!0,a&&a()},m=function(e){f(),i.call(null,e)},v=function(e){f();var t=o(e);"PermissionDeniedError"===t.name||"PermissionDismissedError"===t.name?c.call(null,t):r.call(null,t)};try{h(n,m,v)}catch(b){return t.error("Couldn't get UserMedia: "+b.toString()),void v()}d=-1===location.protocol.indexOf("https")?setTimeout(g,100):setTimeout(g,500)}}(),!function(){var e=function(e){return function(t,n){n.querySelector("html").style.height=n.body.style.height="100%",e(t,n)}},n=function(e,n,i){var r=e.head||e.getElementsByTagName("head")[0],o=t.$.createElement("link",{type:"text/css",media:"screen",rel:"stylesheet",href:n});r.appendChild(o),t.$.on(o,"error",function(e){t.error("Could not load CSS for dialog",n,e&&e.message||e)}),t.$.on(o,"load",i)},i=function(e,i,r){var o=["//fonts.googleapis.com/css?family=Didact+Gothic",t.properties.cssURL].concat(i),s=o.length;t.$.forEach(o,function(t){n(e,t,function(){--s<=0&&r()})})},r=function(e,n,i){var r=t.$.createElement(i||"div",{"class":e},n,this);return r.on=t.$.bind(t.$.on,t.$,r),r.off=t.$.bind(t.$.off,t.$,r),r},o=function(e,n,i){var o=r.call(this,"",null,"input");return o=t.$(o).on("change",i),"IE"===t.$.env.name&&t.$.env.version<=8&&o.on("click",function(){o.first.blur(),o.first.focus()}),o.attr({name:n,id:n,type:"checkbox"}),o.first},s=function(e,t,n){var i=r.call(this,n||"",e,"a");return i.setAttribute("href",t),i};t.Dialogs={},t.Dialogs.Plugin={},t.Dialogs.Plugin.promptToInstall=function(){var n=new t.$.Modal(e(function(e,a){function l(){n.trigger("download"),setTimeout(function(){m.querySelector(".OT_dialog-messages-main").innerHTML="Plugin installation successful";var e=m.querySelectorAll(".OT_dialog-section");t.$.addClass(e[0],"OT_dialog-hidden"),t.$.removeClass(e[1],"OT_dialog-hidden")},3e3)}function c(){n.trigger("refresh")}function u(){f.checked?h():d()}function h(){y.enable(),y.on("click",l),_.enable(),_.on("click",c)}function d(){y.disable(),y.off("click",l),_.disable(),_.off("click",c)}var p,f,g,m,v=t.$.bind(r,a),b=function(e,n){var i="OT_dialog-button "+(n?"OT_dialog-button-"+n:"OT_dialog-button-large"),r=v(i,e);return r.enable=function(){return t.$.removeClass(this,"OT_dialog-button-disabled"),this},r.disable=function(){return t.$.addClass(this,"OT_dialog-button-disabled"),this},r},y=b("Download plugin"),w=b("cancel","small"),_=b("Refresh browser");t.$.addClass(w,"OT_dialog-no-natural-margin OT_dialog-button-block"),t.$.addClass(_,"OT_dialog-no-natural-margin"),y.disable(),_.disable(),w.on("click",function(){n.trigger("cancelButtonClicked"),n.close()}),g=v("OT_closeButton","&times;").on("click",function(){n.trigger("closeButtonClicked"),n.close()}).first;var x=e.location.protocol.indexOf("https")>=0?"https":"http";p=s.call(a,"end-user license agreement",x+"://tokbox.com/support/ie-eula"),f=o.call(a,null,"acceptEULA",u),m=v("OT_dialog-centering",[v("OT_dialog-centering-child",[v("OT_root OT_dialog OT_dialog-plugin-prompt",[g,v("OT_dialog-messages",[v("OT_dialog-messages-main","This app requires real-time communication")]),v("OT_dialog-section",[v("OT_dialog-single-button-with-title",[v("OT_dialog-button-title",[f,function(){var e=v("","accept","label");return e.setAttribute("for",f.id),e.style.margin="0 5px",e}(),p]),v("OT_dialog-actions-card",[y,w])])]),v("OT_dialog-section OT_dialog-hidden",[v("OT_dialog-button-title",["You can now enjoy webRTC enabled video via Internet Explorer."]),_])])])]),i(a,[],function(){a.body.appendChild(m)})}));return n},t.Dialogs.Plugin.promptToReinstall=function(){var n=new t.$.Modal(e(function(e,o){var s,a,l,c=t.$.bind(r,o);s=c("OT_closeButton","&times;").on("click",function(){n.trigger("closeButtonClicked"),n.close()}).first,a=c("OT_dialog-button OT_dialog-button-large OT_dialog-no-natural-margin","Okay").on("click",function(){n.trigger("okay")}).first,l=c("OT_dialog-centering",[c("OT_dialog-centering-child",[c("OT_ROOT OT_dialog OT_dialog-plugin-reinstall",[s,c("OT_dialog-messages",[c("OT_dialog-messages-main","Reinstall Opentok Plugin"),c("OT_dialog-messages-minor","Uh oh! Try reinstalling the OpenTok plugin again to enable real-time video communication for Internet Explorer.")]),c("OT_dialog-section",[c("OT_dialog-single-button",a)])])])]),i(o,[],function(){o.body.appendChild(l)})}));return n},t.Dialogs.Plugin.updateInProgress=function(){var n,o,s=0,a=new t.$.Modal(e(function(e,l){var c,u=t.$.bind(r,l);o=u("OT_dialog-plugin-upgrade-percentage","0%","strong"),n=u("OT_dialog-progress-bar-fill"),c=u("OT_dialog-centering",[u("OT_dialog-centering-child",[u("OT_ROOT OT_dialog OT_dialog-plugin-upgrading",[u("OT_dialog-messages",[u("OT_dialog-messages-main",["One moment please... ",o]),u("OT_dialog-progress-bar",n),u("OT_dialog-messages-minor OT_dialog-no-natural-margin","Please wait while the OpenTok plugin is updated")])])])]),i(l,[],function(){l.body.appendChild(c),null!=s&&a.setUpdateProgress(s)})}));return a.setUpdateProgress=function(e){n&&o?e>99?(t.$.css(n,"width",""),o.innerHTML="100%"):1>e?(t.$.css(n,"width","0%"),o.innerHTML="0%"):(t.$.css(n,"width",e+"%"),o.innerHTML=e+"%"):s=e},a},t.Dialogs.Plugin.updateComplete=function(n){var o=new t.$.Modal(e(function(e,s){var a,l,c=t.$.bind(r,s);a=c("OT_dialog-button OT_dialog-button-large OT_dialog-no-natural-margin","Reload").on("click",function(){o.trigger("reload")}).first;var u;u=n?["Update Failed.",n+""||"NO ERROR"]:["Update Complete.","The OpenTok plugin has been succesfully updated. Please reload your browser."],l=c("OT_dialog-centering",[c("OT_dialog-centering-child",[c("OT_root OT_dialog OT_dialog-plugin-upgraded",[c("OT_dialog-messages",[c("OT_dialog-messages-main",u[0]),c("OT_dialog-messages-minor",u[1])]),c("OT_dialog-single-button",a)])])]),i(s,[],function(){s.body.appendChild(l)})}));return o}}(),!function(e){var n={audio:"audioInput",video:"videoInput"};t.$.shouldAskForDevices=function(n){var i=e.MediaStreamTrack;null!=i&&t.$.isFunction(i.getSources)?e.MediaStreamTrack.getSources(function(e){var t=e.some(function(e){return"audio"===e.kind}),i=e.some(function(e){return"video"===e.kind});n.call(null,{video:i,audio:t})}):(t.$.shouldAskForDevices=function(e){setTimeout(t.$.bind(e,null,{video:!0,audio:!0}))},t.$.shouldAskForDevices(n))},t.$.getMediaDevices=function(i){t.$.hasCapabilities("getMediaDevices")?e.MediaStreamTrack.getSources(function(e){var r=t.$.filter(e,function(e){return null!=n[e.kind]});i(void 0,t.$.map(r,function(e){return{deviceId:e.id,label:e.label,kind:n[e.kind]}}))}):i(new Error("This browser does not support getMediaDevices APIs"))}}(e);var O=function(e){var t=document.createElement("link");t.type="text/css",t.media="screen",t.rel="stylesheet",t.href=e;var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(t)};t.Config=function(){var e,n,i,r=!1,o={},s={},a=document.head||document.getElementsByTagName("head")[0],l=function(){n&&(clearTimeout(n),n=null)},c=function(){l(),e&&(e.onload=e.onreadystatechange=null,a&&e.parentNode&&a.removeChild(e),e=void 0)},u=function(){(!e.readyState||/loaded|complete/.test(e.readyState))&&(l(),r||i._onLoadTimeout())},h=function(){c(),t.warn("TB DynamicConfig failed to load due to an error"),this.trigger("dynamicConfigLoadFailed")},d=function(e,t){return t&&s[t]&&s[t][e]?s[t][e]:o[e]};return i={loadTimeout:4e3,_onLoadTimeout:function(){c(),t.warn("TB DynamicConfig failed to load in "+i.loadTimeout+" ms"),this.trigger("dynamicConfigLoadFailed")},load:function(o){if(!o)throw new Error("You must pass a valid configUrl to Config.load");r=!1,setTimeout(function(){e=document.createElement("script"),e.async="async",e.src=o,e.onload=e.onreadystatechange=t.$.bind(u,i),e.onerror=t.$.bind(h,i),a.appendChild(e)},1),n=setTimeout(function(){i._onLoadTimeout()},this.loadTimeout)},isLoaded:function(){return r},reset:function(){this.off(),c(),r=!1,o={},s={}},replaceWith:function(e){c(),e||(e={}),o=e.global||{},s=e.partners||{},r||(r=!0),this.trigger("dynamicConfigChanged")},get:function(e,t,n){var i=d(e,n);return i?i[t]:null}},t.$.eventing(i),i}(),t.$.registerCapability("getUserMedia",function(){return"Node"===t.$.env?!1:!!(navigator.webkitGetUserMedia||navigator.mozGetUserMedia||OTPlugin.isInstalled())}),t.$.registerCapability("PeerConnection",function(){return"Node"===t.$.env?!1:"function"==typeof e.webkitRTCPeerConnection&&e.webkitRTCPeerConnection.prototype.addStream?!0:"function"==typeof e.mozRTCPeerConnection&&t.$.env.version>20?!0:OTPlugin.isInstalled()}),t.$.registerCapability("webrtc",function(){if(t.properties){var e=t.properties.minimumVersion||{},n=e[t.$.env.name.toLowerCase()];if(n&&t.$.env.versionGreaterThan(n))return t.debug("Support for",t.$.env.name,"is disabled because we require",n,"but this is",t.$.env.version),!1}return"Node"===t.$.env?!0:t.$.hasCapabilities("getUserMedia","PeerConnection")}),t.$.registerCapability("bundle",function(){return t.$.hasCapabilities("webrtc")&&("Chrome"===t.$.env.name||"Node"===t.$.env.name||OTPlugin.isInstalled())}),t.$.registerCapability("RTCPMux",function(){return t.$.hasCapabilities("webrtc")&&("Chrome"===t.$.env.name||"Node"===t.$.env.name||OTPlugin.isInstalled())}),t.$.registerCapability("getMediaDevices",function(){return t.$.isFunction(e.MediaStreamTrack)&&t.$.isFunction(e.MediaStreamTrack.getSources)}),t.$.registerCapability("audioOutputLevelStat",function(){return"Chrome"===t.$.env.name||"IE"===t.$.env.name}),t.$.registerCapability("webAudioCapableRemoteStream",function(){return"Firefox"===t.$.env.name}),t.$.registerCapability("webAudio",function(){return"AudioContext"in e}),t.Analytics=function(n){var i="1",r=new t.$.Analytics(n,t.debug,t._.getClientGuid);this.logError=function(n,o,s,a,l){l||(l={});var c=l.partnerId;t.Config.get("exceptionLogging","enabled",c)===!0&&t._.getClientGuid(function(u,h){if(!u){var d=t.$.extend({clientVersion:"js-"+t.properties.version.replace("v",""),guid:h,partnerId:c,source:e.location.href,logVersion:i,clientSystemTime:(new Date).getTime()},l);r.logError(n,o,s,a,d)}})},this.logEvent=function(n,o){var s=n.partnerId;n||(n={}),t._.getClientGuid(function(a,l){if(!a){var c=t.$.extend({clientVersion:"js-"+t.properties.version.replace("v",""),guid:l,partnerId:s,source:e.location.href,logVersion:i,clientSystemTime:(new Date).getTime()},n);r.logEvent(c,!1,o)}})},this.logQOS=function(n){var o=n.partnerId;n||(n={}),t._.getClientGuid(function(s,a){if(!s){var l=t.$.extend({clientVersion:"js-"+t.properties.version.replace("v",""),guid:a,partnerId:o,source:e.location.href,logVersion:i,clientSystemTime:(new Date).getTime(),duration:0},n);r.logQOS(l)}})}},t.ConnectivityAttemptPinger=function(e){var n,i,r,o="Initial",s=["Initial","Attempt","Success","Failure"],a=5e3,l=6,c=function(i){o=i;var r=!1;switch(o){case"Attempt":"Initial"!==n&&(r=!0),h();break;case"Success":"Attempt"!==n&&(r=!0),d();break;case"Failure":"Attempt"!==n&&(r=!0),d()}if(r){var s=e?t.$.clone(e):{};s.action="Internal Error",s.variation="Non-fatal",s.payload={debug:"Invalid sequence: "+e.action+" "+n+" -> "+o},t.analytics.logEvent(s)}},u=t.$.statable(this,s,"Failure",c),h=function(){r=0,i=setInterval(function(){if(l>r){var n=t.$.extend(e,{variation:"Attempting"});t.analytics.logEvent(n)}else d();r++},a)},d=function(){clearInterval(i)};this.setVariation=function(e){n=o,u(e)},this.stop=function(){d()}},t.StylableComponent=function(e,n,i,r){if(!e.trigger)throw new Error("OT.StylableComponent is dependent on the mixin OT.$.eventing. Ensure that this is included in the object before StylableComponent.");var o=!1,s=function(t,n,i){i?e.trigger("styleValueChanged",t,n,i):e.trigger("styleValueChanged",t,n)};i===!1&&(n={buttonDisplayMode:"off",nameDisplayMode:"off",audioLevelDisplayMode:"off"},o=!0,r({showControls:!1}));var a=new I(n,s);e.getStyle=function(e){return a.get(e)},e.setStyle=o?function(){return t.warn("Calling setStyle() has no effect because theshowControls option was set to false"),this}:function(e,t,n){var i={};return"string"!=typeof e?(a.setAll(e,n),i=e):(a.set(e,t),i[e]=t),r&&r(i),this}};var I=function(e,n){var i,r,o,s,a={};i=["showMicButton","showSpeakerButton","nameDisplayMode","buttonDisplayMode","backgroundImageURI","audioLevelDisplayMode"],r={buttonDisplayMode:["auto","mini","mini-auto","off","on"],nameDisplayMode:["auto","off","on"],audioLevelDisplayMode:["auto","off","on"],showSettingsButton:[!0,!1],showMicButton:[!0,!1],backgroundImageURI:null,showControlBar:[!0,!1],showArchiveStatus:[!0,!1],videoDisabledDisplayMode:["auto","off","on"]},o=function(e,n){return"backgroundImageURI"===e||r.hasOwnProperty(e)&&-1!==t.$.arrayIndexOf(r[e],n)},s=function(e){switch(e){case"true":return!0;case"false":return!1;default:return e}},this.getAll=function(){var e=t.$.clone(a);for(var n in e)e.hasOwnProperty(n)&&t.$.arrayIndexOf(i,n)<0&&delete e[n];return e},this.get=function(e){return e?a[e]:this.getAll()},this.setAll=function(e,i){var r,l;for(var c in e)e.hasOwnProperty(c)&&(l=s(e[c]),o(c,l)?(r=a[c],l!==r&&(a[c]=l,i||n(c,l,r))):t.warn("Style.setAll::Invalid style property passed "+c+" : "+l));return this},this.set=function(e,i){t.debug("setStyle: "+e.toString());var r,l=s(i);return o(e,l)?(r=a[e],l!==r&&(a[e]=l,n(e,i,r)),this):(t.warn("Style.set::Invalid style property passed "+e+" : "+l),this)},e&&this.setAll(e,!0)};t.generateSimpleStateMachine=function(e,n,i){var r=n.slice(),o=t.$.clone(i),s=function(e){return-1!==t.$.arrayIndexOf(r,e)},a=function(e,n){return o[e]&&-1!==t.$.arrayIndexOf(o[e],n)};return function(t){function n(e,n){t({message:e,newState:n,currentState:r,previousState:o})}function i(e){return s(e)?a(r,e)?!0:(n("'"+r+"' cannot transition to '"+e+"'",e),!1):(n("'"+e+"' is not a valid state",e),!1)}var r=e,o=null;this.current=r,this.set=function(e){i(e)&&(o=r,this.current=r=e)}}},!function(){var e,n,i="NotSubscribing";e=["NotSubscribing","Init","ConnectingToPeer","BindingRemoteStream","Subscribing","Failed","Destroyed"],n={NotSubscribing:["NotSubscribing","Init","Destroyed"],Init:["NotSubscribing","ConnectingToPeer","BindingRemoteStream","Destroyed"],ConnectingToPeer:["NotSubscribing","BindingRemoteStream","Failed","Destroyed"],BindingRemoteStream:["NotSubscribing","Subscribing","Failed","Destroyed"],Subscribing:["NotSubscribing","Failed","Destroyed"],Failed:["Destroyed"],Destroyed:[]},t.SubscribingState=t.generateSimpleStateMachine(i,e,n),t.SubscribingState.prototype.isDestroyed=function(){return"Destroyed"===this.current},t.SubscribingState.prototype.isFailed=function(){return"Failed"===this.current},t.SubscribingState.prototype.isSubscribing=function(){return"Subscribing"===this.current},t.SubscribingState.prototype.isAttemptingToSubscribe=function(){return-1!==t.$.arrayIndexOf(["Init","ConnectingToPeer","BindingRemoteStream"],this.current)}}(e),!function(){var e=["NotPublishing","GetUserMedia","BindingMedia","MediaBound","PublishingToSession","Publishing","Failed","Destroyed"],n={NotPublishing:["NotPublishing","GetUserMedia","Destroyed"],GetUserMedia:["BindingMedia","Failed","NotPublishing","Destroyed"],BindingMedia:["MediaBound","Failed","NotPublishing","Destroyed"],MediaBound:["NotPublishing","PublishingToSession","Failed","Destroyed"],PublishingToSession:["NotPublishing","Publishing","Failed","Destroyed"],Publishing:["NotPublishing","MediaBound","Failed","Destroyed"],Failed:["Destroyed"],Destroyed:[]},i="NotPublishing";t.PublishingState=t.generateSimpleStateMachine(i,e,n),t.PublishingState.prototype.isDestroyed=function(){return"Destroyed"===this.current},t.PublishingState.prototype.isAttemptingToPublish=function(){return-1!==t.$.arrayIndexOf(["GetUserMedia","BindingMedia","MediaBound","PublishingToSession"],this.current)},t.PublishingState.prototype.isPublishing=function(){return"Publishing"===this.current}}(e),!function(){t.Microphone=function(e,n){var i;t.$.defineProperties(this,{muted:{get:function(){return i},set:function(t){if(i!==t){i=t;for(var n=e.getAudioTracks(),r=0,o=n.length;o>r;++r)n[r].setEnabled(!i)}}}}),this.muted(void 0!==n?n===!0:e.getAudioTracks().length?!e.getAudioTracks()[0].enabled:!1)}}(e),t.IntervalRunner=function(t,n){var i=t,r=n,o=null;this.start=function(){o=e.setInterval(i,1e3/r)},this.stop=function(){e.clearInterval(o),o=null}},!function(){t.Event=t.$.Event(),t.Event.names={ACTIVE:"active",INACTIVE:"inactive",UNKNOWN:"unknown",PER_SESSION:"perSession",PER_STREAM:"perStream",EXCEPTION:"exception",ISSUE_REPORTED:"issueReported",SESSION_CONNECTED:"sessionConnected",SESSION_DISCONNECTED:"sessionDisconnected",STREAM_CREATED:"streamCreated",STREAM_DESTROYED:"streamDestroyed",CONNECTION_CREATED:"connectionCreated",CONNECTION_DESTROYED:"connectionDestroyed",SIGNAL:"signal",STREAM_PROPERTY_CHANGED:"streamPropertyChanged",MICROPHONE_LEVEL_CHANGED:"microphoneLevelChanged",RESIZE:"resize",SETTINGS_BUTTON_CLICK:"settingsButtonClick",DEVICE_INACTIVE:"deviceInactive",INVALID_DEVICE_NAME:"invalidDeviceName",ACCESS_ALLOWED:"accessAllowed",ACCESS_DENIED:"accessDenied",ACCESS_DIALOG_OPENED:"accessDialogOpened",ACCESS_DIALOG_CLOSED:"accessDialogClosed",ECHO_CANCELLATION_MODE_CHANGED:"echoCancellationModeChanged",MEDIA_STOPPED:"mediaStopped",PUBLISHER_DESTROYED:"destroyed",SUBSCRIBER_DESTROYED:"destroyed",DEVICES_DETECTED:"devicesDetected",DEVICES_SELECTED:"devicesSelected",CLOSE_BUTTON_CLICK:"closeButtonClick",MICLEVEL:"microphoneActivityLevel",MICGAINCHANGED:"microphoneGainChanged",ENV_LOADED:"envLoaded",ENV_UNLOADED:"envUnloaded",AUDIO_LEVEL_UPDATED:"audioLevelUpdated"},t.ExceptionCodes={JS_EXCEPTION:2e3,AUTHENTICATION_ERROR:1004,INVALID_SESSION_ID:1005,CONNECT_FAILED:1006,CONNECT_REJECTED:1007,CONNECTION_TIMEOUT:1008,NOT_CONNECTED:1010,P2P_CONNECTION_FAILED:1013,API_RESPONSE_FAILURE:1014,TERMS_OF_SERVICE_FAILURE:1026,UNABLE_TO_PUBLISH:1500,UNABLE_TO_SUBSCRIBE:1501,UNABLE_TO_FORCE_DISCONNECT:1520,UNABLE_TO_FORCE_UNPUBLISH:1530,PUBLISHER_ICE_WORKFLOW_FAILED:1553,SUBSCRIBER_ICE_WORKFLOW_FAILED:1554,UNEXPECTED_SERVER_RESPONSE:2001},t.ExceptionEvent=function(e,n,i,r,o,s){t.Event.call(this,e),this.message=n,this.title=i,this.code=r,this.component=o,this.target=s},t.IssueReportedEvent=function(e,n){t.Event.call(this,e),this.issueId=n},t.EnvLoadedEvent=function(e){t.Event.call(this,e)};var e=!1;t.ConnectionEvent=function(n,i,r){t.Event.call(this,n,!1),t.$.canDefineProperty?Object.defineProperty(this,"connections",{get:function(){return e||(t.warn("OT.ConnectionEvent connections property is deprecated, use connection instead."),e=!0),[i]}}):this.connections=[i],this.connection=i,this.reason=r};var n=!1;t.StreamEvent=function(e,i,r,o){t.Event.call(this,e,o),t.$.canDefineProperty?Object.defineProperty(this,"streams",{get:function(){return n||(t.warn("OT.StreamEvent streams property is deprecated, use stream instead."),n=!0),[i]}}):this.streams=[i],this.stream=i,this.reason=r};var i=!1,r=!1,o=!1;t.SessionConnectEvent=function(e){t.Event.call(this,e,!1),t.$.canDefineProperty?Object.defineProperties(this,{connections:{get:function(){return i||(t.warn("OT.SessionConnectedEvent no longer includes connections. Listen for connectionCreated events instead."),i=!0),[]}},streams:{get:function(){return r||(t.warn("OT.SessionConnectedEvent no longer includes streams. Listen for streamCreated events instead."),i=!0),[]}},archives:{get:function(){return o||(t.warn("OT.SessionConnectedEvent no longer includes archives. Listen for archiveStarted events instead."),o=!0),[]}}}):(this.connections=[],this.streams=[],this.archives=[])},t.SessionDisconnectEvent=function(e,n,i){t.Event.call(this,e,i),this.reason=n},t.StreamPropertyChangedEvent=function(e,n,i,r,o){t.Event.call(this,e,!1),this.type=e,this.stream=n,this.changedProperty=i,this.oldValue=r,this.newValue=o},t.VideoDimensionsChangedEvent=function(e,n,i){t.Event.call(this,"videoDimensionsChanged",!1),this.type="videoDimensionsChanged",this.target=e,this.oldValue=n,this.newValue=i},t.ArchiveEvent=function(e,n){t.Event.call(this,e,!1),this.type=e,this.id=n.id,this.name=n.name,this.status=n.status,this.archive=n},t.ArchiveUpdatedEvent=function(e,n,i,r){t.Event.call(this,"updated",!1),this.target=e,this.changedProperty=n,this.oldValue=i,this.newValue=r},t.SignalEvent=function(e,n,i){t.Event.call(this,e?"signal:"+e:t.Event.names.SIGNAL,!1),this.data=n,this.from=i},t.StreamUpdatedEvent=function(e,n,i,r){t.Event.call(this,"updated",!1),this.target=e,this.changedProperty=n,this.oldValue=i,this.newValue=r},t.DestroyedEvent=function(e,n,i){t.Event.call(this,e,!1),this.target=n,this.reason=i},t.VideoEnabledChangedEvent=function(e,n){t.Event.call(this,e,!1),this.reason=n.reason},t.VideoDisableWarningEvent=function(e){t.Event.call(this,e,!1)},t.AudioLevelUpdatedEvent=function(e){t.Event.call(this,t.Event.names.AUDIO_LEVEL_UPDATED,!1),this.audioLevel=e},t.MediaStoppedEvent=function(e){t.Event.call(this,t.Event.names.MEDIA_STOPPED,!0),this.target=e}}(e);var M={},P={};t.registerScreenSharingExtensionHelper=function(e,n){P[e]=n,n.autoRegisters&&n.isSupportedInThisBrowser&&t.registerScreenSharingExtension(e)},t.registerScreenSharingExtension=function(e){var t=Array.prototype.slice.call(arguments,1);if(null==P[e])throw new Error("Unsupported kind passed to OT.registerScreenSharingExtension");var n=P[e].register.apply(P[e],t);M[e]=n};var R=function(){var e=t.$.find(t.$.keys(P),function(e){return P[e].isSupportedInThisBrowser});return void 0===e?{}:{name:e,proto:P[e],instance:M[e]}};t.pickScreenSharingHelper=function(){return R()},t.checkScreenSharingCapability=function(e){var t={supported:!1,extensionRequired:void 0,extensionRegistered:void 0,extensionInstalled:void 0,supportedSources:{}},n=R();return void 0===n.name?void setTimeout(e.bind(null,t)):(t.supported=!0,t.extensionRequired=n.proto.extensionRequired?n.name:void 0,t.supportedSources={screen:n.proto.sources.screen,application:n.proto.sources.application,window:n.proto.sources.window,browser:n.proto.sources.browser},n.instance?(t.extensionRegistered=t.extensionRequired?!0:void 0,void n.instance.isInstalled(function(n){t.extensionInstalled=t.extensionRequired?n:void 0,e(t)})):(t.extensionRegistered=!1,t.extensionRequired&&(t.extensionInstalled=!1),void setTimeout(e.bind(null,t))))},t.registerScreenSharingExtensionHelper("firefox",{isSupportedInThisBrowser:"Firefox"===t.$.env.name,autoRegisters:!0,extensionRequired:!1,getConstraintsShowsPermissionUI:!1,sources:{screen:!0,application:"Firefox"===t.$.env.name&&t.$.env.version>=34,window:"Firefox"===t.$.env.name&&t.$.env.version>=34,browser:"Firefox"===t.$.env.name&&t.$.env.version>=38},register:function(){return{isInstalled:function(e){e(!0)},getConstraints:function(e,t,n){t.video={mediaSource:e},t.browserWindow&&(t.video.browserWindow=t.browserWindow,delete t.browserWindow),"undefined"!=typeof t.scrollWithPage&&(t.video.scrollWithPage=t.scrollWithPage,delete t.scrollWithPage),n(void 0,t)}}}}),t.registerScreenSharingExtensionHelper("chrome",{isSupportedInThisBrowser:!!navigator.webkitGetUserMedia&&"undefined"!=typeof chrome,autoRegisters:!1,extensionRequired:!0,getConstraintsShowsPermissionUI:!0,sources:{screen:!0,application:!1,window:!1,browser:!1},register:function(n){if(!n)throw new Error("initChromeScreenSharingExtensionHelper: extensionID is required.");var i=!!navigator.webkitGetUserMedia&&"undefined"!=typeof chrome,r={},o=void 0,s="com.tokbox.screenSharing."+n,a=function(e,t){var n={payload:t,from:"jsapi"};return n[s]=e,n},l=function(e,n){var i,o=t.$.uuid();return r[o]=function(){clearTimeout(i),i=null,e.apply(null,arguments)},n&&(i=setTimeout(function(){delete r[o],e(new Error("Timeout waiting for response to request."))},n)),o},c=function(t){if(!t)throw new Error("isAvailable: callback is required.");if(i||setTimeout(t.bind(null,!1)),void 0!==o)setTimeout(t.bind(null,o));else{var n=l(function(e,n){o!==!0&&(o="extensionLoaded"===n),t(o)},2e3),r=a("isExtensionInstalled",{requestId:n});e.postMessage(r,"*")}},u=function(t,n,i){if(!i)throw new Error("getSourceId: callback is required");c(function(r){if(r){var o=l(function(e,t,r){"permissionDenied"===t?i(new Error("PermissionDeniedError")):(n.video||(n.video={}),n.video.mandatory||(n.video.mandatory={}),n.video.mandatory.chromeMediaSource="desktop",n.video.mandatory.chromeMediaSourceId=r.sourceId,i(void 0,n))});e.postMessage(a("getSourceId",{requestId:o,source:t}),"*")}else i(new Error("Extension is not installed"))})};return e.addEventListener("message",function(t){if(t.origin===e.location.origin&&null!=t.data&&"object"==typeof t.data&&"extension"===t.data.from){var n=t.data[s],i=t.data.payload;if(i&&i.requestId){var a=r[i.requestId];delete r[i.requestId],a&&a(null,n,i)}"extensionLoaded"===n&&(o=!0)}}),{isInstalled:c,getConstraints:u}}}),t.StreamChannel=function(e){this.id=e.id,this.type=e.type,this.active=t.$.castToBoolean(e.active),this.orientation=e.orientation||t.VideoOrientation.ROTATED_NORMAL,e.frameRate&&(this.frameRate=parseFloat(e.frameRate,10)),this.width=parseInt(e.width,10),this.height=parseInt(e.height,10),this.source=e.source||"camera",this.fitMode=e.fitMode||"cover",t.$.eventing(this,!0),this.update=function(e){var n={},i={};for(var r in e)if(e.hasOwnProperty(r)){var o=this[r];switch(r){case"active":this.active=t.$.castToBoolean(e[r]);break;case"disableWarning":this.disableWarning=t.$.castToBoolean(e[r]);break;case"frameRate":this.frameRate=parseFloat(e[r],10);
break;case"width":case"height":this[r]=parseInt(e[r],10),n[r]=this[r],i[r]=o;break;case"orientation":this[r]=e[r],n[r]=this[r],i[r]=o;break;case"fitMode":this[r]=e[r];break;case"source":this[r]=e[r];break;default:return void t.warn("Tried to update unknown key "+r+" on "+this.type+" channel "+this.id)}this.trigger("update",this,r,o,this[r])}return t.$.keys(n).length&&this.trigger("update",this,"videoDimensions",i,n),!0}},!function(){var e=["name","archiving"];t.Stream=function(n,i,r,o,s,a){var l;this.id=this.streamId=n,this.name=i,this.creationTime=Number(r),this.connection=o,this.channel=a,this.publisher=t.publishers.find({streamId:this.id}),t.$.eventing(this);var c=t.$.bind(function(e,n,i,r){var o=n;switch(o){case"active":o="audio"===e.type?"hasAudio":"hasVideo",this[o]=r;break;case"disableWarning":if(o="audio"===e.type?"audioDisableWarning":"videoDisableWarning",this[o]=r,!this["audio"===e.type?"hasAudio":"hasVideo"])return;break;case"fitMode":o="defaultFitMode",this[o]=r;break;case"source":o="audio"===e.type?"audioType":"videoType",this[o]=r;break;case"orientation":case"width":case"height":return void(this.videoDimensions={width:e.width,height:e.height,orientation:e.orientation})}this.dispatchEvent(new t.StreamUpdatedEvent(this,o,i,r))},this),u=t.$.bind(function(){return this.publisher?this.publisher:t.subscribers.find(function(e){return e.stream.id===this.id&&e.session.id===s.id})},this);this.getChannelsOfType=function(e){return t.$.filter(this.channel,function(t){return t.type===e})},this.getChannel=function(e){for(var t=0;t<this.channel.length;++t)if(this.channel[t].id===e)return this.channel[t];return null};var h=this.getChannelsOfType("audio")[0],d=this.getChannelsOfType("video")[0];this.hasAudio=null!=h&&h.active,this.hasVideo=null!=d&&d.active,this.videoType=d&&d.source,this.defaultFitMode=d&&d.fitMode,this.videoDimensions={},d&&(this.videoDimensions.width=d.width,this.videoDimensions.height=d.height,this.videoDimensions.orientation=d.orientation,d.on("update",c),this.frameRate=d.frameRate),h&&h.on("update",c),this.setChannelActiveState=function(e,t,n){var i={active:t};n&&(i.activeReason=n),p(e,i)},this.setVideoDimensions=function(e,t){p("video",{width:e,height:t,orientation:0})},this.setRestrictFrameRate=function(e){p("video",{restrictFrameRate:e})};var p=t.$.bind(function(e,n){var i;if(this.publisher)i=function(e){s._.streamChannelUpdate(this,e,n)};else{var r=t.subscribers.find(function(e){return e.stream&&e.stream.id===this.id&&e.session.id===s.id},this);i=function(e){s._.subscriberChannelUpdate(this,r,e,n)}}t.$.forEach(this.getChannelsOfType(e),t.$.bind(i,this))},this);this.destroyed=!1,this.destroyedReason=void 0,this.destroy=function(e,n){l=e||"clientDisconnected",this.destroyed=!0,this.destroyedReason=l,n!==!0&&this.dispatchEvent(new t.DestroyedEvent("destroyed",this,l))},this._={},this._.updateProperty=t.$.bind(function(n,i){if(-1===t.$.arrayIndexOf(e,n))return void t.warn('Unknown stream property "'+n+'" was modified to "'+i+'".');var r=this[n],o=i;switch(n){case"name":this[n]=o;break;case"archiving":var s=u();s&&s._.archivingStatus(o),this[n]=o}var a=new t.StreamUpdatedEvent(this,n,r,o);this.dispatchEvent(a)},this),this._.update=t.$.bind(function(e){for(var t in e)e.hasOwnProperty(t)&&this._.updateProperty(t,e[t])},this),this._.updateChannel=t.$.bind(function(e,t){this.getChannel(e).update(t)},this)}}(e),!function(){var e,n,i;t.SessionInfo=function(e){var n=e[0];t.log("SessionInfo Response:"),t.log(e),this.sessionId=n.session_id,this.partnerId=n.partner_id,this.sessionStatus=n.session_status,this.messagingServer=n.messaging_server_url,this.messagingURL=n.messaging_url,this.symphonyAddress=n.symphony_address,this.p2pEnabled=!!(n.properties&&n.properties.p2p&&n.properties.p2p.preference&&"enabled"===n.properties.p2p.preference.value)},t.SessionInfo.get=function(r,o,s){var a,l=t.properties.apiURL+"/session/"+r.id+"?extended=true",c=t.$.now(),u=function(a){r.logEvent("Instrumentation",null,"gsi",t.$.now()-c);var l=e(a);l===!1?n(r,o,a):i(r,s,l,JSON.stringify(a))};"IE"===t.$.env.name&&t.$.env.version<10?(l=l+"&format=json&token="+encodeURIComponent(r.token)+"&version=1&cache="+t.$.uuid(),a={xdomainrequest:!0}):a={headers:{"X-TB-TOKEN-AUTH":r.token,"X-TB-VERSION":1}},r.logEvent("SessionInfo","Attempt"),t.$.getJSON(l,a,function(e,n){if(e){var o=n;i(r,s,new t.Error(e.target&&e.target.status||e.code,e.message||"Could not connect to the OpenTok API Server."),o)}else u(n)})};var r={};r[404]=t.ExceptionCodes.INVALID_SESSION_ID,r[409]=t.ExceptionCodes.TERMS_OF_SERVICE_FAILURE,r[400]=t.ExceptionCodes.INVALID_SESSION_ID,r[403]=t.ExceptionCodes.AUTHENTICATION_ERROR,e=function(e){if(t.$.isArray(e)){var n=t.$.filter(e,function(e){return null!=e.error}),i=n.length;if(0===i)return!1;var o,s=n[0].error.code;return r[s.toString()]?(s=r[s],o=n[0].error.errorMessage&&n[0].error.errorMessage.message):(s=t.ErrorCodes.UNEXPECTED_SERVER_RESPONSE,o="Unexpected server response. Try this operation again later."),{code:s,message:o}}return{code:null,message:"Unknown error: getSessionInfo JSON response was badly formed"}},n=function(e,n,i){e.logEvent("SessionInfo","Success",{messagingServer:i[0].messaging_server_url}),n(new t.SessionInfo(i))},i=function(e,t,n,i){var r={reason:"GetSessionInfo",code:n.code||"No code",message:n.message+":"+(i||"Empty responseText from API server")};e.logConnectivityEvent("Failure",r),t(n,e)}}(e),!function(){function e(e,i,r,o){var s=n[r],a=o?t.$.clone(o):{};t.error("OT.exception :: title: "+s+" ("+r+") msg: "+i),a.partnerId||(a.partnerId=t.APIKEY);try{t.analytics.logError(r,"tb.exception",s,{details:i},a),t.dispatchEvent(new t.ExceptionEvent(t.Event.names.EXCEPTION,i,s,r,e,e))}catch(l){t.error("OT.exception :: Failed to dispatch exception - "+l.toString())}}t.Error=function(e,t){this.code=e,this.message=t};var n={1004:"Authentication error",1005:"Invalid Session ID",1006:"Connect Failed",1007:"Connect Rejected",1008:"Connect Time-out",1009:"Security Error",1010:"Not Connected",1011:"Invalid Parameter",1012:"Peer-to-peer Stream Play Failed",1013:"Connection Failed",1014:"API Response Failure",1015:"Session connected, cannot test network",1021:"Request Timeout",1026:"Terms of Service Violation: Export Compliance",1500:"Unable to Publish",1503:"No TURN server found",1520:"Unable to Force Disconnect",1530:"Unable to Force Unpublish",1553:"ICEWorkflow failed",1600:"createOffer, createAnswer, setLocalDescription, setRemoteDescription",2e3:"Internal Error",2001:"Unexpected Server Response",4e3:"WebSocket Connection Failed",4001:"WebSocket Network Disconnected"};t.getErrorTitleByCode=function(e){return n[+e]},t.handleJsException=function(t,n,i){i=i||{};var r,o=i.session;o?(r={sessionId:o.sessionId},o.isConnected()&&(r.connectionId=o.connection.connectionId),i.target||(i.target=o)):i.sessionId&&(r={sessionId:i.sessionId},i.target||(i.target=null)),e(i.target,t,n,r)},t.dispatchError=function(e,n,i,r){t.error(e,n),i&&t.$.isFunction(i)&&i.call(null,new t.Error(e,n)),t.handleJsException(n,e,{session:r})}}(e),!function(){function e(){var e=!1,n=OTPlugin.isSupported(),i=n?OTPlugin.isReady():!0,r=function(){return!t.$.isDOMUnloaded()&&t.$.isReady()&&e&&i},o=function(){r()&&t.dispatchEvent(new t.EnvLoadedEvent(t.Event.names.ENV_LOADED))},s=function(){t.$.onDOMUnload(a),t.Config.load(t.properties.configURL),o()},a=function(){t.dispatchEvent(new t.EnvLoadedEvent(t.Event.names.ENV_UNLOADED))},l=function(e){i=!0,e&&t.debug("TB Plugin failed to load or was not installed"),o()},c=function(){e=!0,t.Config.off("dynamicConfigChanged",c),t.Config.off("dynamicConfigLoadFailed",u),o()},u=function(){c()};t.Config.on("dynamicConfigChanged",c),t.Config.on("dynamicConfigLoadFailed",u),t.$.onDOMLoad(s),n&&OTPlugin.ready(l),this.onLoad=function(e,n){return r()?void e.call(n):void t.on(t.Event.names.ENV_LOADED,e,n)},this.onUnload=function(e,n){return this.isUnloaded()?void e.call(n):void t.on(t.Event.names.ENV_UNLOADED,e,n)},this.isUnloaded=function(){return t.$.isDOMUnloaded()}}var n=new e;t.onLoad=function(e,t){n.onLoad(e,t)},t.onUnload=function(e,t){n.onUnload(e,t)},t.isUnloaded=function(){return n.isUnloaded()}}();var N,F=document.location.hash;t.HAS_REQUIREMENTS=1,t.NOT_HAS_REQUIREMENTS=0,t.checkSystemRequirements=function(){t.debug("OT.checkSystemRequirements()");var e=t.$.hasCapabilities("websockets","webrtc")||OTPlugin.isInstalled();return e=e?this.HAS_REQUIREMENTS:this.NOT_HAS_REQUIREMENTS,t.checkSystemRequirements=function(){return t.debug("OT.checkSystemRequirements()"),e},e===this.NOT_HAS_REQUIREMENTS&&t.analytics.logEvent({action:"checkSystemRequirements",variation:"notHasRequirements",partnerId:t.APIKEY,payload:{userAgent:t.$.env.userAgent}}),e},t.upgradeSystemRequirements=function(){t.onLoad(function(){if(OTPlugin.isSupported())return void t.Dialogs.Plugin.promptToInstall().on({download:function(){e.location=OTPlugin.pathToInstaller()},refresh:function(){location.reload()},closed:function(){}});var n="_upgradeFlash";document.body.appendChild(function(){var e=document.createElement("iframe");e.id=n,e.style.position="absolute",e.style.position="fixed",e.style.height="100%",e.style.width="100%",e.style.top="0px",e.style.left="0px",e.style.right="0px",e.style.bottom="0px",e.style.zIndex=1e3;try{e.style.backgroundColor="rgba(0,0,0,0.2)"}catch(i){e.style.backgroundColor="transparent",e.setAttribute("allowTransparency","true")}e.setAttribute("frameBorder","0"),e.frameBorder="0",e.scrolling="no",e.setAttribute("scrolling","no");var r=t.properties.minimumVersion[t.$.env.name.toLowerCase()],o=r>t.$.env.version;return e.src=t.properties.assetURL+"/html/upgrade.html#"+encodeURIComponent(o?"true":"false")+","+encodeURIComponent(JSON.stringify(t.properties.minimumVersion))+"|"+encodeURIComponent(document.location.href),e}()),N&&clearInterval(N),N=setInterval(function(){var e=document.location.hash,t=/^#?\d+&/;e!==F&&t.test(e)&&(F=e,"close_window"===e.replace(t,"")&&(document.body.removeChild(document.getElementById(n)),document.location.hash=""))},100)})},t.ConnectionCapabilities=function(e){var n=function(e){return e.supportsWebRTC=t.$.castToBoolean(e.supportsWebRTC),e},i=n(e);this.supportsWebRTC=i.supportsWebRTC},t.Capabilities=function(e){this.publish=-1!==t.$.arrayIndexOf(e,"publish")?1:0,this.subscribe=-1!==t.$.arrayIndexOf(e,"subscribe")?1:0,this.forceUnpublish=-1!==t.$.arrayIndexOf(e,"forceunpublish")?1:0,this.forceDisconnect=-1!==t.$.arrayIndexOf(e,"forcedisconnect")?1:0,this.supportsWebRTC=t.$.hasCapabilities("webrtc")?1:0,this.permittedTo=function(e){return this.hasOwnProperty(e)&&1===this[e]}},t.Connection=function(e,n,i,r,o){var s;this.id=this.connectionId=e,this.creationTime=n?Number(n):null,this.data=i,this.capabilities=new t.ConnectionCapabilities(r),this.permissions=new t.Capabilities(o),this.quality=null,t.$.eventing(this),this.destroy=t.$.bind(function(e,n){s=e||"clientDisconnected",n!==!0&&this.dispatchEvent(new t.DestroyedEvent("destroyed",this,s))},this),this.destroyed=function(){return void 0!==s},this.destroyedReason=function(){return s}},t.Connection.fromHash=function(e){return new t.Connection(e.id,e.creationTime,e.data,t.$.extend(e.capablities||{},{supportsWebRTC:!0}),e.permissions||[])},!function(){var e=8192,n=128;t.Signal=function(i,r,o){var s=function(e){return!/^[a-zA-Z0-9\-\._~]+$/.exec(e)},a=function(e){return e?e instanceof t.Connection||e instanceof t.Session?null:{code:400,reason:"The To field was invalid"}:{code:400,reason:"The signal to field was invalid. Either set it to a OT.Connection, OT.Session, or omit it entirely"}},l=function(e){var t=null;return null===e||void 0===e?t={code:400,reason:"The signal type was null or undefined. Either set it to a String value or omit it"}:e.length>n?t={code:413,reason:"The signal type was too long, the maximum length of it is "+n+" characters"}:s(e)&&(t={code:400,reason:"The signal type was invalid, it can only contain letters, numbers, '-', '_', and '~'."}),t},c=function(t){var n=null;if(null===t||void 0===t)n={code:400,reason:"The signal data was null or undefined. Either set it to a String value or omit it"};else try{JSON.stringify(t).length>e&&(n={code:413,reason:"The data field was too long, the maximum size of it is "+e+" characters"})}catch(i){n={code:400,reason:"The data field was not valid JSON"}}return n};this.toRaptorMessage=function(){var e=this.to;return e&&"string"!=typeof e&&(e=e.id),t.Raptor.Message.signals.create(t.APIKEY,i,e,this.type,this.data)},this.toHash=function(){return o},this.error=null,o&&(o.hasOwnProperty("data")&&(this.data=t.$.clone(o.data),this.error=c(this.data)),o.hasOwnProperty("to")&&(this.to=o.to,this.error||(this.error=a(this.to))),o.hasOwnProperty("type")&&(this.error||(this.error=l(o.type)),this.type=o.type)),this.valid=null===this.error}}(this),t.Raptor.Socket=function(e,n,i,r,o){var s,a,l,c,u,d=["disconnected","connecting","connected","error","disconnecting"],p=t.$.statable(this,d,"disconnected"),f=function(e){p(e?"error":"connected"),u.apply(null,arguments)},g=t.$.bind(function(e){var t="clientDisconnected";!this.is("disconnecting")&&l.is("error")&&(t="networkDisconnected"),e&&4001===e.code&&(t="networkTimedout"),p("disconnected"),c.onClose(t)},this),m=function(){};this.connect=function(n,o,h){if(!this.is("disconnected","error"))return void t.warn("Cannot connect the Raptor Socket as it is currently connected. You should disconnect first.");p("connecting"),s=o.sessionId,a=n,u=h;var d="/v2/partner/"+t.APIKEY+"/session/"+s;l=new t.Rumor.Socket(i,r),l.onClose(g),l.onMessage(t.$.bind(c.dispatch,c)),l.connect(e,t.$.bind(function(n){if(n)return void f({reason:"WebSocketConnection",code:n.code,message:n.message});l.onError(m),t.debug("Raptor Socket connected. Subscribing to "+d+" on "+i),l.subscribe([d]);var r=t.Raptor.Message.connections.create(t.APIKEY,s,l.id());this.publish(r,{"X-TB-TOKEN-AUTH":a},t.$.bind(function(n){if(n){var i,r,o=[400,403,409];n.code===t.ExceptionCodes.CONNECT_FAILED?(i=n.code,r=t.getErrorTitleByCode(n.code)):n.code&&t.$.arrayIndexOf(o,n.code)>-1?(i=t.ExceptionCodes.CONNECT_FAILED,r="Received error response to connection create message."):(i=t.ExceptionCodes.UNEXPECTED_SERVER_RESPONSE,r="Unexpected server response. Try this operation again later."),n.message="ConnectToSession:"+n.code+":Received error response to connection create message.";var a={reason:"ConnectToSession",code:i,message:r},l={action:"Connect",variation:"Failure",payload:a,sessionId:s,partnerId:t.APIKEY,connectionId:e};return t.analytics.logEvent(l),void f(a)}this.publish(t.Raptor.Message.sessions.get(t.APIKEY,s),function(n){if(n){var i,r,o=[400,403,409];n.code&&t.$.arrayIndexOf(o,n.code)>-1?(i=t.ExceptionCodes.CONNECT_FAILED,r="Received error response to session read"):(i=t.ExceptionCodes.UNEXPECTED_SERVER_RESPONSE,r="Unexpected server response. Try this operation again later.");var a={reason:"GetSessionState",code:n.code,message:r},l={action:"Connect",variation:"Failure",payload:a,sessionId:s,partnerId:t.APIKEY,connectionId:e};t.analytics.logEvent(l),f(a)}else f.apply(null,arguments)})},this))},this))},this.disconnect=function(e){this.is("disconnected")||(p("disconnecting"),l.disconnect(e))},this.publish=function(e,n,i){if(l.isNot("connected"))return void t.error("OT.Raptor.Socket: cannot publish until the socket is connected."+e);var o,s=t.$.uuid(),a={};return n&&(t.$.isFunction(n)?(a={},o=n):a=n),!o&&i&&t.$.isFunction(i)&&(o=i),o&&c.registerCallback(s,o),t.debug("OT.Raptor.Socket Publish (ID:"+s+") "),t.debug(e),l.publish([r],e,t.$.extend(a,{"Content-Type":"application/x-raptor+v2","TRANSACTION-ID":s,"X-TB-FROM-ADDRESS":l.id()})),s},this.streamCreate=function(e,n,i,r,o,a,l){var c=t.Raptor.Message.streams.create(t.APIKEY,s,n,e,i,r,o,a);this.publish(c,function(e,t){l(e,n,t)})},this.streamDestroy=function(e){this.publish(t.Raptor.Message.streams.destroy(t.APIKEY,s,e))},this.streamChannelUpdate=function(e,n,i){this.publish(t.Raptor.Message.streamChannels.update(t.APIKEY,s,e,n,i))},this.subscriberCreate=function(e,n,i,r){this.publish(t.Raptor.Message.subscribers.create(t.APIKEY,s,e,n,l.id(),i),r)},this.subscriberDestroy=function(e,n){this.publish(t.Raptor.Message.subscribers.destroy(t.APIKEY,s,e,n))},this.subscriberUpdate=function(e,n,i){this.publish(t.Raptor.Message.subscribers.update(t.APIKEY,s,e,n,i))},this.subscriberChannelUpdate=function(e,n,i,r){this.publish(t.Raptor.Message.subscriberChannels.update(t.APIKEY,s,e,n,i,r))},this.forceDisconnect=function(e,n){this.publish(t.Raptor.Message.connections.destroy(t.APIKEY,s,e),n)},this.forceUnpublish=function(e,n){this.publish(t.Raptor.Message.streams.destroy(t.APIKEY,s,e),n)},this.jsepCandidate=function(e,n){this.publish(t.Raptor.Message.streams.candidate(t.APIKEY,s,e,n))},this.jsepCandidateP2p=function(e,n,i){this.publish(t.Raptor.Message.subscribers.candidate(t.APIKEY,s,e,n,i))},this.jsepOffer=function(e,n){this.publish(t.Raptor.Message.offer(e,n))},this.jsepAnswer=function(e,n){this.publish(t.Raptor.Message.streams.answer(t.APIKEY,s,e,n))},this.jsepAnswerP2p=function(e,n,i){this.publish(t.Raptor.Message.subscribers.answer(t.APIKEY,s,e,n,i))},this.signal=function(e,n,i){var r=new t.Signal(s,l.id(),e||{});return r.valid?void this.publish(r.toRaptorMessage(),function(e){var o,s,a,l=[400,403,404,413];if(e)e.code&&t.$.arrayIndexOf(l,o.code)>-1?(s=e.code,a=e.message):(s=t.ExceptionCodes.UNEXPECTED_SERVER_RESPONSE,a="Unexpected server response. Try this operation again later."),o=new t.SignalError(s,a);else{var c=r.data?typeof r.data:null;i("signal","send",{type:c})}n&&t.$.isFunction(n)&&n(o,r.toHash())}):void(n&&t.$.isFunction(n)&&n(new h(r.error.code,r.error.reason),r.toHash()))},this.id=function(){return l&&l.id()},null==o&&(o=new t.Raptor.Dispatcher),c=o},t.GetStatsAudioLevelSampler=function(e){if(!t.$.hasCapabilities("audioOutputLevelStat"))throw new Error("The current platform does not provide the required capabilities");var n=e,i="audioOutputLevel";this.sample=function(e){n.getStats(function(t,n){if(!t)for(var r=0;r<n.length;r++){var o=n[r],s=parseFloat(o[i]);if(!isNaN(s))return void e(s/32768)}e(null)})}},t.AnalyserAudioLevelSampler=function(e){var n=this,i=null,r=null,o=null,s=function(t){var n=e.createMediaStreamSource(t),i=e.createAnalyser();return n.connect(i),i};t.$.defineProperties(n,{webRTCStream:{get:function(){return o},set:function(e){o=e,i=s(o),r=new Uint8Array(i.frequencyBinCount)}}}),this.sample=function(e){if(i){i.getByteTimeDomainData(r);for(var t=0,n=0;n<r.length;n++)t=Math.max(t,Math.abs(r[n]-128));e(t/128)}else e(null)}},t.AudioLevelTransformer=function(){var e=null;this.transform=function(t){e=null===e||t>=e?t:.3*t+.7*e;var n=Math.log(e)/Math.LN10/1.5+1;return Math.min(Math.max(n,0),1)}},t.audioContext=function(){var n=new e.AudioContext;return t.audioContext=function(){return n},n},t.Archive=function(e,n,i){this.id=e,this.name=n,this.status=i,this._={},t.$.eventing(this),this._.update=t.$.bind(function(e){for(var n in e)if(e.hasOwnProperty(n)){var i=this[n];this[n]=e[n];var r=new t.ArchiveUpdatedEvent(this,n,i,this[n]);this.dispatchEvent(r)}},this),this.destroy=function(){}},t.analytics=new t.Analytics(t.properties.loggingURL),t.Subscriber=function(e,n,i){var r,o,s,a,l,c,u,h,d,p,f,g,m,v,b,y=t.$.uuid(),w=e||y,_=n.session,x=n.stream,C=100,$=t.$.hasCapabilities("audioOutputLevelStat")||t.$.hasCapabilities("webAudioCapableRemoteStream"),k=!1,S=this;if(d=t.$.defaults({},n,{showControls:!0,fitMode:x.defaultFitMode||"cover"}),this.id=w,this.widgetId=y,this.session=_,this.stream=x=d.stream,this.streamId=x.id,f={timeStamp:t.$.now()},!_)return void t.handleJsException("Subscriber must be passed a session option",2e3,{session:_,target:this});t.$.eventing(this,!1),"function"==typeof i&&this.once("subscribeComplete",i),$&&this.on({"audioLevelUpdated:added":function(e){1===e&&v&&v.start()},"audioLevelUpdated:removed":function(e){0===e&&v&&v.stop()}});var T=function(e,n,i,r){var o=[{action:e,variation:n,payload:i,streamId:x?x.id:null,sessionId:_?_.sessionId:null,connectionId:_&&_.isConnected()?_.connection.connectionId:null,partnerId:_&&_.isConnected()?_.sessionInfo.partnerId:null,subscriberId:y}];r&&o.push(r),t.analytics.logEvent.apply(t.analytics,o)},E=function(e,n){"Attempt"!==e&&b||(b=new t.ConnectivityAttemptPinger({action:"Subscribe",sessionId:_?_.sessionId:null,connectionId:_&&_.isConnected()?_.connection.connectionId:null,partnerId:_.isConnected()?_.sessionInfo.partnerId:null,streamId:x?x.id:null})),b.setVariation(e),T("Subscribe",e,n)},D=t.$.bind(function(e){var n={streamType:"WebRTC",width:r?Number(t.$.width(r.domElement).replace("px","")):null,height:r?Number(t.$.height(r.domElement).replace("px","")):null,sessionId:_?_.sessionId:null,connectionId:_?_.connection.connectionId:null,mediaServerName:_?_.sessionInfo.messagingServer:null,p2pFlag:_?_.sessionInfo.p2pEnabled:!1,partnerId:_?_.apiKey:null,streamId:x.id,subscriberId:y,version:t.properties.version,duration:parseInt(t.$.now()-u,10),remoteConnectionId:x.connection.connectionId};t.analytics.logQOS(t.$.extend(n,e)),this.trigger("qos",e)},this),A=function(e){t.error("Subscriber State Change Failed: ",e.message),t.debug(e)},O=function(){if(!p.isSubscribing()&&o){t.debug("OT.Subscriber.onLoaded"),p.set("Subscribing"),u=t.$.now();var e={pcc:parseInt(u-h,10),hasRelayCandidates:c&&c.hasRelayCandidates()};T("createPeerConnection","Success",e),r.loading(!1),s.showAfterLoading(),k&&x.setRestrictFrameRate(!0),a&&"auto"===S.getStyle("audioLevelDisplayMode")&&a[r.audioOnly()?"show":"hide"](),this.trigger("subscribeComplete",null,this),this.trigger("loaded",this),E("Success",{streamId:x.id})}},I=function(){t.debug("OT.Subscriber has been disconnected from the Publisher's PeerConnection"),p.isAttemptingToSubscribe()?(p.set("Failed"),this.trigger("subscribeComplete",new t.Error(null,"ClientDisconnected"))):p.isSubscribing()&&p.set("Failed"),this.disconnect()},M=t.$.bind(function(e,n,i,r){var o;p.isAttemptingToSubscribe()?(o={reason:r?r:"PeerConnectionError",message:"Subscriber PeerConnection Error: "+n,hasRelayCandidates:c&&c.hasRelayCandidates()},T("createPeerConnection","Failure",o),p.set("Failed"),this.trigger("subscribeComplete",new t.Error(null,n))):p.isSubscribing()&&(p.set("Failed"),this.trigger("error",n)),this.disconnect();var s;s="ICEWorkflow"===r?t.ExceptionCodes.SUBSCRIBER_ICE_WORKFLOW_FAILED:t.ExceptionCodes.P2P_CONNECTION_FAILED,o={reason:r?r:"PeerConnectionError",message:"Subscriber PeerConnection Error: "+n,code:s},E("Failure",o),t.handleJsException("Subscriber PeerConnection Error: "+n,s,{session:_,target:this}),H.call(this,n)},this),P=function(e){t.debug("OT.Subscriber.onRemoteStreamAdded"),p.set("BindingRemoteStream"),this.subscribeToAudio(d.subscribeToAudio),g="loading",this.subscribeToVideo(d.subscribeToVideo,"loading");var n={error:M,audioVolume:C},i=e.getVideoTracks();i.length>0&&t.$.forEach(i,function(e){e.setEnabled(x.hasVideo&&d.subscribeToVideo)}),o=r.bindVideo(e,n,t.$.bind(function(e){return e?void M(null,e.message||e,c,"VideoElement"):(o&&o.orientation({width:x.videoDimensions.width,height:x.videoDimensions.height,videoOrientation:x.videoDimensions.orientation}),void O.call(this,null))},this)),t.$.hasCapabilities("webAudioCapableRemoteStream")&&m&&e.getAudioTracks().length>0&&m.webRTCStream(e),T("createPeerConnection","StreamAdded"),this.trigger("streamAdded",this)},R=function(e){t.debug("OT.Subscriber.onStreamRemoved"),o.stream===e&&(o.destroy(),o=null),this.trigger("streamRemoved",this)},N=function(){this.disconnect()},F=function(e){switch(e.changedProperty){case"videoDimensions":if(!o)break;o.orientation({width:e.newValue.width,height:e.newValue.height,videoOrientation:e.newValue.orientation}),this.dispatchEvent(new t.VideoDimensionsChangedEvent(this,e.oldValue,e.newValue));break;case"videoDisableWarning":s.videoDisabledIndicator.setWarning(e.newValue),this.dispatchEvent(new t.VideoDisableWarningEvent(e.newValue?"videoDisableWarning":"videoDisableWarningLifted"));break;case"hasVideo":W(!(x.hasVideo&&d.subscribeToVideo)),this.dispatchEvent(new t.VideoEnabledChangedEvent(x.hasVideo?"videoEnabled":"videoDisabled",{reason:"publishVideo"}));break;case"hasAudio":}},L=function(e){if(e===!1)return"off";var t=this.getStyle("buttonDisplayMode");return t===!1?"on":t},j=function(e,t){if(s)switch(e){case"nameDisplayMode":s.name.setDisplayMode(t),s.backingBar.setNameMode(t);break;case"videoDisabledDisplayMode":s.videoDisabledIndicator.setDisplayMode(t);break;case"showArchiveStatus":s.archive.setShowArchiveStatus(t);break;case"buttonDisplayMode":s.muteButton.setDisplayMode(t),s.backingBar.setMuteMode(t);break;case"audioLevelDisplayMode":s.audioLevel.setDisplayMode(t);break;case"bugDisplayMode":case"backgroundImageURI":r.setBackgroundImageURI(t)}},U=function(){var e={backingBar:new t.Chrome.BackingBar({nameMode:d.name?this.getStyle("nameDisplayMode"):"off",muteMode:L.call(this,this.getStyle("showMuteButton"))}),name:new t.Chrome.NamePanel({name:d.name,mode:this.getStyle("nameDisplayMode")}),muteButton:new t.Chrome.MuteButton({muted:d.muted,mode:L.call(this,this.getStyle("showMuteButton"))}),archive:new t.Chrome.Archiving({show:this.getStyle("showArchiveStatus"),archiving:!1})};if($){var n=new t.AudioLevelTransformer,i=function(e){a.setValue(n.transform(e.audioLevel))};a=new t.Chrome.AudioLevelMeter({mode:this.getStyle("audioLevelDisplayMode"),onActivate:function(){S.on("audioLevelUpdated",i)},onPassivate:function(){S.off("audioLevelUpdated",i)}}),e.audioLevel=a}e.videoDisabledIndicator=new t.Chrome.VideoDisabledIndicator({mode:this.getStyle("videoDisabledDisplayMode")}),s=new t.Chrome({parent:r.domElement}).set(e).on({muted:function(){z.call(this,!0)},unmuted:function(){z.call(this,!1)}},this),s.hideWhileLoading()},H=function(){r&&r.addError("The stream was unable to connect due to a network error.","Make sure your connection isn't blocked by a firewall.")};t.StylableComponent(this,{nameDisplayMode:"auto",buttonDisplayMode:"auto",audioLevelDisplayMode:"auto",videoDisabledDisplayMode:"auto",backgroundImageURI:null,showArchiveStatus:!0,showMicButton:!0},d.showControls,function(e){T("SetStyle","Subscriber",e,.1)});var W=function(e){c&&c.subscribeToVideo(!e),r&&(r.audioOnly(e),r.showPoster(e)),a&&"auto"===S.getStyle("audioLevelDisplayMode")&&a[e?"show":"hide"]()},B=function(){var e=0;return function(){e%100===0&&T("getStats","Called"),e++}}();this.destroy=function(e,n){return p.isDestroyed()?void 0:("streamDestroyed"===e&&p.isAttemptingToSubscribe()&&this.trigger("subscribeComplete",new t.Error(null,"InvalidStreamID")),p.set("Destroyed"),v&&v.stop(),this.disconnect(),s&&(s.destroy(),s=null),r&&(r.destroy(),r=null,this.element=null),x&&!x.destroyed&&T("unsubscribe",null,{streamId:x.id}),this.id=w=null,this.stream=x=null,this.streamId=null,this.session=_=null,d=null,n!==!0&&this.dispatchEvent(new t.DestroyedEvent(t.Event.names.SUBSCRIBER_DESTROYED,this,e),t.$.bind(this.off,this)),this)},this.disconnect=function(){p.isDestroyed()||p.isFailed()||p.set("NotSubscribing"),o&&(o.destroy(),o=null),c&&(c.destroy(),c=null,T("disconnect","PeerConnection",{streamId:x.id}))},this.processMessage=function(e,n,i){t.debug("OT.Subscriber.processMessage: Received "+e+" message from "+n.id),t.debug(i),l!==n.id&&(l=n.id),c&&c.processMessage(e,i)},this.disableVideo=function(e){if(e){if("auto"!==g)return void t.info("Video was not re-enabled because it was manually disabled");t.info("Video has been re-enabled"),s.videoDisabledIndicator.disableVideo(!1)}else t.warn("Due to high packet loss and low bandwidth, video has been disabled");this.subscribeToVideo(e,"auto"),e||s.videoDisabledIndicator.disableVideo(!0);var n=e?{videoEnabled:!0}:{videoDisabled:!0};T("updateQuality","video",n)},this.getImgData=function(){return this.isSubscribing()?o.imgData():(t.error("OT.Subscriber.getImgData: Cannot getImgData before the Subscriber is subscribing."),null)},this.getStats=function(e){return c?(B(),void c.getStats(function(n,i){if(n)return void e(n);var r={timestamp:0};t.$.forEach(i,function(e){if(t.getStatsHelpers.isInboundStat(e)){var n=t.getStatsHelpers.isVideoStat(e),i=t.getStatsHelpers.isAudioStat(e);(i||n)&&(r.timestamp=t.getStatsHelpers.normalizeTimestamp(e.timestamp)),n?r.video=t.getStatsHelpers.parseStatCategory(e):i&&(r.audio=t.getStatsHelpers.parseStatCategory(e))}}),e(null,r)})):void e(new t.$.Error("Subscriber is not connected cannot getStats",1015))},this.setAudioVolume=function(e){return e=parseInt(e,10),isNaN(e)?(t.error("OT.Subscriber.setAudioVolume: value should be an integer between 0 and 100"),this):(C=Math.max(0,Math.min(100,e)),C!==e&&t.warn("OT.Subscriber.setAudioVolume: value should be an integer between 0 and 100"),d.muted&&C>0&&(d.premuteVolume=e,z.call(this,!1)),o&&o.setAudioVolume(C),this)},this.getAudioVolume=function(){return d.muted?0:o?o.getAudioVolume():C},this.subscribeToAudio=function(e){var n=t.$.castToBoolean(e,!0);return c&&(c.subscribeToAudio(n&&!d.subscribeMute),_&&x&&n!==d.subscribeToAudio&&x.setChannelActiveState("audio",n&&!d.subscribeMute)),d.subscribeToAudio=n,this};var z=function(e){s.muteButton.muted(e),e!==d.mute&&("Chrome"===t.$.env.name||OTPlugin.isInstalled()?(d.subscribeMute=d.muted=e,this.subscribeToAudio(d.subscribeToAudio)):e?(d.premuteVolume=this.getAudioVolume(),d.muted=!0,this.setAudioVolume(0)):(d.premuteVolume||d.audioVolume)&&(d.muted=!1,this.setAudioVolume(d.premuteVolume||d.audioVolume)),d.mute=d.mute)},q={auto:"quality",publishVideo:"publishVideo",subscribeToVideo:"subscribeToVideo"};if(this.subscribeToVideo=function(e,n){var i=t.$.castToBoolean(e,!0);return W(!(i&&x.hasVideo)),i&&r&&r.video()&&(r.loading(i),r.video().whenTimeIncrements(function(){r.loading(!1)},this)),s&&s.videoDisabledIndicator&&s.videoDisabledIndicator.disableVideo(!1),c&&_&&x&&(i!==d.subscribeToVideo||n!==g)&&x.setChannelActiveState("video",i,n),d.subscribeToVideo=i,g=n,"loading"!==n&&this.dispatchEvent(new t.VideoEnabledChangedEvent(i?"videoEnabled":"videoDisabled",{reason:q[n]||"subscribeToVideo"})),this},this.isSubscribing=function(){return p.isSubscribing()},this.isWebRTC=!0,this.isLoading=function(){return r&&r.loading()},this.videoElement=function(){return o.domElement()},this.videoWidth=function(){return o.videoWidth()},this.videoHeight=function(){return o.videoHeight()},this.restrictFrameRate=function(e){return t.debug("OT.Subscriber.restrictFrameRate("+e+")"),T("restrictFrameRate",e.toString(),{streamId:x.id}),_.sessionInfo.p2pEnabled&&t.warn("OT.Subscriber.restrictFrameRate: Cannot restrictFrameRate on a P2P session"),"boolean"!=typeof e?t.error("OT.Subscriber.restrictFrameRate: expected a boolean value got a "+typeof e):(k=e,x.setRestrictFrameRate(e)),this},this.on("styleValueChanged",j,this),this._={archivingStatus:function(e){s&&s.archive.setArchiving(e)},getDataChannel:function(e,n,i){return c?void c.getDataChannel(e,n,i):void i(new t.$.Error("Cannot create a DataChannel before there is a publisher connection."))}},p=new t.SubscribingState(A),t.debug("OT.Subscriber: subscribe to "+x.id),p.set("Init"),!x)return t.error("OT.Subscriber: No stream parameter."),!1;if(x.on({updated:F,destroyed:N},this),l=x.connection.id,d.name=d.name||x.name,d.classNames="OT_root OT_subscriber",d.style&&this.setStyle(d.style,null,!0),d.audioVolume&&this.setAudioVolume(d.audioVolume),d.subscribeToAudio=t.$.castToBoolean(d.subscribeToAudio,!0),d.subscribeToVideo=t.$.castToBoolean(d.subscribeToVideo,!0),r=new t.WidgetView(e,d),this.id=w=r.domId(),this.element=r.domElement,U.call(this),h=t.$.now(),x.connection.id!==_.connection.id){if(T("createPeerConnection","Attempt",""),p.set("ConnectingToPeer"),c=new t.SubscriberPeerConnection(x.connection,_,x,this,d),c.on({disconnected:I,error:M,remoteStreamAdded:P,remoteStreamRemoved:R,qos:D},this),c.init(),t.$.hasCapabilities("audioOutputLevelStat")?m=new t.GetStatsAudioLevelSampler(c,"out"):t.$.hasCapabilities("webAudioCapableRemoteStream")&&(m=new t.AnalyserAudioLevelSampler(t.audioContext())),m){var V=this;v=new t.IntervalRunner(function(){m.sample(function(e){
null!==e&&t.$.requestAnimationFrame(function(){V.dispatchEvent(new t.AudioLevelUpdatedEvent(e))})})},60)}}else{T("createPeerConnection","Attempt","");var Y=_.getPublisherForStream(x);if(!Y||!Y._.webRtcStream())return this.trigger("subscribeComplete",new t.Error(null,"InvalidStreamID")),this;P.call(this,Y._.webRtcStream())}E("Attempt",{streamId:x.id})},t.Session=function(e,n){function i(e){return new t.$.RSVP.Promise(function(n,i){t.$.getJSON([t.properties.apiURL,"/v2/partner/",E,"/session/",A,"/connection/",I,"/testNetworkConfig"].join(""),{headers:{"X-TB-TOKEN-AUTH":e}},function(e,r){if(e){var o=JSON.parse(e.target.responseText);i(-1===o.code?new t.$.Error("Unexpected HTTP error codes "+e.target.status,"2001"):10001===o.code||10002===o.code?new t.$.Error(o.message,"1004"):new t.$.Error(o.message,o.code))}else n(r)})})}if(t.$.eventing(this),!t.checkSystemRequirements())return void t.upgradeSystemRequirements();null==n&&(n=e,e=null),this.id=this.sessionId=n;var r,o,s,a,l,c,u,h,d,p,f,g,m,v,b,y,w,_,x,C,$,k,S,T=!0,E=e,D=this,A=n,O=t.$.uuid(),I=t.$.uuid(),M=t.$.statable(this,["disconnected","connecting","connected","disconnecting"],"disconnected");this.connection=null,this.connections=new t.$.Collection,this.streams=new t.$.Collection,this.archives=new t.$.Collection,s=function(e,n){M("disconnected"),t.error(e),this.trigger("sessionConnectFailed",new t.Error(n||t.ExceptionCodes.CONNECT_FAILED,e)),t.handleJsException(e,n||t.ExceptionCodes.CONNECT_FAILED,{session:this})},a=function(e){var n=e.reason;"networkTimedout"===n?(n="networkDisconnected",this.logEvent("Connect","TimeOutDisconnect",{reason:e.reason})):this.logEvent("Connect","Disconnected",{reason:e.reason});var i=new t.SessionDisconnectEvent("sessionDisconnected",n);v(),b.call(this,n);var r=t.$.bind(function(){y.call(this,i.reason),i.isDefaultPrevented()||w.call(this,i.reason)},this);this.dispatchEvent(i,r)},l=function(e){e.id.match(/^symphony\./)||this.dispatchEvent(new t.ConnectionEvent(t.Event.names.CONNECTION_CREATED,e))},c=function(e,n){e.id.match(/^symphony\./)||e.id!==o.id()&&this.dispatchEvent(new t.ConnectionEvent(t.Event.names.CONNECTION_DESTROYED,e,n))},u=function(e){e.connection.id!==this.connection.id&&this.dispatchEvent(new t.StreamEvent(t.Event.names.STREAM_CREATED,e,null,!1))},h=function(e){var n=e.target,i=e.changedProperty,r=e.newValue;"videoDisableWarning"!==i&&"audioDisableWarning"!==i&&("orientation"===i&&(i="videoDimensions",r={width:r.width,height:r.height}),this.dispatchEvent(new t.StreamPropertyChangedEvent(t.Event.names.STREAM_PROPERTY_CHANGED,n,i,e.oldValue,r)))},d=function(e,n){if(e.connection.id===this.connection.id)return void t.$.forEach(t.publishers.where({streamId:e.id}),t.$.bind(function(e){e._.unpublishFromSession(this,n)},this));var i=new t.StreamEvent("streamDestroyed",e,n,!0),r=t.$.bind(function(){i.isDefaultPrevented()||t.$.forEach(t.subscribers.where({streamId:e.id}),function(e){e.session.id===this.id&&e.stream&&e.destroy("streamDestroyed")},this)},this);this.dispatchEvent(i,r)},p=function(e){this.dispatchEvent(new t.ArchiveEvent("archiveStarted",e))},f=function(e){this.dispatchEvent(new t.ArchiveEvent("archiveDestroyed",e))},g=function(e){var n=e.target,i=e.changedProperty,r=e.newValue;this.dispatchEvent("status"===i&&"stopped"===r?new t.ArchiveEvent("archiveStopped",n):new t.ArchiveEvent("archiveUpdated",n))},m=function(){D.token=r=null,M("disconnected"),D.connection=null,D.capabilities=new t.Capabilities([]),D.connections.destroy(),D.streams.destroy(),D.archives.destroy()},v=function(){I=t.$.uuid(),m()},b=function(e){t.$.forEach(t.publishers.where({session:this}),function(t){t.disconnect(e)}),t.$.forEach(t.subscribers.where({session:this}),function(e){e.disconnect()})},y=function(e){t.$.forEach(t.publishers.where({session:this}),function(t){t._.streamDestroyed(e)})},w=function(e){t.$.forEach(t.subscribers.where({session:this}),function(t){t.destroy(e)})},_=function(){t.debug("OT.Session: connecting to Raptor");var e=this.sessionInfo.messagingURL,n=t.properties.symphonyAddresss||this.sessionInfo.symphonyAddress;o=new t.Raptor.Socket(I,O,e,n,t.SessionDispatcher(this)),o.connect(r,this.sessionInfo,t.$.bind(function(e,n){return e?(o=void 0,this.logConnectivityEvent("Failure",e),void s.call(this,e.message,e.code)):(t.debug("OT.Session: Received session state from Raptor",n),this.connection=this.connections.get(o.id()),this.connection&&(this.capabilities=this.connection.permissions),M("connected"),this.logConnectivityEvent("Success",null,{connectionId:this.connection.id}),this.connection.on("destroyed",a,this),this.connections.on({add:l,remove:c},this),this.streams.on({add:u,remove:d,update:h},this),this.archives.on({add:p,remove:f,update:g},this),void this.dispatchEvent(new t.SessionConnectEvent(t.Event.names.SESSION_CONNECTED),t.$.bind(function(){this.connections._triggerAddEvents(),this.streams._triggerAddEvents(),this.archives._triggerAddEvents()},this)))},this))},x=function(){this.is("connecting")&&t.SessionInfo.get(this,t.$.bind(C,this),t.$.bind(function(e){s.call(this,e.message+(e.code?" ("+e.code+")":""),e.code)},this))},C=function(e){if(this.is("connecting")){var n=t.properties.sessionInfoOverrides;if(this.sessionInfo=e,null!=n&&"object"==typeof n&&(this.sessionInfo=t.$.defaults(n,this.sessionInfo)),this.sessionInfo.partnerId&&this.sessionInfo.partnerId!==E){this.apiKey=E=this.sessionInfo.partnerId;var i="Authentication Error: The API key does not match the token or session.",r={code:t.ExceptionCodes.AUTHENTICATION_ERROR,message:i};this.logEvent("Failure","SessionInfo",r),s.call(this,i,t.ExceptionCodes.AUTHENTICATION_ERROR)}else _.call(this)}},$=t.$.bind(function(e){return this.capabilities.permittedTo(e)},this),S=t.$.bind(function(e,n,i){t.dispatchError(e,n,i,this)},this),this.logEvent=function(e,n,i,r){var o={action:e,variation:n,payload:i,sessionId:A,partnerId:E};o.connectionId=I,r&&(o=t.$.extend(r,o)),t.analytics.logEvent(o)},this.testNetwork=function(e,n,r){var o=r;if(r=function(e,t){e?D.logEvent("TestNetwork","Failure",{failureCode:e.name||e.message||"unknown"}):D.logEvent("TestNetwork","Success",t),o(e,t)},D.logEvent("TestNetwork","Attempt",{}),this.isConnected())return void r(new t.$.Error("Session connected, cannot test network",1015));var s,a,l=new t.$.RSVP.Promise(function(e,t){var i=n._.webRtcStream();if(i)e(i);else{var r=function(){s(),e(n._.webRtcStream())},o=function(e){e&&(s(),t(e))},s=function(){n.off("publishComplete",o),n.off("accessAllowed",r)};n.on("publishComplete",o),n.on("accessAllowed",r)}});t.$.RSVP.Promise.all([i(e),l]).then(function(e){var n=e[1];return s=e[0],t.webrtcTest({mediaConfig:s.media,localStream:n})}).then(function(e){return t.debug("Received stats from webrtcTest: ",e),e.bandwidth<s.media.thresholdBitsPerSecond?t.$.RSVP.Promise.reject(new t.$.Error("The detect bandwidth form the WebRTC stage of the test was not sufficient to run the HTTP stage of the test",1553)):void(a=e)}).then(function(){return a.extended?void 0:t.httpTest({httpConfig:s.http})}).then(function(e){var t={uploadBitsPerSecond:e?e.uploadBandwidth:a.bandwidth,downloadBitsPerSecond:e?e.downloadBandwidth:a.bandwidth,packetLossRatio:a.packetLostRatio,roundTripTimeMilliseconds:a.roundTripTime};r(null,t)})["catch"](function(e){r(e)})},this.logConnectivityEvent=function(e,n,i){if("Attempt"===e||!k){var r={action:"Connect",sessionId:A,partnerId:E};this.connection&&this.connection.id?r=event.connectionId=this.connection.id:I&&(r.connectionId=I),k=new t.ConnectivityAttemptPinger(r)}k.setVariation(e),this.logEvent("Connect",e,n,i)},this.connect=function(n){null==e&&arguments.length>1&&("string"==typeof arguments[0]||"number"==typeof arguments[0])&&"string"==typeof arguments[1]&&(E=n.toString(),n=arguments[1]);var i=arguments[arguments.length-1];if(this.is("connecting","connected"))return t.warn("OT.Session: Cannot connect, the session is already "+this.state),this;if(m(),M("connecting"),this.token=r=!t.$.isFunction(n)&&n,T?T=!1:O=t.$.uuid(),i&&t.$.isFunction(i)&&(this.once("sessionConnected",t.$.bind(i,null,null)),this.once("sessionConnectFailed",i)),null==E||t.$.isFunction(E))return setTimeout(t.$.bind(s,this,"API Key is undefined. You must pass an API Key to initSession.",t.ExceptionCodes.AUTHENTICATION_ERROR)),this;if(this.logConnectivityEvent("Attempt"),!A||t.$.isObject(A)||t.$.isArray(A)){var o;return A?(o="SessionID is not a string. You must use string as the session ID passed into OT.initSession().",A=A.toString()):o="SessionID is undefined. You must pass a sessionID to initSession.",setTimeout(t.$.bind(s,this,o,t.ExceptionCodes.INVALID_SESSION_ID)),this.logConnectivityEvent("Failure",{reason:"ConnectToSession",code:t.ExceptionCodes.INVALID_SESSION_ID,message:o}),this}return this.apiKey=E=E.toString(),0===t.APIKEY.length&&(t.APIKEY=E),x.call(this),this};var P=t.$.bind(function(e){o&&o.isNot("disconnected")?o.isNot("disconnecting")&&(M("disconnecting"),o.disconnect(e)):v()},this);this.disconnect=function(e){P(void 0!==e?e:!0)},this.destroy=function(e){this.streams.destroy(),this.connections.destroy(),this.archives.destroy(),P("unloaded"!==e)},this.publish=function(e,n,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof n&&(i=n,n=void 0),this.isNot("connected"))return t.analytics.logError(1010,"OT.exception","We need to be connected before you can publish",null,{action:"Publish",variation:"Failure",payload:{reason:"unconnected",code:t.ExceptionCodes.NOT_CONNECTED,message:"We need to be connected before you can publish"},sessionId:A,streamId:e&&e.stream?e.stream.id:null,partnerId:E}),i&&t.$.isFunction(i)&&S(t.ExceptionCodes.NOT_CONNECTED,"We need to be connected before you can publish",i),null;if(!$("publish")){var r="This token does not allow publishing. The role must be at least `publisher` to enable this functionality",o={reason:"permission",code:t.ExceptionCodes.UNABLE_TO_PUBLISH,message:r};return this.logEvent("publish","Failure",o),S(t.ExceptionCodes.UNABLE_TO_PUBLISH,r,i),null}if(!e||"string"==typeof e||t.$.isElementNode(e))e=t.initPublisher(e,n);else{if(!(e instanceof t.Publisher))return void S(t.ExceptionCodes.UNABLE_TO_PUBLISH,"Session.publish :: First parameter passed in is neither a string nor an instance of the Publisher",i);"session"in e&&e.session&&"sessionId"in e.session&&t.warn(e.session.sessionId===this.sessionId?"Cannot publish "+e.guid()+" again to "+this.sessionId+". Please call session.unpublish(publisher) first.":"Cannot publish "+e.guid()+" publisher already attached to "+e.session.sessionId+". Please call session.unpublish(publisher) first.")}return e.once("publishComplete",function(e){return e?void S(t.ExceptionCodes.UNABLE_TO_PUBLISH,"Session.publish :: "+e.message,i):void(i&&t.$.isFunction(i)&&i.apply(null,arguments))}),e._.publishToSession(this),e},this.unpublish=function(e){return e?void e._.unpublishFromSession(this,"unpublished"):void t.error("OT.Session.unpublish: publisher parameter missing.")},this.subscribe=function(e,n,i,r){if("function"==typeof n&&(r=n,n=void 0,i=void 0),"function"==typeof i&&(r=i,i=void 0),!this.connection||!this.connection.connectionId)return void S(t.ExceptionCodes.UNABLE_TO_SUBSCRIBE,"Session.subscribe :: Connection required to subscribe",r);if(!e)return void S(t.ExceptionCodes.UNABLE_TO_SUBSCRIBE,"Session.subscribe :: stream cannot be null",r);if(!e.hasOwnProperty("streamId"))return void S(t.ExceptionCodes.UNABLE_TO_SUBSCRIBE,"Session.subscribe :: invalid stream object",r);var o=new t.Subscriber(n,t.$.extend(i||{},{stream:e,session:this}),function(e){if(e){var n,i,o=[400,403];!e.code&&t.$.arrayIndexOf(o,e.code)>-1?(n=t.OT.ExceptionCodes.UNABLE_TO_SUBSCRIBE,i="Session.subscribe :: "+e.message):(n=t.ExceptionCodes.UNEXPECTED_SERVER_RESPONSE,i="Unexpected server response. Try this operation again later."),S(n,i,r)}else r&&t.$.isFunction(r)&&r.apply(null,arguments)});return t.subscribers.add(o),o},this.unsubscribe=function(e){if(!e){var n="OT.Session.unsubscribe: subscriber cannot be null";throw t.error(n),new Error(n)}return e.stream?(t.debug("OT.Session.unsubscribe: subscriber "+e.id),e.destroy(),!0):(t.warn("OT.Session.unsubscribe:: tried to unsubscribe a subscriber that had no stream"),!1)},this.getSubscribersForStream=function(e){return t.subscribers.where({streamId:e.id})},this.getPublisherForStream=function(e){var n,i;if("string"==typeof e)n=e;else{if("object"!=typeof e||!e||!e.hasOwnProperty("id"))throw i="Session.getPublisherForStream :: Invalid stream type",t.error(i),new Error(i);n=e.id}return t.publishers.where({streamId:n})[0]},this._={jsepCandidateP2p:function(e,t,n){return o.jsepCandidateP2p(e,t,n)},jsepCandidate:function(e,t){return o.jsepCandidate(e,t)},jsepOffer:function(e,t){return o.jsepOffer(e,t)},jsepOfferP2p:function(e,t,n){return o.jsepOfferP2p(e,t,n)},jsepAnswer:function(e,t){return o.jsepAnswer(e,t)},jsepAnswerP2p:function(e,t,n){return o.jsepAnswerP2p(e,t,n)},dispatchSignal:t.$.bind(function(e,n,i){var r=new t.SignalEvent(n,i,e);r.target=this,this.trigger(t.Event.names.SIGNAL,r),n&&this.dispatchEvent(r)},this),subscriberCreate:function(e,t,n,i){return o.subscriberCreate(e.id,t.widgetId,n,i)},subscriberDestroy:function(e,t){return o.subscriberDestroy(e.id,t.widgetId)},subscriberUpdate:function(e,t,n){return o.subscriberUpdate(e.id,t.widgetId,n)},subscriberChannelUpdate:function(e,t,n,i){return o.subscriberChannelUpdate(e.id,t.widgetId,n.id,i)},streamCreate:function(e,n,i,r,s){o.streamCreate(e,n,i,r,t.Config.get("bitrates","min",t.APIKEY),t.Config.get("bitrates","max",t.APIKEY),s)},streamDestroy:function(e){o.streamDestroy(e)},streamChannelUpdate:function(e,t,n){o.streamChannelUpdate(e.id,t.id,n)}},this.signal=function(e,n){var i=e,r=n;if(t.$.isFunction(i)&&(r=i,i=null),this.isNot("connected")){var s="Unable to send signal - you are not connected to the session.";return void S(500,s,r)}o.signal(i,r,this.logEvent),e&&e.data&&"string"!=typeof e.data&&t.warn("Signaling of anything other than Strings is deprecated. Please update the data property to be a string.")},this.forceDisconnect=function(e,n){if(this.isNot("connected")){var i="Cannot call forceDisconnect(). You are not connected to the session.";return void S(t.ExceptionCodes.NOT_CONNECTED,i,n)}var r="This token does not allow forceDisconnect. The role must be at least `moderator` to enable this functionality";if($("forceDisconnect")){var s="string"==typeof e?e:e.id;o.forceDisconnect(s,function(e){e?S(t.ExceptionCodes.UNABLE_TO_FORCE_DISCONNECT,r,n):n&&t.$.isFunction(n)&&n.apply(null,arguments)})}else S(t.ExceptionCodes.UNABLE_TO_FORCE_DISCONNECT,r,n)},this.forceUnpublish=function(e,n){if(this.isNot("connected")){var i="Cannot call forceUnpublish(). You are not connected to the session.";return void S(t.ExceptionCodes.NOT_CONNECTED,i,n)}var r="This token does not allow forceUnpublish. The role must be at least `moderator` to enable this functionality";if($("forceUnpublish")){var s="string"==typeof e?this.streams.get(e):e;o.forceUnpublish(s.id,function(e){e?S(t.ExceptionCodes.UNABLE_TO_FORCE_UNPUBLISH,r,n):n&&t.$.isFunction(n)&&n.apply(null,arguments)})}else S(t.ExceptionCodes.UNABLE_TO_FORCE_UNPUBLISH,r,n)},this.getStateManager=function(){t.warn("Fixme: Have not implemented session.getStateManager")},this.isConnected=function(){return this.is("connected")},this.capabilities=new t.Capabilities([])};var L={audio:!0,video:!0};t.Publisher=function(n){if(!t.checkSystemRequirements())return void t.upgradeSystemRequirements();var i,r,o,s,a,l,c,u,h,d,p,f,g,m,v,b,y,w,_=t.Publisher.nextId(),x={},C=!1,$=[1,7,15,30],k=t.$.hasCapabilities("webAudio"),S=n&&("screen"===n.videoSource||"window"===n.videoSource||"tab"===n.videoSource||"browser"===n.videoSource||"application"===n.videoSource),T=this;if(f=t.$.defaults(n||{},{publishAudio:S?!1:!0,publishVideo:!0,mirror:S?!1:!0,showControls:!0,fitMode:S?"contain":"cover",audioFallbackEnabled:S?!1:!0,maxResolution:S?{width:1920,height:1920}:void 0}),g={"320x240":{width:320,height:240},"640x480":{width:640,height:480},"1280x720":{width:1280,height:720}},S&&"https:"!==e.location.protocol&&t.warn("Screen Sharing typically requires pages to be loadever over HTTPS - unless this browser is configured locally to allow non-SSL pages, permission will be denied without user input."),m={timeStamp:t.$.now()},t.$.eventing(this),!S&&k){y=new t.AnalyserAudioLevelSampler(t.audioContext());var E=new t.IntervalRunner(function(){y.sample(function(e){t.$.requestAnimationFrame(function(){T.dispatchEvent(new t.AudioLevelUpdatedEvent(e))})})},60);this.on({"audioLevelUpdated:added":function(e){1===e&&E.start()},"audioLevelUpdated:removed":function(e){0===e&&E.stop()}})}var D=function(e,n,i,r){t.analytics.logEvent({action:e,variation:n,payload:i,sessionId:c?c.sessionId:null,connectionId:c&&c.isConnected()?c.connection.connectionId:null,partnerId:c?c.apiKey:t.APIKEY,streamId:a},r)},A=function(e,n){"Attempt"!==e&&w||(w=new t.ConnectivityAttemptPinger({action:"Publish",sessionId:c?c.sessionId:null,connectionId:c&&c.isConnected()?c.connection.connectionId:null,partnerId:c?c.apiKey:t.APIKEY,streamId:a})),"Failure"===e&&"Non-fatal"!==n.reason&&w.setVariation(e),D("Publish",e,n)},O=t.$.bind(function(e,n){var i={streamType:"WebRTC",sessionId:c?c.sessionId:null,connectionId:c&&c.isConnected()?c.connection.connectionId:null,partnerId:c?c.apiKey:t.APIKEY,streamId:a,width:r?Number(t.$.width(r.domElement).replace("px","")):void 0,height:r?Number(t.$.height(r.domElement).replace("px","")):void 0,version:t.properties.version,mediaServerName:c?c.sessionInfo.messagingServer:null,p2pFlag:c?c.sessionInfo.p2pEnabled:!1,duration:u?(new Date).getTime()-u.getTime():0,remoteConnectionId:e.id};t.analytics.logQOS(t.$.extend(i,n)),this.trigger("qos",n)},this),I=function(e){t.error("Publisher State Change Failed: ",e.message),t.debug(e)},M=t.$.bind(function(){v.isDestroyed()||(t.debug("OT.Publisher.onLoaded"),v.set("MediaBound"),r.loading(this.session?!s:!1),C=!0,X.call(this),this.trigger("initSuccess"),this.trigger("loaded",this))},this),P=t.$.bind(function(e){var n=t.ExceptionCodes.P2P_CONNECTION_FAILED,i={reason:"Publisher PeerConnection Error: ",code:n,message:e};A("Failure",i),v.set("Failed"),this.trigger("publishComplete",new t.Error(n,"Publisher PeerConnection Error: "+e)),t.handleJsException("Publisher PeerConnection Error: "+e,t.ExceptionCodes.P2P_CONNECTION_FAILED,{session:c,target:this})},this),R=t.$.bind(function(e){t.debug("OT.Publisher.onStreamAvailable"),v.set("BindingMedia"),V(),l=e,h=new t.Microphone(l,!f.publishAudio),this.publishVideo(f.publishVideo&&l.getVideoTracks().length>0),this.accessAllowed=!0,this.dispatchEvent(new t.Event(t.Event.names.ACCESS_ALLOWED,!1));var n={muted:!0,error:W};o=r.bindVideo(l,n,function(e){return e?void P(e):void M()}),y&&l.getAudioTracks().length>0&&y.webRTCStream(l)},this),N=t.$.bind(function(e){t.error("OT.Publisher.onStreamAvailableError "+e.name+": "+e.message),v.set("Failed"),this.trigger("publishComplete",new t.Error(t.ExceptionCodes.UNABLE_TO_PUBLISH,e.message)),r&&r.destroy();var n={reason:"GetUserMedia",code:t.ExceptionCodes.UNABLE_TO_PUBLISH,message:"Publisher failed to access camera/mic: "+e.message};A("Failure",n),t.handleJsException(n.reason,n.code,{session:c,target:this})},this),F=t.$.bind(function(e){t.error("OT.Publisher.onScreenSharingError "+e.message),v.set("Failed"),this.trigger("publishComplete",new t.Error(t.ExceptionCodes.UNABLE_TO_PUBLISH,"Screensharing: "+e.message));var n={reason:"ScreenSharing",message:e.message};A("Failure",n)},this),j=t.$.bind(function(e){t.error("OT.Publisher.onStreamAvailableError Permission Denied"),v.set("Failed");var n="Publisher Access Denied: Permission Denied"+(e.message?": "+e.message:""),i=t.ExceptionCodes.UNABLE_TO_PUBLISH;this.trigger("publishComplete",new t.Error(i,n));var r={reason:"GetUserMedia",code:i,message:n};A("Failure",r),this.dispatchEvent(new t.Event(t.Event.names.ACCESS_DENIED))},this),U=t.$.bind(function(){D("accessDialog","Opened"),this.dispatchEvent(new t.Event(t.Event.names.ACCESS_DIALOG_OPENED,!0))},this),H=t.$.bind(function(){D("accessDialog","Closed"),this.dispatchEvent(new t.Event(t.Event.names.ACCESS_DIALOG_CLOSED,!1))},this),W=t.$.bind(function(e,n){t.error("OT.Publisher.onVideoError");var i=n+(e?" ("+e+")":"");D("stream",null,{reason:"Publisher while playing stream: "+i}),v.set("Failed"),v.isAttemptingToPublish()?this.trigger("publishComplete",new t.Error(t.ExceptionCodes.UNABLE_TO_PUBLISH,i)):this.trigger("error",i),t.handleJsException("Publisher error playing stream: "+i,t.ExceptionCodes.UNABLE_TO_PUBLISH,{session:c,target:this})},this),B=t.$.bind(function(e){t.debug("OT.Subscriber has been disconnected from the Publisher's PeerConnection"),this.cleanupSubscriber(e.remoteConnection().id)},this),z=t.$.bind(function(e,n,i,r){var o;o="ICEWorkflow"===r?t.ExceptionCodes.PUBLISHER_ICE_WORKFLOW_FAILED:t.ExceptionCodes.UNABLE_TO_PUBLISH;var s={reason:r?r:"PeerConnectionError",code:o,message:(r?r:"")+":Publisher PeerConnection with connection "+(i&&i.remoteConnection&&i.remoteConnection().id)+" failed: "+n,hasRelayCandidates:i.hasRelayCandidates()};v.isPublishing()?s.reason="Non-fatal":this.trigger("publishComplete",new t.Error(t.ExceptionCodes.UNABLE_TO_PUBLISH,s.message)),A("Failure",s),t.handleJsException("Publisher PeerConnection Error: "+n,o,{session:c,target:this}),delete x[i.remoteConnection().id]},this),q=t.$.bind(function(e){this.stream=s=e,s.on("destroyed",this.disconnect,this),v.set("Publishing"),r.loading(!C),u=new Date,this.trigger("publishComplete",null,this),this.dispatchEvent(new t.StreamEvent("streamCreated",e,null,!1));var n={streamType:"WebRTC"};A("Success",n)},this),V=function(){l&&(l.stop(),l=null)},Y=t.$.bind(function(e){var n=x[e.id];if(!n){var i=t.$.now();D("createPeerConnection","Attempt"),e.on("destroyed",t.$.bind(this.cleanupSubscriber,this,e.id)),n=x[e.id]=new t.PublisherPeerConnection(e,c,a,l,f.channels),n.on({connected:function(){var e={pcc:parseInt(t.$.now()-i,10),hasRelayCandidates:n.hasRelayCandidates()};D("createPeerConnection","Success",e)},disconnected:B,error:z,qos:O},this),n.init(b)}return n},this),G=function(e){if(e===!1)return"off";var t=this.getStyle("buttonDisplayMode");return t===!1?"on":t},K=function(e,t){if(d)switch(e){case"nameDisplayMode":d.name.setDisplayMode(t),d.backingBar.setNameMode(t);break;case"showArchiveStatus":D("showArchiveStatus","styleChange",{mode:t?"on":"off"}),d.archive.setShowArchiveStatus(t);break;case"buttonDisplayMode":d.muteButton.setDisplayMode(t),d.backingBar.setMuteMode(t);break;case"audioLevelDisplayMode":d.audioLevel.setDisplayMode(t);break;case"backgroundImageURI":r.setBackgroundImageURI(t)}},X=function(){this.getStyle("showArchiveStatus")||D("showArchiveStatus","createChrome",{mode:"off"});var e={backingBar:new t.Chrome.BackingBar({nameMode:f.name?this.getStyle("nameDisplayMode"):"off",muteMode:G.call(this,this.getStyle("buttonDisplayMode"))}),name:new t.Chrome.NamePanel({name:f.name,mode:this.getStyle("nameDisplayMode")}),muteButton:new t.Chrome.MuteButton({muted:f.publishAudio===!1,mode:G.call(this,this.getStyle("buttonDisplayMode"))}),archive:new t.Chrome.Archiving({show:this.getStyle("showArchiveStatus"),archiving:!1})};if(k){var n=new t.AudioLevelTransformer,i=function(e){p.setValue(n.transform(e.audioLevel))};p=new t.Chrome.AudioLevelMeter({mode:this.getStyle("audioLevelDisplayMode"),onActivate:function(){T.on("audioLevelUpdated",i)},onPassivate:function(){T.off("audioLevelUpdated",i)}}),e.audioLevel=p}d=new t.Chrome({parent:r.domElement}).set(e).on({muted:t.$.bind(this.publishAudio,this,!1),unmuted:t.$.bind(this.publishAudio,this,!0)}),p&&"auto"===this.getStyle("audioLevelDisplayMode")&&p[r.audioOnly()?"show":"hide"]()},Q=t.$.bind(function(){d&&(d.destroy(),d=null),this.disconnect(),h=null,o&&(o.destroy(),o=null),V(),r&&(r.destroy(),r=null),c&&this._.unpublishFromSession(c,"reset"),this.id=i=null,this.stream=s=null,C=!1,this.session=c=null,v.isDestroyed()||v.set("NotPublishing")},this);t.StylableComponent(this,{showArchiveStatus:!0,nameDisplayMode:"auto",buttonDisplayMode:"auto",audioLevelDisplayMode:S?"off":"auto",backgroundImageURI:null},f.showControls,function(e){D("SetStyle","Publisher",e,.1)});var J=function(e){r&&(r.audioOnly(e),r.showPoster(e)),p&&"auto"===T.getStyle("audioLevelDisplayMode")&&p[e?"show":"hide"]()};this.publish=function(e){if(t.debug("OT.Publisher: publish"),(v.isAttemptingToPublish()||v.isPublishing())&&Q(),v.set("GetUserMedia"),f.constraints)t.warn("You have passed your own constraints not using ours");else if(f.constraints=t.$.clone(L),S&&(null!=f.audioSource&&t.warn("Invalid audioSource passed to Publisher - when using screen sharing no audioSource may be used"),f.audioSource=null),null===f.audioSource||f.audioSource===!1?(f.constraints.audio=!1,f.publishAudio=!1):("object"==typeof f.audioSource&&(null!=f.audioSource.deviceId?f.audioSource=f.audioSource.deviceId:t.warn("Invalid audioSource passed to Publisher. Expected either a device ID")),f.audioSource&&("object"!=typeof f.constraints.audio&&(f.constraints.audio={}),f.constraints.audio.mandatory||(f.constraints.audio.mandatory={}),f.constraints.audio.optional||(f.constraints.audio.optional=[]),f.constraints.audio.mandatory.sourceId=f.audioSource)),null===f.videoSource||f.videoSource===!1)f.constraints.video=!1,f.publishVideo=!1;else{"object"==typeof f.videoSource&&null==f.videoSource.deviceId&&(t.warn("Invalid videoSource passed to Publisher. Expected either a device ID or device."),f.videoSource=null);var o=function(){"object"!=typeof f.constraints.video&&(f.constraints.video={}),f.constraints.video.mandatory||(f.constraints.video.mandatory={}),f.constraints.video.optional||(f.constraints.video.optional=[])};if(f.videoSource){o();var a=f.constraints.video.mandatory;S||(a.sourceId=null!=f.videoSource.deviceId?f.videoSource.deviceId:f.videoSource)}f.resolution&&(g.hasOwnProperty(f.resolution)?(f.videoDimensions=g[f.resolution],o(),"Chrome"===t.$.env.name&&(f.constraints.video.optional=f.constraints.video.optional.concat([{minWidth:f.videoDimensions.width},{maxWidth:f.videoDimensions.width},{minHeight:f.videoDimensions.height},{maxHeight:f.videoDimensions.height}]))):t.warn("Invalid resolution passed to the Publisher. Got: "+f.resolution+' expecting one of "'+t.$.keys(g).join('","')+'"')),f.maxResolution&&(o(),f.maxResolution.width>1920&&(t.warn("Invalid maxResolution passed to the Publisher. maxResolution.width must be less than or equal to 1920"),f.maxResolution.width=1920),f.maxResolution.height>1920&&(t.warn("Invalid maxResolution passed to the Publisher. maxResolution.height must be less than or equal to 1920"),f.maxResolution.height=1920),f.videoDimensions=f.maxResolution,"Chrome"===t.$.env.name&&(o(),f.constraints.video.mandatory.maxWidth=f.videoDimensions.width,f.constraints.video.mandatory.maxHeight=f.videoDimensions.height)),void 0!==f.frameRate&&-1===t.$.arrayIndexOf($,f.frameRate)?(t.warn("Invalid frameRate passed to the publisher got: "+f.frameRate+" expecting one of "+$.join(",")),delete f.frameRate):f.frameRate&&(o(),f.constraints.video.optional=f.constraints.video.optional.concat([{minFrameRate:f.frameRate},{maxFrameRate:f.frameRate}]))}return f.style&&this.setStyle(f.style,null,!0),f.name&&(f.name=f.name.toString()),f.classNames="OT_root OT_publisher",t.onLoad(function(){r=new t.WidgetView(e,f),T.id=i=r.domId(),T.element=r.domElement,r.on("videoDimensionsChanged",function(e,n){s&&s.setVideoDimensions(n.width,n.height),T.dispatchEvent(new t.VideoDimensionsChangedEvent(T,e,n))}),r.on("mediaStopped",function(){var e=new t.MediaStoppedEvent(T);T.dispatchEvent(e,function(){e.isDefaultPrevented()||(c?T._.unpublishFromSession(c,"mediaStopped"):T.destroy("mediaStopped"))})}),t.$.waterfall([function(e){S?t.checkScreenSharingCapability(function(i){if(i.supported)if(i.extensionRegistered===!1)F(new Error("Screen Sharing suppor in this browser requires an extension, but one has not been registered."));else if(i.extensionInstalled===!1)F(new Error("Screen Sharing suppor in this browser requires an extension, but the extension is not installed."));else{var r=t.pickScreenSharingHelper();r.proto.getConstraintsShowsPermissionUI&&U(),r.instance.getConstraints(n.videoSource,f.constraints,function(t,n){r.proto.getConstraintsShowsPermissionUI&&H(),t?"PermissionDeniedError"===t.message?j(t):F(t):(f.constraints=n,e())})}else F(new Error("Screen Sharing is not supported in this browser"))}):t.$.shouldAskForDevices(function(n){n.video||(t.warn("Setting video constraint to false, there are no video sources"),f.constraints.video=!1),n.audio||(t.warn("Setting audio constraint to false, there are no audio sources"),f.constraints.audio=!1),e()})},function(){v.isDestroyed()||t.$.getUserMedia(f.constraints,R,N,U,H,j)}])},this),this},this.publishAudio=function(e){return f.publishAudio=e,h&&h.muted(!e),d&&d.muteButton.muted(!e),c&&s&&s.setChannelActiveState("audio",e),this},this.publishVideo=function(e){var t=f.publishVideo;if(f.publishVideo=e,c&&s&&f.publishVideo!==t&&s.setChannelActiveState("video",e),l)for(var n=l.getVideoTracks(),i=0,r=n.length;r>i;++i)n[i].setEnabled(e);return J(!e),this},this.destroy=function(e,n){return v.isDestroyed()?void 0:(v.set("Destroyed"),Q(),n!==!0&&this.dispatchEvent(new t.DestroyedEvent(t.Event.names.PUBLISHER_DESTROYED,this,e),t.$.bind(this.off,this)),this)},this.disconnect=function(){for(var e in x)this.cleanupSubscriber(e)},this.cleanupSubscriber=function(e){var t=x[e];t&&(t.destroy(),delete x[e],D("disconnect","PeerConnection",{subscriberConnection:e}))},this.processMessage=function(e,n,i){switch(t.debug("OT.Publisher.processMessage: Received "+e+" from "+n.id),t.debug(i),e){case"unsubscribe":this.cleanupSubscriber(i.content.connection.id);break;default:var r=Y(n);r.processMessage(e,i)}},this.getImgData=function(){return C?o.imgData():(t.error("OT.Publisher.getImgData: Cannot getImgData before the Publisher is publishing."),null)},this._={publishToSession:t.$.bind(function(e){this.session=c=e,a=t.$.uuid();var n=function(){var n,i;if(c){v.set("PublishingToSession");var r=t.$.bind(function(e,n,i){if(e){var r,o,s=[403,404,409];e.code&&t.$.arrayIndexOf(s,e.code)>-1?(r=t.ExceptionCodes.UNABLE_TO_PUBLISH,o=e.message):(r=t.ExceptionCodes.UNEXPECTED_SERVER_RESPONSE,o="Unexpected server response. Try this operation again later.");var l={reason:"Publish",code:r,message:o};return A("Failure",l),v.isAttemptingToPublish()&&this.trigger("publishComplete",new t.Error(r,o)),void t.handleJsException(e.message,r,{session:c,target:this})}this.streamId=a=n,b=t.Raptor.parseIceServers(i)},this);f.videoDimensions?(n=Math.min(f.videoDimensions.width,o.videoWidth()||640),i=Math.min(f.videoDimensions.height,o.videoHeight()||480)):(n=o.videoWidth()||640,i=o.videoHeight()||480);var s=[];null!==f.videoSource&&f.videoSource!==!1&&s.push(new t.StreamChannel({id:"video1",type:"video",active:f.publishVideo,orientation:t.VideoOrientation.ROTATED_NORMAL,frameRate:f.frameRate,width:n,height:i,source:S?"screen":"camera",fitMode:f.fitMode})),null!==f.audioSource&&f.audioSource!==!1&&s.push(new t.StreamChannel({id:"audio1",type:"audio",active:f.publishAudio})),e._.streamCreate(f.name||"",a,f.audioFallbackEnabled,s,r)}};return C?n.call(this):this.on("initSuccess",n,this),A("Attempt",{streamType:"WebRTC"}),this},this),unpublishFromSession:t.$.bind(function(e,n){return c&&e.id===c.id?(e.isConnected()&&this.stream&&e._.streamDestroy(this.stream.id),this.disconnect(),this.session=c=null,v.isDestroyed()||v.set("MediaBound"),w&&w.stop(),D("unpublish","Success",{sessionId:e.id}),this._.streamDestroyed(n),this):(t.warn("The publisher "+_+" is trying to unpublish from a session "+e.id+" it is not attached to (it is attached to "+(c&&c.id||"no session")+")"),this)},this),streamDestroyed:t.$.bind(function(e){if(t.$.arrayIndexOf(["reset"],e)<0){var n=new t.StreamEvent("streamDestroyed",s,e,!0),i=t.$.bind(function(){n.isDefaultPrevented()||this.destroy()},this);this.dispatchEvent(n,i)}},this),archivingStatus:t.$.bind(function(e){
return d&&d.archive.setArchiving(e),e},this),webRtcStream:function(){return l},switchTracks:function(){return new Promise(function(e,n){t.$.getUserMedia(f.constraints,function(i){V(),l=i,h=new t.Microphone(l,!f.publishAudio);var s={muted:!0,error:W};o=r.bindVideo(l,s,function(e){e&&(P(e),n(e))}),y&&l.getAudioTracks().length>0&&y.webRTCStream(l);var a=[];Object.keys(x).forEach(function(e){var t=x[e];t.getSenders().forEach(function(e){"audio"===e.track.kind&&i.getAudioTracks().length?a.push(e.switchTracks(i.getAudioTracks()[0])):"video"===e.track.kind&&i.getVideoTracks().length&&a.push(e.switchTracks(i.getVideoTracks()[0]))})}),Promise.all(a).then(e,n)},function(e){N(e),n(e)},U,H,function(e){j(e),n(e)})})},switchAcquiredWindow:function(e){if("Firefox"!==t.$.env.name||t.$.env.version<38)throw new Error("switchAcquiredWindow is an experimental method and is not supported bythe current platform");"undefined"!=typeof e&&(f.constraints.video.browserWindow=e),D("SwitchAcquiredWindow","Attempt",{constraints:f.constraints});var n=T._.switchTracks();return n.then(function(){D("SwitchAcquiredWindow","Success",{constraints:f.constraints})},function(e){D("SwitchAcquiredWindow","Failure",{error:e,constraints:f.constraints})}),n},getDataChannel:function(e,n,i){var r=x[t.$.keys(x)[0]];return r?void r.getDataChannel(e,n,i):void i(new t.$.Error("Cannot create a DataChannel before there is a subscriber."))}},this.detectDevices=function(){t.warn("Fixme: Haven't implemented detectDevices")},this.detectMicActivity=function(){t.warn("Fixme: Haven't implemented detectMicActivity")},this.getEchoCancellationMode=function(){return t.warn("Fixme: Haven't implemented getEchoCancellationMode"),"fullDuplex"},this.setMicrophoneGain=function(){t.warn("Fixme: Haven't implemented setMicrophoneGain")},this.getMicrophoneGain=function(){return t.warn("Fixme: Haven't implemented getMicrophoneGain"),.5},this.setCamera=function(){t.warn("Fixme: Haven't implemented setCamera")},this.setMicrophone=function(){t.warn("Fixme: Haven't implemented setMicrophone")},this.guid=function(){return _},this.videoElement=function(){return o.domElement()},this.setStream=q,this.isWebRTC=!0,this.isLoading=function(){return r&&r.loading()},this.videoWidth=function(){return o.videoWidth()},this.videoHeight=function(){return o.videoHeight()},this.on("styleValueChanged",K,this),v=new t.PublishingState(I),this.accessAllowed=!1},t.Publisher.nextId=t.$.uuid,t.initSession=function(e,n){null==n&&(n=e,e=null),t.$.isArray(n)&&1===n.length&&(n=n[0]);var i=t.sessions.get(n);return i||(i=new t.Session(e,n),t.sessions.add(i)),i},t.initPublisher=function(e,n,i){t.debug("OT.initPublisher("+e+")"),"string"!=typeof e||document.getElementById(e)||(e=n,n=i,i=arguments[3]),"function"==typeof e?(i=e,n=void 0,e=void 0):t.$.isObject(e)&&!t.$.isElementNode(e)&&(i=n,n=e,e=void 0),"function"==typeof n&&(i=n,n=void 0);var r=new t.Publisher(n);t.publishers.add(r);var o=function(e){e?t.dispatchError(e.code,e.message,i,r.session):i&&t.$.isFunction(i)&&i.apply(null,arguments)},s=function(e){r.off("publishComplete",a),o(e)},a=function(e){r.off("initSuccess",s),e&&o(e)};return r.once("initSuccess",s),r.once("publishComplete",a),r.publish(e),r},t.getDevices=function(e){t.$.getMediaDevices(e)},t.reportIssue=function(){t.warn("ToDo: haven't yet implemented OT.reportIssue")},t.components={},t.onUnload(function(){t.publishers.destroy(),t.subscribers.destroy(),t.sessions.destroy("unloaded")}),O(t.properties.cssURL),"function"==typeof define&&define.amd&&define("TB",[],function(){return TB})}(e,e.OT)}(window||exports);var OTChromeScreenSharingExtensionHelper=function(e){if(!e)throw new Error("initChromeScreenSharingExtensionHelper: extensionID is required.");var t=!!navigator.webkitGetUserMedia&&"undefined"!=typeof chrome,n={},i=void 0,r="com.tokbox.screenSharing."+e,o=function(e,t){var n={payload:t,from:"jsapi"};return n[r]=e,n},s=function(e,t){var i,r=OT.$.uuid();return n[r]=function(){clearTimeout(i),i=null,e.apply(null,arguments)},t&&(i=setTimeout(function(){delete n[r],e(new Error("Timeout waiting for response to request."))},t)),r},a=function(e){if(!e)throw new Error("isAvailable: callback is required.");if(t||setTimeout(e.bind(null,!1)),void 0!==i)setTimeout(e.bind(null,i));else{var n=s(function(t,n,r){i!==!0&&(i="extensionLoaded"===n),e(i)},2e3),r=o("isExtensionInstalled",{requestId:n});window.postMessage(r,"*")}},l=function(e){if(!e)throw new Error("getSourceId: callback is required");a(function(t){if(t){var n=s(function(t,n,i){"permissionDenied"===n?e(new Error("PermissionDeniedError")):e(void 0,{kind:"chromeScreenSharing",deviceId:i.sourceId,label:"Screen Sharing"})});window.postMessage(o("getSourceId",{requestId:n}),"*")}else e(new Error("Extension is not installed"))})};return window.addEventListener("message",function(e){if(e.origin==window.location.origin&&null!=e.data&&"object"==typeof e.data&&"extension"===e.data.from){var t=e.data[r],o=e.data.payload;if(o&&o.requestId){var s=n[o.requestId];delete n[o.requestId],s&&s(null,t,o)}"extensionLoaded"===t&&(i=!0)}}),{isAvailable:a,getVideoSource:l}};if(function(){var e=function(e,t,n,i,r,o){var s={left:t+"px",top:n+"px",width:i+"px",height:r+"px"},a=function(){var t=e.querySelector(".OT_root");if(t){var n=t.style.width;t.style.width=i+"px",t.style.width=n||""}};o&&$?($(e).stop(),$(e).animate(s,o.duration||200,o.easing||"swing",function(){a(),o.complete&&o.complete.call(this)})):OT.$.css(e,s),a()},t=function(e,t){var n=OT.$.css(e,t);return n?parseInt(n,10):0},n=function(e){var t=OT.$.height(e);return t?parseInt(t,10):0},i=function(e){var t=OT.$.width(e);return t?parseInt(t,10):0},r=function(n,i,r,o,s,a,l,c,u){var h,d=n.length,p=function(e,t){for(var n,o,s,a,l,c,u,p=1;d>=p;p++){var f=p,g=Math.ceil(d/f);u=Math.floor(r/g),c=Math.floor(i/f),tRatio=u/c,tRatio>t?(tRatio=t,u=c*tRatio):tRatio<e&&(tRatio=e,c=u/tRatio);var m=c*u*d;(void 0===n||m>n)&&(n=m,a=u,l=c,o=f,s=g)}return{maxArea:n,targetCols:o,targetRows:s,targetHeight:a,targetWidth:l,ratio:h}};if(a){var f=n.length>0&&n[0].querySelector("video");h=f&&f.videoHeight&&f.videoWidth?p(f.videoHeight/f.videoWidth,f.videoHeight/f.videoWidth):p(.75,.75)}else h=p(l,c);for(var g=h.targetRows*h.targetCols-d,m=g*h.targetWidth/2,v=(h.targetRows-1)*h.targetCols,b=(r-h.targetRows*h.targetHeight)/2,y=(i-h.targetCols*h.targetWidth)/2,w=0,_=0,x=0;x<n.length;x++){var C=n[x];x%h.targetCols===0?(w=y,x==v&&(w+=m),_+=0===x?b:h.targetHeight):w+=h.targetWidth,OT.$.css(C,"position","absolute");var $=h.targetWidth-t(C,"paddingLeft")-t(C,"paddingRight")-t(C,"marginLeft")-t(C,"marginRight")-t(C,"borderLeft")-t(C,"borderRight"),k=h.targetHeight-t(C,"paddingTop")-t(C,"paddingBottom")-t(C,"marginTop")-t(C,"marginBottom")-t(C,"borderTop")-t(C,"borderBottom");e(C,w+o,_+s,$,k,u)}},o=function(e){return"none"!==OT.$.css(e,"display")},s=function(e,s,a){if("none"!==OT.$.css(e,"display")){var l=e.getAttribute("id");l||(l="OT_"+OT.$.uuid(),e.setAttribute("id",l));var c=n(e)-t(e,"borderTop")-t(e,"borderBottom"),u=i(e)-t(e,"borderLeft")-t(e,"borderRight"),h=c/u,d=0,p=0,f=0,g=0,m=Array.prototype.filter.call(e.querySelectorAll("#"+l+">."+s.bigClass),o),v=Array.prototype.filter.call(e.querySelectorAll("#"+l+">*:not(."+s.bigClass+")"),o);if(m.length>0&&v.length>0){var b=m[0].querySelector("video");bigRatio=b&&b.videoHeight&&b.videoWidth?b.videoHeight/b.videoWidth:.75;var y,w;h>bigRatio?(y=u,w=Math.min(Math.floor(c*s.bigPercentage),u*bigRatio),p=w,f=c-p):(w=c,y=Math.min(u*s.bigPercentage,Math.floor(w/bigRatio)),d=y,g=u-d),s.bigFirst?(r(m,y,w,0,0,s.bigFixedRatio,s.bigMinRatio,s.bigMaxRatio,s.animate),r(v,u-d,c-p,d,p,s.fixedRatio,s.minRatio,s.maxRatio,s.animate)):(r(v,u-d,c-p,0,0,s.fixedRatio,s.minRatio,s.maxRatio,s.animate),r(m,y,w,g,f,s.bigFixedRatio,s.bigMinRatio,s.bigMaxRatio,s.animate))}else m.length>0&&0===v.length?r(m,u,c,0,0,s.bigFixedRatio,s.bigMinRatio,s.bigMaxRatio,s.animate):r(v,u-d,c-p,d,p,s.fixedRatio,s.minRatio,s.maxRatio,s.animate)}};if(!TB)throw new Error("You must include the OpenTok for WebRTC JS API before the layout-container library");TB.initLayoutContainer=function(e,t){return t=OT.$.defaults(t||{},{maxRatio:1.5,minRatio:9/16,fixedRatio:!1,animate:!1,bigClass:"OT_big",bigPercentage:.8,bigFixedRatio:!1,bigMaxRatio:1.5,bigMinRatio:9/16,bigFirst:!0}),e="string"==typeof e?OT.$(e):e,OT.onLoad(function(){s(e,t)}),{layout:s.bind(null,e,t)}}}(),!window.TB)throw new Error("You must include the TB library before the TB_Angular library");var OpenTokAngular=angular.module("opentok",[]).factory("TB",function(){return TB}).factory("OTSession",["TB","$rootScope",function(e,t){var n={streams:[],connections:[],publishers:[],init:function(i,r,o,s){this.session=e.initSession(r),n.session.on({sessionConnected:function(e){n.publishers.forEach(function(e){n.session.publish(e)})},streamCreated:function(e){t.$apply(function(){n.streams.push(e.stream),console.log("Stream: ",e.stream)})},streamDestroyed:function(e){t.$apply(function(){n.streams.splice(n.streams.indexOf(e.stream),1)})},sessionDisconnected:function(e){t.$apply(function(){n.streams.splice(0,n.streams.length)})},connectionCreated:function(e){t.$apply(function(){n.connections.push(e.connection)})},connectionDestroyed:function(e){t.$apply(function(){n.connections.splice(n.connections.indexOf(e.connection),1)})}}),this.session.connect(i,o,function(e){s&&s(e,n.session)}),this.trigger("init")}};return e.$.eventing(n),n}]).directive("otLayout",["$window","$parse","TB","OTSession",function(e,t,n,i){return{restrict:"E",link:function(r,o,s){var a=t(s.props)(),l=n.initLayoutContainer(o[0],a);r.$watch(function(){return o.children().length},l.layout),e.addEventListener("resize",l.layout),r.$on("otLayout",l.layout);var c=function(e){i.session.on("streamPropertyChanged",function(e){"videoDimensions"===e.changedProperty&&l.layout()})};i.session?c():i.on("init",c)}}}]).directive("otPublisher",["OTSession",function(e){return{restrict:"E",scope:{muteAudio:"=",muteVideo:"=",username:"=",props:"&"},link:function(t,n,i){var r=t.props()||{};r.width=r.width?r.width:angular.element(n).width(),r.height=r.height?r.height:angular.element(n).height(),r.name=t.username,r.style.nameDisplayMode="on";var o=angular.element(n).children();t.publisher=TB.initPublisher(i.apikey||e.session.apiKey,n[0],r,function(e){e&&t.$emit("otPublisherError",e,t.publisher)}),angular.element(n).append(o),t.publisher.on({accessDenied:function(e){t.$emit("otAccessDenied")},accessDialogOpened:function(e){t.$emit("otAccessDialogOpened")},accessDialogClosed:function(e){t.$emit("otAccessDialogClosed")},accessAllowed:function(e){angular.element(n).addClass("allowed"),t.$emit("otAccessAllowed")},loaded:function(e){t.$emit("otLayout")},streamCreated:function(e){t.$emit("otStreamCreated")},streamDestroyed:function(e){t.$emit("otStreamDestroyed")}}),t.$watch("muteAudio",function(e){null!=e&&"undefined"!=typeof e&&t.publisher.publishAudio(1==e?!1:!0)}),t.$watch("muteVideo",function(e){null!=e&&"undefined"!=typeof e&&t.publisher.publishVideo(1==e?!1:!0)}),t.$on("$destroy",function(){e.session?e.session.unpublish(t.publisher):t.publisher.destroy(),e.publishers=e.publishers.filter(function(e){return e!==t.publisher}),t.publisher=null}),e.session&&(e.session.connected||e.session.isConnected&&e.session.isConnected())&&e.session.publish(t.publisher,function(e){e&&t.$emit("otPublisherError",e,t.publisher)}),e.publishers.push(t.publisher)}}}]).directive("otSubscriber",["OTSession",function(e){return{restrict:"E",scope:{stream:"=",props:"&"},link:function(t,n,i){var r=t.stream,o=t.props()||{};o.width=o.width?o.width:angular.element(n).width(),o.height=o.height?o.height:angular.element(n).height(),o.style.nameDisplayMode="on";var s=angular.element(n).children(),a=e.session.subscribe(r,n[0],o,function(e){e&&t.$emit("otSubscriberError",e,a)});a.on("loaded",function(){t.$emit("otLayout")}),angular.element(n).append(s),t.$on("$destroy",function(){e.session.unsubscribe(a)})}}}]);if(function(e,t){"use strict";function n(e){return{$setViewValue:function(e){this.$viewValue=e},$viewValue:e}}e.module("luegg.directives",[]).directive("scrollGlue",function(){return{priority:1,require:["?ngModel"],restrict:"A",link:function(e,t,i,r){function o(){a.scrollTop=a.scrollHeight}function s(){return a.scrollTop+a.clientHeight==a.scrollHeight}var a=t[0],l=r[0]||n(!0);e.$watch(function(){l.$viewValue&&o()}),t.bind("scroll",function(){e.$apply(l.$setViewValue.bind(l,s()))})}}})}(angular),function(){"use strict";function e(){function e(e){e.submitButtonText&&""!==e.submitButtonText||(e.submitButtonText="Send"),e.title||(e.title="Chat")}var n='<div class="row chat-window" style="margin-left:10px;" ng-style="vm.windowStyle"> <div class="panel panel-primary"><div class="panel-heading" id="accordion"><span class="glyphicon glyphicon-comment"></span> &nbsp; {{vm.title}}<div class="btn-group pull-right"><a type="button" class="btn btn-default blue-steel btn-xs" ng-click="vm.toggle()"  data-parent="#accordion" href="javascript:;"><span ng-class="vm.chatButtonClass"></span></a><a type="button" class="btn btn-default red btn-xs" ng-click="vm.close()"  href="javascript:;"><span class="glyphicon glyphicon-remove"></span></a></div></div><div class="panel-body" ng-style="vm.panelStyle"><ul class="chat"><li ng-repeat="message in vm.messages" class="clearfix" ng-class="vm.username === message.username ? \'right\' : \'left\'"><span class="chat-img" ng-class="vm.username === message.username ? \'pull-right\' : \'pull-left\'"><img class="img-circle" ng-if="vm.username !== message.username" ng-src="{{vm.chatImage}}" width="40" height="40" /><img class="img-circle" ng-if="vm.username === message.username" ng-src="{{vm.userImage}}" width="40" height="40" /></span><div class="chat-body clearfix"><div ng-if="vm.username !== message.username" class="header"><strong class="primary-font">{{message.username}}</strong><small class="pull-right text-muted"></small></div><div ng-if="vm.username === message.username" class="header"><small class=" text-muted"></small><strong class="pull-right primary-font">{{message.username}}</strong></div><p>{{message.content}}</p></div></li></ul></div><div class="panel-footer"><form ng-submit="vm.submitFunction()"><div class="input-group"><input id="btn-input" type="text" class="form-control input-sm" ng-model="vm.writingMessage" placeholder="Type your message here..." /><span class="input-group-btn"><input type="submit" class="btn btn-warning btn-sm" value="{{vm.submitButtonText}}" /></span></div></form></div></div></div>',i={restrict:"EA",template:n,replace:!0,scope:{messages:"=",username:"=",userImage:"=",chatImage:"=",submitButtonText:"@",title:"=",submitFunction:"&",isShow:"="},link:e,controller:t,controllerAs:"vm"};return i}function t(e){function t(){i.windowStyle={display:"none"},e.isShow=!1}function n(){r?(i.chatButtonClass="glyphicon glyphicon-chevron-down",i.panelStyle={display:"block"},r=!1):(i.chatButtonClass="glyphicon glyphicon-chevron-up",i.panelStyle={display:"none"},r=!0)}console.log(e.isShow);var i=this,r=!1;i.messages=e.messages,i.username=e.username,i.submitButtonText=e.submitButtonText,i.userImage=e.userImage,i.chatImage=e.chatImage,i.isShow=e.isShow,i.title=e.title,i.writingMessage="",i.submitFunction=function(){e.submitFunction()(i.writingMessage,i.username),i.writingMessage=""},i.windowStyle=1==e.isShow?{display:"block"}:{display:"none"},i.panelStyle={display:"block"},i.chatButtonClass="glyphicon glyphicon-chevron-down",i.toggle=n,i.close=t}angular.module("irontec.simpleChat",["luegg.directives"]),angular.module("irontec.simpleChat").directive("irontecSimpleChat",e),t.$inject=["$scope"]}(),function(e){e.color={},e.color.make=function(t,n,i,r){var o={};return o.r=t||0,o.g=n||0,o.b=i||0,o.a=null!=r?r:1,o.add=function(e,t){for(var n=0;n<e.length;++n)o[e.charAt(n)]+=t;return o.normalize()},o.scale=function(e,t){for(var n=0;n<e.length;++n)o[e.charAt(n)]*=t;return o.normalize()},o.toString=function(){return o.a>=1?"rgb("+[o.r,o.g,o.b].join(",")+")":"rgba("+[o.r,o.g,o.b,o.a].join(",")+")"},o.normalize=function(){function e(e,t,n){return e>t?e:t>n?n:t}return o.r=e(0,parseInt(o.r),255),o.g=e(0,parseInt(o.g),255),o.b=e(0,parseInt(o.b),255),o.a=e(0,o.a,1),o},o.clone=function(){return e.color.make(o.r,o.b,o.g,o.a)},o.normalize()},e.color.extract=function(t,n){var i;do{if(i=t.css(n).toLowerCase(),""!=i&&"transparent"!=i)break;t=t.parent()}while(t.length&&!e.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==i&&(i="transparent"),e.color.parse(i)},e.color.parse=function(n){var i,r=e.color.make;if(i=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return r(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10));if(i=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return r(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10),parseFloat(i[4]));if(i=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return r(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]));if(i=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return r(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]),parseFloat(i[4]));if(i=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return r(parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16));if(i=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return r(parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16));var o=e.trim(n).toLowerCase();return"transparent"==o?r(255,255,255,0):(i=t[o]||[0,0,0],r(i[0],i[1],i[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(e){function t(t,n){var i=n.children("."+t)[0];if(null==i&&(i=document.createElement("canvas"),i.className=t,e(i).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(n),!i.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");i=window.G_vmlCanvasManager.initElement(i)}this.element=i;var r=this.context=i.getContext("2d"),o=window.devicePixelRatio||1,s=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;this.pixelRatio=o/s,this.resize(n.width(),n.height()),this.textContainer=null,this.text={},this._textCache={}}function n(n,r,o,s){function a(e,t){t=[me].concat(t);for(var n=0;n<e.length;++n)e[n].apply(this,t)}function l(){for(var n={Canvas:t},i=0;i<s.length;++i){var r=s[i];r.init(me,n),r.options&&e.extend(!0,re,r.options)}}function c(t){e.extend(!0,re,t),t&&t.colors&&(re.colors=t.colors),null==re.xaxis.color&&(re.xaxis.color=e.color.parse(re.grid.color).scale("a",.22).toString()),null==re.yaxis.color&&(re.yaxis.color=e.color.parse(re.grid.color).scale("a",.22).toString()),null==re.xaxis.tickColor&&(re.xaxis.tickColor=re.grid.tickColor||re.xaxis.color),null==re.yaxis.tickColor&&(re.yaxis.tickColor=re.grid.tickColor||re.yaxis.color),null==re.grid.borderColor&&(re.grid.borderColor=re.grid.color),null==re.grid.tickColor&&(re.grid.tickColor=e.color.parse(re.grid.color).scale("a",.22).toString());var i,r,o,s=n.css("font-size"),l=s?+s.replace("px",""):13,c={style:n.css("font-style"),size:Math.round(.8*l),variant:n.css("font-variant"),weight:n.css("font-weight"),family:n.css("font-family")};for(o=re.xaxes.length||1,i=0;o>i;++i)r=re.xaxes[i],r&&!r.tickColor&&(r.tickColor=r.color),r=e.extend(!0,{},re.xaxis,r),re.xaxes[i]=r,r.font&&(r.font=e.extend({},c,r.font),r.font.color||(r.font.color=r.color),r.font.lineHeight||(r.font.lineHeight=Math.round(1.15*r.font.size)));for(o=re.yaxes.length||1,i=0;o>i;++i)r=re.yaxes[i],r&&!r.tickColor&&(r.tickColor=r.color),r=e.extend(!0,{},re.yaxis,r),re.yaxes[i]=r,r.font&&(r.font=e.extend({},c,r.font),r.font.color||(r.font.color=r.color),r.font.lineHeight||(r.font.lineHeight=Math.round(1.15*r.font.size)));for(re.xaxis.noTicks&&null==re.xaxis.ticks&&(re.xaxis.ticks=re.xaxis.noTicks),re.yaxis.noTicks&&null==re.yaxis.ticks&&(re.yaxis.ticks=re.yaxis.noTicks),re.x2axis&&(re.xaxes[1]=e.extend(!0,{},re.xaxis,re.x2axis),re.xaxes[1].position="top",null==re.x2axis.min&&(re.xaxes[1].min=null),null==re.x2axis.max&&(re.xaxes[1].max=null)),re.y2axis&&(re.yaxes[1]=e.extend(!0,{},re.yaxis,re.y2axis),re.yaxes[1].position="right",null==re.y2axis.min&&(re.yaxes[1].min=null),null==re.y2axis.max&&(re.yaxes[1].max=null)),re.grid.coloredAreas&&(re.grid.markings=re.grid.coloredAreas),re.grid.coloredAreasColor&&(re.grid.markingsColor=re.grid.coloredAreasColor),re.lines&&e.extend(!0,re.series.lines,re.lines),re.points&&e.extend(!0,re.series.points,re.points),re.bars&&e.extend(!0,re.series.bars,re.bars),null!=re.shadowSize&&(re.series.shadowSize=re.shadowSize),null!=re.highlightColor&&(re.series.highlightColor=re.highlightColor),i=0;i<re.xaxes.length;++i)m(ue,i+1).options=re.xaxes[i];for(i=0;i<re.yaxes.length;++i)m(he,i+1).options=re.yaxes[i];for(var u in ge)re.hooks[u]&&re.hooks[u].length&&(ge[u]=ge[u].concat(re.hooks[u]));a(ge.processOptions,[re])}function u(e){ie=h(e),v(),b()}function h(t){for(var n=[],i=0;i<t.length;++i){var r=e.extend(!0,{},re.series);null!=t[i].data?(r.data=t[i].data,delete t[i].data,e.extend(!0,r,t[i]),t[i].data=r.data):r.data=t[i],n.push(r)}return n}function d(e,t){var n=e[t+"axis"];return"object"==typeof n&&(n=n.n),"number"!=typeof n&&(n=1),n}function p(){return e.grep(ue.concat(he),function(e){return e})}function f(e){var t,n,i={};for(t=0;t<ue.length;++t)n=ue[t],n&&n.used&&(i["x"+n.n]=n.c2p(e.left));for(t=0;t<he.length;++t)n=he[t],n&&n.used&&(i["y"+n.n]=n.c2p(e.top));return void 0!==i.x1&&(i.x=i.x1),void 0!==i.y1&&(i.y=i.y1),i}function g(e){var t,n,i,r={};for(t=0;t<ue.length;++t)if(n=ue[t],n&&n.used&&(i="x"+n.n,null==e[i]&&1==n.n&&(i="x"),null!=e[i])){r.left=n.p2c(e[i]);break}for(t=0;t<he.length;++t)if(n=he[t],n&&n.used&&(i="y"+n.n,null==e[i]&&1==n.n&&(i="y"),null!=e[i])){r.top=n.p2c(e[i]);break}return r}function m(t,n){return t[n-1]||(t[n-1]={n:n,direction:t==ue?"x":"y",options:e.extend(!0,{},t==ue?re.xaxis:re.yaxis)}),t[n-1]}function v(){var t,n=ie.length,i=-1;for(t=0;t<ie.length;++t){var r=ie[t].color;null!=r&&(n--,"number"==typeof r&&r>i&&(i=r))}i>=n&&(n=i+1);var o,s=[],a=re.colors,l=a.length,c=0;for(t=0;n>t;t++)o=e.color.parse(a[t%l]||"#666"),t%l==0&&t&&(c=c>=0?.5>c?-c-.2:0:-c),s[t]=o.scale("rgb",1+c);var u,h=0;for(t=0;t<ie.length;++t){if(u=ie[t],null==u.color?(u.color=s[h].toString(),++h):"number"==typeof u.color&&(u.color=s[u.color].toString()),null==u.lines.show){var p,f=!0;for(p in u)if(u[p]&&u[p].show){f=!1;break}f&&(u.lines.show=!0)}null==u.lines.zero&&(u.lines.zero=!!u.lines.fill),u.xaxis=m(ue,d(u,"x")),u.yaxis=m(he,d(u,"y"))}}function b(){function t(e,t,n){t<e.datamin&&t!=-b&&(e.datamin=t),n>e.datamax&&n!=b&&(e.datamax=n)}var n,i,r,o,s,l,c,u,h,d,f,g,m=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,b=Number.MAX_VALUE;for(e.each(p(),function(e,t){t.datamin=m,t.datamax=v,t.used=!1}),n=0;n<ie.length;++n)s=ie[n],s.datapoints={points:[]},a(ge.processRawData,[s,s.data,s.datapoints]);for(n=0;n<ie.length;++n){if(s=ie[n],f=s.data,g=s.datapoints.format,!g){if(g=[],g.push({x:!0,number:!0,required:!0}),g.push({y:!0,number:!0,required:!0}),s.bars.show||s.lines.show&&s.lines.fill){var y=!!(s.bars.show&&s.bars.zero||s.lines.show&&s.lines.zero);g.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:y}),s.bars.horizontal&&(delete g[g.length-1].y,g[g.length-1].x=!0)}s.datapoints.format=g}if(null==s.datapoints.pointsize){s.datapoints.pointsize=g.length,c=s.datapoints.pointsize,l=s.datapoints.points;var w=s.lines.show&&s.lines.steps;for(s.xaxis.used=s.yaxis.used=!0,i=r=0;i<f.length;++i,r+=c){d=f[i];var _=null==d;if(!_)for(o=0;c>o;++o)u=d[o],h=g[o],h&&(h.number&&null!=u&&(u=+u,isNaN(u)?u=null:u==1/0?u=b:u==-(1/0)&&(u=-b)),null==u&&(h.required&&(_=!0),null!=h.defaultValue&&(u=h.defaultValue))),l[r+o]=u;if(_)for(o=0;c>o;++o)u=l[r+o],null!=u&&(h=g[o],h.autoscale!==!1&&(h.x&&t(s.xaxis,u,u),h.y&&t(s.yaxis,u,u))),l[r+o]=null;else if(w&&r>0&&null!=l[r-c]&&l[r-c]!=l[r]&&l[r-c+1]!=l[r+1]){for(o=0;c>o;++o)l[r+c+o]=l[r+o];l[r+1]=l[r-c+1],r+=c}}}}for(n=0;n<ie.length;++n)s=ie[n],a(ge.processDatapoints,[s,s.datapoints]);for(n=0;n<ie.length;++n){s=ie[n],l=s.datapoints.points,c=s.datapoints.pointsize,g=s.datapoints.format;var x=m,C=m,$=v,k=v;for(i=0;i<l.length;i+=c)if(null!=l[i])for(o=0;c>o;++o)u=l[i+o],h=g[o],h&&h.autoscale!==!1&&u!=b&&u!=-b&&(h.x&&(x>u&&(x=u),u>$&&($=u)),h.y&&(C>u&&(C=u),u>k&&(k=u)));if(s.bars.show){var S;switch(s.bars.align){case"left":S=0;break;case"right":S=-s.bars.barWidth;break;default:S=-s.bars.barWidth/2}s.bars.horizontal?(C+=S,k+=S+s.bars.barWidth):(x+=S,$+=S+s.bars.barWidth)}t(s.xaxis,x,$),t(s.yaxis,C,k)}e.each(p(),function(e,t){t.datamin==m&&(t.datamin=null),t.datamax==v&&(t.datamax=null)})}function y(){n.css("padding",0).children().filter(function(){return!e(this).hasClass("flot-overlay")&&!e(this).hasClass("flot-base")}).remove(),"static"==n.css("position")&&n.css("position","relative"),oe=new t("flot-base",n),se=new t("flot-overlay",n),le=oe.context,ce=se.context,ae=e(se.element).unbind();var i=n.data("plot");i&&(i.shutdown(),se.clear()),n.data("plot",me)}function w(){re.grid.hoverable&&(ae.mousemove(q),ae.bind("mouseleave",V)),re.grid.clickable&&ae.click(Y),a(ge.bindEvents,[ae])}function _(){be&&clearTimeout(be),ae.unbind("mousemove",q),ae.unbind("mouseleave",V),ae.unbind("click",Y),a(ge.shutdown,[ae])}function x(e){function t(e){return e}var n,i,r=e.options.transform||t,o=e.options.inverseTransform;"x"==e.direction?(n=e.scale=pe/Math.abs(r(e.max)-r(e.min)),i=Math.min(r(e.max),r(e.min))):(n=e.scale=fe/Math.abs(r(e.max)-r(e.min)),n=-n,i=Math.max(r(e.max),r(e.min))),e.p2c=r==t?function(e){return(e-i)*n}:function(e){return(r(e)-i)*n},e.c2p=o?function(e){return o(i+e/n)}:function(e){return i+e/n}}function C(e){for(var t=e.options,n=e.ticks||[],i=t.labelWidth||0,r=t.labelHeight||0,o=i||("x"==e.direction?Math.floor(oe.width/(n.length||1)):null),s=e.direction+"Axis "+e.direction+e.n+"Axis",a="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+s,l=t.font||"flot-tick-label tickLabel",c=0;c<n.length;++c){var u=n[c];if(u.label){var h=oe.getTextInfo(a,u.label,l,null,o);i=Math.max(i,h.width),r=Math.max(r,h.height)}}e.labelWidth=t.labelWidth||i,e.labelHeight=t.labelHeight||r}function $(t){var n=t.labelWidth,i=t.labelHeight,r=t.options.position,o="x"===t.direction,s=t.options.tickLength,a=re.grid.axisMargin,l=re.grid.labelMargin,c=!0,u=!0,h=!0,d=!1;e.each(o?ue:he,function(e,n){n&&(n.show||n.reserveSpace)&&(n===t?d=!0:n.options.position===r&&(d?u=!1:c=!1),d||(h=!1))}),u&&(a=0),null==s&&(s=h?"full":5),isNaN(+s)||(l+=+s),o?(i+=l,"bottom"==r?(de.bottom+=i+a,t.box={top:oe.height-de.bottom,height:i}):(t.box={top:de.top+a,height:i},de.top+=i+a)):(n+=l,"left"==r?(t.box={left:de.left+a,width:n},de.left+=n+a):(de.right+=n+a,t.box={left:oe.width-de.right,width:n})),t.position=r,t.tickLength=s,t.box.padding=l,t.innermost=c}function k(e){"x"==e.direction?(e.box.left=de.left-e.labelWidth/2,e.box.width=oe.width-de.left-de.right+e.labelWidth):(e.box.top=de.top-e.labelHeight/2,e.box.height=oe.height-de.bottom-de.top+e.labelHeight)}function S(){var t,n=re.grid.minBorderMargin;if(null==n)for(n=0,t=0;t<ie.length;++t)n=Math.max(n,2*(ie[t].points.radius+ie[t].points.lineWidth/2));var i={left:n,right:n,top:n,bottom:n};e.each(p(),function(e,t){t.reserveSpace&&t.ticks&&t.ticks.length&&("x"===t.direction?(i.left=Math.max(i.left,t.labelWidth/2),i.right=Math.max(i.right,t.labelWidth/2)):(i.bottom=Math.max(i.bottom,t.labelHeight/2),i.top=Math.max(i.top,t.labelHeight/2)))}),de.left=Math.ceil(Math.max(i.left,de.left)),de.right=Math.ceil(Math.max(i.right,de.right)),de.top=Math.ceil(Math.max(i.top,de.top)),de.bottom=Math.ceil(Math.max(i.bottom,de.bottom))}function T(){var t,n=p(),i=re.grid.show;for(var r in de){var o=re.grid.margin||0;de[r]="number"==typeof o?o:o[r]||0}a(ge.processOffset,[de]);for(var r in de)de[r]+="object"==typeof re.grid.borderWidth?i?re.grid.borderWidth[r]:0:i?re.grid.borderWidth:0;if(e.each(n,function(e,t){var n=t.options;t.show=null==n.show?t.used:n.show,t.reserveSpace=null==n.reserveSpace?t.show:n.reserveSpace,E(t)}),i){var s=e.grep(n,function(e){return e.show||e.reserveSpace});for(e.each(s,function(e,t){D(t),A(t),O(t,t.ticks),C(t)}),t=s.length-1;t>=0;--t)$(s[t]);S(),e.each(s,function(e,t){k(t)})}pe=oe.width-de.left-de.right,fe=oe.height-de.bottom-de.top,e.each(n,function(e,t){x(t)}),i&&N(),B()}function E(e){var t=e.options,n=+(null!=t.min?t.min:e.datamin),i=+(null!=t.max?t.max:e.datamax),r=i-n;if(0==r){var o=0==i?1:.01;null==t.min&&(n-=o),(null==t.max||null!=t.min)&&(i+=o)}else{var s=t.autoscaleMargin;null!=s&&(null==t.min&&(n-=r*s,0>n&&null!=e.datamin&&e.datamin>=0&&(n=0)),null==t.max&&(i+=r*s,i>0&&null!=e.datamax&&e.datamax<=0&&(i=0)))}e.min=n,e.max=i}function D(t){var n,r=t.options;n="number"==typeof r.ticks&&r.ticks>0?r.ticks:.3*Math.sqrt("x"==t.direction?oe.width:oe.height);var o=(t.max-t.min)/n,s=-Math.floor(Math.log(o)/Math.LN10),a=r.tickDecimals;null!=a&&s>a&&(s=a);var l,c=Math.pow(10,-s),u=o/c;if(1.5>u?l=1:3>u?(l=2,u>2.25&&(null==a||a>=s+1)&&(l=2.5,++s)):l=7.5>u?5:10,l*=c,null!=r.minTickSize&&l<r.minTickSize&&(l=r.minTickSize),t.delta=o,t.tickDecimals=Math.max(0,null!=a?a:s),t.tickSize=r.tickSize||l,"time"==r.mode&&!t.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(t.tickGenerator||(t.tickGenerator=function(e){var t,n=[],r=i(e.min,e.tickSize),o=0,s=Number.NaN;do t=s,s=r+o*e.tickSize,n.push(s),++o;while(s<e.max&&s!=t);return n},t.tickFormatter=function(e,t){var n=t.tickDecimals?Math.pow(10,t.tickDecimals):1,i=""+Math.round(e*n)/n;if(null!=t.tickDecimals){var r=i.indexOf("."),o=-1==r?0:i.length-r-1;if(o<t.tickDecimals)return(o?i:i+".")+(""+n).substr(1,t.tickDecimals-o)}return i}),e.isFunction(r.tickFormatter)&&(t.tickFormatter=function(e,t){return""+r.tickFormatter(e,t)}),null!=r.alignTicksWithAxis){var h=("x"==t.direction?ue:he)[r.alignTicksWithAxis-1];if(h&&h.used&&h!=t){var d=t.tickGenerator(t);if(d.length>0&&(null==r.min&&(t.min=Math.min(t.min,d[0])),null==r.max&&d.length>1&&(t.max=Math.max(t.max,d[d.length-1]))),t.tickGenerator=function(e){var t,n,i=[];for(n=0;n<h.ticks.length;++n)t=(h.ticks[n].v-h.min)/(h.max-h.min),t=e.min+t*(e.max-e.min),i.push(t);return i},!t.mode&&null==r.tickDecimals){var p=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),f=t.tickGenerator(t);f.length>1&&/\..*0$/.test((f[1]-f[0]).toFixed(p))||(t.tickDecimals=p)}}}}function A(t){var n=t.options.ticks,i=[];null==n||"number"==typeof n&&n>0?i=t.tickGenerator(t):n&&(i=e.isFunction(n)?n(t):n);var r,o;for(t.ticks=[],r=0;r<i.length;++r){var s=null,a=i[r];"object"==typeof a?(o=+a[0],a.length>1&&(s=a[1])):o=+a,null==s&&(s=t.tickFormatter(o,t)),isNaN(o)||t.ticks.push({v:o,label:s})}}function O(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)));
}function I(){oe.clear(),a(ge.drawBackground,[le]);var e=re.grid;e.show&&e.backgroundColor&&P(),e.show&&!e.aboveData&&R();for(var t=0;t<ie.length;++t)a(ge.drawSeries,[le,ie[t]]),F(ie[t]);a(ge.draw,[le]),e.show&&e.aboveData&&R(),oe.render(),K()}function M(e,t){for(var n,i,r,o,s=p(),a=0;a<s.length;++a)if(n=s[a],n.direction==t&&(o=t+n.n+"axis",e[o]||1!=n.n||(o=t+"axis"),e[o])){i=e[o].from,r=e[o].to;break}if(e[o]||(n="x"==t?ue[0]:he[0],i=e[t+"1"],r=e[t+"2"]),null!=i&&null!=r&&i>r){var l=i;i=r,r=l}return{from:i,to:r,axis:n}}function P(){le.save(),le.translate(de.left,de.top),le.fillStyle=ne(re.grid.backgroundColor,fe,0,"rgba(255, 255, 255, 0)"),le.fillRect(0,0,pe,fe),le.restore()}function R(){var t,n,i,r;le.save(),le.translate(de.left,de.top);var o=re.grid.markings;if(o)for(e.isFunction(o)&&(n=me.getAxes(),n.xmin=n.xaxis.min,n.xmax=n.xaxis.max,n.ymin=n.yaxis.min,n.ymax=n.yaxis.max,o=o(n)),t=0;t<o.length;++t){var s=o[t],a=M(s,"x"),l=M(s,"y");if(null==a.from&&(a.from=a.axis.min),null==a.to&&(a.to=a.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),!(a.to<a.axis.min||a.from>a.axis.max||l.to<l.axis.min||l.from>l.axis.max)){a.from=Math.max(a.from,a.axis.min),a.to=Math.min(a.to,a.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max);var c=a.from===a.to,u=l.from===l.to;if(!c||!u)if(a.from=Math.floor(a.axis.p2c(a.from)),a.to=Math.floor(a.axis.p2c(a.to)),l.from=Math.floor(l.axis.p2c(l.from)),l.to=Math.floor(l.axis.p2c(l.to)),c||u){var h=s.lineWidth||re.grid.markingsLineWidth,d=h%2?.5:0;le.beginPath(),le.strokeStyle=s.color||re.grid.markingsColor,le.lineWidth=h,c?(le.moveTo(a.to+d,l.from),le.lineTo(a.to+d,l.to)):(le.moveTo(a.from,l.to+d),le.lineTo(a.to,l.to+d)),le.stroke()}else le.fillStyle=s.color||re.grid.markingsColor,le.fillRect(a.from,l.to,a.to-a.from,l.from-l.to)}}n=p(),i=re.grid.borderWidth;for(var f=0;f<n.length;++f){var g,m,v,b,y=n[f],w=y.box,_=y.tickLength;if(y.show&&0!=y.ticks.length){for(le.lineWidth=1,"x"==y.direction?(g=0,m="full"==_?"top"==y.position?0:fe:w.top-de.top+("top"==y.position?w.height:0)):(m=0,g="full"==_?"left"==y.position?0:pe:w.left-de.left+("left"==y.position?w.width:0)),y.innermost||(le.strokeStyle=y.options.color,le.beginPath(),v=b=0,"x"==y.direction?v=pe+1:b=fe+1,1==le.lineWidth&&("x"==y.direction?m=Math.floor(m)+.5:g=Math.floor(g)+.5),le.moveTo(g,m),le.lineTo(g+v,m+b),le.stroke()),le.strokeStyle=y.options.tickColor,le.beginPath(),t=0;t<y.ticks.length;++t){var x=y.ticks[t].v;v=b=0,isNaN(x)||x<y.min||x>y.max||"full"==_&&("object"==typeof i&&i[y.position]>0||i>0)&&(x==y.min||x==y.max)||("x"==y.direction?(g=y.p2c(x),b="full"==_?-fe:_,"top"==y.position&&(b=-b)):(m=y.p2c(x),v="full"==_?-pe:_,"left"==y.position&&(v=-v)),1==le.lineWidth&&("x"==y.direction?g=Math.floor(g)+.5:m=Math.floor(m)+.5),le.moveTo(g,m),le.lineTo(g+v,m+b))}le.stroke()}}i&&(r=re.grid.borderColor,"object"==typeof i||"object"==typeof r?("object"!=typeof i&&(i={top:i,right:i,bottom:i,left:i}),"object"!=typeof r&&(r={top:r,right:r,bottom:r,left:r}),i.top>0&&(le.strokeStyle=r.top,le.lineWidth=i.top,le.beginPath(),le.moveTo(0-i.left,0-i.top/2),le.lineTo(pe,0-i.top/2),le.stroke()),i.right>0&&(le.strokeStyle=r.right,le.lineWidth=i.right,le.beginPath(),le.moveTo(pe+i.right/2,0-i.top),le.lineTo(pe+i.right/2,fe),le.stroke()),i.bottom>0&&(le.strokeStyle=r.bottom,le.lineWidth=i.bottom,le.beginPath(),le.moveTo(pe+i.right,fe+i.bottom/2),le.lineTo(0,fe+i.bottom/2),le.stroke()),i.left>0&&(le.strokeStyle=r.left,le.lineWidth=i.left,le.beginPath(),le.moveTo(0-i.left/2,fe+i.bottom),le.lineTo(0-i.left/2,0),le.stroke())):(le.lineWidth=i,le.strokeStyle=re.grid.borderColor,le.strokeRect(-i/2,-i/2,pe+i,fe+i))),le.restore()}function N(){e.each(p(),function(e,t){var n,i,r,o,s,a=t.box,l=t.direction+"Axis "+t.direction+t.n+"Axis",c="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+l,u=t.options.font||"flot-tick-label tickLabel";if(oe.removeText(c),t.show&&0!=t.ticks.length)for(var h=0;h<t.ticks.length;++h)n=t.ticks[h],!n.label||n.v<t.min||n.v>t.max||("x"==t.direction?(o="center",i=de.left+t.p2c(n.v),"bottom"==t.position?r=a.top+a.padding:(r=a.top+a.height-a.padding,s="bottom")):(s="middle",r=de.top+t.p2c(n.v),"left"==t.position?(i=a.left+a.width-a.padding,o="right"):i=a.left+a.padding),oe.addText(c,i,r,n.label,u,null,null,o,s))})}function F(e){e.lines.show&&L(e),e.bars.show&&H(e),e.points.show&&j(e)}function L(e){function t(e,t,n,i,r){var o=e.points,s=e.pointsize,a=null,l=null;le.beginPath();for(var c=s;c<o.length;c+=s){var u=o[c-s],h=o[c-s+1],d=o[c],p=o[c+1];if(null!=u&&null!=d){if(p>=h&&h<r.min){if(p<r.min)continue;u=(r.min-h)/(p-h)*(d-u)+u,h=r.min}else if(h>=p&&p<r.min){if(h<r.min)continue;d=(r.min-h)/(p-h)*(d-u)+u,p=r.min}if(h>=p&&h>r.max){if(p>r.max)continue;u=(r.max-h)/(p-h)*(d-u)+u,h=r.max}else if(p>=h&&p>r.max){if(h>r.max)continue;d=(r.max-h)/(p-h)*(d-u)+u,p=r.max}if(d>=u&&u<i.min){if(d<i.min)continue;h=(i.min-u)/(d-u)*(p-h)+h,u=i.min}else if(u>=d&&d<i.min){if(u<i.min)continue;p=(i.min-u)/(d-u)*(p-h)+h,d=i.min}if(u>=d&&u>i.max){if(d>i.max)continue;h=(i.max-u)/(d-u)*(p-h)+h,u=i.max}else if(d>=u&&d>i.max){if(u>i.max)continue;p=(i.max-u)/(d-u)*(p-h)+h,d=i.max}(u!=a||h!=l)&&le.moveTo(i.p2c(u)+t,r.p2c(h)+n),a=d,l=p,le.lineTo(i.p2c(d)+t,r.p2c(p)+n)}}le.stroke()}function n(e,t,n){for(var i=e.points,r=e.pointsize,o=Math.min(Math.max(0,n.min),n.max),s=0,a=!1,l=1,c=0,u=0;!(r>0&&s>i.length+r);){s+=r;var h=i[s-r],d=i[s-r+l],p=i[s],f=i[s+l];if(a){if(r>0&&null!=h&&null==p){u=s,r=-r,l=2;continue}if(0>r&&s==c+r){le.fill(),a=!1,r=-r,l=1,s=c=u+r;continue}}if(null!=h&&null!=p){if(p>=h&&h<t.min){if(p<t.min)continue;d=(t.min-h)/(p-h)*(f-d)+d,h=t.min}else if(h>=p&&p<t.min){if(h<t.min)continue;f=(t.min-h)/(p-h)*(f-d)+d,p=t.min}if(h>=p&&h>t.max){if(p>t.max)continue;d=(t.max-h)/(p-h)*(f-d)+d,h=t.max}else if(p>=h&&p>t.max){if(h>t.max)continue;f=(t.max-h)/(p-h)*(f-d)+d,p=t.max}if(a||(le.beginPath(),le.moveTo(t.p2c(h),n.p2c(o)),a=!0),d>=n.max&&f>=n.max)le.lineTo(t.p2c(h),n.p2c(n.max)),le.lineTo(t.p2c(p),n.p2c(n.max));else if(d<=n.min&&f<=n.min)le.lineTo(t.p2c(h),n.p2c(n.min)),le.lineTo(t.p2c(p),n.p2c(n.min));else{var g=h,m=p;f>=d&&d<n.min&&f>=n.min?(h=(n.min-d)/(f-d)*(p-h)+h,d=n.min):d>=f&&f<n.min&&d>=n.min&&(p=(n.min-d)/(f-d)*(p-h)+h,f=n.min),d>=f&&d>n.max&&f<=n.max?(h=(n.max-d)/(f-d)*(p-h)+h,d=n.max):f>=d&&f>n.max&&d<=n.max&&(p=(n.max-d)/(f-d)*(p-h)+h,f=n.max),h!=g&&le.lineTo(t.p2c(g),n.p2c(d)),le.lineTo(t.p2c(h),n.p2c(d)),le.lineTo(t.p2c(p),n.p2c(f)),p!=m&&(le.lineTo(t.p2c(p),n.p2c(f)),le.lineTo(t.p2c(m),n.p2c(f)))}}}}le.save(),le.translate(de.left,de.top),le.lineJoin="round";var i=e.lines.lineWidth,r=e.shadowSize;if(i>0&&r>0){le.lineWidth=r,le.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;t(e.datapoints,Math.sin(o)*(i/2+r/2),Math.cos(o)*(i/2+r/2),e.xaxis,e.yaxis),le.lineWidth=r/2,t(e.datapoints,Math.sin(o)*(i/2+r/4),Math.cos(o)*(i/2+r/4),e.xaxis,e.yaxis)}le.lineWidth=i,le.strokeStyle=e.color;var s=W(e.lines,e.color,0,fe);s&&(le.fillStyle=s,n(e.datapoints,e.xaxis,e.yaxis)),i>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),le.restore()}function j(e){function t(e,t,n,i,r,o,s,a){for(var l=e.points,c=e.pointsize,u=0;u<l.length;u+=c){var h=l[u],d=l[u+1];null==h||h<o.min||h>o.max||d<s.min||d>s.max||(le.beginPath(),h=o.p2c(h),d=s.p2c(d)+i,"circle"==a?le.arc(h,d,t,0,r?Math.PI:2*Math.PI,!1):a(le,h,d,t,r),le.closePath(),n&&(le.fillStyle=n,le.fill()),le.stroke())}}le.save(),le.translate(de.left,de.top);var n=e.points.lineWidth,i=e.shadowSize,r=e.points.radius,o=e.points.symbol;if(0==n&&(n=1e-4),n>0&&i>0){var s=i/2;le.lineWidth=s,le.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,r,null,s+s/2,!0,e.xaxis,e.yaxis,o),le.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,r,null,s/2,!0,e.xaxis,e.yaxis,o)}le.lineWidth=n,le.strokeStyle=e.color,t(e.datapoints,r,W(e.points,e.color),0,!1,e.xaxis,e.yaxis,o),le.restore()}function U(e,t,n,i,r,o,s,a,l,c,u){var h,d,p,f,g,m,v,b,y;c?(b=m=v=!0,g=!1,h=n,d=e,f=t+i,p=t+r,h>d&&(y=d,d=h,h=y,g=!0,m=!1)):(g=m=v=!0,b=!1,h=e+i,d=e+r,p=n,f=t,p>f&&(y=f,f=p,p=y,b=!0,v=!1)),d<s.min||h>s.max||f<a.min||p>a.max||(h<s.min&&(h=s.min,g=!1),d>s.max&&(d=s.max,m=!1),p<a.min&&(p=a.min,b=!1),f>a.max&&(f=a.max,v=!1),h=s.p2c(h),p=a.p2c(p),d=s.p2c(d),f=a.p2c(f),o&&(l.fillStyle=o(p,f),l.fillRect(h,f,d-h,p-f)),u>0&&(g||m||v||b)&&(l.beginPath(),l.moveTo(h,p),g?l.lineTo(h,f):l.moveTo(h,f),v?l.lineTo(d,f):l.moveTo(d,f),m?l.lineTo(d,p):l.moveTo(d,p),b?l.lineTo(h,p):l.moveTo(h,p),l.stroke()))}function H(e){function t(t,n,i,r,o,s){for(var a=t.points,l=t.pointsize,c=0;c<a.length;c+=l)null!=a[c]&&U(a[c],a[c+1],a[c+2],n,i,r,o,s,le,e.bars.horizontal,e.bars.lineWidth)}le.save(),le.translate(de.left,de.top),le.lineWidth=e.bars.lineWidth,le.strokeStyle=e.color;var n;switch(e.bars.align){case"left":n=0;break;case"right":n=-e.bars.barWidth;break;default:n=-e.bars.barWidth/2}var i=e.bars.fill?function(t,n){return W(e.bars,e.color,t,n)}:null;t(e.datapoints,n,n+e.bars.barWidth,i,e.xaxis,e.yaxis),le.restore()}function W(t,n,i,r){var o=t.fill;if(!o)return null;if(t.fillColor)return ne(t.fillColor,i,r,n);var s=e.color.parse(n);return s.a="number"==typeof o?o:.4,s.normalize(),s.toString()}function B(){if(null!=re.legend.container?e(re.legend.container).html(""):n.find(".legend").remove(),re.legend.show){for(var t,i,r=[],o=[],s=!1,a=re.legend.labelFormatter,l=0;l<ie.length;++l)t=ie[l],t.label&&(i=a?a(t.label,t):t.label,i&&o.push({label:i,color:t.color}));if(re.legend.sorted)if(e.isFunction(re.legend.sorted))o.sort(re.legend.sorted);else if("reverse"==re.legend.sorted)o.reverse();else{var c="descending"!=re.legend.sorted;o.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=c?1:-1})}for(var l=0;l<o.length;++l){var u=o[l];l%re.legend.noColumns==0&&(s&&r.push("</tr>"),r.push("<tr>"),s=!0),r.push('<td class="legendColorBox"><div style="border:1px solid '+re.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+u.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+u.label+"</td>")}if(s&&r.push("</tr>"),0!=r.length){var h='<table style="font-size:smaller;color:'+re.grid.color+'">'+r.join("")+"</table>";if(null!=re.legend.container)e(re.legend.container).html(h);else{var d="",p=re.legend.position,f=re.legend.margin;null==f[0]&&(f=[f,f]),"n"==p.charAt(0)?d+="top:"+(f[1]+de.top)+"px;":"s"==p.charAt(0)&&(d+="bottom:"+(f[1]+de.bottom)+"px;"),"e"==p.charAt(1)?d+="right:"+(f[0]+de.right)+"px;":"w"==p.charAt(1)&&(d+="left:"+(f[0]+de.left)+"px;");var g=e('<div class="legend">'+h.replace('style="','style="position:absolute;'+d+";")+"</div>").appendTo(n);if(0!=re.legend.backgroundOpacity){var m=re.legend.backgroundColor;null==m&&(m=re.grid.backgroundColor,m=m&&"string"==typeof m?e.color.parse(m):e.color.extract(g,"background-color"),m.a=1,m=m.toString());var v=g.children();e('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+d+"background-color:"+m+';"> </div>').prependTo(g).css("opacity",re.legend.backgroundOpacity)}}}}}function z(e,t,n){var i,r,o,s=re.grid.mouseActiveRadius,a=s*s+1,l=null;for(i=ie.length-1;i>=0;--i)if(n(ie[i])){var c=ie[i],u=c.xaxis,h=c.yaxis,d=c.datapoints.points,p=u.c2p(e),f=h.c2p(t),g=s/u.scale,m=s/h.scale;if(o=c.datapoints.pointsize,u.options.inverseTransform&&(g=Number.MAX_VALUE),h.options.inverseTransform&&(m=Number.MAX_VALUE),c.lines.show||c.points.show)for(r=0;r<d.length;r+=o){var v=d[r],b=d[r+1];if(null!=v&&!(v-p>g||-g>v-p||b-f>m||-m>b-f)){var y=Math.abs(u.p2c(v)-e),w=Math.abs(h.p2c(b)-t),_=y*y+w*w;a>_&&(a=_,l=[i,r/o])}}if(c.bars.show&&!l){var x,C;switch(c.bars.align){case"left":x=0;break;case"right":x=-c.bars.barWidth;break;default:x=-c.bars.barWidth/2}for(C=x+c.bars.barWidth,r=0;r<d.length;r+=o){var v=d[r],b=d[r+1],$=d[r+2];null!=v&&(ie[i].bars.horizontal?p<=Math.max($,v)&&p>=Math.min($,v)&&f>=b+x&&b+C>=f:p>=v+x&&v+C>=p&&f>=Math.min($,b)&&f<=Math.max($,b))&&(l=[i,r/o])}}}return l?(i=l[0],r=l[1],o=ie[i].datapoints.pointsize,{datapoint:ie[i].datapoints.points.slice(r*o,(r+1)*o),dataIndex:r,series:ie[i],seriesIndex:i}):null}function q(e){re.grid.hoverable&&G("plothover",e,function(e){return 0!=e.hoverable})}function V(e){re.grid.hoverable&&G("plothover",e,function(e){return!1})}function Y(e){G("plotclick",e,function(e){return 0!=e.clickable})}function G(e,t,i){var r=ae.offset(),o=t.pageX-r.left-de.left,s=t.pageY-r.top-de.top,a=f({left:o,top:s});a.pageX=t.pageX,a.pageY=t.pageY;var l=z(o,s,i);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+r.left+de.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+r.top+de.top,10)),re.grid.autoHighlight){for(var c=0;c<ve.length;++c){var u=ve[c];u.auto!=e||l&&u.series==l.series&&u.point[0]==l.datapoint[0]&&u.point[1]==l.datapoint[1]||J(u.series,u.point)}l&&Q(l.series,l.datapoint,e)}n.trigger(e,[a,l])}function K(){var e=re.interaction.redrawOverlayInterval;return-1==e?void X():void(be||(be=setTimeout(X,e)))}function X(){be=null,ce.save(),se.clear(),ce.translate(de.left,de.top);var e,t;for(e=0;e<ve.length;++e)t=ve[e],t.series.bars.show?te(t.series,t.point):ee(t.series,t.point);ce.restore(),a(ge.drawOverlay,[ce])}function Q(e,t,n){if("number"==typeof e&&(e=ie[e]),"number"==typeof t){var i=e.datapoints.pointsize;t=e.datapoints.points.slice(i*t,i*(t+1))}var r=Z(e,t);-1==r?(ve.push({series:e,point:t,auto:n}),K()):n||(ve[r].auto=!1)}function J(e,t){if(null==e&&null==t)return ve=[],void K();if("number"==typeof e&&(e=ie[e]),"number"==typeof t){var n=e.datapoints.pointsize;t=e.datapoints.points.slice(n*t,n*(t+1))}var i=Z(e,t);-1!=i&&(ve.splice(i,1),K())}function Z(e,t){for(var n=0;n<ve.length;++n){var i=ve[n];if(i.series==e&&i.point[0]==t[0]&&i.point[1]==t[1])return n}return-1}function ee(t,n){var i=n[0],r=n[1],o=t.xaxis,s=t.yaxis,a="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();if(!(i<o.min||i>o.max||r<s.min||r>s.max)){var l=t.points.radius+t.points.lineWidth/2;ce.lineWidth=l,ce.strokeStyle=a;var c=1.5*l;i=o.p2c(i),r=s.p2c(r),ce.beginPath(),"circle"==t.points.symbol?ce.arc(i,r,c,0,2*Math.PI,!1):t.points.symbol(ce,i,r,c,!1),ce.closePath(),ce.stroke()}}function te(t,n){var i,r="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),o=r;switch(t.bars.align){case"left":i=0;break;case"right":i=-t.bars.barWidth;break;default:i=-t.bars.barWidth/2}ce.lineWidth=t.bars.lineWidth,ce.strokeStyle=r,U(n[0],n[1],n[2]||0,i,i+t.bars.barWidth,function(){return o},t.xaxis,t.yaxis,ce,t.bars.horizontal,t.bars.lineWidth)}function ne(t,n,i,r){if("string"==typeof t)return t;for(var o=le.createLinearGradient(0,i,0,n),s=0,a=t.colors.length;a>s;++s){var l=t.colors[s];if("string"!=typeof l){var c=e.color.parse(r);null!=l.brightness&&(c=c.scale("rgb",l.brightness)),null!=l.opacity&&(c.a*=l.opacity),l=c.toString()}o.addColorStop(s/(a-1),l)}return o}var ie=[],re={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},oe=null,se=null,ae=null,le=null,ce=null,ue=[],he=[],de={left:0,right:0,top:0,bottom:0},pe=0,fe=0,ge={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},me=this;me.setData=u,me.setupGrid=T,me.draw=I,me.getPlaceholder=function(){return n},me.getCanvas=function(){return oe.element},me.getPlotOffset=function(){return de},me.width=function(){return pe},me.height=function(){return fe},me.offset=function(){var e=ae.offset();return e.left+=de.left,e.top+=de.top,e},me.getData=function(){return ie},me.getAxes=function(){var t={};return e.each(ue.concat(he),function(e,n){n&&(t[n.direction+(1!=n.n?n.n:"")+"axis"]=n)}),t},me.getXAxes=function(){return ue},me.getYAxes=function(){return he},me.c2p=f,me.p2c=g,me.getOptions=function(){return re},me.highlight=Q,me.unhighlight=J,me.triggerRedrawOverlay=K,me.pointOffset=function(e){return{left:parseInt(ue[d(e,"x")-1].p2c(+e.x)+de.left,10),top:parseInt(he[d(e,"y")-1].p2c(+e.y)+de.top,10)}},me.shutdown=_,me.destroy=function(){_(),n.removeData("plot").empty(),ie=[],re=null,oe=null,se=null,ae=null,le=null,ce=null,ue=[],he=[],ge=null,ve=[],me=null},me.resize=function(){var e=n.width(),t=n.height();oe.resize(e,t),se.resize(e,t)},me.hooks=ge,l(me),c(o),y(),u(r),T(),I(),w();var ve=[],be=null}function i(e,t){return t*Math.floor(e/t)}var r=Object.prototype.hasOwnProperty;e.fn.detach||(e.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),t.prototype.resize=function(e,t){if(0>=e||0>=t)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var n=this.element,i=this.context,r=this.pixelRatio;this.width!=e&&(n.width=e*r,n.style.width=e+"px",this.width=e),this.height!=t&&(n.height=t*r,n.style.height=t+"px",this.height=t),i.restore(),i.save(),i.scale(r,r)},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.render=function(){var e=this._textCache;for(var t in e)if(r.call(e,t)){var n=this.getTextLayer(t),i=e[t];n.hide();for(var o in i)if(r.call(i,o)){var s=i[o];for(var a in s)if(r.call(s,a)){for(var l,c=s[a].positions,u=0;l=c[u];u++)l.active?l.rendered||(n.append(l.element),l.rendered=!0):(c.splice(u--,1),l.rendered&&l.element.detach());0==c.length&&delete s[a]}}n.show()}},t.prototype.getTextLayer=function(t){var n=this.text[t];return null==n&&(null==this.textContainer&&(this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),n=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),n},t.prototype.getTextInfo=function(t,n,i,r,o){var s,a,l,c;if(n=""+n,s="object"==typeof i?i.style+" "+i.variant+" "+i.weight+" "+i.size+"px/"+i.lineHeight+"px "+i.family:i,a=this._textCache[t],null==a&&(a=this._textCache[t]={}),l=a[s],null==l&&(l=a[s]={}),c=l[n],null==c){var u=e("<div></div>").html(n).css({position:"absolute","max-width":o,top:-9999}).appendTo(this.getTextLayer(t));"object"==typeof i?u.css({font:s,color:i.color}):"string"==typeof i&&u.addClass(i),c=l[n]={width:u.outerWidth(!0),height:u.outerHeight(!0),element:u,positions:[]},u.detach()}return c},t.prototype.addText=function(e,t,n,i,r,o,s,a,l){var c=this.getTextInfo(e,i,r,o,s),u=c.positions;"center"==a?t-=c.width/2:"right"==a&&(t-=c.width),"middle"==l?n-=c.height/2:"bottom"==l&&(n-=c.height);for(var h,d=0;h=u[d];d++)if(h.x==t&&h.y==n)return void(h.active=!0);h={active:!0,rendered:!1,element:u.length?c.element.clone():c.element,x:t,y:n},u.push(h),h.element.css({top:Math.round(n),left:Math.round(t),"text-align":a})},t.prototype.removeText=function(e,t,n,i,o,s){if(null==i){var a=this._textCache[e];if(null!=a)for(var l in a)if(r.call(a,l)){var c=a[l];for(var u in c)if(r.call(c,u))for(var h,d=c[u].positions,p=0;h=d[p];p++)h.active=!1}}else for(var h,d=this.getTextInfo(e,i,o,s).positions,p=0;h=d[p];p++)h.x==t&&h.y==n&&(h.active=!1)},e.plot=function(t,i,r){var o=new n(e(t),i,r,e.plot.plugins);return o},e.plot.version="0.8.3",e.plot.plugins=[],e.fn.plot=function(t,n){return this.each(function(){e.plot(this,t,n)})}}(jQuery),function(e,t,n){"$:nomunge";function i(n){a===!0&&(a=n||1);for(var l=o.length-1;l>=0;l--){var d=e(o[l]);if(d[0]==t||d.is(":visible")){var p=d.width(),f=d.height(),g=d.data(u);!g||p===g.w&&f===g.h||(d.trigger(c,[g.w=p,g.h=f]),a=n||!0)}else g=d.data(u),g.w=0,g.h=0}null!==r&&(a&&(null==n||1e3>n-a)?r=t.requestAnimationFrame(i):(r=setTimeout(i,s[h]),a=!1))}var r,o=[],s=e.resize=e.extend(e.resize,{}),a=!1,l="setTimeout",c="resize",u=c+"-special-event",h="pendingDelay",d="activeDelay",p="throttleWindow";s[h]=200,s[d]=20,s[p]=!0,e.event.special[c]={setup:function(){if(!s[p]&&this[l])return!1;var t=e(this);o.push(this),t.data(u,{w:t.width(),h:t.height()}),1===o.length&&(r=n,i())},teardown:function(){if(!s[p]&&this[l])return!1;for(var t=e(this),n=o.length-1;n>=0;n--)if(o[n]==this){o.splice(n,1);break}t.removeData(u),o.length||(a?cancelAnimationFrame(r):clearTimeout(r),r=null)},add:function(t){function i(t,i,o){var s=e(this),a=s.data(u)||{};a.w=i!==n?i:s.width(),a.h=o!==n?o:s.height(),r.apply(this,arguments)}if(!s[p]&&this[l])return!1;var r;return e.isFunction(t)?(r=t,i):(r=t.handler,void(t.handler=i))}},t.requestAnimationFrame||(t.requestAnimationFrame=function(){return t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e,n){return t.setTimeout(function(){e((new Date).getTime())},s[d])}}()),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(){return t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}())}(jQuery,this),function(e){function t(e){function t(){var t=e.getPlaceholder();0!=t.width()&&0!=t.height()&&(e.resize(),e.setupGrid(),e.draw())}function n(e,n){e.getPlaceholder().resize(t)}function i(e,n){e.getPlaceholder().unbind("resize",t)}e.hooks.bindEvents.push(n),e.hooks.shutdown.push(i)}var n={};e.plot.plugins.push({init:t,options:n,name:"resize",version:"1.0"})}(jQuery),function(){for(var e=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var i=(new Date).getTime(),r=Math.max(0,16-(i-e)),o=window.setTimeout(function(){t(i+r)},r);return e=i+r,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),angular.module("angular-svg-round-progress",[]),angular.module("angular-svg-round-progress").constant("roundProgressConfig",{max:50,semi:!1,rounded:!1,radius:100,color:"#45ccce",bgcolor:"#eaeaea",stroke:15,iterations:50,animation:"easeOutCubic"}),angular.module("angular-svg-round-progress").service("roundProgressService",[function(){var e={};e.isSupported=!(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect);var t=function(e,t,n,i){var r=(i-90)*Math.PI/180;return{x:e+n*Math.cos(r),y:t+n*Math.sin(r)}};return e.updateState=function(e,n,i,r,o,s){if(!o)return r;var e=e>=n?n-1e-5:e,a=s?180:359.9999,l=0===n?0:e/n*a,c=o/2,u=t(c,c,i,l),h=t(c,c,i,0),d=180>=l?"0":"1",p=["M",u.x,u.y,"A",i,i,0,d,0,h.x,h.y].join(" ");return r.attr("d",p)},e.animations={linearEase:function(e,t,n,i){return n*e/i+t},easeInQuad:function(e,t,n,i){return n*(e/=i)*e+t},easeOutQuad:function(e,t,n,i){return-n*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,i){return n*(e/=i)*e*e+t},easeOutCubic:function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,i){return n*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,n,i){return-n*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,i){return n*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,n,i){return n*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t},easeOutSine:function(e,t,n,i){return n*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,n,i){return-n/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,n,i){return 0==e?t:n*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,n,i){return e==i?t+n:n*(-Math.pow(2,-10*e/i)+1)+t},easeInOutExpo:function(e,t,n,i){return 0==e?t:e==i?t+n:(e/=i/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t},easeInCirc:function(e,t,n,i){return-n*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,n,i){return n*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,n,i){return(e/=i/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,n,i){var r=1.70158,o=0,s=n;if(0==e)return t;if(1==(e/=i))return t+n;if(o||(o=.3*i),s<Math.abs(n)){s=n;var r=o/4}else var r=o/(2*Math.PI)*Math.asin(n/s);return-(s*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-r)*Math.PI/o))+t},easeOutElastic:function(e,t,n,i){var r=1.70158,o=0,s=n;if(0==e)return t;if(1==(e/=i))return t+n;if(o||(o=.3*i),s<Math.abs(n)){s=n;var r=o/4}else var r=o/(2*Math.PI)*Math.asin(n/s);return s*Math.pow(2,-10*e)*Math.sin(2*(e*i-r)*Math.PI/o)+n+t},easeInOutElastic:function(e,t,n,i){var r=1.70158,o=0,s=n;if(0==e)return t;if(2==(e/=i/2))return t+n;if(o||(o=.3*i*1.5),s<Math.abs(n)){s=n;var r=o/4}else var r=o/(2*Math.PI)*Math.asin(n/s);return 1>e?-.5*s*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-r)*Math.PI/o)+t:s*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*i-r)*Math.PI/o)*.5+n+t},easeInBack:function(e,t,n,i,r){return void 0==r&&(r=1.70158),n*(e/=i)*e*((r+1)*e-r)+t},easeOutBack:function(e,t,n,i,r){return void 0==r&&(r=1.70158),n*((e=e/i-1)*e*((r+1)*e+r)+1)+t},easeInOutBack:function(e,t,n,i,r){return void 0==r&&(r=1.70158),(e/=i/2)<1?n/2*e*e*(((r*=1.525)+1)*e-r)+t:n/2*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)+t},easeInBounce:function(t,n,i,r){return i-e.animations.easeOutBounce(r-t,0,i,r)+n},easeOutBounce:function(e,t,n,i){return(e/=i)<1/2.75?7.5625*n*e*e+t:2/2.75>e?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(t,n,i,r){return r/2>t?.5*e.animations.easeInBounce(2*t,0,i,r)+n:.5*e.animations.easeOutBounce(2*t-r,0,i,r)+.5*i+n}},e}]),angular.module("angular-svg-round-progress").directive("roundProgress",["roundProgressService","roundProgressConfig",function(e,t){return e.isSupported?{restrict:"EA",scope:{current:"@",max:"=",semi:"=",rounded:"=",radius:"@",color:"@",bgcolor:"@",stroke:"@",iterations:"@",animation:"@"},link:function(n,i,r){var o,s,a=i.find("path"),l=i.find("circle"),c=angular.copy(t),u=function(){var e=c.semi,t=parseInt(c.radius),n=parseInt(c.stroke);o=2*t+2*n,i.css({width:o+"px",height:(e?o/2:o)+"px",overflow:"hidden"}),a.css({stroke:c.color,"stroke-width":n,"stroke-linecap":c.rounded?"round":"butt"}).attr("transform",e?"translate(0,"+o+") rotate(-90)":""),l.attr({cx:t+n,cy:t+n,r:t}).css({stroke:c.bgcolor,"stroke-width":n})},h=function(t,i){if(!angular.isDefined(t))return!1;if(0>t)return s=i,n.current=0;if(t>c.max)return s=i,n.current=c.max;var r=c.max,l=c.radius,u=c.semi,h=e.animations[c.animation],d=i===t?0:i||0,p=t-d,f=0,g=parseInt(c.iterations);angular.isNumber(s)&&(d=s,p=t-s,s=null),function m(){e.updateState(h(f,d,p,g),r,l,a,o,u),g>f&&(requestAnimationFrame(m),f++)}()};n.$watchCollection("[current, max, semi, rounded, radius, color, bgcolor, stroke, iterations]",function(e,t,n){angular.forEach(n,function(e,t){t.indexOf("$")&&n!==e&&angular.isDefined(e)&&(c[t]=e)}),u(),h(e[0],t[0])})},replace:!0,template:['<svg class="round-progress" xmlns="http://www.w3.org/2000/svg">','<circle fill="none"/>','<path fill="none"/>',"</svg>"].join("\n")}:{restrict:"EA",template:'<div class="round-progress"></div>',replace:!0}}]),angular.module("angular-flot",[]).directive("flot",function(){return{restrict:"EA",template:"<div></div>",scope:{dataset:"=",options:"=",callback:"="},link:function(e,t,n){var i,r,o,s,a,l,c,u,h;if(a=null,c=n.width||"100%",i=n.height||"100%",(null!=(u=e.options)&&null!=(h=u.legend)?h.container:void 0)instanceof jQuery)throw'Please use a jQuery expression string with the "legend.container" option.';return e.dataset||(e.dataset=[]),e.options||(e.options={legend:{show:!1}}),l=$(t.children()[0]),l.css({width:c,height:i}),r=function(){var t;return t=$.plot(l,e.dataset,e.options),e.callback&&e.callback(t),t},o=function(e){return a?(a.setData(e),a.setupGrid(),a.draw()):a=r()},e.$watch("dataset",o,!0),s=function(){return a=r()},l.bind("plothover",function(e,t,n){if($("<div id='tooltip'></div>").css({position:"absolute",display:"none",border:"1px solid #fdd",padding:"2px","background-color":"#fee",opacity:.8}).appendTo("body"),n){var i=(n.datapoint[0],n.datapoint[1]);$("#tooltip").html(n.series.label+" = "+i).css({top:n.pageY+5,left:n.pageX+5}).fadeIn(200)}else $("#tooltip").hide()}),e.$watch("options",s,!0)}}}),function(){"use strict";var e={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isControl:function(t){var n=t.which;switch(n){case e.SHIFT:case e.CTRL:case e.ALT:return!0}return t.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e},isVerticalMovement:function(t){return~[e.UP,e.DOWN].indexOf(t)},isHorizontalMovement:function(t){return~[e.LEFT,e.RIGHT,e.BACKSPACE,e.DELETE].indexOf(t)}};void 0===angular.element.prototype.querySelectorAll&&(angular.element.prototype.querySelectorAll=function(e){return angular.element(this[0].querySelectorAll(e))}),angular.module("ui.select",[]).constant("uiSelectConfig",{theme:"bootstrap",searchEnabled:!0,placeholder:"",refreshDelay:1e3}).service("uiSelectMinErr",function(){var e=angular.$$minErr("ui.select");return function(){var t=e.apply(this,arguments),n=t.message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(n)}}).service("RepeatParser",["uiSelectMinErr","$parse",function(e,t){var n=this;n.parse=function(n){var i=n.match(/^\s*(?:([\s\S]+?)\s+as\s+)?([\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!i)throw e("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",n);return{itemName:i[2],source:t(i[3]),trackByExp:i[4],modelMapper:t(i[1]||i[2])}},n.getGroupNgRepeatExpression=function(){return"$group in $select.groups"},n.getNgRepeatExpression=function(e,t,n,i){var r=e+" in "+(i?"$group.items":t);return n&&(r+=" track by "+n),r}}]).controller("uiSelectCtrl",["$scope","$element","$timeout","RepeatParser","uiSelectMinErr",function(t,n,i,r,o){function s(){h.resetSearchInput&&(h.search=d,h.selected&&h.items.length&&!h.multiple&&(h.activeIndex=h.items.indexOf(h.selected)))}function a(t){var n=!0;switch(t){case e.DOWN:!h.open&&h.multiple?h.activate(!1,!0):h.activeIndex<h.items.length-1&&h.activeIndex++;break;case e.UP:!h.open&&h.multiple?h.activate(!1,!0):h.activeIndex>0&&h.activeIndex--;break;case e.TAB:h.multiple||h.select(h.items[h.activeIndex]);break;case e.ENTER:h.open?h.select(h.items[h.activeIndex]):h.activate(!1,!0);break;case e.ESC:h.close();break;default:n=!1}return n}function l(t){function n(){switch(t){case e.LEFT:return~h.activeMatchIndex?u:s;case e.RIGHT:return~h.activeMatchIndex&&a!==s?l:(h.activate(),!1);case e.BACKSPACE:return~h.activeMatchIndex?(h.removeChoice(a),u):s;case e.DELETE:return~h.activeMatchIndex?(h.removeChoice(h.activeMatchIndex),a):!1}}var i=c(p[0]),r=h.selected.length,o=0,s=r-1,a=h.activeMatchIndex,l=h.activeMatchIndex+1,u=h.activeMatchIndex-1,d=a;
return i>0||h.search.length&&t==e.RIGHT?!1:(h.close(),d=n(),h.activeMatchIndex=h.selected.length&&d!==!1?Math.min(s,Math.max(o,d)):-1,!0)}function c(e){return angular.isNumber(e.selectionStart)?e.selectionStart:e.value.length}function u(){var e=n.querySelectorAll(".ui-select-choices-content"),t=e.querySelectorAll(".ui-select-choices-row");if(t.length<1)throw o("choices","Expected multiple .ui-select-choices-row but got '{0}'.",t.length);var i=t[h.activeIndex],r=i.offsetTop+i.clientHeight-e[0].scrollTop,s=e[0].offsetHeight;r>s?e[0].scrollTop+=r-s:r<i.clientHeight&&(h.isGrouped&&0===h.activeIndex?e[0].scrollTop=0:e[0].scrollTop-=i.clientHeight-r)}var h=this,d="";h.placeholder=void 0,h.search=d,h.activeIndex=0,h.activeMatchIndex=-1,h.items=[],h.selected=void 0,h.open=!1,h.focus=!1,h.focusser=void 0,h.disabled=void 0,h.searchEnabled=void 0,h.resetSearchInput=void 0,h.refreshDelay=void 0,h.multiple=!1,h.isEmpty=function(){return angular.isUndefined(h.selected)||null===h.selected||""===h.selected};var p=n.querySelectorAll("input.ui-select-search");if(1!==p.length)throw o("searchInput","Expected 1 input.ui-select-search but got '{0}'.",p.length);h.activate=function(e,t){h.disabled||h.open||(t||s(),h.open=!0,h.activeMatchIndex=-1,h.activeIndex=h.activeIndex>=h.items.length?0:h.activeIndex,i(function(){h.search=e||h.search,p[0].focus()}))},h.findGroupByName=function(e){return h.groups&&h.groups.filter(function(t){return t.name===e})[0]},h.parseRepeatAttr=function(e,n){function i(e){h.groups=[],angular.forEach(e,function(e){var i=t.$eval(n),r=angular.isFunction(i)?i(e):e[i],o=h.findGroupByName(r);o?o.items.push(e):h.groups.push({name:r,items:[e]})}),h.items=[],h.groups.forEach(function(e){h.items=h.items.concat(e.items)})}function s(e){h.items=e}var a=n?i:s;h.parserResult=r.parse(e),h.isGrouped=!!n,h.itemProperty=h.parserResult.itemName,t.$watchCollection(h.parserResult.source,function(e){if(void 0===e||null===e)h.items=[];else{if(!angular.isArray(e))throw o("items","Expected an array but got '{0}'.",e);if(h.multiple){var t=e.filter(function(e){return h.selected.indexOf(e)<0});a(t)}else a(e);h.ngModel.$modelValue=null}}),h.multiple&&t.$watchCollection("$select.selected",function(e){if(e){var n=h.parserResult.source(t),i=n.filter(function(t){return e.indexOf(t)<0});a(i)}})};var f;h.refresh=function(e){void 0!==e&&(f&&i.cancel(f),f=i(function(){t.$eval(e)},h.refreshDelay))},h.setActiveItem=function(e){h.activeIndex=h.items.indexOf(e)},h.isActive=function(e){return h.items.indexOf(e[h.itemProperty])===h.activeIndex},h.select=function(e){var n={};n[h.parserResult.itemName]=e,h.onSelectCallback(t,{$item:e,$model:h.parserResult.modelMapper(t,n)}),h.multiple?(h.selected.push(e),h.sizeSearchInput()):h.selected=e,h.close()},h.close=function(){h.open&&(s(),h.open=!1,i(function(){h.focusser[0].focus()},0,!1))},h.removeChoice=function(e){h.selected.splice(e,1),h.activeMatchIndex=-1,h.sizeSearchInput()},h.getPlaceholder=function(){return h.multiple&&h.selected.length?void 0:h.placeholder},h.sizeSearchInput=function(){var e=p[0],t=p.parent().parent()[0];p.css("width","10px"),i(function(){var n=t.clientWidth-e.offsetLeft-10;50>n&&(n=t.clientWidth),p.css("width",n+"px")},0,!1)},p.on("keydown",function(n){var i=n.which;t.$apply(function(){var t=!1;h.multiple&&e.isHorizontalMovement(i)&&(t=l(i)),!t&&h.items.length>0&&(t=a(i)),t&&i!=e.TAB&&(n.preventDefault(),n.stopPropagation())}),e.isVerticalMovement(i)&&h.items.length>0&&u()}),p.on("blur",function(){i(function(){h.activeMatchIndex=-1,h.activeIndex=0})}),t.$on("$destroy",function(){p.off("keydown blur")})}]).directive("uiSelect",["$document","uiSelectConfig","uiSelectMinErr","$compile","$parse",function(t,n,i,r,o){return{restrict:"EA",templateUrl:function(e,t){var i=t.theme||n.theme;return i+(angular.isDefined(t.multiple)?"/select-multiple.tpl.html":"/select.tpl.html")},replace:!0,transclude:!0,require:["uiSelect","ngModel"],scope:!0,controller:"uiSelectCtrl",controllerAs:"$select",link:function(n,s,a,l,c){function u(e){var t=!1;t=window.jQuery?window.jQuery.contains(s[0],e.target):s[0].contains(e.target),t||(h.close(),n.$digest())}var h=l[0],d=l[1];h.multiple=angular.isDefined(a.multiple),h.onSelectCallback=o(a.onSelect),d.$parsers.unshift(function(e){var t,i={};if(h.multiple){for(var r=[],o=e.length-1;o>=0;o--)i={},i[h.parserResult.itemName]=e[o],t=h.parserResult.modelMapper(n,i),r.unshift(t);return r}return i={},i[h.parserResult.itemName]=e,t=h.parserResult.modelMapper(n,i)}),d.$formatters.unshift(function(e){var t,i=h.parserResult.source(n,{$select:{search:""}}),r={};if(i){if(h.multiple){var o=[],s=function(e,i){if(e&&e.length){for(var s=e.length-1;s>=0;s--)if(r[h.parserResult.itemName]=e[s],t=h.parserResult.modelMapper(n,r),t==i)return o.unshift(e[s]),!0;return!1}};if(!e)return o;for(var a=e.length-1;a>=0;a--)s(h.selected,e[a])||s(i,e[a]);return o}var l=function(i){return r[h.parserResult.itemName]=i,t=h.parserResult.modelMapper(n,r),t==e};if(h.selected&&l(h.selected))return h.selected;for(var c=i.length-1;c>=0;c--)if(l(i[c]))return i[c]}return e}),h.ngModel=d;var p=angular.element("<input ng-disabled='$select.disabled' class='ui-select-focusser ui-select-offscreen' type='text' aria-haspopup='true' role='button' />");r(p)(n),h.focusser=p,h.multiple||(s.append(p),p.bind("focus",function(){n.$evalAsync(function(){h.focus=!0})}),p.bind("blur",function(){n.$evalAsync(function(){h.focus=!1})}),p.bind("keydown",function(t){return t.which===e.BACKSPACE?(t.preventDefault(),t.stopPropagation(),h.select(void 0),void n.$digest()):void(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||((t.which==e.DOWN||t.which==e.UP||t.which==e.ENTER||t.which==e.SPACE)&&(t.preventDefault(),t.stopPropagation(),h.activate()),n.$digest()))}),p.bind("keyup input",function(t){t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||t.which==e.ENTER||t.which===e.BACKSPACE||(h.activate(p.val()),p.val(""),n.$digest())})),n.$watch("searchEnabled",function(){var e=n.$eval(a.searchEnabled);h.searchEnabled=void 0!==e?e:!0}),a.$observe("disabled",function(){h.disabled=void 0!==a.disabled?a.disabled:!1}),a.$observe("resetSearchInput",function(){var e=n.$eval(a.resetSearchInput);h.resetSearchInput=void 0!==e?e:!0}),h.multiple?(n.$watchCollection("$select.selected",function(e){d.$setViewValue(e,null,!0)}),p.prop("disabled",!0)):n.$watch("$select.selected",function(e){d.$viewValue!==e&&d.$setViewValue(e)}),d.$render=function(){if(h.multiple&&!angular.isArray(d.$viewValue)){if(!angular.isUndefined(d.$viewValue)&&null!==d.$viewValue)throw i("multiarr","Expected model value to be array but got '{0}'",d.$viewValue);h.selected=[]}h.selected=d.$viewValue},t.on("click",u),n.$on("$destroy",function(){t.off("click",u)}),c(n,function(e){var t=angular.element("<div>").append(e),n=t.querySelectorAll(".ui-select-match");if(n.removeAttr("ui-select-match"),1!==n.length)throw i("transcluded","Expected 1 .ui-select-match but got '{0}'.",n.length);s.querySelectorAll(".ui-select-match").replaceWith(n);var r=t.querySelectorAll(".ui-select-choices");if(r.removeAttr("ui-select-choices"),1!==r.length)throw i("transcluded","Expected 1 .ui-select-choices but got '{0}'.",r.length);s.querySelectorAll(".ui-select-choices").replaceWith(r)})}}}]).directive("uiSelectChoices",["uiSelectConfig","RepeatParser","uiSelectMinErr","$compile",function(e,t,n,i){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){var n=t.parent().attr("theme")||e.theme;return n+"/choices.tpl.html"},compile:function(r,o){if(!o.repeat)throw n("repeat","Expected 'repeat' expression.");return function(r,o,s,a,l){var c=s.groupBy;if(a.parseRepeatAttr(s.repeat,c),c){var u=o.querySelectorAll(".ui-select-choices-group");if(1!==u.length)throw n("rows","Expected 1 .ui-select-choices-group but got '{0}'.",u.length);u.attr("ng-repeat",t.getGroupNgRepeatExpression())}var h=o.querySelectorAll(".ui-select-choices-row");if(1!==h.length)throw n("rows","Expected 1 .ui-select-choices-row but got '{0}'.",h.length);h.attr("ng-repeat",t.getNgRepeatExpression(a.parserResult.itemName,"$select.items",a.parserResult.trackByExp,c)).attr("ng-mouseenter","$select.setActiveItem("+a.parserResult.itemName+")").attr("ng-click","$select.select("+a.parserResult.itemName+")");var d=o.querySelectorAll(".ui-select-choices-row-inner");if(1!==d.length)throw n("rows","Expected 1 .ui-select-choices-row-inner but got '{0}'.",d.length);d.attr("uis-transclude-append",""),i(o,l)(r),r.$watch("$select.search",function(e){e&&!a.open&&a.multiple&&a.activate(!1,!0),a.activeIndex=0,a.refresh(s.refresh)}),s.$observe("refreshDelay",function(){var t=r.$eval(s.refreshDelay);a.refreshDelay=void 0!==t?t:e.refreshDelay})}}}}]).directive("uisTranscludeAppend",function(){return{link:function(e,t,n,i,r){r(e,function(e){t.append(e)})}}}).directive("uiSelectMatch",["uiSelectConfig",function(e){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){var n=t.parent().attr("theme")||e.theme,i=t.parent().attr("multiple");return n+(i?"/match-multiple.tpl.html":"/match.tpl.html")},link:function(t,n,i,r){i.$observe("placeholder",function(t){r.placeholder=void 0!==t?t:e.placeholder}),r.multiple&&r.sizeSearchInput()}}}]).filter("highlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,n){return n&&t?t.replace(new RegExp(e(n),"gi"),'<span class="ui-select-highlight">$&</span>'):t}})}(),angular.module("ui.select").run(["$templateCache",function(e){e.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content dropdown-menu" role="menu" aria-labelledby="dLabel" ng-show="$select.items.length > 0"><li class="ui-select-choices-group"><div class="divider" ng-show="$select.isGrouped && $index > 0"></div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header">{{$group.name}}</div><div class="ui-select-choices-row" ng-class="{active: $select.isActive(this)}"><a href="javascript:void(0)" class="ui-select-choices-row-inner"></a></div></li></ul>'),e.put("bootstrap/match-multiple.tpl.html",'<span class="ui-select-match"><span ng-repeat="$item in $select.selected"><button style="margin-right: 3px;" class="ui-select-match-item btn btn-default btn-xs" tabindex="-1" ng-disabled="$select.disabled" ng-click="$select.activeMatchIndex = $index;" ng-class="{\'btn-primary\':$select.activeMatchIndex === $index}"><span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$select.removeChoice($index)">&nbsp;&times;</span> <span uis-transclude-append=""></span></button></span></span>'),e.put("bootstrap/match.tpl.html",'<button type="button" class="btn btn-default form-control ui-select-match" tabindex="-1" ng-hide="$select.open" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}" ;="" ng-click="$select.activate()"><span ng-show="$select.searchEnabled && $select.isEmpty()" class="text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" ng-transclude=""></span> <span class="caret"></span></button>'),e.put("bootstrap/select-multiple.tpl.html",'<div class="ui-select-multiple ui-select-bootstrap dropdown form-control" ng-class="{open: $select.open}"><div><div class="ui-select-match"></div><input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search input-xs" placeholder="{{$select.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-click="$select.activate()" ng-model="$select.search"></div><div class="ui-select-choices"></div></div>'),e.put("bootstrap/select.tpl.html",'<div class="ui-select-bootstrap dropdown" ng-class="{open: $select.open}"><div class="ui-select-match"></div><input type="text" autocomplete="off" tabindex="-1" class="form-control ui-select-search" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-show="$select.searchEnabled && $select.open"><div class="ui-select-choices"></div></div>'),e.put("select2/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content select2-results"><li class="ui-select-choices-group" ng-class="{\'select2-result-with-children\': $select.isGrouped}"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label select2-result-label">{{$group.name}}</div><ul ng-class="{\'select2-result-sub\': $select.isGrouped, \'select2-result-single\': !$select.isGrouped}"><li class="ui-select-choices-row" ng-class="{\'select2-highlighted\': $select.isActive(this)}"><div class="select2-result-label ui-select-choices-row-inner"></div></li></ul></li></ul>'),e.put("select2/match-multiple.tpl.html",'<span class="ui-select-match"><li class="ui-select-match-item select2-search-choice" ng-repeat="$item in $select.selected" ng-class="{\'select2-search-choice-focus\':$select.activeMatchIndex === $index}"><span uis-transclude-append=""></span> <a href="javascript:;" class="ui-select-match-close select2-search-choice-close" ng-click="$select.removeChoice($index)" tabindex="-1"></a></li></span>'),e.put("select2/match.tpl.html",'<a class="select2-choice ui-select-match" ng-class="{\'select2-default\': $select.isEmpty()}" ng-click="$select.activate()"><span ng-show="$select.searchEnabled && $select.isEmpty()" class="select2-chosen">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="select2-chosen" ng-transclude=""></span> <span class="select2-arrow"><b></b></span></a>'),e.put("select2/select-multiple.tpl.html",'<div class="ui-select-multiple select2 select2-container select2-container-multi" ng-class="{\'select2-container-active select2-dropdown-open\': $select.open,\n                \'select2-container-disabled\': $select.disabled}"><ul class="select2-choices"><span class="ui-select-match"></span><li class="select2-search-field"><input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="select2-input ui-select-search" placeholder="{{$select.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-model="$select.search" ng-click="$select.activate()" style="width: 34px;"></li></ul><div class="select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="ui-select-choices"></div></div></div>'),e.put("select2/select.tpl.html",'<div class="select2 select2-container" ng-class="{\'select2-container-active select2-dropdown-open\': $select.open,\n                \'select2-container-disabled\': $select.disabled,\n                \'select2-container-active\': $select.focus }"><div class="ui-select-match"></div><div class="select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="select2-search" ng-show="$select.searchEnabled"><input type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search select2-input" ng-model="$select.search"></div><div class="ui-select-choices"></div></div></div>'),e.put("selectize/choices.tpl.html",'<div ng-show="$select.open" class="ui-select-choices selectize-dropdown single"><div class="ui-select-choices-content selectize-dropdown-content"><div class="ui-select-choices-group optgroup"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label optgroup-header">{{$group.name}}</div><div class="ui-select-choices-row" ng-class="{active: $select.isActive(this)}"><div class="option ui-select-choices-row-inner" data-selectable=""></div></div></div></div></div>'),e.put("selectize/match.tpl.html",'<div ng-hide="$select.searchEnabled && ($select.open || $select.isEmpty())" class="ui-select-match" ng-transclude=""></div>'),e.put("selectize/select.tpl.html",'<div class="selectize-control single"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.activate()"><div class="ui-select-match"></div><input type="text" autocomplete="off" tabindex="-1" class="ui-select-search" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-hide="!$select.searchEnabled || ($select.selected && !$select.open)" ng-disabled="$select.disabled"></div><div class="ui-select-choices"></div></div>')}]),!function(){var e,t,n,i,r,o={}.hasOwnProperty,s=function(e,t){function n(){this.constructor=e}for(var i in t)o.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,n,i,r,o,s;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:this.escapeExpression(e.label),children:0,disabled:e.disabled}),o=e.childNodes,s=[],i=0,r=o.length;r>i;i++)n=o[i],s.push(this.add_option(n,t,e.disabled));return s},e.prototype.add_option=function(e,t,n){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:n===!0?n:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e.prototype.escapeExpression=function(e){var t,n;return null==e||e===!1?"":/[\&\<\>\"\'\`]/.test(e)?(t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/&(?!\w+;)|[\<\>\"\'\`]/g,e.replace(n,function(e){return t[e]||"&amp;"})):e},e}(),i.select_to_array=function(e){var t,n,r,o,s;for(n=new i,s=e.childNodes,r=0,o=s.length;o>r;r++)t=s[r],n.add_node(t);return n.parsed},t=function(){function e(t,n){this.form_field=t,this.options=null!=n?n:{},e.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},e.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.results_option_build=function(e){var t,n,i,r,o;for(t="",o=this.results_data,i=0,r=o.length;r>i;i++)n=o[i],t+=n.group?this.result_add_group(n):this.result_add_option(n),(null!=e?e.first:void 0)&&(n.selected&&this.is_multiple?this.choice_build(n):n.selected&&!this.is_multiple&&this.single_set_selected_text(n.text));return t},e.prototype.result_add_option=function(e){var t,n;return e.search_match&&this.include_option_in_results(e)?(t=[],e.disabled||e.selected&&this.is_multiple||t.push("active-result"),!e.disabled||e.selected&&this.is_multiple||t.push("disabled-result"),e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),n=""!==e.style.cssText?' style="'+e.style+'"':"",'<li class="'+t.join(" ")+'"'+n+' data-option-array-index="'+e.array_index+'">'+e.search_text+"</li>"):""},e.prototype.result_add_group=function(e){return(e.search_match||e.group_match)&&e.active_options>0?'<li class="group-result">'+e.search_text+"</li>":""},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build(),this.results_showing?this.winnow_results():void 0},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.winnow_results=function(){var e,t,n,i,r,o,s,a,l,c,u,h,d;for(this.no_results_clear(),r=0,s=this.get_search_text(),e=s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),i=this.search_contains?"":"^",n=new RegExp(i+e,"i"),c=new RegExp(e,"i"),d=this.results_data,u=0,h=d.length;h>u;u++)t=d[u],t.search_match=!1,o=null,this.include_option_in_results(t)&&(t.group&&(t.group_match=!1,t.active_options=0),null!=t.group_array_index&&this.results_data[t.group_array_index]&&(o=this.results_data[t.group_array_index],0===o.active_options&&o.search_match&&(r+=1),o.active_options+=1),(!t.group||this.group_search)&&(t.search_text=t.group?t.label:t.html,t.search_match=this.search_string_match(t.search_text,n),t.search_match&&!t.group&&(r+=1),t.search_match?(s.length&&(a=t.search_text.search(c),l=t.search_text.substr(0,a+s.length)+"</em>"+t.search_text.substr(a+s.length),t.search_text=l.substr(0,a)+"<em>"+l.substr(a)),null!=o&&(o.group_match=!0)):null!=t.group_array_index&&this.results_data[t.group_array_index].search_match&&(t.search_match=!0)));return this.result_clear_highlight(),1>r&&s.length?(this.update_results_content(""),this.no_results(s)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},e.prototype.search_string_match=function(e,t){var n,i,r,o;if(t.test(e))return!0;if(this.enable_split_word_search&&(e.indexOf(" ")>=0||0===e.indexOf("["))&&(i=e.replace(/\[|\]/g,"").split(" "),i.length))for(r=0,o=i.length;o>r;r++)if(n=i[r],t.test(n))return!0},e.prototype.choices_count=function(){var e,t,n,i;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,i=this.form_field.options,t=0,n=i.length;n>t;t++)e=i[t],e.selected&&(this.selected_option_count+=1);return this.selected_option_count},e.prototype.choices_click=function(e){return e.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},e.prototype.keyup_checker=function(e){var t,n;switch(t=null!=(n=e.which)?n:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},e.prototype.include_option_in_results=function(e){return this.is_multiple&&!this.display_selected_options&&e.selected?!1:!this.display_disabled_options&&e.disabled?!1:e.empty?!1:!0},e.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},e.default_multiple_text="Select Some Options",e.default_single_text="Select an Option",e.default_no_result_text="No results match",e}(),e=jQuery,e.fn.extend({chosen:function(i){return t.browser_is_supported()?this.each(function(){var t,r;t=e(this),r=t.data("chosen"),"destroy"===i&&r?r.destroy():r||t.data("chosen",new n(this,i))}):this}}),n=function(t){function n(){return r=n.__super__.constructor.apply(this,arguments)}return s(n,t),n.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},n.prototype.set_up_html=function(){var t,n;return t=["chosen-container"],t.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chosen-rtl"),n={"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(n.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=e("<div />",n),this.container.html(this.is_multiple?'<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>':'<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},n.prototype.register_observers=function(){var e=this;return this.container.bind("mousedown.chosen",function(t){e.container_mousedown(t)}),this.container.bind("mouseup.chosen",function(t){e.container_mouseup(t)}),this.container.bind("mouseenter.chosen",function(t){e.mouse_enter(t)}),this.container.bind("mouseleave.chosen",function(t){e.mouse_leave(t)}),this.search_results.bind("mouseup.chosen",function(t){e.search_results_mouseup(t)}),this.search_results.bind("mouseover.chosen",function(t){e.search_results_mouseover(t)}),this.search_results.bind("mouseout.chosen",function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(t){e.search_results_mousewheel(t)}),this.form_field_jq.bind("chosen:updated.chosen",function(t){e.results_update_field(t)}),this.form_field_jq.bind("chosen:activate.chosen",function(t){e.activate_field(t)}),this.form_field_jq.bind("chosen:open.chosen",function(t){e.container_mousedown(t)}),this.search_field.bind("blur.chosen",function(t){e.input_blur(t)}),this.search_field.bind("keyup.chosen",function(t){e.keyup_checker(t)}),this.search_field.bind("keydown.chosen",function(t){e.keydown_checker(t)}),this.search_field.bind("focus.chosen",function(t){e.input_focus(t)}),this.is_multiple?this.search_choices.bind("click.chosen",function(t){e.choices_click(t)}):this.container.bind("click.chosen",function(e){e.preventDefault()})},n.prototype.destroy=function(){return e(document).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},n.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},n.prototype.container_mousedown=function(t){return this.is_disabled||(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null!=t&&e(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chosen-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},n.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},n.prototype.search_results_mousewheel=function(e){var t,n,i;return t=-(null!=(n=e.originalEvent)?n.wheelDelta:void 0)||(null!=(i=e.originialEvent)?i.detail:void 0),null!=t?(e.preventDefault(),"DOMMouseScroll"===e.type&&(t=40*t),this.search_results.scrollTop(t+this.search_results.scrollTop())):void 0},n.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},n.prototype.close_field=function(){return e(document).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},n.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},n.prototype.test_active_click=function(t){return this.container.is(e(t.target).closest(".chosen-container"))?this.active_field=!0:this.close_field()},n.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=i.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},n.prototype.result_do_highlight=function(e){
var t,n,i,r,o;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),i=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),r=i+o,n=this.result_highlight.position().top+this.search_results.scrollTop(),t=n+this.result_highlight.outerHeight(),t>=r)return this.search_results.scrollTop(t-i>0?t-i:0);if(o>n)return this.search_results.scrollTop(n)}},n.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},n.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},n.prototype.update_results_content=function(e){return this.search_results.html(e)},n.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},n.prototype.set_tab_index=function(){var e;return this.form_field.tabIndex?(e=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=e):void 0},n.prototype.set_label_behavior=function(){var t=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()}):void 0},n.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},n.prototype.search_results_mouseup=function(t){var n;return n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),n.length?(this.result_highlight=n,this.result_select(t),this.search_field.focus()):void 0},n.prototype.search_results_mouseover=function(t){var n;return n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),n?this.result_do_highlight(n):void 0},n.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},n.prototype.choice_build=function(t){var n,i,r=this;return n=e("<li />",{"class":"search-choice"}).html("<span>"+t.html+"</span>"),t.disabled?n.addClass("search-choice-disabled"):(i=e("<a />",{"class":"search-choice-close","data-option-array-index":t.array_index}),i.bind("click.chosen",function(e){return r.choice_destroy_link_click(e)}),n.append(i)),this.search_container.before(n)},n.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(e(t.target))},n.prototype.choice_destroy=function(e){return this.result_deselect(e[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},n.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},n.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},n.prototype.result_select=function(e){var t,n,i;return this.result_highlight?(t=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?t.removeClass("active-result"):(this.result_single_selected&&(this.result_single_selected.removeClass("result-selected"),i=this.result_single_selected[0].getAttribute("data-option-array-index"),this.results_data[i].selected=!1),this.result_single_selected=t),t.addClass("result-selected"),n=this.results_data[t[0].getAttribute("data-option-array-index")],n.selected=!0,this.form_field.options[n.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(n):this.single_set_selected_text(n.text),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[n.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},n.prototype.single_set_selected_text=function(e){return null==e&&(e=this.default_text),e===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(e)},n.prototype.result_deselect=function(e){var t;return t=this.results_data[e],this.form_field.options[t.options_index].disabled?!1:(t.selected=!1,this.form_field.options[t.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[t.options_index].value}),this.search_field_scale(),!0)},n.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},n.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html()},n.prototype.winnow_results_set_highlight=function(){var e,t;return t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null!=e?this.result_do_highlight(e):void 0},n.prototype.no_results=function(t){var n;return n=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),n.find("span").first().html(t),this.search_results.append(n)},n.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},n.prototype.keydown_arrow=function(){var e;return this.results_showing&&this.result_highlight?(e=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(e):void 0:this.results_show()},n.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},n.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},n.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},n.prototype.keydown_checker=function(e){var t,n;switch(t=null!=(n=e.which)?n:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}},n.prototype.search_field_scale=function(){var t,n,i,r,o,s,a,l,c;if(this.is_multiple){for(i=0,a=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",s=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,c=s.length;c>l;l++)r=s[l],o+=r+":"+this.search_field.css(r)+";";return t=e("<div />",{style:o}),t.text(this.search_field.val()),e("body").append(t),a=t.width()+25,t.remove(),n=this.container.outerWidth(),a>n-10&&(a=n-10),this.search_field.css({width:a+"px"})}},n}(t)}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("localytics.directives",[]),angular.module("localytics.directives").directive("chosen",function(){var t,n,i,r;return n=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/,t=["noResultsText","allowSingleDeselect","disableSearchThreshold","disableSearch","enableSplitWordSearch","inheritSelectClasses","maxSelectedOptions","placeholderTextMultiple","placeholderTextSingle","searchContains","singleBackstrokeDelete","displayDisabledOptions","displaySelectedOptions","width"],r=function(e){return e.replace(/[A-Z]/g,function(e){return"_"+e.toLowerCase()})},i=function(e){var t;if(angular.isArray(e))return 0===e.length;if(angular.isObject(e))for(t in e)if(e.hasOwnProperty(t))return!1;return!0},{restrict:"A",require:"?ngModel",terminal:!0,link:function(o,s,a,l){var c,u,h,d,p,f,g,m,v,b,y,w,_;return s.addClass("localytics-chosen"),g=o.$eval(a.chosen)||{},angular.forEach(a,function(n,i){return e.call(t,i)>=0?g[r(i)]=o.$eval(n):void 0}),b=function(){return s.addClass("loading").attr("disabled",!0).trigger("chosen:updated")},y=function(){return s.removeClass("loading").attr("disabled",!1).trigger("chosen:updated")},c=null,u=null,d=!1,p=function(){return c?s.trigger("chosen:updated"):(c=s.chosen(g).data("chosen"),u=c.default_text)},v=function(){return d=!1,s.attr("data-placeholder",u)},h=function(){return d=!0,s.attr("data-placeholder",c.results_none_found).attr("disabled",!0).trigger("chosen:updated")},l?(m=l.$render,l.$render=function(){return m(),p()},a.multiple&&(_=function(){return l.$viewValue},o.$watch(_,l.$render,!0))):p(),a.$observe("disabled",function(){return s.trigger("chosen:updated")}),a.ngOptions&&l?(f=a.ngOptions.match(n),w=f[7],o.$watchCollection(w,function(e,t){return angular.isUndefined(e)?b():(d&&v(),y(),i(e)?h():void 0)})):void 0}}})}.call(this),function(e,t,n){"use strict";function i(e,n,i){r.directive(e,["$parse","$swipe",function(r,o){return function(s,a,l){function c(e){if(!u)return!1;var t=Math.abs(e.y-u.y);return e=(e.x-u.x)*n,h&&75>t&&e>0&&e>30&&.3>t/e}var u,h,d=r(l[e]),p=["touch"];t.isDefined(l.ngSwipeDisableMouse)||p.push("mouse"),o.bind(a,{start:function(e,t){u=e,h=!0},cancel:function(e){h=!1},end:function(e,t){c(e)&&s.$apply(function(){a.triggerHandler(i),d(s,{$event:t})})}},p)}}])}var r=t.module("ngTouch",[]);r.factory("$swipe",[function(){function e(e){var t=e.touches&&e.touches.length?e.touches:[e];return e=e.changedTouches&&e.changedTouches[0]||e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]||t[0].originalEvent||t[0],{x:e.clientX,y:e.clientY}}function n(e,n){var r=[];return t.forEach(e,function(e){(e=i[e][n])&&r.push(e)}),r.join(" ")}var i={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}};return{bind:function(t,i,r){var o,s,a,l,c=!1;r=r||["mouse","touch"],t.on(n(r,"start"),function(t){a=e(t),c=!0,s=o=0,l=a,i.start&&i.start(a,t)});var u=n(r,"cancel");u&&t.on(u,function(e){c=!1,i.cancel&&i.cancel(e)}),t.on(n(r,"move"),function(t){if(c&&a){var n=e(t);o+=Math.abs(n.x-l.x),s+=Math.abs(n.y-l.y),l=n,10>o&&10>s||(s>o?(c=!1,i.cancel&&i.cancel(t)):(t.preventDefault(),i.move&&i.move(n,t)))}}),t.on(n(r,"end"),function(t){c&&(c=!1,i.end&&i.end(e(t),t))})}}}]),r.config(["$provide",function(e){e.decorator("ngClickDirective",["$delegate",function(e){return e.shift(),e}])}]),r.directive("ngClick",["$parse","$timeout","$rootElement",function(e,n,i){function r(e,t,n){for(var i=0;i<e.length;i+=2){var r=e[i+1],o=n;if(25>Math.abs(e[i]-t)&&25>Math.abs(r-o))return e.splice(i,i+2),!0}return!1}function o(e){if(!(2500<Date.now()-a)){var t=e.touches&&e.touches.length?e.touches:[e],n=t[0].clientX,t=t[0].clientY;1>n&&1>t||c&&c[0]===n&&c[1]===t||(c&&(c=null),"label"===e.target.tagName.toLowerCase()&&(c=[n,t]),r(l,n,t)||(e.stopPropagation(),e.preventDefault(),e.target&&e.target.blur()))}}function s(e){e=e.touches&&e.touches.length?e.touches:[e];var t=e[0].clientX,i=e[0].clientY;l.push(t,i),n(function(){for(var e=0;e<l.length;e+=2)if(l[e]==t&&l[e+1]==i){l.splice(e,e+2);break}},2500,!1)}var a,l,c;return function(n,c,u){function h(){v=!1,c.removeClass("ng-click-active")}var d,p,f,g,m=e(u.ngClick),v=!1;c.on("touchstart",function(e){v=!0,d=e.target?e.target:e.srcElement,3==d.nodeType&&(d=d.parentNode),c.addClass("ng-click-active"),p=Date.now(),e=e.touches&&e.touches.length?e.touches:[e],e=e[0].originalEvent||e[0],f=e.clientX,g=e.clientY}),c.on("touchmove",function(e){h()}),c.on("touchcancel",function(e){h()}),c.on("touchend",function(e){var n=Date.now()-p,m=e.changedTouches&&e.changedTouches.length?e.changedTouches:e.touches&&e.touches.length?e.touches:[e],b=m[0].originalEvent||m[0],m=b.clientX,b=b.clientY,y=Math.sqrt(Math.pow(m-f,2)+Math.pow(b-g,2));v&&750>n&&12>y&&(l||(i[0].addEventListener("click",o,!0),i[0].addEventListener("touchstart",s,!0),l=[]),a=Date.now(),r(l,m,b),d&&d.blur(),t.isDefined(u.disabled)&&!1!==u.disabled||c.triggerHandler("click",[e])),h()}),c.onclick=function(e){},c.on("click",function(e,t){n.$apply(function(){m(n,{$event:t||e})})}),c.on("mousedown",function(e){c.addClass("ng-click-active")}),c.on("mousemove mouseup",function(e){c.removeClass("ng-click-active")})}}]),i("ngSwipeLeft",-1,"swipeleft"),i("ngSwipeRight",1,"swiperight")}(window,window.angular),angular.module("ui.slider",[]).value("uiSliderConfig",{}).directive("uiSlider",["uiSliderConfig","$timeout",function(e,t){return e=e||{},{require:"ngModel",compile:function(){return function(n,i,r,o){function s(e,t){return t?parseFloat(e):parseInt(e)}function a(){i.slider("destroy")}var l=angular.extend(n.$eval(r.uiSlider)||{},e),c={min:null,max:null},u=["min","max","step"],h=angular.isUndefined(r.useDecimals)?!1:!0,d=function(){angular.isArray(o.$viewValue)&&l.range!==!0&&(console.warn("Change your range option of ui-slider. When assigning ngModel an array of values then the range option should be set to true."),l.range=!0),angular.forEach(u,function(e){angular.isDefined(r[e])&&(l[e]=s(r[e],h))}),i.slider(l),d=angular.noop};angular.forEach(u,function(e){r.$observe(e,function(t){t&&(d(),i.slider("option",e,s(t,h)),o.$render())})}),r.$observe("disabled",function(e){d(),i.slider("option","disabled",!!e)}),n.$watch(r.uiSlider,function(e){d(),void 0!=e&&i.slider("option",e)},!0),t(d,0,!0),i.bind("slide",function(e,t){o.$setViewValue(t.values||t.value),n.$apply()}),o.$render=function(){d();var e=l.range===!0?"values":"value";l.range||!isNaN(o.$viewValue)||o.$viewValue instanceof Array?l.range&&!angular.isDefined(o.$viewValue)&&(o.$viewValue=[0,0]):o.$viewValue=0,l.range===!0&&(angular.isDefined(l.min)&&l.min>o.$viewValue[0]&&(o.$viewValue[0]=l.min),angular.isDefined(l.max)&&l.max<o.$viewValue[1]&&(o.$viewValue[1]=l.max),o.$viewValue[0]>o.$viewValue[1]&&(c.min>=o.$viewValue[1]&&(o.$viewValue[0]=c.min),c.max<=o.$viewValue[0]&&(o.$viewValue[1]=c.max)),c.min=o.$viewValue[0],c.max=o.$viewValue[1]),i.slider(e,o.$viewValue)},n.$watch(r.ngModel,function(){l.range===!0&&o.$render()},!0),i.bind("$destroy",a)}}}}]),!function(){"use strict";angular.module("cfp.hotkeys",[]).provider("hotkeys",function(){this.includeCheatSheet=!0,this.templateTitle="Keyboard Shortcuts:",this.template='<div class="cfp-hotkeys-container fade" ng-class="{in: helpVisible}" style="display: none;"><div class="cfp-hotkeys"><h4 class="cfp-hotkeys-title">{{ title }}</h4><table><tbody><tr ng-repeat="hotkey in hotkeys | filter:{ description: \'!$$undefined$$\' }"><td class="cfp-hotkeys-keys"><span ng-repeat="key in hotkey.format() track by $index" class="cfp-hotkeys-key">{{ key }}</span></td><td class="cfp-hotkeys-text">{{ hotkey.description }}</td></tr></tbody></table><div class="cfp-hotkeys-close" ng-click="toggleCheatSheet()">×</div></div></div>',this.cheatSheetHotkey="?",this.cheatSheetDescription="Show / hide this help menu",this.$get=["$rootElement","$rootScope","$compile","$window","$document",function(e,t,n,i,r){function o(e){var t={command:"⌘",shift:"⇧",left:"←",right:"→",up:"↑",down:"↓","return":"↩",backspace:"⌫"};e=e.split("+");for(var n=0;n<e.length;n++)"mod"===e[n]&&(e[n]=i.navigator&&i.navigator.platform.indexOf("Mac")>=0?"command":"ctrl"),e[n]=t[e[n]]||e[n];return e.join(" + ")}function s(e,t,n,i,r,o){this.combo=e instanceof Array?e:[e],this.description=t,this.callback=n,this.action=i,this.allowIn=r,this.persistent=o}function a(){for(var e=f.hotkeys.length;e--;){var t=f.hotkeys[e];t&&!t.persistent&&u(t)}}function l(){f.helpVisible=!f.helpVisible,f.helpVisible?(y=h("esc"),u("esc"),c("esc",y.description,l)):(u("esc"),y!==!1&&c(y))}function c(e,t,n,i,r,o){var a,l=["INPUT","SELECT","TEXTAREA"],c=Object.prototype.toString.call(e);if("[object Object]"===c&&(t=e.description,n=e.callback,i=e.action,o=e.persistent,r=e.allowIn,e=e.combo),t instanceof Function?(i=n,n=t,t="$$undefined$$"):angular.isUndefined(t)&&(t="$$undefined$$"),void 0===o&&(o=!0),"function"==typeof n){a=n,r instanceof Array||(r=[]);for(var u,h=0;h<r.length;h++)r[h]=r[h].toUpperCase(),u=l.indexOf(r[h]),-1!==u&&l.splice(u,1);n=function(e){var t=!0,n=e.target||e.srcElement,i=n.nodeName.toUpperCase();if((" "+n.className+" ").indexOf(" mousetrap ")>-1)t=!0;else for(var r=0;r<l.length;r++)if(l[r]===i){t=!1;break}t&&p(a.apply(this,arguments))}}"string"==typeof i?Mousetrap.bind(e,p(n),i):Mousetrap.bind(e,p(n));var d=new s(e,t,n,i,r,o);return f.hotkeys.push(d),d}function u(e){var t=e instanceof s?e.combo:e;if(Mousetrap.unbind(t),angular.isArray(t)){for(var n=!0,i=t.length;i--;)n=u(t[i])&&n;return n}var r=f.hotkeys.indexOf(h(t));return r>-1?(f.hotkeys[r].combo.length>1?f.hotkeys[r].combo.splice(f.hotkeys[r].combo.indexOf(t),1):f.hotkeys.splice(r,1),!0):!1}function h(e){for(var t,n=0;n<f.hotkeys.length;n++)if(t=f.hotkeys[n],t.combo.indexOf(e)>-1)return t;return!1}function d(e){return e.$id in g||(g[e.$id]=[],e.$on("$destroy",function(){for(var t=g[e.$id].length;t--;)u(g[e.$id][t]),delete g[e.$id][t]})),{add:function(t){var n;return n=arguments.length>1?c.apply(this,arguments):c(t),g[e.$id].push(n),this}}}function p(e){return function(n,i){if(e instanceof Array){var r=e[0],o=e[1];e=function(){o.scope.$eval(r)}}t.$apply(function(){e(n,h(i))})}}Mousetrap.stopCallback=function(e,t){return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:t.contentEditable&&"true"==t.contentEditable},s.prototype.format=function(){for(var e=this.combo[0],t=e.split(/[\s]/),n=0;n<t.length;n++)t[n]=o(t[n]);return t};var f=t.$new();f.hotkeys=[],f.helpVisible=!1,f.title=this.templateTitle,f.toggleCheatSheet=l;var g=[];if(t.$on("$routeChangeSuccess",function(e,t){a(),t&&t.hotkeys&&angular.forEach(t.hotkeys,function(e){var n=e[2];("string"==typeof n||n instanceof String)&&(e[2]=[n,t]),e[5]=!1,c.apply(this,e)})}),this.includeCheatSheet){var m=r[0],v=e[0],b=angular.element(this.template);c(this.cheatSheetHotkey,this.cheatSheetDescription,l),(v===m||v===m.documentElement)&&(v=m.body),angular.element(v).append(n(b)(f))}var y=!1,w={add:c,del:u,get:h,bindTo:d,template:this.template,toggleCheatSheet:l,includeCheatSheet:this.includeCheatSheet,cheatSheetHotkey:this.cheatSheetHotkey,cheatSheetDescription:this.cheatSheetDescription,purgeHotkeys:a,templateTitle:this.templateTitle};return w}]}).directive("hotkey",["hotkeys",function(e){return{restrict:"A",link:function(t,n,i){var r,o;angular.forEach(t.$eval(i.hotkey),function(t,n){o="string"==typeof i.hotkeyAllowIn?i.hotkeyAllowIn.split(/[\s,]+/):[],r=n,e.add({combo:n,description:i.hotkeyDescription,callback:t,action:i.hotkeyAction,allowIn:o})}),n.bind("$destroy",function(){e.del(r)})}}}]).run(["hotkeys",function(){}])}(),function(e,t){function n(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function i(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return $[e.which]?$[e.which]:k[e.which]?k[e.which]:String.fromCharCode(e.which).toLowerCase()}function r(e,t){return e.sort().join(",")===t.sort().join(",")}function o(e){e=e||{};var t,n=!1;for(t in A)e[t]?n=!0:A[t]=0;n||(M=!1)}function s(e,t,n,i,o,s){var a,l,c=[],u=n.type;if(!E[e])return[];for("keyup"==u&&p(e)&&(t=[e]),a=0;a<E[e].length;++a)if(l=E[e][a],(i||!l.seq||A[l.seq]==l.level)&&u==l.action&&("keypress"==u&&!n.metaKey&&!n.ctrlKey||r(t,l.modifiers))){var h=!i&&l.combo==o,d=i&&l.seq==i&&l.level==s;(h||d)&&E[e].splice(a,1),c.push(l)}return c}function a(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function l(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function c(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function u(e,t,n,i){R.stopCallback(t,t.target||t.srcElement,n,i)||e(t,n)===!1&&(l(t),c(t))}function h(e,t,n){var i,r=s(e,t,n),a={},l=0,c=!1;for(i=0;i<r.length;++i)r[i].seq&&(l=Math.max(l,r[i].level));for(i=0;i<r.length;++i)if(r[i].seq){if(r[i].level!=l)continue;c=!0,a[r[i].seq]=1,u(r[i].callback,n,r[i].combo,r[i].seq)}else c||u(r[i].callback,n,r[i].combo);var h="keypress"==n.type&&I;n.type!=M||p(e)||h||o(a),I=c&&"keydown"==n.type}function d(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=i(e);return t?"keyup"==e.type&&O===t?void(O=!1):void R.handleKey(t,a(e),e):void 0}function p(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function f(){clearTimeout(C),C=setTimeout(o,1e3)}function g(){if(!x){x={};for(var e in $)e>95&&112>e||$.hasOwnProperty(e)&&(x[$[e]]=e)}return x}function m(e,t,n){return n||(n=g()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function v(e,t,n,r){function s(t){return function(){M=t,++A[e],f()}}function a(t){u(n,t,e),"keyup"!==r&&(O=i(t)),setTimeout(o,10)}A[e]=0;for(var l=0;l<t.length;++l){var c=l+1===t.length,h=c?a:s(r||y(t[l+1]).action);w(t[l],h,r,e,l)}}function b(e){return"+"===e?["+"]:e.split("+")}function y(e,t){var n,i,r,o=[];for(n=b(e),r=0;r<n.length;++r)i=n[r],T[i]&&(i=T[i]),t&&"keypress"!=t&&S[i]&&(i=S[i],o.push("shift")),p(i)&&o.push(i);return t=m(i,o,t),{key:i,modifiers:o,action:t}}function w(e,t,n,i,r){D[e+":"+n]=t,e=e.replace(/\s+/g," ");var o,a=e.split(" ");return a.length>1?void v(e,a,t,n):(o=y(e,n),E[o.key]=E[o.key]||[],s(o.key,o.modifiers,{type:o.action},i,e,r),void E[o.key][i?"unshift":"push"]({callback:t,modifiers:o.modifiers,action:o.action,seq:i,level:r,combo:e}))}function _(e,t,n){for(var i=0;i<e.length;++i)w(e[i],t,n)}for(var x,C,$={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},k={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},S={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},T={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},E={},D={},A={},O=!1,I=!1,M=!1,P=1;20>P;++P)$[111+P]="f"+P;for(P=0;9>=P;++P)$[P+96]=P;n(t,"keypress",d),n(t,"keydown",d),n(t,"keyup",d);var R={bind:function(e,t,n){return e=e instanceof Array?e:[e],_(e,t,n),this},unbind:function(e,t){return R.bind(e,function(){},t)},trigger:function(e,t){return D[e+":"+t]&&D[e+":"+t]({},e),this},reset:function(){return E={},D={},this},stopCallback:function(e,t){return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},handleKey:h};e.Mousetrap=R,"function"==typeof define&&define.amd&&define(R)}(window,document),angular.module("toastr",[]).directive("toast",["$compile","$timeout","toastr",function(e,t,n){return{replace:!0,templateUrl:"templates/toastr/toastr.html",link:function(i,r){function o(e){return t(function(){n.remove(i.toastId)},e)}var s;if(i.toastClass=i.options.toastClass,i.titleClass=i.options.titleClass,i.messageClass=i.options.messageClass,i.options.closeHtml){var a=angular.element(i.options.closeHtml);a.addClass("toast-close-button"),a.attr("ng-click","close()"),e(a)(i),r.prepend(a)}i.init=function(){i.options.timeOut&&(s=o(i.options.timeOut))},r.on("mouseenter",function(){s&&t.cancel(s)}),i.tapToast=function(){i.options.tapToDismiss&&i.close()},i.close=function(){n.remove(i.toastId)},r.on("mouseleave",function(){(0!==i.options.timeOut||0!==i.options.extendedTimeOut)&&(s=o(i.options.extendedTimeOut))})}}}]).constant("toastrConfig",{allowHtml:!1,closeButton:!1,closeHtml:"<button>&times;</button>",containerId:"toast-container",extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},messageClass:"toast-message",positionClass:"toast-top-right",tapToDismiss:!0,timeOut:5e3,titleClass:"toast-title",toastClass:"toast"}).factory("toastr",["$animate","$compile","$document","$rootScope","$sce","toastrConfig","$q",function(e,t,n,i,r,o,s){function a(e){if(e)g(e.toastId);else for(var t=0;t<b.length;t++)g(b[t].toastId)}function l(e,t,n){return f({iconClass:d().iconClasses.error,message:e,optionsOverride:n,title:t})}function c(e,t,n){return f({iconClass:d().iconClasses.info,message:e,optionsOverride:n,title:t})}function u(e,t,n){return f({iconClass:d().iconClasses.success,message:e,optionsOverride:n,title:t})}function h(e,t,n){return f({iconClass:d().iconClasses.warning,message:e,optionsOverride:n,title:t})}function d(){return angular.extend({},o)}function p(t){if(m)return y.promise;m=angular.element("<div></div>"),m.attr("id",t.containerId),m.addClass(t.positionClass),m.css({"pointer-events":"auto"});var i=n.find("body").eq(0);return e.enter(m,i,null,function(){y.resolve()}),y.promise}function f(n){function o(e,t,n){n.allowHtml?(e.scope.allowHtml=!0,e.scope.title=r.trustAsHtml(t.title),e.scope.message=r.trustAsHtml(t.message)):(e.scope.title=t.title,e.scope.message=t.message),e.scope.toastType=e.iconClass,e.scope.toastId=e.toastId,e.scope.options={extendedTimeOut:n.extendedTimeOut,messageClass:n.messageClass,tapToDismiss:n.tapToDismiss,timeOut:n.timeOut,titleClass:n.titleClass,toastClass:n.toastClass},n.closeButton&&(e.scope.options.closeHtml=n.closeHtml)}function s(e){var n=angular.element("<div toast></div>");return t(n)(e)}var a=d(),l={toastId:v++,scope:i.$new()};return l.iconClass=n.iconClass,n.optionsOverride&&(a=angular.extend(a,n.optionsOverride),l.iconClass=n.optionsOverride.iconClass||l.iconClass),o(l,n,a),l.el=s(l.scope),b.push(l),p(a).then(function(){e.enter(l.el,m,null,function(){l.scope.init()})}),l}function g(t){function n(e){for(var t=0;t<b.length;t++)if(b[t].toastId===e)return b[t]}var i=n(t);i&&e.leave(i.el,function(){i.scope.$destroy(),m&&0===m.children().length&&(b=[],m.remove(),m=null,y=s.defer())})}var m,v=0,b=[],y=s.defer(),w={clear:a,error:l,info:c,remove:g,success:u,warning:h};return w}]),angular.module("toastr").run(["$templateCache",function(e){"use strict";e.put("templates/toastr/toastr.html",'<div class="{{toastClass}} {{toastType}}" ng-click="tapToast()">\n  <div ng-switch on="allowHtml">\n    <div ng-switch-default ng-if="title" class="{{titleClass}}">{{title}}</div>\n    <div ng-switch-default class="{{messageClass}}">{{message}}</div>\n    <div ng-switch-when="true" ng-if="title" class="{{titleClass}}" ng-bind-html="title"></div>\n    <div ng-switch-when="true" class="{{messageClass}}" ng-bind-html="message"></div>\n  </div>\n</div>')}]),!function(e,t){"use strict";return"function"==typeof define&&define.amd?void define(["angular"],function(e){return t(e)}):t(e)}(angular||null,function(e){"use strict";var t=e.module("ngTable",[]);t.factory("ngTableParams",["$q","$log",function(t,n){var i=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},r=function(r,o){var s=this,a=function(){c.debugMode&&n.debug&&n.debug.apply(this,arguments)};this.data=[],this.parameters=function(t,n){if(n=n||!1,e.isDefined(t)){for(var r in t){var o=t[r];if(n&&r.indexOf("[")>=0){for(var s=r.split(/\[(.*)\]/).reverse(),c="",u=0,h=s.length;h>u;u++){var d=s[u];if(""!==d){var p=o;o={},o[c=d]=i(p)?parseFloat(p):p}}"sorting"===c&&(l[c]={}),l[c]=e.extend(l[c]||{},o[c])}else l[r]=i(t[r])?parseFloat(t[r]):t[r]}return a("ngTable: set parameters",l),this}return l},this.settings=function(t){return e.isDefined(t)?(e.isArray(t.data)&&(t.total=t.data.length),c=e.extend(c,t),a("ngTable: set settings",c),this):c},this.page=function(t){return e.isDefined(t)?this.parameters({page:t}):l.page},this.total=function(t){return e.isDefined(t)?this.settings({total:t}):c.total},this.count=function(t){return e.isDefined(t)?this.parameters({count:t,page:1}):l.count},this.filter=function(t){return e.isDefined(t)?this.parameters({filter:t}):l.filter},this.sorting=function(t){if(2==arguments.length){var n={};return n[t]=arguments[1],this.parameters({sorting:n}),this}return e.isDefined(t)?this.parameters({sorting:t}):l.sorting},this.isSortBy=function(t,n){return e.isDefined(l.sorting[t])&&l.sorting[t]==n},this.orderBy=function(){var e=[];for(var t in l.sorting)e.push(("asc"===l.sorting[t]?"+":"-")+t);return e},this.getData=function(t,n){t.resolve(e.isArray(this.data)&&e.isObject(n)?this.data.slice((n.page()-1)*n.count(),n.page()*n.count()):[])},this.getGroups=function(n,i){var r=t.defer();r.promise.then(function(t){var r={};e.forEach(t,function(t){var n=e.isFunction(i)?i(t):t[i];r[n]=r[n]||{data:[]},r[n].value=n,r[n].data.push(t)});var o=[];for(var s in r)o.push(r[s]);a("ngTable: refresh groups",o),n.resolve(o)}),this.getData(r,s)},this.generatePagesArray=function(e,t,n){var i,r,o,s,a,l;if(i=11,l=[],a=Math.ceil(t/n),a>1){l.push({type:"prev",number:Math.max(1,e-1),active:e>1}),l.push({type:"first",number:1,active:e>1}),o=Math.round((i-5)/2),s=Math.max(2,e-o),r=Math.min(a-1,e+2*o-(e-s)),s=Math.max(2,s-(2*o-(r-s)));for(var c=s;r>=c;)l.push(c===s&&2!==c||c===r&&c!==a-1?{type:"more",active:!1}:{type:"page",number:c,active:e!==c}),c++;l.push({type:"last",number:a,active:e!==a}),l.push({type:"next",number:Math.min(a,e+1),active:a>e})}return l},this.url=function(t){t=t||!1;var n=t?[]:{};for(var i in l)if(l.hasOwnProperty(i)){var r=l[i],o=encodeURIComponent(i);if("object"==typeof r){for(var s in r)if(!e.isUndefined(r[s])&&""!==r[s]){var a=o+"["+encodeURIComponent(s)+"]";t?n.push(a+"="+r[s]):n[a]=r[s]}}else e.isFunction(r)||e.isUndefined(r)||""===r||(t?n.push(o+"="+encodeURIComponent(r)):n[o]=encodeURIComponent(r))}return n},this.reload=function(){var e=t.defer(),n=this;c.$loading=!0,c.groupBy?c.getGroups(e,c.groupBy,this):c.getData(e,this),a("ngTable: reload data"),e.promise.then(function(e){c.$loading=!1,a("ngTable: current scope",c.$scope),n.data=c.groupBy?c.$scope.$groups=e:c.$scope.$data=e,c.$scope.pages=n.generatePagesArray(n.page(),n.total(),n.count()),
c.$scope.$emit("ngTableAfterReloadData")})},this.reloadPages=function(){var e=this;c.$scope.pages=e.generatePagesArray(e.page(),e.total(),e.count())};var l=this.$params={page:1,count:1,filter:{},sorting:{},group:{},groupBy:null},c={$scope:null,$loading:!1,data:null,total:0,defaultSort:"desc",filterDelay:750,counts:[10,25,50,100],getGroups:this.getGroups,getData:this.getData};return this.settings(o),this.parameters(r,!0),this};return r}]);var n=["$scope","ngTableParams","$timeout",function(t,n,i){t.$loading=!1,t.params||(t.params=new n),t.params.settings().$scope=t;var r=function(){var e=0;return function(t,n){i.cancel(e),e=i(t,n)}}();t.$watch("params.$params",function(n,i){t.params.settings().$scope=t,e.equals(n.filter,i.filter)?t.params.reload():r(function(){t.params.$params.page=1,t.params.reload()},t.params.settings().filterDelay)},!0),t.sortBy=function(e,n){var i=t.parse(e.sortable);if(i){var r=t.params.settings().defaultSort,o="asc"===r?"desc":"asc",s=t.params.sorting()&&t.params.sorting()[i]&&t.params.sorting()[i]===r,a=n.ctrlKey||n.metaKey?t.params.sorting():{};a[i]=s?o:r,t.params.parameters({sorting:a})}}}];return t.directive("ngTable",["$compile","$q","$parse",function(t,i,r){return{restrict:"A",priority:1001,scope:!0,controller:n,compile:function(n){var i=[],o=0,s=null,a=n.find("thead");return e.forEach(e.element(n.find("tr")),function(t){t=e.element(t),t.hasClass("ng-table-group")||s||(s=t)}),s?(e.forEach(s.find("td"),function(t){var n=e.element(t);if(!n.attr("ignore-cell")||"true"!==n.attr("ignore-cell")){var s=function(e,t){return function(o){return r(n.attr("x-data-"+e)||n.attr("data-"+e)||n.attr(e))(o,{$columns:i})||t}},a=s("title"," "),l=s("header",!1),c=s("filter",!1)(),u=!1,h=!1;c&&c.$$name&&(h=c.$$name,delete c.$$name),c&&c.templateURL&&(u=c.templateURL,delete c.templateURL),n.attr("data-title-text",a()),i.push({id:o++,title:a,sortable:s("sortable",!1),"class":n.attr("x-data-header-class")||n.attr("data-header-class")||n.attr("header-class"),filter:c,filterTemplateURL:u,filterName:h,headerTemplateURL:l,filterData:n.attr("filter-data")?n.attr("filter-data"):null,show:n.attr("ng-show")?function(e){return r(n.attr("ng-show"))(e)}:function(){return!0}})}}),function(n,o,s){if(n.$loading=!1,n.$columns=i,n.$watch(s.ngTable,function(t){e.isUndefined(t)||(n.paramsModel=r(s.ngTable),n.params=t)},!0),n.parse=function(t){return e.isDefined(t)?t(n):""},s.showFilter&&n.$parent.$watch(s.showFilter,function(e){n.show_filter=e}),e.forEach(i,function(t){var i;if(t.filterData){if(i=r(t.filterData)(n,{$column:t}),!e.isObject(i)||!e.isObject(i.promise))throw new Error("Function "+t.filterData+" must be instance of $q.defer()");return delete t.filterData,i.promise.then(function(n){e.isArray(n)||(n=[]),n.unshift({title:"-",id:""}),t.data=n})}}),!o.hasClass("ng-table")){n.templates={header:s.templateHeader?s.templateHeader:"ng-table/header.html",pagination:s.templatePagination?s.templatePagination:"ng-table/pager.html"};var l=a.length>0?a:e.element(document.createElement("thead")).attr("ng-include","templates.header"),c=e.element(document.createElement("div")).attr({"ng-table-pagination":"params","template-url":"templates.pagination"});o.find("thead").remove(),o.addClass("ng-table").prepend(l).after(c),t(l)(n),t(c)(n)}}):void 0}}}]),t.directive("ngTablePagination",["$compile",function(t){return{restrict:"A",scope:{params:"=ngTablePagination",templateUrl:"="},replace:!1,link:function(n,i){n.params.settings().$scope.$on("ngTableAfterReloadData",function(){n.pages=n.params.generatePagesArray(n.params.page(),n.params.total(),n.params.count())},!0),n.$watch("templateUrl",function(r){if(!e.isUndefined(r)){var o=e.element(document.createElement("div"));o.attr({"ng-include":"templateUrl"}),i.append(o),t(o)(n)}})}}}]),e.module("ngTable").run(["$templateCache",function(e){e.put("ng-table/filters/select-multiple.html",'<select ng-options="data.id as data.title for data in column.data" multiple ng-multiple="true" ng-model="params.filter()[name]" ng-show="filter==\'select-multiple\'" class="filter filter-select-multiple form-control" name="{{column.filterName}}"> </select>'),e.put("ng-table/filters/select.html",'<select ng-options="data.id as data.title for data in column.data" ng-model="params.filter()[name]" ng-show="filter==\'select\'" class="filter filter-select form-control" name="{{column.filterName}}"> </select>'),e.put("ng-table/filters/text.html",'<input type="text" name="{{column.filterName}}" ng-model="params.filter()[name]" ng-if="filter==\'text\'" class="input-filter form-control"/>'),e.put("ng-table/header.html",'<tr> <th ng-repeat="column in $columns" ng-class="{ \'sortable\': parse(column.sortable), \'sort-asc\': params.sorting()[parse(column.sortable)]==\'asc\', \'sort-desc\': params.sorting()[parse(column.sortable)]==\'desc\' }" ng-click="sortBy(column, $event)" ng-show="column.show(this)" ng-init="template=column.headerTemplateURL(this)" class="header {{column.class}}"> <div ng-if="!template" ng-show="!template" ng-bind="parse(column.title)"></div> <div ng-if="template" ng-show="template"><div ng-include="template"></div></div> </th> </tr> <tr ng-show="show_filter" class="ng-table-filters"> <th ng-repeat="column in $columns" ng-show="column.show(this)" class="filter"> <div ng-repeat="(name, filter) in column.filter"> <div ng-if="column.filterTemplateURL" ng-show="column.filterTemplateURL"> <div ng-include="column.filterTemplateURL"></div> </div> <div ng-if="!column.filterTemplateURL" ng-show="!column.filterTemplateURL"> <div ng-include="\'ng-table/filters/\' + filter + \'.html\'"></div> </div> </div> </th> </tr>'),e.put("ng-table/pager.html",'<div class="ng-cloak ng-table-pager"> <div ng-if="params.settings().counts.length" class="ng-table-counts btn-group pull-right"> <button ng-repeat="count in params.settings().counts" type="button" ng-class="{\'active\':params.count()==count}" ng-click="params.count(count)" class="btn btn-default"> <span ng-bind="count"></span> </button> </div> <ul class="pagination ng-table-pagination"> <li ng-class="{\'disabled\': !page.active}" ng-repeat="page in pages" ng-switch="page.type"> <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo;</a> <a ng-switch-when="first" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="page" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="more" ng-click="params.page(page.number)" href="">&#8230;</a> <a ng-switch-when="last" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="next" ng-click="params.page(page.number)" href="">&raquo;</a> </li> </ul> </div> ')}]),t}),!function(e,t){return"function"==typeof define&&define.amd?void define("angular-file-upload",["angular"],function(e){return t(e)}):t(e)}("undefined"==typeof angular?null:angular,function(e){var t=e.module("angularFileUpload",[]);return t.value("fileUploaderOptions",{url:"/",alias:"file",headers:{},queue:[],progress:0,autoUpload:!1,removeAfterUpload:!1,method:"POST",filters:[],formData:[],queueLimit:Number.MAX_VALUE,withCredentials:!1}).factory("FileUploader",["fileUploaderOptions","$rootScope","$http","$window","$compile",function(t,n,i,r,o){function s(n){var i=e.copy(t);e.extend(this,i,n,{isUploading:!1,_nextIndex:0,_failFilterIndex:-1,_directives:{select:[],drop:[],over:[]}}),this.filters.unshift({name:"queueLimit",fn:this._queueLimitFilter}),this.filters.unshift({name:"folder",fn:this._folderFilter})}function a(t){var n=e.isElement(t),i=n?t.value:t,r=e.isString(i)?"FakePath":"Object",o="_createFrom"+r;this[o](i)}function l(t,n,i){var r=e.isElement(n),o=r?e.element(n):null,a=r?null:n;e.extend(this,{url:t.url,alias:t.alias,headers:e.copy(t.headers),formData:e.copy(t.formData),removeAfterUpload:t.removeAfterUpload,withCredentials:t.withCredentials,method:t.method},i,{uploader:t,file:new s.FileLikeObject(n),isReady:!1,isUploading:!1,isUploaded:!1,isSuccess:!1,isCancel:!1,isError:!1,progress:0,index:null,_file:a,_input:o}),o&&this._replaceNode(o)}function c(t){e.extend(this,t),this.uploader._directives[this.prop].push(this),this._saveLinks(),this.bind()}function u(){u.super_.apply(this,arguments),this.uploader.isHTML5||this.element.removeAttr("multiple"),this.element.prop("value",null)}function h(){h.super_.apply(this,arguments)}function d(){d.super_.apply(this,arguments)}return s.prototype.isHTML5=!(!r.File||!r.FormData),s.prototype.addToQueue=function(t,n,i){var r=this.isArrayLikeObject(t)?t:[t],o=this._getFilters(i),a=this.queue.length,l=[];e.forEach(r,function(e){var t=new s.FileLikeObject(e);if(this._isValidFile(t,o,n)){var i=new s.FileItem(this,e,n);l.push(i),this.queue.push(i),this._onAfterAddingFile(i)}else{var r=this.filters[this._failFilterIndex];this._onWhenAddingFileFailed(t,r,n)}},this),this.queue.length!==a&&(this._onAfterAddingAll(l),this.progress=this._getTotalProgress()),this._render(),this.autoUpload&&this.uploadAll()},s.prototype.removeFromQueue=function(e){var t=this.getIndexOfItem(e),n=this.queue[t];n.isUploading&&n.cancel(),this.queue.splice(t,1),n._destroy(),this.progress=this._getTotalProgress()},s.prototype.clearQueue=function(){for(;this.queue.length;)this.queue[0].remove();this.progress=0},s.prototype.uploadItem=function(e){var t=this.getIndexOfItem(e),n=this.queue[t],i=this.isHTML5?"_xhrTransport":"_iframeTransport";n._prepareToUploading(),this.isUploading||(this.isUploading=!0,this[i](n))},s.prototype.cancelItem=function(e){var t=this.getIndexOfItem(e),n=this.queue[t],i=this.isHTML5?"_xhr":"_form";n&&n.isUploading&&n[i].abort()},s.prototype.uploadAll=function(){var t=this.getNotUploadedItems().filter(function(e){return!e.isUploading});t.length&&(e.forEach(t,function(e){e._prepareToUploading()}),t[0].upload())},s.prototype.cancelAll=function(){var t=this.getNotUploadedItems();e.forEach(t,function(e){e.cancel()})},s.prototype.isFile=function(e){var t=r.File;return t&&e instanceof t},s.prototype.isFileLikeObject=function(e){return e instanceof s.FileLikeObject},s.prototype.isArrayLikeObject=function(t){return e.isObject(t)&&"length"in t},s.prototype.getIndexOfItem=function(t){return e.isNumber(t)?t:this.queue.indexOf(t)},s.prototype.getNotUploadedItems=function(){return this.queue.filter(function(e){return!e.isUploaded})},s.prototype.getReadyItems=function(){return this.queue.filter(function(e){return e.isReady&&!e.isUploading}).sort(function(e,t){return e.index-t.index})},s.prototype.destroy=function(){e.forEach(this._directives,function(t){e.forEach(this._directives[t],function(e){e.destroy()},this)},this)},s.prototype.onAfterAddingAll=function(){},s.prototype.onAfterAddingFile=function(){},s.prototype.onWhenAddingFileFailed=function(){},s.prototype.onBeforeUploadItem=function(){},s.prototype.onProgressItem=function(){},s.prototype.onProgressAll=function(){},s.prototype.onSuccessItem=function(){},s.prototype.onErrorItem=function(){},s.prototype.onCancelItem=function(){},s.prototype.onCompleteItem=function(){},s.prototype.onCompleteAll=function(){},s.prototype._getTotalProgress=function(e){if(this.removeAfterUpload)return e||0;var t=this.getNotUploadedItems().length,n=t?this.queue.length-t:this.queue.length,i=100/this.queue.length,r=(e||0)*i/100;return Math.round(n*i+r)},s.prototype._getFilters=function(t){if(e.isUndefined(t))return this.filters;if(e.isArray(t))return t;var n=t.split(/\s*,/);return this.filters.filter(function(e){return-1!==n.indexOf(e.name)},this)},s.prototype._render=function(){n.$$phase||n.$apply()},s.prototype._folderFilter=function(e){return!(!e.size&&!e.type)},s.prototype._queueLimitFilter=function(){return this.queue.length<this.queueLimit},s.prototype._isValidFile=function(e,t,n){return this._failFilterIndex=-1,t.length?t.every(function(t){return this._failFilterIndex++,t.fn.call(this,e,n)},this):!0},s.prototype._isSuccessCode=function(e){return e>=200&&300>e||304===e},s.prototype._transformResponse=function(t){return e.forEach(i.defaults.transformResponse,function(e){t=e(t)}),t},s.prototype._parseHeaders=function(t){function n(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function i(e){return e.toLowerCase()}var r,o,s,a={};return t?(e.forEach(t.split("\n"),function(e){s=e.indexOf(":"),r=i(n(e.substr(0,s))),o=n(e.substr(s+1)),r&&(a[r]=a[r]?a[r]+", "+o:o)}),a):a},s.prototype._xhrTransport=function(t){var n=t._xhr=new XMLHttpRequest,i=new FormData,r=this;r._onBeforeUploadItem(t),e.forEach(t.formData,function(t){e.forEach(t,function(e,t){i.append(t,e)})}),i.append(t.alias,t._file,t.file.name),n.upload.onprogress=function(e){var n=Math.round(e.lengthComputable?100*e.loaded/e.total:0);r._onProgressItem(t,n)},n.onload=function(){var e=r._parseHeaders(n.getAllResponseHeaders()),i=r._transformResponse(n.response),o=r._isSuccessCode(n.status)?"Success":"Error",s="_on"+o+"Item";r[s](t,i,n.status,e),r._onCompleteItem(t,i,n.status,e)},n.onerror=function(){var e=r._parseHeaders(n.getAllResponseHeaders()),i=r._transformResponse(n.response);r._onErrorItem(t,i,n.status,e),r._onCompleteItem(t,i,n.status,e)},n.onabort=function(){var e=r._parseHeaders(n.getAllResponseHeaders()),i=r._transformResponse(n.response);r._onCancelItem(t,i,n.status,e),r._onCompleteItem(t,i,n.status,e)},n.open(t.method,t.url,!0),n.withCredentials=t.withCredentials,e.forEach(t.headers,function(e,t){n.setRequestHeader(t,e)}),n.send(i),this._render()},s.prototype._iframeTransport=function(t){var n=e.element('<form style="display: none;" />'),i=e.element('<iframe name="iframeTransport'+Date.now()+'">'),r=t._input,o=this;t._form&&t._form.replaceWith(r),t._form=n,o._onBeforeUploadItem(t),r.prop("name",t.alias),e.forEach(t.formData,function(t){e.forEach(t,function(t,i){n.append(e.element('<input type="hidden" name="'+i+'" value="'+t+'" />'))})}),n.prop({action:t.url,method:"POST",target:i.prop("name"),enctype:"multipart/form-data",encoding:"multipart/form-data"}),i.bind("load",function(){try{var e=i[0].contentDocument.body.innerHTML}catch(n){}var r={response:e,status:200,dummy:!0},s=o._transformResponse(r.response),a={};o._onSuccessItem(t,s,r.status,a),o._onCompleteItem(t,s,r.status,a)}),n.abort=function(){var e,s={status:0,dummy:!0},a={};i.unbind("load").prop("src","javascript:false;"),n.replaceWith(r),o._onCancelItem(t,e,s.status,a),o._onCompleteItem(t,e,s.status,a)},r.after(n),n.append(r).append(i),n[0].submit(),this._render()},s.prototype._onWhenAddingFileFailed=function(e,t,n){this.onWhenAddingFileFailed(e,t,n)},s.prototype._onAfterAddingFile=function(e){this.onAfterAddingFile(e)},s.prototype._onAfterAddingAll=function(e){this.onAfterAddingAll(e)},s.prototype._onBeforeUploadItem=function(e){e._onBeforeUpload(),this.onBeforeUploadItem(e)},s.prototype._onProgressItem=function(e,t){var n=this._getTotalProgress(t);this.progress=n,e._onProgress(t),this.onProgressItem(e,t),this.onProgressAll(n),this._render()},s.prototype._onSuccessItem=function(e,t,n,i){e._onSuccess(t,n,i),this.onSuccessItem(e,t,n,i)},s.prototype._onErrorItem=function(e,t,n,i){e._onError(t,n,i),this.onErrorItem(e,t,n,i)},s.prototype._onCancelItem=function(e,t,n,i){e._onCancel(t,n,i),this.onCancelItem(e,t,n,i)},s.prototype._onCompleteItem=function(t,n,i,r){t._onComplete(n,i,r),this.onCompleteItem(t,n,i,r);var o=this.getReadyItems()[0];return this.isUploading=!1,e.isDefined(o)?void o.upload():(this.onCompleteAll(),this.progress=this._getTotalProgress(),void this._render())},s.isFile=s.prototype.isFile,s.isFileLikeObject=s.prototype.isFileLikeObject,s.isArrayLikeObject=s.prototype.isArrayLikeObject,s.isHTML5=s.prototype.isHTML5,s.inherit=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.super_=t},s.FileLikeObject=a,s.FileItem=l,s.FileDirective=c,s.FileSelect=u,s.FileDrop=h,s.FileOver=d,a.prototype._createFromFakePath=function(e){this.lastModifiedDate=null,this.size=null,this.type="like/"+e.slice(e.lastIndexOf(".")+1).toLowerCase(),this.name=e.slice(e.lastIndexOf("/")+e.lastIndexOf("\\")+2)},a.prototype._createFromObject=function(t){this.lastModifiedDate=e.copy(t.lastModifiedDate),this.size=t.size,this.type=t.type,this.name=t.name},l.prototype.upload=function(){this.uploader.uploadItem(this)},l.prototype.cancel=function(){this.uploader.cancelItem(this)},l.prototype.remove=function(){this.uploader.removeFromQueue(this)},l.prototype.onBeforeUpload=function(){},l.prototype.onProgress=function(){},l.prototype.onSuccess=function(){},l.prototype.onError=function(){},l.prototype.onCancel=function(){},l.prototype.onComplete=function(){},l.prototype._onBeforeUpload=function(){this.isReady=!0,this.isUploading=!0,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.onBeforeUpload()},l.prototype._onProgress=function(e){this.progress=e,this.onProgress(e)},l.prototype._onSuccess=function(e,t,n){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!0,this.isCancel=!1,this.isError=!1,this.progress=100,this.index=null,this.onSuccess(e,t,n)},l.prototype._onError=function(e,t,n){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!1,this.isCancel=!1,this.isError=!0,this.progress=0,this.index=null,this.onError(e,t,n)},l.prototype._onCancel=function(e,t,n){this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!0,this.isError=!1,this.progress=0,this.index=null,this.onCancel(e,t,n)},l.prototype._onComplete=function(e,t,n){this.onComplete(e,t,n),this.removeAfterUpload&&this.remove()},l.prototype._destroy=function(){this._input&&this._input.remove(),this._form&&this._form.remove(),delete this._form,delete this._input},l.prototype._prepareToUploading=function(){this.index=this.index||++this.uploader._nextIndex,this.isReady=!0},l.prototype._replaceNode=function(e){var t=o(e.clone())(e.scope());t.prop("value",null),e.css("display","none"),e.after(t)},c.prototype.events={},c.prototype.bind=function(){for(var e in this.events){var t=this.events[e];this.element.bind(e,this[t])}},c.prototype.unbind=function(){for(var e in this.events)this.element.unbind(e,this.events[e])},c.prototype.destroy=function(){var e=this.uploader._directives[this.prop].indexOf(this);this.uploader._directives[this.prop].splice(e,1),this.unbind()},c.prototype._saveLinks=function(){for(var e in this.events){var t=this.events[e];this[t]=this[t].bind(this)}},s.inherit(u,c),u.prototype.events={$destroy:"destroy",change:"onChange"},u.prototype.prop="select",u.prototype.getOptions=function(){},u.prototype.getFilters=function(){},u.prototype.isEmptyAfterSelection=function(){return!!this.element.attr("multiple")},u.prototype.onChange=function(){var e=this.uploader.isHTML5?this.element[0].files:this.element[0],t=this.getOptions(),n=this.getFilters();this.uploader.isHTML5||this.destroy(),this.uploader.addToQueue(e,t,n),this.isEmptyAfterSelection()&&this.element.prop("value",null)},s.inherit(h,c),h.prototype.events={$destroy:"destroy",drop:"onDrop",dragover:"onDragOver",dragleave:"onDragLeave"},h.prototype.prop="drop",h.prototype.getOptions=function(){},h.prototype.getFilters=function(){},h.prototype.onDrop=function(t){var n=this._getTransfer(t);if(n){var i=this.getOptions(),r=this.getFilters();this._preventAndStop(t),e.forEach(this.uploader._directives.over,this._removeOverClass,this),this.uploader.addToQueue(n.files,i,r)}},h.prototype.onDragOver=function(t){var n=this._getTransfer(t);this._haveFiles(n.types)&&(n.dropEffect="copy",this._preventAndStop(t),e.forEach(this.uploader._directives.over,this._addOverClass,this))},h.prototype.onDragLeave=function(t){t.target===this.element[0]&&(this._preventAndStop(t),e.forEach(this.uploader._directives.over,this._removeOverClass,this))},h.prototype._getTransfer=function(e){return e.dataTransfer?e.dataTransfer:e.originalEvent.dataTransfer},h.prototype._preventAndStop=function(e){e.preventDefault(),e.stopPropagation()},h.prototype._haveFiles=function(e){return e?e.indexOf?-1!==e.indexOf("Files"):e.contains?e.contains("Files"):!1:!1},h.prototype._addOverClass=function(e){e.addOverClass()},h.prototype._removeOverClass=function(e){e.removeOverClass()},s.inherit(d,c),d.prototype.events={$destroy:"destroy"},d.prototype.prop="over",d.prototype.overClass="nv-file-over",d.prototype.addOverClass=function(){this.element.addClass(this.getOverClass())},d.prototype.removeOverClass=function(){this.element.removeClass(this.getOverClass())},d.prototype.getOverClass=function(){return this.overClass},s}]).directive("nvFileSelect",["$parse","FileUploader",function(e,t){return{link:function(n,i,r){var o=n.$eval(r.uploader);if(!(o instanceof t))throw new TypeError('"Uploader" must be an instance of FileUploader');var s=new t.FileSelect({uploader:o,element:i});s.getOptions=e(r.options).bind(s,n),s.getFilters=function(){return r.filters}}}}]).directive("nvFileDrop",["$parse","FileUploader",function(e,t){return{link:function(n,i,r){var o=n.$eval(r.uploader);if(!(o instanceof t))throw new TypeError('"Uploader" must be an instance of FileUploader');if(o.isHTML5){var s=new t.FileDrop({uploader:o,element:i});s.getOptions=e(r.options).bind(s,n),s.getFilters=function(){return r.filters}}}}}]).directive("nvFileOver",["FileUploader",function(e){return{link:function(t,n,i){var r=t.$eval(i.uploader);if(!(r instanceof e))throw new TypeError('"Uploader" must be an instance of FileUploader');var o=new e.FileOver({uploader:r,element:n});o.getOverClass=function(){return i.overClass||this.overClass}}}}]),t}),"undefined"==typeof jQuery)throw new Error("Jasny Bootstrap's JavaScript requires jQuery");+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}void 0===e.support.transition&&(e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one(e.support.transition.end,function(){n=!0});var r=function(){n||e(i).trigger(e.support.transition.end)};return setTimeout(r,t),this},e(function(){e.support.transition=t()}))}(window.jQuery),+function(e){"use strict";var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,i),this.state=null,this.placement=null,this.options.recalc&&(this.calcClone(),e(window).on("resize",e.proxy(this.recalc,this))),this.options.autohide&&e(document).on("click",e.proxy(this.autohide,this)),this.options.toggle&&this.toggle(),this.options.disablescrolling&&(this.options.disableScrolling=this.options.disablescrolling,delete this.options.disablescrolling)};t.DEFAULTS={toggle:!0,placement:"auto",autohide:!0,recalc:!0,disableScrolling:!0},t.prototype.offset=function(){switch(this.placement){case"left":case"right":return this.$element.outerWidth();case"top":case"bottom":return this.$element.outerHeight()}},t.prototype.calcPlacement=function(){function t(e,t){if("auto"===r.css(t))return e;if("auto"===r.css(e))return t;var n=parseInt(r.css(e),10),i=parseInt(r.css(t),10);return n>i?t:e}if("auto"!==this.options.placement)return void(this.placement=this.options.placement);this.$element.hasClass("in")||this.$element.css("visiblity","hidden !important").addClass("in");var n=e(window).width()/this.$element.width(),i=e(window).height()/this.$element.height(),r=this.$element;this.placement=n>=i?t("left","right"):t("top","bottom"),"hidden !important"===this.$element.css("visibility")&&this.$element.removeClass("in").css("visiblity","")},t.prototype.opposite=function(e){switch(e){case"top":return"bottom";case"left":return"right";case"bottom":return"top";case"right":return"left"}},t.prototype.getCanvasElements=function(){var t=this.options.canvas?e(this.options.canvas):this.$element,n=t.find("*").filter(function(){return"fixed"===e(this).css("position")}).not(this.options.exclude);return t.add(n)},t.prototype.slide=function(t,n,i){if(!e.support.transition){var r={};return r[this.placement]="+="+n,t.animate(r,350,i)}var o=this.placement,s=this.opposite(o);t.each(function(){"auto"!==e(this).css(o)&&e(this).css(o,(parseInt(e(this).css(o),10)||0)+n),"auto"!==e(this).css(s)&&e(this).css(s,(parseInt(e(this).css(s),10)||0)-n)}),this.$element.one(e.support.transition.end,i).emulateTransitionEnd(350)},t.prototype.disableScrolling=function(){var t=e("body").width(),n="padding-"+this.opposite(this.placement);if(void 0===e("body").data("offcanvas-style")&&e("body").data("offcanvas-style",e("body").attr("style")||""),e("body").css("overflow","hidden"),e("body").width()>t){var i=parseInt(e("body").css(n),10)+e("body").width()-t;setTimeout(function(){e("body").css(n,i)},1)}},t.prototype.show=function(){if(!this.state){var t=e.Event("show.bs.offcanvas");if(this.$element.trigger(t),!t.isDefaultPrevented()){this.state="slide-in",this.calcPlacement();var n=this.getCanvasElements(),i=this.placement,r=this.opposite(i),o=this.offset();-1!==n.index(this.$element)&&(e(this.$element).data("offcanvas-style",e(this.$element).attr("style")||""),this.$element.css(i,-1*o),this.$element.css(i)),n.addClass("canvas-sliding").each(function(){void 0===e(this).data("offcanvas-style")&&e(this).data("offcanvas-style",e(this).attr("style")||""),"static"===e(this).css("position")&&e(this).css("position","relative"),"auto"!==e(this).css(i)&&"0px"!==e(this).css(i)||"auto"!==e(this).css(r)&&"0px"!==e(this).css(r)||e(this).css(i,0)}),this.options.disableScrolling&&this.disableScrolling();var s=function(){"slide-in"==this.state&&(this.state="slid",n.removeClass("canvas-sliding").addClass("canvas-slid"),this.$element.trigger("shown.bs.offcanvas"))};setTimeout(e.proxy(function(){this.$element.addClass("in"),this.slide(n,o,e.proxy(s,this))},this),1)}}},t.prototype.hide=function(){if("slid"===this.state){var t=e.Event("hide.bs.offcanvas");if(this.$element.trigger(t),!t.isDefaultPrevented()){this.state="slide-out";var n=e(".canvas-slid"),i=(this.placement,-1*this.offset()),r=function(){"slide-out"==this.state&&(this.state=null,this.placement=null,this.$element.removeClass("in"),n.removeClass("canvas-sliding"),n.add(this.$element).add("body").each(function(){e(this).attr("style",e(this).data("offcanvas-style")).removeData("offcanvas-style")}),this.$element.trigger("hidden.bs.offcanvas"))};n.removeClass("canvas-slid").addClass("canvas-sliding"),setTimeout(e.proxy(function(){this.slide(n,i,e.proxy(r,this))},this),1)}}},t.prototype.toggle=function(){"slide-in"!==this.state&&"slide-out"!==this.state&&this["slid"===this.state?"hide":"show"]()},t.prototype.calcClone=function(){this.$calcClone=this.$element.clone().html("").addClass("offcanvas-clone").removeClass("in").appendTo(e("body"))},t.prototype.recalc=function(){if("none"!==this.$calcClone.css("display")&&("slid"===this.state||"slide-in"===this.state)){this.state=null,this.placement=null;var t=this.getCanvasElements();this.$element.removeClass("in"),t.removeClass("canvas-slid"),t.add(this.$element).add("body").each(function(){e(this).attr("style",e(this).data("offcanvas-style")).removeData("offcanvas-style")})}},t.prototype.autohide=function(t){0===e(t.target).closest(this.$element).length&&this.hide()};var n=e.fn.offcanvas;e.fn.offcanvas=function(n){return this.each(function(){var i=e(this),r=i.data("bs.offcanvas"),o=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n);r||i.data("bs.offcanvas",r=new t(this,o)),"string"==typeof n&&r[n]()})},e.fn.offcanvas.Constructor=t,e.fn.offcanvas.noConflict=function(){return e.fn.offcanvas=n,this},e(document).on("click.bs.offcanvas.data-api","[data-toggle=offcanvas]",function(t){var n,i=e(this),r=i.attr("data-target")||t.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),o=e(r),s=o.data("bs.offcanvas"),a=s?"toggle":i.data();t.stopPropagation(),s?s.toggle():o.offcanvas(a)})}(window.jQuery),+function(e){"use strict";var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,i),this.$element.on("click.bs.rowlink","td:not(.rowlink-skip)",e.proxy(this.click,this))};t.DEFAULTS={target:"a"},t.prototype.click=function(t){var n=e(t.currentTarget).closest("tr").find(this.options.target)[0];if(e(t.target)[0]!==n)if(t.preventDefault(),n.click)n.click();else if(document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)}};var n=e.fn.rowlink;e.fn.rowlink=function(n){return this.each(function(){var i=e(this),r=i.data("bs.rowlink");r||i.data("bs.rowlink",r=new t(this,n))})},e.fn.rowlink.Constructor=t,e.fn.rowlink.noConflict=function(){return e.fn.rowlink=n,this},e(document).on("click.bs.rowlink.data-api",'[data-link="row"]',function(t){if(0===e(t.target).closest(".rowlink-skip").length){var n=e(this);n.data("bs.rowlink")||(n.rowlink(n.data()),e(t.target).trigger("click.bs.rowlink"))}})}(window.jQuery),+function(e){"use strict";var t=void 0!==window.orientation,n=navigator.userAgent.toLowerCase().indexOf("android")>-1,i="Microsoft Internet Explorer"==window.navigator.appName,r=function(t,i){n||(this.$element=e(t),this.options=e.extend({},r.DEFAULTS,i),this.mask=String(this.options.mask),this.init(),this.listen(),this.checkVal())};r.DEFAULTS={mask:"",placeholder:"_",definitions:{9:"[0-9]",a:"[A-Za-z]",w:"[A-Za-z0-9]","*":"."}},r.prototype.init=function(){var t=this.options.definitions,n=this.mask.length;this.tests=[],this.partialPosition=this.mask.length,this.firstNonMaskPos=null,e.each(this.mask.split(""),e.proxy(function(e,i){"?"==i?(n--,this.partialPosition=e):t[i]?(this.tests.push(new RegExp(t[i])),null===this.firstNonMaskPos&&(this.firstNonMaskPos=this.tests.length-1)):this.tests.push(null)},this)),this.buffer=e.map(this.mask.split(""),e.proxy(function(e){return"?"!=e?t[e]?this.options.placeholder:e:void 0},this)),this.focusText=this.$element.val(),this.$element.data("rawMaskFn",e.proxy(function(){return e.map(this.buffer,function(e,t){return this.tests[t]&&e!=this.options.placeholder?e:null}).join("")},this))},r.prototype.listen=function(){if(!this.$element.attr("readonly")){var t=(i?"paste":"input")+".mask";this.$element.on("unmask.bs.inputmask",e.proxy(this.unmask,this)).on("focus.bs.inputmask",e.proxy(this.focusEvent,this)).on("blur.bs.inputmask",e.proxy(this.blurEvent,this)).on("keydown.bs.inputmask",e.proxy(this.keydownEvent,this)).on("keypress.bs.inputmask",e.proxy(this.keypressEvent,this)).on(t,e.proxy(this.pasteEvent,this))}},r.prototype.caret=function(e,t){if(0!==this.$element.length){if("number"==typeof e)return t="number"==typeof t?t:e,this.$element.each(function(){if(this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var n=this.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select()}});if(this.$element[0].setSelectionRange)e=this.$element[0].selectionStart,t=this.$element[0].selectionEnd;else if(document.selection&&document.selection.createRange){var n=document.selection.createRange();e=0-n.duplicate().moveStart("character",-1e5),t=e+n.text.length}return{begin:e,end:t}}},r.prototype.seekNext=function(e){for(var t=this.mask.length;++e<=t&&!this.tests[e];);return e},r.prototype.seekPrev=function(e){for(;--e>=0&&!this.tests[e];);return e},r.prototype.shiftL=function(e,t){var n=this.mask.length;if(!(0>e)){for(var i=e,r=this.seekNext(t);n>i;i++)if(this.tests[i]){if(!(n>r&&this.tests[i].test(this.buffer[r])))break;this.buffer[i]=this.buffer[r],this.buffer[r]=this.options.placeholder,r=this.seekNext(r)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,e))}},r.prototype.shiftR=function(e){for(var t=this.mask.length,n=e,i=this.options.placeholder;t>n;n++)if(this.tests[n]){var r=this.seekNext(n),o=this.buffer[n];if(this.buffer[n]=i,!(t>r&&this.tests[r].test(o)))break;i=o}},r.prototype.unmask=function(){this.$element.unbind(".mask").removeData("inputmask")},r.prototype.focusEvent=function(){this.focusText=this.$element.val();var e=this.mask.length,t=this.checkVal();this.writeBuffer();var n=this,i=function(){t==e?n.caret(0,t):n.caret(t)};i(),setTimeout(i,50)},r.prototype.blurEvent=function(){
this.checkVal(),this.$element.val()!==this.focusText&&this.$element.trigger("change")},r.prototype.keydownEvent=function(e){var n=e.which;if(8==n||46==n||t&&127==n){var i=this.caret(),r=i.begin,o=i.end;return o-r===0&&(r=46!=n?this.seekPrev(r):o=this.seekNext(r-1),o=46==n?this.seekNext(o):o),this.clearBuffer(r,o),this.shiftL(r,o-1),!1}return 27==n?(this.$element.val(this.focusText),this.caret(0,this.checkVal()),!1):void 0},r.prototype.keypressEvent=function(e){var t=this.mask.length,n=e.which,i=this.caret();if(e.ctrlKey||e.altKey||e.metaKey||32>n)return!0;if(n){i.end-i.begin!==0&&(this.clearBuffer(i.begin,i.end),this.shiftL(i.begin,i.end-1));var r=this.seekNext(i.begin-1);if(t>r){var o=String.fromCharCode(n);if(this.tests[r].test(o)){this.shiftR(r),this.buffer[r]=o,this.writeBuffer();var s=this.seekNext(r);this.caret(s)}}return!1}},r.prototype.pasteEvent=function(){var e=this;setTimeout(function(){e.caret(e.checkVal(!0))},0)},r.prototype.clearBuffer=function(e,t){for(var n=this.mask.length,i=e;t>i&&n>i;i++)this.tests[i]&&(this.buffer[i]=this.options.placeholder)},r.prototype.writeBuffer=function(){return this.$element.val(this.buffer.join("")).val()},r.prototype.checkVal=function(e){for(var t=this.mask.length,n=this.$element.val(),i=-1,r=0,o=0;t>r;r++)if(this.tests[r]){for(this.buffer[r]=this.options.placeholder;o++<n.length;){var s=n.charAt(o-1);if(this.tests[r].test(s)){this.buffer[r]=s,i=r;break}}if(o>n.length)break}else this.buffer[r]==n.charAt(o)&&r!=this.partialPosition&&(o++,i=r);return!e&&i+1<this.partialPosition?(this.$element.val(""),this.clearBuffer(0,t)):(e||i+1>=this.partialPosition)&&(this.writeBuffer(),e||this.$element.val(this.$element.val().substring(0,i+1))),this.partialPosition?r:this.firstNonMaskPos};var o=e.fn.inputmask;e.fn.inputmask=function(t){return this.each(function(){var n=e(this),i=n.data("bs.inputmask");i||n.data("bs.inputmask",i=new r(this,t))})},e.fn.inputmask.Constructor=r,e.fn.inputmask.noConflict=function(){return e.fn.inputmask=o,this},e(document).on("focus.bs.inputmask.data-api","[data-mask]",function(){var t=e(this);t.data("bs.inputmask")||t.inputmask(t.data())})}(window.jQuery),+function(e){"use strict";var t="Microsoft Internet Explorer"==window.navigator.appName,n=function(t,n){if(this.$element=e(t),this.$input=this.$element.find(":file"),0!==this.$input.length){this.name=this.$input.attr("name")||n.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),0===this.$hidden.length&&(this.$hidden=e('<input type="hidden">').insertBefore(this.$input)),this.$preview=this.$element.find(".fileinput-preview");var i=this.$preview.css("height");"inline"!==this.$preview.css("display")&&"0px"!==i&&"none"!==i&&this.$preview.css("line-height",i),this.original={exists:this.$element.hasClass("fileinput-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.listen()}};n.prototype.listen=function(){this.$input.on("change.bs.fileinput",e.proxy(this.change,this)),e(this.$input[0].form).on("reset.bs.fileinput",e.proxy(this.reset,this)),this.$element.find('[data-trigger="fileinput"]').on("click.bs.fileinput",e.proxy(this.trigger,this)),this.$element.find('[data-dismiss="fileinput"]').on("click.bs.fileinput",e.proxy(this.clear,this))},n.prototype.change=function(t){var n=void 0===t.target.files?t.target&&t.target.value?[{name:t.target.value.replace(/^.+\\/,"")}]:[]:t.target.files;if(t.stopPropagation(),0===n.length)return void this.clear();this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name);var i=n[0];if(this.$preview.length>0&&("undefined"!=typeof i.type?i.type.match(/^image\/(gif|png|jpeg)$/):i.name.match(/\.(gif|png|jpe?g)$/i))&&"undefined"!=typeof FileReader){var r=new FileReader,o=this.$preview,s=this.$element;r.onload=function(t){var r=e("<img>");r[0].src=t.target.result,n[0].result=t.target.result,s.find(".fileinput-filename").text(i.name),"none"!=o.css("max-height")&&r.css("max-height",parseInt(o.css("max-height"),10)-parseInt(o.css("padding-top"),10)-parseInt(o.css("padding-bottom"),10)-parseInt(o.css("border-top"),10)-parseInt(o.css("border-bottom"),10)),o.html(r),s.addClass("fileinput-exists").removeClass("fileinput-new"),s.trigger("change.bs.fileinput",n)},r.readAsDataURL(i)}else this.$element.find(".fileinput-filename").text(i.name),this.$preview.text(i.name),this.$element.addClass("fileinput-exists").removeClass("fileinput-new"),this.$element.trigger("change.bs.fileinput")},n.prototype.clear=function(e){if(e&&e.preventDefault(),this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name",""),t){var n=this.$input.clone(!0);this.$input.after(n),this.$input.remove(),this.$input=n}else this.$input.val("");this.$preview.html(""),this.$element.find(".fileinput-filename").text(""),this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),void 0!==e&&(this.$input.trigger("change"),this.$element.trigger("clear.bs.fileinput"))},n.prototype.reset=function(){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.$element.find(".fileinput-filename").text(""),this.original.exists?this.$element.addClass("fileinput-exists").removeClass("fileinput-new"):this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),this.$element.trigger("reset.bs.fileinput")},n.prototype.trigger=function(e){this.$input.trigger("click"),e.preventDefault()};var i=e.fn.fileinput;e.fn.fileinput=function(t){return this.each(function(){var i=e(this),r=i.data("bs.fileinput");r||i.data("bs.fileinput",r=new n(this,t)),"string"==typeof t&&r[t]()})},e.fn.fileinput.Constructor=n,e.fn.fileinput.noConflict=function(){return e.fn.fileinput=i,this},e(document).on("click.fileinput.data-api",'[data-provides="fileinput"]',function(t){var n=e(this);if(!n.data("bs.fileinput")){n.fileinput(n.data());var i=e(t.target).closest('[data-dismiss="fileinput"],[data-trigger="fileinput"]');i.length>0&&(t.preventDefault(),i.trigger("click.bs.fileinput"))}})}(window.jQuery),!function(e,t){"use strict";function n(){var e={http:null,interval:600};this.http=function(n){if(!n)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");t.isString(n)&&(n={url:n,method:"GET"}),n.cache=!1,e.http=n},this.interval=function(t){if(t=parseInt(t),isNaN(t)||0>=t)throw new Error("Interval must be expressed in seconds and be greater than 0.");e.interval=t},this.$get=function(n,i,r,o){function s(e,t){n.$broadcast("$keepaliveResponse",e,t)}function a(){n.$broadcast("$keepalive"),t.isObject(e.http)&&o(e.http).success(s).error(s)}var l={ping:null};return{_options:function(){return e},start:function(){r.cancel(l.ping),l.ping=r(a,1e3*e.interval)},stop:function(){r.cancel(l.ping)},ping:function(){a()}}},this.$get.$inject=["$rootScope","$log","$interval","$http"]}function i(){var e={idleDuration:1200,warningDuration:30,autoResume:!0,events:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart",keepalive:!0};this.activeOn=function(t){e.events=t},this.idleDuration=function(t){if(0>=t)throw new Error("idleDuration must be a value in seconds, greater than 0.");e.idleDuration=t},this.warningDuration=function(t){if(0>t)throw new Error("warning must be a value in seconds, greater than 0.");e.warningDuration=t},this.autoResume=function(t){e.autoResume=t===!0},this.keepalive=function(t){e.keepalive=t===!0},this.$get=function(t,n,i,r,o){function s(){e.keepalive&&(u.running&&o.ping(),o.start())}function a(){e.keepalive&&o.stop()}function l(){u.idling=!u.idling;var n=u.idling?"Start":"End";i.$broadcast("$idle"+n),u.idling?(a(),u.countdown=e.warningDuration,c(),u.warning=t(c,1e3,e.warningDuration)):s(),t.cancel(u.idle)}function c(){u.countdown<=0?i.$broadcast("$idleTimeout"):i.$broadcast("$idleWarn",u.countdown),u.countdown--}var u={idle:null,warning:null,idling:!1,running:!1,countdown:null},h={_options:function(){return e},running:function(){return u.running},idling:function(){return u.idling},watch:function(){t.cancel(u.idle),t.cancel(u.warning),u.idling?l():u.running||s(),u.running=!0,u.idle=t(l,1e3*e.idleDuration)},unwatch:function(){t.cancel(u.idle),t.cancel(u.warning),u.idling=!1,u.running=!1}},d=function(){u.running&&e.autoResume&&h.watch()};return r.find("body").on(e.events,d),h},this.$get.$inject=["$interval","$log","$rootScope","$document","$keepalive"]}t.module("ngIdle.keepalive",[]).provider("$keepalive",n),t.module("ngIdle.idle",[]).provider("$idle",i),t.module("ngIdle.ngIdleCountdown",[]).directive("ngIdleCountdown",function(){return{restrict:"A",scope:{value:"=ngIdleCountdown"},link:function(e){e.$on("$idleWarn",function(t,n){e.value=n}),e.$on("$idleTimeout",function(){e.value=0})}}}),t.module("ngIdle",["ngIdle.keepalive","ngIdle.idle","ngIdle.ngIdleCountdown"])}(window,window.angular),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.io=e()}}(function(){var e;return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return r(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,n){function i(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=r(e),o=i.source,c=i.id;return t.forceNew||t["force new connection"]||!1===t.multiplex?(a("ignoring socket cache for %s",o),n=s(o,t)):(l[c]||(a("new io instance for %s",o),l[c]=s(o,t)),n=l[c]),n.socket(i.path)}var r=e("./url"),o=e("socket.io-parser"),s=e("./manager"),a=e("debug")("socket.io-client");t.exports=n=i;var l=n.managers={};n.protocol=o.protocol,n.connect=i,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(e,t,n){function i(e,t){return this instanceof i?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new i(e,t)}var r=(e("./url"),e("engine.io-client")),o=e("./socket"),s=e("component-emitter"),a=e("socket.io-parser"),l=e("./on"),c=e("component-bind"),u=(e("object-component"),e("debug")("socket.io-client:manager")),h=e("indexof"),d=e("backo2");t.exports=i,i.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},i.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},s(i.prototype),i.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},i.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},i.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},i.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},i.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},i.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},i.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},i.prototype.open=i.prototype.connect=function(e){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var i=l(t,"open",function(){n.onopen(),e&&e()}),o=l(t,"error",function(t){if(u("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var i=new Error("Connection error");i.data=t,e(i)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;u("connect attempt will timeout after %d",s);var a=setTimeout(function(){u("connect attempt timed out after %d",s),i.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(i),this.subs.push(o),this},i.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(l(e,"data",c(this,"ondata"))),this.subs.push(l(this.decoder,"decoded",c(this,"ondecoded"))),this.subs.push(l(e,"error",c(this,"onerror"))),this.subs.push(l(e,"close",c(this,"onclose")))},i.prototype.ondata=function(e){this.decoder.add(e)},i.prototype.ondecoded=function(e){this.emit("packet",e)},i.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},i.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new o(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~h(n.connected,t)||n.connected.push(t)})}return t},i.prototype.destroy=function(e){var t=h(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},i.prototype.packet=function(e){u("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var n=0;n<e.length;n++)t.engine.write(e[n]);t.encoding=!1,t.processPacketQueue()}))},i.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},i.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},i.prototype.close=i.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},i.prototype.onclose=function(e){u("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},i.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},i.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(e,t,n){function i(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}t.exports=i},{}],5:[function(e,t,n){function i(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var r=e("socket.io-parser"),o=e("component-emitter"),s=e("to-array"),a=e("./on"),l=e("component-bind"),c=e("debug")("socket.io-client:socket"),u=e("has-binary");t.exports=n=i;var h={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},d=o.prototype.emit;o(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",l(this,"onopen")),a(e,"packet",l(this,"onpacket")),a(e,"close",l(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},i.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},i.prototype.emit=function(e){if(h.hasOwnProperty(e))return d.apply(this,arguments),this;var t=s(arguments),n=r.EVENT;u(t)&&(n=r.BINARY_EVENT);var i={type:n,data:t};return"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this},i.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},i.prototype.onopen=function(){c("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},i.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},i.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(e);break;case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:this.onack(e);break;case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},i.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?d.apply(this,t):this.receiveBuffer.push(t)},i.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=s(arguments);c("sending ack %j",i);var o=u(i)?r.BINARY_ACK:r.ACK;t.packet({type:o,id:e,data:i})}}},i.prototype.onack=function(e){c("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)d.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(e,t,n){(function(n){function i(e,t){var i=e,t=t||n.location;return null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!=typeof t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),i=r(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/",i.id=i.protocol+"://"+i.host+":"+i.port,i.href=i.protocol+"://"+i.host+(t&&t.port==i.port?"":":"+i.port),i}var r=e("parseuri"),o=e("debug")("socket.io-client:url");t.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(e,t,n){function i(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(e){this.ms=e},i.prototype.setMax=function(e){this.max=e},i.prototype.setJitter=function(e){this.jitter=e}},{}],8:[function(e,t,n){var i=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return t.apply(e,n.concat(i.call(arguments)))}}},{}],9:[function(e,t,n){function i(e){return e?r(e):void 0}function r(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}t.exports=i,i.prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},i.prototype.once=function(e,t){function n(){i.off(e,n),t.apply(this,arguments)}var i=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===t||i.fn===t){n.splice(r,1);break}return this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var i=0,r=n.length;r>i;++i)n[i].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],10:[function(e,t,n){function i(e){return i.enabled(e)?function(t){t=r(t);var n=new Date,o=n-(i[e]||n);i[e]=n,t=e+" "+t+" +"+i.humanize(o),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function r(e){return e instanceof Error?e.stack||e.message:e}t.exports=i,i.names=[],i.skips=[],i.enable=function(e){try{localStorage.debug=e}catch(t){}for(var n=(e||"").split(/[\s,]+/),r=n.length,o=0;r>o;o++)e=n[o].replace("*",".*?"),"-"===e[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$"))},i.disable=function(){i.enable("")},i.humanize=function(e){var t=1e3,n=6e4,i=60*n;return e>=i?(e/i).toFixed(1)+"h":e>=n?(e/n).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},i.enabled=function(e){for(var t=0,n=i.skips.length;n>t;t++)if(i.skips[t].test(e))return!1;for(var t=0,n=i.names.length;n>t;t++)if(i.names[t].test(e))return!0;return!1};try{window.localStorage&&i.enable(localStorage.debug)}catch(o){}},{}],11:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":12}],12:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(e,t,n){(function(n){function i(e,t){if(!(this instanceof i))return new i(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=u(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:n.location&&"https:"==location.protocol,t.host){var r=t.host.split(":");t.hostname=r.shift(),r.length?t.port=r.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(n.location?location.hostname:"localhost"),this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}function r(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var o=e("./transports"),s=e("component-emitter"),a=e("debug")("engine.io-client:socket"),l=e("indexof"),c=e("engine.io-parser"),u=e("parseuri"),h=e("parsejson"),d=e("parseqs");t.exports=i,i.priorWebsocketSuccess=!1,s(i.prototype),i.protocol=c.protocol,i.Socket=i,i.Transport=e("./transport"),i.transports=e("./transports"),i.parser=e("engine.io-parser"),i.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=r(this.query);t.EIO=c.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new o[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return n},i.prototype.open=function(){var e;if(this.rememberUpgrade&&i.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";var e;try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},i.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},i.prototype.probe=function(e){function t(){if(d.onlyBinaryUpgrades){var t=!this.supportsBinary&&d.transport.supportsBinary;h=h||t}h||(a('probe transport "%s" opened',e),u.send([{type:"ping",data:"probe"}]),u.once("packet",function(t){if(!h)if("pong"==t.type&&"probe"==t.data){if(a('probe transport "%s" pong',e),d.upgrading=!0,d.emit("upgrading",u),!u)return;i.priorWebsocketSuccess="websocket"==u.name,a('pausing current transport "%s"',d.transport.name),d.transport.pause(function(){h||"closed"!=d.readyState&&(a("changing transport and sending upgrade packet"),c(),d.setTransport(u),u.send([{type:"upgrade"}]),d.emit("upgrade",u),u=null,d.upgrading=!1,d.flush())})}else{a('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=u.name,d.emit("upgradeError",n)}}))}function n(){h||(h=!0,c(),u.close(),u=null)}function r(t){var i=new Error("probe error: "+t);i.transport=u.name,n(),a('probe transport "%s" failed because of error: %s',e,t),d.emit("upgradeError",i)}function o(){r("transport closed")}function s(){r("socket closed")}function l(e){u&&e.name!=u.name&&(a('"%s" works - aborting "%s"',e.name,u.name),n())}function c(){u.removeListener("open",t),u.removeListener("error",r),u.removeListener("close",o),d.removeListener("close",s),d.removeListener("upgrading",l)}a('probing transport "%s"',e);var u=this.createTransport(e,{probe:1}),h=!1,d=this;i.priorWebsocketSuccess=!1,u.once("open",t),u.once("error",r),u.once("close",o),this.once("close",s),this.once("upgrading",l),u.open()},i.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",i.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},i.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(h(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},i.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},i.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},i.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},i.prototype.ping=function(){this.sendPacket("ping")},i.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},i.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},i.prototype.write=i.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},i.prototype.sendPacket=function(e,t,n){if("closing"!=this.readyState&&"closed"!=this.readyState){var i={type:e,data:t};this.emit("packetCreate",i),this.writeBuffer.push(i),this.callbackBuffer.push(n),this.flush()}},i.prototype.close=function(){function e(){i.onClose("forced close"),a("socket closing - telling transport to close"),i.transport.close()}function t(){i.removeListener("upgrade",t),i.removeListener("upgradeError",t),e()}function n(){i.once("upgrade",t),i.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var i=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},i.prototype.onError=function(e){a("socket error %j",e),i.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},i.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){a('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),
this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},i.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;i>n;n++)~l(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(e,t,n){function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}var r=e("engine.io-parser"),o=e("component-emitter");t.exports=i,o(i.prototype),i.timestamps=0,i.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},i.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(e,t,n){(function(t){function i(e){var n,i=!1,a=!1,l=!1!==e.jsonp;if(t.location){var c="https:"==location.protocol,u=location.port;u||(u=c?443:80),i=e.hostname!=location.hostname||u!=e.port,a=e.secure!=c}if(e.xdomain=i,e.xscheme=a,n=new r(e),"open"in n&&!e.forceJSONP)return new o(e);if(!l)throw new Error("JSONP disabled");return new s(e)}var r=e("xmlhttprequest"),o=e("./polling-xhr"),s=e("./polling-jsonp"),a=e("./websocket");n.polling=i,n.websocket=a}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(e,t,n){(function(n){function i(){}function r(e){o.call(this,e),this.query=this.query||{},a||(n.___eio||(n.___eio=[]),a=n.___eio),this.index=a.length;var t=this;a.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=i)},!1)}var o=e("./polling"),s=e("component-inherit");t.exports=r;var a,l=/\n/g,c=/\\n/g;s(r,o),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},r.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.script=t;var i="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);i&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},r.prototype.doWrite=function(e,t){function n(){i(),t()}function i(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';o=document.createElement(t)}catch(e){o=document.createElement("iframe"),o.name=r.iframeId,o.src="javascript:0"}o.id=r.iframeId,r.form.appendChild(o),r.iframe=o}var r=this;if(!this.form){var o,s=document.createElement("form"),a=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=u,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),i(),e=e.replace(c,"\\\n"),this.area.value=e.replace(l,"\\n");try{this.form.submit()}catch(h){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==r.iframe.readyState&&n()}:this.iframe.onload=n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(e,t,n){(function(n){function i(){}function r(e){if(l.call(this,e),n.location){var t="https:"==location.protocol,i=location.port;i||(i=t?443:80),this.xd=e.hostname!=n.location.hostname||i!=e.port,this.xs=e.secure!=t}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function s(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var a=e("xmlhttprequest"),l=e("./polling"),c=e("component-emitter"),u=e("component-inherit"),h=e("debug")("engine.io-client:polling-xhr");t.exports=r,t.exports.Request=o,u(r,l),r.prototype.supportsBinary=!0,r.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new o(e)},r.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:n}),r=this;i.on("success",t),i.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=i},r.prototype.doPoll=function(){h("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},c(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new a(e),i=this;try{if(h("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async),this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){i.onLoad()},t.onerror=function(){i.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?i.onLoad():setTimeout(function(){i.onError(t.status)},0))},h("xhr data %s",this.data),t.send(this.data)}catch(r){return void setTimeout(function(){i.onError(r)},0)}n.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=i:this.xhr.onreadystatechange=i,e)try{this.xhr.abort()}catch(t){}n.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}e="application/octet-stream"===t?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof n.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},n.document&&(o.requestsCount=0,o.requests={},n.attachEvent?n.attachEvent("onunload",s):n.addEventListener&&n.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(e,t,n){function i(e){var t=e&&e.forceBase64;(!c||t)&&(this.supportsBinary=!1),r.call(this,e)}var r=e("../transport"),o=e("parseqs"),s=e("engine.io-parser"),a=e("component-inherit"),l=e("debug")("engine.io-client:polling");t.exports=i;var c=function(){var t=e("xmlhttprequest"),n=new t({xdomain:!1});return null!=n.responseType}();a(i,r),i.prototype.name="polling",i.prototype.doOpen=function(){this.poll()},i.prototype.pause=function(e){function t(){l("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(l("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){l("pre-pause polling complete"),--i||t()})),this.writable||(l("we are currently writing - waiting to pause"),i++,this.once("drain",function(){l("pre-pause writing complete"),--i||t()}))}else t()},i.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},i.prototype.onData=function(e){var t=this;l("polling got data %s",e);var n=function(e,n,i){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};s.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},i.prototype.doClose=function(){function e(){l("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(l("transport open - closing"),e()):(l("transport not open - deferring close"),this.once("open",e))},i.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},i.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+r.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(e,t,n){function i(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),r.call(this,e)}var r=e("../transport"),o=e("engine.io-parser"),s=e("parseqs"),a=e("component-inherit"),l=e("debug")("engine.io-client:websocket"),c=e("ws");t.exports=i,a(i,r),i.prototype.name="websocket",i.prototype.supportsBinary=!0,i.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.ws=new c(e,t,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},i.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(i.prototype.onData=function(e){var t=this;setTimeout(function(){r.prototype.onData.call(t,e)},0)}),i.prototype.write=function(e){function t(){n.writable=!0,n.emit("drain")}var n=this;this.writable=!1;for(var i=0,r=e.length;r>i;i++)o.encodePacket(e[i],this.supportsBinary,function(e){try{n.ws.send(e)}catch(t){l("websocket closed before onclose event")}});setTimeout(t,0)},i.prototype.onClose=function(){r.prototype.onClose.call(this)},i.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},i.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},i.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===i.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(e,t,n){var i=e("has-cors");t.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(o){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(o){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}}},{"has-cors":40}],21:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],22:[function(e,t,n){function i(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var i="color: "+this.color;e=[e[0],i,"color: inherit"].concat(Array.prototype.slice.call(e,1));var r=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%"!==e&&(r++,"%c"===e&&(o=r))}),e.splice(o,0,i),e}function o(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(t){}}function a(){var e;try{e=localStorage.debug}catch(t){}return e}n=t.exports=e("./debug"),n.log=o,n.formatArgs=r,n.save=s,n.load=a,n.useColors=i,n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(a())},{"./debug":23}],23:[function(e,t,n){function i(){return n.colors[u++%n.colors.length]}function r(e){function t(){}function r(){var e=r,t=+new Date,o=t-(c||t);e.diff=o,e.prev=c,e.curr=t,c=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=i());var s=Array.prototype.slice.call(arguments);s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(t,i){if("%"===t)return t;a++;var r=n.formatters[i];if("function"==typeof r){var o=s[a];t=r.call(e,o),s.splice(a,1),a--}return t}),"function"==typeof n.formatArgs&&(s=n.formatArgs.apply(e,s));var l=r.log||n.log||console.log.bind(console);l.apply(e,s)}t.enabled=!1,r.enabled=!0;var o=n.enabled(e)?r:t;return o.namespace=e,o}function o(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),i=t.length,r=0;i>r;r++)t[r]&&(e=t[r].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function s(){n.enable("")}function a(e){var t,i;for(t=0,i=n.skips.length;i>t;t++)if(n.skips[t].test(e))return!1;for(t=0,i=n.names.length;i>t;t++)if(n.names[t].test(e))return!0;return!1}function l(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=r,n.coerce=l,n.disable=s,n.enable=o,n.enabled=a,n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var c,u=0},{ms:24}],24:[function(e,t,n){function i(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"y":return n*h;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"h":return n*c;case"minutes":case"minute":case"m":return n*l;case"seconds":case"second":case"s":return n*a;case"ms":return n}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=l?Math.round(e/l)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function o(e){return s(e,u,"day")||s(e,c,"hour")||s(e,l,"minute")||s(e,a,"second")||e+" ms"}function s(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,l=60*a,c=60*l,u=24*c,h=365.25*u;t.exports=function(e,t){return t=t||{},"string"==typeof e?i(e):t["long"]?o(e):r(e)}},{}],25:[function(e,t,n){(function(t){function i(e,t){var i="b"+n.packets[e.type]+e.data.data;return t(i)}function r(e,t,i){if(!t)return n.encodeBase64Packet(e,i);var r=e.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=v[e.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return i(s.buffer)}function o(e,t,i){if(!t)return n.encodeBase64Packet(e,i);var r=new FileReader;return r.onload=function(){e.data=r.result,n.encodePacket(e,t,!0,i)},r.readAsArrayBuffer(e.data)}function s(e,t,i){if(!t)return n.encodeBase64Packet(e,i);if(m)return o(e,t,i);var r=new Uint8Array(1);r[0]=v[e.type];var s=new w([r.buffer,e.data]);return i(s)}function a(e,t,n){for(var i=new Array(e.length),r=d(e.length,n),o=function(e,n,r){t(n,function(t,n){i[e]=n,r(t,i)})},s=0;s<e.length;s++)o(s,e[s],r)}var l=e("./keys"),c=e("has-binary"),u=e("arraybuffer.slice"),h=e("base64-arraybuffer"),d=e("after"),p=e("utf8"),f=navigator.userAgent.match(/Android/i),g=/PhantomJS/i.test(navigator.userAgent),m=f||g;n.protocol=3;var v=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=l(v),y={type:"error",data:"parser error"},w=e("blob");n.encodePacket=function(e,n,o,a){"function"==typeof n&&(a=n,n=!1),"function"==typeof o&&(a=o,o=null);var l=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&l instanceof ArrayBuffer)return r(e,n,a);if(w&&l instanceof t.Blob)return s(e,n,a);if(l&&l.base64)return i(e,a);var c=v[e.type];return void 0!==e.data&&(c+=o?p.encode(String(e.data)):String(e.data)),a(""+c)},n.encodeBase64Packet=function(e,i){var r="b"+n.packets[e.type];if(w&&e.data instanceof w){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];i(r+e)},o.readAsDataURL(e.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(a){for(var l=new Uint8Array(e.data),c=new Array(l.length),u=0;u<l.length;u++)c[u]=l[u];s=String.fromCharCode.apply(null,c)}return r+=t.btoa(s),i(r)},n.decodePacket=function(e,t,i){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return n.decodeBase64Packet(e.substr(1),t);if(i)try{e=p.decode(e)}catch(r){return y}var o=e.charAt(0);return Number(o)==o&&b[o]?e.length>1?{type:b[o],data:e.substring(1)}:{type:b[o]}:y}var s=new Uint8Array(e),o=s[0],a=u(e,1);return w&&"blob"===t&&(a=new w([a])),{type:b[o],data:a}},n.decodeBase64Packet=function(e,n){var i=b[e.charAt(0)];if(!t.ArrayBuffer)return{type:i,data:{base64:!0,data:e.substr(1)}};var r=h.decode(e.substr(1));return"blob"===n&&w&&(r=new w([r])),{type:i,data:r}},n.encodePayload=function(e,t,i){function r(e){return e.length+":"+e}function o(e,i){n.encodePacket(e,s?t:!1,!0,function(e){i(null,r(e))})}"function"==typeof t&&(i=t,t=null);var s=c(e);return t&&s?w&&!m?n.encodePayloadAsBlob(e,i):n.encodePayloadAsArrayBuffer(e,i):e.length?void a(e,o,function(e,t){return i(t.join(""))}):i("0:")},n.decodePayload=function(e,t,i){if("string"!=typeof e)return n.decodePayloadAsBinary(e,t,i);"function"==typeof t&&(i=t,t=null);var r;if(""==e)return i(y,0,1);for(var o,s,a="",l=0,c=e.length;c>l;l++){var u=e.charAt(l);if(":"!=u)a+=u;else{if(""==a||a!=(o=Number(a)))return i(y,0,1);if(s=e.substr(l+1,o),a!=s.length)return i(y,0,1);if(s.length){if(r=n.decodePacket(s,t,!0),y.type==r.type&&y.data==r.data)return i(y,0,1);var h=i(r,l+o,c);if(!1===h)return}l+=o,a=""}}return""!=a?i(y,0,1):void 0},n.encodePayloadAsArrayBuffer=function(e,t){function i(e,t){n.encodePacket(e,!0,!0,function(e){return t(null,e)})}return e.length?void a(e,i,function(e,n){var i=n.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),r=new Uint8Array(i),o=0;return n.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);n=i.buffer}r[o++]=t?0:1;for(var a=n.byteLength.toString(),s=0;s<a.length;s++)r[o++]=parseInt(a[s]);r[o++]=255;for(var i=new Uint8Array(n),s=0;s<i.length;s++)r[o++]=i[s]}),t(r.buffer)}):t(new ArrayBuffer(0))},n.encodePayloadAsBlob=function(e,t){function i(e,t){n.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof e){for(var i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);e=i.buffer,n[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,s=o.toString(),a=new Uint8Array(s.length+1),r=0;r<s.length;r++)a[r]=parseInt(s[r]);if(a[s.length]=255,w){var l=new w([n.buffer,a.buffer,e]);t(null,l)}})}a(e,i,function(e,n){return t(new w(n))})},n.decodePayloadAsBinary=function(e,t,i){"function"==typeof t&&(i=t,t=null);for(var r=e,o=[],s=!1;r.byteLength>0;){for(var a=new Uint8Array(r),l=0===a[0],c="",h=1;255!=a[h];h++){if(c.length>310){s=!0;break}c+=a[h]}if(s)return i(y,0,1);r=u(r,2+c.length),c=parseInt(c);var d=u(r,0,c);if(l)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(p){var f=new Uint8Array(d);d="";for(var h=0;h<f.length;h++)d+=String.fromCharCode(f[h])}o.push(d),r=u(r,c)}var g=o.length;o.forEach(function(e,r){i(n.decodePacket(e,t,!0),r,g)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(e,t,n){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},{}],27:[function(e,t,n){function i(e,t,n){function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}var o=!1;return n=n||r,i.count=e,0===e?t():i}function r(){}t.exports=i},{}],28:[function(e,t,n){t.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(0>t&&(t+=i),0>n&&(n+=i),n>i&&(n=i),t>=i||t>=n||0===i)return new ArrayBuffer(0);for(var r=new Uint8Array(e),o=new Uint8Array(n-t),s=t,a=0;n>s;s++,a++)o[a]=r[s];return o.buffer}},{}],29:[function(e,t,n){!function(e){"use strict";n.encode=function(t){var n,i=new Uint8Array(t),r=i.length,o="";for(n=0;r>n;n+=3)o+=e[i[n]>>2],o+=e[(3&i[n])<<4|i[n+1]>>4],o+=e[(15&i[n+1])<<2|i[n+2]>>6],o+=e[63&i[n+2]];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},n.decode=function(t){var n,i,r,o,s,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(n=0;l>n;n+=4)i=e.indexOf(t[n]),r=e.indexOf(t[n+1]),o=e.indexOf(t[n+2]),s=e.indexOf(t[n+3]),h[c++]=i<<2|r>>4,h[c++]=(15&r)<<4|o>>2,h[c++]=(3&o)<<6|63&s;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(e,t,n){(function(e){function n(e,t){t=t||{};for(var n=new i,r=0;r<e.length;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,r=function(){try{var e=new Blob(["hi"]);return 2==e.size}catch(t){return!1}}(),o=i&&i.prototype.append&&i.prototype.getBlob;t.exports=function(){return r?e.Blob:o?n:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(e,t,n){(function(n){function i(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(r(e)){for(var i=0;i<e.length;i++)if(t(e[i]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var o in e)if(e.hasOwnProperty(o)&&t(e[o]))return!0}return!1}return t(e)}var r=e("isarray");t.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:32}],32:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],33:[function(t,n,i){(function(t){!function(r){function o(e){for(var t,n,i=[],r=0,o=e.length;o>r;)t=e.charCodeAt(r++),t>=55296&&56319>=t&&o>r?(n=e.charCodeAt(r++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--)):i.push(t);return i}function s(e){for(var t,n=e.length,i=-1,r="";++i<n;)t=e[i],t>65535&&(t-=65536,r+=y(t>>>10&1023|55296),t=56320|1023&t),r+=y(t);return r}function a(e,t){return y(e>>t&63|128)}function l(e){if(0==(4294967168&e))return y(e);var t="";return 0==(4294965248&e)?t=y(e>>6&31|192):0==(4294901760&e)?(t=y(e>>12&15|224),t+=a(e,6)):0==(4292870144&e)&&(t=y(e>>18&7|240),t+=a(e,12),t+=a(e,6)),t+=y(63&e|128)}function c(e){for(var t,n=o(e),i=n.length,r=-1,s="";++r<i;)t=n[r],s+=l(t);return s}function u(){if(b>=v)throw Error("Invalid byte index");var e=255&m[b];if(b++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function h(){var e,t,n,i,r;if(b>v)throw Error("Invalid byte index");if(b==v)return!1;if(e=255&m[b],b++,0==(128&e))return e;if(192==(224&e)){var t=u();if(r=(31&e)<<6|t,r>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=u(),n=u(),r=(15&e)<<12|t<<6|n,r>=2048)return r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=u(),n=u(),i=u(),r=(15&e)<<18|t<<12|n<<6|i,r>=65536&&1114111>=r))return r;throw Error("Invalid UTF-8 detected")}function d(e){m=o(e),v=m.length,b=0;for(var t,n=[];(t=h())!==!1;)n.push(t);return s(n)}var p="object"==typeof i&&i,f="object"==typeof n&&n&&n.exports==p&&n,g="object"==typeof t&&t;(g.global===g||g.window===g)&&(r=g);var m,v,b,y=String.fromCharCode,w={version:"2.0.0",encode:c,decode:d};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return w});else if(p&&!p.nodeType)if(f)f.exports=w;else{var _={},x=_.hasOwnProperty;for(var C in w)x.call(w,C)&&(p[C]=w[C])}else r.utf8=w}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(e,t,n){(function(e){var n=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):n.test(t.replace(i,"@").replace(r,"]").replace(o,""))?new Function("return "+t)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),i=0,r=n.length;r>i;i++){var o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},{}],36:[function(e,t,n){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,n=e.indexOf("["),o=e.indexOf("]");-1!=n&&-1!=o&&(e=e.substring(0,n)+e.substring(n,o).replace(/:/g,";")+e.substring(o,e.length));for(var s=i.exec(e||""),a={},l=14;l--;)a[r[l]]=s[l]||"";return-1!=n&&-1!=o&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],37:[function(e,t,n){function i(e,t,n){var i;return i=t?new o(e,t):new o(e)}var r=function(){return this}(),o=r.WebSocket||r.MozWebSocket;t.exports=o?i:null,o&&(i.prototype=o.prototype)},{}],38:[function(e,t,n){(function(n){function i(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(r(e)){for(var i=0;i<e.length;i++)if(t(e[i]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t(e[o]))return!0}return!1}return t(e)}var r=e("isarray");t.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:39}],39:[function(e,t,n){t.exports=e(32)},{}],40:[function(e,t,n){var i=e("global");try{t.exports="XMLHttpRequest"in i&&"withCredentials"in new i.XMLHttpRequest}catch(r){t.exports=!1}},{global:41}],41:[function(e,t,n){t.exports=function(){return this}()},{}],42:[function(e,t,n){var i=[].indexOf;t.exports=function(e,t){if(i)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],43:[function(e,t,n){var i=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},n.values=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(e[n]);return t},n.merge=function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);return e},n.length=function(e){return n.keys(e).length},n.isEmpty=function(e){return 0==n.length(e)}},{}],44:[function(e,t,n){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){for(var t=i.exec(e||""),n={},o=14;o--;)n[r[o]]=t[o]||"";return n}},{}],45:[function(e,t,n){(function(t){var i=e("isarray"),r=e("./is-buffer");n.deconstructPacket=function(e){function t(e){if(!e)return e;if(r(e)){var o={_placeholder:!0,num:n.length};return n.push(e),o}if(i(e)){for(var s=new Array(e.length),a=0;a<e.length;a++)s[a]=t(e[a]);return s}if("object"==typeof e&&!(e instanceof Date)){var s={};for(var l in e)s[l]=t(e[l]);return s}return e}var n=[],o=e.data,s=e;return s.data=t(o),s.attachments=n.length,{packet:s,buffers:n}},n.reconstructPacket=function(e,t){function n(e){if(e&&e._placeholder){var r=t[e.num];return r}if(i(e)){for(var o=0;o<e.length;o++)e[o]=n(e[o]);return e}if(e&&"object"==typeof e){for(var s in e)e[s]=n(e[s]);return e}return e}return e.data=n(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,n){function o(e,l,c){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){s++;var u=new FileReader;u.onload=function(){c?c[l]=this.result:a=this.result,--s||n(a)},u.readAsArrayBuffer(e)}else if(i(e))for(var h=0;h<e.length;h++)o(e[h],h,e);else if(e&&"object"==typeof e&&!r(e))for(var d in e)o(e[d],d,e)}var s=0,a=e;o(a),s||n(a)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(e,t,n){function i(){}function r(e){var t="",i=!1;return t+=e.type,(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)&&(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(i=!0,t+=e.nsp),null!=e.id&&(i&&(t+=",",i=!1),t+=e.id),null!=e.data&&(i&&(t+=","),t+=h.stringify(e.data)),u("encoded %j as %s",e,t),t}function o(e,t){function n(e){var n=p.deconstructPacket(e),i=r(n.packet),o=n.buffers;o.unshift(i),t(o)}p.removeBlobs(e,n)}function s(){this.reconstructor=null}function a(e){var t={},i=0;if(t.type=Number(e.charAt(0)),
null==n.types[t.type])return c();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){for(var r="";"-"!=e.charAt(++i)&&(r+=e.charAt(i),i!=e.length););if(r!=Number(r)||"-"!=e.charAt(i))throw new Error("Illegal attachments");t.attachments=Number(r)}if("/"==e.charAt(i+1))for(t.nsp="";++i;){var o=e.charAt(i);if(","==o)break;if(t.nsp+=o,i==e.length)break}else t.nsp="/";var s=e.charAt(i+1);if(""!==s&&Number(s)==s){for(t.id="";++i;){var o=e.charAt(i);if(null==o||Number(o)!=o){--i;break}if(t.id+=e.charAt(i),i==e.length)break}t.id=Number(t.id)}if(e.charAt(++i))try{t.data=h.parse(e.substr(i))}catch(a){return c()}return u("decoded %s as %j",e,t),t}function l(e){this.reconPack=e,this.buffers=[]}function c(e){return{type:n.ERROR,data:"parser error"}}var u=e("debug")("socket.io-parser"),h=e("json3"),d=(e("isarray"),e("component-emitter")),p=e("./binary"),f=e("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=i,n.Decoder=s,i.prototype.encode=function(e,t){if(u("encoding packet %j",e),n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)o(e,t);else{var i=r(e);t([i])}},d(s.prototype),s.prototype.add=function(e){var t;if("string"==typeof e)t=a(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new l(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!f(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},l.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=p.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},l.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(e,t,n){(function(e){function n(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(e,t,n){t.exports=e(32)},{}],49:[function(t,n,i){!function(t){function n(e){if(n[e]!==s)return n[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=n("json-stringify")&&n("json-parse");else{var i,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var o=u.stringify,l="function"==typeof o&&h;if(l){(i=function(){return 1}).toJSON=i;try{l="0"===o(0)&&"0"===o(new Number)&&'""'==o(new String)&&o(a)===s&&o(s)===s&&o()===s&&"1"===o(i)&&"[1]"==o([i])&&"[null]"==o([s])&&"null"==o(null)&&"[null,null,null]"==o([s,a,null])&&o({a:[i,!0,!1,null,"\x00\b\n\f\r	"]})==r&&"1"===o(null,i)&&"[\n 1,\n 2\n]"==o([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==o(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==o(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==o(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==o(new Date(-1))}catch(c){l=!1}}t=l}if("json-parse"==e){var d=u.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){i=d(r);var p=5==i.a.length&&1===i.a[0];if(p){try{p=!d('"	"')}catch(c){}if(p)try{p=1!==d("01")}catch(c){}if(p)try{p=1!==d("1.")}catch(c){}}}}catch(c){p=!1}t=p}}return n[e]=!!t}var r,o,s,a={}.toString,l="function"==typeof e&&e.amd,c="object"==typeof JSON&&JSON,u="object"==typeof i&&i&&!i.nodeType&&i;u&&c?(u.stringify=c.stringify,u.parse=c.parse):u=t.JSON=c||{};var h=new Date(-0xc782b5b800cec);try{h=-109252==h.getUTCFullYear()&&0===h.getUTCMonth()&&1===h.getUTCDate()&&10==h.getUTCHours()&&37==h.getUTCMinutes()&&6==h.getUTCSeconds()&&708==h.getUTCMilliseconds()}catch(d){}if(!n("json")){var p="[object Function]",f="[object Date]",g="[object Number]",m="[object String]",v="[object Array]",b="[object Boolean]",y=n("bug-string-char-index");if(!h)var w=Math.floor,_=[0,31,59,90,120,151,181,212,243,273,304,334],x=function(e,t){return _[t]+365*(e-1970)+w((e-1969+(t=+(t>1)))/4)-w((e-1901+t)/100)+w((e-1601+t)/400)};(r={}.hasOwnProperty)||(r=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=a?r=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,r=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,r.call(this,e)});var C={"boolean":1,number:1,string:1,undefined:1},$=function(e,t){var n=typeof e[t];return"object"==n?!!e[t]:!C[n]};if(o=function(e,t){var n,i,s,l=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,i=new n;for(s in i)r.call(i,s)&&l++;return n=i=null,l?o=2==l?function(e,t){var n,i={},o=a.call(e)==p;for(n in e)o&&"prototype"==n||r.call(i,n)||!(i[n]=1)||!r.call(e,n)||t(n)}:function(e,t){var n,i,o=a.call(e)==p;for(n in e)o&&"prototype"==n||!r.call(e,n)||(i="constructor"===n)||t(n);(i||r.call(e,n="constructor"))&&t(n)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],o=function(e,t){var n,o,s=a.call(e)==p,l=!s&&"function"!=typeof e.constructor&&$(e,"hasOwnProperty")?e.hasOwnProperty:r;for(n in e)s&&"prototype"==n||!l.call(e,n)||t(n);for(o=i.length;n=i[--o];l.call(e,n)&&t(n));}),o(e,t)},!n("json-stringify")){var k={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},S="000000",T=function(e,t){return(S+(t||0)).slice(-e)},E="\\u00",D=function(e){var t,n='"',i=0,r=e.length,o=r>10&&y;for(o&&(t=e.split(""));r>i;i++){var s=e.charCodeAt(i);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=k[s];break;default:if(32>s){n+=E+T(2,s.toString(16));break}n+=o?t[i]:y?e.charAt(i):e[i]}}return n+'"'},A=function(e,t,n,i,l,c,u){var h,d,p,y,_,C,$,k,S,E,O,I,M,P,R,N;try{h=t[e]}catch(F){}if("object"==typeof h&&h)if(d=a.call(h),d!=f||r.call(h,"toJSON"))"function"==typeof h.toJSON&&(d!=g&&d!=m&&d!=v||r.call(h,"toJSON"))&&(h=h.toJSON(e));else if(h>-1/0&&1/0>h){if(x){for(_=w(h/864e5),p=w(_/365.2425)+1970-1;x(p+1,0)<=_;p++);for(y=w((_-x(p,0))/30.42);x(p,y+1)<=_;y++);_=1+_-x(p,y),C=(h%864e5+864e5)%864e5,$=w(C/36e5)%24,k=w(C/6e4)%60,S=w(C/1e3)%60,E=C%1e3}else p=h.getUTCFullYear(),y=h.getUTCMonth(),_=h.getUTCDate(),$=h.getUTCHours(),k=h.getUTCMinutes(),S=h.getUTCSeconds(),E=h.getUTCMilliseconds();h=(0>=p||p>=1e4?(0>p?"-":"+")+T(6,0>p?-p:p):T(4,p))+"-"+T(2,y+1)+"-"+T(2,_)+"T"+T(2,$)+":"+T(2,k)+":"+T(2,S)+"."+T(3,E)+"Z"}else h=null;if(n&&(h=n.call(t,e,h)),null===h)return"null";if(d=a.call(h),d==b)return""+h;if(d==g)return h>-1/0&&1/0>h?""+h:"null";if(d==m)return D(""+h);if("object"==typeof h){for(P=u.length;P--;)if(u[P]===h)throw TypeError();if(u.push(h),O=[],R=c,c+=l,d==v){for(M=0,P=h.length;P>M;M++)I=A(M,h,n,i,l,c,u),O.push(I===s?"null":I);N=O.length?l?"[\n"+c+O.join(",\n"+c)+"\n"+R+"]":"["+O.join(",")+"]":"[]"}else o(i||h,function(e){var t=A(e,h,n,i,l,c,u);t!==s&&O.push(D(e)+":"+(l?" ":"")+t)}),N=O.length?l?"{\n"+c+O.join(",\n"+c)+"\n"+R+"}":"{"+O.join(",")+"}":"{}";return u.pop(),N}};u.stringify=function(e,t,n){var i,r,o,s;if("function"==typeof t||"object"==typeof t&&t)if((s=a.call(t))==p)r=t;else if(s==v){o={};for(var l,c=0,u=t.length;u>c;l=t[c++],s=a.call(l),(s==m||s==g)&&(o[l]=1));}if(n)if((s=a.call(n))==g){if((n-=n%1)>0)for(i="",n>10&&(n=10);i.length<n;i+=" ");}else s==m&&(i=n.length<=10?n:n.slice(0,10));return A("",(l={},l[""]=e,l),r,o,i,"",[])}}if(!n("json-parse")){var O,I,M=String.fromCharCode,P={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},R=function(){throw O=I=null,SyntaxError()},N=function(){for(var e,t,n,i,r,o=I,s=o.length;s>O;)switch(r=o.charCodeAt(O)){case 9:case 10:case 13:case 32:O++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=y?o.charAt(O):o[O],O++,e;case 34:for(e="@",O++;s>O;)if(r=o.charCodeAt(O),32>r)R();else if(92==r)switch(r=o.charCodeAt(++O)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=P[r],O++;break;case 117:for(t=++O,n=O+4;n>O;O++)r=o.charCodeAt(O),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||R();e+=M("0x"+o.slice(t,O));break;default:R()}else{if(34==r)break;for(r=o.charCodeAt(O),t=O;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++O);e+=o.slice(t,O)}if(34==o.charCodeAt(O))return O++,e;R();default:if(t=O,45==r&&(i=!0,r=o.charCodeAt(++O)),r>=48&&57>=r){for(48==r&&(r=o.charCodeAt(O+1),r>=48&&57>=r)&&R(),i=!1;s>O&&(r=o.charCodeAt(O),r>=48&&57>=r);O++);if(46==o.charCodeAt(O)){for(n=++O;s>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==O&&R(),O=n}if(r=o.charCodeAt(O),101==r||69==r){for(r=o.charCodeAt(++O),(43==r||45==r)&&O++,n=O;s>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==O&&R(),O=n}return+o.slice(t,O)}if(i&&R(),"true"==o.slice(O,O+4))return O+=4,!0;if("false"==o.slice(O,O+5))return O+=5,!1;if("null"==o.slice(O,O+4))return O+=4,null;R()}return"$"},F=function(e){var t,n;if("$"==e&&R(),"string"==typeof e){if("@"==(y?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=N(),"]"!=e;n||(n=!0))n&&(","==e?(e=N(),"]"==e&&R()):R()),","==e&&R(),t.push(F(e));return t}if("{"==e){for(t={};e=N(),"}"!=e;n||(n=!0))n&&(","==e?(e=N(),"}"==e&&R()):R()),(","==e||"string"!=typeof e||"@"!=(y?e.charAt(0):e[0])||":"!=N())&&R(),t[e.slice(1)]=F(N());return t}R()}return e},L=function(e,t,n){var i=j(e,t,n);i===s?delete e[t]:e[t]=i},j=function(e,t,n){var i,r=e[t];if("object"==typeof r&&r)if(a.call(r)==v)for(i=r.length;i--;)L(r,i,n);else o(r,function(e){L(r,e,n)});return n.call(e,t,r)};u.parse=function(e,t){var n,i;return O=0,I=""+e,n=F(N()),"$"!=N()&&R(),O=I=null,t&&a.call(t)==p?j((i={},i[""]=n,i),"",t):n}}}l&&e(function(){return u})}(this)},{}],50:[function(e,t,n){function i(e,t){var n=[];t=t||0;for(var i=t||0;i<e.length;i++)n[i-t]=e[i];return n}t.exports=i},{}]},{},[1])(1)}),void 0===jQuery.migrateMute&&(jQuery.migrateMute=!0),function(e,t,n){function i(n){var i=t.console;o[n]||(o[n]=!0,e.migrateWarnings.push(n),i&&i.warn&&!e.migrateMute&&(i.warn("JQMIGRATE: "+n),e.migrateTrace&&i.trace&&i.trace()))}function r(t,r,o,s){if(Object.defineProperty)try{return Object.defineProperty(t,r,{configurable:!0,enumerable:!0,get:function(){return i(s),o},set:function(e){i(s),o=e}}),n}catch(a){}e._definePropertyBroken=!0,t[r]=o}var o={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===n&&(e.migrateTrace=!0),e.migrateReset=function(){o={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&i("jQuery is not compatible with Quirks Mode");var s=e("<input/>",{size:1}).attr("size")&&e.attrFn,a=e.attr,l=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},c=e.attrHooks.value&&e.attrHooks.value.set||function(){return n},u=/^(?:input|button)$/i,h=/^[238]$/,d=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,p=/^(?:checked|selected)$/i;r(e,"attrFn",s||{},"jQuery.attrFn is deprecated"),e.attr=function(t,r,o,l){var c=r.toLowerCase(),f=t&&t.nodeType;return l&&(4>a.length&&i("jQuery.fn.attr( props, pass ) is deprecated"),t&&!h.test(f)&&(s?r in s:e.isFunction(e.fn[r])))?e(t)[r](o):("type"===r&&o!==n&&u.test(t.nodeName)&&t.parentNode&&i("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[c]&&d.test(c)&&(e.attrHooks[c]={get:function(t,i){var r,o=e.prop(t,i);return o===!0||"boolean"!=typeof o&&(r=t.getAttributeNode(i))&&r.nodeValue!==!1?i.toLowerCase():n},set:function(t,n,i){var r;return n===!1?e.removeAttr(t,i):(r=e.propFix[i]||i,r in t&&(t[r]=!0),t.setAttribute(i,i.toLowerCase())),i}},p.test(c)&&i("jQuery.fn.attr('"+c+"') may use property instead of attribute")),a.call(e,t,r,o))},e.attrHooks.value={get:function(e,t){var n=(e.nodeName||"").toLowerCase();return"button"===n?l.apply(this,arguments):("input"!==n&&"option"!==n&&i("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var r=(e.nodeName||"").toLowerCase();return"button"===r?c.apply(this,arguments):("input"!==r&&"option"!==r&&i("jQuery.fn.attr('value', val) no longer sets properties"),e.value=t,n)}};var f,g,m=e.fn.init,v=e.parseJSON,b=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,n,r){var o;return t&&"string"==typeof t&&!e.isPlainObject(n)&&(o=b.exec(e.trim(t)))&&o[0]&&("<"!==t.charAt(0)&&i("$(html) HTML strings must start with '<' character"),o[3]&&i("$(html) HTML text after last tag is ignored"),"#"===o[0].charAt(0)&&(i("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),n&&n.context&&(n=n.context),e.parseHTML)?m.call(this,e.parseHTML(o[2],n,!0),n,r):m.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?v.apply(this,arguments):(i("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(f=e.uaMatch(navigator.userAgent),g={},f.browser&&(g[f.browser]=!0,g.version=f.version),g.chrome?g.webkit=!0:g.webkit&&(g.safari=!0),e.browser=g),r(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(i,r){return r&&r instanceof e&&!(r instanceof t)&&(r=t(r)),e.fn.init.call(this,i,r,n)},t.fn.init.prototype=t.fn;var n=t(document);return i("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var y=e.fn.data;e.fn.data=function(t){var r,o,s=this[0];return!s||"events"!==t||1!==arguments.length||(r=e.data(s,t),o=e._data(s,t),r!==n&&r!==o||o===n)?y.apply(this,arguments):(i("Use of jQuery.fn.data('events') is deprecated"),o)};var w=/\/(java|ecma)script/i,_=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return i("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),_.apply(this,arguments)},e.clean||(e.clean=function(t,r,o,s){r=r||document,r=!r.nodeType&&r[0]||r,r=r.ownerDocument||r,i("jQuery.clean() is deprecated");var a,l,c,u,h=[];if(e.merge(h,e.buildFragment(t,r).childNodes),o)for(c=function(e){return!e.type||w.test(e.type)?s?s.push(e.parentNode?e.parentNode.removeChild(e):e):o.appendChild(e):n},a=0;null!=(l=h[a]);a++)e.nodeName(l,"script")&&c(l)||(o.appendChild(l),l.getElementsByTagName!==n&&(u=e.grep(e.merge([],l.getElementsByTagName("script")),c),h.splice.apply(h,[a+1,0].concat(u)),a+=u.length));return h});var x=e.event.add,C=e.event.remove,$=e.event.trigger,k=e.fn.toggle,S=e.fn.live,T=e.fn.die,E="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",D=RegExp("\\b(?:"+E+")\\b"),A=/(?:^|\s)hover(\.\S+|)\b/,O=function(t){return"string"!=typeof t||e.event.special.hover?t:(A.test(t)&&i("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(A,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&r(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,n,r,o){e!==document&&D.test(t)&&i("AJAX events should be attached to document: "+t),x.call(this,e,O(t||""),n,r,o)},e.event.remove=function(e,t,n,i,r){C.call(this,e,O(t)||"",n,i,r)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return i("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,n){if(!e.isFunction(t)||!e.isFunction(n))return k.apply(this,arguments);i("jQuery.fn.toggle(handler, handler...) is deprecated");var r=arguments,o=t.guid||e.guid++,s=0,a=function(n){var i=(e._data(this,"lastToggle"+t.guid)||0)%s;return e._data(this,"lastToggle"+t.guid,i+1),n.preventDefault(),r[i].apply(this,arguments)||!1};for(a.guid=o;r.length>s;)r[s++].guid=o;return this.click(a)},e.fn.live=function(t,n,r){return i("jQuery.fn.live() is deprecated"),S?S.apply(this,arguments):(e(this.context).on(t,this.selector,n,r),this)},e.fn.die=function(t,n){return i("jQuery.fn.die() is deprecated"),T?T.apply(this,arguments):(e(this.context).off(t,this.selector||"**",n),this)},e.event.trigger=function(e,t,n,r){return n||D.test(e)||i("Global events are undocumented and deprecated"),$.call(this,e,t,n||document,r)},e.each(E.split("|"),function(t,n){e.event.special[n]={setup:function(){var t=this;return t!==document&&(e.event.add(document,n+"."+e.guid,function(){e.event.trigger(n,null,t,!0)}),e._data(this,n,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,n+"."+e._data(this,n)),!1}}})}(jQuery,window),angular.module("ui.date",[]).constant("uiDateConfig",{}).directive("uiDate",["uiDateConfig",function(e){"use strict";var t;return t={},angular.extend(t,e),{require:"?ngModel",link:function(t,n,i,r){var o=function(){return angular.extend({},e,t.$eval(i.uiDate))},s=function(){var e=!1,i=o();if(r){var s=i.onSelect||angular.noop;i.onSelect=function(i,o){t.$apply(function(){e=!0,r.$setViewValue(n.datepicker("getDate")),s(i,o),n.blur()})},i.beforeShow=function(){e=!0},i.onClose=function(t,n){e=!1},n.off("blur.datepicker").on("blur.datepicker",function(){e||t.$apply(function(){n.datepicker("setDate",n.datepicker("getDate")),r.$setViewValue(n.datepicker("getDate"))})}),r.$render=function(){var e=r.$viewValue;if(angular.isDefined(e)&&null!==e&&!angular.isDate(e))throw new Error("ng-Model value must be a Date object - currently it is a "+typeof e+" - use ui-date-format to convert it from a string");n.datepicker("setDate",e)}}n.datepicker("destroy"),n.datepicker(i),r&&r.$render()};t.$watch(o,s,!0)}}}]).constant("uiDateFormatConfig","").directive("uiDateFormat",["uiDateFormatConfig",function(e){var t={require:"ngModel",link:function(t,n,i,r){var o=i.uiDateFormat||e;o?(r.$formatters.push(function(e){return angular.isString(e)?jQuery.datepicker.parseDate(o,e):null}),r.$parsers.push(function(e){return e?jQuery.datepicker.formatDate(o,e):null})):(r.$formatters.push(function(e){return angular.isString(e)?new Date(e):null}),r.$parsers.push(function(e){return e?e.toISOString():null}))}};return t}]),function(){function e(e){for(var t,n,i=e.css("color"),e=e[0],r=!1;e&&!n&&!r;){try{t=$(e).css("background-color")}catch(o){t="transparent"}"transparent"!==t&&"rgba(0, 0, 0, 0)"!==t&&(n=t),r=e.body,e=e.parentNode}var s,e=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,r=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/;t=void 0,(t=i.match(e))?s={r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}:(t=i.match(r))&&(s={r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)});var a;return n?(t=void 0,(t=n.match(e))?a={r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}:(t=n.match(r))&&(a={r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)})):a=s&&127<Math.max.apply(null,[s.r,s.g,s.b])?{r:0,g:0,b:0}:{r:255,g:255,b:255},t=function(e){return"rgb("+[e.r,e.g,e.b].join(", ")+")"},s&&a?(e=Math.max.apply(null,[s.r,s.g,s.b]),s=Math.max.apply(null,[a.r,a.g,a.b]),s=Math.round(s+-.75*(s-e)),s={r:s,g:s,b:s}):s?(s=Math.max.apply(null,[s.r,s.g,s.b]),e=1,s>127&&(e=-1),s=Math.round(s+96*e),s={r:s,g:s,b:s}):s={r:191,g:191,b:191},{color:i,"background-color":a?t(a):n,"decor-color":t(s)}}function t(e,t){this.x=e,this.y=t,this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)},this._length=null,this.getLength=function(){return this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))),this._length};var n=function(e){return Math.round(e/Math.abs(e))};this.resizeTo=function(e){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=e,this.y=e*n(this.y);else if(0===this.y)this._length=e,this.x=e*n(this.x);else{var t=Math.abs(this.y/this.x),i=Math.sqrt(Math.pow(e,2)/(1+Math.pow(t,2))),t=t*i;this._length=e,this.x=i*n(this.x),this.y=t*n(this.y)}return this},this.angleTo=function(e){var t=this.getLength()*e.getLength();return 0===t?0:Math.acos(Math.min(Math.max((this.x*e.x+this.y*e.y)/t,-1),1))/Math.PI}}function n(e,n){this.x=e,this.y=n,this.getVectorToCoordinates=function(e,n){return new t(e-this.x,n-this.y)},this.getVectorFromCoordinates=function(e,t){return this.getVectorToCoordinates(e,t).reverse()},this.getVectorToPoint=function(e){return new t(e.x-this.x,e.y-this.y)},this.getVectorFromPoint=function(e){return this.getVectorToPoint(e).reverse()}}function i(e,t,n,i,r){if(this.data=e,this.context=t,e.length)for(var o,s,a=e.length,l=0;a>l;l++){o=e[l],s=o.x.length,n.call(t,o);for(var c=1;s>c;c++)i.call(t,o,c);r.call(t,o)}this.changed=function(){},this.startStrokeFn=n,this.addToStrokeFn=i,this.endStrokeFn=r,this.inStroke=!1,this._stroke=this._lastPoint=null,this.startStroke=function(e){if(e&&"number"==typeof e.x&&"number"==typeof e.y){this._stroke={x:[e.x],y:[e.y]},this.data.push(this._stroke),this._lastPoint=e,this.inStroke=!0;var t=this._stroke,n=this.startStrokeFn,i=this.context;return setTimeout(function(){n.call(i,t)},3),e}return null},this.addToStroke=function(e){if(this.inStroke&&"number"==typeof e.x&&"number"==typeof e.y&&4<Math.abs(e.x-this._lastPoint.x)+Math.abs(e.y-this._lastPoint.y)){var t=this._stroke.x.length;this._stroke.x.push(e.x),this._stroke.y.push(e.y),this._lastPoint=e;var n=this._stroke,i=this.addToStrokeFn,r=this.context;return setTimeout(function(){i.call(r,n,t)},3),e}return null},this.endStroke=function(){var e=this.inStroke;if(this.inStroke=!1,this._lastPoint=null,e){var t=this._stroke,n=this.endStrokeFn,i=this.context,r=this.changed;return setTimeout(function(){n.call(i,t),r.call(i)},3),!0}return null}}function r(t,i,r){var l=this.$parent=$(t),t=this.eventTokens={};this.events=new a(this);var c=$.fn[o]("globalEvents"),u={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10,showUndoButton:!1,data:[]};$.extend(u,e(l)),i&&$.extend(u,i),this.settings=u;for(var h in r)r.hasOwnProperty(h)&&r[h].call(this,h);this.events.publish(o+".initializing"),this.$controlbarUpper=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1em !important;margin-bottom:1em !important;"></div>').appendTo(l),this.isCanvasEmulator=!1,r=this.canvas=this.initializeCanvas(u),i=$(r),this.$controlbarLower=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1.5em !important;margin-bottom:1.5em !important;"></div>').appendTo(l),this.canvasContext=r.getContext("2d"),i.data(o+".this",this),l=(l=u.lineWidth)?l:Math.max(Math.round(r.width/400),2),u.lineWidth=l,this.lineCurveThreshold=3*u.lineWidth,u.cssclass&&""!=$.trim(u.cssclass)&&i.addClass(u.cssclass),this.fatFingerCompensation=0;var l=function(e){var t,i,r=function(r){return r=r.changedTouches&&0<r.changedTouches.length?r.changedTouches[0]:r,new n(Math.round(r.pageX+t),Math.round(r.pageY+i)+e.fatFingerCompensation)},o=new s(750,function(){e.dataEngine.endStroke()});return this.drawEndHandler=function(t){try{t.preventDefault()}catch(n){}o.clear(),e.dataEngine.endStroke()},this.drawStartHandler=function(n){n.preventDefault();var s=$(e.canvas).offset();t=-1*s.left,i=-1*s.top,e.dataEngine.startStroke(r(n)),o.kick()},this.drawMoveHandler=function(t){t.preventDefault(),e.dataEngine.inStroke&&(e.dataEngine.addToStroke(r(t)),o.kick())},this}.call({},this),d=l.drawEndHandler,p=l.drawStartHandler,f=l.drawMoveHandler,g=this.canvas,i=$(g);this.isCanvasEmulator?(i.bind("mousemove."+o,f),i.bind("mouseup."+o,d),i.bind("mousedown."+o,p)):(g.ontouchstart=function(e){g.onmousedown=void 0,g.onmouseup=void 0,g.onmousemove=void 0,this.fatFingerCompensation=u.minFatFingerCompensation&&-3*u.lineWidth>u.minFatFingerCompensation?-3*u.lineWidth:u.minFatFingerCompensation,p(e),g.ontouchend=d,g.ontouchstart=p,g.ontouchmove=f},g.onmousedown=function(e){g.ontouchstart=void 0,g.ontouchend=void 0,g.ontouchmove=void 0,p(e),g.onmousedown=p,g.onmouseup=d,g.onmousemove=f}),t[o+".windowmouseup"]=c.subscribe(o+".windowmouseup",l.drawEndHandler),this.events.publish(o+".attachingEventHandlers");var m=this,t=u.width.toString(10),v=o;return("ratio"===t||"%"===t.split("")[t.length-1])&&(this.eventTokens[v+".parentresized"]=c.subscribe(v+".parentresized",function(e,t,n){return function(){var i=t.width();if(i!==n){for(var r in e)e.hasOwnProperty(r)&&(c.unsubscribe(e[r]),delete e[r]);var o=m.settings;m.$parent.children().remove();for(r in m)m.hasOwnProperty(r)&&delete m[r];r=o.data;var s,a,l,u,h,d,i=1*i/n,p=[];for(a=0,l=r.length;l>a;a++){for(d=r[a],s={x:[],y:[]},u=0,h=d.x.length;h>u;u++)s.x.push(d.x[u]*i),s.y.push(d.y[u]*i);p.push(s)}o.data=p,t[v](o)}}}(this.eventTokens,this.$parent,this.$parent.width(),1*this.canvas.width/this.canvas.height))),this.resetCanvas(u.data),this.events.publish(o+".initialized"),this}var o="jSignature",s=function(e,t){var n;return this.kick=function(){clearTimeout(n),n=setTimeout(t,e)},this.clear=function(){clearTimeout(n)},this},a=function(e){this.topics={},this.context=e?e:this,this.publish=function(e,t,n,i){if(this.topics[e]){var r,o,s,a,l=this.topics[e],c=Array.prototype.slice.call(arguments,1),u=[];for(o=0,s=l.length;s>o;o++)a=l[o],r=a[0],a[1]&&(a[0]=function(){},u.push(o)),r.apply(this.context,c);for(o=0,s=u.length;s>o;o++)l.splice(u[o],1)}},this.subscribe=function(e,t,n){return this.topics[e]?this.topics[e].push([t,n]):this.topics[e]=[[t,n]],{topic:e,callback:t}},this.unsubscribe=function(e){if(this.topics[e.topic])for(var t=this.topics[e.topic],n=0,i=t.length;i>n;n++)t[n][0]===e.callback&&t.splice(n,1)}},l=function(e){var t=this.canvasContext,n=e.x[0],e=e.y[0],i=this.settings.lineWidth,r=t.fillStyle;t.fillStyle=t.strokeStyle,t.fillRect(n+i/-2,e+i/-2,i,i),t.fillStyle=r},c=function(e,i){var r=new n(e.x[i-1],e.y[i-1]),o=new n(e.x[i],e.y[i]),s=r.getVectorToPoint(o);if(i>1){var a,l=new n(e.x[i-2],e.y[i-2]),c=l.getVectorToPoint(r);if(c.getLength()>this.lineCurveThreshold){a=i>2?new n(e.x[i-3],e.y[i-3]).getVectorToPoint(l):new t(0,0);var u=.35*c.getLength(),h=c.angleTo(a.reverse()),d=s.angleTo(c.reverse());a=new t(a.x+c.x,a.y+c.y).resizeTo(Math.max(.05,h)*u);var p=new t(c.x+s.x,c.y+s.y).reverse().resizeTo(Math.max(.05,d)*u),c=this.canvasContext,u=l.x,d=l.y,h=r.x,f=r.y,g=l.x+a.x,l=l.y+a.y;a=r.x+p.x,p=r.y+p.y,c.beginPath(),c.moveTo(u,d),c.bezierCurveTo(g,l,a,p,h,f),c.stroke()}}s.getLength()<=this.lineCurveThreshold&&(s=this.canvasContext,l=r.x,r=r.y,a=o.x,o=o.y,s.beginPath(),s.moveTo(l,r),s.lineTo(a,o),s.stroke())},u=function(e){var i=e.x.length-1;if(i>0){var r=new n(e.x[i],e.y[i]),o=new n(e.x[i-1],e.y[i-1]),s=o.getVectorToPoint(r);if(s.getLength()>this.lineCurveThreshold){if(i>1){var e=new n(e.x[i-2],e.y[i-2]).getVectorToPoint(o),a=new t(e.x+s.x,e.y+s.y).resizeTo(s.getLength()/2),s=this.canvasContext,e=o.x,i=o.y,l=r.x,c=r.y,u=o.x+a.x,o=o.y+a.y,a=r.x,r=r.y;s.beginPath(),s.moveTo(e,i),s.bezierCurveTo(u,o,a,r,l,c)}else s=this.canvasContext,e=o.x,o=o.y,i=r.x,r=r.y,s.beginPath(),s.moveTo(e,o),s.lineTo(i,r);s.stroke()}}};r.prototype.resetCanvas=function(e){var t=this.canvas,n=this.settings,r=this.canvasContext,s=this.isCanvasEmulator,a=t.width,h=t.height;r.clearRect(0,0,a+30,h+30),r.shadowColor=r.fillStyle=n["background-color"],s&&r.fillRect(0,0,a+30,h+30),r.lineWidth=Math.ceil(parseInt(n.lineWidth,10)),r.lineCap=r.lineJoin="round",r.strokeStyle=n["decor-color"],r.shadowOffsetX=0,r.shadowOffsetY=0;var d=Math.round(h/5),p=1.5*d,f=h-d,a=a-1.5*d,h=h-d;r.beginPath(),r.moveTo(p,f),r.lineTo(a,h),r.stroke(),r.strokeStyle=n.color,s||(r.shadowColor=r.strokeStyle,r.shadowOffsetX=.5*r.lineWidth,r.shadowOffsetY=-.6*r.lineWidth,r.shadowBlur=0),e||(e=[]),r=this.dataEngine=new i(e,this,l,c,u),n.data=e,$(t).data(o+".data",e).data(o+".settings",n);var g=this.$parent,m=this.events,v=o;return r.changed=function(){m.publish(v+".change"),g.trigger("change")},r.changed(),!0},r.prototype.initializeCanvas=function(e){var t=document.createElement("canvas"),n=$(t);if(e.width===e.height&&"ratio"===e.height&&(e.width="100%"),n.css("margin",0).css("padding",0).css("border","none").css("height","ratio"!==e.height&&e.height?e.height.toString(10):1).css("width","ratio"!==e.width&&e.width?e.width.toString(10):1),n.appendTo(this.$parent),"ratio"===e.height?n.css("height",Math.round(n.width()/e.sizeRatio)):"ratio"===e.width&&n.css("width",Math.round(n.height()*e.sizeRatio)),n.addClass(o),t.width=n.width(),t.height=n.height(),e=t,e.getContext)e=!1;else{var n=e.ownerDocument.parentWindow,i=n.FlashCanvas?e.ownerDocument.parentWindow.FlashCanvas:"undefined"==typeof FlashCanvas?void 0:FlashCanvas;if(!i)throw Error("Canvas element does not support 2d context. jSignature cannot proceed.");if(e=i.initElement(e),i=1,n&&n.screen&&n.screen.deviceXDPI&&n.screen.logicalXDPI&&(i=1*n.screen.deviceXDPI/n.screen.logicalXDPI),1!==i)try{$(e).children("object").get(0).resize(Math.ceil(e.width*i),Math.ceil(e.height*i)),e.getContext("2d").scale(i,i)}catch(r){}e=!0}return this.isCanvasEmulator=e,t.onselectstart=function(e){return e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),!1},t};var h,d=window,p=function(e,t){var n=new Image,i=this;n.onload=function(){i.getContext("2d").drawImage(n,0,0,n.width<i.width?n.width:i.width,n.height<i.height?n.height:i.height)},n.src="data:"+t+","+e},f=function(e){return this.find("canvas."+o).add(this.filter("canvas."+o)).data(o+".this").resetCanvas(e),this},g=function(e,t){if(void 0!==t||"string"!=typeof e||"data:"!==e.substr(0,5)||(t=e.slice(5).split(",")[0],e=e.slice(6+t.length),t!==e)){var n=this.find("canvas."+o).add(this.filter("canvas."+o));if(!_.hasOwnProperty(t))throw Error(o+" is unable to find import plugin with for format '"+String(t)+"'");return 0!==n.length&&_[t].call(n[0],e,t,function(e){return function(){return e.resetCanvas.apply(e,arguments)}}(n.data(o+".this"))),this}},m=new a,v=o,b=function(){m.publish(v+".parentresized")};$(d).bind("resize."+v,function(){h&&clearTimeout(h),h=setTimeout(b,500)}).bind("mouseup."+v,function(){m.publish(v+".windowmouseup")});var y={},w={"default":function(){return this.toDataURL()},"native":function(e){return e},image:function(){var e=this.toDataURL();if("string"==typeof e&&4<e.length&&"data:"===e.slice(0,5)&&-1!==e.indexOf(",")){var t=e.indexOf(",");return[e.slice(5,t),e.substr(t+1)]}return[]}},_={"native":function(e,t,n){n(e)},image:p,"image/png;base64":p,"image/jpeg;base64":p,"image/jpg;base64":p},x={"export":w,"import":_,instance:y},C={init:function(e){return this.each(function(){var t,n=!1;for(t=this.parentNode;t&&!n;)n=t.body,t=t.parentNode;!n||new r(this,e,y)})},getSettings:function(){return this.find("canvas."+o).add(this.filter("canvas."+o)).data(o+".this").settings},clear:f,reset:f,addPlugin:function(e,t,n){return x.hasOwnProperty(e)&&(x[e][t]=n),this},listPlugins:function(e){var t=[];if(x.hasOwnProperty(e)){var n,e=x[e];for(n in e)e.hasOwnProperty(n)&&t.push(n)}return t},getData:function(e){var t=this.find("canvas."+o).add(this.filter("canvas."+o));return void 0===e&&(e="default"),0!==t.length&&w.hasOwnProperty(e)?w[e].call(t.get(0),t.data(o+".data")):void 0},importData:g,setData:g,globalEvents:function(){return m},events:function(){return this.find("canvas."+o).add(this.filter("canvas."+o)).data(o+".this").events}};$.fn[o]=function(e){return e&&"object"!=typeof e?"string"==typeof e&&C[e]?C[e].apply(this,Array.prototype.slice.call(arguments,1)):void $.error("Method "+String(e)+" does not exist on jQuery."+o):C.init.apply(this,arguments)}}(),function(){$.fn.jSignature("addPlugin","instance","UndoButton",function(e){this.events.subscribe("jSignature.attachingEventHandlers",function(){
if(this.settings[e]){var t=this.settings[e];"function"!=typeof t&&(t=function(){var e=$('<input type="button" value="Undo last stroke" style="position:absolute;display:none;margin:0 !important;top:auto" />').appendTo(this.$controlbarLower),t=e.width();return e.css("left",Math.round((this.canvas.width-t)/2)),t!==e.width()&&e.width(t),e});var n=t.call(this),i=this;i.events.subscribe("jSignature.change",function(){i.dataEngine.data.length?n.show():n.hide()});var r=this,o=(this.events.topics.hasOwnProperty("jSignature.undo")?e:"jSignature")+".undo";n.bind("click",function(){r.events.publish(o)}),r.events.subscribe(o,function(){var e=r.dataEngine.data;e.length&&(e.pop(),r.resetCanvas(e))})}})})}(),function(){for(var e={},t={},n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX".split(""),i=n.length/2,r=i-1;r>-1;r--)e[n[r]]=n[r+i],t[n[r+i]]=n[r];var o=function(t){for(var t=t.split(""),n=t.length,i=1;n>i;i++)t[i]=e[t[i]];return t.join("")},s=function(e){for(var t,n,r=[],s=0,a=1,l=e.length,c=0;l>c;c++)t=Math.round(e[c]),n=t-s,s=t,0>n&&a>0?(a=-1,r.push("Z")):n>0&&0>a&&(a=1,r.push("Y")),t=Math.abs(n),r.push(t>=i?o(t.toString(i)):t.toString(i));return r.join("")},a=function(n){for(var r,o=[],n=n.split(""),s=n.length,a=1,l=[],c=0,u=0;s>u;u++)r=n[u],r in e||"Z"===r||"Y"===r?(0!==l.length&&(l=parseInt(l.join(""),i)*a+c,o.push(l),c=l),"Z"===r?(a=-1,l=[]):"Y"===r?(a=1,l=[]):l=[r]):l.push(t[r]);return o.push(parseInt(l.join(""),i)*a+c),o},l=function(e){for(var t,n=[],i=e.length,r=0;i>r;r++)t=e[r],n.push(s(t.x)),n.push(s(t.y));return n.join("_")},c=function(e){for(var t=[],e=e.split("_"),n=e.length/2,i=0;n>i;i++)t.push({x:a(e[2*i]),y:a(e[2*i+1])});return t},n=function(e){return["image/jsignature;base30",l(e)]},r=function(e,t,n){"string"==typeof e&&("image/jsignature;base30"===e.substring(0,23).toLowerCase()&&(e=e.substring(24)),n(c(e)))};if(null==this.jQuery)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");var u=this.jQuery.fn.jSignature;u("addPlugin","export","base30",n),u("addPlugin","export","image/jsignature;base30",n),u("addPlugin","import","base30",r),u("addPlugin","import","image/jsignature;base30",r),this.jSignatureDebug&&(this.jSignatureDebug.base30={remapTailChars:o,compressstrokeleg:s,uncompressstrokeleg:a,compressstrokes:l,uncompressstrokes:c,charmap:e})}.call("undefined"!=typeof window?window:this),function(){function e(e,t){this.x=e,this.y=t,this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)},this._length=null,this.getLength=function(){return this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))),this._length};var n=function(e){return Math.round(e/Math.abs(e))};this.resizeTo=function(e){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=e,this.y=e*n(this.y);else if(0===this.y)this._length=e,this.x=e*n(this.x);else{var t=Math.abs(this.y/this.x),i=Math.sqrt(Math.pow(e,2)/(1+Math.pow(t,2))),t=t*i;this._length=e,this.x=i*n(this.x),this.y=t*n(this.y)}return this},this.angleTo=function(e){var t=this.getLength()*e.getLength();return 0===t?0:Math.acos(Math.min(Math.max((this.x*e.x+this.y*e.y)/t,-1),1))/Math.PI}}function t(t,n){this.x=t,this.y=n,this.getVectorToCoordinates=function(t,n){return new e(t-this.x,n-this.y)},this.getVectorFromCoordinates=function(e,t){return this.getVectorToCoordinates(e,t).reverse()},this.getVectorToPoint=function(t){return new e(t.x-this.x,t.y-this.y)},this.getVectorFromPoint=function(e){return this.getVectorToPoint(e).reverse()}}function n(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function i(i,r,o){var r=r+1,s=new t(i.x[r-1],i.y[r-1]),a=new t(i.x[r],i.y[r]),a=s.getVectorToPoint(a),l=new t(i.x[r-2],i.y[r-2]),s=l.getVectorToPoint(s);return s.getLength()>o?(o=r>2?new t(i.x[r-3],i.y[r-3]).getVectorToPoint(l):new e(0,0),i=.35*s.getLength(),l=s.angleTo(o.reverse()),r=a.angleTo(s.reverse()),o=new e(o.x+s.x,o.y+s.y).resizeTo(Math.max(.05,l)*i),a=new e(s.x+a.x,s.y+a.y).reverse().resizeTo(Math.max(.05,r)*i),a=new e(s.x+a.x,s.y+a.y),["c",n(o.x,2),n(o.y,2),n(a.x,2),n(a.y,2),n(s.x,2),n(s.y,2)]):["l",n(s.x,2),n(s.y,2)]}function r(i,r){var o=i.x.length-1,s=new t(i.x[o],i.y[o]),a=new t(i.x[o-1],i.y[o-1]),s=a.getVectorToPoint(s);if(o>1&&s.getLength()>r){var o=new t(i.x[o-2],i.y[o-2]).getVectorToPoint(a),a=s.angleTo(o.reverse()),l=.35*s.getLength(),o=new e(o.x+s.x,o.y+s.y).resizeTo(Math.max(.05,a)*l);return["c",n(o.x,2),n(o.y,2),n(s.x,2),n(s.y,2),n(s.x,2),n(s.y,2)]}return["l",n(s.x,2),n(s.y,2)]}function o(e,t,o){for(var t=["M",n(e.x[0]-t,2),n(e.y[0]-o,2)],o=1,s=e.x.length-1;s>o;o++)t.push.apply(t,i(e,o,1));return s>0?t.push.apply(t,r(e,o,1)):0===s&&t.push.apply(t,["l",1,1]),t.join(" ")}function s(e){var t,n,i=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'],r=e.length,s=[],a=[],l=n=t=0,c=0,u=[];if(0!==r){for(t=0;r>t;t++){l=e[t],c=[],n={x:[],y:[]};for(var h=void 0,d=void 0,h=0,d=l.x.length;d>h;h++)c.push({x:l.x[h],y:l.y[h]});for(c=simplify(c,.7,!0),h=0,d=c.length;d>h;h++)n.x.push(c[h].x),n.y.push(c[h].y);u.push(n),s=s.concat(n.x),a=a.concat(n.y)}e=Math.min.apply(null,s)-1,r=Math.max.apply(null,s)+1,s=Math.min.apply(null,a)-1,a=Math.max.apply(null,a)+1,l=0>e?0:e,c=0>s?0:s,t=r-e,n=a-s}for(i.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+t.toString()+'" height="'+n.toString()+'">'),t=0,r=u.length;r>t;t++)n=u[t],i.push('<path fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="'+o(n,l,c)+'"/>');return i.push("</svg>"),i.join("")}function a(e){return[h,s(e)]}function l(e){return[d,u(s(e))]}var c=window;if(("undefined"!=typeof exports?exports:c).simplify=function(e,t,n){if(t=void 0!==t?t*t:1,!n){for(var i,r=e.length,o=e[0],s=[o],n=1;r>n;n++){i=e[n];var a=i.x-o.x,l=i.y-o.y;a*a+l*l>t&&(s.push(i),o=i)}o!==i&&s.push(i),e=s}i=e;var c,u,n=i.length,r=new("undefined"!=typeof Uint8Array?Uint8Array:Array)(n),o=0,s=n-1,h=[],d=[],p=[];for(r[o]=r[s]=1;s;){for(l=0,a=o+1;s>a;a++){c=i[a];var f=i[o],g=i[s],m=f.x,v=f.y,f=g.x-m,b=g.y-v,y=void 0;(0!==f||0!==b)&&(y=((c.x-m)*f+(c.y-v)*b)/(f*f+b*b),y>1?(m=g.x,v=g.y):y>0&&(m+=f*y,v+=b*y)),f=c.x-m,b=c.y-v,c=f*f+b*b,c>l&&(u=a,l=c)}l>t&&(r[u]=1,h.push(o),d.push(u),h.push(u),d.push(s)),o=h.pop(),s=d.pop()}for(a=0;n>a;a++)r[a]&&p.push(i[a]);return e=p},"function"!=typeof u)var u=function(e){var t,n,i,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),s=0,a=0,l="",l=[];do t=e.charCodeAt(s++),n=e.charCodeAt(s++),i=e.charCodeAt(s++),r=t<<16|n<<8|i,t=r>>18&63,n=r>>12&63,i=r>>6&63,r&=63,l[a++]=o[t]+o[n]+o[i]+o[r];while(s<e.length);return l=l.join(""),e=e.length%3,(e?l.slice(0,e-3):l)+"===".slice(e||3)};var h="image/svg+xml",d="image/svg+xml;base64";if("undefined"==typeof $)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");c=$.fn.jSignature,c("addPlugin","export","svg",a),c("addPlugin","export",h,a),c("addPlugin","export","svgbase64",l),c("addPlugin","export",d,l)}(),function(e){!function(){function t(t){for(var n,i,r=t.css("color"),t=t[0],o=!1;t&&!i&&!o;){try{n=e(t).css("background-color")}catch(s){n="transparent"}"transparent"!==n&&"rgba(0, 0, 0, 0)"!==n&&(i=n),o=t.body,t=t.parentNode}var a,t=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,o=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/;n=void 0,(n=r.match(t))?a={r:parseInt(n[1],10),g:parseInt(n[2],10),b:parseInt(n[3],10)}:(n=r.match(o))&&(a={r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)});var l;return i?(n=void 0,(n=i.match(t))?l={r:parseInt(n[1],10),g:parseInt(n[2],10),b:parseInt(n[3],10)}:(n=i.match(o))&&(l={r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)})):l=a&&127<Math.max.apply(null,[a.r,a.g,a.b])?{r:0,g:0,b:0}:{r:255,g:255,b:255},n=function(e){return"rgb("+[e.r,e.g,e.b].join(", ")+")"},a&&l?(t=Math.max.apply(null,[a.r,a.g,a.b]),a=Math.max.apply(null,[l.r,l.g,l.b]),a=Math.round(a+-.75*(a-t)),a={r:a,g:a,b:a}):a?(a=Math.max.apply(null,[a.r,a.g,a.b]),t=1,a>127&&(t=-1),a=Math.round(a+96*t),a={r:a,g:a,b:a}):a={r:191,g:191,b:191},{color:r,"background-color":l?n(l):i,"decor-color":n(a)}}function n(e,t){this.x=e,this.y=t,this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)},this._length=null,this.getLength=function(){return this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))),this._length};var n=function(e){return Math.round(e/Math.abs(e))};this.resizeTo=function(e){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=e,this.y=e*n(this.y);else if(0===this.y)this._length=e,this.x=e*n(this.x);else{var t=Math.abs(this.y/this.x),i=Math.sqrt(Math.pow(e,2)/(1+Math.pow(t,2))),t=t*i;this._length=e,this.x=i*n(this.x),this.y=t*n(this.y)}return this},this.angleTo=function(e){var t=this.getLength()*e.getLength();return 0===t?0:Math.acos(Math.min(Math.max((this.x*e.x+this.y*e.y)/t,-1),1))/Math.PI}}function i(e,t){this.x=e,this.y=t,this.getVectorToCoordinates=function(e,t){return new n(e-this.x,t-this.y)},this.getVectorFromCoordinates=function(e,t){return this.getVectorToCoordinates(e,t).reverse()},this.getVectorToPoint=function(e){return new n(e.x-this.x,e.y-this.y)},this.getVectorFromPoint=function(e){return this.getVectorToPoint(e).reverse()}}function r(e,t,n,i,r){if(this.data=e,this.context=t,e.length)for(var o,s,a=e.length,l=0;a>l;l++){o=e[l],s=o.x.length,n.call(t,o);for(var c=1;s>c;c++)i.call(t,o,c);r.call(t,o)}this.changed=function(){},this.startStrokeFn=n,this.addToStrokeFn=i,this.endStrokeFn=r,this.inStroke=!1,this._stroke=this._lastPoint=null,this.startStroke=function(e){if(e&&"number"==typeof e.x&&"number"==typeof e.y){this._stroke={x:[e.x],y:[e.y]},this.data.push(this._stroke),this._lastPoint=e,this.inStroke=!0;var t=this._stroke,n=this.startStrokeFn,i=this.context;return setTimeout(function(){n.call(i,t)},3),e}return null},this.addToStroke=function(e){if(this.inStroke&&"number"==typeof e.x&&"number"==typeof e.y&&4<Math.abs(e.x-this._lastPoint.x)+Math.abs(e.y-this._lastPoint.y)){var t=this._stroke.x.length;this._stroke.x.push(e.x),this._stroke.y.push(e.y),this._lastPoint=e;var n=this._stroke,i=this.addToStrokeFn,r=this.context;return setTimeout(function(){i.call(r,n,t)},3),e}return null},this.endStroke=function(){var e=this.inStroke;if(this.inStroke=!1,this._lastPoint=null,e){var t=this._stroke,n=this.endStrokeFn,i=this.context,r=this.changed;return setTimeout(function(){n.call(i,t),r.call(i)},3),!0}return null}}function o(n,r,o){var c=this.$parent=e(n),n=this.eventTokens={};this.events=new l(this);var u=e.fn[s]("globalEvents"),h={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10,showUndoButton:!1,data:[]};e.extend(h,t(c)),r&&e.extend(h,r),this.settings=h;for(var d in o)o.hasOwnProperty(d)&&o[d].call(this,d);this.events.publish(s+".initializing"),this.$controlbarUpper=e('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1em !important;margin-bottom:1em !important;"></div>').appendTo(c),this.isCanvasEmulator=!1,o=this.canvas=this.initializeCanvas(h),r=e(o),this.$controlbarLower=e('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1.5em !important;margin-bottom:1.5em !important;"></div>').appendTo(c),this.canvasContext=o.getContext("2d"),r.data(s+".this",this),c=(c=h.lineWidth)?c:Math.max(Math.round(o.width/400),2),h.lineWidth=c,this.lineCurveThreshold=3*h.lineWidth,h.cssclass&&""!=e.trim(h.cssclass)&&r.addClass(h.cssclass),this.fatFingerCompensation=0;var c=function(t){var n,r,o=function(e){return e=e.changedTouches&&0<e.changedTouches.length?e.changedTouches[0]:e,new i(Math.round(e.pageX+n),Math.round(e.pageY+r)+t.fatFingerCompensation)},s=new a(750,function(){t.dataEngine.endStroke()});return this.drawEndHandler=function(e){try{e.preventDefault()}catch(n){}s.clear(),t.dataEngine.endStroke()},this.drawStartHandler=function(i){i.preventDefault();var a=e(t.canvas).offset();n=-1*a.left,r=-1*a.top,t.dataEngine.startStroke(o(i)),s.kick()},this.drawMoveHandler=function(e){e.preventDefault(),t.dataEngine.inStroke&&(t.dataEngine.addToStroke(o(e)),s.kick())},this}.call({},this),p=c.drawEndHandler,f=c.drawStartHandler,g=c.drawMoveHandler,m=this.canvas,r=e(m);this.isCanvasEmulator?(r.bind("mousemove."+s,g),r.bind("mouseup."+s,p),r.bind("mousedown."+s,f)):(m.ontouchstart=function(e){m.onmousedown=void 0,m.onmouseup=void 0,m.onmousemove=void 0,this.fatFingerCompensation=h.minFatFingerCompensation&&-3*h.lineWidth>h.minFatFingerCompensation?-3*h.lineWidth:h.minFatFingerCompensation,f(e),m.ontouchend=p,m.ontouchstart=f,m.ontouchmove=g},m.onmousedown=function(e){m.ontouchstart=void 0,m.ontouchend=void 0,m.ontouchmove=void 0,f(e),m.onmousedown=f,m.onmouseup=p,m.onmousemove=g}),n[s+".windowmouseup"]=u.subscribe(s+".windowmouseup",c.drawEndHandler),this.events.publish(s+".attachingEventHandlers");var v=this,n=h.width.toString(10),b=s;return("ratio"===n||"%"===n.split("")[n.length-1])&&(this.eventTokens[b+".parentresized"]=u.subscribe(b+".parentresized",function(e,t,n){return function(){var i=t.width();if(i!==n){for(var r in e)e.hasOwnProperty(r)&&(u.unsubscribe(e[r]),delete e[r]);var o=v.settings;v.$parent.children().remove();for(r in v)v.hasOwnProperty(r)&&delete v[r];r=o.data;var s,a,l,c,h,d,i=1*i/n,p=[];for(a=0,l=r.length;l>a;a++){for(d=r[a],s={x:[],y:[]},c=0,h=d.x.length;h>c;c++)s.x.push(d.x[c]*i),s.y.push(d.y[c]*i);p.push(s)}o.data=p,t[b](o)}}}(this.eventTokens,this.$parent,this.$parent.width(),1*this.canvas.width/this.canvas.height))),this.resetCanvas(h.data),this.events.publish(s+".initialized"),this}var s="jSignature",a=function(e,t){var n;return this.kick=function(){clearTimeout(n),n=setTimeout(t,e)},this.clear=function(){clearTimeout(n)},this},l=function(e){this.topics={},this.context=e?e:this,this.publish=function(e,t,n,i){if(this.topics[e]){var r,o,s,a,l=this.topics[e],c=Array.prototype.slice.call(arguments,1),u=[];for(o=0,s=l.length;s>o;o++)a=l[o],r=a[0],a[1]&&(a[0]=function(){},u.push(o)),r.apply(this.context,c);for(o=0,s=u.length;s>o;o++)l.splice(u[o],1)}},this.subscribe=function(e,t,n){return this.topics[e]?this.topics[e].push([t,n]):this.topics[e]=[[t,n]],{topic:e,callback:t}},this.unsubscribe=function(e){if(this.topics[e.topic])for(var t=this.topics[e.topic],n=0,i=t.length;i>n;n++)t[n][0]===e.callback&&t.splice(n,1)}},c=function(e){var t=this.canvasContext,n=e.x[0],e=e.y[0],i=this.settings.lineWidth,r=t.fillStyle;t.fillStyle=t.strokeStyle,t.fillRect(n+i/-2,e+i/-2,i,i),t.fillStyle=r},u=function(e,t){var r=new i(e.x[t-1],e.y[t-1]),o=new i(e.x[t],e.y[t]),s=r.getVectorToPoint(o);if(t>1){var a,l=new i(e.x[t-2],e.y[t-2]),c=l.getVectorToPoint(r);if(c.getLength()>this.lineCurveThreshold){a=t>2?new i(e.x[t-3],e.y[t-3]).getVectorToPoint(l):new n(0,0);var u=.35*c.getLength(),h=c.angleTo(a.reverse()),d=s.angleTo(c.reverse());a=new n(a.x+c.x,a.y+c.y).resizeTo(Math.max(.05,h)*u);var p=new n(c.x+s.x,c.y+s.y).reverse().resizeTo(Math.max(.05,d)*u),c=this.canvasContext,u=l.x,d=l.y,h=r.x,f=r.y,g=l.x+a.x,l=l.y+a.y;a=r.x+p.x,p=r.y+p.y,c.beginPath(),c.moveTo(u,d),c.bezierCurveTo(g,l,a,p,h,f),c.stroke()}}s.getLength()<=this.lineCurveThreshold&&(s=this.canvasContext,l=r.x,r=r.y,a=o.x,o=o.y,s.beginPath(),s.moveTo(l,r),s.lineTo(a,o),s.stroke())},h=function(e){var t=e.x.length-1;if(t>0){var r=new i(e.x[t],e.y[t]),o=new i(e.x[t-1],e.y[t-1]),s=o.getVectorToPoint(r);if(s.getLength()>this.lineCurveThreshold){if(t>1){var e=new i(e.x[t-2],e.y[t-2]).getVectorToPoint(o),a=new n(e.x+s.x,e.y+s.y).resizeTo(s.getLength()/2),s=this.canvasContext,e=o.x,t=o.y,l=r.x,c=r.y,u=o.x+a.x,o=o.y+a.y,a=r.x,r=r.y;s.beginPath(),s.moveTo(e,t),s.bezierCurveTo(u,o,a,r,l,c)}else s=this.canvasContext,e=o.x,o=o.y,t=r.x,r=r.y,s.beginPath(),s.moveTo(e,o),s.lineTo(t,r);s.stroke()}}};o.prototype.resetCanvas=function(t){var n=this.canvas,i=this.settings,o=this.canvasContext,a=this.isCanvasEmulator,l=n.width,d=n.height;o.clearRect(0,0,l+30,d+30),o.shadowColor=o.fillStyle=i["background-color"],a&&o.fillRect(0,0,l+30,d+30),o.lineWidth=Math.ceil(parseInt(i.lineWidth,10)),o.lineCap=o.lineJoin="round",o.strokeStyle=i["decor-color"],o.shadowOffsetX=0,o.shadowOffsetY=0;var p=Math.round(d/5),f=1.5*p,g=d-p,l=l-1.5*p,d=d-p;o.beginPath(),o.moveTo(f,g),o.lineTo(l,d),o.stroke(),o.strokeStyle=i.color,a||(o.shadowColor=o.strokeStyle,o.shadowOffsetX=.5*o.lineWidth,o.shadowOffsetY=-.6*o.lineWidth,o.shadowBlur=0),t||(t=[]),o=this.dataEngine=new r(t,this,c,u,h),i.data=t,e(n).data(s+".data",t).data(s+".settings",i);var m=this.$parent,v=this.events,b=s;return o.changed=function(){v.publish(b+".change"),m.trigger("change")},o.changed(),!0},o.prototype.initializeCanvas=function(t){var n=document.createElement("canvas"),i=e(n);if(t.width===t.height&&"ratio"===t.height&&(t.width="100%"),i.css("margin",0).css("padding",0).css("border","none").css("height","ratio"!==t.height&&t.height?t.height.toString(10):1).css("width","ratio"!==t.width&&t.width?t.width.toString(10):1),i.appendTo(this.$parent),"ratio"===t.height?i.css("height",Math.round(i.width()/t.sizeRatio)):"ratio"===t.width&&i.css("width",Math.round(i.height()*t.sizeRatio)),i.addClass(s),n.width=i.width(),n.height=i.height(),t=n,t.getContext)t=!1;else{var i=t.ownerDocument.parentWindow,r=i.FlashCanvas?t.ownerDocument.parentWindow.FlashCanvas:"undefined"==typeof FlashCanvas?void 0:FlashCanvas;if(!r)throw Error("Canvas element does not support 2d context. jSignature cannot proceed.");if(t=r.initElement(t),r=1,i&&i.screen&&i.screen.deviceXDPI&&i.screen.logicalXDPI&&(r=1*i.screen.deviceXDPI/i.screen.logicalXDPI),1!==r)try{e(t).children("object").get(0).resize(Math.ceil(t.width*r),Math.ceil(t.height*r)),t.getContext("2d").scale(r,r)}catch(o){}t=!0}return this.isCanvasEmulator=t,n.onselectstart=function(e){return e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),!1},n};var d,p=window,f=function(e,t){var n=new Image,i=this;n.onload=function(){i.getContext("2d").drawImage(n,0,0,n.width<i.width?n.width:i.width,n.height<i.height?n.height:i.height)},n.src="data:"+t+","+e},g=function(e){return this.find("canvas."+s).add(this.filter("canvas."+s)).data(s+".this").resetCanvas(e),this},m=function(e,t){if(void 0!==t||"string"!=typeof e||"data:"!==e.substr(0,5)||(t=e.slice(5).split(",")[0],e=e.slice(6+t.length),t!==e)){var n=this.find("canvas."+s).add(this.filter("canvas."+s));if(!x.hasOwnProperty(t))throw Error(s+" is unable to find import plugin with for format '"+String(t)+"'");return 0!==n.length&&x[t].call(n[0],e,t,function(e){return function(){return e.resetCanvas.apply(e,arguments)}}(n.data(s+".this"))),this}},v=new l,b=s,y=function(){v.publish(b+".parentresized")};e(p).bind("resize."+b,function(){d&&clearTimeout(d),d=setTimeout(y,500)}).bind("mouseup."+b,function(){v.publish(b+".windowmouseup")});var w={},_={"default":function(){return this.toDataURL()},"native":function(e){return e},image:function(){var e=this.toDataURL();if("string"==typeof e&&4<e.length&&"data:"===e.slice(0,5)&&-1!==e.indexOf(",")){var t=e.indexOf(",");return[e.slice(5,t),e.substr(t+1)]}return[]}},x={"native":function(e,t,n){n(e)},image:f,"image/png;base64":f,"image/jpeg;base64":f,"image/jpg;base64":f},C={"export":_,"import":x,instance:w},$={init:function(e){return this.each(function(){var t,n=!1;for(t=this.parentNode;t&&!n;)n=t.body,t=t.parentNode;!n||new o(this,e,w)})},getSettings:function(){return this.find("canvas."+s).add(this.filter("canvas."+s)).data(s+".this").settings},clear:g,reset:g,addPlugin:function(e,t,n){return C.hasOwnProperty(e)&&(C[e][t]=n),this},listPlugins:function(e){var t=[];if(C.hasOwnProperty(e)){var n,e=C[e];for(n in e)e.hasOwnProperty(n)&&t.push(n)}return t},getData:function(e){var t=this.find("canvas."+s).add(this.filter("canvas."+s));return void 0===e&&(e="default"),0!==t.length&&_.hasOwnProperty(e)?_[e].call(t.get(0),t.data(s+".data")):void 0},importData:m,setData:m,globalEvents:function(){return v},events:function(){return this.find("canvas."+s).add(this.filter("canvas."+s)).data(s+".this").events}};e.fn[s]=function(t){return t&&"object"!=typeof t?"string"==typeof t&&$[t]?$[t].apply(this,Array.prototype.slice.call(arguments,1)):void e.error("Method "+String(t)+" does not exist on jQuery."+s):$.init.apply(this,arguments)}}(),function(){e.fn.jSignature("addPlugin","instance","UndoButton",function(t){this.events.subscribe("jSignature.attachingEventHandlers",function(){if(this.settings[t]){var n=this.settings[t];"function"!=typeof n&&(n=function(){var t=e('<input type="button" value="Undo last stroke" style="position:absolute;display:none;margin:0 !important;top:auto" />').appendTo(this.$controlbarLower),n=t.width();return t.css("left",Math.round((this.canvas.width-n)/2)),n!==t.width()&&t.width(n),t});var i=n.call(this),r=this;r.events.subscribe("jSignature.change",function(){r.dataEngine.data.length?i.show():i.hide()});var o=this,s=(this.events.topics.hasOwnProperty("jSignature.undo")?t:"jSignature")+".undo";i.bind("click",function(){o.events.publish(s)}),o.events.subscribe(s,function(){var e=o.dataEngine.data;e.length&&(e.pop(),o.resetCanvas(e))})}})})}(),function(){for(var e={},t={},n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX".split(""),i=n.length/2,r=i-1;r>-1;r--)e[n[r]]=n[r+i],t[n[r+i]]=n[r];var o=function(t){for(var t=t.split(""),n=t.length,i=1;n>i;i++)t[i]=e[t[i]];return t.join("")},s=function(e){for(var t,n,r=[],s=0,a=1,l=e.length,c=0;l>c;c++)t=Math.round(e[c]),n=t-s,s=t,0>n&&a>0?(a=-1,r.push("Z")):n>0&&0>a&&(a=1,r.push("Y")),t=Math.abs(n),r.push(t>=i?o(t.toString(i)):t.toString(i));return r.join("")},a=function(n){for(var r,o=[],n=n.split(""),s=n.length,a=1,l=[],c=0,u=0;s>u;u++)r=n[u],r in e||"Z"===r||"Y"===r?(0!==l.length&&(l=parseInt(l.join(""),i)*a+c,o.push(l),c=l),"Z"===r?(a=-1,l=[]):"Y"===r?(a=1,l=[]):l=[r]):l.push(t[r]);return o.push(parseInt(l.join(""),i)*a+c),o},l=function(e){for(var t,n=[],i=e.length,r=0;i>r;r++)t=e[r],n.push(s(t.x)),n.push(s(t.y));return n.join("_")},c=function(e){for(var t=[],e=e.split("_"),n=e.length/2,i=0;n>i;i++)t.push({x:a(e[2*i]),y:a(e[2*i+1])});return t},n=function(e){return["image/jsignature;base30",l(e)]},r=function(e,t,n){"string"==typeof e&&("image/jsignature;base30"===e.substring(0,23).toLowerCase()&&(e=e.substring(24)),n(c(e)))};if(null==this.jQuery)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");var u=this.jQuery.fn.jSignature;u("addPlugin","export","base30",n),u("addPlugin","export","image/jsignature;base30",n),u("addPlugin","import","base30",r),u("addPlugin","import","image/jsignature;base30",r),this.jSignatureDebug&&(this.jSignatureDebug.base30={remapTailChars:o,compressstrokeleg:s,uncompressstrokeleg:a,compressstrokes:l,uncompressstrokes:c,charmap:e})}.call("undefined"!=typeof window?window:this),function(){function t(e,t){this.x=e,this.y=t,this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)},this._length=null,this.getLength=function(){return this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))),this._length};var n=function(e){return Math.round(e/Math.abs(e))};this.resizeTo=function(e){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=e,this.y=e*n(this.y);else if(0===this.y)this._length=e,this.x=e*n(this.x);else{var t=Math.abs(this.y/this.x),i=Math.sqrt(Math.pow(e,2)/(1+Math.pow(t,2))),t=t*i;this._length=e,this.x=i*n(this.x),this.y=t*n(this.y)}return this},this.angleTo=function(e){var t=this.getLength()*e.getLength();return 0===t?0:Math.acos(Math.min(Math.max((this.x*e.x+this.y*e.y)/t,-1),1))/Math.PI}}function n(e,n){this.x=e,this.y=n,this.getVectorToCoordinates=function(e,n){return new t(e-this.x,n-this.y)},this.getVectorFromCoordinates=function(e,t){return this.getVectorToCoordinates(e,t).reverse()},this.getVectorToPoint=function(e){return new t(e.x-this.x,e.y-this.y)},this.getVectorFromPoint=function(e){return this.getVectorToPoint(e).reverse()}}function i(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}function r(e,r,o){var r=r+1,s=new n(e.x[r-1],e.y[r-1]),a=new n(e.x[r],e.y[r]),a=s.getVectorToPoint(a),l=new n(e.x[r-2],e.y[r-2]),s=l.getVectorToPoint(s);return s.getLength()>o?(o=r>2?new n(e.x[r-3],e.y[r-3]).getVectorToPoint(l):new t(0,0),e=.35*s.getLength(),l=s.angleTo(o.reverse()),r=a.angleTo(s.reverse()),o=new t(o.x+s.x,o.y+s.y).resizeTo(Math.max(.05,l)*e),a=new t(s.x+a.x,s.y+a.y).reverse().resizeTo(Math.max(.05,r)*e),a=new t(s.x+a.x,s.y+a.y),["c",i(o.x,2),i(o.y,2),i(a.x,2),i(a.y,2),i(s.x,2),i(s.y,2)]):["l",i(s.x,2),i(s.y,2)]}function o(e,r){var o=e.x.length-1,s=new n(e.x[o],e.y[o]),a=new n(e.x[o-1],e.y[o-1]),s=a.getVectorToPoint(s);if(o>1&&s.getLength()>r){var o=new n(e.x[o-2],e.y[o-2]).getVectorToPoint(a),a=s.angleTo(o.reverse()),l=.35*s.getLength(),o=new t(o.x+s.x,o.y+s.y).resizeTo(Math.max(.05,a)*l);return["c",i(o.x,2),i(o.y,2),i(s.x,2),i(s.y,2),i(s.x,2),i(s.y,2)]}return["l",i(s.x,2),i(s.y,2)]}function s(e,t,n){for(var t=["M",i(e.x[0]-t,2),i(e.y[0]-n,2)],n=1,s=e.x.length-1;s>n;n++)t.push.apply(t,r(e,n,1));return s>0?t.push.apply(t,o(e,n,1)):0===s&&t.push.apply(t,["l",1,1]),t.join(" ")}function a(e){var t,n,i=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'],r=e.length,o=[],a=[],l=n=t=0,c=0,u=[];if(0!==r){for(t=0;r>t;t++){l=e[t],c=[],n={x:[],y:[]};for(var h=void 0,d=void 0,h=0,d=l.x.length;d>h;h++)c.push({x:l.x[h],y:l.y[h]});for(c=simplify(c,.7,!0),h=0,d=c.length;d>h;h++)n.x.push(c[h].x),n.y.push(c[h].y);u.push(n),o=o.concat(n.x),a=a.concat(n.y)}e=Math.min.apply(null,o)-1,r=Math.max.apply(null,o)+1,o=Math.min.apply(null,a)-1,a=Math.max.apply(null,a)+1,l=0>e?0:e,c=0>o?0:o,t=r-e,n=a-o}for(i.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+t.toString()+'" height="'+n.toString()+'">'),t=0,r=u.length;r>t;t++)n=u[t],i.push('<path fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="'+s(n,l,c)+'"/>');return i.push("</svg>"),i.join("")}function l(e){return[d,a(e)]}function c(e){return[p,h(a(e))]}var u=window;if(("undefined"!=typeof exports?exports:u).simplify=function(e,t,n){if(t=void 0!==t?t*t:1,!n){for(var i,r=e.length,o=e[0],s=[o],n=1;r>n;n++){i=e[n];var a=i.x-o.x,l=i.y-o.y;a*a+l*l>t&&(s.push(i),o=i)}o!==i&&s.push(i),e=s}i=e;var c,u,n=i.length,r=new("undefined"!=typeof Uint8Array?Uint8Array:Array)(n),o=0,s=n-1,h=[],d=[],p=[];for(r[o]=r[s]=1;s;){for(l=0,a=o+1;s>a;a++){c=i[a];var f=i[o],g=i[s],m=f.x,v=f.y,f=g.x-m,b=g.y-v,y=void 0;(0!==f||0!==b)&&(y=((c.x-m)*f+(c.y-v)*b)/(f*f+b*b),y>1?(m=g.x,v=g.y):y>0&&(m+=f*y,v+=b*y)),f=c.x-m,b=c.y-v,c=f*f+b*b,c>l&&(u=a,l=c)}l>t&&(r[u]=1,h.push(o),d.push(u),h.push(u),d.push(s)),o=h.pop(),s=d.pop()}for(a=0;n>a;a++)r[a]&&p.push(i[a]);return e=p},"function"!=typeof h)var h=function(e){var t,n,i,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),s=0,a=0,l="",l=[];do t=e.charCodeAt(s++),n=e.charCodeAt(s++),i=e.charCodeAt(s++),r=t<<16|n<<8|i,t=r>>18&63,n=r>>12&63,i=r>>6&63,r&=63,l[a++]=o[t]+o[n]+o[i]+o[r];while(s<e.length);return l=l.join(""),e=e.length%3,(e?l.slice(0,e-3):l)+"===".slice(e||3)};var d="image/svg+xml",p="image/svg+xml;base64";if("undefined"==typeof e)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");u=e.fn.jSignature,u("addPlugin","export","svg",l),u("addPlugin","export",d,l),u("addPlugin","export","svgbase64",c),u("addPlugin","export",p,c)}()}(jQuery),angular.module("xeditable",[]).value("editableOptions",{theme:"default",buttons:"right",blurElem:"cancel",blurForm:"ignore",activate:"focus"}),angular.module("xeditable").directive("editableBsdate",["editableDirectiveFactory",function(e){return e({directiveName:"editableBsdate",inputTpl:'<input type="text">'})}]),angular.module("xeditable").directive("editableBstime",["editableDirectiveFactory",function(e){return e({directiveName:"editableBstime",inputTpl:"<timepicker></timepicker>",render:function(){this.parent.render.call(this);var e=angular.element('<div class="well well-small" style="display:inline-block;"></div>');e.attr("ng-model",this.inputEl.attr("ng-model")),this.inputEl.removeAttr("ng-model"),this.attrs.eNgChange&&(e.attr("ng-change",this.inputEl.attr("ng-change")),this.inputEl.removeAttr("ng-change")),this.inputEl.wrap(e)}})}]),angular.module("xeditable").directive("editableCheckbox",["editableDirectiveFactory",function(e){return e({directiveName:"editableCheckbox",inputTpl:'<input type="checkbox">',render:function(){this.parent.render.call(this),this.attrs.eTitle&&(this.inputEl.wrap("<label></label>"),this.inputEl.after(angular.element("<span></span>").text(this.attrs.eTitle)))},autosubmit:function(){var e=this;e.inputEl.bind("change",function(){setTimeout(function(){e.scope.$apply(function(){e.scope.$form.$submit()})},500)})}})}]),angular.module("xeditable").directive("editableChecklist",["editableDirectiveFactory","editableNgOptionsParser",function(e,t){return e({directiveName:"editableChecklist",inputTpl:"<span></span>",useCopy:!0,render:function(){this.parent.render.call(this);var e=t(this.attrs.eNgOptions),n='<label ng-repeat="'+e.ngRepeat+'"><input type="checkbox" checklist-model="$parent.$data" checklist-value="'+e.locals.valueFn+'"><span ng-bind="'+e.locals.displayFn+'"></span></label>';this.inputEl.removeAttr("ng-model"),this.inputEl.removeAttr("ng-options"),this.inputEl.html(n)}})}]),function(){var e="text|email|tel|number|url|search|color|date|datetime|time|month|week".split("|");angular.forEach(e,function(e){var t="editable"+e.charAt(0).toUpperCase()+e.slice(1);angular.module("xeditable").directive(t,["editableDirectiveFactory",function(n){return n({directiveName:t,inputTpl:'<input type="'+e+'">'})}])}),angular.module("xeditable").directive("editableRange",["editableDirectiveFactory",function(e){return e({directiveName:"editableRange",inputTpl:'<input type="range" id="range" name="range">',render:function(){this.parent.render.call(this),this.inputEl.after("<output>{{$data}}</output>")}})}])}(),angular.module("xeditable").directive("editableRadiolist",["editableDirectiveFactory","editableNgOptionsParser",function(e,t){return e({directiveName:"editableRadiolist",inputTpl:"<span></span>",render:function(){this.parent.render.call(this);var e=t(this.attrs.eNgOptions),n='<label ng-repeat="'+e.ngRepeat+'"><input type="radio" ng-model="$parent.$data" value="{{'+e.locals.valueFn+'}}"><span ng-bind="'+e.locals.displayFn+'"></span></label>';this.inputEl.removeAttr("ng-model"),this.inputEl.removeAttr("ng-options"),this.inputEl.html(n)},autosubmit:function(){var e=this;e.inputEl.bind("change",function(){setTimeout(function(){e.scope.$apply(function(){e.scope.$form.$submit()})},500)})}})}]),angular.module("xeditable").directive("editableSelect",["editableDirectiveFactory",function(e){return e({directiveName:"editableSelect",inputTpl:"<select></select>",autosubmit:function(){var e=this;e.inputEl.bind("change",function(){e.scope.$apply(function(){e.scope.$form.$submit()})})}})}]),angular.module("xeditable").directive("editableTextarea",["editableDirectiveFactory",function(e){return e({directiveName:"editableTextarea",inputTpl:"<textarea></textarea>",addListeners:function(){var e=this;e.parent.addListeners.call(e),e.single&&"no"!==e.buttons&&e.autosubmit()},autosubmit:function(){var e=this;e.inputEl.bind("keydown",function(t){(t.ctrlKey||t.metaKey)&&13===t.keyCode&&e.scope.$apply(function(){e.scope.$form.$submit()})})}})}]),angular.module("xeditable").factory("editableController",["$q","editableUtils",function(e,t){function n(e,n,i,r,o,s,a,l,c){var u,h,d=this;d.scope=e,d.elem=i,d.attrs=n,d.inputEl=null,d.editorEl=null,d.single=!0,d.error="",d.theme=o[s.theme]||o["default"],
d.parent={},d.inputTpl="",d.directiveName="",d.useCopy=!1,d.single=null,d.buttons="right",d.init=function(t){if(d.single=t,d.name=n.eName||n[d.directiveName],!n[d.directiveName])throw"You should provide value for `"+d.directiveName+"` in editable element!";u=r(n[d.directiveName]),d.buttons=d.single?d.attrs.buttons||s.buttons:"no",n.eName&&d.scope.$watch("$data",function(e){d.scope.$form.$data[n.eName]=e}),n.onshow&&(d.onshow=function(){return d.catchError(r(n.onshow)(e))}),n.onhide&&(d.onhide=function(){return r(n.onhide)(e)}),n.oncancel&&(d.oncancel=function(){return r(n.oncancel)(e)}),n.onbeforesave&&(d.onbeforesave=function(){return d.catchError(r(n.onbeforesave)(e))}),n.onaftersave&&(d.onaftersave=function(){return d.catchError(r(n.onaftersave)(e))}),e.$parent.$watch(n[d.directiveName],function(e,t){d.handleEmpty()})},d.render=function(){var e=d.theme;d.inputEl=angular.element(d.inputTpl),d.controlsEl=angular.element(e.controlsTpl),d.controlsEl.append(d.inputEl),"no"!==d.buttons&&(d.buttonsEl=angular.element(e.buttonsTpl),d.submitEl=angular.element(e.submitTpl),d.cancelEl=angular.element(e.cancelTpl),d.buttonsEl.append(d.submitEl).append(d.cancelEl),d.controlsEl.append(d.buttonsEl),d.inputEl.addClass("editable-has-buttons")),d.errorEl=angular.element(e.errorTpl),d.controlsEl.append(d.errorEl),d.editorEl=angular.element(d.single?e.formTpl:e.noformTpl),d.editorEl.append(d.controlsEl);for(var i in n.$attr)if(!(i.length<=1)){var r=!1,o=i.substring(1,2);if("e"===i.substring(0,1)&&o===o.toUpperCase()&&(r=i.substring(1),"Form"!==r&&"NgSubmit"!==r)){r=r.substring(0,1).toLowerCase()+t.camelToDash(r.substring(1));var a=""===n[i]?r:n[i];d.inputEl.attr(r,a)}}d.inputEl.addClass("editable-input"),d.inputEl.attr("ng-model","$data"),d.editorEl.addClass(t.camelToDash(d.directiveName)),d.single&&(d.editorEl.attr("editable-form","$form"),d.editorEl.attr("blur",d.attrs.blur||("no"===d.buttons?"cancel":s.blurElem))),angular.isFunction(e.postrender)&&e.postrender.call(d)},d.setLocalValue=function(){d.scope.$data=d.useCopy?angular.copy(u(e.$parent)):u(e.$parent)},d.show=function(){return d.setLocalValue(),d.render(),i.after(d.editorEl),l(d.editorEl)(e),d.addListeners(),i.addClass("editable-hide"),d.onshow()},d.hide=function(){return d.editorEl.remove(),i.removeClass("editable-hide"),d.onhide()},d.cancel=function(){d.oncancel()},d.addListeners=function(){d.inputEl.bind("keyup",function(e){if(d.single)switch(e.keyCode){case 27:d.scope.$apply(function(){d.scope.$form.$cancel()})}}),d.single&&"no"===d.buttons&&d.autosubmit(),d.editorEl.bind("click",function(e){1===e.which&&d.scope.$form.$visible&&(d.scope.$form._clicked=!0)})},d.setWaiting=function(e){e?(h=!d.inputEl.attr("disabled")&&!d.inputEl.attr("ng-disabled")&&!d.inputEl.attr("ng-enabled"),h&&(d.inputEl.attr("disabled","disabled"),d.buttonsEl&&d.buttonsEl.find("button").attr("disabled","disabled"))):h&&(d.inputEl.removeAttr("disabled"),d.buttonsEl&&d.buttonsEl.find("button").removeAttr("disabled"))},d.activate=function(){setTimeout(function(){var e=d.inputEl[0];"focus"===s.activate&&e.focus&&e.focus(),"select"===s.activate&&e.select&&e.select()},0)},d.setError=function(t){angular.isObject(t)||(e.$error=t,d.error=t)},d.catchError=function(e,t){return angular.isObject(e)&&t!==!0?c.when(e).then(angular.bind(this,function(e){this.catchError(e,!0)}),angular.bind(this,function(e){this.catchError(e,!0)})):t&&angular.isObject(e)&&e.status&&200!==e.status&&e.data&&angular.isString(e.data)?(this.setError(e.data),e=e.data):angular.isString(e)&&this.setError(e),e},d.save=function(){u.assign(e.$parent,angular.copy(d.scope.$data))},d.handleEmpty=function(){var t=u(e.$parent),n=null===t||void 0===t||""===t||angular.isArray(t)&&0===t.length;i.toggleClass("editable-empty",n)},d.autosubmit=angular.noop,d.onshow=angular.noop,d.onhide=angular.noop,d.oncancel=angular.noop,d.onbeforesave=angular.noop,d.onaftersave=angular.noop}return n.$inject=["$scope","$attrs","$element","$parse","editableThemes","editableOptions","$rootScope","$compile","$q"],n}]),angular.module("xeditable").factory("editableDirectiveFactory",["$parse","$compile","editableThemes","$rootScope","$document","editableController","editableFormController",function(e,t,n,i,r,o,s){return function(t){return{restrict:"A",scope:!0,require:[t.directiveName,"?^form"],controller:o,link:function(n,o,a,l){var c,u=l[0],h=!1;if(l[1])c=l[1],h=!0;else if(a.eForm){var d=e(a.eForm)(n);if(d)c=d,h=!0;else for(var p=0;p<r[0].forms.length;p++)if(r[0].forms[p].name===a.eForm){c=null,h=!0;break}}if(angular.forEach(t,function(e,t){void 0!==u[t]&&(u.parent[t]=u[t])}),angular.extend(u,t),u.init(!h),n.$editable=u,o.addClass("editable"),h)if(c){if(n.$form=c,!n.$form.$addEditable)throw"Form with editable elements should have `editable-form` attribute.";n.$form.$addEditable(u)}else i.$$editableBuffer=i.$$editableBuffer||{},i.$$editableBuffer[a.eForm]=i.$$editableBuffer[a.eForm]||[],i.$$editableBuffer[a.eForm].push(u),n.$form=null;else n.$form=s(),n.$form.$addEditable(u),a.eForm&&(n.$parent[a.eForm]=n.$form),a.eForm||(o.addClass("editable-click"),o.bind("click",function(e){e.preventDefault(),e.editable=u,n.$apply(function(){n.$form.$show()})}))}}}}]),angular.module("xeditable").factory("editableFormController",["$parse","$document","$rootScope","editablePromiseCollection","editableUtils",function(e,t,n,i,r){var o=[];t.bind("click",function(e){if(1===e.which){for(var t=[],i=[],r=0;r<o.length;r++)o[r]._clicked?o[r]._clicked=!1:o[r].$waiting||("cancel"===o[r]._blur&&t.push(o[r]),"submit"===o[r]._blur&&i.push(o[r]));(t.length||i.length)&&n.$apply(function(){angular.forEach(t,function(e){e.$cancel()}),angular.forEach(i,function(e){e.$submit()})})}});var s={$addEditable:function(e){this.$editables.push(e),e.elem.bind("$destroy",angular.bind(this,this.$removeEditable,e)),e.scope.$form||(e.scope.$form=this),this.$visible&&e.catchError(e.show())},$removeEditable:function(e){for(var t=0;t<this.$editables.length;t++)if(this.$editables[t]===e)return void this.$editables.splice(t,1)},$show:function(){if(!this.$visible){this.$visible=!0;var e=i();e.when(this.$onshow()),this.$setError(null,""),angular.forEach(this.$editables,function(t){e.when(t.show())}),e.then({onWait:angular.bind(this,this.$setWaiting),onTrue:angular.bind(this,this.$activate),onFalse:angular.bind(this,this.$activate),onString:angular.bind(this,this.$activate)}),setTimeout(angular.bind(this,function(){this._clicked=!1,-1===r.indexOf(o,this)&&o.push(this)}),0)}},$activate:function(e){var t;if(this.$editables.length){if(angular.isString(e))for(t=0;t<this.$editables.length;t++)if(this.$editables[t].name===e)return void this.$editables[t].activate();for(t=0;t<this.$editables.length;t++)if(this.$editables[t].error)return void this.$editables[t].activate();this.$editables[0].activate()}},$hide:function(){this.$visible&&(this.$visible=!1,this.$onhide(),angular.forEach(this.$editables,function(e){e.hide()}),r.arrayRemove(o,this))},$cancel:function(){this.$visible&&(this.$oncancel(),angular.forEach(this.$editables,function(e){e.cancel()}),this.$hide())},$setWaiting:function(e){this.$waiting=!!e,angular.forEach(this.$editables,function(t){t.setWaiting(!!e)})},$setError:function(e,t){angular.forEach(this.$editables,function(n){e&&n.name!==e||n.setError(t)})},$submit:function(){function e(e){var t=i();t.when(this.$onbeforesave()),t.then({onWait:angular.bind(this,this.$setWaiting),onTrue:e?angular.bind(this,this.$save):angular.bind(this,this.$hide),onFalse:angular.bind(this,this.$hide),onString:angular.bind(this,this.$activate)})}if(!this.$waiting){this.$setError(null,"");var t=i();angular.forEach(this.$editables,function(e){t.when(e.onbeforesave())}),t.then({onWait:angular.bind(this,this.$setWaiting),onTrue:angular.bind(this,e,!0),onFalse:angular.bind(this,e,!1),onString:angular.bind(this,this.$activate)})}},$save:function(){angular.forEach(this.$editables,function(e){e.save()});var e=i();e.when(this.$onaftersave()),angular.forEach(this.$editables,function(t){e.when(t.onaftersave())}),e.then({onWait:angular.bind(this,this.$setWaiting),onTrue:angular.bind(this,this.$hide),onFalse:angular.bind(this,this.$hide),onString:angular.bind(this,this.$activate)})},$onshow:angular.noop,$oncancel:angular.noop,$onhide:angular.noop,$onbeforesave:angular.noop,$onaftersave:angular.noop};return function(){return angular.extend({$editables:[],$visible:!1,$waiting:!1,$data:{},_clicked:!1,_blur:null},s)}}]),angular.module("xeditable").directive("editableForm",["$rootScope","$parse","editableFormController","editableOptions",function(e,t,n,i){return{restrict:"A",require:["form"],compile:function(){return{pre:function(t,i,r,o){var s,a=o[0];r.editableForm?t[r.editableForm]&&t[r.editableForm].$show?(s=t[r.editableForm],angular.extend(a,s)):(s=n(),t[r.editableForm]=s,angular.extend(s,a)):(s=n(),angular.extend(a,s));var l=e.$$editableBuffer,c=a.$name;c&&l&&l[c]&&(angular.forEach(l[c],function(e){s.$addEditable(e)}),delete l[c])},post:function(e,n,r,o){var s;s=r.editableForm&&e[r.editableForm]&&e[r.editableForm].$show?e[r.editableForm]:o[0],r.onshow&&(s.$onshow=angular.bind(s,t(r.onshow),e)),r.onhide&&(s.$onhide=angular.bind(s,t(r.onhide),e)),r.oncancel&&(s.$oncancel=angular.bind(s,t(r.oncancel),e)),r.shown&&t(r.shown)(e)&&s.$show(),s._blur=r.blur||i.blurForm,r.ngSubmit||r.submit||(r.onbeforesave&&(s.$onbeforesave=function(){return t(r.onbeforesave)(e,{$data:s.$data})}),r.onaftersave&&(s.$onaftersave=function(){return t(r.onaftersave)(e,{$data:s.$data})}),n.bind("submit",function(t){t.preventDefault(),e.$apply(function(){s.$submit()})})),n.bind("click",function(e){1===e.which&&s.$visible&&(s._clicked=!0)})}}}}}]),angular.module("xeditable").factory("editablePromiseCollection",["$q",function(e){function t(){return{promises:[],hasFalse:!1,hasString:!1,when:function(t,n){if(t===!1)this.hasFalse=!0;else if(!n&&angular.isObject(t))this.promises.push(e.when(t));else{if(!angular.isString(t))return;this.hasString=!0}},then:function(t){function n(){a.hasString||a.hasFalse?!a.hasString&&a.hasFalse?r():o():i()}t=t||{};var i=t.onTrue||angular.noop,r=t.onFalse||angular.noop,o=t.onString||angular.noop,s=t.onWait||angular.noop,a=this;this.promises.length?(s(!0),e.all(this.promises).then(function(e){s(!1),angular.forEach(e,function(e){a.when(e,!0)}),n()},function(e){s(!1),o()})):n()}}}return t}]),angular.module("xeditable").factory("editableUtils",[function(){return{indexOf:function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1},arrayRemove:function(e,t){var n=this.indexOf(e,t);return n>=0&&e.splice(n,1),t},camelToDash:function(e){var t=/[A-Z]/g;return e.replace(t,function(e,t){return(t?"-":"")+e.toLowerCase()})},dashToCamel:function(e){var t=/([\:\-\_]+(.))/g,n=/^moz([A-Z])/;return e.replace(t,function(e,t,n,i){return i?n.toUpperCase():n}).replace(n,"Moz$1")}}}]),angular.module("xeditable").factory("editableNgOptionsParser",[function(){function e(e){var n;if(!(n=e.match(t)))throw"ng-options parse error";var i,r=n[2]||n[1],o=n[4]||n[6],s=n[5],a=(n[3]||"",n[2]?n[1]:o),l=n[7],c=n[8],u=c?n[8]:null;return void 0===s?(i=o+" in "+l,void 0!==c&&(i+=" track by "+u)):i="("+s+", "+o+") in "+l,{ngRepeat:i,locals:{valueName:o,keyName:s,valueFn:a,displayFn:r}}}var t=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(.*?)(?:\s+track\s+by\s+(.*?))?$/;return e}]),angular.module("xeditable").factory("editableThemes",function(){var e={"default":{formTpl:'<form class="editable-wrap"></form>',noformTpl:'<span class="editable-wrap"></span>',controlsTpl:'<span class="editable-controls"></span>',inputTpl:"",errorTpl:'<div class="editable-error" ng-show="$error" ng-bind="$error"></div>',buttonsTpl:'<span class="editable-buttons"></span>',submitTpl:'<button type="submit">save</button>',cancelTpl:'<button type="button" ng-click="$form.$cancel()">cancel</button>'},bs2:{formTpl:'<form class="form-inline editable-wrap" role="form"></form>',noformTpl:'<span class="editable-wrap"></span>',controlsTpl:'<div class="editable-controls controls control-group" ng-class="{\'error\': $error}"></div>',inputTpl:"",errorTpl:'<div class="editable-error help-block" ng-show="$error" ng-bind="$error"></div>',buttonsTpl:'<span class="editable-buttons"></span>',submitTpl:'<button type="submit" class="btn btn-primary"><span class="icon-ok icon-white"></span></button>',cancelTpl:'<button type="button" class="btn" ng-click="$form.$cancel()"><span class="icon-remove"></span></button>'},bs3:{formTpl:'<form class="form-inline editable-wrap" role="form"></form>',noformTpl:'<span class="editable-wrap"></span>',controlsTpl:'<div class="editable-controls form-group" ng-class="{\'has-error\': $error}"></div>',inputTpl:"",errorTpl:'<div class="editable-error help-block" ng-show="$error" ng-bind="$error"></div>',buttonsTpl:'<span class="editable-buttons"></span>',submitTpl:'<button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-ok"></span></button>',cancelTpl:'<button type="button" class="btn btn-default" ng-click="$form.$cancel()"><span class="glyphicon glyphicon-remove"></span></button>',buttonsClass:"",inputClass:"",postrender:function(){switch(this.directiveName){case"editableText":case"editableSelect":case"editableTextarea":case"editableEmail":case"editableTel":case"editableNumber":case"editableUrl":case"editableSearch":case"editableDate":case"editableDatetime":case"editableTime":case"editableMonth":case"editableWeek":if(this.inputEl.addClass("form-control"),this.theme.inputClass){if(this.inputEl.attr("multiple")&&("input-sm"===this.theme.inputClass||"input-lg"===this.theme.inputClass))break;this.inputEl.addClass(this.theme.inputClass)}}this.buttonsEl&&this.theme.buttonsClass&&this.buttonsEl.find("button").addClass(this.theme.buttonsClass)}}};return e}),!function(e){jQuery.fn.extend({slimScroll:function(n){var i={width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px",animate:!0},r=e.extend(i,n);return this.each(function(){function i(t){if(u){var t=t||window.event,n=0;t.wheelDelta&&(n=-t.wheelDelta/120),t.detail&&(n=t.detail/3);var i=t.target||t.srcTarget||t.srcElement;e(i).closest("."+r.wrapperClass).is(_.parent())&&o(n,!0),t.preventDefault&&!w&&t.preventDefault(),w||(t.returnValue=!1)}}function o(e,t,n){w=!1;var i=e,o=_.outerHeight()-S.outerHeight();if(t&&(i=parseInt(S.css("top"))+e*parseInt(r.wheelStep)/100*S.outerHeight(),i=Math.min(Math.max(i,0),o),i=e>0?Math.ceil(i):Math.floor(i),S.css({top:i+"px"})),m=parseInt(S.css("top"))/(_.outerHeight()-S.outerHeight()),i=m*(_[0].scrollHeight-_.outerHeight()),n){i=e;var s=i/_[0].scrollHeight*_.outerHeight();s=Math.min(Math.max(s,0),o),S.css({top:s+"px"})}"scrollTo"in r&&r.animate?_.animate({scrollTop:i}):_.scrollTop(i),_.trigger("slimscrolling",~~i),l(),c()}function s(){window.addEventListener?(this.addEventListener("DOMMouseScroll",i,!1),this.addEventListener("mousewheel",i,!1)):document.attachEvent("onmousewheel",i)}function a(){g=Math.max(_.outerHeight()/_[0].scrollHeight*_.outerHeight(),y),S.css({height:g+"px"});var e=g==_.outerHeight()?"none":"block";S.css({display:e})}function l(){if(a(),clearTimeout(p),m==~~m){if(w=r.allowPageScroll,v!=m){var e=0==~~m?"top":"bottom";_.trigger("slimscroll",e)}}else w=!1;return v=m,g>=_.outerHeight()?void(w=!0):(S.stop(!0,!0).fadeIn("fast"),void(r.railVisible&&k.stop(!0,!0).fadeIn("fast")))}function c(){r.alwaysVisible||(p=setTimeout(function(){r.disableFadeOut&&u||h||d||(S.fadeOut("slow"),k.fadeOut("slow"))},1e3))}var u,h,d,p,f,g,m,v,b="<div></div>",y=30,w=!1,_=e(this);if("ontouchstart"in window&&window.navigator.msPointerEnabled&&_.css("-ms-touch-action","none"),_.parent().hasClass(r.wrapperClass)){var x=_.scrollTop();if(S=_.parent().find("."+r.barClass),k=_.parent().find("."+r.railClass),a(),e.isPlainObject(n)){if("height"in n&&"auto"==n.height){_.parent().css("height","auto"),_.css("height","auto");var C=_.parent().parent().height();_.parent().css("height",C),_.css("height",C)}if("scrollTo"in n)x=parseInt(r.scrollTo);else if("scrollBy"in n)x+=parseInt(r.scrollBy);else if("destroy"in n)return S.remove(),k.remove(),void _.unwrap();o(x,!1,!0)}}else{r.height="auto"==n.height?_.parent().height():n.height;var $=e(b).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});_.css({overflow:"hidden",width:r.width,height:r.height});var k=e(b).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),S=e(b).addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),T="right"==r.position?{right:r.distance}:{left:r.distance};k.css(T),S.css(T),_.wrap($),_.parent().append(S),_.parent().append(k),r.railDraggable&&S.bind("mousedown",function(n){var i=e(document);return d=!0,t=parseFloat(S.css("top")),pageY=n.pageY,i.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,S.css("top",currTop),o(0,S.position().top,!1)}),i.bind("mouseup.slimscroll",function(){d=!1,c(),i.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),"ontouchstart"in window&&window.navigator.msPointerEnabled&&(_.bind("MSPointerDown",function(e){f=e.originalEvent.pageY}),_.bind("MSPointerMove",function(e){e.originalEvent.preventDefault();var t=(f-e.originalEvent.pageY)/r.touchScrollStep;o(t,!0),f=e.originalEvent.pageY})),k.hover(function(){l()},function(){c()}),S.hover(function(){h=!0},function(){h=!1}),_.hover(function(){u=!0,l(),c()},function(){u=!1,c()}),_.bind("touchstart",function(e){e.originalEvent.touches.length&&(f=e.originalEvent.touches[0].pageY)}),_.bind("touchmove",function(e){if(w||e.originalEvent.preventDefault(),e.originalEvent.touches.length){var t=(f-e.originalEvent.touches[0].pageY)/r.touchScrollStep;o(t,!0),f=e.originalEvent.touches[0].pageY}}),a(),"bottom"===r.start?(S.css({top:_.outerHeight()-S.outerHeight()}),o(0,!0)):"top"!==r.start&&(o(e(r.start).position().top,null,!0),r.alwaysVisible||S.hide()),s()}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery),!function(){"use strict";function e(e){function t(t,i){var o,g,m=t==window,v=i&&void 0!==i.message?i.message:void 0;if(i=e.extend({},e.blockUI.defaults,i||{}),!i.ignoreIfBlocked||!e(t).data("blockUI.isBlocked")){if(i.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,i.overlayCSS||{}),o=e.extend({},e.blockUI.defaults.css,i.css||{}),i.onOverlayClick&&(i.overlayCSS.cursor="pointer"),g=e.extend({},e.blockUI.defaults.themedCSS,i.themedCSS||{}),v=void 0===v?i.message:v,m&&p&&n(window,{fadeOut:0}),v&&"string"!=typeof v&&(v.parentNode||v.jquery)){var b=v.jquery?v[0]:v,y={};e(t).data("blockUI.history",y),y.el=b,y.parent=b.parentNode,y.display=b.style.display,y.position=b.style.position,y.parent&&y.parent.removeChild(b)}e(t).data("blockUI.onUnblock",i.onUnblock);var w,_,x,C,$=i.baseZ;w=e(u||i.forceIframe?'<iframe class="blockUI" style="z-index:'+$++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+i.iframeSrc+'"></iframe>':'<div class="blockUI" style="display:none"></div>'),_=e(i.theme?'<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+$++ +';display:none"></div>':'<div class="blockUI blockOverlay" style="z-index:'+$++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),i.theme&&m?(C='<div class="blockUI '+i.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+($+10)+';display:none;position:fixed">',i.title&&(C+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(i.title||"&nbsp;")+"</div>"),C+='<div class="ui-widget-content ui-dialog-content"></div>',C+="</div>"):i.theme?(C='<div class="blockUI '+i.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+($+10)+';display:none;position:absolute">',i.title&&(C+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(i.title||"&nbsp;")+"</div>"),C+='<div class="ui-widget-content ui-dialog-content"></div>',C+="</div>"):C=m?'<div class="blockUI '+i.blockMsgClass+' blockPage" style="z-index:'+($+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+i.blockMsgClass+' blockElement" style="z-index:'+($+10)+';display:none;position:absolute"></div>',x=e(C),v&&(i.theme?(x.css(g),x.addClass("ui-widget-content")):x.css(o)),i.theme||_.css(i.overlayCSS),_.css("position",m?"fixed":"absolute"),(u||i.forceIframe)&&w.css("opacity",0);var k=[w,_,x],S=e(m?"body":t);e.each(k,function(){this.appendTo(S)}),i.theme&&i.draggable&&e.fn.draggable&&x.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var T=d&&(!e.support.boxModel||e("object,embed",m?null:t).length>0);if(h||T){if(m&&i.allowBodyStretch&&e.support.boxModel&&e("html,body").css("height","100%"),(h||!e.support.boxModel)&&!m)var E=l(t,"borderTopWidth"),D=l(t,"borderLeftWidth"),A=E?"(0 - "+E+")":0,O=D?"(0 - "+D+")":0;e.each(k,function(e,t){var n=t[0].style;if(n.position="absolute",2>e)m?n.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+i.quirksmodeOffsetHack+') + "px"'):n.setExpression("height",'this.parentNode.offsetHeight + "px"'),m?n.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):n.setExpression("width",'this.parentNode.offsetWidth + "px"'),O&&n.setExpression("left",O),A&&n.setExpression("top",A);else if(i.centerY)m&&n.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),n.marginTop=0;else if(!i.centerY&&m){var r=i.css&&i.css.top?parseInt(i.css.top,10):0,o="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+r+') + "px"';n.setExpression("top",o)}})}if(v&&(i.theme?x.find(".ui-widget-content").append(v):x.append(v),(v.jquery||v.nodeType)&&e(v).show()),(u||i.forceIframe)&&i.showOverlay&&w.show(),i.fadeIn){var I=i.onBlock?i.onBlock:c,M=i.showOverlay&&!v?I:c,P=v?I:c;i.showOverlay&&_._fadeIn(i.fadeIn,M),v&&x._fadeIn(i.fadeIn,P)}else i.showOverlay&&_.show(),v&&x.show(),i.onBlock&&i.onBlock();if(r(1,t,i),m?(p=x[0],f=e(i.focusableElements,p),i.focusInput&&setTimeout(s,20)):a(x[0],i.centerX,i.centerY),i.timeout){var R=setTimeout(function(){m?e.unblockUI(i):e(t).unblock(i)},i.timeout);e(t).data("blockUI.timeout",R)}}}function n(t,n){var o,s=t==window,a=e(t),l=a.data("blockUI.history"),c=a.data("blockUI.timeout");c&&(clearTimeout(c),a.removeData("blockUI.timeout")),n=e.extend({},e.blockUI.defaults,n||{}),r(0,t,n),null===n.onUnblock&&(n.onUnblock=a.data("blockUI.onUnblock"),a.removeData("blockUI.onUnblock"));var u;u=s?e("body").children().filter(".blockUI").add("body > .blockUI"):a.find(">.blockUI"),n.cursorReset&&(u.length>1&&(u[1].style.cursor=n.cursorReset),u.length>2&&(u[2].style.cursor=n.cursorReset)),s&&(p=f=null),n.fadeOut?(o=u.length,u.stop().fadeOut(n.fadeOut,function(){0===--o&&i(u,l,n,t)})):i(u,l,n,t)}function i(t,n,i,r){var o=e(r);if(!o.data("blockUI.isBlocked")){t.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),n&&n.el&&(n.el.style.display=n.display,n.el.style.position=n.position,n.parent&&n.parent.appendChild(n.el),o.removeData("blockUI.history")),o.data("blockUI.static")&&o.css("position","static"),"function"==typeof i.onUnblock&&i.onUnblock(r,i);var s=e(document.body),a=s.width(),l=s[0].style.width;s.width(a-1).width(a),s[0].style.width=l}}function r(t,n,i){var r=n==window,s=e(n);if((t||(!r||p)&&(r||s.data("blockUI.isBlocked")))&&(s.data("blockUI.isBlocked",t),r&&i.bindEvents&&(!t||i.showOverlay))){var a="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";t?e(document).bind(a,i,o):e(document).unbind(a,o)}}function o(t){if("keydown"===t.type&&t.keyCode&&9==t.keyCode&&p&&t.data.constrainTabKey){var n=f,i=!t.shiftKey&&t.target===n[n.length-1],r=t.shiftKey&&t.target===n[0];if(i||r)return setTimeout(function(){s(r)},10),!1}var o=t.data,a=e(t.target);return a.hasClass("blockOverlay")&&o.onOverlayClick&&o.onOverlayClick(t),a.parents("div."+o.blockMsgClass).length>0?!0:0===a.parents().children().filter("div.blockUI").length}function s(e){if(f){var t=f[e===!0?f.length-1:0];t&&t.focus()}}function a(e,t,n){var i=e.parentNode,r=e.style,o=(i.offsetWidth-e.offsetWidth)/2-l(i,"borderLeftWidth"),s=(i.offsetHeight-e.offsetHeight)/2-l(i,"borderTopWidth");t&&(r.left=o>0?o+"px":"0"),n&&(r.top=s>0?s+"px":"0")}function l(t,n){return parseInt(e.css(t,n),10)||0}e.fn._fadeIn=e.fn.fadeIn;var c=e.noop||function(){},u=/MSIE/.test(navigator.userAgent),h=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),d=(document.documentMode||0,e.isFunction(document.createElement("div").style.setExpression));e.blockUI=function(e){t(window,e)},e.unblockUI=function(e){n(window,e)},e.growlUI=function(t,n,i,r){var o=e('<div class="growlUI"></div>');t&&o.append("<h1>"+t+"</h1>"),n&&o.append("<h2>"+n+"</h2>"),void 0===i&&(i=3e3);var s=function(t){t=t||{},e.blockUI({message:o,fadeIn:"undefined"!=typeof t.fadeIn?t.fadeIn:700,fadeOut:"undefined"!=typeof t.fadeOut?t.fadeOut:1e3,timeout:"undefined"!=typeof t.timeout?t.timeout:i,centerY:!1,showOverlay:!1,onUnblock:r,css:e.blockUI.defaults.growlCSS})};s(),o.css("opacity"),o.mouseover(function(){s({fadeIn:0,timeout:3e4});var t=e(".blockMsg");t.stop(),t.fadeTo(300,1)}).mouseout(function(){e(".blockMsg").fadeOut(1e3)})},e.fn.block=function(n){if(this[0]===window)return e.blockUI(n),this;var i=e.extend({},e.blockUI.defaults,n||{});return this.each(function(){var t=e(this);i.ignoreIfBlocked&&t.data("blockUI.isBlocked")||t.unblock({fadeOut:0})}),this.each(function(){"static"==e.css(this,"position")&&(this.style.position="relative",e(this).data("blockUI.static",!0)),this.style.zoom=1,t(this,n)})},e.fn.unblock=function(t){return this[0]===window?(e.unblockUI(t),this):this.each(function(){n(this,t)})},e.blockUI.version=2.66,e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var p=null,f=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)}(),function(e,t){"use strict";function n(e){var t=Array.prototype.slice.call(arguments,1);return e.prop?e.prop.apply(e,t):e.attr.apply(e,t)}function i(e,t,n){var i,r;for(i in n)n.hasOwnProperty(i)&&(r=i.replace(/ |$/g,t.eventNamespace),e.bind(r,n[i]))}function r(e,t,n){i(e,n,{focus:function(){t.addClass(n.focusClass)},blur:function(){t.removeClass(n.focusClass),t.removeClass(n.activeClass)},mouseenter:function(){t.addClass(n.hoverClass)},mouseleave:function(){t.removeClass(n.hoverClass),t.removeClass(n.activeClass)},"mousedown touchbegin":function(){e.is(":disabled")||t.addClass(n.activeClass)},"mouseup touchend":function(){t.removeClass(n.activeClass)}})}function o(e,t){e.removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass)}function s(e,t,n){n?e.addClass(t):e.removeClass(t)}function a(e,t,n){var i="checked",r=t.is(":"+i);t.prop?t.prop(i,r):r?t.attr(i,i):t.removeAttr(i),s(e,n.checkedClass,r)}function l(e,t,n){s(e,n.disabledClass,t.is(":disabled"))}function c(e,t,n){switch(n){case"after":return e.after(t),e.next();case"before":return e.before(t),e.prev();case"wrap":return e.wrap(t),e.parent()}return null}function u(t,i,r){var o,s,a;return r||(r={}),r=e.extend({bind:{},divClass:null,divWrap:"wrap",spanClass:null,spanHtml:null,spanWrap:"wrap"},r),o=e("<div />"),s=e("<span />"),i.autoHide&&t.is(":hidden")&&"none"===t.css("display")&&o.hide(),r.divClass&&o.addClass(r.divClass),i.wrapperClass&&o.addClass(i.wrapperClass),r.spanClass&&s.addClass(r.spanClass),a=n(t,"id"),i.useID&&a&&n(o,"id",i.idPrefix+"-"+a),r.spanHtml&&s.html(r.spanHtml),o=c(t,o,r.divWrap),s=c(t,s,r.spanWrap),l(o,t,i),{div:o,span:s}}function h(t,n){var i;return n.wrapperClass?(i=e("<span />").addClass(n.wrapperClass),i=c(t,i,"wrap")):null}function d(){var t,n,i,r;return r="rgb(120,2,153)",n=e('<div style="width:0;height:0;color:'+r+'">'),e("body").append(n),i=n.get(0),t=window.getComputedStyle?window.getComputedStyle(i,"").color:(i.currentStyle||i.style||{}).color,n.remove(),t.replace(/ /g,"")!==r}function p(t){return t?e("<span />").text(t).html():""}function f(){return navigator.cpuClass&&!navigator.product}function g(){return void 0!==window.XMLHttpRequest?!0:!1}function m(e){var t;return e[0].multiple?!0:(t=n(e,"size"),!t||1>=t?!1:!0)}function v(){return!1}function b(e,t){var n="none";i(e,t,{"selectstart dragstart mousedown":v}),e.css({MozUserSelect:n,msUserSelect:n,webkitUserSelect:n,userSelect:n})}function y(e,t,n){var i=e.val();""===i?i=n.fileDefaultHtml:(i=i.split(/[\/\\]+/),i=i[i.length-1]),t.text(i)}function w(e,t,n){var i,r;for(i=[],e.each(function(){var e;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i.push({el:this,name:e,old:this.style[e]}),this.style[e]=t[e])}),n();i.length;)r=i.pop(),r.el.style[r.name]=r.old}function _(e,t){var n;n=e.parents(),n.push(e[0]),n=n.not(":visible"),w(n,{visibility:"hidden",display:"block",position:"absolute"},t)}function x(e,t){return function(){e.unwrap().unwrap().unbind(t.eventNamespace)}}var C=!0,$=!1,k=[{match:function(e){return e.is("a, button, :submit, :reset, input[type='button']")},apply:function(e,t){var s,a,c,h,d;return a=t.submitDefaultHtml,e.is(":reset")&&(a=t.resetDefaultHtml),h=e.is("a, button")?function(){return e.html()||a}:function(){return p(n(e,"value"))||a},c=u(e,t,{divClass:t.buttonClass,spanHtml:h()}),s=c.div,r(e,s,t),d=!1,i(s,t,{"click touchend":function(){var t,i,r,o;d||e.is(":disabled")||(d=!0,e[0].dispatchEvent?(t=document.createEvent("MouseEvents"),t.initEvent("click",!0,!0),i=e[0].dispatchEvent(t),e.is("a")&&i&&(r=n(e,"target"),o=n(e,"href"),r&&"_self"!==r?window.open(o,r):document.location.href=o)):e.click(),d=!1)}}),b(s,t),{remove:function(){return s.after(e),s.remove(),e.unbind(t.eventNamespace),e},update:function(){o(s,t),l(s,e,t),e.detach(),c.span.html(h()).append(e)}}}},{match:function(e){return e.is(":checkbox")},apply:function(e,t){var n,s,c;return n=u(e,t,{divClass:t.checkboxClass}),s=n.div,c=n.span,r(e,s,t),i(e,t,{"click touchend":function(){a(c,e,t)}}),a(c,e,t),{remove:x(e,t),update:function(){o(s,t),c.removeClass(t.checkedClass),a(c,e,t),l(s,e,t)}}}},{match:function(e){return e.is(":file");
},apply:function(t,s){function a(){y(t,p,s)}var h,d,p,g;return h=u(t,s,{divClass:s.fileClass,spanClass:s.fileButtonClass,spanHtml:s.fileButtonHtml,spanWrap:"after"}),d=h.div,g=h.span,p=e("<span />").html(s.fileDefaultHtml),p.addClass(s.filenameClass),p=c(t,p,"after"),n(t,"size")||n(t,"size",d.width()/10),r(t,d,s),a(),f()?i(t,s,{click:function(){t.trigger("change"),setTimeout(a,0)}}):i(t,s,{change:a}),b(p,s),b(g,s),{remove:function(){return p.remove(),g.remove(),t.unwrap().unbind(s.eventNamespace)},update:function(){o(d,s),y(t,p,s),l(d,t,s)}}}},{match:function(e){if(e.is("input")){var t=(" "+n(e,"type")+" ").toLowerCase(),i=" color date datetime datetime-local email month number password search tel text time url week ";return i.indexOf(t)>=0}return!1},apply:function(e,t){var i,o;return i=n(e,"type"),e.addClass(t.inputClass),o=h(e,t),r(e,e,t),t.inputAddTypeAsClass&&e.addClass(i),{remove:function(){e.removeClass(t.inputClass),t.inputAddTypeAsClass&&e.removeClass(i),o&&e.unwrap()},update:v}}},{match:function(e){return e.is(":radio")},apply:function(t,s){var c,h,d;return c=u(t,s,{divClass:s.radioClass}),h=c.div,d=c.span,r(t,h,s),i(t,s,{"click touchend":function(){e.uniform.update(e(':radio[name="'+n(t,"name")+'"]'))}}),a(d,t,s),{remove:x(t,s),update:function(){o(h,s),a(d,t,s),l(h,t,s)}}}},{match:function(e){return e.is("select")&&!m(e)?!0:!1},apply:function(t,n){var s,a,c,h;return n.selectAutoWidth&&_(t,function(){h=t.width()}),s=u(t,n,{divClass:n.selectClass,spanHtml:(t.find(":selected:first")||t.find("option:first")).html(),spanWrap:"before"}),a=s.div,c=s.span,n.selectAutoWidth?_(t,function(){w(e([c[0],a[0]]),{display:"block"},function(){var e;e=c.outerWidth()-c.width(),a.width(h+e),c.width(h)})}):a.addClass("fixedWidth"),r(t,a,n),i(t,n,{change:function(){c.html(t.find(":selected").html()),a.removeClass(n.activeClass)},"click touchend":function(){var e=t.find(":selected").html();c.html()!==e&&t.trigger("change")},keyup:function(){c.html(t.find(":selected").html())}}),b(c,n),{remove:function(){return c.remove(),t.unwrap().unbind(n.eventNamespace),t},update:function(){n.selectAutoWidth?(e.uniform.restore(t),t.uniform(n)):(o(a,n),c.html(t.find(":selected").html()),l(a,t,n))}}}},{match:function(e){return e.is("select")&&m(e)?!0:!1},apply:function(e,t){var n;return e.addClass(t.selectMultiClass),n=h(e,t),r(e,e,t),{remove:function(){e.removeClass(t.selectMultiClass),n&&e.unwrap()},update:v}}},{match:function(e){return e.is("textarea")},apply:function(e,t){var n;return e.addClass(t.textareaClass),n=h(e,t),r(e,e,t),{remove:function(){e.removeClass(t.textareaClass),n&&e.unwrap()},update:v}}}];f()&&!g()&&(C=!1),e.uniform={defaults:{activeClass:"active",autoHide:!0,buttonClass:"button",checkboxClass:"checker",checkedClass:"checked",disabledClass:"disabled",eventNamespace:".uniform",fileButtonClass:"action",fileButtonHtml:"Choose File",fileClass:"uploader",fileDefaultHtml:"No file selected",filenameClass:"filename",focusClass:"focus",hoverClass:"hover",idPrefix:"uniform",inputAddTypeAsClass:!0,inputClass:"uniform-input",radioClass:"radio",resetDefaultHtml:"Reset",resetSelector:!1,selectAutoWidth:!0,selectClass:"selector",selectMultiClass:"uniform-multiselect",submitDefaultHtml:"Submit",textareaClass:"uniform",useID:!0,wrapperClass:null},elements:[]},e.fn.uniform=function(t){var n=this;return t=e.extend({},e.uniform.defaults,t),$||($=!0,d()&&(C=!1)),C?(t.resetSelector&&e(t.resetSelector).mouseup(function(){window.setTimeout(function(){e.uniform.update(n)},10)}),this.each(function(){var n,i,r,o=e(this);if(o.data("uniformed"))return void e.uniform.update(o);for(n=0;k.length>n;n+=1)if(i=k[n],i.match(o,t))return r=i.apply(o,t),o.data("uniformed",r),void e.uniform.elements.push(o.get(0))})):this},e.uniform.restore=e.fn.uniform.restore=function(n){n===t&&(n=e.uniform.elements),e(n).each(function(){var t,n,i=e(this);n=i.data("uniformed"),n&&(n.remove(),t=e.inArray(this,e.uniform.elements),t>=0&&e.uniform.elements.splice(t,1),i.removeData("uniformed"))})},e.uniform.update=e.fn.uniform.update=function(n){n===t&&(n=e.uniform.elements),e(n).each(function(){var t,n=e(this);t=n.data("uniformed"),t&&t.update(n,t.options)})}}(jQuery),function(){var e=[].slice;!function(t,n){"use strict";var i;return i=function(){function e(e,n){null==n&&(n={}),this.$element=t(e),this.options=t.extend({},t.fn.bootstrapSwitch.defaults,n,{state:this.$element.is(":checked"),size:this.$element.data("size"),animate:this.$element.data("animate"),disabled:this.$element.is(":disabled"),readonly:this.$element.is("[readonly]"),onColor:this.$element.data("on-color"),offColor:this.$element.data("off-color"),onText:this.$element.data("on-text"),offText:this.$element.data("off-text"),labelText:this.$element.data("label-text"),baseClass:this.$element.data("base-class"),wrapperClass:this.$element.data("wrapper-class")}),this.$wrapper=t("<div>",{"class":function(e){return function(){var t;return t=[""+e.options.baseClass].concat(e._getClasses(e.options.wrapperClass)),t.push(e.options.state?""+e.options.baseClass+"-on":""+e.options.baseClass+"-off"),null!=e.options.size&&t.push(""+e.options.baseClass+"-"+e.options.size),e.options.animate&&t.push(""+e.options.baseClass+"-animate"),e.options.disabled&&t.push(""+e.options.baseClass+"-disabled"),e.options.readonly&&t.push(""+e.options.baseClass+"-readonly"),e.$element.attr("id")&&t.push(""+e.options.baseClass+"-id-"+e.$element.attr("id")),t.join(" ")}}(this)()}),this.$container=t("<div>",{"class":""+this.options.baseClass+"-container"}),this.$on=t("<span>",{html:this.options.onText,"class":""+this.options.baseClass+"-handle-on "+this.options.baseClass+"-"+this.options.onColor}),this.$off=t("<span>",{html:this.options.offText,"class":""+this.options.baseClass+"-handle-off "+this.options.baseClass+"-"+this.options.offColor}),this.$label=t("<label>",{"for":this.$element.attr("id"),html:this.options.labelText,"class":""+this.options.baseClass+"-label"}),this.$element.on("init.bootstrapSwitch",function(t){return function(){return t.options.onInit.apply(e,arguments)}}(this)),this.$element.on("switchChange.bootstrapSwitch",function(t){return function(){return t.options.onSwitchChange.apply(e,arguments)}}(this)),this.$container=this.$element.wrap(this.$container).parent(),this.$wrapper=this.$container.wrap(this.$wrapper).parent(),this.$element.before(this.$on).before(this.$label).before(this.$off).trigger("init.bootstrapSwitch"),this._elementHandlers(),this._handleHandlers(),this._labelHandlers(),this._formHandler()}return e.prototype._constructor=e,e.prototype.state=function(e,t){return"undefined"==typeof e?this.options.state:this.options.disabled||this.options.readonly?this.$element:(e=!!e,this.$element.prop("checked",e).trigger("change.bootstrapSwitch",t),this.$element)},e.prototype.toggleState=function(e){return this.options.disabled||this.options.readonly?this.$element:this.$element.prop("checked",!this.options.state).trigger("change.bootstrapSwitch",e)},e.prototype.size=function(e){return"undefined"==typeof e?this.options.size:(null!=this.options.size&&this.$wrapper.removeClass(""+this.options.baseClass+"-"+this.options.size),e&&this.$wrapper.addClass(""+this.options.baseClass+"-"+e),this.options.size=e,this.$element)},e.prototype.animate=function(e){return"undefined"==typeof e?this.options.animate:(e=!!e,this.$wrapper[e?"addClass":"removeClass"](""+this.options.baseClass+"-animate"),this.options.animate=e,this.$element)},e.prototype.disabled=function(e){return"undefined"==typeof e?this.options.disabled:(e=!!e,this.$wrapper[e?"addClass":"removeClass"](""+this.options.baseClass+"-disabled"),this.$element.prop("disabled",e),this.options.disabled=e,this.$element)},e.prototype.toggleDisabled=function(){return this.$element.prop("disabled",!this.options.disabled),this.$wrapper.toggleClass(""+this.options.baseClass+"-disabled"),this.options.disabled=!this.options.disabled,this.$element},e.prototype.readonly=function(e){return"undefined"==typeof e?this.options.readonly:(e=!!e,this.$wrapper[e?"addClass":"removeClass"](""+this.options.baseClass+"-readonly"),this.$element.prop("readonly",e),this.options.readonly=e,this.$element)},e.prototype.toggleReadonly=function(){return this.$element.prop("readonly",!this.options.readonly),this.$wrapper.toggleClass(""+this.options.baseClass+"-readonly"),this.options.readonly=!this.options.readonly,this.$element},e.prototype.onColor=function(e){var t;return t=this.options.onColor,"undefined"==typeof e?t:(null!=t&&this.$on.removeClass(""+this.options.baseClass+"-"+t),this.$on.addClass(""+this.options.baseClass+"-"+e),this.options.onColor=e,this.$element)},e.prototype.offColor=function(e){var t;return t=this.options.offColor,"undefined"==typeof e?t:(null!=t&&this.$off.removeClass(""+this.options.baseClass+"-"+t),this.$off.addClass(""+this.options.baseClass+"-"+e),this.options.offColor=e,this.$element)},e.prototype.onText=function(e){return"undefined"==typeof e?this.options.onText:(this.$on.html(e),this.options.onText=e,this.$element)},e.prototype.offText=function(e){return"undefined"==typeof e?this.options.offText:(this.$off.html(e),this.options.offText=e,this.$element)},e.prototype.labelText=function(e){return"undefined"==typeof e?this.options.labelText:(this.$label.html(e),this.options.labelText=e,this.$element)},e.prototype.baseClass=function(){return this.options.baseClass},e.prototype.wrapperClass=function(e){return"undefined"==typeof e?this.options.wrapperClass:(e||(e=t.fn.bootstrapSwitch.defaults.wrapperClass),this.$wrapper.removeClass(this._getClasses(this.options.wrapperClass).join(" ")),this.$wrapper.addClass(this._getClasses(e).join(" ")),this.options.wrapperClass=e,this.$element)},e.prototype.destroy=function(){var e;return e=this.$element.closest("form"),e.length&&e.off("reset.bootstrapSwitch").removeData("bootstrap-switch"),this.$container.children().not(this.$element).remove(),this.$element.unwrap().unwrap().off(".bootstrapSwitch").removeData("bootstrap-switch"),this.$element},e.prototype._elementHandlers=function(){return this.$element.on({"change.bootstrapSwitch":function(e){return function(n,i){var r;return n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),r=e.$element.is(":checked"),r!==e.options.state?(e.options.state=r,e.$wrapper.removeClass(r?""+e.options.baseClass+"-off":""+e.options.baseClass+"-on").addClass(r?""+e.options.baseClass+"-on":""+e.options.baseClass+"-off"),i?void 0:(e.$element.is(":radio")&&t("[name='"+e.$element.attr("name")+"']").not(e.$element).prop("checked",!1).trigger("change.bootstrapSwitch",!0),e.$element.trigger("switchChange.bootstrapSwitch",[r]))):void 0}}(this),"focus.bootstrapSwitch":function(e){return function(t){return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.$wrapper.addClass(""+e.options.baseClass+"-focused")}}(this),"blur.bootstrapSwitch":function(e){return function(t){return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.$wrapper.removeClass(""+e.options.baseClass+"-focused")}}(this),"keydown.bootstrapSwitch":function(e){return function(t){if(t.which&&!e.options.disabled&&!e.options.readonly)switch(t.which){case 32:return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.toggleState();case 37:return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.state(!1);case 39:return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.state(!0)}}}(this)})},e.prototype._handleHandlers=function(){return this.$on.on("click.bootstrapSwitch",function(e){return function(){return e.state(!1),e.$element.trigger("focus.bootstrapSwitch")}}(this)),this.$off.on("click.bootstrapSwitch",function(e){return function(){return e.state(!0),e.$element.trigger("focus.bootstrapSwitch")}}(this))},e.prototype._labelHandlers=function(){return this.$label.on({"mousemove.bootstrapSwitch touchmove.bootstrapSwitch":function(e){return function(t){var n,i,r,o;return e.drag?(t.preventDefault(),i=t.pageX||t.originalEvent.touches[0].pageX,r=(i-e.$wrapper.offset().left)/e.$wrapper.width()*100,n=25,o=75,n>r?r=n:r>o&&(r=o),e.$container.css("margin-left",""+(r-o)+"%"),e.$element.trigger("focus.bootstrapSwitch")):void 0}}(this),"mousedown.bootstrapSwitch touchstart.bootstrapSwitch":function(e){return function(t){return e.drag||e.options.disabled||e.options.readonly?void 0:(t.preventDefault(),e.drag=!0,e.options.animate&&e.$wrapper.removeClass(""+e.options.baseClass+"-animate"),e.$element.trigger("focus.bootstrapSwitch"))}}(this),"mouseup.bootstrapSwitch touchend.bootstrapSwitch":function(e){return function(t){return e.drag?(t.preventDefault(),e.drag=!1,e.$element.prop("checked",parseInt(e.$container.css("margin-left"),10)>-(e.$container.width()/6)).trigger("change.bootstrapSwitch"),e.$container.css("margin-left",""),e.options.animate?e.$wrapper.addClass(""+e.options.baseClass+"-animate"):void 0):void 0}}(this),"mouseleave.bootstrapSwitch":function(e){return function(){return e.$label.trigger("mouseup.bootstrapSwitch")}}(this)})},e.prototype._formHandler=function(){var e;return e=this.$element.closest("form"),e.data("bootstrap-switch")?void 0:e.on("reset.bootstrapSwitch",function(){return n.setTimeout(function(){return e.find("input").filter(function(){return t(this).data("bootstrap-switch")}).each(function(){return t(this).bootstrapSwitch("state",this.checked)})},1)}).data("bootstrap-switch",!0)},e.prototype._getClasses=function(e){var n,i,r,o;if(!t.isArray(e))return[""+this.options.baseClass+"-"+e];for(i=[],r=0,o=e.length;o>r;r++)n=e[r],i.push(""+this.options.baseClass+"-"+n);return i},e}(),t.fn.bootstrapSwitch=function(){var n,r,o;return r=arguments[0],n=2<=arguments.length?e.call(arguments,1):[],o=this,this.each(function(){var e,s;return e=t(this),s=e.data("bootstrap-switch"),s||e.data("bootstrap-switch",s=new i(this,r)),"string"==typeof r?o=s[r].apply(s,n):void 0}),o},t.fn.bootstrapSwitch.Constructor=i,t.fn.bootstrapSwitch.defaults={state:!0,size:null,animate:!0,disabled:!1,readonly:!1,onColor:"primary",offColor:"default",onText:"ON",offText:"OFF",labelText:"&nbsp;",baseClass:"bootstrap-switch",wrapperClass:"wrapper",onInit:function(){},onSwitchChange:function(){}}}(window.jQuery,window)}.call(this),!function(e){"undefined"==typeof e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var n=e([0]),i=-1,r=this.length;++i<r&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function n(t){var n=e(document.createTextNode(""));t.before(n),n.before(t),n.remove()}function i(e){var t,n,i,r;if(!e||e.length<1)return e;for(t="",n=0,i=e.length;i>n;n++)r=e.charAt(n),t+=U[r]||r;return t}function r(e,t){for(var n=0,i=t.length;i>n;n+=1)if(s(e,t[n]))return n;return-1}function o(){var t=e(j);t.appendTo("body");var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function s(e,n){return e===n?!0:e===t||n===t?!1:null===e||null===n?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function a(t,n){var i,r,o;if(null===t||t.length<1)return[];for(i=t.split(n),r=0,o=i.length;o>r;r+=1)i[r]=e.trim(i[r]);return i}function l(e){return e.outerWidth(!1)-e.width()}function c(n){var i="keyup-change-value";n.on("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.on("keyup",function(){var r=e.data(n,i);r!==t&&n.val()!==r&&(e.removeData(n,i),n.trigger("keyup-change"))})}function u(n){n.on("mousemove",function(n){var i=L;(i===t||i.x!==n.pageX||i.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function h(e,n,i){i=i||t;var r;return function(){var t=arguments;window.clearTimeout(r),r=window.setTimeout(function(){n.apply(i,t)},e)}}function d(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function p(e,t){var n=h(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){r(e.target,t.get())>=0&&n(e)})}function f(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],i=e.val().length;e.focus();var r=n.offsetWidth>0||n.offsetHeight>0;r&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(i,i):n.createTextRange&&(t=n.createTextRange(),t.collapse(!1),t.select()))},0)}function g(t){t=e(t)[0];var n=0,i=0;if("selectionStart"in t)n=t.selectionStart,i=t.selectionEnd-n;else if("selection"in document){t.focus();var r=document.selection.createRange();i=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),n=r.text.length-i}return{offset:n,length:i}}function m(e){e.preventDefault(),e.stopPropagation()}function v(e){e.preventDefault(),e.stopImmediatePropagation()}function b(t){if(!R){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);R=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),R.attr("class","select2-sizer"),e("body").append(R)}return R.text(t.val()),R.width()}function y(t,n,i){var r,o,s=[];r=t.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0===this.indexOf("select2-")&&s.push(this)})),r=n.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(o=i(this),o&&s.push(o))})),t.attr("class",s.join(" "))}function w(e,t,n,r){var o=i(e.toUpperCase()).indexOf(i(t.toUpperCase())),s=t.length;return 0>o?void n.push(r(e)):(n.push(r(e.substring(0,o))),n.push("<span class='select2-match'>"),n.push(r(e.substring(o,o+s))),n.push("</span>"),void n.push(r(e.substring(o+s,e.length))))}function _(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function x(n){var i,r=null,o=n.quietMillis||100,s=n.url,a=this;return function(l){window.clearTimeout(i),i=window.setTimeout(function(){var i=n.data,o=s,c=n.transport||e.fn.select2.ajaxDefaults.transport,u={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},h=e.extend({},e.fn.select2.ajaxDefaults.params,u);i=i?i.call(a,l.term,l.page,l.context):null,o="function"==typeof o?o.call(a,l.term,l.page,l.context):o,r&&"function"==typeof r.abort&&r.abort(),n.params&&(e.isFunction(n.params)?e.extend(h,n.params.call(a)):e.extend(h,n.params)),e.extend(h,{url:o,dataType:n.dataType,data:i,success:function(e){var t=n.results(e,l.page);l.callback(t)}}),r=c.call(a,h)},o)}}function C(t){var n,i,r=t,o=function(e){return""+e.text};e.isArray(r)&&(i=r,r={results:i}),e.isFunction(r)===!1&&(i=r,r=function(){return i});var s=r();return s.text&&(o=s.text,e.isFunction(o)||(n=s.text,o=function(e){return e[n]})),function(t){var n,i=t.term,s={results:[]};return""===i?void t.callback(r()):(n=function(r,s){var a,l;if(r=r[0],r.children){a={};for(l in r)r.hasOwnProperty(l)&&(a[l]=r[l]);a.children=[],e(r.children).each2(function(e,t){n(t,a.children)}),(a.children.length||t.matcher(i,o(a),r))&&s.push(a)}else t.matcher(i,o(r),r)&&s.push(r)},e(r().results).each2(function(e,t){n(t,s.results)}),void t.callback(s))}}function $(n){var i=e.isFunction(n);return function(r){var o=r.term,s={results:[]};e(i?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===o||r.matcher(o,n))&&s.results.push(e?this:{id:this,text:this})}),r.callback(s)}}function k(t,n){if(e.isFunction(t))return!0;if(!t)return!1;if("string"==typeof t)return!0;throw new Error(n+" must be a string, function, or falsy value")}function S(t){if(e.isFunction(t)){var n=Array.prototype.slice.call(arguments,1);return t.apply(null,n)}return t}function T(t){var n=0;return e.each(t,function(e,t){t.children?n+=T(t.children):n++}),n}function E(e,n,i,r){var o,a,l,c,u,h=e,d=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return t;for(;;){for(a=-1,l=0,c=r.tokenSeparators.length;c>l&&(u=r.tokenSeparators[l],a=e.indexOf(u),!(a>=0));l++);if(0>a)break;if(o=e.substring(0,a),e=e.substring(a+u.length),o.length>0&&(o=r.createSearchChoice.call(this,o,n),o!==t&&null!==o&&r.id(o)!==t&&null!==r.id(o))){for(d=!1,l=0,c=n.length;c>l;l++)if(s(r.id(o),r.id(n[l]))){d=!0;break}d||i(o)}}return h!==e?e:void 0}function D(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var A,O,I,M,P,R,N,F,L={x:0,y:0},A={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case A.LEFT:case A.RIGHT:case A.UP:case A.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case A.SHIFT:case A.CTRL:case A.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},j="<div class='select2-measure-scrollbar'></div>",U={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z"};N=e(document),P=function(){var e=1;return function(){return e++}}(),N.on("mousemove",function(e){L.x=e.pageX,L.y=e.pageY}),O=D(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,r,s=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+P()).replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.containerSelector="#"+this.containerId,this.container.attr("id",this.containerId),this.body=d(function(){return n.element.closest("body")}),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(S(n.containerCss)),this.container.addClass(S(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",m),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(S(n.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",m),this.results=i=this.container.find(s),this.search=r=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",m),u(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",s,this.bind(this.highlightUnderEvent)),this.dropdown.on("touchend",s,this.bind(this.selectHighlighted)),this.dropdown.on("touchmove",s,this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",s,this.bind(this.clearTouchMoved)),p(80,this.results),this.dropdown.on("scroll-debounced",s,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&i.mousewheel(function(e,t,n,r){var o=i.scrollTop();r>0&&0>=o-r?(i.scrollTop(0),m(e)):0>r&&i.get(0).scrollHeight-i.scrollTop()+r<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),m(e))}),c(r),r.on("keyup-change input paste",this.bind(this.updateResults)),r.on("focus",function(){r.addClass("select2-focused")}),r.on("blur",function(){r.removeClass("select2-focused")}),this.dropdown.on("mouseup",s,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown focusin",function(e){e.stopPropagation()}),this.nextSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var a=n.element.prop("disabled");a===t&&(a=!1),this.enable(!a);var l=n.element.prop("readonly");l===t&&(l=!1),this.readonly(l),F=F||o(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",n.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,n=e.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),n!==t&&(n.container.remove(),n.liveRegion.remove(),n.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:s(e.attr("locked"),"locked")||s(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var i,r,o,l,c=this;if(i=n.element,"select"===i.get(0).tagName.toLowerCase()&&(this.select=r=n.element),r&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(i,r,o){var s,a=this.opts.id,l=this.liveRegion;
(s=function(i,r,u){var h,d,p,f,g,m,v,b,y,w;for(i=n.sortResults(i,r,o),h=0,d=i.length;d>h;h+=1)p=i[h],g=p.disabled===!0,f=!g&&a(p)!==t,m=p.children&&p.children.length>0,v=e("<li></li>"),v.addClass("select2-results-dept-"+u),v.addClass("select2-result"),v.addClass(f?"select2-result-selectable":"select2-result-unselectable"),g&&v.addClass("select2-disabled"),m&&v.addClass("select2-result-with-children"),v.addClass(c.opts.formatResultCssClass(p)),v.attr("role","presentation"),b=e(document.createElement("div")),b.addClass("select2-result-label"),b.attr("id","select2-result-label-"+P()),b.attr("role","option"),w=n.formatResult(p,b,o,c.opts.escapeMarkup),w!==t&&(b.html(w),v.append(b)),m&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),s(p.children,y,u+1),v.append(y)),v.data("select2-data",p),r.append(v);l.text(n.formatMatches(i.length))})(r,i,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(o=n.id,n.id=function(e){return e[o]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(r?(n.query=this.bind(function(e){var n,r,o,s={results:[],more:!1},a=e.term;o=function(t,n){var i;t.is("option")?e.matcher(a,t.text(),t)&&n.push(c.optionToData(t)):t.is("optgroup")&&(i=c.optionToData(t),t.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&n.push(i))},n=i.children(),this.getPlaceholder()!==t&&n.length>0&&(r=this.getPlaceholderOption(),r&&(n=n.not(r))),n.each2(function(e,t){o(t,s.results)}),e.callback(s)}),n.id=function(e){return e.id}):"query"in n||("ajax"in n?(l=n.element.data("ajax-url"),l&&l.length>0&&(n.ajax.url=l),n.query=x.call(n.element,n.ajax)):"data"in n?n.query=C(n.data):"tags"in n&&(n.query=$(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,i){var r=[];e(a(t.val(),n.separator)).each(function(){var t={id:this,text:this},i=n.tags;e.isFunction(i)&&(i=i()),e(i).each(function(){return s(this.id,t.id)?(t=this,!1):void 0}),r.push(t)}),i(r)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");if("top"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof n.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return n},monitorSource:function(){var e,n,i=this.opts.element;i.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),e=this.bind(function(){var e=i.prop("disabled");e===t&&(e=!1),this.enable(!e);var n=i.prop("readonly");n===t&&(n=!1),this.readonly(n),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(S(this.opts.containerCssClass)),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(S(this.opts.dropdownCssClass))}),i.on("propertychange.select2",e),this.mutationCallback===t&&(this.mutationCallback=function(t){t.forEach(e)}),n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,n!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new n(this.mutationCallback),this.propertyObserver.observe(i.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,r,o,s=this.dropdown,a=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=s.outerHeight(!1),h=e(window),d=h.width(),p=h.height(),f=h.scrollLeft()+d,g=h.scrollTop()+p,m=a.top+l,v=a.left,b=g>=m+u,y=a.top-u>=h.scrollTop(),w=s.outerWidth(!1),_=f>=v+w,x=s.hasClass("select2-drop-above");x?(n=!0,!y&&b&&(i=!0,n=!1)):(n=!1,!b&&y&&(i=!0,n=!0)),i&&(s.hide(),a=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=s.outerHeight(!1),f=h.scrollLeft()+d,g=h.scrollTop()+p,m=a.top+l,v=a.left,w=s.outerWidth(!1),_=f>=v+w,s.show()),this.opts.dropdownAutoWidth?(o=e(".select2-results",s)[0],s.addClass("select2-drop-auto-width"),s.css("width",""),w=s.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:F.width),w>c?c=w:w=c,_=f>=v+w):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(t=this.body().offset(),m-=t.top,v-=t.left),_||(v=a.left+this.container.outerWidth(!1)-w),r={left:v,width:c},n?(r.top=a.top-u,r.bottom="auto",this.container.addClass("select2-drop-above"),s.addClass("select2-drop-above")):(r.top=m,r.bottom="auto",this.container.removeClass("select2-drop-above"),s.removeClass("select2-drop-above")),r=e.extend(r,S(this.opts.dropdownCss)),s.css(r)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var t,i=this.containerId,r="scroll."+i,o="resize."+i,s="orientationchange."+i;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),t=e("#select2-drop-mask"),0==t.length&&(t=e(document.createElement("div")),t.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body()),t.on("mousedown touchstart click",function(i){n(t);var r,o=e("#select2-drop");o.length>0&&(r=o.data("select2"),r.opts.selectOnBlur&&r.selectHighlighted({noFocus:!0}),r.close(),i.preventDefault(),i.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each(function(){e(this).on(o+" "+r+" "+s,function(){a.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerId,n="scroll."+t,i="resize."+t,r="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(i).off(r)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return S(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t,n,i,r,o,s,a,l=this.results;if(n=this.highlight(),!(0>n)){if(0==n)return void l.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),i=e(t[n]),r=i.offset().top+i.outerHeight(!0),n===t.length-1&&(a=l.find("li.select2-more-results"),a.length>0&&(r=a.offset().top+a.outerHeight(!0))),o=l.offset().top+l.outerHeight(!0),r>o&&l.scrollTop(l.scrollTop()+(r-o)),s=i.offset().top-l.offset().top,0>s&&"none"!=i.css("display")&&l.scrollTop(l.scrollTop()+s)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),i=this.highlight();i>-1&&i<n.length;){i+=t;var r=e(n[i]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var n,i,o=this.findHighlightableChoices();return 0===arguments.length?r(o.filter(".select2-highlighted")[0],o.get()):(t>=o.length&&(t=o.length-1),0>t&&(t=0),this.removeHighlight(),n=e(o[t]),n.addClass("select2-highlighted"),this.search.attr("aria-activedescendant",n.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(n.text()),i=n.data("select2-data"),void(i&&this.opts.element.trigger({type:"select2-highlight",val:this.id(i),choice:i})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(n))}else 0==n.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,r=this,o=this.search.val(),s=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:s,matcher:this.opts.matcher,callback:this.bind(function(e){r.opened()&&(r.opts.populateResults.call(this,t,e.results,{term:o,page:i,context:s}),r.postprocessResults(e,!1,!1),e.more===!0?(n.detach().appendTo(t).text(S(r.opts.formatLoadMore,i+1)),window.setTimeout(function(){r.loadMoreIfNeeded()},10)):n.remove(),r.positionDropdown(),r.resultsPage=i,r.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})})))},tokenize:function(){},updateResults:function(n){function i(){c.removeClass("select2-active"),d.positionDropdown(),d.liveRegion.text(u.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?u.text():d.opts.formatMatches(u.find(".select2-result-selectable").length))}function r(e){u.html(e),i()}var o,a,l,c=this.search,u=this.results,h=this.opts,d=this,p=c.val(),f=e.data(this.container,"select2-last-term");if((n===!0||!f||!s(p,f))&&(e.data(this.container,"select2-last-term",p),n===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var g=this.getMaximumSelectionSize();if(g>=1&&(o=this.data(),e.isArray(o)&&o.length>=g&&k(h.formatSelectionTooBig,"formatSelectionTooBig")))return void r("<li class='select2-selection-limit'>"+S(h.formatSelectionTooBig,g)+"</li>");if(c.val().length<h.minimumInputLength)return r(k(h.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+S(h.formatInputTooShort,c.val(),h.minimumInputLength)+"</li>":""),void(n&&this.showSearch&&this.showSearch(!0));if(h.maximumInputLength&&c.val().length>h.maximumInputLength)return void r(k(h.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+S(h.formatInputTooLong,c.val(),h.maximumInputLength)+"</li>":"");h.formatSearching&&0===this.findHighlightableChoices().length&&r("<li class='select2-searching'>"+S(h.formatSearching)+"</li>"),c.addClass("select2-active"),this.removeHighlight(),a=this.tokenize(),a!=t&&null!=a&&c.val(a),this.resultsPage=1,h.query({element:h.element,term:c.val(),page:this.resultsPage,context:null,matcher:h.matcher,callback:this.bind(function(o){var a;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&""!==c.val()&&(a=this.opts.createSearchChoice.call(d,c.val(),o.results),a!==t&&null!==a&&d.id(a)!==t&&null!==d.id(a)&&0===e(o.results).filter(function(){return s(d.id(this),d.id(a))}).length&&this.opts.createSearchChoicePosition(o.results,a)),0===o.results.length&&k(h.formatNoMatches,"formatNoMatches"))return void r("<li class='select2-no-results'>"+S(h.formatNoMatches,c.val())+"</li>");u.empty(),d.opts.populateResults.call(this,u,o.results,{term:c.val(),page:this.resultsPage,context:null}),o.more===!0&&k(h.formatLoadMore,"formatLoadMore")&&(u.append("<li class='select2-more-results'>"+d.opts.escapeMarkup(S(h.formatLoadMore,this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),i(),this.opts.element.trigger({type:"select2-loaded",items:o})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){f(this.search)},selectHighlighted:function(e){if(this._touchMoved)return void this.clearTouchMoved();var t=this.highlight(),n=this.results.find(".select2-highlighted"),i=n.closest(".select2-result").data("select2-data");i?(this.highlight(t),this.onSelect(i,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.text()&&""===e.val())return e}},initContainerWidth:function(){function n(){var n,i,r,o,s,a;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(i=n.split(";"),o=0,s=i.length;s>o;o+=1)if(a=i[o].replace(/\s/g,""),r=a.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var i=n.call(this);null!==i&&this.container.css("width",i)}}),I=D(O,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var n,i,r;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),n=this.search.get(0),n.createTextRange?(i=n.createTextRange(),i.collapse(!1),i.select()):n.setSelectionRange&&(r=this.search.val().length,n.setSelectionRange(r,r)),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,i,r=this.container,o=this.dropdown,s=P();this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=t=r.find(".select2-choice"),this.focusser=r.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+s),this.focusser.attr("aria-labelledby","select2-chosen-"+s),this.results.attr("id","select2-results-"+s),this.search.attr("aria-owns","select2-results-"+s),this.focusser.attr("id","s2id_autogen"+s),i=e("label[for='"+this.opts.element.attr("id")+"']"),this.focusser.prev().text(i.text()).attr("for",this.focusser.attr("id"));var a=this.opts.element.attr("title");this.opts.element.attr("title",a||i.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){if(e.which===A.PAGE_UP||e.which===A.PAGE_DOWN)return void m(e);switch(e.which){case A.UP:case A.DOWN:return this.moveHighlight(e.which===A.UP?-1:1),void m(e);case A.ENTER:return this.selectHighlighted(),void m(e);case A.TAB:return void this.selectHighlighted({noFocus:!0});case A.ESC:return this.cancel(e),void m(e)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==A.TAB&&!A.isControl(e)&&!A.isFunctionKey(e)&&e.which!==A.ESC){if(this.opts.openOnEnter===!1&&e.which===A.ENTER)return void m(e);if(e.which==A.DOWN||e.which==A.UP||e.which==A.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void m(e)}return e.which==A.DELETE||e.which==A.BACKSPACE?(this.opts.allowClear&&this.clear(),void m(e)):void 0}})),c(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),v(e),this.close(),this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(i){n(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),m(i)})),o.on("mousedown touchstart",this.bind(function(){this.search.focus()})),t.on("focus",this.bind(function(e){m(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(t){var n=this.selection.data("select2-data");if(n){var i=e.Event("select2-clearing");if(this.opts.element.trigger(i),i.isDefaultPrevented())return;var r=this.getPlaceholderOption();this.opts.element.val(r?r.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),t!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder(),e.nextSearchTerm=e.opts.nextSearchTerm(n,e.search.val()))})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()?(e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val():!1},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=e.find("option").filter(function(){return this.selected&&!this.disabled});t(n.optionToData(i))}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=n.val(),o=null;t.query({matcher:function(e,n,i){var a=s(r,t.id(i));return a&&(o=i),a},callback:e.isFunction(i)?function(){i(o)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var i=0,r=this;if(this.findHighlightableChoices().each2(function(e,t){return s(r.id(t.data("select2-data")),r.opts.element.val())?(i=e,!1):void 0}),n!==!1&&this.highlight(t===!0&&i>=0?i:0),t===!0){var o=this.opts.minimumResultsForSearch;o>=0&&this.showSearch(T(e.results)>=o)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),s(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var n,i,r=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),r.empty(),null!==e&&(n=this.opts.formatSelection(e,r,this.opts.escapeMarkup)),n!==t&&r.append(n),i=this.opts.formatSelectionCssClass(e,r),i!==t&&r.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,i=null,r=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return i=r.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),n&&this.triggerChange({added:i,removed:o});else{if(!e&&0!==e)return void this.clear(n);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){r.opts.element.val(e?r.id(e):""),r.updateSelection(e),r.setPlaceholder(),n&&r.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,i=!1;return 0===arguments.length?(n=this.selection.data("select2-data"),n==t&&(n=null),n):(arguments.length>1&&(i=arguments[1]),void(e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),i&&this.triggerChange({added:e,removed:n})):this.clear(i)))}}),M=D(O,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=a(n.val(),t.separator),o=[];t.query({matcher:function(n,i,a){var l=e.grep(r,function(e){return s(e,t.id(a))}).length;return l&&o.push(a),l},callback:e.isFunction(i)?function(){for(var e=[],n=0;n<r.length;n++)for(var a=r[n],l=0;l<o.length;l++){var c=o[l];if(s(a,t.id(c))){e.push(c),o.splice(l,1);break}}i(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n);var i=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+P()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var n=t.find(".select2-search-choice-focus"),i=n.prev(".select2-search-choice:not(.select2-locked)"),r=n.next(".select2-search-choice:not(.select2-locked)"),o=g(this.search);if(n.length&&(e.which==A.LEFT||e.which==A.RIGHT||e.which==A.BACKSPACE||e.which==A.DELETE||e.which==A.ENTER)){var s=n;return e.which==A.LEFT&&i.length?s=i:e.which==A.RIGHT?s=r.length?r:null:e.which===A.BACKSPACE?this.unselect(n.first())&&(this.search.width(10),s=i.length?i:r):e.which==A.DELETE?this.unselect(n.first())&&(this.search.width(10),s=r.length?r:null):e.which==A.ENTER&&(s=null),this.selectChoice(s),m(e),void(s&&s.length||this.open())}if((e.which===A.BACKSPACE&&1==this.keydowns||e.which==A.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void m(e);if(this.selectChoice(null),this.opened())switch(e.which){case A.UP:case A.DOWN:return this.moveHighlight(e.which===A.UP?-1:1),void m(e);case A.ENTER:return this.selectHighlighted(),void m(e);case A.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case A.ESC:return this.cancel(e),void m(e)}if(e.which!==A.TAB&&!A.isControl(e)&&!A.isFunctionKey(e)&&e.which!==A.BACKSPACE&&e.which!==A.ESC){if(e.which===A.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===A.PAGE_UP||e.which===A.PAGE_DOWN)&&m(e),e.which===A.ENTER&&m(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus();
},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],i=[],o=this;e(t).each(function(){r(o.id(this),n)<0&&(n.push(o.id(this)),i.push(this))}),t=i,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,n){this.triggerSelect(e)&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.clearSearch(),this.updateResults(),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),n&&n.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,r,o=!n.locked,s=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=o?s:a,c=this.id(n),u=this.getVal();i=this.opts.formatSelection(n,l.find("div"),this.opts.escapeMarkup),i!=t&&l.find("div").replaceWith("<div>"+i+"</div>"),r=this.opts.formatSelectionCssClass(n,l.find("div")),r!=t&&l.addClass(r),o&&l.find(".select2-search-choice-close").on("mousedown",m).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),m(t),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",n),l.insertBefore(this.searchContainer),u.push(c),this.setVal(u)},unselect:function(t){var n,i,o=this.getVal();if(t=t.closest(".select2-search-choice"),0===t.length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(n=t.data("select2-data")){var s=e.Event("select2-removing");if(s.val=this.id(n),s.choice=n,this.opts.element.trigger(s),s.isDefaultPrevented())return!1;for(;(i=r(this.id(n),o))>=0;)o.splice(i,1),this.setVal(o),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}),!0}},postprocessResults:function(e,t,n){var i=this.getVal(),o=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),a=this;o.each2(function(e,t){var n=a.id(t.data("select2-data"));r(n,i)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&n!==!1&&a.highlight(0),!this.opts.createSearchChoice&&!o.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&k(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+S(a.opts.formatNoMatches,a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-l(this.search)},resizeSearch:function(){var e,t,n,i,r,o=l(this.search);e=b(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,r=n-(t-i)-o,e>r&&(r=n-o),40>r&&(r=n-o),0>=r&&(r=e),this.search.width(Math.floor(r))},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),a(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){r(this,n)<0&&n.push(this)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator)))},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)s(this.opts.id(t[n]),this.opts.id(e[i]))&&(t.splice(n,1),n>0&&n--,e.splice(i,1),i--);return{added:t,removed:e}},val:function(n,i){var r,o=this;if(0===arguments.length)return this.getVal();if(r=this.data(),r.length||(r=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:r}));if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(r,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,o.id);o.setVal(n),o.updateSelection(t),o.clearSearch(),i&&o.triggerChange(o.buildChangeDetails(r,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var i,r,o=this;return 0===arguments.length?this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(r=this.data(),t||(t=[]),i=e.map(t,function(e){return o.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),void(n&&this.triggerChange(this.buildChangeDetails(r,this.data()))))}}),e.fn.select2=function(){var n,i,o,s,a,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],u=["opened","isFocused","container","dropdown"],h=["val","data"],d={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])n=0===l.length?{}:e.extend({},l[0]),n.element=e(this),"select"===n.element.get(0).tagName.toLowerCase()?a=n.element.prop("multiple"):(a=n.multiple||!1,"tags"in n&&(n.multiple=a=!0)),i=a?new window.Select2["class"].multi:new window.Select2["class"].single,i.init(n);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(r(l[0],c)<0)throw"Unknown method: "+l[0];if(s=t,i=e(this).data("select2"),i===t)return;if(o=l[0],"container"===o?s=i.container:"dropdown"===o?s=i.dropdown:(d[o]&&(o=d[o]),s=i[o].apply(i,l.slice(1))),r(l[0],u)>=0||r(l[0],h)&&1==l.length)return!1}}),s===t?this:s},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var r=[];return w(e.text,n.term,r,i),r.join("")},formatSelection:function(e,n,i){return e?i(e.text):t},sortResults:function(e){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(){return t},formatMatches:function(e){return e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" or more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results…"},formatSearching:function(){return"Searching…"},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},matcher:function(e,t){return i(""+t).toUpperCase().indexOf(i(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:E,escapeMarkup:_,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return e.opts.minimumResultsForSearch<0?!1:!0}},e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:x,local:C,tags:$},util:{debounce:h,markMatch:w,escapeMarkup:_,stripDiacritics:i},"class":{"abstract":O,single:I,multi:M}}}}(jQuery),function(e,t,n){var i=function(i){function r(e){var t,n,o={};i.each(e,function(i){(t=i.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(t[1]+" ")&&(n=i.replace(t[0],t[2].toLowerCase()),o[n]=i,"o"===t[1]&&r(e[i]))}),e._hungarianMap=o}function o(e,t,s){e._hungarianMap||r(e);var a;i.each(t,function(r){a=e._hungarianMap[r],a===n||!s&&t[a]!==n||("o"===a.charAt(0)?(t[a]||(t[a]={}),i.extend(!0,t[a],t[r]),o(e[a],t[a],s)):t[a]=t[r])})}function s(e){var t=Ve.defaults.oLanguage,n=e.sZeroRecords;!e.sEmptyTable&&n&&"No data available in table"===t.sEmptyTable&&Re(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&n&&"Loading..."===t.sLoadingRecords&&Re(e,e,"sZeroRecords","sLoadingRecords"),e.sInfoThousands&&(e.sThousands=e.sInfoThousands),(e=e.sDecimal)&&ze(e)}function a(e){if(pt(e,"ordering","bSort"),pt(e,"orderMulti","bSortMulti"),pt(e,"orderClasses","bSortClasses"),pt(e,"orderCellsTop","bSortCellsTop"),pt(e,"order","aaSorting"),pt(e,"orderFixed","aaSortingFixed"),pt(e,"paging","bPaginate"),pt(e,"pagingType","sPaginationType"),pt(e,"pageLength","iDisplayLength"),pt(e,"searching","bFilter"),e=e.aoSearchCols)for(var t=0,n=e.length;n>t;t++)e[t]&&o(Ve.models.oSearch,e[t])}function l(e){pt(e,"orderable","bSortable"),pt(e,"orderData","aDataSort"),pt(e,"orderSequence","asSorting"),pt(e,"orderDataType","sortDataType")}function c(e){var e=e.oBrowser,t=i("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(i("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(i('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),n=t.find(".test");e.bScrollOversize=100===n[0].offsetWidth,e.bScrollbarLeft=1!==n.offset().left,t.remove()}function u(e,t,i,r,o,s){var a,l=!1;for(i!==n&&(a=i,l=!0);r!==o;)e.hasOwnProperty(r)&&(a=l?t(a,e[r],r,e):e[r],l=!0,r+=s);return a}function h(e,n){var r=Ve.defaults.column,o=e.aoColumns.length,r=i.extend({},Ve.models.oColumn,r,{nTh:n?n:t.createElement("th"),sTitle:r.sTitle?r.sTitle:n?n.innerHTML:"",aDataSort:r.aDataSort?r.aDataSort:[o],mData:r.mData?r.mData:o,idx:o});e.aoColumns.push(r),r=e.aoPreSearchCols,r[o]=i.extend({},Ve.models.oSearch,r[o]),d(e,o,null)}function d(e,t,r){var t=e.aoColumns[t],s=e.oClasses,a=i(t.nTh);if(!t.sWidthOrig){t.sWidthOrig=a.attr("width")||null;var c=(a.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);c&&(t.sWidthOrig=c[1])}r!==n&&null!==r&&(l(r),o(Ve.defaults.column,r),r.mDataProp!==n&&!r.mData&&(r.mData=r.mDataProp),r.sType&&(t._sManualType=r.sType),r.className&&!r.sClass&&(r.sClass=r.className),i.extend(t,r),Re(t,r,"sWidth","sWidthOrig"),"number"==typeof r.iDataSort&&(t.aDataSort=[r.iDataSort]),Re(t,r,"aDataSort"));var u=t.mData,h=k(u),d=t.mRender?k(t.mRender):null,r=function(e){return"string"==typeof e&&-1!==e.indexOf("@")};t._bAttrSrc=i.isPlainObject(u)&&(r(u.sort)||r(u.type)||r(u.filter)),t.fnGetData=function(e,t,i){var r=h(e,t,n,i);return d&&t?d(r,t,e,i):r},t.fnSetData=function(e,t,n){return S(u)(e,t,n)},e.oFeatures.bSort||(t.bSortable=!1,a.addClass(s.sSortableNone)),e=-1!==i.inArray("asc",t.asSorting),r=-1!==i.inArray("desc",t.asSorting),t.bSortable&&(e||r)?e&&!r?(t.sSortingClass=s.sSortableAsc,t.sSortingClassJUI=s.sSortJUIAscAllowed):!e&&r?(t.sSortingClass=s.sSortableDesc,t.sSortingClassJUI=s.sSortJUIDescAllowed):(t.sSortingClass=s.sSortable,t.sSortingClassJUI=s.sSortJUI):(t.sSortingClass=s.sSortableNone,t.sSortingClassJUI="")}function p(e){if(!1!==e.oFeatures.bAutoWidth){var t=e.aoColumns;me(e);for(var n=0,i=t.length;i>n;n++)t[n].nTh.style.width=t[n].sWidth}t=e.oScroll,(""!==t.sY||""!==t.sX)&&fe(e),je(e,null,"column-sizing",[e])}function f(e,t){var n=v(e,"bVisible");return"number"==typeof n[t]?n[t]:null}function g(e,t){var n=v(e,"bVisible"),n=i.inArray(t,n);return-1!==n?n:null}function m(e){return v(e,"bVisible").length}function v(e,t){var n=[];return i.map(e.aoColumns,function(e,i){e[t]&&n.push(i)}),n}function b(e){var t,i,r,o,s,a,l,c,u,h=e.aoColumns,d=e.aoData,p=Ve.ext.type.detect;for(t=0,i=h.length;i>t;t++)if(l=h[t],u=[],!l.sType&&l._sManualType)l.sType=l._sManualType;else if(!l.sType){for(r=0,o=p.length;o>r;r++){for(s=0,a=d.length;a>s&&(u[s]===n&&(u[s]=x(e,s,t,"type")),c=p[r](u[s],e),!(!c||"html"===c));s++);if(c){l.sType=c;break}}l.sType||(l.sType="string")}}function y(e,t,r,o){var s,a,l,c,u,d,p=e.aoColumns;if(t)for(s=t.length-1;s>=0;s--){d=t[s];var f=d.targets!==n?d.targets:d.aTargets;for(i.isArray(f)||(f=[f]),a=0,l=f.length;l>a;a++)if("number"==typeof f[a]&&0<=f[a]){for(;p.length<=f[a];)h(e);o(f[a],d)}else if("number"==typeof f[a]&&0>f[a])o(p.length+f[a],d);else if("string"==typeof f[a])for(c=0,u=p.length;u>c;c++)("_all"==f[a]||i(p[c].nTh).hasClass(f[a]))&&o(c,d)}if(r)for(s=0,e=r.length;e>s;s++)o(s,r[s])}function w(e,t,n,r){var o=e.aoData.length,s=i.extend(!0,{},Ve.models.oRow,{src:n?"dom":"data"});s._aData=t,e.aoData.push(s);for(var t=e.aoColumns,s=0,a=t.length;a>s;s++)n&&C(e,o,s,x(e,o,s)),t[s].sType=null;return e.aiDisplayMaster.push(o),(n||!e.oFeatures.bDeferRender)&&I(e,o,n,r),o}function _(e,t){var n;return t instanceof i||(t=i(t)),t.map(function(t,i){return n=O(e,i),w(e,n.data,i,n.cells)})}function x(e,t,i,r){var o=e.iDraw,s=e.aoColumns[i],a=e.aoData[t]._aData,l=s.sDefaultContent,i=s.fnGetData(a,r,{settings:e,row:t,col:i});if(i===n)return e.iDrawError!=o&&null===l&&(Pe(e,0,"Requested unknown parameter "+("function"==typeof s.mData?"{function}":"'"+s.mData+"'")+" for row "+t,4),e.iDrawError=o),l;if(i!==a&&null!==i||null===l){if("function"==typeof i)return i.call(a)}else i=l;return null===i&&"display"==r?"":i}function C(e,t,n,i){e.aoColumns[n].fnSetData(e.aoData[t]._aData,i,{settings:e,row:t,col:n})}function $(e){return i.map(e.match(/(\\.|[^\.])+/g),function(e){return e.replace(/\\./g,".")})}function k(e){if(i.isPlainObject(e)){var t={};return i.each(e,function(e,n){n&&(t[e]=k(n))}),function(e,i,r,o){var s=t[i]||t._;return s!==n?s(e,i,r,o):e}}if(null===e)return function(e){return e};if("function"==typeof e)return function(t,n,i,r){return e(t,n,i,r)};if("string"==typeof e&&(-1!==e.indexOf(".")||-1!==e.indexOf("[")||-1!==e.indexOf("("))){var r=function(e,t,i){var o,s;if(""!==i){s=$(i);for(var a=0,l=s.length;l>a;a++){if(i=s[a].match(ft),o=s[a].match(gt),i){for(s[a]=s[a].replace(ft,""),""!==s[a]&&(e=e[s[a]]),o=[],s.splice(0,a+1),s=s.join("."),a=0,l=e.length;l>a;a++)o.push(r(e[a],t,s));e=i[0].substring(1,i[0].length-1),e=""===e?o:o.join(e);break}if(o)s[a]=s[a].replace(gt,""),e=e[s[a]]();else{if(null===e||e[s[a]]===n)return n;e=e[s[a]]}}}return e};return function(t,n){return r(t,n,e)}}return function(t){return t[e]}}function S(e){if(i.isPlainObject(e))return S(e._);if(null===e)return function(){};if("function"==typeof e)return function(t,n,i){e(t,"set",n,i)};if("string"==typeof e&&(-1!==e.indexOf(".")||-1!==e.indexOf("[")||-1!==e.indexOf("("))){var t=function(e,i,r){var o,r=$(r);o=r[r.length-1];for(var s,a,l=0,c=r.length-1;c>l;l++){if(s=r[l].match(ft),a=r[l].match(gt),s){for(r[l]=r[l].replace(ft,""),e[r[l]]=[],o=r.slice(),o.splice(0,l+1),s=o.join("."),a=0,c=i.length;c>a;a++)o={},t(o,i[a],s),e[r[l]].push(o);return}a&&(r[l]=r[l].replace(gt,""),e=e[r[l]](i)),(null===e[r[l]]||e[r[l]]===n)&&(e[r[l]]={}),e=e[r[l]]}o.match(gt)?e[o.replace(gt,"")](i):e[o.replace(ft,"")]=i};return function(n,i){return t(n,i,e)}}return function(t,n){t[e]=n}}function T(e){return ct(e.aoData,"_aData")}function E(e){e.aoData.length=0,e.aiDisplayMaster.length=0,e.aiDisplay.length=0}function D(e,t,i){for(var r=-1,o=0,s=e.length;s>o;o++)e[o]==t?r=o:e[o]>t&&e[o]--;-1!=r&&i===n&&e.splice(r,1)}function A(e,t,i,r){var o,s=e.aoData[t];if("dom"!==i&&(i&&"auto"!==i||"dom"!==s.src)){var a,l=s.anCells;if(l)for(i=0,o=l.length;o>i;i++){for(a=l[i];a.childNodes.length;)a.removeChild(a.firstChild);l[i].innerHTML=x(e,t,i,"display")}}else s._aData=O(e,s).data;if(s._aSortData=null,s._aFilterData=null,e=e.aoColumns,r!==n)e[r].sType=null;else for(i=0,o=e.length;o>i;i++)e[i].sType=null;M(s)}function O(e,t){var n,r,o,s,a=[],l=[],c=t.firstChild,u=0,h=e.aoColumns,d=function(e,t,n){"string"==typeof e&&(t=e.indexOf("@"),-1!==t&&(e=e.substring(t+1),o["@"+e]=n.getAttribute(e)))},p=function(e){r=h[u],s=i.trim(e.innerHTML),r&&r._bAttrSrc?(o={display:s},d(r.mData.sort,o,e),d(r.mData.type,o,e),d(r.mData.filter,o,e),a.push(o)):a.push(s),u++};if(c)for(;c;)n=c.nodeName.toUpperCase(),("TD"==n||"TH"==n)&&(p(c),l.push(c)),c=c.nextSibling;else for(l=t.anCells,c=0,n=l.length;n>c;c++)p(l[c]);return{data:a,cells:l}}function I(e,n,i,r){var o,s,a,l,c,u=e.aoData[n],h=u._aData,d=[];if(null===u.nTr){for(o=i||t.createElement("tr"),u.nTr=o,u.anCells=d,o._DT_RowIndex=n,M(u),l=0,c=e.aoColumns.length;c>l;l++)a=e.aoColumns[l],s=i?r[l]:t.createElement(a.sCellType),d.push(s),(!i||a.mRender||a.mData!==l)&&(s.innerHTML=x(e,n,l,"display")),a.sClass&&(s.className+=" "+a.sClass),a.bVisible&&!i?o.appendChild(s):!a.bVisible&&i&&s.parentNode.removeChild(s),a.fnCreatedCell&&a.fnCreatedCell.call(e.oInstance,s,x(e,n,l),h,n,l);je(e,"aoRowCreatedCallback",null,[o,h,n])}u.nTr.setAttribute("role","row")}function M(e){var t=e.nTr,n=e._aData;if(t){if(n.DT_RowId&&(t.id=n.DT_RowId),n.DT_RowClass){var r=n.DT_RowClass.split(" ");e.__rowc=e.__rowc?dt(e.__rowc.concat(r)):r,i(t).removeClass(e.__rowc.join(" ")).addClass(n.DT_RowClass)}n.DT_RowData&&i(t).data(n.DT_RowData)}}function P(e){var t,n,r,o,s,a=e.nTHead,l=e.nTFoot,c=0===i("th, td",a).length,u=e.oClasses,h=e.aoColumns;for(c&&(o=i("<tr/>").appendTo(a)),t=0,n=h.length;n>t;t++)s=h[t],r=i(s.nTh).addClass(s.sClass),c&&r.appendTo(o),e.oFeatures.bSort&&(r.addClass(s.sSortingClass),!1!==s.bSortable&&(r.attr("tabindex",e.iTabIndex).attr("aria-controls",e.sTableId),Ee(e,s.nTh,t))),s.sTitle!=r.html()&&r.html(s.sTitle),He(e,"header")(e,r,s,u);if(c&&j(e.aoHeader,a),i(a).find(">tr").attr("role","row"),i(a).find(">tr>th, >tr>td").addClass(u.sHeaderTH),i(l).find(">tr>th, >tr>td").addClass(u.sFooterTH),null!==l)for(e=e.aoFooter[0],t=0,n=e.length;n>t;t++)s=h[t],s.nTf=e[t].cell,s.sClass&&i(s.nTf).addClass(s.sClass)}function R(e,t,r){var o,s,a,l,c=[],u=[],h=e.aoColumns.length;if(t){for(r===n&&(r=!1),o=0,s=t.length;s>o;o++){for(c[o]=t[o].slice(),c[o].nTr=t[o].nTr,a=h-1;a>=0;a--)!e.aoColumns[a].bVisible&&!r&&c[o].splice(a,1);u.push([])}for(o=0,s=c.length;s>o;o++){if(e=c[o].nTr)for(;a=e.firstChild;)e.removeChild(a);for(a=0,t=c[o].length;t>a;a++)if(l=h=1,u[o][a]===n){for(e.appendChild(c[o][a].cell),u[o][a]=1;c[o+h]!==n&&c[o][a].cell==c[o+h][a].cell;)u[o+h][a]=1,h++;for(;c[o][a+l]!==n&&c[o][a].cell==c[o][a+l].cell;){for(r=0;h>r;r++)u[o+r][a+l]=1;l++}i(c[o][a].cell).attr("rowspan",h).attr("colspan",l)}}}}function N(e){var t=je(e,"aoPreDrawCallback","preDraw",[e]);if(-1!==i.inArray(!1,t))de(e,!1);else{var t=[],r=0,o=e.asStripeClasses,s=o.length,a=e.oLanguage,l=e.iInitDisplayStart,c="ssp"==We(e),u=e.aiDisplay;e.bDrawing=!0,l!==n&&-1!==l&&(e._iDisplayStart=c?l:l>=e.fnRecordsDisplay()?0:l,e.iInitDisplayStart=-1);var l=e._iDisplayStart,h=e.fnDisplayEnd();if(e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++,de(e,!1);else if(c){if(!e.bDestroying&&!W(e))return}else e.iDraw++;if(0!==u.length)for(a=c?e.aoData.length:h,c=c?0:l;a>c;c++){var d=u[c],p=e.aoData[d];if(null===p.nTr&&I(e,d),d=p.nTr,0!==s){var f=o[r%s];p._sRowStripe!=f&&(i(d).removeClass(p._sRowStripe).addClass(f),p._sRowStripe=f)}je(e,"aoRowCallback",null,[d,p._aData,r,c]),t.push(d),r++}else r=a.sZeroRecords,1==e.iDraw&&"ajax"==We(e)?r=a.sLoadingRecords:a.sEmptyTable&&0===e.fnRecordsTotal()&&(r=a.sEmptyTable),t[0]=i("<tr/>",{"class":s?o[0]:""}).append(i("<td />",{valign:"top",colSpan:m(e),"class":e.oClasses.sRowEmpty}).html(r))[0];je(e,"aoHeaderCallback","header",[i(e.nTHead).children("tr")[0],T(e),l,h,u]),je(e,"aoFooterCallback","footer",[i(e.nTFoot).children("tr")[0],T(e),l,h,u]),o=i(e.nTBody),o.children().detach(),o.append(i(t)),je(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1}}function F(e,t){var n=e.oFeatures,i=n.bFilter;n.bSort&&ke(e),i?Y(e,e.oPreviousSearch):e.aiDisplay=e.aiDisplayMaster.slice(),!0!==t&&(e._iDisplayStart=0),e._drawHold=t,N(e),e._drawHold=!1}function L(e){var t=e.oClasses,n=i(e.nTable),n=i("<div/>").insertBefore(n),r=e.oFeatures,o=i("<div/>",{id:e.sTableId+"_wrapper","class":t.sWrapper+(e.nTFoot?"":" "+t.sNoFooter)});e.nHolding=n[0],e.nTableWrapper=o[0],e.nTableReinsertBefore=e.nTable.nextSibling;for(var s,a,l,c,u,h,d=e.sDom.split(""),p=0;p<d.length;p++){if(s=null,a=d[p],"<"==a){if(l=i("<div/>")[0],c=d[p+1],"'"==c||'"'==c){for(u="",h=2;d[p+h]!=c;)u+=d[p+h],h++;"H"==u?u=t.sJUIHeader:"F"==u&&(u=t.sJUIFooter),-1!=u.indexOf(".")?(c=u.split("."),l.id=c[0].substr(1,c[0].length-1),l.className=c[1]):"#"==u.charAt(0)?l.id=u.substr(1,u.length-1):l.className=u,p+=h}o.append(l),o=i(l)}else if(">"==a)o=o.parent();else if("l"==a&&r.bPaginate&&r.bLengthChange)s=le(e);else if("f"==a&&r.bFilter)s=V(e);else if("r"==a&&r.bProcessing)s=he(e);else if("t"==a)s=pe(e);else if("i"==a&&r.bInfo)s=ne(e);else if("p"==a&&r.bPaginate)s=ce(e);else if(0!==Ve.ext.feature.length)for(l=Ve.ext.feature,h=0,c=l.length;c>h;h++)if(a==l[h].cFeature){s=l[h].fnInit(e);break}s&&(l=e.aanFeatures,l[a]||(l[a]=[]),l[a].push(s),o.append(s))}n.replaceWith(o)}function j(e,t){var n,r,o,s,a,l,c,u,h,d,p=i(t).children("tr");for(e.splice(0,e.length),o=0,l=p.length;l>o;o++)e.push([]);for(o=0,l=p.length;l>o;o++)for(n=p[o],r=n.firstChild;r;){if("TD"==r.nodeName.toUpperCase()||"TH"==r.nodeName.toUpperCase()){for(u=1*r.getAttribute("colspan"),h=1*r.getAttribute("rowspan"),u=u&&0!==u&&1!==u?u:1,h=h&&0!==h&&1!==h?h:1,s=0,a=e[o];a[s];)s++;for(c=s,d=1===u?!0:!1,a=0;u>a;a++)for(s=0;h>s;s++)e[o+s][c+a]={cell:r,unique:d},e[o+s].nTr=n}r=r.nextSibling}}function U(e,t,n){var i=[];n||(n=e.aoHeader,t&&(n=[],j(n,t)));for(var t=0,r=n.length;r>t;t++)for(var o=0,s=n[t].length;s>o;o++)!n[t][o].unique||i[o]&&e.bSortCellsTop||(i[o]=n[t][o].cell);return i}function H(e,t,n){if(je(e,"aoServerParams","serverParams",[t]),t&&i.isArray(t)){var r={},o=/(.*?)\[\]$/;i.each(t,function(e,t){var n=t.name.match(o);n?(n=n[0],r[n]||(r[n]=[]),r[n].push(t.value)):r[t.name]=t.value}),t=r}var s,a=e.ajax,l=e.oInstance;if(i.isPlainObject(a)&&a.data){s=a.data;var c=i.isFunction(s)?s(t):s,t=i.isFunction(s)&&c?c:i.extend(!0,t,c);delete a.data}c={data:t,success:function(t){var i=t.error||t.sError;i&&e.oApi._fnLog(e,0,i),e.json=t,je(e,null,"xhr",[e,t]),n(t)},dataType:"json",cache:!1,type:e.sServerMethod,error:function(t,n){var i=e.oApi._fnLog;"parsererror"==n?i(e,0,"Invalid JSON response",1):4===t.readyState&&i(e,0,"Ajax error",7),de(e,!1)}},e.oAjaxData=t,je(e,null,"preXhr",[e,t]),e.fnServerData?e.fnServerData.call(l,e.sAjaxSource,i.map(t,function(e,t){return{name:t,value:e}}),n,e):e.sAjaxSource||"string"==typeof a?e.jqXHR=i.ajax(i.extend(c,{url:a||e.sAjaxSource})):i.isFunction(a)?e.jqXHR=a.call(l,t,n,e):(e.jqXHR=i.ajax(i.extend(c,a)),a.data=s)}function W(e){return e.bAjaxDataGet?(e.iDraw++,de(e,!0),H(e,B(e),function(t){z(e,t)}),!1):!0}function B(e){var t,n,r,o,s=e.aoColumns,a=s.length,l=e.oFeatures,c=e.oPreviousSearch,u=e.aoPreSearchCols,h=[],d=$e(e);t=e._iDisplayStart,n=!1!==l.bPaginate?e._iDisplayLength:-1;var p=function(e,t){h.push({name:e,value:t})};p("sEcho",e.iDraw),p("iColumns",a),p("sColumns",ct(s,"sName").join(",")),p("iDisplayStart",t),p("iDisplayLength",n);var f={draw:e.iDraw,columns:[],order:[],start:t,length:n,search:{value:c.sSearch,regex:c.bRegex}};for(t=0;a>t;t++)r=s[t],o=u[t],n="function"==typeof r.mData?"function":r.mData,f.columns.push({data:n,name:r.sName,searchable:r.bSearchable,orderable:r.bSortable,search:{value:o.sSearch,regex:o.bRegex}}),p("mDataProp_"+t,n),l.bFilter&&(p("sSearch_"+t,o.sSearch),p("bRegex_"+t,o.bRegex),p("bSearchable_"+t,r.bSearchable)),l.bSort&&p("bSortable_"+t,r.bSortable);return l.bFilter&&(p("sSearch",c.sSearch),p("bRegex",c.bRegex)),l.bSort&&(i.each(d,function(e,t){f.order.push({column:t.col,dir:t.dir}),p("iSortCol_"+e,t.col),p("sSortDir_"+e,t.dir)}),p("iSortingCols",d.length)),s=Ve.ext.legacy.ajax,null===s?e.sAjaxSource?h:f:s?h:f}function z(e,t){var i=t.sEcho!==n?t.sEcho:t.draw,r=t.iTotalRecords!==n?t.iTotalRecords:t.recordsTotal,o=t.iTotalDisplayRecords!==n?t.iTotalDisplayRecords:t.recordsFiltered;if(i){if(1*i<e.iDraw)return;e.iDraw=1*i}for(E(e),e._iRecordsTotal=parseInt(r,10),e._iRecordsDisplay=parseInt(o,10),i=q(e,t),r=0,o=i.length;o>r;r++)w(e,i[r]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,N(e),e._bInitComplete||se(e,t),e.bAjaxDataGet=!0,de(e,!1)}function q(e,t){var r=i.isPlainObject(e.ajax)&&e.ajax.dataSrc!==n?e.ajax.dataSrc:e.sAjaxDataProp;return"data"===r?t.aaData||t[r]:""!==r?k(r)(t):t}function V(e){var n=e.oClasses,r=e.sTableId,o=e.oLanguage,s=e.oPreviousSearch,a=e.aanFeatures,l='<input type="search" class="'+n.sFilterInput+'"/>',c=o.sSearch,c=c.match(/_INPUT_/)?c.replace("_INPUT_",l):c+l,n=i("<div/>",{id:a.f?null:r+"_filter","class":n.sFilter}).append(i("<label/>").append(c)),a=function(){var t=this.value?this.value:"";t!=s.sSearch&&(Y(e,{sSearch:t,bRegex:s.bRegex,bSmart:s.bSmart,bCaseInsensitive:s.bCaseInsensitive}),e._iDisplayStart=0,N(e))},u=i("input",n).val(s.sSearch).attr("placeholder",o.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT","ssp"===We(e)?ve(a,400):a).bind("keypress.DT",function(e){return 13==e.keyCode?!1:void 0}).attr("aria-controls",r);return i(e.nTable).on("search.dt.DT",function(n,i){if(e===i)try{u[0]!==t.activeElement&&u.val(s.sSearch)}catch(r){}}),n[0]}function Y(e,t,i){var r=e.oPreviousSearch,o=e.aoPreSearchCols,s=function(e){r.sSearch=e.sSearch,r.bRegex=e.bRegex,r.bSmart=e.bSmart,r.bCaseInsensitive=e.bCaseInsensitive};if(b(e),"ssp"!=We(e)){for(X(e,t.sSearch,i,t.bEscapeRegex!==n?!t.bEscapeRegex:t.bRegex,t.bSmart,t.bCaseInsensitive),s(t),t=0;t<o.length;t++)K(e,o[t].sSearch,t,o[t].bEscapeRegex!==n?!o[t].bEscapeRegex:o[t].bRegex,o[t].bSmart,o[t].bCaseInsensitive);G(e)}else s(t);e.bFiltered=!0,je(e,null,"search",[e])}function G(e){for(var t,n,i=Ve.ext.search,r=e.aiDisplay,o=0,s=i.length;s>o;o++){for(var a=[],l=0,c=r.length;c>l;l++)n=r[l],t=e.aoData[n],i[o](e,t._aFilterData,n,t._aData,l)&&a.push(n);r.length=0,r.push.apply(r,a)}}function K(e,t,n,i,r,o){if(""!==t)for(var s=e.aiDisplay,i=Q(t,i,r,o),r=s.length-1;r>=0;r--)t=e.aoData[s[r]]._aFilterData[n],i.test(t)||s.splice(r,1)}function X(e,t,n,i,r,o){var s,i=Q(t,i,r,o),r=e.oPreviousSearch.sSearch,o=e.aiDisplayMaster;if(0!==Ve.ext.search.length&&(n=!0),s=Z(e),0>=t.length)e.aiDisplay=o.slice();else for((s||n||r.length>t.length||0!==t.indexOf(r)||e.bSorted)&&(e.aiDisplay=o.slice()),t=e.aiDisplay,n=t.length-1;n>=0;n--)i.test(e.aoData[t[n]]._sFilterRow)||t.splice(n,1)}function Q(e,t,n,r){return e=t?e:J(e),n&&(e="^(?=.*?"+i.map(e.match(/"[^"]+"|[^ ]+/g)||"",function(e){return'"'===e.charAt(0)?e.match(/^"(.*)"$/)[1]:e}).join(")(?=.*?")+").*$"),RegExp(e,r?"i":"")}function J(e){return e.replace(nt,"\\$1")}function Z(e){var t,n,i,r,o,s,a,l,c=e.aoColumns,u=Ve.ext.type.search;for(t=!1,n=0,r=e.aoData.length;r>n;n++)if(l=e.aoData[n],!l._aFilterData){for(s=[],i=0,o=c.length;o>i;i++)t=c[i],t.bSearchable?(a=x(e,n,i,"filter"),u[t.sType]&&(a=u[t.sType](a)),null===a&&(a=""),"string"!=typeof a&&a.toString&&(a=a.toString())):a="",a.indexOf&&-1!==a.indexOf("&")&&(mt.innerHTML=a,a=vt?mt.textContent:mt.innerText),a.replace&&(a=a.replace(/[\r\n]/g,"")),s.push(a);l._aFilterData=s,l._sFilterRow=s.join("  "),t=!0}return t}function ee(e){return{search:e.sSearch,smart:e.bSmart,regex:e.bRegex,caseInsensitive:e.bCaseInsensitive}}function te(e){return{sSearch:e.search,bSmart:e.smart,bRegex:e.regex,bCaseInsensitive:e.caseInsensitive}}function ne(e){var t=e.sTableId,n=e.aanFeatures.i,r=i("<div/>",{"class":e.oClasses.sInfo,id:n?null:t+"_info"});return n||(e.aoDrawCallback.push({fn:ie,sName:"information"}),r.attr("role","status").attr("aria-live","polite"),i(e.nTable).attr("aria-describedby",t+"_info")),r[0]}function ie(e){var t=e.aanFeatures.i;if(0!==t.length){var n=e.oLanguage,r=e._iDisplayStart+1,o=e.fnDisplayEnd(),s=e.fnRecordsTotal(),a=e.fnRecordsDisplay(),l=a?n.sInfo:n.sInfoEmpty;a!==s&&(l+=" "+n.sInfoFiltered),l+=n.sInfoPostFix,l=re(e,l),n=n.fnInfoCallback,null!==n&&(l=n.call(e.oInstance,e,r,o,s,a,l)),i(t).html(l)}}function re(e,t){var n=e.fnFormatNumber,i=e._iDisplayStart+1,r=e._iDisplayLength,o=e.fnRecordsDisplay(),s=-1===r;return t.replace(/_START_/g,n.call(e,i)).replace(/_END_/g,n.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,n.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(e,o)).replace(/_PAGE_/g,n.call(e,s?1:Math.ceil(i/r))).replace(/_PAGES_/g,n.call(e,s?1:Math.ceil(o/r)))}function oe(e){var t,n,i,r=e.iInitDisplayStart,o=e.aoColumns;if(n=e.oFeatures,e.bInitialised){for(L(e),P(e),R(e,e.aoHeader),R(e,e.aoFooter),de(e,!0),n.bAutoWidth&&me(e),t=0,n=o.length;n>t;t++)i=o[t],i.sWidth&&(i.nTh.style.width=xe(i.sWidth));F(e),o=We(e),"ssp"!=o&&("ajax"==o?H(e,[],function(n){var i=q(e,n);for(t=0;t<i.length;t++)w(e,i[t]);e.iInitDisplayStart=r,F(e),de(e,!1),se(e,n)},e):(de(e,!1),se(e)))}else setTimeout(function(){oe(e)},200)}function se(e,t){e._bInitComplete=!0,t&&p(e),je(e,"aoInitComplete","init",[e,t])}function ae(e,t){var n=parseInt(t,10);e._iDisplayLength=n,Ue(e),je(e,null,"length",[e,n])}function le(e){for(var t=e.oClasses,n=e.sTableId,r=e.aLengthMenu,o=i.isArray(r[0]),s=o?r[0]:r,r=o?r[1]:r,o=i("<select/>",{name:n+"_length","aria-controls":n,"class":t.sLengthSelect}),a=0,l=s.length;l>a;a++)o[0][a]=new Option(r[a],s[a]);var c=i("<div><label/></div>").addClass(t.sLength);return e.aanFeatures.l||(c[0].id=n+"_length"),c.children().append(e.oLanguage.sLengthMenu.replace("_MENU_",o[0].outerHTML)),i("select",c).val(e._iDisplayLength).bind("change.DT",function(){ae(e,i(this).val()),N(e)}),i(e.nTable).bind("length.dt.DT",function(t,n,r){e===n&&i("select",c).val(r)}),c[0]}function ce(e){var t=e.sPaginationType,n=Ve.ext.pager[t],r="function"==typeof n,o=function(e){N(e)},t=i("<div/>").addClass(e.oClasses.sPaging+t)[0],s=e.aanFeatures;return r||n.fnInit(e,t,o),s.p||(t.id=e.sTableId+"_paginate",e.aoDrawCallback.push({fn:function(e){if(r){var t,i=e._iDisplayStart,a=e._iDisplayLength,l=e.fnRecordsDisplay(),c=-1===a,i=c?0:Math.ceil(i/a),a=c?1:Math.ceil(l/a),l=n(i,a),c=0;for(t=s.p.length;t>c;c++)He(e,"pageButton")(e,s.p[c],c,l,i,a)}else n.fnUpdate(e,o)},sName:"pagination"})),t}function ue(e,t,n){var i=e._iDisplayStart,r=e._iDisplayLength,o=e.fnRecordsDisplay();return 0===o||-1===r?i=0:"number"==typeof t?(i=t*r,i>o&&(i=0)):"first"==t?i=0:"previous"==t?(i=r>=0?i-r:0,0>i&&(i=0)):"next"==t?o>i+r&&(i+=r):"last"==t?i=Math.floor((o-1)/r)*r:Pe(e,0,"Unknown paging action: "+t,5),t=e._iDisplayStart!==i,e._iDisplayStart=i,t&&(je(e,null,"page",[e]),n&&N(e)),t}function he(e){return i("<div/>",{id:e.aanFeatures.r?null:e.sTableId+"_processing","class":e.oClasses.sProcessing}).html(e.oLanguage.sProcessing).insertBefore(e.nTable)[0]}function de(e,t){e.oFeatures.bProcessing&&i(e.aanFeatures.r).css("display",t?"block":"none"),je(e,null,"processing",[e,t])}function pe(e){var t=i(e.nTable);t.attr("role","grid");var n=e.oScroll;
if(""===n.sX&&""===n.sY)return e.nTable;var r=n.sX,o=n.sY,s=e.oClasses,a=t.children("caption"),l=a.length?a[0]._captionSide:null,c=i(t[0].cloneNode(!1)),u=i(t[0].cloneNode(!1)),h=t.children("tfoot");n.sX&&"100%"===t.attr("width")&&t.removeAttr("width"),h.length||(h=null),n=i("<div/>",{"class":s.sScrollWrapper}).append(i("<div/>",{"class":s.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:r?r?xe(r):null:"100%"}).append(i("<div/>",{"class":s.sScrollHeadInner}).css({"box-sizing":"content-box",width:n.sXInner||"100%"}).append(c.removeAttr("id").css("margin-left",0).append(t.children("thead")))).append("top"===l?a:null)).append(i("<div/>",{"class":s.sScrollBody}).css({overflow:"auto",height:o?xe(o):null,width:r?xe(r):null}).append(t)),h&&n.append(i("<div/>",{"class":s.sScrollFoot}).css({overflow:"hidden",border:0,width:r?r?xe(r):null:"100%"}).append(i("<div/>",{"class":s.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",0).append(t.children("tfoot")))).append("bottom"===l?a:null));var t=n.children(),d=t[0],s=t[1],p=h?t[2]:null;return r&&i(s).scroll(function(){var e=this.scrollLeft;d.scrollLeft=e,h&&(p.scrollLeft=e)}),e.nScrollHead=d,e.nScrollBody=s,e.nScrollFoot=p,e.aoDrawCallback.push({fn:fe,sName:"scrolling"}),n[0]}function fe(e){var t,n,r,o,s,a,l=e.oScroll,c=l.sX,u=l.sXInner,h=l.sY,d=l.iBarWidth,p=i(e.nScrollHead),g=p[0].style,m=p.children("div"),v=m[0].style,b=m.children("table"),m=e.nScrollBody,y=i(m),w=m.style,_=i(e.nScrollFoot).children("div"),x=_.children("table"),C=i(e.nTHead),$=i(e.nTable),k=$[0],S=k.style,T=e.nTFoot?i(e.nTFoot):null,E=e.oBrowser,D=E.bScrollOversize,A=[],O=[],I=[],M=function(e){e=e.style,e.paddingTop="0",e.paddingBottom="0",e.borderTopWidth="0",e.borderBottomWidth="0",e.height=0};$.children("thead, tfoot").remove(),s=C.clone().prependTo($),t=C.find("tr"),r=s.find("tr"),s.find("th, td").removeAttr("tabindex"),T&&(o=T.clone().prependTo($),n=T.find("tr"),o=o.find("tr")),c||(w.width="100%",p[0].style.width="100%"),i.each(U(e,s),function(t,n){a=f(e,t),n.style.width=e.aoColumns[a].sWidth}),T&&ge(function(e){e.style.width=""},o),l.bCollapse&&""!==h&&(w.height=y[0].offsetHeight+C[0].offsetHeight+"px"),p=$.outerWidth(),""===c?(S.width="100%",D&&($.find("tbody").height()>m.offsetHeight||"scroll"==y.css("overflow-y"))&&(S.width=xe($.outerWidth()-d))):""!==u?S.width=xe(u):p==y.width()&&y.height()<$.height()?(S.width=xe(p-d),$.outerWidth()>p-d&&(S.width=xe(p))):S.width=xe(p),p=$.outerWidth(),ge(M,r),ge(function(e){I.push(e.innerHTML),A.push(xe(i(e).css("width")))},r),ge(function(e,t){e.style.width=A[t]},t),i(r).height(0),T&&(ge(M,o),ge(function(e){O.push(xe(i(e).css("width")))},o),ge(function(e,t){e.style.width=O[t]},n),i(o).height(0)),ge(function(e,t){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+I[t]+"</div>",e.style.width=A[t]},r),T&&ge(function(e,t){e.innerHTML="",e.style.width=O[t]},o),$.outerWidth()<p?(n=m.scrollHeight>m.offsetHeight||"scroll"==y.css("overflow-y")?p+d:p,D&&(m.scrollHeight>m.offsetHeight||"scroll"==y.css("overflow-y"))&&(S.width=xe(n-d)),(""===c||""!==u)&&Pe(e,1,"Possible column misalignment",6)):n="100%",w.width=xe(n),g.width=xe(n),T&&(e.nScrollFoot.style.width=xe(n)),!h&&D&&(w.height=xe(k.offsetHeight+d)),h&&l.bCollapse&&(w.height=xe(h),l=c&&k.offsetWidth>m.offsetWidth?d:0,k.offsetHeight<m.offsetHeight&&(w.height=xe(k.offsetHeight+l))),l=$.outerWidth(),b[0].style.width=xe(l),v.width=xe(l),b=$.height()>m.clientHeight||"scroll"==y.css("overflow-y"),E="padding"+(E.bScrollbarLeft?"Left":"Right"),v[E]=b?d+"px":"0px",T&&(x[0].style.width=xe(l),_[0].style.width=xe(l),_[0].style[E]=b?d+"px":"0px"),y.scroll(),!e.bSorted&&!e.bFiltered||e._drawHold||(m.scrollTop=0)}function ge(e,t,n){for(var i,r,o=0,s=0,a=t.length;a>s;){for(i=t[s].firstChild,r=n?n[s].firstChild:null;i;)1===i.nodeType&&(n?e(i,r,o):e(i,o),o++),i=i.nextSibling,r=n?r.nextSibling:null;s++}}function me(t){var n,r,o=t.nTable,s=t.aoColumns,a=t.oScroll,l=a.sY,c=a.sX,u=a.sXInner,h=s.length,a=v(t,"bVisible"),d=i("th",t.nTHead),f=o.getAttribute("width"),g=o.parentNode,b=!1;for(n=0;n<a.length;n++)r=s[a[n]],null!==r.sWidth&&(r.sWidth=be(r.sWidthOrig,g),b=!0);if(b||c||l||h!=m(t)||h!=d.length){h=i(o).clone().empty().css("visibility","hidden").removeAttr("id").append(i(t.nTHead).clone(!1)).append(i(t.nTFoot).clone(!1)).append(i("<tbody><tr/></tbody>")),h.find("tfoot th, tfoot td").css("width","");var y=h.find("tbody tr"),d=U(t,h.find("thead")[0]);for(n=0;n<a.length;n++)r=s[a[n]],d[n].style.width=null!==r.sWidthOrig&&""!==r.sWidthOrig?xe(r.sWidthOrig):"";if(t.aoData.length)for(n=0;n<a.length;n++)b=a[n],r=s[b],i(we(t,b)).clone(!1).append(r.sContentPadding).appendTo(y);if(h.appendTo(g),c&&u?h.width(u):c?(h.css("width","auto"),h.width()<g.offsetWidth&&h.width(g.offsetWidth)):l?h.width(g.offsetWidth):f&&h.width(f),ye(t,h[0]),c){for(n=u=0;n<a.length;n++)r=s[a[n]],l=i(d[n]).outerWidth(),u+=null===r.sWidthOrig?l:parseInt(r.sWidth,10)+l-i(d[n]).width();h.width(xe(u)),o.style.width=xe(u)}for(n=0;n<a.length;n++)r=s[a[n]],(l=i(d[n]).width())&&(r.sWidth=xe(l));o.style.width=xe(h.css("width")),h.remove()}else for(n=0;h>n;n++)s[n].sWidth=xe(d.eq(n).width());f&&(o.style.width=xe(f)),!f&&!c||t._reszEvt||(i(e).bind("resize.DT-"+t.sInstance,ve(function(){p(t)})),t._reszEvt=!0)}function ve(e,t){var i,r,o=t||200;return function(){var t=this,s=+new Date,a=arguments;i&&i+o>s?(clearTimeout(r),r=setTimeout(function(){i=n,e.apply(t,a)},o)):i?(i=s,e.apply(t,a)):i=s}}function be(e,n){if(!e)return 0;var r=i("<div/>").css("width",xe(e)).appendTo(n||t.body),o=r[0].offsetWidth;return r.remove(),o}function ye(e,t){var n=e.oScroll;(n.sX||n.sY)&&(n=n.sX?0:n.iBarWidth,t.style.width=xe(i(t).outerWidth()-n))}function we(e,t){var n=_e(e,t);if(0>n)return null;var r=e.aoData[n];return r.nTr?r.anCells[t]:i("<td/>").html(x(e,n,t,"display"))[0]}function _e(e,t){for(var n,i=-1,r=-1,o=0,s=e.aoData.length;s>o;o++)n=x(e,o,t,"display")+"",n=n.replace(bt,""),n.length>i&&(i=n.length,r=o);return r}function xe(e){return null===e?"0px":"number"==typeof e?0>e?"0px":e+"px":e.match(/\d$/)?e+"px":e}function Ce(){if(!Ve.__scrollbarWidth){var e=i("<p/>").css({width:"100%",height:200,padding:0})[0],t=i("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(e).appendTo("body"),n=e.offsetWidth;t.css("overflow","scroll"),e=e.offsetWidth,n===e&&(e=t[0].clientWidth),t.remove(),Ve.__scrollbarWidth=n-e}return Ve.__scrollbarWidth}function $e(e){var t,n,r,o,s,a,l=[],c=e.aoColumns;t=e.aaSortingFixed,n=i.isPlainObject(t);var u=[];for(r=function(e){e.length&&!i.isArray(e[0])?u.push(e):u.push.apply(u,e)},i.isArray(t)&&r(t),n&&t.pre&&r(t.pre),r(e.aaSorting),n&&t.post&&r(t.post),e=0;e<u.length;e++)for(a=u[e][0],r=c[a].aDataSort,t=0,n=r.length;n>t;t++)o=r[t],s=c[o].sType||"string",l.push({src:a,col:o,dir:u[e][1],index:u[e][2],type:s,formatter:Ve.ext.type.order[s+"-pre"]});return l}function ke(e){var t,n,i,r,o=[],s=Ve.ext.type.order,a=e.aoData,l=0,c=e.aiDisplayMaster;for(b(e),r=$e(e),t=0,n=r.length;n>t;t++)i=r[t],i.formatter&&l++,Ae(e,i.col);if("ssp"!=We(e)&&0!==r.length){for(t=0,n=c.length;n>t;t++)o[c[t]]=t;c.sort(l===r.length?function(e,t){var n,i,s,l,c=r.length,u=a[e]._aSortData,h=a[t]._aSortData;for(s=0;c>s;s++)if(l=r[s],n=u[l.col],i=h[l.col],n=i>n?-1:n>i?1:0,0!==n)return"asc"===l.dir?n:-n;return n=o[e],i=o[t],i>n?-1:n>i?1:0}:function(e,t){var n,i,l,c,u=r.length,h=a[e]._aSortData,d=a[t]._aSortData;for(l=0;u>l;l++)if(c=r[l],n=h[c.col],i=d[c.col],c=s[c.type+"-"+c.dir]||s["string-"+c.dir],n=c(n,i),0!==n)return n;return n=o[e],i=o[t],i>n?-1:n>i?1:0})}e.bSorted=!0}function Se(e){for(var t,n,i=e.aoColumns,r=$e(e),e=e.oLanguage.oAria,o=0,s=i.length;s>o;o++){n=i[o];var a=n.asSorting;t=n.sTitle.replace(/<.*?>/g,"");var l=n.nTh;l.removeAttribute("aria-sort"),n.bSortable&&(0<r.length&&r[0].col==o?(l.setAttribute("aria-sort","asc"==r[0].dir?"ascending":"descending"),n=a[r[0].index+1]||a[0]):n=a[0],t+="asc"===n?e.sSortAscending:e.sSortDescending),l.setAttribute("aria-label",t)}}function Te(e,t,r,o){var s=e.aaSorting,a=e.aoColumns[t].asSorting,l=function(e){var t=e._idx;return t===n&&(t=i.inArray(e[1],a)),t+1>=a.length?0:t+1};"number"==typeof s[0]&&(s=e.aaSorting=[s]),r&&e.oFeatures.bSortMulti?(r=i.inArray(t,ct(s,"0")),-1!==r?(t=l(s[r]),s[r][1]=a[t],s[r]._idx=t):(s.push([t,a[0],0]),s[s.length-1]._idx=0)):s.length&&s[0][0]==t?(t=l(s[0]),s.length=1,s[0][1]=a[t],s[0]._idx=t):(s.length=0,s.push([t,a[0]]),s[0]._idx=0),F(e),"function"==typeof o&&o(e)}function Ee(e,t,n,i){var r=e.aoColumns[n];Fe(t,{},function(t){!1!==r.bSortable&&(e.oFeatures.bProcessing?(de(e,!0),setTimeout(function(){Te(e,n,t.shiftKey,i),"ssp"!==We(e)&&de(e,!1)},0)):Te(e,n,t.shiftKey,i))})}function De(e){var t,n,r=e.aLastSort,o=e.oClasses.sSortColumn,s=$e(e),a=e.oFeatures;if(a.bSort&&a.bSortClasses){for(a=0,t=r.length;t>a;a++)n=r[a].src,i(ct(e.aoData,"anCells",n)).removeClass(o+(2>a?a+1:3));for(a=0,t=s.length;t>a;a++)n=s[a].src,i(ct(e.aoData,"anCells",n)).addClass(o+(2>a?a+1:3))}e.aLastSort=s}function Ae(e,t){var n,i=e.aoColumns[t],r=Ve.ext.order[i.sSortDataType];r&&(n=r.call(e.oInstance,e,t,g(e,t)));for(var o,s=Ve.ext.type.order[i.sType+"-pre"],a=0,l=e.aoData.length;l>a;a++)i=e.aoData[a],i._aSortData||(i._aSortData=[]),(!i._aSortData[t]||r)&&(o=r?n[a]:x(e,a,t,"sort"),i._aSortData[t]=s?s(o):o)}function Oe(e){if(e.oFeatures.bStateSave&&!e.bDestroying){var t={time:+new Date,start:e._iDisplayStart,length:e._iDisplayLength,order:i.extend(!0,[],e.aaSorting),search:ee(e.oPreviousSearch),columns:i.map(e.aoColumns,function(t,n){return{visible:t.bVisible,search:ee(e.aoPreSearchCols[n])}})};je(e,"aoStateSaveParams","stateSaveParams",[e,t]),e.oSavedState=t,e.fnStateSaveCallback.call(e.oInstance,e,t)}}function Ie(e){var t,n,r=e.aoColumns;if(e.oFeatures.bStateSave){var o=e.fnStateLoadCallback.call(e.oInstance,e);if(o&&o.time&&(t=je(e,"aoStateLoadParams","stateLoadParams",[e,o]),-1===i.inArray(!1,t)&&(t=e.iStateDuration,!(t>0&&o.time<+new Date-1e3*t)&&r.length===o.columns.length))){for(e.oLoadedState=i.extend(!0,{},o),e._iDisplayStart=o.start,e.iInitDisplayStart=o.start,e._iDisplayLength=o.length,e.aaSorting=[],i.each(o.order,function(t,n){e.aaSorting.push(n[0]>=r.length?[0,n[1]]:n)}),i.extend(e.oPreviousSearch,te(o.search)),t=0,n=o.columns.length;n>t;t++){var s=o.columns[t];r[t].bVisible=s.visible,i.extend(e.aoPreSearchCols[t],te(s.search))}je(e,"aoStateLoaded","stateLoaded",[e,o])}}}function Me(e){var t=Ve.settings,e=i.inArray(e,ct(t,"nTable"));return-1!==e?t[e]:null}function Pe(t,n,i,r){if(i="DataTables warning: "+(null!==t?"table id="+t.sTableId+" - ":"")+i,r&&(i+=". For more information about this error, please see http://datatables.net/tn/"+r),n)e.console&&console.log&&console.log(i);else{if(t=Ve.ext,"alert"!=(t.sErrMode||t.errMode))throw Error(i);alert(i)}}function Re(e,t,r,o){i.isArray(r)?i.each(r,function(n,r){i.isArray(r)?Re(e,t,r[0],r[1]):Re(e,t,r)}):(o===n&&(o=r),t[r]!==n&&(e[o]=t[r]))}function Ne(e,t,n){var r,o;for(o in t)t.hasOwnProperty(o)&&(r=t[o],i.isPlainObject(r)?(i.isPlainObject(e[o])||(e[o]={}),i.extend(!0,e[o],r)):e[o]=n&&"data"!==o&&"aaData"!==o&&i.isArray(r)?r.slice():r);return e}function Fe(e,t,n){i(e).bind("click.DT",t,function(t){e.blur(),n(t)}).bind("keypress.DT",t,function(e){13===e.which&&(e.preventDefault(),n(e))}).bind("selectstart.DT",function(){return!1})}function Le(e,t,n,i){n&&e[t].push({fn:n,sName:i})}function je(e,t,n,r){var o=[];return t&&(o=i.map(e[t].slice().reverse(),function(t){return t.fn.apply(e.oInstance,r)})),null!==n&&i(e.nTable).trigger(n+".dt",r),o}function Ue(e){var t=e._iDisplayStart,n=e.fnDisplayEnd(),i=e._iDisplayLength;n===e.fnRecordsDisplay()&&(t=n-i),(-1===i||0>t)&&(t=0),e._iDisplayStart=t}function He(e,t){var n=e.renderer,r=Ve.ext.renderer[t];return i.isPlainObject(n)&&n[t]?r[n[t]]||r._:"string"==typeof n?r[n]||r._:r._}function We(e){return e.oFeatures.bServerSide?"ssp":e.ajax||e.sAjaxSource?"ajax":"dom"}function Be(e,t){var n=[],n=Pt.numbers_length,i=Math.floor(n/2);return n>=t?n=ht(0,t):i>=e?(n=ht(0,n-2),n.push("ellipsis"),n.push(t-1)):(e>=t-1-i?n=ht(t-(n-2),t):(n=ht(e-1,e+2),n.push("ellipsis"),n.push(t-1)),n.splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}function ze(e){i.each({num:function(t){return Rt(t,e)},"num-fmt":function(t){return Rt(t,e,it)},"html-num":function(t){return Rt(t,e,Ze)},"html-num-fmt":function(t){return Rt(t,e,Ze,it)}},function(t,n){Ye.type.order[t+e+"-pre"]=n})}function qe(e){return function(){var t=[Me(this[Ve.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return Ve.ext.internal[e].apply(this,t)}}var Ve,Ye,Ge,Ke,Xe,Qe={},Je=/[\r\n]/g,Ze=/<.*?>/g,et=/^[\w\+\-]/,tt=/[\w\+\-]$/,nt=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^|\\-)","g"),it=/[',$\u00a3\u20ac\u00a5%\u2009\u202F]/g,rt=function(e){return e&&!0!==e&&"-"!==e?!1:!0},ot=function(e){var t=parseInt(e,10);return!isNaN(t)&&isFinite(e)?t:null},st=function(e,t){return Qe[t]||(Qe[t]=RegExp(J(t),"g")),"string"==typeof e?e.replace(/\./g,"").replace(Qe[t],"."):e},at=function(e,t,n){var i="string"==typeof e;return t&&i&&(e=st(e,t)),n&&i&&(e=e.replace(it,"")),rt(e)||!isNaN(parseFloat(e))&&isFinite(e)},lt=function(e,t,n){return rt(e)?!0:(rt(e)||"string"==typeof e)&&at(e.replace(Ze,""),t,n)?!0:null},ct=function(e,t,i){var r=[],o=0,s=e.length;if(i!==n)for(;s>o;o++)e[o]&&e[o][t]&&r.push(e[o][t][i]);else for(;s>o;o++)e[o]&&r.push(e[o][t]);return r},ut=function(e,t,i,r){var o=[],s=0,a=t.length;if(r!==n)for(;a>s;s++)o.push(e[t[s]][i][r]);else for(;a>s;s++)o.push(e[t[s]][i]);return o},ht=function(e,t){var i,r=[];t===n?(t=0,i=e):(i=t,t=e);for(var o=t;i>o;o++)r.push(o);return r},dt=function(e){var t,n,i,r=[],o=e.length,s=0;n=0;e:for(;o>n;n++){for(t=e[n],i=0;s>i;i++)if(r[i]===t)continue e;r.push(t),s++}return r},pt=function(e,t,i){e[t]!==n&&(e[i]=e[t])},ft=/\[.*?\]$/,gt=/\(\)$/,mt=i("<div>")[0],vt=mt.textContent!==n,bt=/<.*?>/g;Ve=function(e){this.$=function(e,t){return this.api(!0).$(e,t)},this._=function(e,t){return this.api(!0).rows(e,t).data()},this.api=function(e){return new Ge(e?Me(this[Ye.iApiIndex]):this)},this.fnAddData=function(e,t){var r=this.api(!0),o=i.isArray(e)&&(i.isArray(e[0])||i.isPlainObject(e[0]))?r.rows.add(e):r.row.add(e);return(t===n||t)&&r.draw(),o.flatten().toArray()},this.fnAdjustColumnSizing=function(e){var t=this.api(!0).columns.adjust(),i=t.settings()[0],r=i.oScroll;e===n||e?t.draw(!1):(""!==r.sX||""!==r.sY)&&fe(i)},this.fnClearTable=function(e){var t=this.api(!0).clear();(e===n||e)&&t.draw()},this.fnClose=function(e){this.api(!0).row(e).child.hide()},this.fnDeleteRow=function(e,t,i){var r=this.api(!0),e=r.rows(e),o=e.settings()[0],s=o.aoData[e[0][0]];return e.remove(),t&&t.call(this,o,s),(i===n||i)&&r.draw(),s},this.fnDestroy=function(e){this.api(!0).destroy(e)},this.fnDraw=function(e){this.api(!0).draw(!e)},this.fnFilter=function(e,t,i,r,o,s){o=this.api(!0),null===t||t===n?o.search(e,i,r,s):o.column(t).search(e,i,r,s),o.draw()},this.fnGetData=function(e,t){var i=this.api(!0);if(e!==n){var r=e.nodeName?e.nodeName.toLowerCase():"";return t!==n||"td"==r||"th"==r?i.cell(e,t).data():i.row(e).data()||null}return i.data().toArray()},this.fnGetNodes=function(e){var t=this.api(!0);return e!==n?t.row(e).node():t.rows().nodes().flatten().toArray()},this.fnGetPosition=function(e){var t=this.api(!0),n=e.nodeName.toUpperCase();return"TR"==n?t.row(e).index():"TD"==n||"TH"==n?(e=t.cell(e).index(),[e.row,e.columnVisible,e.column]):null},this.fnIsOpen=function(e){return this.api(!0).row(e).child.isShown()},this.fnOpen=function(e,t,n){return this.api(!0).row(e).child(t,n).show().child()[0]},this.fnPageChange=function(e,t){var i=this.api(!0).page(e);(t===n||t)&&i.draw(!1)},this.fnSetColumnVis=function(e,t,i){e=this.api(!0).column(e).visible(t),(i===n||i)&&e.columns.adjust().draw()},this.fnSettings=function(){return Me(this[Ye.iApiIndex])},this.fnSort=function(e){this.api(!0).order(e).draw()},this.fnSortListener=function(e,t,n){this.api(!0).order.listener(e,t,n)},this.fnUpdate=function(e,t,i,r,o){var s=this.api(!0);return i===n||null===i?s.row(t).data(e):s.cell(t,i).data(e),(o===n||o)&&s.columns.adjust(),(r===n||r)&&s.draw(),0},this.fnVersionCheck=Ye.fnVersionCheck;var t=this,r=e===n,u=this.length;r&&(e={}),this.oApi=this.internal=Ye.internal;for(var p in Ve.ext.internal)p&&(this[p]=qe(p));return this.each(function(){var p,f={},g=u>1?Ne(f,e,!0):e,m=0,v=this.getAttribute("id"),f=!1,b=Ve.defaults;if("table"!=this.nodeName.toLowerCase())Pe(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{a(b),l(b.column),o(b,b,!0),o(b.column,b.column,!0),o(b,g);var x=Ve.settings,m=0;for(p=x.length;p>m;m++){if(x[m].nTable==this){if(p=g.bRetrieve!==n?g.bRetrieve:b.bRetrieve,r||p)return x[m].oInstance;if(g.bDestroy!==n?g.bDestroy:b.bDestroy){x[m].oInstance.fnDestroy();break}return void Pe(x[m],0,"Cannot reinitialise DataTable",3)}if(x[m].sTableId==this.id){x.splice(m,1);break}}(null===v||""===v)&&(this.id=v="DataTables_Table_"+Ve.ext._unique++);var C=i.extend(!0,{},Ve.models.oSettings,{nTable:this,oApi:t.internal,oInit:g,sDestroyWidth:i(this)[0].style.width,sInstance:v,sTableId:v});x.push(C),C.oInstance=1===t.length?t:i(this).dataTable(),a(g),g.oLanguage&&s(g.oLanguage),g.aLengthMenu&&!g.iDisplayLength&&(g.iDisplayLength=i.isArray(g.aLengthMenu[0])?g.aLengthMenu[0][0]:g.aLengthMenu[0]),g=Ne(i.extend(!0,{},b),g),Re(C.oFeatures,g,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" ")),Re(C,g,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),Re(C.oScroll,g,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Re(C.oLanguage,g,"fnInfoCallback"),Le(C,"aoDrawCallback",g.fnDrawCallback,"user"),Le(C,"aoServerParams",g.fnServerParams,"user"),Le(C,"aoStateSaveParams",g.fnStateSaveParams,"user"),Le(C,"aoStateLoadParams",g.fnStateLoadParams,"user"),Le(C,"aoStateLoaded",g.fnStateLoaded,"user"),Le(C,"aoRowCallback",g.fnRowCallback,"user"),Le(C,"aoRowCreatedCallback",g.fnCreatedRow,"user"),Le(C,"aoHeaderCallback",g.fnHeaderCallback,"user"),Le(C,"aoFooterCallback",g.fnFooterCallback,"user"),Le(C,"aoInitComplete",g.fnInitComplete,"user"),Le(C,"aoPreDrawCallback",g.fnPreDrawCallback,"user"),v=C.oClasses,g.bJQueryUI?(i.extend(v,Ve.ext.oJUIClasses,g.oClasses),g.sDom===b.sDom&&"lfrtip"===b.sDom&&(C.sDom='<"H"lfr>t<"F"ip>'),C.renderer?i.isPlainObject(C.renderer)&&!C.renderer.header&&(C.renderer.header="jqueryui"):C.renderer="jqueryui"):i.extend(v,Ve.ext.classes,g.oClasses),i(this).addClass(v.sTable),(""!==C.oScroll.sX||""!==C.oScroll.sY)&&(C.oScroll.iBarWidth=Ce()),!0===C.oScroll.sX&&(C.oScroll.sX="100%"),C.iInitDisplayStart===n&&(C.iInitDisplayStart=g.iDisplayStart,C._iDisplayStart=g.iDisplayStart),null!==g.iDeferLoading&&(C.bDeferLoading=!0,m=i.isArray(g.iDeferLoading),C._iRecordsDisplay=m?g.iDeferLoading[0]:g.iDeferLoading,C._iRecordsTotal=m?g.iDeferLoading[1]:g.iDeferLoading),""!==g.oLanguage.sUrl?(C.oLanguage.sUrl=g.oLanguage.sUrl,i.getJSON(C.oLanguage.sUrl,null,function(e){s(e),o(b.oLanguage,e),i.extend(!0,C.oLanguage,g.oLanguage,e),oe(C)}),f=!0):i.extend(!0,C.oLanguage,g.oLanguage),null===g.asStripeClasses&&(C.asStripeClasses=[v.sStripeOdd,v.sStripeEven]);var m=C.asStripeClasses,$=i("tbody tr:eq(0)",this);-1!==i.inArray(!0,i.map(m,function(e){return $.hasClass(e)}))&&(i("tbody tr",this).removeClass(m.join(" ")),C.asDestroyStripes=m.slice());var k,x=[],m=this.getElementsByTagName("thead");if(0!==m.length&&(j(C.aoHeader,m[0]),x=U(C)),null===g.aoColumns)for(k=[],m=0,p=x.length;p>m;m++)k.push(null);else k=g.aoColumns;for(m=0,p=k.length;p>m;m++)h(C,x?x[m]:null);if(y(C,g.aoColumnDefs,k,function(e,t){d(C,e,t)}),$.length){var S=function(e,t){return e.getAttribute("data-"+t)?t:null};i.each(O(C,$[0]).cells,function(e,t){var i=C.aoColumns[e];if(i.mData===e){var r=S(t,"sort")||S(t,"order"),o=S(t,"filter")||S(t,"search");(null!==r||null!==o)&&(i.mData={_:e+".display",sort:null!==r?e+".@data-"+r:n,type:null!==r?e+".@data-"+r:n,filter:null!==o?e+".@data-"+o:n},d(C,e))}})}var T=C.oFeatures;if(g.bStateSave&&(T.bStateSave=!0,Ie(C,g),Le(C,"aoDrawCallback",Oe,"state_save")),g.aaSorting===n)for(x=C.aaSorting,m=0,p=x.length;p>m;m++)x[m][1]=C.aoColumns[m].asSorting[0];if(De(C),T.bSort&&Le(C,"aoDrawCallback",function(){if(C.bSorted){var e=$e(C),t={};i.each(e,function(e,n){t[n.src]=n.dir}),je(C,null,"order",[C,e,t]),Se(C)}}),Le(C,"aoDrawCallback",function(){(C.bSorted||"ssp"===We(C)||T.bDeferRender)&&De(C)},"sc"),c(C),m=i(this).children("caption").each(function(){this._captionSide=i(this).css("caption-side")}),p=i(this).children("thead"),0===p.length&&(p=i("<thead/>").appendTo(this)),C.nTHead=p[0],p=i(this).children("tbody"),0===p.length&&(p=i("<tbody/>").appendTo(this)),C.nTBody=p[0],p=i(this).children("tfoot"),0===p.length&&0<m.length&&(""!==C.oScroll.sX||""!==C.oScroll.sY)&&(p=i("<tfoot/>").appendTo(this)),0===p.length||0===p.children().length?i(this).addClass(v.sNoFooter):0<p.length&&(C.nTFoot=p[0],j(C.aoFooter,C.nTFoot)),g.aaData)for(m=0;m<g.aaData.length;m++)w(C,g.aaData[m]);else(C.bDeferLoading||"dom"==We(C))&&_(C,i(C.nTBody).children("tr"));C.aiDisplay=C.aiDisplayMaster.slice(),C.bInitialised=!0,!1===f&&oe(C)}}),t=null,this};var yt=[],wt=Array.prototype,_t=function(e){var t,n,r=Ve.settings,o=i.map(r,function(e){return e.nTable});return e?e.nTable&&e.oApi?[e]:e.nodeName&&"table"===e.nodeName.toLowerCase()?(t=i.inArray(e,o),-1!==t?[r[t]]:null):e&&"function"==typeof e.settings?e.settings().toArray():("string"==typeof e?n=i(e):e instanceof i&&(n=e),n?n.map(function(){return t=i.inArray(this,o),-1!==t?r[t]:null}).toArray():void 0):[]};Ge=function(e,t){if(!this instanceof Ge)throw"DT API must be constructed as a new object";var n=[],r=function(e){(e=_t(e))&&n.push.apply(n,e)};if(i.isArray(e))for(var o=0,s=e.length;s>o;o++)r(e[o]);else r(e);this.context=dt(n),t&&this.push.apply(this,t.toArray?t.toArray():t),this.selector={rows:null,cols:null,opts:null},Ge.extend(this,this,yt)},Ve.Api=Ge,Ge.prototype={concat:wt.concat,context:[],each:function(e){for(var t=0,n=this.length;n>t;t++)e.call(this,this[t],t,this);return this},eq:function(e){var t=this.context;return t.length>e?new Ge(t[e],this[e]):null},filter:function(e){var t=[];if(wt.filter)t=wt.filter.call(this,e,this);else for(var n=0,i=this.length;i>n;n++)e.call(this,this[n],n,this)&&t.push(this[n]);return new Ge(this.context,t)},flatten:function(){var e=[];return new Ge(this.context,e.concat.apply(e,this.toArray()))},join:wt.join,indexOf:wt.indexOf||function(e,t){for(var n=t||0,i=this.length;i>n;n++)if(this[n]===e)return n;return-1},iterator:function(e,t,i){var r,o,s,a,l,c,u,h=[],d=this.context,p=this.selector;for("string"==typeof e&&(i=t,t=e,e=!1),o=0,s=d.length;s>o;o++)if("table"===t)r=i(d[o],o),r!==n&&h.push(r);else if("columns"===t||"rows"===t)r=i(d[o],this[o],o),r!==n&&h.push(r);else if("column"===t||"column-rows"===t||"row"===t||"cell"===t)for(u=this[o],"column-rows"===t&&(c=St(d[o],p.opts)),a=0,l=u.length;l>a;a++)r=u[a],r="cell"===t?i(d[o],r.row,r.column,o,a):i(d[o],r,o,a,c),r!==n&&h.push(r);return h.length?(e=new Ge(d,e?h.concat.apply([],h):h),t=e.selector,t.rows=p.rows,t.cols=p.cols,t.opts=p.opts,e):this},lastIndexOf:wt.lastIndexOf||function(e,t){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(e){var t=[];if(wt.map)t=wt.map.call(this,e,this);else for(var n=0,i=this.length;i>n;n++)t.push(e.call(this,this[n],n));return new Ge(this.context,t)},pluck:function(e){return this.map(function(t){return t[e]})},pop:wt.pop,push:wt.push,reduce:wt.reduce||function(e,t){return u(this,e,t,0,this.length,1)},reduceRight:wt.reduceRight||function(e,t){return u(this,e,t,this.length-1,-1,-1)},reverse:wt.reverse,selector:null,shift:wt.shift,sort:wt.sort,splice:wt.splice,toArray:function(){return wt.slice.call(this)},to$:function(){return i(this)},toJQuery:function(){return i(this)},unique:function(){return new Ge(this.context,dt(this))},unshift:wt.unshift},Ge.extend=function(e,t,n){if(t&&(t instanceof Ge||t.__dt_wrapper)){var r,o,s,a=function(e,t,n){return function(){var i=t.apply(e,arguments);return Ge.extend(i,i,n.methodExt),i}};for(r=0,o=n.length;o>r;r++)s=n[r],t[s.name]="function"==typeof s.val?a(e,s.val,s):i.isPlainObject(s.val)?{}:s.val,t[s.name].__dt_wrapper=!0,Ge.extend(e,t[s.name],s.propExt)}},Ge.register=Ke=function(e,t){if(i.isArray(e))for(var n=0,r=e.length;r>n;n++)Ge.register(e[n],t);else for(var o,s,a=e.split("."),l=yt,n=0,r=a.length;r>n;n++){o=(s=-1!==a[n].indexOf("()"))?a[n].replace("()",""):a[n];var c;e:{c=0;for(var u=l.length;u>c;c++)if(l[c].name===o){c=l[c];break e}c=null}c||(c={name:o,val:{},methodExt:[],propExt:[]},l.push(c)),n===r-1?c.val=t:l=s?c.methodExt:c.propExt}},Ge.registerPlural=Xe=function(e,t,r){Ge.register(e,r),Ge.register(t,function(){var e=r.apply(this,arguments);return e===this?this:e instanceof Ge?e.length?i.isArray(e[0])?new Ge(e.context,e[0]):e[0]:n:e})},Ke("tables()",function(e){var t;if(e){t=Ge;var n=this.context;if("number"==typeof e)e=[n[e]];else var r=i.map(n,function(e){return e.nTable}),e=i(r).filter(e).map(function(){var e=i.inArray(this,r);return n[e]}).toArray();t=new t(e)}else t=this;return t}),Ke("table()",function(e){var e=this.tables(e),t=e.context;return t.length?new Ge(t[0]):e}),Xe("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable})}),Xe("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody})}),Xe("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead})}),Xe("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot})}),Xe("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper})}),Ke("draw()",function(e){return this.iterator("table",function(t){F(t,!1===e)})}),Ke("page()",function(e){return e===n?this.page.info().page:this.iterator("table",function(t){ue(t,e)})}),Ke("page.info()",function(){if(0===this.context.length)return n;var e=this.context[0],t=e._iDisplayStart,i=e._iDisplayLength,r=e.fnRecordsDisplay(),o=-1===i;return{page:o?0:Math.floor(t/i),pages:o?1:Math.ceil(r/i),start:t,end:e.fnDisplayEnd(),length:i,recordsTotal:e.fnRecordsTotal(),recordsDisplay:r}}),Ke("page.len()",function(e){return e===n?0!==this.context.length?this.context[0]._iDisplayLength:n:this.iterator("table",function(t){ae(t,e)})});var xt=function(e,t,n){if("ssp"==We(e)?F(e,t):(de(e,!0),H(e,[],function(n){E(e);for(var n=q(e,n),i=0,r=n.length;r>i;i++)w(e,n[i]);F(e,t),de(e,!1)})),n){var i=new Ge(e);i.one("draw",function(){n(i.ajax.json())})}};Ke("ajax.json()",function(){var e=this.context;return 0<e.length?e[0].json:void 0}),Ke("ajax.params()",function(){var e=this.context;return 0<e.length?e[0].oAjaxData:void 0}),Ke("ajax.reload()",function(e,t){return this.iterator("table",function(n){xt(n,!1===t,e)})}),Ke("ajax.url()",function(e){var t=this.context;return e===n?0===t.length?n:(t=t[0],t.ajax?i.isPlainObject(t.ajax)?t.ajax.url:t.ajax:t.sAjaxSource):this.iterator("table",function(t){i.isPlainObject(t.ajax)?t.ajax.url=e:t.ajax=e})}),Ke("ajax.url().load()",function(e,t){return this.iterator("table",function(n){xt(n,!1===t,e)})});var Ct=function(e,t){var r,o,s,a,l,c,u=[];for(e&&"string"!=typeof e&&e.length!==n||(e=[e]),s=0,a=e.length;a>s;s++)for(o=e[s]&&e[s].split?e[s].split(","):[e[s]],l=0,c=o.length;c>l;l++)(r=t("string"==typeof o[l]?i.trim(o[l]):o[l]))&&r.length&&u.push.apply(u,r);return u},$t=function(e){return e||(e={}),e.filter&&!e.search&&(e.search=e.filter),{search:e.search||"none",order:e.order||"current",page:e.page||"all"}},kt=function(e){for(var t=0,n=e.length;n>t;t++)if(0<e[t].length)return e[0]=e[t],e.length=1,e.context=[e.context[t]],e;return e.length=0,e},St=function(e,t){var n,r,o,s=[],a=e.aiDisplay;n=e.aiDisplayMaster;var l=t.search;if(r=t.order,o=t.page,"ssp"==We(e))return"removed"===l?[]:ht(0,n.length);if("current"==o)for(n=e._iDisplayStart,r=e.fnDisplayEnd();r>n;n++)s.push(a[n]);else if("current"==r||"applied"==r)s="none"==l?n.slice():"applied"==l?a.slice():i.map(n,function(e){return-1===i.inArray(e,a)?e:null});else if("index"==r||"original"==r)for(n=0,r=e.aoData.length;r>n;n++)"none"==l?s.push(n):(o=i.inArray(n,a),(-1===o&&"removed"==l||o>=0&&"applied"==l)&&s.push(n));return s};Ke("rows()",function(e,t){e===n?e="":i.isPlainObject(e)&&(t=e,e="");var t=$t(t),r=this.iterator("table",function(n){var r=t;return Ct(e,function(e){var t=ot(e);if(null!==t&&!r)return[t];var o=St(n,r);if(null!==t&&-1!==i.inArray(t,o))return[t];if(!e)return o;for(var t=[],s=0,a=o.length;a>s;s++)t.push(n.aoData[o[s]].nTr);return e.nodeName&&-1!==i.inArray(e,t)?[e._DT_RowIndex]:i(t).filter(e).map(function(){return this._DT_RowIndex}).toArray()})});return r.selector.rows=e,r.selector.opts=t,r}),Ke("rows().nodes()",function(){return this.iterator("row",function(e,t){return e.aoData[t].nTr||n})}),Ke("rows().data()",function(){return this.iterator(!0,"rows",function(e,t){return ut(e.aoData,t,"_aData")})}),Xe("rows().cache()","row().cache()",function(e){return this.iterator("row",function(t,n){var i=t.aoData[n];return"search"===e?i._aFilterData:i._aSortData})}),Xe("rows().invalidate()","row().invalidate()",function(e){return this.iterator("row",function(t,n){A(t,n,e)})}),Xe("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,t){return t})}),Xe("rows().remove()","row().remove()",function(){var e=this;return this.iterator("row",function(t,n,r){var o=t.aoData;o.splice(n,1);for(var s=0,a=o.length;a>s;s++)null!==o[s].nTr&&(o[s].nTr._DT_RowIndex=s);i.inArray(n,t.aiDisplay),D(t.aiDisplayMaster,n),D(t.aiDisplay,n),D(e[r],n,!1),Ue(t)})}),Ke("rows.add()",function(e){var t=this.iterator("table",function(t){var n,i,r,o=[];for(i=0,r=e.length;r>i;i++)n=e[i],o.push(n.nodeName&&"TR"===n.nodeName.toUpperCase()?_(t,n)[0]:w(t,n));return o}),n=this.rows(-1);return n.pop(),n.push.apply(n,t.toArray()),n}),Ke("row()",function(e,t){return kt(this.rows(e,t))}),Ke("row().data()",function(e){var t=this.context;return e===n?t.length&&this.length?t[0].aoData[this[0]]._aData:n:(t[0].aoData[this[0]]._aData=e,A(t[0],this[0],"data"),this)}),Ke("row().node()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]].nTr||null:null}),Ke("row.add()",function(e){e instanceof i&&e.length&&(e=e[0]);var t=this.iterator("table",function(t){return e.nodeName&&"TR"===e.nodeName.toUpperCase()?_(t,e)[0]:w(t,e)});return this.row(t[0])});var Tt=function(e){var t=e.context;t.length&&e.length&&(e=t[0].aoData[e[0]],e._details&&(e._details.remove(),e._detailsShow=n,e._details=n))},Et=function(e,t){var n=e.context;if(n.length&&e.length){var i=n[0].aoData[e[0]];if(i._details){(i._detailsShow=t)?i._details.insertAfter(i.nTr):i._details.detach();var r=n[0],o=new Ge(r),s=r.aoData;o.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),0<ct(s,"_details").length&&(o.on("draw.dt.DT_details",function(e,t){r===t&&o.rows({page:"current"}).eq(0).each(function(e){e=s[e],e._detailsShow&&e._details.insertAfter(e.nTr)})}),o.on("column-visibility.dt.DT_details",function(e,t){if(r===t)for(var n,i=m(t),o=0,a=s.length;a>o;o++)n=s[o],n._details&&n._details.children("td[colspan]").attr("colspan",i)}),o.on("destroy.dt.DT_details",function(e,t){if(r===t)for(var n=0,i=s.length;i>n;n++)s[n]._details&&Tt(s[n])}))}}};Ke("row().child()",function(e,t){var r=this.context;if(e===n)return r.length&&this.length?r[0].aoData[this[0]]._details:n;if(!0===e)this.child.show();else if(!1===e)Tt(this);else if(r.length&&this.length){
var o=r[0],r=r[0].aoData[this[0]],s=[],a=function(e,t){if(e.nodeName&&"tr"===e.nodeName.toLowerCase())s.push(e);else{var n=i("<tr><td/></tr>").addClass(t);i("td",n).addClass(t).html(e)[0].colSpan=m(o),s.push(n[0])}};if(i.isArray(e)||e instanceof i)for(var l=0,c=e.length;c>l;l++)a(e[l],t);else a(e,t);r._details&&r._details.remove(),r._details=i(s),r._detailsShow&&r._details.insertAfter(r.nTr)}return this}),Ke(["row().child.show()","row().child().show()"],function(){return Et(this,!0),this}),Ke(["row().child.hide()","row().child().hide()"],function(){return Et(this,!1),this}),Ke(["row().child.remove()","row().child().remove()"],function(){return Tt(this),this}),Ke("row().child.isShown()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]]._detailsShow||!1:!1});var Dt=/^(.+):(name|visIdx|visible)$/;Ke("columns()",function(e,t){e===n?e="":i.isPlainObject(e)&&(t=e,e="");var t=$t(t),r=this.iterator("table",function(t){var n=e,r=t.aoColumns,o=ct(r,"sName"),s=ct(r,"nTh");return Ct(n,function(e){var n=ot(e);if(""===e)return ht(r.length);if(null!==n)return[n>=0?n:r.length+n];var a="string"==typeof e?e.match(Dt):"";if(!a)return i(s).filter(e).map(function(){return i.inArray(this,s)}).toArray();switch(a[2]){case"visIdx":case"visible":return e=parseInt(a[1],10),0>e?(n=i.map(r,function(e,t){return e.bVisible?t:null}),[n[n.length+e]]):[f(t,e)];case"name":return i.map(o,function(e,t){return e===a[1]?t:null})}})});return r.selector.cols=e,r.selector.opts=t,r}),Xe("columns().header()","column().header()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].nTh})}),Xe("columns().footer()","column().footer()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].nTf})}),Xe("columns().data()","column().data()",function(){return this.iterator("column-rows",function(e,t,n,i,r){for(var n=[],i=0,o=r.length;o>i;i++)n.push(x(e,r[i],t,""));return n})}),Xe("columns().cache()","column().cache()",function(e){return this.iterator("column-rows",function(t,n,i,r,o){return ut(t.aoData,o,"search"===e?"_aFilterData":"_aSortData",n)})}),Xe("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,t,n,i,r){return ut(e.aoData,r,"anCells",t)})}),Xe("columns().visible()","column().visible()",function(e,t){return this.iterator("column",function(r,o){var s;if(e===n)s=r.aoColumns[o].bVisible;else{var a=r.aoColumns;s=a[o];var l,c,u,h=r.aoData;if(e===n)s=s.bVisible;else{if(s.bVisible!==e){if(e){var d=i.inArray(!0,ct(a,"bVisible"),o+1);for(l=0,c=h.length;c>l;l++)u=h[l].nTr,a=h[l].anCells,u&&u.insertBefore(a[o],a[d]||null)}else i(ct(r.aoData,"anCells",o)).detach();s.bVisible=e,R(r,r.aoHeader),R(r,r.aoFooter),(t===n||t)&&(p(r),(r.oScroll.sX||r.oScroll.sY)&&fe(r)),je(r,null,"column-visibility",[r,o,e]),Oe(r)}s=void 0}}return s})}),Xe("columns().indexes()","column().index()",function(e){return this.iterator("column",function(t,n){return"visible"===e?g(t,n):n})}),Ke("columns.adjust()",function(){return this.iterator("table",function(e){p(e)})}),Ke("column.index()",function(e,t){if(0!==this.context.length){var n=this.context[0];if("fromVisible"===e||"toData"===e)return f(n,t);if("fromData"===e||"toVisible"===e)return g(n,t)}}),Ke("column()",function(e,t){return kt(this.columns(e,t))}),Ke("cells()",function(e,t,r){if(i.isPlainObject(e)&&(typeof e.row!==n?(r=t,t=null):(r=e,e=null)),i.isPlainObject(t)&&(r=t,t=null),null===t||t===n)return this.iterator("table",function(t){var o,s,a,l,c,u=e,h=$t(r),d=t.aoData,p=St(t,h),h=ut(d,p,"anCells"),f=i([].concat.apply([],h)),g=t.aoColumns.length;return Ct(u,function(e){if(null===e||e===n){for(s=[],a=0,l=p.length;l>a;a++)for(o=p[a],c=0;g>c;c++)s.push({row:o,column:c});return s}return i.isPlainObject(e)?[e]:f.filter(e).map(function(e,t){return o=t.parentNode._DT_RowIndex,{row:o,column:i.inArray(t,d[o].anCells)}}).toArray()})});var o,s,a,l,c,u=this.columns(t,r),h=this.rows(e,r),d=this.iterator("table",function(e,t){for(o=[],s=0,a=h[t].length;a>s;s++)for(l=0,c=u[t].length;c>l;l++)o.push({row:h[t][s],column:u[t][l]});return o});return i.extend(d.selector,{cols:t,rows:e,opts:r}),d}),Xe("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,t,n){return e.aoData[t].anCells[n]})}),Ke("cells().data()",function(){return this.iterator("cell",function(e,t,n){return x(e,t,n)})}),Xe("cells().cache()","cell().cache()",function(e){return e="search"===e?"_aFilterData":"_aSortData",this.iterator("cell",function(t,n,i){return t.aoData[n][e][i]})}),Xe("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,t,n){return{row:t,column:n,columnVisible:g(e,n)}})}),Ke(["cells().invalidate()","cell().invalidate()"],function(e){var t=this.selector;return this.rows(t.rows,t.opts).invalidate(e),this}),Ke("cell()",function(e,t,n){return kt(this.cells(e,t,n))}),Ke("cell().data()",function(e){var t=this.context,i=this[0];return e===n?t.length&&i.length?x(t[0],i[0].row,i[0].column):n:(C(t[0],i[0].row,i[0].column,e),A(t[0],i[0].row,"data",i[0].column),this)}),Ke("order()",function(e,t){var r=this.context;return e===n?0!==r.length?r[0].aaSorting:n:("number"==typeof e?e=[[e,t]]:i.isArray(e[0])||(e=Array.prototype.slice.call(arguments)),this.iterator("table",function(t){t.aaSorting=e.slice()}))}),Ke("order.listener()",function(e,t,n){return this.iterator("table",function(i){Ee(i,e,t,n)})}),Ke(["columns().order()","column().order()"],function(e){var t=this;return this.iterator("table",function(n,r){var o=[];i.each(t[r],function(t,n){o.push([n,e])}),n.aaSorting=o})}),Ke("search()",function(e,t,r,o){var s=this.context;return e===n?0!==s.length?s[0].oPreviousSearch.sSearch:n:this.iterator("table",function(n){n.oFeatures.bFilter&&Y(n,i.extend({},n.oPreviousSearch,{sSearch:e+"",bRegex:null===t?!1:t,bSmart:null===r?!0:r,bCaseInsensitive:null===o?!0:o}),1)})}),Xe("columns().search()","column().search()",function(e,t,r,o){return this.iterator("column",function(s,a){var l=s.aoPreSearchCols;return e===n?l[a].sSearch:void(s.oFeatures.bFilter&&(i.extend(l[a],{sSearch:e+"",bRegex:null===t?!1:t,bSmart:null===r?!0:r,bCaseInsensitive:null===o?!0:o}),Y(s,s.oPreviousSearch,1)))})}),Ke("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Ke("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})}),Ke("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Ke("state.save()",function(){return this.iterator("table",function(e){Oe(e)})}),Ve.versionCheck=Ve.fnVersionCheck=function(e){for(var t,n,i=Ve.version.split("."),e=e.split("."),r=0,o=e.length;o>r;r++)if(t=parseInt(i[r],10)||0,n=parseInt(e[r],10)||0,t!==n)return t>n;return!0},Ve.isDataTable=Ve.fnIsDataTable=function(e){var t=i(e).get(0),n=!1;return i.each(Ve.settings,function(e,i){(i.nTable===t||i.nScrollHead===t||i.nScrollFoot===t)&&(n=!0)}),n},Ve.tables=Ve.fnTables=function(e){return jQuery.map(Ve.settings,function(t){return!e||e&&i(t.nTable).is(":visible")?t.nTable:void 0})},Ve.camelToHungarian=o,Ke("$()",function(e,t){var n=this.rows(t).nodes(),n=i(n);return i([].concat(n.filter(e).toArray(),n.find(e).toArray()))}),i.each(["on","one","off"],function(e,t){Ke(t+"()",function(){var e=Array.prototype.slice.call(arguments);e[0].match(/\.dt\b/)||(e[0]+=".dt");var n=i(this.tables().nodes());return n[t].apply(n,e),this})}),Ke("clear()",function(){return this.iterator("table",function(e){E(e)})}),Ke("settings()",function(){return new Ge(this.context,this.context)}),Ke("data()",function(){return this.iterator("table",function(e){return ct(e.aoData,"_aData")}).flatten()}),Ke("destroy()",function(t){return t=t||!1,this.iterator("table",function(n){var r,o=n.nTableWrapper.parentNode,s=n.oClasses,a=n.nTable,l=n.nTBody,c=n.nTHead,u=n.nTFoot,h=i(a),l=i(l),d=i(n.nTableWrapper),p=i.map(n.aoData,function(e){return e.nTr});n.bDestroying=!0,je(n,"aoDestroyCallback","destroy",[n]),t||new Ge(n).columns().visible(!0),d.unbind(".DT").find(":not(tbody *)").unbind(".DT"),i(e).unbind(".DT-"+n.sInstance),a!=c.parentNode&&(h.children("thead").detach(),h.append(c)),u&&a!=u.parentNode&&(h.children("tfoot").detach(),h.append(u)),h.detach(),d.detach(),n.aaSorting=[],n.aaSortingFixed=[],De(n),i(p).removeClass(n.asStripeClasses.join(" ")),i("th, td",c).removeClass(s.sSortable+" "+s.sSortableAsc+" "+s.sSortableDesc+" "+s.sSortableNone),n.bJUI&&(i("th span."+s.sSortIcon+", td span."+s.sSortIcon,c).detach(),i("th, td",c).each(function(){var e=i("div."+s.sSortJUIWrapper,this);i(this).append(e.contents()),e.detach()})),!t&&o&&o.insertBefore(a,n.nTableReinsertBefore),l.children().detach(),l.append(p),h.css("width",n.sDestroyWidth).removeClass(s.sTable),(r=n.asDestroyStripes.length)&&l.children().each(function(e){i(this).addClass(n.asDestroyStripes[e%r])}),o=i.inArray(n,Ve.settings),-1!==o&&Ve.settings.splice(o,1)})}),Ve.version="1.10.2",Ve.settings=[],Ve.models={},Ve.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},Ve.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null},Ve.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},Ve.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(e){try{return JSON.parse((-1===e.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(t){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(e,t){try{(-1===e.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(t))}catch(n){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:i.extend({},Ve.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null},r(Ve.defaults),Ve.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},r(Ve.defaults.column),Ve.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:n,oAjaxData:n,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==We(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==We(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var e=this._iDisplayLength,t=this._iDisplayStart,n=t+e,i=this.aiDisplay.length,r=this.oFeatures,o=r.bPaginate;return r.bServerSide?!1===o||-1===e?t+i:Math.min(t+e,this._iRecordsDisplay):!o||n>i||-1===e?i:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}},Ve.ext=Ye={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:Ve.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:Ve.version},i.extend(Ye,{afnFiltering:Ye.search,aTypes:Ye.type.detect,ofnSearch:Ye.type.search,oSort:Ye.type.order,afnSortData:Ye.order,aoFeatures:Ye.feature,oApi:Ye.internal,oStdClasses:Ye.classes,oPagination:Ye.pager}),i.extend(Ve.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});var At="",At="",Ot=At+"ui-state-default",It=At+"css_right ui-icon ui-icon-",Mt=At+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";i.extend(Ve.ext.oJUIClasses,Ve.ext.classes,{sPageButton:"fg-button ui-button "+Ot,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:Ot+" sorting_asc",sSortDesc:Ot+" sorting_desc",sSortable:Ot+" sorting",sSortableAsc:Ot+" sorting_asc_disabled",sSortableDesc:Ot+" sorting_desc_disabled",sSortableNone:Ot+" sorting_disabled",sSortJUIAsc:It+"triangle-1-n",sSortJUIDesc:It+"triangle-1-s",sSortJUI:It+"carat-2-n-s",sSortJUIAscAllowed:It+"carat-1-n",sSortJUIDescAllowed:It+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+Ot,sScrollFoot:"dataTables_scrollFoot "+Ot,sHeaderTH:Ot,sFooterTH:Ot,sJUIHeader:Mt+" ui-corner-tl ui-corner-tr",sJUIFooter:Mt+" ui-corner-bl ui-corner-br"});var Pt=Ve.ext.pager;i.extend(Pt,{simple:function(){return["previous","next"]},full:function(){return["first","previous","next","last"]},simple_numbers:function(e,t){return["previous",Be(e,t),"next"]},full_numbers:function(e,t){return["first","previous",Be(e,t),"next","last"]},_numbers:Be,numbers_length:7}),i.extend(!0,Ve.ext.renderer,{pageButton:{_:function(e,n,r,o,s,a){var l,c,u=e.oClasses,h=e.oLanguage.oPaginate,d=0,p=function(t,n){var o,f,g,m,v=function(t){ue(e,t.data.action,!0)};for(o=0,f=n.length;f>o;o++)if(m=n[o],i.isArray(m))g=i("<"+(m.DT_el||"div")+"/>").appendTo(t),p(g,m);else{switch(c=l="",m){case"ellipsis":t.append("<span>&hellip;</span>");break;case"first":l=h.sFirst,c=m+(s>0?"":" "+u.sPageButtonDisabled);break;case"previous":l=h.sPrevious,c=m+(s>0?"":" "+u.sPageButtonDisabled);break;case"next":l=h.sNext,c=m+(a-1>s?"":" "+u.sPageButtonDisabled);break;case"last":l=h.sLast,c=m+(a-1>s?"":" "+u.sPageButtonDisabled);break;default:l=m+1,c=s===m?u.sPageButtonActive:""}l&&(g=i("<a>",{"class":u.sPageButton+" "+c,"aria-controls":e.sTableId,"data-dt-idx":d,tabindex:e.iTabIndex,id:0===r&&"string"==typeof m?e.sTableId+"_"+m:null}).html(l).appendTo(t),Fe(g,{action:m},v),d++)}};try{var f=i(t.activeElement).data("dt-idx");p(i(n).empty(),o),null!==f&&i(n).find("[data-dt-idx="+f+"]").focus()}catch(g){}}}});var Rt=function(e,t,n,i){return e&&"-"!==e?(t&&(e=st(e,t)),e.replace&&(n&&(e=e.replace(n,"")),i&&(e=e.replace(i,""))),1*e):-(1/0)};return i.extend(Ye.type.order,{"date-pre":function(e){return Date.parse(e)||0},"html-pre":function(e){return rt(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return rt(e)?"":"string"==typeof e?e.toLowerCase():e.toString?e.toString():""},"string-asc":function(e,t){return t>e?-1:e>t?1:0},"string-desc":function(e,t){return t>e?1:e>t?-1:0}}),ze(""),i.extend(Ve.ext.type.detect,[function(e,t){var n=t.oLanguage.sDecimal;return at(e,n)?"num"+n:null},function(e){if(e&&(!et.test(e)||!tt.test(e)))return null;var t=Date.parse(e);return null!==t&&!isNaN(t)||rt(e)?"date":null},function(e,t){var n=t.oLanguage.sDecimal;return at(e,n,!0)?"num-fmt"+n:null},function(e,t){var n=t.oLanguage.sDecimal;return lt(e,n)?"html-num"+n:null},function(e,t){var n=t.oLanguage.sDecimal;return lt(e,n,!0)?"html-num-fmt"+n:null},function(e){return rt(e)||"string"==typeof e&&-1!==e.indexOf("<")?"html":null}]),i.extend(Ve.ext.type.search,{html:function(e){return rt(e)?e:"string"==typeof e?e.replace(Je," ").replace(Ze,""):""},string:function(e){return rt(e)?e:"string"==typeof e?e.replace(Je," "):e}}),i.extend(!0,Ve.ext.renderer,{header:{_:function(e,t,n,r){i(e.nTable).on("order.dt.DT",function(i,o,s,a){e===o&&(i=n.idx,t.removeClass(n.sSortingClass+" "+r.sSortAsc+" "+r.sSortDesc).addClass("asc"==a[i]?r.sSortAsc:"desc"==a[i]?r.sSortDesc:n.sSortingClass))})},jqueryui:function(e,t,n,r){var o=n.idx;i("<div/>").addClass(r.sSortJUIWrapper).append(t.contents()).append(i("<span/>").addClass(r.sSortIcon+" "+n.sSortingClassJUI)).appendTo(t),i(e.nTable).on("order.dt.DT",function(i,s,a,l){e===s&&(t.removeClass(r.sSortAsc+" "+r.sSortDesc).addClass("asc"==l[o]?r.sSortAsc:"desc"==l[o]?r.sSortDesc:n.sSortingClass),t.find("span."+r.sSortIcon).removeClass(r.sSortJUIAsc+" "+r.sSortJUIDesc+" "+r.sSortJUI+" "+r.sSortJUIAscAllowed+" "+r.sSortJUIDescAllowed).addClass("asc"==l[o]?r.sSortJUIAsc:"desc"==l[o]?r.sSortJUIDesc:n.sSortingClassJUI))})}}}),Ve.render={number:function(e,t,n,i){return{display:function(r){var o=0>r?"-":"",r=Math.abs(parseFloat(r)),s=parseInt(r,10),r=n?t+(r-s).toFixed(n).substring(2):"";return o+(i||"")+s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e)+r}}}},i.extend(Ve.ext.internal,{_fnExternApiFunc:qe,_fnBuildAjax:H,_fnAjaxUpdate:W,_fnAjaxParameters:B,_fnAjaxUpdateDraw:z,_fnAjaxDataSrc:q,_fnAddColumn:h,_fnColumnOptions:d,_fnAdjustColumnSizing:p,_fnVisibleToColumnIndex:f,_fnColumnIndexToVisible:g,_fnVisbleColumns:m,_fnGetColumns:v,_fnColumnTypes:b,_fnApplyColumnDefs:y,_fnHungarianMap:r,_fnCamelToHungarian:o,_fnLanguageCompat:s,_fnBrowserDetect:c,_fnAddData:w,_fnAddTr:_,_fnNodeToDataIndex:function(e,t){return t._DT_RowIndex!==n?t._DT_RowIndex:null},_fnNodeToColumnIndex:function(e,t,n){return i.inArray(n,e.aoData[t].anCells)},_fnGetCellData:x,_fnSetCellData:C,_fnSplitObjNotation:$,_fnGetObjectDataFn:k,_fnSetObjectDataFn:S,_fnGetDataMaster:T,_fnClearTable:E,_fnDeleteIndex:D,_fnInvalidateRow:A,_fnGetRowElements:O,_fnCreateTr:I,_fnBuildHead:P,_fnDrawHead:R,_fnDraw:N,_fnReDraw:F,_fnAddOptionsHtml:L,_fnDetectHeader:j,_fnGetUniqueThs:U,_fnFeatureHtmlFilter:V,_fnFilterComplete:Y,_fnFilterCustom:G,_fnFilterColumn:K,_fnFilter:X,_fnFilterCreateSearch:Q,_fnEscapeRegex:J,_fnFilterData:Z,_fnFeatureHtmlInfo:ne,_fnUpdateInfo:ie,_fnInfoMacros:re,_fnInitialise:oe,_fnInitComplete:se,_fnLengthChange:ae,_fnFeatureHtmlLength:le,_fnFeatureHtmlPaginate:ce,_fnPageChange:ue,_fnFeatureHtmlProcessing:he,_fnProcessingDisplay:de,_fnFeatureHtmlTable:pe,_fnScrollDraw:fe,_fnApplyToChildren:ge,_fnCalculateColumnWidths:me,_fnThrottle:ve,_fnConvertToWidth:be,_fnScrollingWidthAdjust:ye,_fnGetWidestNode:we,_fnGetMaxLenString:_e,_fnStringToCss:xe,_fnScrollBarWidth:Ce,_fnSortFlatten:$e,_fnSort:ke,_fnSortAria:Se,_fnSortListener:Te,_fnSortAttachListener:Ee,_fnSortingClasses:De,_fnSortData:Ae,_fnSaveState:Oe,_fnLoadState:Ie,_fnSettingsFromNode:Me,_fnLog:Pe,_fnMap:Re,_fnBindAction:Fe,_fnCallbackReg:Le,_fnCallbackFire:je,_fnLengthOverflow:Ue,_fnRenderer:He,_fnDataSource:We,_fnRowAttributes:M,_fnCalculateEnd:function(){}}),i.fn.dataTable=Ve,i.fn.dataTableSettings=Ve.settings,i.fn.dataTableExt=Ve.ext,i.fn.DataTable=function(e){return i(this).dataTable(e).api()},i.each(Ve,function(e,t){i.fn.DataTable[e]=t}),i.fn.dataTable};"function"==typeof define&&define.amd?define("datatables",["jquery"],i):"object"==typeof exports?i(require("jquery")):jQuery&&!jQuery.fn.dataTable&&i(jQuery)}(window,document),function(e){e.fn.columnFilter=function(t){function n(e,t,n,i,r){if("undefined"==typeof t)return new Array;"undefined"==typeof n&&(n=!0),"undefined"==typeof i&&(i=!0),"undefined"==typeof r&&(r=!0);var o;o=1==i?e.aiDisplay:e.aiDisplayMaster;for(var s=new Array,a=0,l=o.length;l>a;a++){iRow=o[a];var c=oTable.fnGetData(iRow),u=c[t];(1!=r||0!=u.length)&&(1==n&&jQuery.inArray(u,s)>-1||s.push(u))}return s.sort()}function i(e){return properties.bUseColVis?e:oTable.fnSettings().oApi._fnVisibleToColumnIndex(oTable.fnSettings(),e)}function r(t,n,r,o,s,a){var l="text_filter";o&&(l="number_filter"),p=p.replace(/(^\s*)|(\s*$)/g,"");var c=t.fnSettings().aoPreSearchCols[d].sSearch,u="search_init ",g=p;""!=c&&"^"!=c&&(g=o&&"^"==c.charAt(0)?c.substr(1):c,u="");var m=e('<input type="text" class="'+u+l+'" value="'+g+'"/>');void 0!=a&&-1!=a&&m.attr("maxlength",a),f.html(m),f.wrapInner(o?'<span class="filter_column filter_number" />':'<span class="filter_column filter_text" />'),h[d]=p;var v=d;m.keyup(o&&!t.fnSettings().oFeatures.bServerSide?function(){t.fnFilter("^"+this.value,i(v),!0,!1),b()}:function(){if(t.fnSettings().oFeatures.bServerSide&&0!=s){var o=(t.fnSettings().aoPreSearchCols[v].sSearch,e(this).data("dt-iLastFilterLength"));"undefined"==typeof o&&(o=0);var a=this.value.length;if(Math.abs(a-o)<s)return;e(this).data("dt-iLastFilterLength",a)}t.fnFilter(this.value,i(v),n,r),b()}),m.focus(function(){e(this).hasClass("search_init")&&(e(this).removeClass("search_init"),this.value="")}),m.blur(function(){""==this.value&&(e(this).addClass("search_init"),this.value=h[v])})}function o(t){f.html(u(0));var n=t.attr("id")+"_range_from_"+d,r=e('<input type="text" class="number_range_filter" id="'+n+'" rel="'+d+'"/>');f.append(r),f.append(u(1));var o=t.attr("id")+"_range_to_"+d,s=e('<input type="text" class="number_range_filter" id="'+o+'" rel="'+d+'"/>');f.append(s),f.append(u(2)),f.wrapInner('<span class="filterColumn filter_number_range" />');var a=d;v.push(d),t.dataTableExt.afnFiltering.push(function(e,r,s){if(t.attr("id")!=e.sTableId)return!0;var l=1*document.getElementById(n).value,c=1*document.getElementById(o).value,u="-"==r[i(a)]?0:1*r[i(a)];return""==l&&""==c?!0:""==l&&c>=u?!0:u>=l&&""==c?!0:u>=l&&c>=u?!0:!1}),e("#"+n+",#"+o,f).keyup(function(){var e=1*document.getElementById(n).value,i=1*document.getElementById(o).value;0!=e&&0!=i&&e>i||(t.fnDraw(),b())})}function s(t){f.html(u(0));var n=t.attr("id")+"_range_from_"+d,r=e('<input type="text" style="width: 90px" class="date_range_filter date-picker"   id="'+n+'" rel="'+d+'"/>');f.append(r),f.append(u(1));var o=t.attr("id")+"_range_to_"+d,s=e('<input type="text" style="width: 90px" class="date_range_filter date-picker"  id="'+o+'" rel="'+d+'"/>');f.append(s),f.append(u(2)),f.wrapInner('<span class="filterColumn filter_date_range" />');var a=d;v.push(d),t.dataTableExt.afnFiltering.push(function(r,s,l){if(t.attr("id")!=r.sTableId)return!0;var c=e("#"+n).val(),u=moment(c,"DD/MM/YYYY"),h=e("#"+o).val(),d=moment(h,"DD/MM/YYYY");if(null==c&&null==h)return!0;var p=null;try{if(null==s[i(a)])return!1;p=moment(s[i(a)],"D/M/YYYY")}catch(f){return!1}return null==p?!1:""==c&&d>=p?!0:p>=u&&""==h?!0:p>=u&&d>=p?!0:!1}),e("#"+n+",#"+o,f).change(function(){t.fnDraw(),b()})}function a(t,i,r,o,s,a){null==i&&(i=n(t.fnSettings(),r,!0,!1,!0));var l=t.fnSettings().aoPreSearchCols[d].sSearch,c='<select class="search_init select_filter"><option value="" class="search_init">'+s+"</option>",u=0,h=i.length;for(u=0;h>u;u++)if("object"!=typeof i[u]){var p="";escape(i[u])==l&&(p="selected "),c+="<option "+p+' value="'+escape(i[u])+'">'+i[u]+"</option>"}else{var p="";a?(i[u].value==l&&(p="selected "),c+="<option "+p+'value="'+i[u].value+'">'+i[u].label+"</option>"):(escape(i[u].value)==l&&(p="selected "),c+="<option "+p+'value="'+escape(i[u].value)+'">'+i[u].label+"</option>")}var f=e(c+"</select>");o.html(f),o.wrapInner('<span class="filterColumn filter_select" />'),f.change(function(){""!=e(this).val()?e(this).removeClass("search_init"):e(this).addClass("search_init"),a?t.fnFilter(e(this).val(),r,a):t.fnFilter(unescape(e(this).val()),r),b()})}function l(e,t,n){var r=e.fnSettings();null!=t||""==r.sAjaxSource||r.oFeatures.bServerSide||r.aoDrawCallback.push({fn:function(t,o,s){return function(){return 2!=r.iDraw||null==r.sAjaxSource||""==r.sAjaxSource||r.oFeatures.bServerSide?void 0:a(e,null,i(t),o,s,n)}}(d,f,p),sName:"column_filter_"+d}),a(e,t,i(d),f,p,n)}function c(t,i){null==i&&(i=n(t.fnSettings(),d,!0,!0,!0));var r,o=d,s="",a=i.length,l=p.replace("%","Perc").replace("&","AND").replace("$","DOL").replace("£","STERL").replace("@","AT").replace(/\s/g,"_");l=l.replace(/[^a-zA-Z 0-9]+/g,""),labelBtn=null!=properties.sFilterButtonText||void 0!=properties.sFilterButtonText?properties.sFilterButtonText:p;var c=10,u=12,h=Math.floor(a/u);a%u>0&&(h+=1);var g=100/h-2,m=c*h;1==h&&(g=20);var v='<div style="float:left; min-width: '+g+'%; " >',y="</div>",w=t.attr("id")+l,_="chkBtnOpen"+w,x=w+"-flt-toggle";for(s+='<button id="'+_+'" class="checkbox_filter" > '+labelBtn+"</button>",s+='<div id="'+x+'" title="'+p+'" class="toggle-check ui-widget-content ui-corner-all"  style="width: '+m+'%; " >',s+=v,r=0;a>r;r++){r%u==0&&0!=r&&(s+=y+v),s+='<input class="search_init checkbox_filter" type="checkbox" id= "'+i[r]+'" name= "'+l+'" value="'+i[r]+'" >'+i[r]+"<br/>";var C=e(s);f.html(C),f.wrapInner('<span class="filterColumn filter_checkbox" />'),C.change(function(){var n="",r="|",s=e('input:checkbox[name="'+l+'"]:checked').size();e('input:checkbox[name="'+l+'"]:checked').each(function(t){(0==t&&1==s||0!=t&&t==s-1)&&(r=""),n=n.replace(/^\s+|\s+$/g,""),n=n+e(this).val()+r,r="|"});for(var c=0;a>c;c++)""!=n?e("#"+i[c]).removeClass("search_init"):e("#"+i[c]).addClass("search_init");t.fnFilter(n,o,!0,!1),b()})}e("#"+_).button(),e("#"+x).dialog({autoOpen:!1,hide:"blind",buttons:[{text:"Reset",click:function(){return e('input:checkbox[name="'+l+'"]:checked').each(function(t){e(this).attr("checked",!1),e(this).addClass("search_init")}),t.fnFilter("",o,!0,!1),b(),!1}},{text:"Close",click:function(){e(this).dialog("close")}}]}),e("#"+_).click(function(){e("#"+x).dialog("open");var t=e(this);return e("#"+x).dialog("widget").position({my:"top",at:"bottom",of:t}),!1});var $=b;b=function(){var t=e("#"+_);e("#"+x).dialog("widget").position({my:"top",at:"bottom",of:t}),$()}}function u(e){switch(e){case 0:return g.substring(0,g.indexOf("{from}"));case 1:return g.substring(g.indexOf("{from}")+6,g.indexOf("{to}"));default:return g.substring(g.indexOf("{to}")+4)}}var h,d,p,f,g="From {from} to {to}",m=new Array,v=new Array,b=function(){};oTable=this;var y={sPlaceHolder:"foot",sRangeSeparator:"~",iFilteringDelay:500,aoColumns:null,sRangeFormat:"From {from} to {to}"};return properties=e.extend(y,t),this.each(function(){if(oTable.fnSettings().oFeatures.bFilter){h=new Array;var t="tfoot tr";if("head:after"==properties.sPlaceHolder){var n=e("thead tr:last",oTable).detach();oTable.fnSettings().bSortCellsTop?n.appendTo(e("thead",oTable)):n.prependTo(e("thead",oTable)),t="thead tr:last"}else if("head:before"==properties.sPlaceHolder){var n=e("thead tr:first",oTable).detach();oTable.fnSettings().bSortCellsTop?n.appendTo(e("thead",oTable)):n.prependTo(e("thead",oTable)),t="thead tr:first"}for(e(t+" th",oTable).each(function(t){d=t;var n={type:"text",bRegex:!1,bSmart:!0,iMaxLenght:-1,iFilterLength:0};if(null!=properties.aoColumns){if(properties.aoColumns.length<d||null==properties.aoColumns[d])return;n=properties.aoColumns[d]}if(p=e(this).text(),null==n.sSelector?f=e(e(this)[0]):(f=e(n.sSelector),0==f.length&&(f=e(e(this)[0]))),null!=n)switch(g=null!=n.sRangeFormat?n.sRangeFormat:properties.sRangeFormat,n.type){case"null":break;case"number":r(oTable,!0,!1,!0,n.iFilterLength,n.iMaxLenght);break;case"select":1!=n.bRegex&&(n.bRegex=!1),l(oTable,n.values,n.bRegex);break;case"number-range":o(oTable);break;case"date-range":s(oTable);break;case"checkbox":c(oTable,n.values);break;case"text":default:bRegex=null==n.bRegex?!1:n.bRegex,bSmart=null==n.bSmart?!1:n.bSmart,r(oTable,bRegex,bSmart,!1,n.iFilterLength,n.iMaxLenght)}}),j=0;j<v.length;j++){var i=function(){var t=oTable.attr("id");return e("#"+t+"_range_from_"+v[j]).val()+properties.sRangeSeparator+e("#"+t+"_range_to_"+v[j]).val()};m.push(i)}if(oTable.fnSettings().oFeatures.bServerSide){var a=oTable.fnSettings().fnServerData;oTable.fnSettings().fnServerData=function(t,n,i){for(j=0;j<v.length;j++){var r=v[j];for(k=0;k<n.length;k++)n[k].name=="sSearch_"+r&&(n[k].value=m[j]())}if(n.push({name:"sRangeSeparator",value:properties.sRangeSeparator}),null!=a)try{a(t,n,i,oTable.fnSettings())}catch(o){a(t,n,i)}else e.getJSON(t,n,function(e){i(e)})}}}})}}(jQuery),$.extend(!0,$.fn.dataTable.defaults,{dom:"<'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>",language:{lengthMenu:" _MENU_ records ",paginate:{previous:'<i class="fa fa-angle-left"></i>',next:'<i class="fa fa-angle-right"></i>'}}}),$.extend($.fn.dataTableExt.oStdClasses,{sWrapper:"dataTables_wrapper",sFilterInput:"form-control input-small input-inline",sLengthSelect:"form-control input-xsmall input-inline"}),$.fn.dataTable.defaults.renderer="bootstrap",$.fn.dataTable.ext.renderer.pageButton.bootstrap=function(e,t,n,i,r,o){var s,a,l=new $.fn.dataTable.Api(e),c=e.oClasses,u=e.oLanguage.oPaginate,h=function(t,i){var d,p,f,g,m=function(e){e.preventDefault(),"ellipsis"!==e.data.action&&l.page(e.data.action).draw(!1)};for(d=0,p=i.length;p>d;d++)if(g=i[d],$.isArray(g))h(t,g);else{switch(s="",a="",g){case"ellipsis":s="&hellip;",a="disabled";break;case"first":s=u.sFirst,a=g+(r>0?"":" disabled");break;case"previous":
s=u.sPrevious,a=g+(r>0?"":" disabled");break;case"next":s=u.sNext,a=g+(o-1>r?"":" disabled");break;case"last":s=u.sLast,a=g+(o-1>r?"":" disabled");break;default:s=g+1,a=r===g?"active":""}s&&(f=$("<li>",{"class":c.sPageButton+" "+a,"aria-controls":e.sTableId,tabindex:e.iTabIndex,id:0===n&&"string"==typeof g?e.sTableId+"_"+g:null}).append($("<a>",{href:"#"}).html(s)).appendTo(t),e.oApi._fnBindAction(f,{action:g},m))}};h($(t).empty().html('<ul class="pagination"/>').children("ul"),i)},$.fn.DataTable.TableTools&&($.extend(!0,$.fn.DataTable.TableTools.classes,{container:"DTTT btn-group",buttons:{normal:"btn btn-default",disabled:"disabled"},collection:{container:"DTTT_dropdown dropdown-menu",buttons:{normal:"",disabled:"disabled"}},print:{info:"DTTT_Print_Info"},select:{row:"active"}}),$.extend(!0,$.fn.DataTable.TableTools.DEFAULTS.oTags,{collection:{container:"ul",button:"li",liner:"a"}})),$.fn.dataTableExt.oApi.fnPagingInfo=function(e){return{iStart:e._iDisplayStart,iEnd:e.fnDisplayEnd(),iLength:e._iDisplayLength,iTotal:e.fnRecordsTotal(),iFilteredTotal:e.fnRecordsDisplay(),iPage:-1===e._iDisplayLength?0:Math.ceil(e._iDisplayStart/e._iDisplayLength),iTotalPages:-1===e._iDisplayLength?0:Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength)}},$.extend($.fn.dataTableExt.oPagination,{bootstrap_full_number:{fnInit:function(e,t,n){var i=e.oLanguage.oPaginate,r=function(t){t.preventDefault(),e.oApi._fnPageChange(e,t.data.action)&&n(e)};$(t).append('<ul class="pagination"><li class="prev disabled"><a href="#" title="'+i.sFirst+'"><i class="fa fa-angle-double-left"></i></a></li><li class="prev disabled"><a href="#" title="'+i.sPrevious+'"><i class="fa fa-angle-left"></i></a></li><li class="next disabled"><a href="#" title="'+i.sNext+'"><i class="fa fa-angle-right"></i></a></li><li class="next disabled"><a href="#" title="'+i.sLast+'"><i class="fa fa-angle-double-right"></i></a></li></ul>');var o=$("a",t);$(o[0]).bind("click.DT",{action:"first"},r),$(o[1]).bind("click.DT",{action:"previous"},r),$(o[2]).bind("click.DT",{action:"next"},r),$(o[3]).bind("click.DT",{action:"last"},r)},fnUpdate:function(e,t){var n,i,r,o,s,a=5,l=e.oInstance.fnPagingInfo(),c=e.aanFeatures.p,u=Math.floor(a/2);for(l.iTotalPages<a?(o=1,s=l.iTotalPages):l.iPage<=u?(o=1,s=a):l.iPage>=l.iTotalPages-u?(o=l.iTotalPages-a+1,s=l.iTotalPages):(o=l.iPage-u+1,s=o+a-1),n=0,iLen=c.length;n<iLen;n++){for(l.iTotalPages<=0?$(".pagination",c[n]).css("visibility","hidden"):$(".pagination",c[n]).css("visibility","visible"),$("li:gt(1)",c[n]).filter(":not(.next)").remove(),i=o;s>=i;i++)r=i==l.iPage+1?'class="active"':"",$("<li "+r+'><a href="#">'+i+"</a></li>").insertBefore($("li.next:first",c[n])[0]).bind("click",function(n){n.preventDefault(),e._iDisplayStart=(parseInt($("a",this).text(),10)-1)*l.iLength,t(e)});0===l.iPage?$("li.prev",c[n]).addClass("disabled"):$("li.prev",c[n]).removeClass("disabled"),l.iPage===l.iTotalPages-1||0===l.iTotalPages?$("li.next",c[n]).addClass("disabled"):$("li.next",c[n]).removeClass("disabled")}}}}),$.extend($.fn.dataTableExt.oPagination,{bootstrap_extended:{fnInit:function(e,t,n){var i=e.oLanguage.oPaginate,r=(e.oInstance.fnPagingInfo(),function(t){t.preventDefault(),e.oApi._fnPageChange(e,t.data.action)&&n(e)});$(t).append('<div class="pagination-panel"> '+i.page+' <a href="#" class="btn btn-sm default prev disabled" title="'+i.previous+'"><i class="fa fa-angle-left"></i></a><input type="text" class="pagination-panel-input form-control input-mini input-inline input-sm" maxlenght="5" style="text-align:center; margin: 0 5px;"><a href="#" class="btn btn-sm default next disabled" title="'+i.next+'"><i class="fa fa-angle-right"></i></a> '+i.pageOf+' <span class="pagination-panel-total"></span></div>');var o=$("a",t);$(o[0]).bind("click.DT",{action:"previous"},r),$(o[1]).bind("click.DT",{action:"next"},r),$(".pagination-panel-input",t).bind("change.DT",function(t){var i=e.oInstance.fnPagingInfo();t.preventDefault();var r=parseInt($(this).val());r>0&&r<=i.iTotalPages?e.oApi._fnPageChange(e,r-1)&&n(e):$(this).val(i.iPage+1)}),$(".pagination-panel-input",t).bind("keypress.DT",function(t){var i=e.oInstance.fnPagingInfo();if(13==t.which){var r=parseInt($(this).val());r>0&&r<=e.oInstance.fnPagingInfo().iTotalPages?e.oApi._fnPageChange(e,r-1)&&n(e):$(this).val(i.iPage+1),t.preventDefault()}})},fnUpdate:function(e,t){var n,i,r,o,s,a=5,l=e.oInstance.fnPagingInfo(),c=e.aanFeatures.p,u=Math.floor(a/2);for(l.iTotalPages<a?(o=1,s=l.iTotalPages):l.iPage<=u?(o=1,s=a):l.iPage>=l.iTotalPages-u?(o=l.iTotalPages-a+1,s=l.iTotalPages):(o=l.iPage-u+1,s=o+a-1),n=0,iLen=c.length;n<iLen;n++){var h=$(c[n]).parents(".dataTables_wrapper");for(l.iTotal<=0?$(".dataTables_paginate, .dataTables_length",h).hide():$(".dataTables_paginate, .dataTables_length",h).show(),l.iTotalPages<=0?$(".dataTables_paginate, .dataTables_length .seperator",h).hide():$(".dataTables_paginate, .dataTables_length .seperator",h).show(),$(".pagination-panel-total",c[n]).html(l.iTotalPages),$(".pagination-panel-input",c[n]).val(l.iPage+1),$("li:gt(1)",c[n]).filter(":not(.next)").remove(),i=o;s>=i;i++)r=i==l.iPage+1?'class="active"':"",$("<li "+r+'><a href="#">'+i+"</a></li>").insertBefore($("li.next:first",c[n])[0]).bind("click",function(n){n.preventDefault(),e._iDisplayStart=(parseInt($("a",this).text(),10)-1)*l.iLength,t(e)});0===l.iPage?$("a.prev",c[n]).addClass("disabled"):$("a.prev",c[n]).removeClass("disabled"),l.iPage===l.iTotalPages-1||0===l.iTotalPages?$("a.next",c[n]).addClass("disabled"):$("a.next",c[n]).removeClass("disabled")}}}}),function(e,t){function n(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return n(e.getFullYear(),e.getMonth(),e.getDate())}function r(e){return function(){return this[e].apply(this,arguments)}}function o(t,n){function i(e,t){return t.toLowerCase()}var r,o=e(t).data(),s={},a=new RegExp("^"+n.toLowerCase()+"([A-Z])");n=new RegExp("^"+n.toLowerCase());for(var l in o)n.test(l)&&(r=l.replace(a,i),s[r]=o[l]);return s}function s(t){var n={};if(f[t]||(t=t.split("-")[0],f[t])){var i=f[t];return e.each(p,function(e,t){t in i&&(n[t]=i[t])}),n}}var a=e(window),l=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){for(var t=e&&e.valueOf(),n=0,i=this.length;i>n;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){t&&(e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.splice(0)},copy:function(){var e=new l;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),c=function(t,n){this.dates=new l,this.viewDate=i(),this.focusDate=null,this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on, .input-group-addon, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=e(g.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("rlobdatepicker-inline").appendTo(this.element):this.picker.addClass("rlobdatepicker-dropdown dropdown-menu"),this.o.rtl&&(this.picker.addClass("rlobdatepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("fa-angle-left fa-angle-right")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};c.prototype={constructor:c,_process_options:function(t){this._o=e.extend({},this._o,t);var n=this.o=e.extend({},this._o),i=n.language;switch(f[i]||(i=i.split("-")[0],f[i]||(i=d.language)),n.language=i,n.startView){case 2:case"decade":n.startView=2;break;case 1:case"year":n.startView=1;break;default:n.startView=0}switch(n.minViewMode){case 1:case"months":n.minViewMode=1;break;case 2:case"years":n.minViewMode=2;break;default:n.minViewMode=0}n.startView=Math.max(n.startView,n.minViewMode),n.multidate!==!0&&(n.multidate=Number(n.multidate)||!1,n.multidate=n.multidate!==!1?Math.max(0,n.multidate):1),n.multidateSeparator=String(n.multidateSeparator),n.weekStart%=7,n.weekEnd=(n.weekStart+6)%7;var r=g.parseFormat(n.format);n.startDate!==-(1/0)&&(n.startDate=n.startDate?n.startDate instanceof Date?this._local_to_utc(this._zero_time(n.startDate)):g.parseDate(n.startDate,r,n.language):-(1/0)),n.endDate!==1/0&&(n.endDate=n.endDate?n.endDate instanceof Date?this._local_to_utc(this._zero_time(n.endDate)):g.parseDate(n.endDate,r,n.language):1/0),n.daysOfWeekDisabled=n.daysOfWeekDisabled||[],e.isArray(n.daysOfWeekDisabled)||(n.daysOfWeekDisabled=n.daysOfWeekDisabled.split(/[,\s]*/)),n.daysOfWeekDisabled=e.map(n.daysOfWeekDisabled,function(e){return parseInt(e,10)});var o=String(n.orientation).toLowerCase().split(/\s+/g),s=n.orientation.toLowerCase();if(o=e.grep(o,function(e){return/^auto|left|right|top|bottom$/.test(e)}),n.orientation={x:"auto",y:"auto"},s&&"auto"!==s)if(1===o.length)switch(o[0]){case"top":case"bottom":n.orientation.y=o[0];break;case"left":case"right":n.orientation.x=o[0]}else s=e.grep(o,function(e){return/^left|right$/.test(e)}),n.orientation.x=s[0]||"auto",s=e.grep(o,function(e){return/^top|bottom$/.test(e)}),n.orientation.y=s[0]||"auto"},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var n,i,r,o=0;o<e.length;o++)n=e[o][0],2===e[o].length?(i=t,r=e[o][1]):3===e[o].length&&(i=e[o][1],r=e[o][2]),n.on(r,i)},_unapplyEvents:function(e){for(var n,i,r,o=0;o<e.length;o++)n=e[o][0],2===e[o].length?(r=t,i=e[o][1]):3===e[o].length&&(r=e[o][1],i=e[o][2]),n.off(i,r)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var i=n||this.dates.get(-1),r=this._utc_to_local(i);this.element.trigger({type:t,date:r,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){0===arguments.length?(e=this.dates.length-1,t=this.o.format):"string"==typeof e&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return g.formatDate(n,t,this.o.language)},this)})},show:function(){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){this.isInline||this.picker.is(":visible")&&(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().rlobdatepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+6e4*e.getTimezoneOffset())},_local_to_utc:function(e){return e&&new Date(e.getTime()-6e4*e.getTimezoneOffset())},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,t),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,e.map(t,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:r("setDates"),setUTCDate:r("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(n){n===t&&(n=this.o.format);var i=this.o.language;return e.map(this.dates,function(e){return g.formatDate(e,n,i)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var t=this.picker.outerWidth(),n=this.picker.outerHeight(),i=10,r=a.width(),o=a.height(),s=a.scrollTop(),l=parseInt(this.element.parents().filter(function(){return"auto"!==e(this).css("z-index")}).first().css("z-index"))+10,c=this.component?this.component.parent().offset():this.element.offset(),u=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),h=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),d=c.left,p=c.top;this.picker.removeClass("rlobdatepicker-orient-top rlobdatepicker-orient-bottom rlobdatepicker-orient-right rlobdatepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("rlobdatepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(d-=t-h)):(this.picker.addClass("rlobdatepicker-orient-left"),c.left<0?d-=c.left-i:c.left+t>r&&(d=r-t-i));var f,g,m=this.o.orientation.y;"auto"===m&&(f=-s+c.top-n,g=s+o-(c.top+u+n),m=Math.max(f,g)===g?"top":"bottom"),this.picker.addClass("rlobdatepicker-orient-"+m),"top"===m?p+=u:p-=n+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:d,zIndex:l})}},_allow_update:!0,update:function(){if(this._allow_update){var t=this.dates.copy(),n=[],i=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),i=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n=n&&this.o.multidate?n.split(this.o.multidateSeparator):[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return g.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),i?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()}},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="cw">&nbsp;</th>';t+=n,this.picker.find(".rlobdatepicker-days thead tr:first-child").prepend(n)}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+f[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".rlobdatepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+f[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".rlobdatepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var n=[],i=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),o=new Date;return t.getUTCFullYear()<i||t.getUTCFullYear()===i&&t.getUTCMonth()<r?n.push("old"):(t.getUTCFullYear()>i||t.getUTCFullYear()===i&&t.getUTCMonth()>r)&&n.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("focused"),this.o.todayHighlight&&t.getUTCFullYear()===o.getFullYear()&&t.getUTCMonth()===o.getMonth()&&t.getUTCDate()===o.getDate()&&n.push("today"),-1!==this.dates.contains(t)&&n.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled))&&n.push("disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("range"),-1!==e.inArray(t.valueOf(),this.range)&&n.push("selected")),n},fill:function(){var i,r=new Date(this.viewDate),o=r.getUTCFullYear(),s=r.getUTCMonth(),a=this.o.startDate!==-(1/0)?this.o.startDate.getUTCFullYear():-(1/0),l=this.o.startDate!==-(1/0)?this.o.startDate.getUTCMonth():-(1/0),c=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,u=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,h=f[this.o.language].today||f.en.today||"",d=f[this.o.language].clear||f.en.clear||"";this.picker.find(".rlobdatepicker-days thead th.rlobdatepicker-switch").text(f[this.o.language].months[s]+" "+o),this.picker.find("tfoot th.today").text(h).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.clear").text(d).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var p=n(o,s-1,28),m=g.getDaysInMonth(p.getUTCFullYear(),p.getUTCMonth());p.setUTCDate(m),p.setUTCDate(m-(p.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(p);v.setUTCDate(v.getUTCDate()+42),v=v.valueOf();for(var b,y=[];p.valueOf()<v;){if(p.getUTCDay()===this.o.weekStart&&(y.push("<tr>"),this.o.calendarWeeks)){var w=new Date(+p+(this.o.weekStart-p.getUTCDay()-7)%7*864e5),_=new Date(Number(w)+(11-w.getUTCDay())%7*864e5),x=new Date(Number(x=n(_.getUTCFullYear(),0,1))+(11-x.getUTCDay())%7*864e5),C=(_-x)/864e5/7+1;y.push('<td class="cw">'+C+"</td>")}if(b=this.getClassNames(p),b.push("day"),this.o.beforeShowDay!==e.noop){var $=this.o.beforeShowDay(this._utc_to_local(p));$===t?$={}:"boolean"==typeof $?$={enabled:$}:"string"==typeof $&&($={classes:$}),$.enabled===!1&&b.push("disabled"),$.classes&&(b=b.concat($.classes.split(/\s+/))),$.tooltip&&(i=$.tooltip)}b=e.unique(b),y.push('<td class="'+b.join(" ")+'"'+(i?' title="'+i+'"':"")+">"+p.getUTCDate()+"</td>"),p.getUTCDay()===this.o.weekEnd&&y.push("</tr>"),p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".rlobdatepicker-days tbody").empty().append(y.join(""));var k=this.picker.find(".rlobdatepicker-months").find("th:eq(1)").text(o).end().find("span").removeClass("active");e.each(this.dates,function(e,t){t.getUTCFullYear()===o&&k.eq(t.getUTCMonth()).addClass("active")}),(a>o||o>c)&&k.addClass("disabled"),o===a&&k.slice(0,l).addClass("disabled"),o===c&&k.slice(u+1).addClass("disabled"),y="",o=10*parseInt(o/10,10);var S=this.picker.find(".rlobdatepicker-years").find("th:eq(1)").text(o+"-"+(o+9)).end().find("td");o-=1;for(var T,E=e.map(this.dates,function(e){return e.getUTCFullYear()}),D=-1;11>D;D++)T=["year"],-1===D?T.push("old"):10===D&&T.push("new"),-1!==e.inArray(o,E)&&T.push("active"),(a>o||o>c)&&T.push("disabled"),y+='<span class="'+T.join(" ")+'">'+o+"</span>",o+=1;S.html(y)},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.picker.find(".prev").css(this.o.startDate!==-(1/0)&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?{visibility:"hidden"}:{visibility:"visible"});break;case 1:case 2:this.picker.find(".prev").css(this.o.startDate!==-(1/0)&&t<=this.o.startDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"}),this.picker.find(".next").css(this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()?{visibility:"hidden"}:{visibility:"visible"})}}},click:function(t){t.preventDefault();var i,r,o,s=e(t.target).closest("span, td, th");if(1===s.length)switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"rlobdatepicker-switch":this.showMode(1);break;case"prev":case"next":var a=g.modes[this.viewMode].navStep*("prev"===s[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,a),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,a),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var l=new Date;l=n(l.getFullYear(),l.getMonth(),l.getDate(),0,0,0),this.showMode(-2);var c="linked"===this.o.todayBtn?null:"view";this._setDate(l,c);break;case"clear":var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":s.is(".disabled")||(this.viewDate.setUTCDate(1),s.is(".month")?(o=1,r=s.parent().find("span").index(s),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(r),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(n(i,r,o))):(o=1,r=0,i=parseInt(s.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(n(i,r,o))),this.showMode(-1),this.fill());break;case"td":s.is(".day")&&!s.is(".disabled")&&(o=parseInt(s.text(),10)||1,i=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),s.is(".old")?0===r?(r=11,i-=1):r-=1:s.is(".new")&&(11===r?(r=0,i+=1):r+=1),this._setDate(n(i,r,o)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);if(e?-1!==t?this.dates.remove(t):this.dates.push(e):this.dates.clear(),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(e,t){t&&"date"!==t||this._toggle_multidate(e&&new Date(e)),t&&"view"!==t||(this.viewDate=e&&new Date(e)),this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),!this.o.autoclose||t&&"date"!==t||this.hide()},moveMonth:function(e,n){if(!e)return t;if(!n)return e;var i,r,o=new Date(e.valueOf()),s=o.getUTCDate(),a=o.getUTCMonth(),l=Math.abs(n);if(n=n>0?1:-1,1===l)r=-1===n?function(){return o.getUTCMonth()===a}:function(){return o.getUTCMonth()!==i},i=a+n,o.setUTCMonth(i),(0>i||i>11)&&(i=(i+12)%12);else{for(var c=0;l>c;c++)o=this.moveMonth(o,n);i=o.getUTCMonth(),o.setUTCDate(s),r=function(){return i!==o.getUTCMonth()}}for(;r();)o.setUTCDate(--s),o.setUTCMonth(i);return o},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))return void(27===e.keyCode&&this.show());var t,n,r,o=!1,s=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37===e.keyCode?-1:1,e.ctrlKey?(n=this.moveYear(this.dates.get(-1)||i(),t),r=this.moveYear(s,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(n=this.moveMonth(this.dates.get(-1)||i(),t),r=this.moveMonth(s,t),this._trigger("changeMonth",this.viewDate)):(n=new Date(this.dates.get(-1)||i()),n.setUTCDate(n.getUTCDate()+t),r=new Date(s),r.setUTCDate(s.getUTCDate()+t)),this.dateWithinRange(n)&&(this.focusDate=this.viewDate=r,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38===e.keyCode?-1:1,e.ctrlKey?(n=this.moveYear(this.dates.get(-1)||i(),t),r=this.moveYear(s,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(n=this.moveMonth(this.dates.get(-1)||i(),t),r=this.moveMonth(s,t),this._trigger("changeMonth",this.viewDate)):(n=new Date(this.dates.get(-1)||i()),n.setUTCDate(n.getUTCDate()+7*t),r=new Date(s),r.setUTCDate(s.getUTCDate()+7*t)),this.dateWithinRange(n)&&(this.focusDate=this.viewDate=r,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:s=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(s),o=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(o){this._trigger(this.dates.length?"changeDate":"clearDate");var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".rlobdatepicker-"+g.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var u=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).rlobdatepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("rlobdatepicker")}),this.updateDates()};u.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var n=e(t.target).data("rlobdatepicker"),i=n.getUTCDate(),r=e.inArray(t.target,this.inputs),o=this.inputs.length;if(-1!==r){if(e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(i)}),i<this.dates[r])for(;r>=0&&i<this.dates[r];)this.pickers[r--].setUTCDate(i);else if(i>this.dates[r])for(;o>r&&i>this.dates[r];)this.pickers[r++].setUTCDate(i);this.updateDates(),delete this.updating}}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().rlobdatepicker}};var h=e.fn.rlobdatepicker;e.fn.rlobdatepicker=function(n){var i=Array.apply(null,arguments);i.shift();var r;return this.each(function(){var a=e(this),l=a.data("rlobdatepicker"),h="object"==typeof n&&n;if(!l){var p=o(this,"date"),f=e.extend({},d,p,h),g=s(f.language),m=e.extend({},d,g,p,h);if(a.is(".input-daterange")||m.inputs){var v={inputs:m.inputs||a.find("input").toArray()};a.data("rlobdatepicker",l=new u(this,e.extend(m,v)))}else a.data("rlobdatepicker",l=new c(this,m))}return"string"==typeof n&&"function"==typeof l[n]&&(r=l[n].apply(l,i),r!==t)?!1:void 0}),r!==t?r:this};var d=e.fn.rlobdatepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-(1/0),startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=e.fn.rlobdatepicker.locale_opts=["format","rtl","weekStart"];e.fn.rlobdatepicker.Constructor=c;var f=e.fn.rlobdatepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},g={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,g.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\x00").split("\x00"),n=e.match(this.validParts);if(!t||!t.length||!n||0===n.length)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(i,r,o){function s(){var e=this.slice(0,d[u].length),t=d[u].slice(0,e.length);return e===t}if(!i)return t;if(i instanceof Date)return i;"string"==typeof r&&(r=g.parseFormat(r));var a,l,u,h=/([\-+]\d+)([dmwy])/,d=i.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(i)){for(i=new Date,u=0;u<d.length;u++)switch(a=h.exec(d[u]),l=parseInt(a[1]),a[2]){case"d":i.setUTCDate(i.getUTCDate()+l);break;case"m":i=c.prototype.moveMonth.call(c.prototype,i,l);break;case"w":i.setUTCDate(i.getUTCDate()+7*l);break;case"y":i=c.prototype.moveYear.call(c.prototype,i,l)}return n(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),0,0,0)}d=i&&i.match(this.nonpunctuation)||[],i=new Date;var p,m,v={},b=["yyyy","yy","M","MM","m","mm","d","dd"],y={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!==t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};y.M=y.MM=y.mm=y.m,y.dd=y.d,i=n(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0);var w=r.parts.slice();if(d.length!==w.length&&(w=e(w).filter(function(t,n){return-1!==e.inArray(n,b)}).toArray()),d.length===w.length){var _;for(u=0,_=w.length;_>u;u++){if(p=parseInt(d[u],10),a=w[u],isNaN(p))switch(a){case"MM":m=e(f[o].months).filter(s),p=e.inArray(m[0],f[o].months)+1;break;case"M":m=e(f[o].monthsShort).filter(s),p=e.inArray(m[0],f[o].monthsShort)+1}v[a]=p}var x,C;for(u=0;u<b.length;u++)C=b[u],C in v&&!isNaN(v[C])&&(x=new Date(i),y[C](x,v[C]),isNaN(x)||(i=x))}return i},formatDate:function(t,n,i){if(!t)return"";"string"==typeof n&&(n=g.parseFormat(n));var r={d:t.getUTCDate(),D:f[i].daysShort[t.getUTCDay()],DD:f[i].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:f[i].monthsShort[t.getUTCMonth()],MM:f[i].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};r.dd=(r.d<10?"0":"")+r.d,r.mm=(r.m<10?"0":"")+r.m,t=[];for(var o=e.extend([],n.separators),s=0,a=n.parts.length;a>=s;s++)o.length&&t.push(o.shift()),t.push(r[n.parts[s]]);return t.join("")},headTemplate:'<thead><tr><th class="prev"><i class="fa fa-angle-left"></i></th><th colspan="5" class="rlobdatepicker-switch"></th><th class="next"><i class="fa fa-angle-right"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};g.template='<div class="rlobdatepicker"><div class="rlobdatepicker-days"><table class=" table-condensed">'+g.headTemplate+"<tbody></tbody>"+g.footTemplate+'</table></div><div class="rlobdatepicker-months"><table class="table-condensed">'+g.headTemplate+g.contTemplate+g.footTemplate+'</table></div><div class="rlobdatepicker-years"><table class="table-condensed">'+g.headTemplate+g.contTemplate+g.footTemplate+"</table></div></div>",
e.fn.rlobdatepicker.DPGlobal=g,e.fn.rlobdatepicker.noConflict=function(){return e.fn.rlobdatepicker=h,this},e(document).on("focus.rlobdatepicker.data-api click.rlobdatepicker.data-api",'[data-provide="rlobdatepicker"]',function(t){var n=e(this);n.data("rlobdatepicker")||(t.preventDefault(),n.rlobdatepicker("show"))}),e(function(){e('[data-provide="rlobdatepicker-inline"]').rlobdatepicker()})}(window.jQuery),!function(e,t,n,i){"use strict";var r="datepaginator",o=function(t,n){this._element=t,this.$element=e(t),this._init(n)};o.defaults={fillWidth:!0,highlightSelectedDate:!0,highlightToday:!0,hint:"dddd, Do MMMM YYYY",injectStyle:!0,itemWidth:35,navItemWidth:20,offDays:"Sat,Sun",offDaysFormat:"ddd",onSelectedDateChanged:null,selectedDate:moment().clone().startOf("day"),selectedDateFormat:"YYYY-MM-DD",selectedItemWidth:140,showCalendar:!0,showOffDays:!0,showStartOfWeek:!0,size:i,startOfWeek:"Mon",startOfWeekFormat:"ddd",squareEdges:!1,text:"ddd<br/>Do",textSelected:"dddd<br/>Do, MMMM YYYY",useBootstrap2:!1,width:0},o.prototype={setSelectedDate:function(e,t){this._setSelectedDate(moment(e,t?t:this.options.selectedDateFormat)),this._render()},remove:function(){this._destroy(),e.removeData(this,"plugin_"+r)},_init:function(t){this.options=e.extend({},o.defaults,t),this.options.width?this.options.fillWidth=!1:(this.options.width=this.$element.width(),this.options.fillWidth=!0),"string"==typeof this.options.selectedDate&&(this.options.selectedDate=moment(this.options.selectedDate,this.options.selectedDateFormat).clone().startOf("day")),"small"===this.options.size?this.options.size="sm":"large"===this.options.size&&(this.options.size="lg"),this._destroy(),this._subscribeEvents(),this._render()},_unsubscribeEvents:function(){this.$element.off("click"),this.$element.off("selectedDateChanged")},_subscribeEvents:function(){this._unsubscribeEvents(),this.$element.on("click",e.proxy(this._clickedHandler,this)),"function"==typeof this.options.onSelectedDateChanged&&this.$element.on("selectedDateChanged",this.options.onSelectedDateChanged),this.options.fillWidth&&e(t).on("resize",e.proxy(this._resize,this))},_destroy:function(){this.initialized&&(this.$calendar&&this.$calendar.rlobdatepicker("remove"),this.$wrapper.remove(),this.$wrapper=null,this._unsubscribeEvents()),this.initialized=!1},_clickedHandler:function(t){t.preventDefault();var n=e(t.target),i=n.attr("class");-1!=i.indexOf("dp-nav-left")?this._back():-1!=i.indexOf("dp-nav-right")?this._forward():-1!=i.indexOf("dp-item")&&this._select(n.attr("data-moment"))},_setSelectedDate:function(e){!1===e.isSame(this.options.selectedDate)&&(this.options.selectedDate=e.startOf("day"),this.$element.trigger("selectedDateChanged",[e.clone()]))},_back:function(){this._setSelectedDate(this.options.selectedDate.clone().subtract("day",1)),this._render()},_forward:function(){this._setSelectedDate(this.options.selectedDate.clone().add("day",1)),this._render()},_select:function(e){this._setSelectedDate(moment(e,this.options.selectedDateFormat)),this._render()},_calendarSelect:function(e){this._setSelectedDate(moment(e.date)),this._render()},_resize:function(){this.options.width=this.$element.width(),this._render()},_render:function(){var t=this;this.initialized?this.$calendar&&this.$calendar.rlobdatepicker("remove"):(this.$element.addClass(this.options.useBootstrap2?"pagination":"").removeClass("datepaginator datepaginator-sm datepaginator-lg").addClass("sm"===this.options.size?"datepaginator-sm":"lg"===this.options.size?"datepaginator-lg":"datepaginator"),this.$wrapper=e(this._template.list),this.$leftNav=e(this._template.listItem).append(e(this._template.navItem).addClass("dp-nav-left").addClass("sm"===this.options.size?"dp-nav-sm":"lg"===this.options.size?"dp-nav-lg":"").addClass(this.options.squareEdges?"dp-nav-square-edges":"").append(e(this._template.icon).addClass("fa-angle-left").addClass("dp-nav-left")).width(this.options.navItemWidth)),this.$rightNav=e(this._template.listItem).append(e(this._template.navItem).addClass("dp-nav-right").addClass("sm"===this.options.size?"dp-nav-sm":"lg"===this.options.size?"dp-nav-lg":"").addClass(this.options.squareEdges?"dp-nav-square-edges":"").append(e(this._template.icon).addClass("fa-angle-right").addClass("dp-nav-right")).width(this.options.navItemWidth)),this.$calendar=this.options.showCalendar?e(this._template.calendar):i,this._injectStyle(),this.initialized=!0),this.$element.empty().append(this.$wrapper.empty()),this.$wrapper.append(this.$leftNav),e.each(this._buildData(),function(n,i){var r=e(t._template.dateItem).attr("data-moment",i.m).attr("title",i.hint).width(i.itemWidth);i.isSelected&&t.options.highlightSelectedDate&&r.addClass("dp-selected"),i.isToday&&t.options.highlightToday&&r.addClass("dp-today"),i.isStartOfWeek&&t.options.showStartOfWeek&&r.addClass("dp-divider"),i.isOffDay&&t.options.showOffDays&&r.addClass("dp-off"),i.isSelected&&t.options.showCalendar&&r.append(t.$calendar),"sm"===t.options.size?r.addClass("dp-item-sm"):"lg"===t.options.size&&r.addClass("dp-item-lg"),r.append(i.text),t.$wrapper.append(e(t._template.listItem).append(r))}),this.$wrapper.append(this.$rightNav),this.$calendar&&this.$calendar.rlobdatepicker({autoclose:!0,forceParse:!0,startView:0,minView:0,todayHighlight:!0}).rlobdatepicker("update",this.options.selectedDate.toDate()).on("changeDate",e.proxy(this._calendarSelect,this))},_injectStyle:function(){this.options.injectStyle&&!n.getElementById("bootstrap-datepaginator-style")&&e("<style type='text/css' id='bootstrap-datepaginator-style'> "+this._css+" </style>").appendTo("head")},_buildData:function(){for(var e=this.options.width-(this.options.selectedItemWidth-this.options.itemWidth+2*this.options.navItemWidth),t=Math.floor(e/this.options.itemWidth),n=parseInt(t/2),i=Math.floor(e/t),r=Math.floor(this.options.selectedItemWidth+(e-t*i)),o=moment().startOf("day"),s=this.options.selectedDate.clone().subtract("days",n),a=this.options.selectedDate.clone().add("days",t-n),l=new Array,c=s;c.isBefore(a);c.add("days",1))l[l.length]={m:c.clone().format(this.options.selectedDateFormat),isSelected:c.isSame(this.options.selectedDate)?!0:!1,isToday:c.isSame(o)?!0:!1,isOffDay:-1!==this.options.offDays.split(",").indexOf(c.format(this.options.offDaysFormat))?!0:!1,isStartOfWeek:-1!==this.options.startOfWeek.split(",").indexOf(c.format(this.options.startOfWeekFormat))?!0:!1,text:c.format(c.isSame(this.options.selectedDate)?this.options.textSelected:this.options.text),hint:c.format(this.options.hint),itemWidth:c.isSame(this.options.selectedDate)?r:i};return l},_template:{list:'<ul class="pagination"></ul>',listItem:"<li></li>",navItem:'<a href="#" class="dp-nav"></a>',dateItem:'<a href="#" class="dp-item"></a>',icon:'<i class="fa"></i>',calendar:'<i id="dp-calendar" class="glyphicon glyphicon-calendar"></i>'},_css:".datepaginator{font-size:12px;height:60px}.datepaginator-sm{font-size:10px;height:40px}.datepaginator-lg{font-size:14px;height:80px}.pagination{margin:0;padding:0;white-space:nowrap}.dp-nav{height:60px;padding:22px 0!important;width:20px;margin:0!important;text-align:center}.dp-nav-square-edges{border-radius:0!important}.dp-item{height:60px;padding:13px 0!important;width:35px;margin:0!important;border-left-style:hidden!important;text-align:center}.dp-item-sm{height:40px!important;padding:5px!important}.dp-item-lg{height:80px!important;padding:22px 0!important}.dp-nav-sm{height:40px!important;padding:11px 0!important}.dp-nav-lg{height:80px!important;padding:33px 0!important}a.dp-nav-right{border-left-style:hidden!important}.dp-divider{border-left:2px solid #ddd!important}.dp-off{background-color:#F0F0F0!important}.dp-today{background-color:#88B5DB!important;color:#fff!important}.dp-selected{background-color:#428bca!important;color:#fff!important;width:140px}#dp-calendar{padding:3px 5px 0 0!important;position:absolute;right:0;top:10}"};var s=function(e){t.console&&t.console.error(e)};e.fn[r]=function(t,n){return this.each(function(){var i=e.data(this,"plugin_"+r);"string"==typeof t?i?e.isFunction(i[t])&&"_"!==t.charAt(0)?("string"==typeof n&&(n=[n]),i[t].apply(i,n)):s("No such method : "+t):s("Not initialized, can not call method : "+t):i?i._init(t):e.data(this,"plugin_"+r,new o(this,t))})}}(jQuery,window,document);var UIDatepaginator=function(){return{init:function(){$("#datepaginator_sample_1").datepaginator(),$("#datepaginator_sample_2").datepaginator({size:"large"}),$("#datepaginator_sample_3").datepaginator({size:"small"}),$("#datepaginator_sample_4").datepaginator({onSelectedDateChanged:function(e,t){alert("Selected date: "+moment(t).format("Do, MMM YYYY"))}})}}}();!function(e){var t=function(t,i){if(this.$element=e(t),this.$note=e('<div class="alert"></div>'),this.options=e.extend(!0,{},e.fn.notify.defaults,i),this.options.transition?"fade"==this.options.transition?this.$note.addClass("in").addClass(this.options.transition):this.$note.addClass(this.options.transition):this.$note.addClass("fade").addClass("in"),this.$note.addClass(this.options.type?"alert-"+this.options.type:"alert-success"),this.options.message||""===this.$element.data("message")?"object"==typeof this.options.message?this.options.message.html?this.$note.html(this.options.message.html):this.options.message.text&&this.$note.text(this.options.message.text):this.$note.html(this.options.message):this.$note.html(this.$element.data("message")),this.options.closable){var r=e('<a class="close pull-right" href="#">&times;</a>');e(r).on("click",e.proxy(n,this)),this.$note.prepend(r)}return this},n=function(){return this.options.onClose(),e(this.$note).remove(),this.options.onClosed(),!1};t.prototype.show=function(){this.options.fadeOut.enabled&&this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",e.proxy(n,this)),this.$element.append(this.$note),this.$note.alert()},t.prototype.hide=function(){this.options.fadeOut.enabled?this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",e.proxy(n,this)):n.call(this)},e.fn.notify=function(e){return new t(this,e)},e.fn.notify.defaults={type:"success",closable:!0,transition:"fade",fadeOut:{enabled:!0,delay:3e3},message:null,onClose:function(){},onClosed:function(){}}}(window.jQuery),function(){var e,t,n,i,r,o,s,a,l=[].slice,c={}.hasOwnProperty,u=function(e,t){function n(){this.constructor=e}for(var i in t)c.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};s=function(){},t=function(){function e(){}return e.prototype.addEventListener=e.prototype.on,e.prototype.on=function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this},e.prototype.emit=function(){var e,t,n,i,r,o;if(i=arguments[0],e=2<=arguments.length?l.call(arguments,1):[],this._callbacks=this._callbacks||{},n=this._callbacks[i])for(r=0,o=n.length;o>r;r++)t=n[r],t.apply(this,e);return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=e.prototype.off,e.prototype.removeEventListener=e.prototype.off,e.prototype.off=function(e,t){var n,i,r,o,s;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(i=this._callbacks[e],!i)return this;if(1===arguments.length)return delete this._callbacks[e],this;for(r=o=0,s=i.length;s>o;r=++o)if(n=i[r],n===t){i.splice(r,1);break}return this},e}(),e=function(e){function n(e,t){var r,o,s;if(this.element=e,this.version=n.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(n.instances.push(this),this.element.dropzone=this,r=null!=(s=n.optionsForElement(this.element))?s:{},this.options=i({},this.defaultOptions,r,null!=t?t:{}),this.options.forceFallback||!n.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(o=this.getExistingFallback())&&o.parentNode&&o.parentNode.removeChild(o),this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?n.getElement(this.options.previewsContainer,"previewsContainer"):this.element),this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:n.getElements(this.options.clickable,"clickable")),this.init()}var i,r;return u(n,e),n.prototype.Emitter=t,n.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],n.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,filesizeBase:1e3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload!",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return s},forceFallback:!1,fallback:function(){var e,t,i,r,o,s;for(this.element.className=""+this.element.className+" dz-browser-not-supported",s=this.element.getElementsByTagName("div"),r=0,o=s.length;o>r;r++)e=s[r],/(^| )dz-message($| )/.test(e.className)&&(t=e,e.className="dz-message");return t||(t=n.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(t)),i=t.getElementsByTagName("span")[0],i&&(i.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,n,i;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},n=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=n*t.optHeight:null==t.optHeight&&(t.optHeight=1/n*t.optWidth),i=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):n>i?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*i):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/i),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:s,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:s,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var t,i,r,o,s,a,l,c,u,h,d,p,f;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=n.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),h=e.previewElement.querySelectorAll("[data-dz-name]"),o=0,l=h.length;l>o;o++)t=h[o],t.textContent=e.name;for(d=e.previewElement.querySelectorAll("[data-dz-size]"),s=0,c=d.length;c>s;s++)t=d[s],t.innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=n.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),i=function(t){return function(i){return i.preventDefault(),i.stopPropagation(),e.status===n.UPLOADING?n.confirm(t.options.dictCancelUploadConfirmation,function(){return t.removeFile(e)}):t.options.dictRemoveFileConfirmation?n.confirm(t.options.dictRemoveFileConfirmation,function(){return t.removeFile(e)}):t.removeFile(e)}}(this),p=e.previewElement.querySelectorAll("[data-dz-remove]"),f=[],a=0,u=p.length;u>a;a++)r=p[a],f.push(r.addEventListener("click",i));return f}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var n,i,r,o;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),o=e.previewElement.querySelectorAll("[data-dz-thumbnail]"),i=0,r=o.length;r>i;i++)n=o[i],n.alt=e.name,n.src=t;return setTimeout(function(t){return function(){return e.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(e,t){var n,i,r,o,s;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),o=e.previewElement.querySelectorAll("[data-dz-errormessage]"),s=[],i=0,r=o.length;r>i;i++)n=o[i],s.push(n.textContent=t);return s}},errormultiple:s,processing:function(e){return e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink)?e._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:s,uploadprogress:function(e,t,n){var i,r,o,s,a;if(e.previewElement){for(s=e.previewElement.querySelectorAll("[data-dz-uploadprogress]"),a=[],r=0,o=s.length;o>r;r++)i=s[r],a.push("PROGRESS"===i.nodeName?i.value=t:i.style.width=""+t+"%");return a}},totaluploadprogress:s,sending:s,sendingmultiple:s,success:function(e){return e.previewElement?e.previewElement.classList.add("dz-success"):void 0},successmultiple:s,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:s,complete:function(e){return e._removeLink&&(e._removeLink.textContent=this.options.dictRemoveFile),e.previewElement?e.previewElement.classList.add("dz-complete"):void 0},completemultiple:s,maxfilesexceeded:s,maxfilesreached:s,queuecomplete:s,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'},i=function(){var e,t,n,i,r,o,s;for(i=arguments[0],n=2<=arguments.length?l.call(arguments,1):[],o=0,s=n.length;s>o;o++){t=n[o];for(e in t)r=t[e],i[e]=r}return i},n.prototype.getAcceptedFiles=function(){var e,t,n,i,r;for(i=this.files,r=[],t=0,n=i.length;n>t;t++)e=i[t],e.accepted&&r.push(e);return r},n.prototype.getRejectedFiles=function(){var e,t,n,i,r;for(i=this.files,r=[],t=0,n=i.length;n>t;t++)e=i[t],e.accepted||r.push(e);return r},n.prototype.getFilesWithStatus=function(e){var t,n,i,r,o;for(r=this.files,o=[],n=0,i=r.length;i>n;n++)t=r[n],t.status===e&&o.push(t);return o},n.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(n.QUEUED)},n.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(n.UPLOADING)},n.prototype.getActiveFiles=function(){var e,t,i,r,o;for(r=this.files,o=[],t=0,i=r.length;i>t;t++)e=r[t],(e.status===n.UPLOADING||e.status===n.QUEUED)&&o.push(e);return o},n.prototype.init=function(){var e,t,i,r,o,s,a;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(n.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(i=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null==e.options.maxFiles||e.options.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dz-hidden-input",null!=e.options.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.acceptedFiles),null!=e.options.capture&&e.hiddenFileInput.setAttribute("capture",e.options.capture),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,n,r,o;if(n=e.hiddenFileInput.files,n.length)for(r=0,o=n.length;o>r;r++)t=n[r],e.addFile(t);return i()})}}(this))(),this.URL=null!=(s=window.URL)?s:window.webkitURL,a=this.events,r=0,o=a.length;o>r;r++)e=a[r],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(t){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),t=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(n){return t(n),e.emit("dragenter",n)}}(this),dragover:function(e){return function(n){var i;try{i=n.dataTransfer.effectAllowed}catch(r){}return n.dataTransfer.dropEffect="move"===i||"linkMove"===i?"move":"copy",t(n),e.emit("dragover",n)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(n){return t(n),e.drop(n)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(t){return e.listeners.push({element:t,events:{click:function(i){return t!==e.element||i.target===e.element||n.elementInside(i.target,e.element.querySelector(".dz-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},n.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,n.instances.splice(n.instances.indexOf(this),1)},n.prototype.updateTotalUploadProgress=function(){var e,t,n,i,r,o,s,a;if(i=0,n=0,e=this.getActiveFiles(),e.length){for(a=this.getActiveFiles(),o=0,s=a.length;s>o;o++)t=a[o],i+=t.upload.bytesSent,n+=t.upload.total;r=100*i/n}else r=100;return this.emit("totaluploadprogress",r,n,i)},n.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},n.prototype.getFallbackForm=function(){var e,t,i,r;return(e=this.getExistingFallback())?e:(i='<div class="dz-fallback">',this.options.dictFallbackText&&(i+="<p>"+this.options.dictFallbackText+"</p>"),i+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',t=n.createElement(i),"FORM"!==this.element.tagName?(r=n.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),r.appendChild(t)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=r?r:t)},n.prototype.getExistingFallback=function(){var e,t,n,i,r,o;for(t=function(e){var t,n,i;for(n=0,i=e.length;i>n;n++)if(t=e[n],/(^| )fallback($| )/.test(t.className))return t},o=["div","form"],i=0,r=o.length;r>i;i++)if(n=o[i],e=t(this.element.getElementsByTagName(n)))return e},n.prototype.setupEventListeners=function(){var e,t,n,i,r,o,s;for(o=this.listeners,s=[],i=0,r=o.length;r>i;i++)e=o[i],s.push(function(){var i,r;i=e.events,r=[];for(t in i)n=i[t],r.push(e.element.addEventListener(t,n,!1));return r}());return s},n.prototype.removeEventListeners=function(){var e,t,n,i,r,o,s;for(o=this.listeners,s=[],i=0,r=o.length;r>i;i++)e=o[i],s.push(function(){var i,r;i=e.events,r=[];for(t in i)n=i[t],r.push(e.element.removeEventListener(t,n,!1));return r}());return s},n.prototype.disable=function(){var e,t,n,i,r;for(this.clickableElements.forEach(function(e){return e.classList.remove("dz-clickable")}),this.removeEventListeners(),i=this.files,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(this.cancelUpload(e));return r},n.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dz-clickable")}),this.setupEventListeners()},n.prototype.filesize=function(e){var t,n,i,r,o,s,a,l;for(s=["TB","GB","MB","KB","b"],i=r=null,n=a=0,l=s.length;l>a;n=++a)if(o=s[n],t=Math.pow(this.options.filesizeBase,4-n)/10,e>=t){i=e/Math.pow(this.options.filesizeBase,4-n),r=o;break}return i=Math.round(10*i)/10,"<strong>"+i+"</strong> "+r},n.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},n.prototype.drop=function(e){var t,n;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(n=e.dataTransfer.items,n&&n.length&&null!=n[0].webkitGetAsEntry?this._addFilesFromItems(n):this.handleFiles(t)))},n.prototype.paste=function(e){var t,n;return null!=(null!=e&&null!=(n=e.clipboardData)?n.items:void 0)?(this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0):void 0},n.prototype.handleFiles=function(e){var t,n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(this.addFile(t));return r},n.prototype._addFilesFromItems=function(e){var t,n,i,r,o;for(o=[],i=0,r=e.length;r>i;i++)n=e[i],o.push(null!=n.webkitGetAsEntry&&(t=n.webkitGetAsEntry())?t.isFile?this.addFile(n.getAsFile()):t.isDirectory?this._addFilesFromDirectory(t,t.name):void 0:null!=n.getAsFile&&(null==n.kind||"file"===n.kind)?this.addFile(n.getAsFile()):void 0);return o},n.prototype._addFilesFromDirectory=function(e,t){var n,i;return n=e.createReader(),i=function(e){return function(n){var i,r,o;for(r=0,o=n.length;o>r;r++)i=n[r],i.isFile?i.file(function(n){return e.options.ignoreHiddenFiles&&"."===n.name.substring(0,1)?void 0:(n.fullPath=""+t+"/"+n.name,e.addFile(n))}):i.isDirectory&&e._addFilesFromDirectory(i,""+t+"/"+i.name)}}(this),n.readEntries(i,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},n.prototype.accept=function(e,t){return e.size>1024*this.options.maxFilesize*1024?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):n.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,t):t(this.options.dictInvalidFileType)},n.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=n.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(n){return n?(e.accepted=!1,t._errorProcessing([e],n)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}}(this))},n.prototype.enqueueFiles=function(e){var t,n,i;for(n=0,i=e.length;i>n;n++)t=e[n],this.enqueueFile(t);return null},n.prototype.enqueueFile=function(e){if(e.status!==n.ADDED||e.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");
return e.status=n.QUEUED,this.options.autoProcessQueue?setTimeout(function(e){return function(){return e.processQueue()}}(this),0):void 0},n.prototype._thumbnailQueue=[],n.prototype._processingThumbnail=!1,n.prototype._enqueueThumbnail=function(e){return this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},n.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},n.prototype.removeFile=function(e){return e.status===n.UPLOADING&&this.cancelUpload(e),this.files=a(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},n.prototype.removeAllFiles=function(e){var t,i,r,o;for(null==e&&(e=!1),o=this.files.slice(),i=0,r=o.length;r>i;i++)t=o[i],(t.status!==n.UPLOADING||e)&&this.removeFile(t);return null},n.prototype.createThumbnail=function(e,t){var n;return n=new FileReader,n.onload=function(i){return function(){return"image/svg+xml"===e.type?(i.emit("thumbnail",e,n.result),void(null!=t&&t())):i.createThumbnailFromUrl(e,n.result,t)}}(this),n.readAsDataURL(e)},n.prototype.createThumbnailFromUrl=function(e,t,n){var i;return i=document.createElement("img"),i.onload=function(t){return function(){var r,s,a,l,c,u,h,d;return e.width=i.width,e.height=i.height,a=t.options.resize.call(t,e),null==a.trgWidth&&(a.trgWidth=a.optWidth),null==a.trgHeight&&(a.trgHeight=a.optHeight),r=document.createElement("canvas"),s=r.getContext("2d"),r.width=a.trgWidth,r.height=a.trgHeight,o(s,i,null!=(c=a.srcX)?c:0,null!=(u=a.srcY)?u:0,a.srcWidth,a.srcHeight,null!=(h=a.trgX)?h:0,null!=(d=a.trgY)?d:0,a.trgWidth,a.trgHeight),l=r.toDataURL("image/png"),t.emit("thumbnail",e,l),null!=n?n():void 0}}(this),null!=n&&(i.onerror=n),i.src=t},n.prototype.processQueue=function(){var e,t,n,i;if(t=this.options.parallelUploads,n=this.getUploadingFiles().length,e=n,!(n>=t)&&(i=this.getQueuedFiles(),i.length>0)){if(this.options.uploadMultiple)return this.processFiles(i.slice(0,t-n));for(;t>e;){if(!i.length)return;this.processFile(i.shift()),e++}}},n.prototype.processFile=function(e){return this.processFiles([e])},n.prototype.processFiles=function(e){var t,i,r;for(i=0,r=e.length;r>i;i++)t=e[i],t.processing=!0,t.status=n.UPLOADING,this.emit("processing",t);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},n.prototype._getFilesWithXhr=function(e){var t,n;return n=function(){var n,i,r,o;for(r=this.files,o=[],n=0,i=r.length;i>n;n++)t=r[n],t.xhr===e&&o.push(t);return o}.call(this)},n.prototype.cancelUpload=function(e){var t,i,r,o,s,a,l;if(e.status===n.UPLOADING){for(i=this._getFilesWithXhr(e.xhr),r=0,s=i.length;s>r;r++)t=i[r],t.status=n.CANCELED;for(e.xhr.abort(),o=0,a=i.length;a>o;o++)t=i[o],this.emit("canceled",t);this.options.uploadMultiple&&this.emit("canceledmultiple",i)}else((l=e.status)===n.ADDED||l===n.QUEUED)&&(e.status=n.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));return this.options.autoProcessQueue?this.processQueue():void 0},r=function(){var e,t;return t=arguments[0],e=2<=arguments.length?l.call(arguments,1):[],"function"==typeof t?t.apply(this,e):t},n.prototype.uploadFile=function(e){return this.uploadFiles([e])},n.prototype.uploadFiles=function(e){var t,o,s,a,l,c,u,h,d,p,f,g,m,v,b,y,w,_,x,C,$,k,S,T,E,D,A,O,I,M,P,R,N,F;for(x=new XMLHttpRequest,C=0,T=e.length;T>C;C++)t=e[C],t.xhr=x;g=r(this.options.method,e),w=r(this.options.url,e),x.open(g,w,!0),x.withCredentials=!!this.options.withCredentials,b=null,s=function(n){return function(){var i,r,o;for(o=[],i=0,r=e.length;r>i;i++)t=e[i],o.push(n._errorProcessing(e,b||n.options.dictResponseError.replace("{{statusCode}}",x.status),x));return o}}(this),y=function(n){return function(i){var r,o,s,a,l,c,u,h,d;if(null!=i)for(o=100*i.loaded/i.total,s=0,c=e.length;c>s;s++)t=e[s],t.upload={progress:o,total:i.total,bytesSent:i.loaded};else{for(r=!0,o=100,a=0,u=e.length;u>a;a++)t=e[a],(100!==t.upload.progress||t.upload.bytesSent!==t.upload.total)&&(r=!1),t.upload.progress=o,t.upload.bytesSent=t.upload.total;if(r)return}for(d=[],l=0,h=e.length;h>l;l++)t=e[l],d.push(n.emit("uploadprogress",t,o,t.upload.bytesSent));return d}}(this),x.onload=function(t){return function(i){var r;if(e[0].status!==n.CANCELED&&4===x.readyState){if(b=x.responseText,x.getResponseHeader("content-type")&&~x.getResponseHeader("content-type").indexOf("application/json"))try{b=JSON.parse(b)}catch(o){i=o,b="Invalid JSON response from server."}return y(),200<=(r=x.status)&&300>r?t._finished(e,b,i):s()}}}(this),x.onerror=function(t){return function(){return e[0].status!==n.CANCELED?s():void 0}}(this),v=null!=(I=x.upload)?I:x,v.onprogress=y,c={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&i(c,this.options.headers);for(a in c)l=c[a],x.setRequestHeader(a,l);if(o=new FormData,this.options.params){M=this.options.params;for(f in M)_=M[f],o.append(f,_)}for($=0,E=e.length;E>$;$++)t=e[$],this.emit("sending",t,x,o);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,x,o),"FORM"===this.element.tagName)for(P=this.element.querySelectorAll("input, textarea, select, button"),k=0,D=P.length;D>k;k++)if(h=P[k],d=h.getAttribute("name"),p=h.getAttribute("type"),"SELECT"===h.tagName&&h.hasAttribute("multiple"))for(R=h.options,S=0,A=R.length;A>S;S++)m=R[S],m.selected&&o.append(d,m.value);else(!p||"checkbox"!==(N=p.toLowerCase())&&"radio"!==N||h.checked)&&o.append(d,h.value);for(u=O=0,F=e.length-1;F>=0?F>=O:O>=F;u=F>=0?++O:--O)o.append(this._getParamName(u),e[u],e[u].name);return x.send(o)},n.prototype._finished=function(e,t,i){var r,o,s;for(o=0,s=e.length;s>o;o++)r=e[o],r.status=n.SUCCESS,this.emit("success",r,t,i),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("successmultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},n.prototype._errorProcessing=function(e,t,i){var r,o,s;for(o=0,s=e.length;s>o;o++)r=e[o],r.status=n.ERROR,this.emit("error",r,t,i),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("errormultiple",e,t,i),this.emit("completemultiple",e)),this.options.autoProcessQueue?this.processQueue():void 0},n}(t),e.version="4.0.1",e.options={},e.optionsForElement=function(t){return t.getAttribute("id")?e.options[n(t.getAttribute("id"))]:void 0},e.instances=[],e.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},e.autoDiscover=!0,e.discover=function(){var t,n,i,r,o,s;for(document.querySelectorAll?i=document.querySelectorAll(".dropzone"):(i=[],t=function(e){var t,n,r,o;for(o=[],n=0,r=e.length;r>n;n++)t=e[n],o.push(/(^| )dropzone($| )/.test(t.className)?i.push(t):void 0);return o},t(document.getElementsByTagName("div")),t(document.getElementsByTagName("form"))),s=[],r=0,o=i.length;o>r;r++)n=i[r],s.push(e.optionsForElement(n)!==!1?new e(n):void 0);return s},e.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],e.isBrowserSupported=function(){var t,n,i,r,o;if(t=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(o=e.blacklistedBrowsers,i=0,r=o.length;r>i;i++)n=o[i],n.test(navigator.userAgent)&&(t=!1);else t=!1;else t=!1;return t},a=function(e,t){var n,i,r,o;for(o=[],i=0,r=e.length;r>i;i++)n=e[i],n!==t&&o.push(n);return o},n=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},e.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},e.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},e.getElement=function(e,t){var n;if("string"==typeof e?n=document.querySelector(e):null!=e.nodeType&&(n=e),null==n)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return n},e.getElements=function(e,t){var n,i,r,o,s,a,l,c;if(e instanceof Array){r=[];try{for(o=0,a=e.length;a>o;o++)i=e[o],r.push(this.getElement(i,t))}catch(u){n=u,r=null}}else if("string"==typeof e)for(r=[],c=document.querySelectorAll(e),s=0,l=c.length;l>s;s++)i=c[s],r.push(i);else null!=e.nodeType&&(r=[e]);if(null==r||!r.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return r},e.confirm=function(e,t,n){return window.confirm(e)?t():null!=n?n():void 0},e.isValidFile=function(e,t){var n,i,r,o,s;if(!t)return!0;for(t=t.split(","),i=e.type,n=i.replace(/\/.*$/,""),o=0,s=t.length;s>o;o++)if(r=t[o],r=r.trim(),"."===r.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(r.toLowerCase(),e.name.length-r.length))return!0}else if(/\/\*$/.test(r)){if(n===r.replace(/\/.*$/,""))return!0}else if(i===r)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(t){return this.each(function(){return new e(this,t)})}),"undefined"!=typeof module&&null!==module?module.exports=e:window.Dropzone=e,e.ADDED="added",e.QUEUED="queued",e.ACCEPTED=e.QUEUED,e.UPLOADING="uploading",e.PROCESSING=e.UPLOADING,e.CANCELED="canceled",e.ERROR="error",e.SUCCESS="success",r=function(e){var t,n,i,r,o,s,a,l,c,u;for(a=e.naturalWidth,s=e.naturalHeight,n=document.createElement("canvas"),n.width=1,n.height=s,i=n.getContext("2d"),i.drawImage(e,0,0),r=i.getImageData(0,0,1,s).data,u=0,o=s,l=s;l>u;)t=r[4*(l-1)+3],0===t?o=l:u=l,l=o+u>>1;return c=l/s,0===c?1:c},o=function(e,t,n,i,o,s,a,l,c,u){var h;return h=r(t),e.drawImage(t,n,i,o,s,a,l,c,u/h)},i=function(e,t){var n,i,r,o,s,a,l,c,u;if(r=!1,u=!0,i=e.document,c=i.documentElement,n=i.addEventListener?"addEventListener":"attachEvent",l=i.addEventListener?"removeEventListener":"detachEvent",a=i.addEventListener?"":"on",o=function(n){return"readystatechange"!==n.type||"complete"===i.readyState?(("load"===n.type?e:i)[l](a+n.type,o,!1),!r&&(r=!0)?t.call(e,n.type||n):void 0):void 0},s=function(){var e;try{c.doScroll("left")}catch(t){return e=t,void setTimeout(s,50)}return o("poll")},"complete"!==i.readyState){if(i.createEventObject&&c.doScroll){try{u=!e.frameElement}catch(h){}u&&s()}return i[n](a+"DOMContentLoaded",o,!1),i[n](a+"readystatechange",o,!1),e[n](a+"load",o,!1)}},e._autoDiscoverFunction=function(){return e.autoDiscover?e.discover():void 0},i(window,e._autoDiscoverFunction)}.call(this),angular.module("ngDraggable",[]).service("ngDraggable",[function(){var e=this;e.inputEvent=function(e){return angular.isDefined(e.touches)?e.touches[0]:e}}]).directive("ngDrag",["$rootScope","$parse","$document","$window","ngDraggable",function(e,t,n,i,r){return{restrict:"A",link:function(o,s,a){o.value=a.ngDrag;var l,c,u,h,d,p,f,g,m=!1,v="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,b="touchstart mousedown",y="touchmove mousemove",w="touchend mouseup",_=o.$id,x=null,C=null,$=!1,k=null,S=t(a.ngDragSuccess)||null,T=angular.isDefined(a.allowTransform)?o.$eval(a.allowTransform):!0,E=t(a.ngDragData),D=angular.noop,A=function(){s.attr("draggable","false");var e=s.find("[ng-drag-handle]");e.length&&(g=e),O(!0)},O=function(e){e&&(o.$on("$destroy",I),o.$watch(a.ngDrag,M),o.$watch(a.ngCenterAnchor,P),g?g.on(b,N):s.on(b,N),v||"img"!=s[0].nodeName.toLowerCase()||s.on("mousedown",function(){return!1}))},I=function(e){O(!1)},M=function(e,t){$=e},P=function(e,t){angular.isDefined(e)&&(m=e||"true")},R=function(e){return angular.isDefined(angular.element(e.target).attr("ng-cancel-drag"))},N=function(e){$&&(R(e)||("mousedown"!=e.type||0==e.button)&&(v?(F(),k=setTimeout(function(){F(),L(e)},100),n.on(y,F),n.on(w,F)):L(e)))},F=function(){clearTimeout(k),n.off(y,F),n.off(w,F)},L=function(t){$&&(t.preventDefault(),l=s[0].getBoundingClientRect(),C=T?l:{left:document.body.scrollLeft,top:document.body.scrollTop},s.centerX=s[0].offsetWidth/2,s.centerY=s[0].offsetHeight/2,c=r.inputEvent(t).pageX,u=r.inputEvent(t).pageY,p=c-l.left,f=u-l.top,m?(h=c-s.centerX-i.pageXOffset,d=u-s.centerY-i.pageYOffset):(h=c-p-i.pageXOffset,d=u-f-i.pageYOffset),n.on(y,j),n.on(w,U),D=e.$on("draggable:_triggerHandlerMove",function(e,t){j(t)}))},j=function(t){$&&(t.preventDefault(),s.hasClass("dragging")||(x=E(o),s.addClass("dragging"),e.$broadcast("draggable:start",{x:c,y:u,tx:h,ty:d,event:t,element:s,data:x})),c=r.inputEvent(t).pageX,u=r.inputEvent(t).pageY,m?(h=c-s.centerX-C.left,d=u-s.centerY-C.top):(h=c-p-C.left,d=u-f-C.top),B(h,d),e.$broadcast("draggable:move",{x:c,y:u,tx:h,ty:d,event:t,element:s,data:x,uid:_}))},U=function(t){$&&(t.preventDefault(),e.$broadcast("draggable:end",{x:c,y:u,tx:h,ty:d,event:t,element:s,data:x,callback:H,uid:_}),s.removeClass("dragging"),s.parent().find(".drag-enter").removeClass("drag-enter"),W(),n.off(y,j),n.off(w,U),D())},H=function(e){S&&o.$apply(function(){S(o,{$data:x,$event:e})})},W=function(){s.css(T?{transform:"","z-index":"","-webkit-transform":"","-ms-transform":""}:{position:"",top:"",left:""})},B=function(e,t){s.css(T?{transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","z-index":99999,"-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+t+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+e+", "+t+")"}:{left:e+"px",top:t+"px",position:"fixed"})};A()}}}]).directive("ngDrop",["$parse","$timeout","$window","$document","ngDraggable",function(e,t,n,i,r){return{restrict:"A",link:function(n,r,o){n.value=o.ngDrop,n.isTouching=!1;var s=null,a=n.$id,l=!1,c=e(o.ngDropSuccess),u=e(o.ngDragStart),h=e(o.ngDragStop),d=e(o.ngDragMove),p=function(){f(!0)},f=function(e){e&&(n.$watch(o.ngDrop,m),n.$on("$destroy",g),n.$on("draggable:start",v),n.$on("draggable:move",b),n.$on("draggable:end",y))},g=function(e){f(!1)},m=function(e,t){l=e},v=function(e,i){l&&(w(i.x,i.y,i.element),o.ngDragStart&&t(function(){u(n,{$data:i.data,$event:i})}))},b=function(e,i){l&&(w(i.x,i.y,i.element),o.ngDragMove&&t(function(){d(n,{$data:i.data,$event:i})}))},y=function(e,i){return l&&a!==i.uid?(w(i.x,i.y,i.element)&&(i.callback&&i.callback(i),o.ngDropSuccess&&t(function(){c(n,{$data:i.data,$event:i,$target:n.$eval(n.value)})})),o.ngDragStop&&t(function(){h(n,{$data:i.data,$event:i})}),void _(!1,i.element)):void _(!1,i.element)},w=function(e,t,i){var o=x(e,t);return n.isTouching=o,o&&(s=r),_(o,i),o},_=function(e,t){e?(r.addClass("drag-enter"),t.addClass("drag-over")):s==r&&(s=null,r.removeClass("drag-enter"),t.removeClass("drag-over"))},x=function(e,t){var n=r[0].getBoundingClientRect();return e-=i[0].body.scrollLeft+i[0].documentElement.scrollLeft,t-=i[0].body.scrollTop+i[0].documentElement.scrollTop,e>=n.left&&e<=n.right&&t<=n.bottom&&t>=n.top};p()}}}]).directive("ngDragClone",["$parse","$timeout","ngDraggable",function(e,t,n){return{restrict:"A",link:function(e,t,n){var i,r=!0,o=null;e.clonedData={};var s=function(){i=t.find("img"),t.attr("draggable","false"),i.attr("draggable","false"),d(),a(!0)},a=function(t){t&&(e.$on("draggable:start",c),e.$on("draggable:move",u),e.$on("draggable:end",h),l())},l=function(){i.off("mousedown touchstart touchmove touchend touchcancel",f),i.on("mousedown touchstart touchmove touchend touchcancel",f)},c=function(n,i,s){r=!0,angular.isDefined(i.data.allowClone)&&(r=i.data.allowClone),r&&(e.$apply(function(){e.clonedData=i.data}),t.css("width",i.element[0].offsetWidth),t.css("height",i.element[0].offsetHeight),p(i.tx,i.ty)),o=t[0].getBoundingClientRect()},u=function(e,t){r&&(_tx=t.tx+o.left,_ty=t.ty+o.top,p(_tx,_ty))},h=function(e,t){r&&d()},d=function(){t.css({left:0,top:0,position:"fixed","z-index":-1,visibility:"hidden"})},p=function(e,n){t.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+n+", 0, 1)","z-index":99999,visibility:"visible","-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+e+", "+n+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+e+", "+n+")"})},f=function(e){var t=e;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};s()}}}]).directive("ngPreventDrag",["$parse","$timeout",function(e,t){return{restrict:"A",link:function(e,t,n){var i=function(){t.attr("draggable","false"),r(!0)},r=function(e){e&&t.on("mousedown touchstart touchmove touchend touchcancel",o)},o=function(e){var t=e.originalEvent;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1};i()}}}]).directive("ngCancelDrag",[function(){return{restrict:"A",link:function(e,t,n){t.find("*").attr("ng-cancel-drag","ng-cancel-drag")}}}]).directive("ngDragScroll",["$window","$interval","$timeout","$document","$rootScope",function(e,t,n,i,r){return{restrict:"A",link:function(o,s,a){var l=null,c=null,u={verticalScroll:a.verticalScroll||!0,horizontalScroll:a.horizontalScroll||!0,activationDistance:a.activationDistance||75,scrollDistance:a.scrollDistance||50,scrollInterval:a.scrollInterval||250},h=function(){l=t(function(){if(c){var t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),o=Math.max(document.documentElement.clientHeight,window.innerHeight||0),a=0,l=0;if(u.horizontalScroll&&(c.clientX<u.activationDistance?a=-u.scrollDistance:c.clientX>t-u.activationDistance&&(a=u.scrollDistance)),u.verticalScroll&&(c.clientY<u.activationDistance?l=-u.scrollDistance:c.clientY>o-u.activationDistance&&(l=u.scrollDistance)),0!==a||0!==l){var h=i[0].documentElement.scrollLeft,d=i[0].documentElement.scrollTop,p=s.css("transform");s.css("transform","initial"),e.scrollBy(a,l);var f=i[0].documentElement.scrollLeft-h,g=i[0].documentElement.scrollTop-d;s.css("transform",p),n(function(){c.pageX+=f,c.pageY+=g,r.$emit("draggable:_triggerHandlerMove",c)})}}},u.scrollInterval)},d=function(){t.cancel(l),l=null};o.$on("draggable:start",function(e,t){t.element[0]===s[0]&&(l||h())}),o.$on("draggable:end",function(e,t){t.element[0]===s[0]&&l&&d()}),o.$on("draggable:move",function(e,t){t.element[0]===s[0]&&(c=t.event)})}}}]),function(e,t,n,i){"use strict";var r=t.module("ngDragDrop",[]).service("ngDragDropService",["$timeout","$parse",function(o,s){this.draggableScope=null,this.droppableScope=null,this.callEventCallback=function(e,t,i,r){function o(t){var i=-1!==t.indexOf("(")?t.indexOf("("):t.length,r=-1!==t.lastIndexOf(")")?t.lastIndexOf(")"):t.length,o=t.substring(i+1,r),a=t.match(/^[^.]+.\s*/)[0].slice(0,-1);return a=e[a]&&"function"==typeof e[a].constructor?a:null,{callback:t.substring(a&&a.length+1||0,i),args:n.map(o&&o.split(",")||[],function(t){return[s(t)(e)]}),constructor:a}}if(t){var a=o(t),l=a.callback,c=a.constructor,u=[i,r].concat(a.args);return(e[l]||e[c][l]).apply(e,u)}},this.invokeDrop=function(e,n,s,a){var l,c,u="",h="",d={},p={},f=null,g={},m={},v=null,b=this.droppableScope,y=this.draggableScope;u=e.ngattr("ng-model"),h=n.ngattr("ng-model"),l=y.$eval(u),c=b.$eval(h),v=n.find("[jqyoui-draggable]:last,[data-jqyoui-draggable]:last"),p=b.$eval(n.attr("jqyoui-droppable")||n.attr("data-jqyoui-droppable"))||[],d=y.$eval(e.attr("jqyoui-draggable")||e.attr("data-jqyoui-draggable"))||[],d.index=this.fixIndex(y,d,l),p.index=this.fixIndex(b,p,c),f=t.isArray(l)?d.index:null,g=t.isArray(l)?l[f]:l,d.deepCopy&&(g=t.copy(g)),m=t.isArray(c)&&p&&p.index!==i?c[p.index]:t.isArray(c)?{}:c,p.deepCopy&&(m=t.copy(m)),d.animate===!0?(this.move(e,v.length>0?v:n,null,"fast",p,null),this.move(v.length>0&&!p.multiple?v:[],e.parent("[jqyoui-droppable],[data-jqyoui-droppable]"),r.startXY,"fast",p,t.bind(this,function(){o(t.bind(this,function(){e.css({position:"relative",left:"",top:""}),v.css({position:"relative",left:"",top:"",display:"none"===v.css("display")?"":v.css("display")}),this.mutateDraggable(y,p,d,u,h,m,e),this.mutateDroppable(b,p,d,h,g,f),this.callEventCallback(b,p.onDrop,s,a)}))}))):o(t.bind(this,function(){this.mutateDraggable(y,p,d,u,h,m,e),this.mutateDroppable(b,p,d,h,g,f),this.callEventCallback(b,p.onDrop,s,a)}))},this.move=function(t,n,r,o,s,a){if(0===t.length)return a&&e.setTimeout(function(){a()},300),!1;var l=t.css("z-index"),c=t[s.containment||"offset"](),u=n.css("display"),h=n.hasClass("ng-hide");null===r&&n.length>0&&((n.attr("jqyoui-draggable")||n.attr("data-jqyoui-draggable"))!==i&&n.ngattr("ng-model")!==i&&n.is(":visible")&&s&&s.multiple?(r=n[s.containment||"offset"](),s.stack===!1?r.left+=n.outerWidth(!0):r.top+=n.outerHeight(!0)):(h&&n.removeClass("ng-hide"),r=n.css({visibility:"hidden",display:"block"})[s.containment||"offset"](),n.css({visibility:"",display:u}))),t.css({position:"absolute","z-index":9999}).css(c).animate(r,o,function(){h&&n.addClass("ng-hide"),t.css("z-index",l),a&&a()})},this.mutateDroppable=function(e,n,i,r,o,a){var l=e.$eval(r);e.dndDragItem=o,t.isArray(l)?(n&&n.index>=0?l[n.index]=o:l.push(o),i&&i.placeholder===!0&&(l[l.length-1].jqyoui_pos=a)):(s(r+" = dndDragItem")(e),i&&i.placeholder===!0&&(l.jqyoui_pos=a))},this.mutateDraggable=function(e,n,r,o,a,l,c){var u=t.equals(l,{})||!l,h=e.$eval(o);e.dndDropItem=l,r&&r.placeholder?"keep"!=r.placeholder&&(t.isArray(h)&&r.index!==i?h[r.index]=l:s(o+" = dndDropItem")(e)):t.isArray(h)?u?r&&r.placeholder!==!0&&"keep"!==r.placeholder&&h.splice(r.index,1):h[r.index]=l:(s(o+" = dndDropItem")(e),e.$parent&&s(o+" = dndDropItem")(e.$parent)),c.css({"z-index":"",left:"",top:""})},this.fixIndex=function(e,n,r){if(n.applyFilter&&t.isArray(r)&&r.length>0){var o=e[n.applyFilter](),s=o[n.index],a=i;return r.forEach(function(e,n){t.equals(e,s)&&(a=n)}),a}return n.index}}]).directive("jqyouiDraggable",["ngDragDropService",function(e){return{require:"?jqyouiDroppable",restrict:"A",link:function(n,i,o){var s,a,l,c=function(c,u){c?(s=n.$eval(i.attr("jqyoui-draggable")||i.attr("data-jqyoui-draggable"))||{},a=n.$eval(o.jqyouiOptions)||{},i.draggable({disabled:!1}).draggable(a).draggable({start:function(i,o){e.draggableScope=n,l=t.element(a.helper?o.helper:this).css("z-index"),t.element(a.helper?o.helper:this).css("z-index",9999),r.startXY=t.element(this)[s.containment||"offset"](),e.callEventCallback(n,s.onStart,i,o)},stop:function(i,r){t.element(a.helper?r.helper:this).css("z-index",l),e.callEventCallback(n,s.onStop,i,r)},drag:function(t,i){e.callEventCallback(n,s.onDrag,t,i)}})):i.draggable({disabled:!0})};n.$watch(function(){return n.$eval(o.drag)},c),c(),i.on("$destroy",function(){i.draggable({disabled:!0}).draggable("destroy")})}}}]).directive("jqyouiDroppable",["ngDragDropService","$q",function(e,n){return{restrict:"A",priority:1,link:function(i,r,o){var s,a=function(a,l){a?(s=i.$eval(t.element(r).attr("jqyoui-droppable")||t.element(r).attr("data-jqyoui-droppable"))||{},r.droppable({disabled:!1}).droppable(i.$eval(o.jqyouiOptions)||{}).droppable({over:function(t,n){e.callEventCallback(i,s.onOver,t,n)},out:function(t,n){e.callEventCallback(i,s.onOut,t,n)},drop:function(r,a){var l=null;l=s.beforeDrop?e.callEventCallback(i,s.beforeDrop,r,a):function(){var e=n.defer();return e.resolve(),e.promise}(),l.then(t.bind(this,function(){t.element(a.draggable).ngattr("ng-model")&&o.ngModel?(e.droppableScope=i,e.invokeDrop(t.element(a.draggable),t.element(this),r,a)):e.callEventCallback(i,s.onDrop,r,a)}),function(){a.draggable.css({left:"",top:""})})}})):r.droppable({disabled:!0})};i.$watch(function(){return i.$eval(o.drop)},a),a(),r.on("$destroy",function(){r.droppable({disabled:!0}).droppable("destroy")})}}}]);t.element.prototype.ngattr=function(e,n){var i=t.element(this).get(0);return i.getAttribute(e)||i.getAttribute("data-"+e)}}(window,window.angular,window.jQuery),angular.module("app.directive.common",["app.directive.mydatatable.common","app.directive.smartfloat.common"]).filter("offset",function(){return function(e,t){return e.length>0?(t=20*(t-1),e.slice(t,t+20)):void 0}}).filter("undefined",function(){return function(e){return e&&""!==e&&null!==e?e:"No"}}).filter("arrGetBy",function(){return function(e,t,n){for(var i=0,r=e.length;r>i;i++)if(e[i][t]==n)return e[i];return null}}).filter("startFrom",function(){return function(e,t){return t=+t,e?e.slice(t):e}}).filter("moment",function(){return function(e,t){var n=Array.prototype.slice.call(arguments,2),i=moment(e);return i[t].apply(i,n)}}).directive("accessibleForm",function(){return{restrict:"A",link:function(e,t){t.on("submit",function(){var e=angular.element(t[0].querySelectorAll(".ng-invalid")[0]),n=angular.element(t[0].querySelectorAll(".ng-invalid")[1]);void 0!=e[0]&&void 0==n[0]?e.focus():void 0!=n[0]&&e[0].childElementCount>0?n.focus():void 0!=n[0]&&e[0].childElementCount<=0?e.offset().top<n.offset().top?e.focus():n.focus():0})}}}).directive("fabric",function(){return{restrict:"EA",templateUrl:"common/views/directives/fabric.html",link:function(e,t,n){var i=new fabric.Canvas("c"),r=new fabric.Text("hello world",{fontSize:30,originX:"center",originY:"center"});new fabric.Group([r],{left:150,top:100,angle:-10}),i.add(r)}}}).directive("tooltip",function(){return{restrict:"A",link:function(e,t,n){$(t).hover(function(){$(t).tooltip("show")},function(){$(t).tooltip("hide")})}}}).directive("bootstrapSwitch",[function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,i){t.bootstrapSwitch(),t.on("switchChange.bootstrapSwitch",function(t,n){i&&e.$apply(function(){i.$setViewValue(n)})}),e.$watch(n.ngModel,function(e,n){e?t.bootstrapSwitch("state",!0,!0):t.bootstrapSwitch("state",!1,!0)})}}}]).directive("audiogram",function(e){return{restrict:"EA",scope:{data:"="},templateUrl:"common/views/directives/audioDiagram.html",link:function(e,t,n){e.id=n.audiogram,e.$watch("data",function(t){for(var n=t,i=800,r=430,o=40,s=30,a=100,l=[-10,0,10,20,30,40,50,60,70,80,90,100,110,120],i=n.length*a+a,c=Raphael(e.id,1e3,600),u=(c.path(["M",o,o,"L",i+o,o,"L",i+o,r,"L",o,r,"L",o,o]),o),h=0;h<l.length;++h)c.text(o/2,u,l[h]),u+=s,h<l.length-2&&c.path(["M",o,u,"L",i+o,u]);for(var u=a+o,h=0;h<n.length;++h)c.text(u,o/2,n[h]+"Hz"),c.path(["M",u,o,"L",u,r]),u+=h===n.length-1?2*a:a})}}}).directive("numbersOnly",function(){return{require:"ngModel",scope:{model:"=ngModel"},link:function(e,t,n,i){e.$watch("model",function(t,n){var i=String(t).split("");0!==i.length&&(1!==i.length||"-"!=i[0]&&"."!==i[0])&&(2!==i.length||"-."!==t)&&isNaN(t)&&(e.model=n)}),t.bind("keypress",function(e){32===e.keyCode&&e.preventDefault()})}}}).directive("radio",function(){return{restrict:"A",require:"?ngModel",scope:{model:"=ngModel",value:"=ngValue"},link:function(e,t,n){t.uniform(),e.$watch("model",function(n){n&&(n===e.value&&t.prop("checked",!0),angular.element.uniform.update(t))})}}}).directive("checkbox",function(){return{restrict:"A",require:"?ngModel",scope:{model:"=ngModel"},link:function(e,t,n){t.uniform(),e.$watch("model",function(e){e&&(t.prop("checked",!0),angular.element.uniform.update(t))})}}}).directive("minHeight",function(){return{restrict:"A",link:function(e,t,n){var i=angular.element(window).height();t.css("min-height",i+"px"),angular.element(window).resize(function(){var e=angular.element(window).height();t.css("min-height",e+"px")})}}}).directive("knob",function(){return{restrict:"A",link:function(e,t,n){$(t).val(e.number).knob()}}}).directive("syncClick",function(){return{restrict:"A",scope:{syncClick:"&"},link:function(e,t,n){t.on("click",function(){e.syncClick()})}}}).directive("draggable",function(e,t){var n=function(e,t){return e[t]||e.touches&&e.touches[0][t]||e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0][t]};return{restrict:"A",scope:{drag:"="},link:function(t,i,r){t.$watch("drag",function(t){if(void 0!==t&&1==t)console.log("=========A============");else{console.log("=========B=============");var r=function(e){u=n(e,"pageY")-l,c=n(e,"pageX")-a,i.css({top:u+"px",left:c+"px"})},o=function h(t){e.unbind("mousemove touchmove",r),e.unbind("mouseup touchend",h)},s=i.css("position"),a=0,l=0,c=0,u=0;"relative"!==s&&"absolute"!==s&&(i.css("positon","relative"),s="relative"),i.on("mousedown touchstart",function(t){t.preventDefault();var s=n(t,"pageX"),c=n(t,"pageY");a=s-i.context.offsetLeft,l=c-i.context.offsetTop,e.on("mousemove touchmove",r),e.on("mouseup touchend",o),$(e[0].body).on("mouseleave",o)})}})}}}).directive("customDate",function(){return{restrict:"A",link:function(e,t,n){var i="dd/mm/yy";t.datepicker("birthday"===n.type?{dateFormat:i,changeMonth:!0,changeYear:!0,defaultDate:new Date(1990,8,6),yearRange:"1930:2100"}:{dateFormat:i,changeMonth:!0,changeYear:!0})}}}).directive("checkList",function(){return{restrict:"A",scope:{selectedItemsArray:"=",value:"@"},link:function(e,t){e.$watchCollection("selectedItemsArray",function(n){_.contains(n,e.value)?t.prop("checked",!0):t.prop("checked",!1)}),_.contains(e.selectedItemsArray,e.value)&&t.prop("checked",!0),t.on("change",function(){if(t.prop("checked"))_.contains(e.selectedItemsArray,e.value)||e.$apply(function(){e.selectedItemsArray.push(e.value)});else if(_.contains(e.selectedItemsArray,e.value)){var n=e.selectedItemsArray.indexOf(e.value);e.$apply(function(){e.selectedItemsArray.splice(n,1)})}})}}}).directive("sidebarRes",function(){return{restrict:"A",link:function(e,t,n){var i=angular.element(window).width();768>i?(t.find(".not-mobile").hide(),t.find(".mobile").show(),t.addClass("sidebar-mobile"),t.find("#main-menu").hide(),t.find(".sidebar-menu").css("min-height","0px"),t.find(".sidebar-menu").addClass("sidebar-mobile"),t.find(".sidebar-menu").css("position","relative"),t.addClass("sidebar-padding-left"),t.removeClass("sidebar-collapsed")):992>i?(t.find(".not-mobile").show(),t.find(".mobile").hide(),t.find("#main-menu").show(),t.addClass("sidebar-collapsed"),t.removeClass("sidebar-mobile"),t.find(".sidebar-menu").removeClass("sidebar-mobile"),t.find(".sidebar-menu").css("position","absolute"),t.removeClass("sidebar-padding-left")):(t.find(".not-mobile").show(),t.find(".mobile").hide(),t.find("#main-menu").show(),t.removeClass("sidebar-collapsed"),t.removeClass("sidebar-mobile"),t.find(".sidebar-menu").removeClass("sidebar-mobile"),t.find(".sidebar-menu").css("position","absolute"),t.removeClass("sidebar-padding-left")),angular.element(window).resize(function(){var e=angular.element(window).width();768>e?(t.find(".not-mobile").hide(),t.find(".mobile").show(),t.addClass("sidebar-mobile"),t.find("#main-menu").hide(),t.find(".sidebar-menu").css("min-height","0px"),t.find(".sidebar-menu").css("position","relative"),t.addClass("sidebar-padding-left"),t.removeClass("sidebar-collapsed")):992>e?(t.find(".not-mobile").show(),t.find(".mobile").hide(),t.find("#main-menu").show(),t.addClass("sidebar-collapsed"),t.removeClass("sidebar-mobile"),t.find(".sidebar-menu").removeClass("sidebar-mobile"),t.find(".sidebar-menu").css("position","absolute"),t.removeClass("sidebar-padding-left")):(t.find(".not-mobile").show(),t.find(".mobile").hide(),t.find("#main-menu").show(),t.removeClass("sidebar-collapsed"),t.removeClass("sidebar-mobile"),t.find(".sidebar-menu").removeClass("sidebar-mobile"),t.find(".sidebar-menu").css("position","absolute"),t.removeClass("sidebar-padding-left"))})}}}).directive("email",function(){return{require:"ngModel",link:function(e,t,n,i){i.$parsers.unshift(function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return"undefined"!=typeof e&&""!==e?t.test(e)?i.$setValidity("email",!0):i.$setValidity("email",!1):i.$setValidity("email",!0),e})}}}).directive("integer",function(){return{require:"ngModel",link:function(e,t,n,i){i.$parsers.unshift(function(e){
return"undefined"!=typeof e&&""!==e&&null!==e?e>=0&&e%1===0?i.$setValidity("integer",!0):i.$setValidity("integer",!1):i.$setValidity("integer",!0),e})}}}).directive("ngLoading",function(e){return{restrict:"A",scope:!1,link:function(t,n,i){var r=n.html();t.$watch(i.ngLoading,function(i){i===!0?n.html('<div class="loading-circles"><div class="loading-circle"></div><div class="loading-circle"></div><div class="loading-circle"></div><div class="loading-circle"></div><div class="loading-circle"></div><div class="loading-circle"></div><div class="loading-circle"></div><div class="loading-circle"></div></div>'):(n.html(r),e(n.contents())(t))})}}}).directive("match",function(){return{require:"ngModel",restrict:"A",scope:{match:"="},link:function(e,t,n,i){e.$watch(function(){var t=i.$modelValue||i.$$invalidModelValue;return i.$pristine&&angular.isUndefined(t)||e.match===t},function(e){i.$setValidity("match",e)})}}}).directive("appFilereader",function(e){var t=Array.prototype.slice;return{restrict:"A",require:"?ngModel",link:function(n,i,r,o){o&&(o.$render=function(){},i.bind("change",function(n){function i(t){var n=e.defer(),i=new FileReader;return i.onload=function(e){n.resolve(e.target.result)},i.onerror=function(e){n.reject(e)},i.readAsDataURL(t),n.promise}var r=n.target;e.all(t.call(r.files,0).map(i)).then(function(e){o.$setViewValue(r.multiple?e:e.length?e[0]:null)})}))}}}).directive("pwCheck",[function(){return{require:"ngModel",link:function(e,t,n,i){var r="#"+n.pwCheck;t.add(r).on("keyup",function(){e.$apply(function(){var e=t.val()===$(r).val();i.$setValidity("pwmatch",e)})})}}}]).directive("customTimepicker",function(){return{require:"ngModel",restrict:"EA",scope:{ngModel:"="},link:function(e,t,n,i){t.timepicker({showPeriodLabels:!1,onSelect:function(t,n){e.ngModel=t,e.$apply()}})}}}).directive("ngRightClick",function(e){return function(t,n,i){var r=e(i.ngRightClick);n.bind("contextmenu",function(e){t.$apply(function(){e.preventDefault(),r(t,{$event:e})})})}}).directive("floatLabel",function(){return{require:"ngModel",restrict:"A",scope:{ngModel:"="},link:function(e,t,n){"timepicker"===n.type&&t.timepicker({showPeriodLabels:!1,onSelect:function(t,n){e.ngModel=t,e.$apply()}}),e.$watch("ngModel",function(i,r){"undefined"==typeof i||""===i||null===i?t.parent().removeClass("show-label"):(t.parent().addClass("show-label"),n.toDate?angular.element("#"+n.toDate).datepicker("option","minDate",e.ngModel):n.fromDate&&angular.element("#"+n.fromDate).datepicker("option","maxDate",e.ngModel))})}}}).directive("signature",function(e){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",reset:"="},link:function(e,t,n){var i=document.querySelector("#"+n.id),r=new SignaturePad(i);r.maxWidth=3,r.penColor="black",e.$watch("ngModel",function(e){"undefined"!=typeof e&&(r.isEmpty()||r.clear(),r.fromDataURL(e))}),r.onEnd=function(){e.$apply(function(){e.ngModel=r.toDataURL()})}}}}).filter("utc",function(){return function(e){var t=new Date(e);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())}}).filter("empty",function(){return function(e){return"undefined"!=typeof e&&e?e:"###"}}).filter("filterdate",function(){return function(e,t){return moment(e).isValid()&&("undefined"!=typeof e||e)?moment(e).format(t):"###"}}).directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}}).directive("customTr",function(){return{restrict:"EA",scope:{customTr:"=",customFr:"=",ngModel:"="},link:function(e,t,n){var i={required:"Field is required!",maxlength:"Too long!",number:"Required number!"};e.$watch("customTr",function(n,r){var o=!1;void 0!==e.customFr&&void 0!==e.customFr.$error&&null!==e.customFr.$error&&(angular.forEach(e.customFr.$error,function(e,n){e&&(o=!0,t.parent().hasClass("tooltipstered")&&angular.element(t.parent()).tooltipster("destroy"),angular.element(t.parent()).tooltipster({theme:"tooltip-error-theme",contentAsHTML:!0,content:i[n]}))}),o?(t.parent().find("i").hasClass("glyphicon glyphicon-exclamation-sign")?t.parent().find("i").hasClass("glyphicon glyphicon-exclamation-sign"):t.parent().find("label").append("&nbsp<i class='glyphicon glyphicon-exclamation-sign' style='color: #f3565d'></i>"),t.parent().find("label").css("color","#f3565d")):(t.parent().find("i").hasClass("glyphicon glyphicon-exclamation-sign")&&t.parent().find("i").hasClass("glyphicon glyphicon-exclamation-sign")&&t.parent().find("i").removeClass("glyphicon glyphicon-exclamation-sign"),t.parent().find("label").css("color","#404040"),t.parent().hasClass("tooltipstered")&&(angular.element(t.parent()).tooltipster("destroy"),angular.element(t.parent()).removeAttr("title"))))})}}}),angular.module("app.directive.mydatatable.common",[]).directive("myDataTable",function(e,t){return{restrict:"E",templateUrl:"common/views/mydatatable.html",scope:{options:"=options",row_click:"=rowclick",row_class:"=rowclass",num_rows:"=numrows",col_click:"=colclick"},controller:function(t,n,i){var r=t.options;if(r){t.search={};var o=function(){for(var e=[],t=0,n=r.columns.length;n>t;++t){var i=r.columns[t];i.not_submit||e.push(i.db_field?i.db_field:i.field)}return e},s=function(){for(var e=[],t=0,n=r.columns.length;n>t;++t){var i=r.columns[t];i.order&&e.push([i.field,i.order])}return console.log(e),e},a=function(e){var n=t.page_data.totalItems;n!=e.count&&(t.page_data.totalItems=e.count),t.data.items=e.list};t.ajaxGetData=function(){var n=t.page_data.itemPerPage,i=(t.page_data.currentPage-1)*n,l=o(),c=s(),u={limit:n,offset:i,fields:l,order:c};r.use_filters&&(u.search=t.search),r.search&&(u.search||(u.search={}),angular.extend(u.search,r.search)),r.method&&"post"==r.method.toLowerCase()?e.all(r.api).post(u).then(a):e.one(r.api).get(u).then(a)},t.orderField=function(e){e.order&&(t.page_data.currentPage=1,e.order="ASC"==e.order?"DESC":"ASC",t.ajaxGetData())},t.enterFilter=function(){t.page_data.currentPage=1,t.ajaxGetData()},t.reload=function(){t.ajaxGetData(),t.data.more_items=[]},t.displayData=function(e,t){return t.format?t.format(e):e};var l=function(){t.data={more_items:[],items:[]},t.search={},t.limit_opt=[{value:5},{value:10},{value:20},{value:50}],t.page_data={totalItems:0,currentPage:1,maxSize:5,itemPerPage:5},t.num_rows&&(t.page_data.itemPerPage=t.num_rows),!r.not_load&&r.api&&t.ajaxGetData(),r.not_paging=r.not_paging?!0:!1,void 0!==r.scope&&null!==r.scope&&angular.extend(r.scope,t),t["static"]=r["static"]?!0:!1};l()}}}}),angular.module("app.directive.smartfloat.common",[]).directive("smartFloat",function(e){var t=/^\$?\d+.(\d{3})*(\,\d*)$/,n=/^\$?\d+,(\d{3})*(\.\d*)$/,i=/^\$?\d+(\.\d*)?$/,r=/^\$?\d+(\,\d*)?$/;return{require:"ngModel",link:function(o,s,a,l){l.$parsers.unshift(function(e){return t.test(e)?(l.$setValidity("float",!0),parseFloat(e.replace(".","").replace(",","."))):n.test(e)?(l.$setValidity("float",!0),parseFloat(e.replace(",",""))):i.test(e)?(l.$setValidity("float",!0),parseFloat(e)):r.test(e)?(l.$setValidity("float",!0),parseFloat(e.replace(",","."))):void l.$setValidity("float",!1)}),l.$formatters.unshift(function(t){return e("number")(parseFloat(t),2)})}}}),angular.module("app.loggedIn.home",["app.loggedIn.home.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.home",{url:"/home",templateUrl:"modules/home/views/home.html",controller:"HomeController"})}),angular.module("app.loggedIn.home.controller",[]).controller("HomeController",function($scope,$http,$state,$cookieStore,$modal){}),angular.module("app.loggedIn.appointment",["app.loggedIn.appointment.include"]).config(function($stateProvider){$stateProvider.state("loggedIn.appointment",{url:"/appointment",templateUrl:"modules/appointment/views/index.html",controller:"AppointmentController"}).state("loggedIn.appointment_doctor",{url:"/appointment/doctor/:doctorId",templateUrl:"modules/appointment/views/doctor/index.html",controller:"AppointmentDoctorController"})}),angular.module("app.loggedIn.appointment.include",["app.loggedIn.appointment.models","app.loggedIn.appointment.controllers.index","app.loggedIn.appointment.controllers.detail","app.loggedIn.appointment.controllers.doctor","app.loggedIn.appointment.directives.calendar","app.loggedIn.appointment.directives.add"]),angular.module("app.loggedIn.appointment.models",[]).factory("AppointmentModel",function(Restangular){var mainModel={},mainApi=Restangular.all("api/meditek/v1/appointment");return mainModel.checkNextAppointment=function(data){var instanceApi=mainApi.all("checkNextAppointment");return instanceApi.post({data:data})},mainModel.alertCenterPatient=function(data){var instanceApi=mainApi.all("alertCenterPatient");return instanceApi.post({data:data})},mainModel.byDoctor=function(data){var instanceApi=mainApi.all("byDoctor");return instanceApi.post({data:data})},mainModel.deleteClnAppPatient=function(data){var instanceApi=mainApi.all("deleteClnAppPatient");return instanceApi.post({data:data})},mainModel.add=function(data){var instanceApi=mainApi.all("add");return instanceApi.post({data:data})},mainModel.edit=function(data){var instanceApi=mainApi.all("edit");return instanceApi.post({data:data})},mainModel.postGetCal=function(data){var instanceApi=mainApi.all("postGetCal");return instanceApi.post({data:data})},mainModel.load=function(data){var instanceApi=mainApi.all("load");return instanceApi.post({data:data})},mainModel.detailLoad=function(data){var instanceApi=mainApi.all("detailLoad");return instanceApi.post({data:data})},mainModel.alertCenter=function(data){var instanceApi=mainApi.all("alertCenter");return instanceApi.post({data:data})},mainModel.alertCenterConsultation=function(data){var instanceApi=mainApi.all("alertCenterConsultation");return instanceApi.post({data:data})},mainModel.alertSiteCenter=function(data){var instanceApi=mainApi.all("alertSiteCenter");return instanceApi.post({data:data})},mainModel.one=function(data){var instanceApi=mainApi.all("one");return instanceApi.post({data:data})},mainModel.getServiceColor=function(data){var instanceApi=mainApi.all("getServiceColor");return instanceApi.post({data:data})},mainModel.getOneApptPatient=function(data){var instanceApi=mainApi.all("getOneApptPatient");return instanceApi.post({data:data})},mainModel.changeService=function(data){var instanceApi=mainApi.all("changeService");return instanceApi.post({data:data})},mainModel.changeStatus=function(data){var instanceApi=mainApi.all("changeStatus");return instanceApi.post({data:data})},mainModel.ApptG=function(data){var instanceApi=mainApi.all("Getappt");return instanceApi.post({data:data})},mainModel.PostCheck=function(data){var instanceApi=mainApi.all("postcheck");return instanceApi.post({data:data})},mainModel.PostUser=function(data){var instanceApi=mainApi.all("postuser");return instanceApi.post({data:data})},mainModel}),angular.module("app.loggedIn.appointment.controllers.index",[]).controller("AppointmentController",function($scope,$state){}),angular.module("app.loggedIn.appointment.controllers.detail",[]).controller("AppointmentDetailController",function($scope,$state,$stateParams,PatientModel){var load=function(){PatientModel.byid({Patient_id:$stateParams.patientId}).then(function(response){$scope.patient.item=response.data},function(error){})};$scope.patient={load:function(){load()},item:null},$scope.patient.load()}),angular.module("app.loggedIn.appointment.controllers.doctor",[]).controller("AppointmentDoctorController",function($scope,$state,$timeout,$stateParams,$modal,toastr,$cookieStore,OutreferralModel,AppointmentModel,mdtRedimedsitesService,mdtDeptService,ConfigService){var loadSite=function(){mdtRedimedsitesService.list().then(function(response){$scope.site.list=response.data},function(error){})},loadClinical=function(){mdtDeptService.listAll().then(function(response){$scope.clinicalDept.list=response.data},function(error){})};$scope.goToOtherDoctor=function(doctor){$cookieStore.put("appointment",$scope.appointment.pre),$scope.appointment.load({site_id:data.site_id,datepicker:$scope.appointment.pre.datepicker,doctor_id:doctor.DOCTOR_ID,clinical_dept_id:$scope.appointment.pre.clinical_dept_id}),$scope.appointment.pre.doctor_id=doctor.DOCTOR_ID},$scope.loadAppointment=function(){$scope.appointment.load({site_id:data.site_id,datepicker:$scope.appointment.pre.datepicker,doctor_id:$scope.appointment.pre.doctor_id,clinical_dept_id:$scope.appointment.pre.clinical_dept_id})},$scope.dialogWaitingListAdd=function(col){angular.element("#popupMenu").css({display:"none"}),$modal.open({templateUrl:"waitingListAdd",controller:function($scope,$modalInstance){$scope.success=!1,$timeout(function(){$scope.doctor_id=col.DOCTOR_ID},200),$scope.$watch("success",function(success){success&&$modalInstance.close("success")})},size:"lg",resolve:{col:function(){return col}}})},angular.element("#appointment").on("click",function(){angular.element("#popupMenu").css({display:"none"})}),$scope.goToAppDetail=function(list,patient){$state.go("loggedIn.patient.appointment",{cal_id:list.CAL_ID,patient_id:patient.Patient_id})},$scope.rightAdd=function(app,col){angular.element("#popupMenu").css({display:"none"}),$scope.dialogAppointmentAdd(app,col)},$scope.onRightClick=function($event,app,col){angular.element("#popupMenu").css({display:"block",top:$event.pageY-68,left:$event.pageX-20}),$scope.appointment.selectedAppointment=angular.copy(app),$scope.appointment.selectedCol=angular.copy(col)},$scope.dialogAppointmentAdd=function(app,col){var modalInstance=$modal.open({templateUrl:"appointmentAdd",controller:function($scope,$modalInstance,app,options){$scope.appointment={app:app,col:col},$scope.options=options,$scope.params={permission:{create:!0,edit:!1}},$scope.patient=null,$scope.$watch("patient",function(patient){null!==patient&&$modalInstance.close(patient)})},size:"lg",resolve:{app:function(){return app},col:function(){return col},options:function(){return $scope.options}}});modalInstance.result.then(function(patient){if(patient){$scope.appointment.load({site_id:data.site_id,datepicker:data.datepicker,doctor_id:$stateParams.doctorId}),toastr.success("Added Successfully");var modalInstance=$modal.open({templateUrl:"notifyClaim",controller:function($scope,$modalInstance,new_patient,ClaimModel){$scope.selectClaim=function(){$modal.open({templateUrl:"claimSelect",controller:function($scope,$modalInstance,new_patient,col,toastr){var clickRow=function(row){var postData={Patient_id:new_patient.Patient_id,CAL_ID:col.CAL_ID,Claim_id:row.Claim_id};$modalInstance.close("success"),ClaimModel.addPatient(postData).then(function(response){toastr.success("You have choose claim")},function(error){})};$scope.claim={limit:10,reload:!1,Patient_id:new_patient.Patient_id,CAL_ID:col.CAL_ID,addSuccess:!1,clickRow:function(row){clickRow(row)}},$scope.$watch("claim.addSuccess",function(addSuccess){addSuccess&&$modalInstance.close("success")})},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(success){"success"===success&&$modalInstance.close("cancel")})},$scope.addClaim=function(){$modal.open({templateUrl:"claimAdd",controller:function($scope,$modalInstance,new_patient,col,toastr){$scope.claim={Patient_id:new_patient.Patient_id,CAL_ID:col.CAL_ID,success:!1},$scope.$watch("claim.success",function(success){success&&(toastr.success("You have choose claim"),$modalInstance.close("success"))})},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(success){"success"===success&&$modalInstance.close("cancel")})},$scope.cancel=function(){$modalInstance.close("cancel")}},size:"sm",backdrop:"static",keyboard:!1,resolve:{new_patient:function(){return patient}}});modalInstance.result.then(function(result){"cancel"===result&&col.IS_REFERRAL&&$modal.open({templateUrl:"notifyReferral",controller:function($scope,$modalInstance,new_patient){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.selectReferral=function(){$modal.open({templateUrl:"referralSelect",controller:function($scope,$modalInstance,new_patient,col,OutreferralModel){$scope.patientId=new_patient.Patient_id,$scope.reload=!1,$scope.calId=col.CAL_ID,$scope.doctorId=col.DOCTOR_ID,$scope.limit=10,$scope.addSuccess=!1,$timeout(function(){$scope.calId=col.CAL_ID},600),$scope.$watch("addSuccess",function(addSuccess){addSuccess&&$modalInstance.close("success")}),$scope.clickRow=function(row){var postData={CAL_ID:$scope.calId,outreferral_id:row.id,patient_id:$scope.patientId,isEnable:1};OutreferralModel.select(postData).then(function(response){toastr.success("You have choose Referral"),$modalInstance.close("success")},function(error){})}},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(result){"success"===result&&($modalInstance.dismiss("cancel"),scope.alertCenter.load())})},$scope.addReferral=function(){$modal.open({templateUrl:"referralAdd",controller:function($scope,$modalInstance,new_patient,col){$scope.patientId=new_patient.Patient_id,$scope.calId=col.CAL_ID,$scope.success=!1,$timeout(function(){$scope.doctorId=col.DOCTOR_ID},600),$scope.$watch("success",function(success){success&&(toastr.success("You have choose Referral"),$modalInstance.close("success"))})},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(result){"success"===result&&($modalInstance.dismiss("cancel"),scope.alertCenter.load())})}},size:"sm",backdrop:"static",keyboard:!1,resolve:{new_patient:function(){return patient}}})})}})};var load=function(option){$scope.appointment.list=[],option.datepicker=ConfigService.convertToDB(option.datepicker),AppointmentModel.detailLoad(option).then(function(response){$scope.appointment.doctors=response.doctors,_.forEach(response.data,function(data){var flagTheme=-1,flagPatient=-1,i=0;if(_.forEach($scope.appointment.list,function(list){if(list.FROM_TIME===data.FROM_TIME){if(list.cal===data.CAL_ID)return void(flagPatient=i);flagTheme=i}i++}),data.Patient_id&&-1===flagPatient&&(flagPatient=1e3),-1!==flagPatient)if(1e3!==flagPatient)$scope.appointment.list[flagPatient].cal=data.CAL_ID,$scope.appointment.list[flagPatient].CAL_ID=data.CAL_ID,$scope.appointment.list[flagPatient].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,outreferral:data.outreferral,DOCTOR_ID:data.DOCTOR_ID,CAL_ID:data.CAL_ID}),$scope.appointment.list[flagPatient].PATIENTS="ok";else{var temp_index=0,flagIndex=!1;if(_.forEach($scope.appointment.list,function(list){return data.FROM_TIME===list.FROM_TIME?"###"===list.PATIENTS?($scope.appointment.list[temp_index].cal=data.CAL_ID,$scope.appointment.list[temp_index].CAL_ID=data.CAL_ID,$scope.appointment.list[temp_index].SERVICE_COLOR=data.SERVICE_COLOR,$scope.appointment.list[temp_index].patients=[],$scope.appointment.list[temp_index].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral,CAL_ID:data.CAL_ID}),$scope.appointment.list[temp_index].PATIENTS="ok",$scope.appointment.list[temp_index].IS_REFERRAL=data.IS_REFERRAL,void(flagIndex=!0)):($scope.appointment.list[temp_index].cal=data.CAL_ID,$scope.appointment.list[temp_index].CAL_ID=data.CAL_ID,$scope.appointment.list[temp_index].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral,CAL_ID:data.CAL_ID}),$scope.appointment.list[temp_index].PATIENTS="ok",void(flagIndex=!0)):void temp_index++}),!flagIndex){var doctor={SERVICE_ID:data.SERVICE_ID,CAL_ID:data.CAL_ID,IS_REFERRAL:data.IS_REFERRAL,SERVICE_COLOR:data.SERVICE_COLOR,PATIENTS:"MESS_SYS_010",patients:[],CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID};doctor.patients.push({DOCTOR_ID:$stateParams.doctorId,Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral,CAL_ID:data.CAL_ID}),doctor.PATIENTS="ok",doctor.cal=data.CAL_ID,doctor.FROM_TIME=data.FROM_TIME,doctor.TO_TIME=data.TO_TIME,$scope.appointment.list.push(doctor)}}else if(-1!==flagTheme)$scope.appointment.list[flagTheme].patients=[],$scope.appointment.list[flagTheme].cal=data.CAL_ID,$scope.appointment.list[flagTheme].CAL_ID=data.CAL_ID,null!==data.Patient_id&&$scope.appointment.list[flagTheme].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral,CAL_ID:data.CAL_ID}),$scope.appointment.list[flagTheme].PATIENTS="MESS_SYS_010",$scope.appointment.list[flagTheme].SERVICE_ID=data.SERVICE_ID,$scope.appointment.list[flagTheme].CAL_ID=data.CAL_ID,$scope.appointment.list[flagTheme].SERVICE_COLOR=data.SERVICE_COLOR,$scope.appointment.list[flagTheme].IS_REFERRAL=data.IS_REFERRAL,$scope.appointment.list[flagTheme].CLINICAL_DEPT_ID=data.CLINICAL_DEPT_ID,$scope.appointment.list[flagTheme].patients.length>0&&($scope.appointment.list[flagTheme].PATIENTS="ok");else{var doctor={SERVICE_ID:data.SERVICE_ID,CAL_ID:data.CAL_ID,IS_REFERRAL:data.IS_REFERRAL,SERVICE_COLOR:data.SERVICE_COLOR,PATIENTS:"MESS_SYS_010",patients:[],CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID};doctor.patients.push({DOCTOR_ID:$stateParams.doctorId,Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral,CAL_ID:data.CAL_ID}),doctor.cal=data.CAL_ID,doctor.FROM_TIME=data.FROM_TIME,doctor.TO_TIME=data.TO_TIME,$scope.appointment.list.push(doctor)}})})};if($scope.site={list:[]},$scope.clinicalDept={list:[]},$scope.appointment={pre:{doctor_id:null,name:null,datepicker:null,site_id:null,clinical_dept_id:null},list:[],doctors:[],load:function(option){load(option)}},$cookieStore.get("appointment")){var data=$cookieStore.get("appointment");$scope.appointment.pre.datepicker=data.datepicker,$scope.appointment.pre.doctor_id=$stateParams.doctorId,$scope.appointment.pre.clinical_dept_id=data.clinical_dept_id,$scope.appointment.pre.site_id=data.site_id,OutreferralModel.DotorFromUserId($stateParams.doctorId).then(function(response){$scope.appointment.pre.name=response.data[0].NAME},function(error){}),$scope.appointment.load({site_id:data.site_id,datepicker:data.datepicker,doctor_id:$stateParams.doctorId,clinical_dept_id:data.clinical_dept_id}),loadSite(),loadClinical()}}),angular.module("app.loggedIn.appointment.directives.calendar",[]).directive("appointmentCalendar",function($modal,$timeout,$state,$cookieStore,$modal,toastr,AppointmentModel,mdtRedimedsitesService,mdtDeptService,ConfigService){return{restrict:"EA",templateUrl:"modules/appointment/directives/templates/calendar.html",scope:{options:"=",search:"="},link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id;scope.arrayAppid=[],scope.oldColor=[],scope.isKeyPressed=function($event){if(e=event||window.event,e.altKey){var id=$(event.target).find(".appid").text(),patient_name=$(event.target).find(".patient_name").text();if(id>0){for(var count=0,i=0;i<scope.arrayAppid.length;i++)scope.arrayAppid[i].CAL_ID==id&&count++;if(0==count){postData={CAL_ID:id},AppointmentModel.getOneApptPatient(postData).then(function(response){if(-1==response.data){var object={CAL_ID:id};scope.arrayAppid.push(object)}else{var object={CAL_ID:id,patient_name:patient_name,appt_status:response.data.appt_status};scope.arrayAppid.push(object)}});var objectColor={CAL_ID:id,color_old:event.target.style.backgroundColor};scope.oldColor.push(objectColor),console.log(objectColor),event.target.style.backgroundColor="rgb(199, 197, 196)"}}}},scope.rightClickChangeColor=function($event){if(e=event||window.event,e.altKey)for(var id=$(event.target).find(".appid").text(),i=0;i<scope.arrayAppid.length;i++)if(id==scope.arrayAppid[i].CAL_ID)for(var j=0;j<scope.oldColor.length;j++)id==scope.oldColor[j].CAL_ID&&(event.target.style.backgroundColor=scope.oldColor[j].color_old,scope.oldColor.splice(j,1)),scope.arrayAppid.splice(i,1)},scope.changeService=function(SERVICE_ID){for(var postData=[],i=0;i<scope.arrayAppid.length;i++)object={SERVICE_ID:SERVICE_ID,CAL_ID:scope.arrayAppid[i].CAL_ID},postData.push(object);AppointmentModel.changeService(postData).then(function(response){scope.arrayAppid=[],scope.appointment.load(),scope.alertCenter.load()})},scope.isshiftRight=function($event){angular.element("#changeStatus").css({display:"none"}),e=event||window.event,1==e.ctrlKey&&angular.element("#calMenu").css({display:"block",top:$event.pageY-68,left:$event.pageX-20})},scope.changeStatusFor=function(status){for(var i=0;i<scope.arrayAppid.length;i++)postData={STATUS:status,CAL_ID:scope.arrayAppid[i].CAL_ID},AppointmentModel.changeStatus(postData).then(function(response){},function(error){})},scope.cancelCalMenu=function($event){angular.element("#calMenu").css({display:"none"}),scope.arrayAppid=[],scope.appointment.load(),scope.alertCenter.load()},scope.changeStatus=function(status){setTimeout(scope.changeStatusFor(status),2e3),toastr.success("Changes Appointment Status Successfully"),angular.element("#changeStatus").css({display:"none"}),scope.arrayAppid=[],scope.appointment.load(),scope.alertCenter.load()},scope.showChangeStatus=function($event){angular.element("#calMenu").css({display:"none"}),angular.element("#changeStatus").css({display:"block",top:$event.pageY-68,left:$event.pageX-20})},scope.cancel=function($event){angular.element("#changeStatus").css({display:"none"}),angular.element("#calMenu").css({display:"block"})},angular.element("#appointment").on("click",function(){angular.element("#popupMenu").css({display:"none"}),angular.element("#calMenu").css({display:"none"}),angular.element("#changeStatus").css({display:"none"})}),scope.servicedata={},scope.getServiceColor=function(){AppointmentModel.getServiceColor("data").then(function(response){scope.servicedata=response.data},function(error){})},scope.getServiceColor(),scope.addPatient=function(){$modal.open({templateUrl:"addPatient",controller:function($scope,$modalInstance,toastr,options){$scope.patientAddForm={params:{permission:{edit:!1,create:!0}}},$scope.options=options,$scope.$watch("onsuccess",function(success){success&&$modalInstance.close("success")})},size:"lg",resolve:{options:function(){return scope.options}}})},scope.goToCalendarDetail=function(doctor){$cookieStore.put("appointment",scope.appointment.search),$state.go("loggedIn.appointment_doctor",{doctorId:doctor.DOCTOR_ID})},scope.extendMinutes=function(hour,minute){hour=scope.convertToSeconds(hour);var seconds=hour+60*minute,sec_num=parseInt(seconds,10),hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-3600*hours)/60);10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes);var time=hours+":"+minutes;return time},scope.convertToSeconds=function(time){var hour=parseInt(time.substring(0,2)),minute=parseInt(time.substring(3));return 3600*hour+60*minute},scope.differentTimeHours=function(hourOne,hourSecond){return 0!==hourSecond?(hourOne=scope.convertToSeconds(hourOne),hourSecond=scope.convertToSeconds(hourSecond),(hourSecond-hourOne)/60):0},scope.showDropdown=function(patient,col){$modal.open({templateUrl:"notifyAlert",controller:function($scope,patient,AlertModel,OutreferralModel){var postData={Patient_id:patient.Patient_id,CAL_ID:col.CAL_ID,limit:20,offset:0,Creation_date:"desc",name:"",description:""};$scope.alert={list:[]},$scope.outreferral={name:"It has Referral"};var refPostData={CAL_ID:col.CAL_ID,patient_id:patient.Patient_id};OutreferralModel.checkPatientCalendar(refPostData).then(function(response){0===response.data&&($scope.outreferral.name=1===response.service.IS_REFERRAL?"There is no referral":"This slot does not need referral")}),AlertModel.listFollowPatient(postData).then(function(response){$scope.alert.list=response.data},function(error){})},resolve:{patient:function(){return patient}}})},scope.goToAppDetail=function(CAL_ID,Patient_id){$state.go("loggedIn.patient.consult",{cal_id:CAL_ID,patient_id:Patient_id}),$cookieStore.put("appointment",scope.appointment.search)};var search={datepicker:moment().format("DD/MM/YYYY"),site_id:1,clinical_dept_id:""},loadSite=function(){mdtRedimedsitesService.list().then(function(response){scope.site.list=response.data},function(error){})},loadClinical=function(){mdtDeptService.listAll().then(function(response){scope.clinicalDept.list=response.data},function(error){})},load=function(){var postData=angular.copy(scope.appointment.search);postData.datepicker=ConfigService.convertToDB(postData.datepicker),scope.appointment.list=[],scope.alertCenter.load(),AppointmentModel.load(postData).then(function(response){scope.doctor.headers=response.doctors;var doctor_array_temp=[];_.forEach(response.doctors,function(doctor){doctor_array_temp.push({DOCTOR_ID:doctor.DOCTOR_ID,left:0})});var min_calendar=9999;_.forEach(response.data,function(data){var flagTheme=-1,flagPatient=-1,i=0;if(_.forEach(scope.appointment.list,function(list){list.FROM_TIME===data.FROM_TIME&&_.forEach(list.cals,function(cal){return cal===data.CAL_ID?void(flagPatient=i):void(flagTheme=i)}),i++}),data.Patient_id&&-1===flagPatient&&(flagPatient=1e3),-1!==flagPatient)if(1e3!==flagPatient){var doctor_row=0;scope.appointment.list[flagPatient].cals.push(data.CAL_ID),_.forEach(response.doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[flagPatient].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,outreferral:data.outreferral,DOCTOR_ID:data.DOCTOR_ID}),void(scope.appointment.list[flagPatient].doctors[doctor_row].PATIENTS="ok")):void doctor_row++})}else{var temp_index=0,flagIndex=!1;if(_.forEach(scope.appointment.list,function(list){data.FROM_TIME===list.FROM_TIME&&_.forEach(list.doctors,function(doc){if(doc.DOCTOR_ID===data.DOCTOR_ID){if("###"===doc.PATIENTS){var doctor_row=0;return scope.appointment.list[temp_index].cals.push(data.CAL_ID),_.forEach(response.doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[temp_index].doctors[doctor_row].CAL_ID=data.CAL_ID,scope.appointment.list[temp_index].doctors[doctor_row].SERVICE_COLOR=data.SERVICE_COLOR,scope.appointment.list[temp_index].doctors[doctor_row].patients=[],scope.appointment.list[temp_index].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),scope.appointment.list[temp_index].doctors[doctor_row].PATIENTS="ok",scope.appointment.list[temp_index].doctors[doctor_row].IS_REFERRAL=data.IS_REFERRAL,void(scope.appointment.list[temp_index].doctors[doctor_row].IS_BOOKABLE=data.IS_BOOKABLE)):void doctor_row++}),void(flagIndex=!0)}var doctor_row=0;return scope.appointment.list[temp_index].cals.push(data.CAL_ID),_.forEach(response.doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[temp_index].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),void(scope.appointment.list[temp_index].doctors[doctor_row].PATIENTS="ok")):void doctor_row++}),void(flagIndex=!0)}}),temp_index++}),!flagIndex){var doctors=[];_.forEach(response.doctors,function(doctor){doctors.push(doctor.DOCTOR_ID===data.DOCTOR_ID?{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,SERVICE_ID:data.SERVICE_ID,CAL_ID:data.CAL_ID,IS_REFERRAL:data.IS_REFERRAL,IS_BOOKABLE:data.IS_BOOKABLE,SERVICE_COLOR:data.SERVICE_COLOR,PATIENTS:"MESS_SYS_010",patients:[],CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID}:{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,PATIENTS:"###"})});var doctor_row=0;_.forEach(doctors,function(doctor){doctor.DOCTOR_ID===data.DOCTOR_ID&&(doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),doctors[doctor_row].PATIENTS="ok"),doctor_row++});var cal=[];cal.push(data.CAL_ID);var object={FROM_TIME:data.FROM_TIME,TO_TIME:data.TO_TIME,cals:cal,
doctors:doctors};scope.appointment.list.push(object)}}else if(-1!==flagTheme){var doctor_row=0;_.forEach(scope.appointment.list[flagTheme].doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[flagTheme].doctors[doctor_row].patients=[],scope.appointment.list[flagTheme].cals.push(data.CAL_ID),null!==data.Patient_id&&scope.appointment.list[flagTheme].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),scope.appointment.list[flagTheme].doctors[doctor_row].PATIENTS="MESS_SYS_010",scope.appointment.list[flagTheme].doctors[doctor_row].SERVICE_ID=data.SERVICE_ID,scope.appointment.list[flagTheme].doctors[doctor_row].CAL_ID=data.CAL_ID,scope.appointment.list[flagTheme].doctors[doctor_row].SERVICE_COLOR=data.SERVICE_COLOR,scope.appointment.list[flagTheme].doctors[doctor_row].IS_REFERRAL=data.IS_REFERRAL,scope.appointment.list[flagTheme].doctors[doctor_row].IS_BOOKABLE=data.IS_BOOKABLE,scope.appointment.list[flagTheme].doctors[doctor_row].CLINICAL_DEPT_ID=data.CLINICAL_DEPT_ID,void(scope.appointment.list[flagTheme].doctors[doctor_row].patients.length>0&&(scope.appointment.list[flagTheme].doctors[doctor_row].PATIENTS="ok"))):void doctor_row++})}else{var doctors=[];_.forEach(response.doctors,function(doctor){doctors.push(doctor.DOCTOR_ID===data.DOCTOR_ID?{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,SERVICE_ID:data.SERVICE_ID,CAL_ID:data.CAL_ID,IS_REFERRAL:data.IS_REFERRAL,IS_BOOKABLE:data.IS_BOOKABLE,SERVICE_COLOR:data.SERVICE_COLOR,PATIENTS:"MESS_SYS_010",patients:[],CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID}:{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,PATIENTS:"###"})});var differentTimeHours=scope.differentTimeHours(data.FROM_TIME,data.TO_TIME);min_calendar>=differentTimeHours&&(min_calendar=differentTimeHours);var i=0;_.forEach(doctor_array_temp,function(doctor){doctor.DOCTOR_ID===data.DOCTOR_ID&&(doctor_array_temp[i].left=scope.differentTimeHours(data.FROM_TIME,data.TO_TIME)),i++});var cal=[];cal.push(data.CAL_ID);var object={FROM_TIME:data.FROM_TIME,TO_TIME:data.TO_TIME,cals:cal,SERVICE_ID:data.SERVICE_ID,CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID,doctors:doctors};scope.appointment.list.push(object)}}),scope.appointment.new_list=[];var i=0;if(scope.appointment.list.length>0)var begin_from_time=scope.appointment.list[0].FROM_TIME;_.forEach(scope.appointment.list,function(list){if("undefined"!=typeof scope.appointment.list[i+1])var begin_to_time=scope.appointment.list[i+1].FROM_TIME;else var begin_to_time=scope.extendMinutes(begin_from_time,45);var diff=scope.differentTimeHours(begin_from_time,begin_to_time);scope.appointment.new_list.push(scope.appointment.list[i]);var new_list_length=scope.appointment.new_list.length,j=0;_.forEach(scope.appointment.new_list[new_list_length-1].doctors,function(doctor){scope.appointment.new_list[new_list_length-1].doctors[j].border="yes",j++});for(var diff_i=15;diff-15>=diff_i;diff_i+=15){var from_time=scope.extendMinutes(scope.appointment.list[i].FROM_TIME,diff_i);begin_from_time=from_time;var temp_doctors=angular.copy(scope.appointment.list[i].doctors),doc_i=0;_.forEach(temp_doctors,function(doctor){temp_doctors[doc_i].PATIENTS="###",doc_i++}),scope.appointment.new_list.push({FROM_TIME:from_time,doctors:temp_doctors})}begin_from_time=scope.extendMinutes(begin_from_time,15),i++}),scope.appointment.list=angular.copy(scope.appointment.new_list);var i=0;_.forEach(scope.appointment.list,function(list){var j=0;_.forEach(list.doctors,function(doctor){var k=0;_.forEach(doctor_array_temp,function(temp){doctor.DOCTOR_ID===temp.DOCTOR_ID&&("###"!==doctor.PATIENTS?(doctor_array_temp[k].left_temp=doctor_array_temp[k].left-15,doctor_array_temp[k].color=scope.appointment.list[i].doctors[j].SERVICE_COLOR,0===doctor_array_temp[k].left_temp&&(scope.appointment.list[i].doctors[j].height="35px")):doctor_array_temp[k].left_temp>0&&(scope.appointment.list[i].doctors[j].SERVICE_COLOR=doctor_array_temp[k].color,doctor_array_temp[k].left_temp-=15,0===doctor_array_temp[k].left_temp&&(scope.appointment.list[i].doctors[j].height="35px"))),k++}),j++}),i++});var i=0;_.forEach(scope.appointment.list,function(list){var j=0;_.forEach(list.doctors,function(doctor){"undefined"!=typeof scope.appointment.list[i].doctors[j].patients&&scope.appointment.list[i].doctors[j].patients.length>1&&"ok"===scope.appointment.list[i].doctors[j].PATIENTS&&(scope.appointment.list[i].doctors[j].height="auto"),j++}),i++})},function(error){})},dialogWaitingListAdd=function(col){angular.element("#popupMenu").css({display:"none"}),$modal.open({templateUrl:"waitingListAdd",controller:function($scope,$modalInstance,patient){$scope.success=!1,$timeout(function(){$scope.doctor_id=col.DOCTOR_ID,$scope.patient_id=patient.Patient_id},200),$scope.$watch("success",function(success){success&&$modalInstance.close("success")})},size:"lg",resolve:{col:function(){return col},patient:function(){return scope.appointment.selectedPatient}}})},dialogRightEdit=function(app,col){angular.element("#popupMenu").css({display:"none"});var patient=scope.appointment.selectedPatient;dialogEdit(app,col,patient)},dialogEdit=function(app,col,patient){if(scope.appointment.load(),1==col.IS_BOOKABLE){var modalInstance=$modal.open({templateUrl:"appointmentEdit",controller:function($scope,$modalInstance,app,options,search,col,patient){$scope.appointment={app:app,col:col,patient:patient},$scope.options=options,$scope.search=search,$scope.params={permission:{create:!0,edit:!1}},$scope.patient=null,$scope.$watch("patient",function(patient){null!==patient&&(-1!==patient?$modalInstance.close(patient):$modalInstance.dismiss("cancel"))})},size:"lg",resolve:{app:function(){return app},col:function(){return col},options:function(){return scope.options},search:function(){return scope.appointment.search},patient:function(){return patient}}});modalInstance.result.then(function(patient){patient&&(scope.loadAlertCenterPatient.load(),scope.appointment.load(),scope.alertCenter.load())})}else var modalInstance=$modal.open({templateUrl:"showNotificationNo",controller:function($scope,$modalInstance){$scope.cancel=function(){$modalInstance.dismiss("cancel")}}}).result.then(function(response){})},dialogRightAdd=function(app,col){angular.element("#popupMenu").css({display:"none"}),dialogAdd(app,col)},dialogAdd=function(app,col){if(scope.appointment.load(),1==col.IS_BOOKABLE){var modalInstance=$modal.open({templateUrl:"appointmentAdd",controller:function($scope,$modalInstance,app,options,search){$scope.appointment={app:app,col:col},$scope.options=options,$scope.search=search,$scope.params={permission:{create:!0,edit:!1}},$scope.patient=null,$scope.$watch("patient",function(patient){null!==patient&&(-1!==patient?$modalInstance.close(patient):$modalInstance.dismiss("cancel"))})},size:"lg",resolve:{app:function(){return app},col:function(){return col},options:function(){return scope.options},search:function(){return scope.appointment.search}}});modalInstance.result.then(function(patient){if(patient){scope.loadAlertCenterPatient.load(),scope.appointment.load(),scope.alertCenter.load(),toastr.success("Added Successfully");var modalInstance=$modal.open({templateUrl:"notifyClaim",controller:function($scope,$modalInstance,new_patient,ClaimModel){$scope.selectClaim=function(){$modal.open({templateUrl:"claimSelect",controller:function($scope,$modalInstance,new_patient,col,toastr){var clickRow=function(row){var postData={Patient_id:new_patient.Patient_id,CAL_ID:col.CAL_ID,Claim_id:row.Claim_id};$modalInstance.close("success"),ClaimModel.addPatient(postData).then(function(response){toastr.success("You have choose claim")},function(error){})};$scope.claim={limit:10,reload:!1,Patient_id:new_patient.Patient_id,CAL_ID:col.CAL_ID,addSuccess:!1,clickRow:function(row){clickRow(row)}},$scope.$watch("claim.addSuccess",function(addSuccess){addSuccess&&$modalInstance.close("success")})},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(success){"success"===success&&$modalInstance.close("cancel")})},$scope.addClaim=function(){$modal.open({templateUrl:"claimAdd",controller:function($scope,$modalInstance,new_patient,col,toastr){$scope.claim={Patient_id:new_patient.Patient_id,CAL_ID:col.CAL_ID,success:!1},$scope.$watch("claim.success",function(success){success&&(toastr.success("You have choose claim"),$modalInstance.close("success"))})},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(success){"success"===success&&$modalInstance.close("cancel")})},$scope.cancel=function(){$modalInstance.close("cancel")}},size:"sm",backdrop:"static",keyboard:!1,resolve:{new_patient:function(){return patient}}});modalInstance.result.then(function(result){"cancel"===result&&col.IS_REFERRAL&&$modal.open({templateUrl:"notifyReferral",controller:function($scope,$modalInstance,new_patient){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.selectReferral=function(){$modal.open({templateUrl:"referralSelect",controller:function($scope,$modalInstance,new_patient,col,OutreferralModel){$scope.patientId=new_patient.Patient_id,$scope.reload=!1,$scope.calId=col.CAL_ID,$scope.doctorId=col.DOCTOR_ID,$scope.limit=10,$scope.addSuccess=!1,$timeout(function(){$scope.calId=col.CAL_ID},600),$scope.$watch("addSuccess",function(addSuccess){addSuccess&&$modalInstance.close("success")}),$scope.clickRow=function(row){var postData={CAL_ID:$scope.calId,outreferral_id:row.id,patient_id:$scope.patientId,isEnable:1};OutreferralModel.select(postData).then(function(response){toastr.success("You have choose Referral"),$modalInstance.close("success")},function(error){})}},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(result){"success"===result&&($modalInstance.dismiss("cancel"),scope.alertCenter.load())})},$scope.addReferral=function(){$modal.open({templateUrl:"referralAdd",controller:function($scope,$modalInstance,new_patient,col){$scope.patientId=new_patient.Patient_id,$scope.calId=col.CAL_ID,$scope.success=!1,$timeout(function(){$scope.doctorId=col.DOCTOR_ID},600),$scope.$watch("success",function(success){success&&(toastr.success("You have choose Referral"),$modalInstance.close("success"))})},size:"lg",resolve:{new_patient:function(){return new_patient},col:function(){return col}}}).result.then(function(result){"success"===result&&($modalInstance.dismiss("cancel"),scope.alertCenter.load())})}},size:"sm",backdrop:"static",keyboard:!1,resolve:{new_patient:function(){return patient}}})})}})}else var modalInstance=$modal.open({templateUrl:"showNotificationNo",controller:function($scope,$modalInstance){$scope.cancel=function(){$modalInstance.dismiss("cancel")}}}).result.then(function(response){})},onRightClick=function($event,app,col,patient){angular.element("#popupMenu").css({display:"block",top:$event.pageY-68,left:$event.pageX-20}),scope.appointment.selectedAppointment=angular.copy(app),scope.appointment.selectedCol=angular.copy(col),scope.appointment.selectedPatient=angular.copy(patient)};scope.appointment={selectedAppointment:{},selectedCol:{},selectedPatient:{},onRightClick:function($event,app,col,patient){onRightClick($event,app,col,patient)},dialog:{rightAdd:function(app,col){dialogRightAdd(app,col)},rightEdit:function(app,col){dialogRightEdit(app,col)},add:function(app,col){dialogAdd(app,col)},chooseWaitingList:function(col){dialogWaitingListAdd(col)}},list:[],search:angular.copy(search),load:function(){load()}},$cookieStore.get("appointment")&&(scope.appointment.search=$cookieStore.get("appointment"),$cookieStore.remove("appointment")),scope.site={list:[],load:function(){loadSite()}},scope.doctor={headers:[]},scope.clinicalDept={list:[],load:function(){loadClinical()}};var loadAlertCenterPatient=function(){AppointmentModel.alertCenterPatient().then(function(response){scope.loadAlertCenterPatient.list=response.data})};scope.loadAlertCenterPatient={load:function(){loadAlertCenterPatient()},list:[]},scope.loadAlertCenterPatient.load();var loadAlertCenter=function(){var postData=angular.copy(scope.appointment.search);postData.datepicker=ConfigService.convertToDB(postData.datepicker),scope.alertCenter.list=[],AppointmentModel.alertCenter(postData).then(function(response){_.forEach(response.data,function(row){var flag=-1,i=0;if(_.forEach(scope.alertCenter.list,function(list){return list.Patient_id===row.Patient_id?void(flag=i):void i++}),-1!==flag){if(row.ALERT_ID){var alert_flag=!0;if(_.forEach(scope.alertCenter.list[flag].alert,function(alert){alert.id===row.ALERT_ID&&(alert_flag=!1)}),alert_flag){var object={id:row.ALERT_ID,name:row.ALERT_NAME,color:row.SERVICE_COLOR,patient_alert:row.ID,Check:row.Check,User:row.User,isUser:row.isUser,Patients_id:row.Patients_id};scope.alertCenter.list[flag].alert.push(object)}var cal_flag=!0,i=0;if(_.forEach(scope.alertCenter.list[flag].cal,function(cal){cal.CAL_ID===row.CAL_ID&&(cal_flag=!1)}),cal_flag&&(scope.alertCenter.list[flag].test=row.IS_REFERRAL,scope.alertCenter.list[flag].cal.push({IS_REFERRAL:row.IS_REFERRAL,CAL_ID:row.CAL_ID,FROM_TIME:row.FROM_TIME,TO_TIME:row.TO_TIME,OUTREFERRAL:"no",DOCTOR_ID:row.DOCTOR_ID}),row.outreferral_id)){var cal_length=scope.alertCenter.list[flag].cal.length;scope.alertCenter.list[flag].cal[cal_length-1].OUTREFERRAL="yes"}}}else{var object={Patient_id:row.Patient_id,First_name:row.First_name,Sur_name:row.Sur_name,alert:[],cal:[]};row.ALERT_ID&&object.alert.push({id:row.ALERT_ID,name:row.ALERT_NAME,color:row.SERVICE_COLOR,patient_alert:row.ID,Check:row.Check,User:row.User,isUser:row.isUser,Patients_id:row.Patients_id}),row.CAL_ID&&(object.test=row.IS_REFERRAL,object.cal.push({IS_REFERRAL:row.IS_REFERRAL,DOCTOR_ID:row.DOCTOR_ID,CAL_ID:row.CAL_ID,FROM_TIME:row.FROM_TIME,TO_TIME:row.TO_TIME,OUTREFERRAL:"no"}),row.outreferral_id&&(object.cal[0].OUTREFERRAL="yes")),scope.alertCenter.list.push(object)}})},function(error){})};scope.clickArrow=function(){scope.alertCenter.arrow=!scope.alertCenter.arrow,scope.alertCenter.arrow?(angular.element("#alert-center").css({display:"none"}),angular.element(".un_arrow").css({right:0})):(angular.element("#alert-center").css({display:"block"}),angular.element(".un_arrow").css({right:"225px"}))};var search={id:0,isCheck:0,isUser:0},onCheck=function(row){scope.alertCenter.search.id=row.patient_alert,scope.alertCenter.search.isCheck=row.Check,scope.alertCenter.search.isUser=user_id,scope.alertCenter.search.Patients_id=row.Patients_id,AppointmentModel.PostCheck(scope.alertCenter.search).then(function(response){var temp=[],temp_r=[];angular.forEach(scope.alertCenter.list,function(value,index){scope.alertCenter.list[index].Patient_id===scope.alertCenter.search.Patients_id&&temp.push(value)}),angular.forEach(temp[0].alert,function(values,indexs){temp[0].alert[indexs].patient_alert===scope.alertCenter.search.id&&temp_r.push(values)}),AppointmentModel.PostUser(user_id).then(function(resp){angular.forEach(temp_r,function(valuer,indexr){temp_r[indexr].User=resp.data[0].User}),angular.forEach(scope.alertCenter.list,function(value_y,index_y){angular.forEach(temp_r,function(value_x,index_x){scope.alertCenter.list[index_y].Patient_id===temp_r[index_x].Patients_id&&angular.forEach(scope.alertCenter.list[index_y].alert,function(value_a,index_a){})})})},function(error){})},function(error){})};scope.alertCenter={search:search,onCheck:function(row){onCheck(row)},load:function(){loadAlertCenter()},list:[],arrow:!1},scope.site.load(),scope.clinicalDept.load(),scope.appointment.load()}}}),angular.module("app.loggedIn.appointment.directives.add",[]).directive("appointmentAdd",function(ConfigService,sysServiceService,AppointmentModel,WaitingListModel,$modal,$state,toastr){return{restrict:"EA",scope:{params:"=",patient:"=",options:"=",search:"=",checkedit:"="},templateUrl:"modules/appointment/directives/templates/add.html",link:function(scope,elem,attrs){var form={PHONE:"",APP_TYPE:"",STATUS:"",AVAILABLE:null,ARR_TIME:null,ATTEND_TIME:null,bill_to:null,ACC_TYPE:null,SERVICE_ID:scope.params.col.SERVICE_ID,NOTES:""};scope.row=null,scope.cln_appt_patientsID=null,scope.ID_clAPPatient=null,scope.CheckAddPatient=!1,scope.wattinglist=!1,scope.nextAppointment=null;var acc_type_load=function(){ConfigService.account_type_option().then(function(response){scope.acc_type.list=response.list},function(error){})},serviceLoad=function(){sysServiceService.byClinicalDepartment(scope.params.col.CLINICAL_DEPT_ID).then(function(response){scope.service.list=response.data},function(error){})};scope.loadAlertCenterPatient={list:[]};var loadAlertCenterPatient=function(){AppointmentModel.alertCenterPatient().then(function(response){scope.loadAlertCenterPatient.list=response.data})};loadAlertCenterPatient();var PatientAppHaveNext=function(){$modal.open({templateUrl:"PatientAppHaveNext",controller:function($scope,$modalInstance,list){$scope.loadAlertCenterPatient=list,$scope.clickOnRow=function(row){$modalInstance.close(row)}},resolve:{list:function(){return scope.loadAlertCenterPatient.list}}}).result.then(function(row){row&&(console.log(row),scope.wattinglist=!0,scope.CheckAddPatient=!1,scope.nextAppointment=row,scope.ID_clAPPatient&&deleteClnAppPatient(scope.ID_clAPPatient),scope.row=row,scope.arr_objectNameFirst=row.First_name,scope.arr_objectNameLast=row.Sur_name)})},waitingListSelect=function(){$modal.open({templateUrl:"waitingListSelect",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){row&&(scope.wattinglist=!0,scope.CheckAddPatient=!1,scope.nextAppointment=null,scope.ID_clAPPatient&&deleteClnAppPatient(scope.ID_clAPPatient),scope.row=row,scope.arr_objectNameFirst=row.First_name,scope.arr_objectNameLast=row.Sur_name)})},patientAdd=function(){$modal.open({templateUrl:"patientAdd",controller:function($scope,$modalInstance,options,cal_id){$scope.options=options,$scope.params={permission:{create:!0,edit:!1,calendar:!0},CAL_ID:cal_id},$scope.onsuccess="",$scope.$watch("onsuccess",function(patient_id){""!==patient_id&&$modalInstance.close(patient_id)})},size:"lg",resolve:{options:function(){return scope.options},cal_id:function(){return scope.params.col.CAL_ID}}}).result.then(function(status){if(""!==status){var postData={CAL_ID:-1,Patient_id:status.Patient_id};AppointmentModel.postGetCal(postData).then(function(response){scope.ID_clAPPatient=response.data[0].id}),scope.row=status,scope.CheckAddPatient=!0,scope.wattinglist=!1,scope.nextAppointment=null,scope.arr_objectNameFirst=status.First_name,scope.arr_objectNameLast=status.Sur_name}})},deleteClnAppPatient=function(value){AppointmentModel.deleteClnAppPatient({id:value}).then(function(response){(response.data="success")&&(scope.ID_clAPPatient=null)})},patientSelect=function(){$modal.open({templateUrl:"patientList",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}},size:"lg"}).result.then(function(row){scope.row=row,scope.CheckAddPatient=!1,scope.wattinglist=!1,scope.nextAppointment=null,scope.ID_clAPPatient&&deleteClnAppPatient(scope.ID_clAPPatient),scope.arr_objectNameFirst=row.First_name,scope.arr_objectNameLast=row.Sur_name})};if(scope.Ok=function(){if(scope.CheckAddPatient===!0){var Data={CAL_ID:scope.params.col.CAL_ID,Patient_id:scope.row.Patient_id};AppointmentModel.postGetCal(Data).then(function(response){scope.cln_appt_patientsID=response.data[0].id;var postData={form:{},Patient_id:null,cln_appt_patientsID:scope.cln_appt_patientsID};postData.form=angular.copy(scope.appointment.form),postData.form.ARR_TIME=ConfigService.convertToDB(postData.form.ARR_TIME),postData.form.ATTEND_TIME=ConfigService.convertToDB(postData.form.ATTEND_TIME),postData.form.CAL_ID=scope.params.col.CAL_ID,postData.Patient_id=scope.row.Patient_id,AppointmentModel.edit(postData).then(function(response){scope.patient={Patient_id:postData.Patient_id,First_name:scope.arr_objectNameFirst,Sur_name:scope.arr_objectNameLast},toastr.success("Edit Successfully")},function(error){})})}else if(1==scope.checkedit){if(scope.nextAppointment){var dataUpdateNextApp={cal_id:scope.nextAppointment.CAL_ID,patient_id:scope.nextAppointment.Patient_id};AppointmentModel.checkNextAppointment(dataUpdateNextApp).then(function(response){})}var postData={form:{},Patient_id:null,cln_appt_patientsID:scope.cln_appt_patientsID};postData.form=angular.copy(scope.appointment.form),postData.form.ARR_TIME=ConfigService.convertToDB(postData.form.ARR_TIME),postData.form.ATTEND_TIME=ConfigService.convertToDB(postData.form.ATTEND_TIME),postData.form.CAL_ID=scope.params.col.CAL_ID,postData.Patient_id=scope.row?scope.row.Patient_id:scope.params.patient.Patient_id,AppointmentModel.edit(postData).then(function(response){scope.patient={Patient_id:postData.Patient_id,First_name:scope.arr_objectNameFirst,Sur_name:scope.arr_objectNameLast},toastr.success("Edit Successfully")},function(error){})}else{if(scope.nextAppointment){var dataUpdateNextApp={cal_id:scope.nextAppointment.CAL_ID,patient_id:scope.nextAppointment.Patient_id};AppointmentModel.checkNextAppointment(dataUpdateNextApp).then(function(response){})}var postData=ConfigService.convertToDB(scope.search.datepicker).toString();AppointmentModel.ApptG(postData).then(function(response){if(scope.row){var postData={form:{},Patient_id:null};postData.form=angular.copy(scope.appointment.form),postData.form.ARR_TIME=ConfigService.convertToDB(postData.form.ARR_TIME),postData.form.ATTEND_TIME=ConfigService.convertToDB(postData.form.ATTEND_TIME),postData.form.CAL_ID=scope.params.col.CAL_ID,postData.Patient_id=scope.row.Patient_id,AppointmentModel.add(postData).then(function(response){scope.patient=scope.row,toastr.success("Added Successfully")},function(error){}),1==scope.wattinglist&&WaitingListModel.remove({id:scope.row.id}).then(function(response){},function(error){})}},function(error){})}},scope.cancel=function(){scope.patient=-1},scope.acc_type={load:function(){acc_type_load()},list:[]},scope.service={load:function(){serviceLoad()},list:[]},scope.acc_type.load(),scope.service.load(),scope.appointment={form:form},scope.app_patient={dialog:{add:function(){patientAdd()},select:function(){patientSelect()},waitingListSelect:function(){waitingListSelect()},PatientAppHaveNext:function(){PatientAppHaveNext()}}},scope.checkedit){var postData={CAL_ID:scope.params.col.CAL_ID,Patient_id:scope.params.patient.Patient_id};AppointmentModel.postGetCal(postData).then(function(response){scope.acc_type.load(),scope.service.load(),scope.appointment.form=response.data[0],scope.cln_appt_patientsID=response.data[0].id,scope.appointment.form,scope.appointment.form.ARR_TIME=ConfigService.convertToDate(scope.appointment.form.ARR_TIME),scope.appointment.form.ATTEND_TIME=ConfigService.convertToDate(scope.appointment.form.ATTEND_TIME),scope.arr_objectNameFirst=scope.appointment.form.First_name,scope.arr_objectNameLast=scope.appointment.form.Sur_name})}}}}),angular.module("app.loggedIn.alert",["app.loggedIn.alert.include"]).config(function($stateProvider){$stateProvider.state("loggedIn.alert",{url:"/alert",templateUrl:"modules/alert/views/list.html",controller:"AlertListController"}).state("loggedIn.patient.alert",{"abstract":!0,url:"/patientalert"}).state("loggedIn.patient.alert.list",{url:"/list",views:{"main-content@loggedIn.patient":{templateUrl:"modules/alert/views/patient/list.html",controller:"AlertPatientListController"}}})}),angular.module("app.loggedIn.alert.include",["app.loggedIn.alert.controllers.list","app.loggedIn.alert.controllers.patientList","app.loggedIn.alert.model","app.loggedIn.alert.directives.patientList","app.loggedIn.alert.directives.list","app.loggedIn.alert.directives.add","app.loggedIn.alert.directives.edit"]),angular.module("app.loggedIn.alert.model",[]).factory("AlertModel",function(Restangular){var instanceService={},appApi=Restangular.all("api/meditek/v1/alert");return instanceService.listFollowPatient=function(data){var detailApi=appApi.all("listFollowPatient");return detailApi.post({data:data})},instanceService.listNoFollowPatient=function(data){var detailApi=appApi.all("listNoFollowPatient");return detailApi.post({data:data})},instanceService.list=function(data){var detailApi=appApi.all("list");return detailApi.post({data:data})},instanceService.add=function(data){var detailApi=appApi.all("add");return detailApi.post({data:data})},instanceService.edit=function(data){var detailApi=appApi.all("edit");return detailApi.post({data:data})},instanceService.remove=function(data){var detailApi=appApi.all("remove");return detailApi.post({data:data})},instanceService.one=function(data){var detailApi=appApi.all("one");return detailApi.post({data:data})},instanceService.disableAlert=function(data){var detailApi=appApi.all("disableAlert");return detailApi.post({data:data})},instanceService.disablePatientAlert=function(data){var detailApi=appApi.all("disablePatientAlert");return detailApi.post({data:data})},instanceService.getMedication=function(data){var detailApi=appApi.all("getMedication");return detailApi.post({data:data})},instanceService.insertMedication=function(data){var detailApi=appApi.all("insertMedication");return detailApi.post({data:data})},instanceService.deleteMedication=function(data){var detailApi=appApi.all("deleteMedication");return detailApi.post({data:data})},instanceService.getdoctorid=function(data){var detailApi=appApi.all("getdoctorid");return detailApi.post({data:data})},instanceService.showcompanyid=function(data){var detailApi=appApi.all("showcompanyid");return detailApi.post({data:data})},instanceService.insertalert=function(data){var detailApi=appApi.all("insertalert");return detailApi.post({data:data})},instanceService.postshowalertpatient=function(data){var detailApi=appApi.all("postshowalertpatient");return detailApi.post({data:data})},instanceService.postlistalert=function(data){var detailApi=appApi.all("postlistalert");return detailApi.post({data:data})},instanceService}),angular.module("app.loggedIn.alert.controllers.list",[]).controller("AlertAddDialog",function($scope,$modalInstance){$scope.alert={success:!1},$scope.$watch("alert.success",function(success){success&&$modalInstance.close("success")})}).controller("AlertListController",function($scope,$modal,toastr){var add=function(){$scope.alert.reload=!1,$modal.open({templateUrl:"dialogAlertAdd",controller:"AlertAddDialog",size:"lg"}).result.then(function(response){"success"===response&&(toastr.success("Added Successfully"),$scope.alert.reload=!0)})};$scope.alert={dialog:{add:function(){add()}},reload:!1,limit:20}}),angular.module("app.loggedIn.alert.controllers.patientList",[]).controller("AlertPatientSelectDialog",function($scope,$modalInstance,Patient_id,CAL_ID,AlertModel,toastr){var onSaveCheck=function(data){var postData=angular.copy(data);AlertModel.insertalert(postData).then(function(response){toastr.success("Select Successfully"),$modalInstance.close("success")},function(error){})};$scope.alert={success:!1},$scope.$watch("alert.success",function(success){success&&$modalInstance.close("success")}),$scope.alert={Patient_id:Patient_id,CAL_ID:CAL_ID,limit:10,onSaveCheck:function(data){onSaveCheck(data)}}}).controller("AlertPatientListController",function($scope,$modal,$stateParams,toastr){var select=function(){$scope.alert.reload=!1,$modal.open({templateUrl:"dialogAlertPatientSelect",controller:"AlertPatientSelectDialog",size:"lg",resolve:{Patient_id:function(){return $stateParams.patient_id},CAL_ID:function(){return $stateParams.cal_id}}}).result.then(function(response){"success"===response&&($scope.alert.reload=!0)})},add=function(){$scope.alert.reload=!1,$modal.open({templateUrl:"dialogAddAlert",controller:"AlertPatientSelectDialog",size:"lg",resolve:{Patient_id:function(){return $stateParams.patient_id},CAL_ID:function(){return $stateParams.cal_id}}}).result.then(function(response){"success"===response&&($scope.alert.reload=!0)})};$scope.alert={dialog:{select:function(){select()},add:function(){add()}},reload:!1,Patient_id:$stateParams.patient_id,CAL_ID:$stateParams.cal_id,limit:20}}),angular.module("app.loggedIn.alert.directives.list",[]).controller("AlertRemoveDialog",function($scope,$modalInstance,list){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.ok=function(){$modalInstance.close(list)}}).controller("AlertEditDialog",function($scope,$modalInstance,list){$scope.alert={id:list.id,success:!1},$scope.$watch("alert.success",function(success){success&&$modalInstance.close("success")})}).directive("alertList",function($modal,AlertModel,toastr){return{restrict:"EA",scope:{limit:"=",reload:"="},templateUrl:"modules/alert/directives/templates/list.html",link:function(scope,elem,attrs){var search={page:1,limit:scope.limit,offset:0,max_size:5,name:"",description:"",SERVICE_COLOR:"",Creation_date:"desc",isenable:""},disableAlert=function(l){AlertModel.disableAlert(l).then(function(response){scope.alert.load()},function(error){})},load=function(){var postData=angular.copy(scope.alert.search);AlertModel.list(postData).then(function(response){scope.alert.list=response.data,scope.alert.count=response.count},function(error){})},onSearch=function(){scope.alert.search.offset=0,scope.alert.load(),scope.alert.search.page=1},onOrderBy=function(option){switch(option.field){case"Creation_date":scope.alert.search.Creation_date=option.order}scope.alert.load()},remove=function(list){$modal.open({templateUrl:"dialogAlertRemove",controller:"AlertRemoveDialog",size:"sm",resolve:{list:function(){return list}}}).result.then(function(list){AlertModel.remove(list).then(function(response){toastr.success("Delete Successfully"),scope.alert.load()},function(error){})})},edit=function(list){$modal.open({templateUrl:"dialogAlertEdit",controller:"AlertEditDialog",size:"lg",resolve:{list:function(){return list}}}).result.then(function(response){"success"===response&&(toastr.success("Edit Successfully"),scope.alert.load())})},onPage=function(page){scope.alert.search.offset=(page-1)*scope.alert.search.limit,scope.alert.load()};scope.alert={dialog:{remove:function(list){remove(list)},edit:function(list){edit(list)}},search:angular.copy(search),load:function(){load()},list:[],onSearch:function(){onSearch()},onOrderBy:function(option){onOrderBy(option)},onPage:function(page){onPage(page)},disableAlert:function(l){disableAlert(l)}},scope.alert.load(),scope.$watch("reload",function(reload){reload&&(scope.alert.search=angular.copy(search),scope.alert.load())})}}}),angular.module("app.loggedIn.alert.directives.patientList",[]).directive("alertPatientList",function($modal,$stateParams,AlertModel,toastr){return{restrict:"EA",scope:{patientId:"=",calId:"=",limit:"=",reload:"=",permission:"@",onSavecheck:"&"},templateUrl:"modules/alert/directives/templates/patientList.html",link:function(scope,elem,attrs){scope.action="undefined"==typeof scope.permission?{edit:!0,remove:!0,checkbox:!1}:scope.$eval(scope.permission);var search={page:1,limit:scope.limit,offset:0,max_size:5,name:"",description:"",Creation_date:"desc",Patient_id:scope.patientId,CAL_ID:scope.calId,isEnable:""},bysearch={page:1,max_size:5,limit:15,offset:0,patient_id:$stateParams.patient_id,cal_id:$stateParams.cal_id},searchlist={page:1,max_size:5,limit:10,offset:0};scope.setPage=function(page){scope.alert.searchlist.offset=(page-1)*scope.alert.searchlist.limit,scope.alert.load()},scope.onPage=function(page){scope.alert.bysearch.offset=(page-1)*scope.alert.bysearch.limit,scope.alert.load()};var load=function(){if(1==scope.action.edit?AlertModel.postshowalertpatient(scope.alert.bysearch).then(function(response){scope.alert.bylist=response.data,scope.alert.count=response.count},function(error){}):AlertModel.showcompanyid($stateParams.patient_id).then(function(response){scope.alert.searchlist.company_id=response.data[0].company_id,AlertModel.postlistalert(scope.alert.searchlist).then(function(res){
scope.alert.list=res.data,scope.alert.count_list=res.count},function(error){})},function(error){}),"undefined"!=typeof scope.withoutPatient&&scope.withoutPatient){var postData=angular.copy(scope.alert.search);console.log(postData),AlertModel.listNoFollowPatient(postData).then(function(response){scope.alert.list=response.data,scope.alert.count=response.count},function(error){})}else{var postData=angular.copy(scope.alert.search);AlertModel.listFollowPatient(postData).then(function(response){scope.alert.list=response.data,scope.alert.count=response.count},function(error){})}},onSearch=function(){scope.alert.search.offset=0,scope.alert.load(),scope.alert.search.page=1},onOrderBy=function(option){switch(option.field){case"Creation_date":scope.alert.search.Creation_date=option.order}scope.alert.load()},remove=function(list){$modal.open({templateUrl:"dialogAlertRemove",controller:"AlertRemoveDialog",size:"sm",resolve:{list:function(){return list}}}).result.then(function(list){AlertModel.remove(list).then(function(response){toastr.success("Delete Successfully"),scope.alert.load()},function(error){})})},edit=function(list){$modal.open({templateUrl:"dialogAlertEdit",controller:"AlertEditDialog",size:"md",resolve:{list:function(){return list}}}).result.then(function(response){"success"===response&&(toastr.success("Edit Successfully"),scope.alert.load())})},onPage=function(page){scope.alert.search.offset=(page-1)*scope.alert.search.limit,scope.alert.load()},onCheckbox=function(option){if(option.value)scope.alert.checkbox.push({patient_id:scope.patientId,cal_id:$stateParams.cal_id,alert_id:option.list.id});else{var i=0;_.forEach(scope.alert.checkbox,function(checkbox){return checkbox.alert_id===option.list.id?void scope.alert.checkbox.splice(i,1):void i++})}};scope.alert={dialog:{remove:function(list){remove(list)},edit:function(list){edit(list)}},count:0,count_list:0,search:angular.copy(search),bysearch:bysearch,load:function(){load()},searchlist:searchlist,list:[],bylist:[],checkbox:[],onSearch:function(){onSearch()},onOrderBy:function(option){onOrderBy(option)},onPage:function(page){onPage(page)},onCheckbox:function(option){onCheckbox(option)},checkedit:scope.action.edit},scope.alert.load(),scope.$watch("reload",function(reload){reload&&(scope.alert.search=angular.copy(search),scope.alert.load())})}}}),angular.module("app.loggedIn.alert.directives.add",[]).directive("alertAdd",function($cookieStore,$stateParams,AlertModel,ConfigService,toastr){return{restrict:"EA",scope:{success:"=",alertid:"="},templateUrl:"modules/alert/directives/templates/add.html",link:function(scope,elem,attrs){$("#service_color").minicolors({control:"wheel"});var user_id=$cookieStore.get("userInfo").id,Patient_id=$stateParams.patient_id,Cal_id=$stateParams.cal_id,form={name:"",description:"",SERVICE_COLOR:"",company_id:0,Created_by:user_id,Last_updated_by:user_id},save=function(){ConfigService.beforeSave(scope.alert.errors);var postData=angular.copy(scope.alert.form);postData.Creation_date=postData.Last_update_date=moment().format("YYYY-MM-DD"),0!=scope.alertid&&scope.alertid&&(postData.company_id=scope.alertid),0!=Patient_id&&0!=Cal_id&&(postData.patient_id=Patient_id,postData.cal_id=Cal_id),AlertModel.add(postData).then(function(response){toastr.success("Added Successfully"),scope.success=!0},function(error){scope.alert.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.alert.errors)})};scope.alert={form:form,errors:[],save:function(){save()}}}}}),angular.module("app.loggedIn.alert.directives.edit",[]).directive("alertEdit",function($cookieStore,AlertModel,ConfigService){return{restrict:"EA",scope:{success:"=",alertId:"="},templateUrl:"modules/alert/directives/templates/edit.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id;$("#service_color").minicolors({control:"wheel"});var form={name:"",description:"",SERVICE_COLOR:"",Created_by:user_id,Last_updated_by:user_id},save=function(){ConfigService.beforeSave(scope.alert.errors);var postData=angular.copy(scope.alert.form);postData.Last_update_date=moment().format("YYYY-MM-DD"),AlertModel.edit(postData).then(function(response){scope.success=!0},function(error){scope.alert.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.alert.errors)})},load=function(){var postData={id:scope.alertId};AlertModel.one(postData).then(function(response){angular.extend(scope.alert.form,response.data),delete scope.alert.form.Creation_date},function(error){})};scope.alert={form:angular.copy(form),load:function(){load()},errors:[],save:function(){save()}},scope.alert.load()}}}),angular.module("app.loggedIn.allergy",["app.loggedIn.allergy.controller","app.loggedIn.allergy.service","app.loggedIn.allergy.directive"]).config(function($stateProvider){$stateProvider.state("loggedIn.allergy",{url:"/allergy","abstract":!0,templateUrl:"modules/allergies/views/structure.html",controller:"AllergyController"}).state("loggedIn.patient.allergy",{"abstract":!0,views:{"main-content@loggedIn.patient":{templateUrl:"modules/allergies/views/structure.html",controller:"AllergyController"}}}).state("loggedIn.allergy.list",{url:"/list",views:{"main-content":{templateUrl:"modules/allergies/views/list.html",controller:"AllergyListController"}}}).state("loggedIn.patient.allergy.list",{url:"/allergy",views:{"main-content":{templateUrl:"modules/allergies/views/list.html",controller:"AllergyListController"}}})}),angular.module("app.loggedIn.allergy.controller",["app.loggedIn.allergy.list.controller"]).controller("AllergyController",function(){}),angular.module("app.loggedIn.allergy.list.controller",[]).controller("AllergyListController",function($scope,$stateParams,AllergyService,toastr){$scope.allergy_panel={},console.log("this is patient_id",$stateParams.patient_id),$stateParams.patient_id&&($scope.showAddExisted=!0),$scope.allergy={select:0,scope:$scope.patient_panel,options:{method:"post",scope:$scope.allergy_panel,columns:[{field:"allergy_id",is_hide:!0},{field:"allergy_name",label:"Allergy Name"},{field:"isEnable",is_hide:!0}],use_filters:!0,filters:{allergy_name:{type:"text"}},use_actions:!0,actions:[{"class":"fa fa-info",title:"Edit",callback:function(item){console.log("this is selected item",item),$scope.allergy.id=item.allergy_id,$scope.allergyEditForm.open()}}],actionsIsEnable:{show:!0,setEnable:function(item){item.isEnable=0==item.isEnable?1:0,console.log(item),AllergyService.update(item).then(function(data){(data.status="success")&&($scope.setListAllergy&&$scope.setListAllergy(),$scope.allergy_panel.reload())})}}}},$stateParams.patient_id?($scope.allergy.options.api="api/erm/v2/allergy/search_patient_allergy",$scope.allergy.options.search={Patient_id:$stateParams.patient_id}):$scope.allergy.options.api="api/erm/v2/allergy/search",$scope.allergySub=angular.copy($scope.allergy),$scope.allergyAddForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.setListAllergy&&$scope.setListAllergy(),$scope.allergy_panel.reload(),$scope.allergyAddForm.close()}},$scope.allergyEditForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.setListAllergy&&$scope.setListAllergy(),$scope.allergy_panel.reload(),$scope.allergyEditForm.close()}},$scope.patientAllergyForm={is_show:!1,open:function(){$scope.allergySub.options.use_actions=!1,$scope.allergySub.options.columns=[{field:"allergy_id",is_hide:!0},{field:"allergy_name",label:"Allergy name"},{field:"Creation_date",label:"Created date"}],$scope.allergySub.options.api="api/erm/v2/allergy/search_remain_allergy",this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.allergy_panel.reload(),$scope.patientAllergyForm.close()}},$scope.allergySelected=function(item){console.log("this is selected item",item);var postData={allergy_id:item.allergy_id,patient_id:$stateParams.patient_id};AllergyService.insertPatientAllergy(postData).then(function(response2){"success"===response2.status?(toastr.success("Allergy applied to patient","Successfully"),$scope.setListAllergy&&$scope.setListAllergy(),$scope.patientAllergyForm.close(),$scope.allergy_panel.reload()):toastr.error("Fail to apply allergy to patient","Error")})}}),angular.module("app.loggedIn.allergy.service",[]).factory("AllergyService",function(Restangular,ConfigService,$state){var instanceService={},v2_api=Restangular.all("api/erm/v2");return instanceService.insert=function(postData){var detailApi=v2_api.all("allergy/insert");return detailApi.post(postData)},instanceService.detail=function(postData){var detailApi=v2_api.all("allergy/detail");return detailApi.post({ID:postData})},instanceService.update=function(postData){var detailApi=v2_api.all("allergy/update");return detailApi.post(postData)},instanceService.insertPatientAllergy=function(postData){var detailApi=v2_api.all("allergy/insert_patient_allergy");return detailApi.post(postData)},instanceService}),angular.module("app.loggedIn.allergy.directive",["app.loggedIn.allergy.detail.directive"]),angular.module("app.loggedIn.allergy.detail.directive",[]).directive("allergyDetail",function(AllergyModel,AllergyService,ConfigService,toastr,$stateParams){return{restrict:"EA",scope:{data:"@",options:"=",onsuccess:"=onsuccess"},templateUrl:"modules/allergies/directives/templates/detail.html",link:function(scope,element,attrs){var loadData=function(id){AllergyService.detail(id).then(function(data){angular.extend(scope.modelObjectMap,data.data),ConfigService.autoConvertData(scope.modelObjectMap)})};if(scope.modelObjectMap=angular.copy(AllergyModel),scope.mode={type:"add",text:"Add allergy"},scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit referral"})}var addProcess=function(postData){AllergyService.insert(postData).then(function(response){if("success"===response.status)if($stateParams.patient_id){var postData={allergy_id:response.data.allergy_id,patient_id:$stateParams.patient_id};AllergyService.insertPatientAllergy(postData).then(function(response2){"success"===response2.status?(toastr.success("Successfully add and apllied allergy to patient","Successfully"),scope.modelObjectMap=angular.copy(AllergyModel),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response)):toastr.error("Allergy add successfully but fail to apply allergy to patient","Error")})}else toastr.success("Add allergy successfully","Successfully"),scope.modelObjectMap=angular.copy(AllergyModel),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response);else toastr.error("Fail to add allergy","Error")})},editProcess=function(postData){AllergyService.update(postData).then(function(response){"success"===response.status&&(toastr.success("Edit allergy Successfully","Success"),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.certificate",["app.loggedIn.certificate.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.certificate",{"abstract":!0,templateUrl:"modules/certificate/views/structure.html",controller:"CertificateController"}).state("loggedIn.certificate.home",{url:"/certificate/home",views:{"main-content":{templateUrl:"modules/certificate/views/home.html",controller:"CertificateHomeController"}}}).state("loggedIn.certificate.referral",{url:"/certificate/referral",views:{"main-content":{templateUrl:"modules/certificate/views/referral.html",controller:"CertificateReferralController"}}}).state("loggedIn.certificate.scripts",{url:"/certificate/scripts",views:{"main-content":{templateUrl:"modules/certificate/views/scripts.html",controller:"CertificateScriptsController"}}})}),angular.module("app.loggedIn.certificate.controller",["app.loggedIn.certificate.home.controller","app.loggedIn.certificate.referral.controller","app.loggedIn.certificate.scripts.controller"]).controller("CertificateController",function($scope,ConfigService){}),angular.module("app.loggedIn.certificate.home.controller",[]).controller("CertificateHomeController",function($scope,ConfigService){}),angular.module("app.loggedIn.certificate.referral.controller",[]).controller("CertificateReferralController",function($scope,$state,$stateParams,$cookieStore,toastr,localStorageService,PatientService,ReceptionistService){$scope.accordion={patientDetails:!0,referral:!0};var Patient=localStorageService.get("patientTempInfo");Patient.CAL_ID=localStorageService.get("apptTempInfo").CAL_ID,$scope.referralObjectMap={patient_id:Patient.Patient_id,appointment_id:Patient.CAL_ID,CT_SCAN:0,X_RAY:0,MRI:0,ULTRASOUND:0,PATHOLOGY:0,CLINICAL_DETAILS:"",ALLERGIES:0,REQUESTING_PRACTITIONER:"",REPORT_URGENT:0,ELECTRONIC:0,FAX:0,MAIL:0,PHONE:0,RETURN_WITH_PATIENT:0,APPOINTMENT_DATE:null,Created_by:$cookieStore.get("userInfo").id,AssessmentName:"",AssessmentId:""},$scope.patient={},$scope.patient_id=0,$scope.appointment_id=0;var flag=!1,loadPage=function(){PatientService.getPatient(Patient.Patient_id).then(function(data){$scope.patient=data.data[0]}),PatientService.getReferral($scope.referralObjectMap).then(function(data){data.length>0&&($scope.referralObjectMap=data[0],flag=!0)}),$scope.isSubmited=!1};loadPage(),$scope.submitReferral=function(){0==flag?PatientService.insertReferral($scope.referralObjectMap).then(function(data){"OK"==data.status?(toastr.success("Referral created successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")}):PatientService.updateReferral($scope.referralObjectMap).then(function(data){"OK"==data.status?(toastr.success("Referral created successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")})}}),angular.module("app.loggedIn.certificate.scripts.controller",[]).controller("CertificateScriptsController",function($scope,$state,$cookieStore,toastr,PatientService,ReceptionistService,localStorageService){$scope.accordion={script:!0};var Patient=localStorageService.get("patientTempInfo");Patient.CAL_ID=localStorageService.get("apptTempInfo").CAL_ID,$scope.scriptObjectMap={patient_id:Patient.Patient_id,appointment_id:Patient.CAL_ID,prescriber:"",scriptNum:0,Medicare:"",isRefNo:0,EntitlementNo:"",isSafety:0,isConcessional:0,isPBS:0,isRPBS:0,isBrand:0,pharmacist:"",doctorSign:null,doctordate:null,patientSign:null,patientDate:"",agentAddress:"",AssessmentName:"",Created_by:$cookieStore.get("userInfo").id,AssessmentId:0},$scope.patient={},$scope.patient_id=0,$scope.appointment_id=0;var flag=!1,loadPage=function(){PatientService.getPatient(Patient.Patient_id).then(function(data){$scope.patient=data.data[0],console.log(data)}),PatientService.getScript($scope.scriptObjectMap).then(function(data){data.length>0&&($scope.scriptObjectMap=data[0],flag=!0)})};loadPage(),$scope.submitScript=function(){console.log($scope.scriptObjectMap),0==flag?PatientService.insertScript($scope.scriptObjectMap).then(function(data){"OK"==data.status?(toastr.success("Script created successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")}):PatientService.updateScript($scope.scriptObjectMap).then(function(data){"OK"==data.status?(toastr.success("Script update successfully.","Success"),$state.go("loggedIn.doctor.patients.detail.appt")):toastr.error("Server error.","Error")})}}),angular.module("app.loggedIn.certificate.directive",["app.loggedIn.certificate.script.directive"]),angular.module("app.loggedIn.certificate.script.directive",[]).directive("scriptModule",function(){return{restrict:"EA",scope:{},templateUrl:"modules/certificate/directives/templates/script.html",link:function(scope,element,attrs){}}}),angular.module("app.loggedIn.claim",["app.loggedIn.claim.include"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.claim",{"abstract":!0,url:"/claim"}).state("loggedIn.patient.claim.list",{url:"/list",views:{"main-content@loggedIn.patient":{templateUrl:"modules/claim/views/patient/list.html",controller:"ClaimPatientListController"}}})}),angular.module("app.loggedIn.claim.include",["app.loggedIn.claim.directives.patientList","app.loggedIn.claim.directives.patientAdd","app.loggedIn.claim.directives.patientEdit","app.loggedIn.claim.controllers.patientList","app.loggedIn.claim.directives.patientShow","app.loggedIn.claim.model"]),angular.module("app.loggedIn.claim.model",[]).factory("ClaimModel",function(Restangular){var instanceService={},appApi=Restangular.all("api/meditek/v1/claim");return instanceService.listFollowPatient=function(data){var detailApi=appApi.all("listFollowPatient");return detailApi.post({data:data})},instanceService.listFollowPatientInsurer=function(data){var detailApi=appApi.all("listFollowPatientInsurer");return detailApi.post({data:data})},instanceService.listNoFollowPatient=function(data){var detailApi=appApi.all("listNoFollowPatient");return detailApi.post({data:data})},instanceService.getPatientInsurer=function(patientId){var detailApi=appApi.one("getPatientInsurer");return detailApi.get({patientId:patientId})},instanceService.add=function(data){var detailApi=appApi.all("add");return detailApi.post({data:data})},instanceService.addPatient=function(data){var detailApi=appApi.all("addPatient");return detailApi.post({data:data})},instanceService.edit=function(data){var detailApi=appApi.all("edit");return detailApi.post({data:data})},instanceService.remove=function(data){var detailApi=appApi.all("remove");return detailApi.post({data:data})},instanceService.one=function(data){var detailApi=appApi.all("one");return detailApi.post({data:data})},instanceService.OClose=function(data){var detailApi=appApi.all("oclose");return detailApi.post({data:data})},instanceService}),angular.module("app.loggedIn.claim.directives.patientAdd",[]).directive("claimPatientAdd",function($cookieStore,ClaimModel,ConfigService,InsurerService){return{restrict:"EA",scope:{patientId:"=",calId:"=",success:"=",successData:"=",insurerdata:"="},templateUrl:"modules/claim/directives/templates/patientAdd.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,form={Patient_id:scope.patientId,Injury_name:"",Injury_date:null,How_Injury_Occurred:"",Location:"",Claim_date:null,Claim_no:"",Address:"",Case_manager:"",isCurr:"1",PO_number:"",Isenable:"1",Created_by:user_id,Last_updated_by:user_id,CAL_ID:scope.calId},save=function(){ConfigService.beforeSave(scope.claim.errors);var postData=angular.copy(scope.claim.form);postData.Creation_date=postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.Injury_date&&(postData.Injury_date=ConfigService.convertToDB(postData.Injury_date)),postData.Claim_date&&(postData.Claim_date=ConfigService.convertToDB(postData.Claim_date)),ClaimModel.add(postData).then(function(response){scope.success=scope.insurerdata?response.data:!0},function(error){scope.claim.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.claim.errors)})},loadInsurer=function(){if(scope.insurerdata)scope.insurer.name=scope.insurerdata.insurer_name,form.insurer_id=scope.insurerdata.id,form.Insurer=scope.insurerdata.insurer_name;else{var postData={Patient_id:scope.patientId};InsurerService.oneFollowPatient(postData).then(function(response){"undefined"!=typeof response.data?(scope.insurer.name=response.data.insurer_name,form.insurer_id=response.data.id,form.Insurer=response.data.insurer_name):scope.insurer.name="No Insurer"},function(error){})}};scope.claim={form:form,errors:[],save:function(){save()}},scope.insurer={load:function(){loadInsurer()},name:""},scope.insurer.load()}}}),angular.module("app.loggedIn.claim.directives.patientEdit",[]).directive("claimPatientEdit",function($cookieStore,$stateParams,ClaimModel,ConfigService,InsurerService){return{restrict:"EA",scope:{claimId:"=",patientId:"=",success:"="},templateUrl:"modules/claim/directives/templates/patientEdit.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,form={Patient_id:scope.patientId,Injury_name:"",Injury_date:null,How_Injury_Occurred:"",Location:"",Claim_date:null,Claim_no:"",Address:"",Case_manager:"",isCurr:"1",PO_number:"",Isenable:"0",Created_by:user_id,Last_updated_by:user_id},save=function(){ConfigService.beforeSave(scope.claim.errors);var postData=angular.copy(scope.claim.form);postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.Injury_date&&(postData.Injury_date=ConfigService.convertToDB(postData.Injury_date)),postData.Claim_date&&(postData.Claim_date=ConfigService.convertToDB(postData.Claim_date)),ClaimModel.edit(postData).then(function(response){scope.success=!0},function(error){scope.claim.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.claim.errors)})},loadInsurer=function(){},load=function(){var postData={Patient_id:scope.patientId,Claim_id:scope.claimId};ClaimModel.one(postData).then(function(response){scope.insurer.name=null!==response.data.Insurer?response.data.Insurer:"No Insurer",angular.extend(scope.claim.form,response.data),scope.claim.form.Claim_date=ConfigService.convertToDate(scope.claim.form.Claim_date),scope.claim.form.Injury_date=ConfigService.convertToDate(scope.claim.form.Injury_date),scope.claim.form.isCurr=scope.claim.form.isCurr.toString(),scope.claim.form.Isenable=scope.claim.form.Isenable.toString(),delete scope.claim.form.Creation_date},function(error){})};scope.claim={errors:[],load:function(){load()},form:angular.copy(form),errors:[],save:function(){save()}},scope.insurer={load:function(){loadInsurer()},name:""},scope.claim.load(),scope.insurer.load()}}}),angular.module("app.loggedIn.claim.directives.patientList",[]).controller("ClaimPatientRemoveDialog",function($scope,$modalInstance,list){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.ok=function(){$modalInstance.close(list)}}).controller("ClaimPatientEditDialog",function($scope,$modalInstance,$stateParams,list){$scope.claim={Claim_id:list.Claim_id,Patient_id:$stateParams.patient_id,success:!1},$scope.$watch("claim.success",function(success){success&&$modalInstance.close("success")})}).controller("ClaimPatientShowDialog",function($scope,$modalInstance,$stateParams,list){$scope.claim={Claim_id:list.Claim_id,Patient_id:$stateParams.patient_id,success:!1},$scope.$watch("claim.success",function(success){success&&$modalInstance.close("success")})}).directive("claimPatientList",function(ClaimModel,$modal,toastr,$stateParams){return{restrict:"EA",scope:{reload:"=",limit:"=",patientId:"=",calId:"=",withoutPatient:"@",permission:"@",onRowClick:"&",addSuccess:"="},templateUrl:"modules/claim/directives/templates/patientList.html",link:function(scope,elem,attrs){scope.action="undefined"==typeof scope.permission?{edit:!0,remove:!0,add:!0,show:!0}:scope.$eval(scope.permission),console.log(scope.action);var search={page:1,limit:scope.limit,offset:0,max_size:5,Claim_no:"",Claim_date:"desc",Injury_name:"",Injury_date:"asc",Patient_id:scope.patientId},load=function(){var postData=angular.copy(scope.claim.search);"undefined"!=typeof scope.withoutPatient&&scope.withoutPatient?ClaimModel.listNoFollowPatient(postData).then(function(response){scope.claim.list=response.data,scope.claim.count=response.count},function(error){}):ClaimModel.listFollowPatient(postData).then(function(response){scope.claim.list=response.data,scope.claim.count=response.count},function(error){})},onPage=function(page){scope.claim.search.offset=(page-1)*scope.claim.search.limit,scope.claim.load()},onSearch=function(){scope.claim.load(),scope.claim.search.page=1},onOrderBy=function(option){switch(option.field){case"Claim_date":scope.claim.search.Claim_date=option.order;break;case"Injury_date":scope.claim.search.Injury_date=option.order}scope.claim.load()},remove=function(list){$modal.open({templateUrl:"dialogClaimRemove",controller:"ClaimPatientRemoveDialog",size:"sm",resolve:{list:function(){return list}}}).result.then(function(list){ClaimModel.remove(list).then(function(response){toastr.success("Deleted Successfully"),scope.claim.load()},function(error){})})},edit=function(list){$modal.open({templateUrl:"dialogClaimEdit",controller:"ClaimPatientEditDialog",size:"md",resolve:{list:function(){return list}}}).result.then(function(response){"success"===response&&(toastr.success("Edit Successfully"),scope.claim.load())})},add=function(){$modal.open({templateUrl:"claimAdd",controller:function($scope,$modalInstance,patientId,calId){$scope.claim={Patient_id:patientId,CAL_ID:calId,success:!1},$scope.$watch("claim.success",function(success){success&&$modalInstance.close("success")})},size:"lg",resolve:{patientId:function(){return scope.patientId},calId:function(){return scope.calId}}}).result.then(function(success){"success"===success&&(toastr.success("Add Successfully"),scope.addSuccess=!0)})},show=function(list){$modal.open({templateUrl:"dialogClaimShow",controller:"ClaimPatientShowDialog",size:"md",resolve:{list:function(){return list}}}).result.then(function(response){"success"===response&&(toastr.success("Edit Successfully"),scope.claim.load())})};scope.claim={dialog:{add:function(){add()},remove:function(list){remove(list)},edit:function(list){edit(list)},show:function(list){show(list)}},load:function(){load()},list:[],count:0,search:angular.copy(search),onPage:function(page){onPage(page)},onSearch:function(){onSearch()},onOrderBy:function(option){onOrderBy(option)}},scope.claim.load(),scope.$watch("reload",function(reload){scope.claim.search=angular.copy(search),reload&&scope.claim.load()})}}}),angular.module("app.loggedIn.claim.directives.patientShow",[]).directive("claimPatientShow",function($cookieStore,$stateParams,ClaimModel,ConfigService,InsurerService){return{restrict:"EA",scope:{claimId:"=",patientId:"=",success:"="},templateUrl:"modules/claim/directives/templates/patientShow.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,form={Patient_id:scope.patientId,Injury_name:"",Injury_date:null,How_Injury_Occurred:"",Location:"",Claim_date:null,Claim_no:"",Address:"",Case_manager:"",isCurr:"1",PO_number:"",Isenable:"0",Created_by:user_id,Last_updated_by:user_id},save=function(){ConfigService.beforeSave(scope.claim.errors);var postData=angular.copy(scope.claim.form);postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.Injury_date&&(postData.Injury_date=ConfigService.convertToDB(postData.Injury_date)),postData.Claim_date&&(postData.Claim_date=ConfigService.convertToDB(postData.Claim_date)),ClaimModel.edit(postData).then(function(response){scope.success=!0},function(error){scope.claim.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.claim.errors)})},loadInsurer=function(){},load=function(){var postData={Patient_id:scope.patientId,Claim_id:scope.claimId};ClaimModel.one(postData).then(function(response){scope.insurer.name=null!==response.data.Insurer?response.data.Insurer:"No Insurer",angular.extend(scope.claim.form,response.data),scope.claim.form.Claim_date=ConfigService.convertToDate(scope.claim.form.Claim_date),scope.claim.form.Injury_date=ConfigService.convertToDate(scope.claim.form.Injury_date),scope.claim.form.isCurr=scope.claim.form.isCurr.toString(),scope.claim.form.Isenable=scope.claim.form.Isenable.toString(),delete scope.claim.form.Creation_date},function(error){})};scope.claim={errors:[],load:function(){load()},form:angular.copy(form),errors:[],save:function(){save()}},scope.insurer={load:function(){loadInsurer()},name:""},scope.claim.load(),scope.insurer.load()}}}),angular.module("app.loggedIn.claim.controllers.patientList",[]).controller("ClaimPatientListController",function($scope,$modal,$stateParams,toastr){var add=function(){$modal.open({templateUrl:"dialogClaimAdd",controller:"ClaimPatientAddDialog",size:"md",resolve:{patientId:function(){return $stateParams.patient_id},calId:function(){return $stateParams.cal_id}}}).result.then(function(response){"success"===response&&(toastr.success("Added Successfully"),$scope.claim.reload=!0)})};$scope.claim={dialog:{add:function(){add(),$scope.claim.reload=!1}},reload:!1,limit:20,Patient_id:$stateParams.patient_id,CAL_ID:$stateParams.cal_id}}).controller("ClaimPatientAddDialog",function($scope,$modalInstance,patientId,calId){$scope.patientId=patientId,$scope.calId=calId,$scope.success=!1,$scope.$watch("success",function(success){success&&$modalInstance.close("success")})}),angular.module("app.loggedIn.company",["app.loggedIn.company.include"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.company",{url:"/company",views:{"main-content@loggedIn.patient":{templateUrl:"modules/company/views/list.html",controller:"CompanyListController"}}}).state("loggedIn.patient.company.add",{url:"/add",views:{"@loggedIn":{templateUrl:"modules/company/views/add.html",controller:"CompanyAddController"}}}).state("loggedIn.patient.company.addCompanyNotFollow",{url:"/addCompany",views:{"@loggedIn":{templateUrl:"modules/company/views/addCompanyNotFollow.html"}}}).state("loggedIn.patient.company.addParent",{url:"/addParent",views:{"@loggedIn":{templateUrl:"modules/company/dialogs/addParent.html",controller:"CompanyAddParentDialgosController"}}}).state("loggedIn.patient.company.addInsurer",{url:"/addParent",views:{"@loggedIn":{templateUrl:"modules/company/dialogs/addInsurer.html",controller:"CompanyInsurerDialgosController"}}}).state("loggedIn.patient.company.listParent",{url:"/listParent",views:{"@loggedIn":{templateUrl:"modules/company/views/listParent.html",controller:"CompanyListParentController"}}}).state("loggedIn.patient.company.listInsurer",{url:"/listInsurer",views:{"@loggedIn":{templateUrl:"modules/company/views/listInsurer.html",controller:"CompanylistInsurerController"}}}).state("loggedIn.patient.company.edit",{url:"/:companyId/edit",views:{"@loggedIn":{templateUrl:"modules/company/views/edit.html",controller:"CompanyEditController"}}})}),angular.module("app.loggedIn.company.include",["app.loggedIn.company.directives.list","app.loggedIn.company.controllers.list","app.loggedIn.company.models","app.loggedIn.company.controllers.add","app.loggedIn.company.directives.add","app.loggedIn.company.controllers.edit","app.loggedIn.company.directives.edit","app.loggedIn.company.controllers.listParent","app.loggedIn.company.directives.listParent","app.loggedIn.company.controllers.listInsurer","app.loggedIn.company.directives.listInsurer","app.loggedIn.company.dialog.addParent","app.loggedIn.company.dialog.addInusrer","app.loggedIn.company.dialog.remove","app.loggedIn.company.services","app.loggedIn.company.directives.listNotFollow","app.loggedIn.company.controllers.listNotFollow","app.loggedIn.company.dialog.listNoFollow","app.loggedIn.company.directives.addCompanyNotFollow","app.loggedIn.company.dialog.addNewInusrer"]),angular.module("app.loggedIn.company.models",[]).factory("CompanyModel",function(Restangular){var instanceService={},mainApi=Restangular.all("api/meditek/v1/company");return instanceService.detail=function(data){var instanceApi=mainApi.all("detail");return instanceApi.post({data:data})},instanceService.list=function(data){var instanceApi=mainApi.all("list");return instanceApi.post({data:data})},instanceService.add=function(data){var instanceApi=mainApi.all("add");return instanceApi.post({data:data})},instanceService.addCompanyNotFollow=function(data){var instanceApi=mainApi.all("addCompanyNotFollow");return instanceApi.post({data:data})},instanceService.insertPatientCompanies=function(company_id,patient_id){var instanceApi=mainApi.all("insertPatientCompanies");return instanceApi.post({
company_id:company_id,patient_id:patient_id})},instanceService.listParent=function(data){var instanceApi=mainApi.all("listParent");return instanceApi.post({data:data})},instanceService.byCompanyId=function(data){var instanceApi=mainApi.all("byCompanyId");return instanceApi.post({data:data})},instanceService.listInsurer=function(data){var instanceApi=mainApi.all("listInsurer");return instanceApi.post({data:data})},instanceService.edit=function(data){var instanceApi=mainApi.all("edit");return instanceApi.post({data:data})},instanceService.remove=function(data){var instanceApi=mainApi.all("remove");return instanceApi.post({data:data})},instanceService.removeInsurer=function(data){var instanceApi=mainApi.all("removeInsurer");return instanceApi.post({data:data})},instanceService.upCompanyPatient=function(data){var instanceApi=mainApi.all("upCompanyPatient");return instanceApi.post({data:data})},instanceService.disableInsurer=function(data){var instanceApi=mainApi.all("disableInsurer");return instanceApi.post({data:data})},instanceService.disableCompany=function(data){var instanceApi=mainApi.all("disableCompany");return instanceApi.post({data:data})},instanceService.updateInsurer=function(data){var instanceApi=mainApi.all("updateInsurer");return instanceApi.post({data:data})},instanceService.listNotFollow=function(data){var instanceApi=mainApi.all("listNotFollow");return instanceApi.post({data:data})},instanceService.AddlistNotFollow=function(data){var instanceApi=mainApi.all("AddlistNotFollow");return instanceApi.post({data:data})},instanceService.selectInsurer=function(data){var instanceApi=mainApi.all("selectInsurer");return instanceApi.post({data:data})},instanceService.getFromTime=function(data){var instanceApi=mainApi.all("getFromTime");return instanceApi.post({data:data})},instanceService}),angular.module("app.loggedIn.company.services",[]).factory("CompanyService",function(Restangular){var companyService={},companyApi=Restangular.all("api/erm"),mdtApi=Restangular.all("api/meditek/v1/company/"),restApi=Restangular.all("api/restful/Company");return companyService.mdtSearch=function(options){var funcApi=mdtApi.all("search");return funcApi.post(options)},companyService.mdtById=function(company_id){var funcApi=mdtApi.all("byId");return funcApi.post({company_id:company_id})},companyService.detail=function(id){var instanceApi=companyApi.one("v2/companies/detail");return instanceApi.get({id:id})},companyService.insert=function(data){var instanceApi=companyApi.all("v2/companies/insert");return instanceApi.post({data:data})},companyService.update=function(id,data){var instanceApi=companyApi.all("v2/companies/update");return instanceApi.post({id:id,data:data})},companyService["delete"]=function(id){var instanceApi=companyApi.all("v2/companies/delete");return instanceApi.post({id:id})},companyService.get=function(id){return restApi.one(""+id).get()},companyService}),angular.module("app.loggedIn.company.directives.list",[]).directive("listCompany",function(CompanyModel,$filter,$state,$stateParams,$modal,toastr){return{restrict:"EA",templateUrl:"modules/company/directives/templates/list.html",scope:{options:"=",limit:"@",onRowClick:"&",actionCenter:"="},link:function(scope,elem,attrs){var search={page:1,offset:0,limit:parseInt(scope.limit),company_id:$stateParams.companyId,patient_id:$stateParams.patient_id,Company_name:"",Industry:"",Addr:"",from_date:"",to_date:""};scope.onRowClick=function(row){scope.updateCompany.id=row.id,scope.updateCompany.to_date=null,scope.updateCompany.patient_id=$stateParams.patient_id;var postData=angular.copy(scope.updateCompany);CompanyModel.upCompanyPatient(postData).then(function(response){toastr.success("Change Company Active Successfully"),scope.company.load(),scope.actionCenter.runWhenFinish()},function(error){scope.company.errors=angular.copy(error.data.errors)})};var remove=function(row){$modal.open({templateUrl:"modules/company/dialogs/templates/remove.html",controller:"CompanyRemoveDialog",size:"sm",resolve:{row:function(){return row}}}).result.then(function(row){CompanyModel.remove(row).then(function(response){toastr.success("Delete Successfully"),scope.company.load()},function(error){})})};scope.clickEdit=function(row){$state.go("loggedIn.patient.company.edit",{companyId:row.id})};var load=function(){scope.company.loading=!0,CompanyModel.list(search).then(function(response){scope.company.loading=!1,scope.company.error="",scope.company.list=response.data,scope.company.count=response.count,scope.company.search.page=1,scope.company.company_idActive=response.data1[0].company_id},function(error){scope.company.loading=!1,scope.company.error=$filter("translate")(error.data.code)})};scope.addClick=function(){$state.go("loggedIn.patient.company.add")},scope.addNewCompany=function(){$modal.open({templateUrl:"modules/company/views/add.html",controller:"CompanyAddController",size:"lg",resolve:{insurerArray:function(){return scope.company.listTemp}}}).result.then(function(row){scope.company.load()})};var onSearch=function(option){switch(option.field){case"Company_name":scope.company.search.Company_name=option.value;break;case"Industry":scope.company.search.Industry=option.value;break;case"Addr":scope.company.search.Addr=option.value;break;case"country":scope.company.search.country=option.value}scope.company.load(),loadPage(1)},loadPage=function(page){scope.company.search.offset=(page-1)*scope.company.search.limit,scope.company.load()};scope.disableCompany=function(row){var postData={patient_id:$stateParams.patient_id,company_id:row.id,isEnable:row.checkisEnable};CompanyModel.disableCompany(postData).then(function(response){scope.company.load()},function(error){})},scope.SelectCompany=function(){$modal.open({templateUrl:"modules/company/dialogs/templates/listNotFollowPatient.html",controller:"CompanyListNoFollowDialog",size:"",resolve:{listId:function(){return scope.company.list}}}).result.then(function(row){var postData={patient_id:$stateParams.patient_id,company_id:row.id};CompanyModel.AddlistNotFollow(postData).then(function(response){scope.company.load()})})},scope.company={search:search,error:"",count:0,loading:!1,list:[],company_idActive:"",load:function(){load()},loadPage:function(page){loadPage(page)},onSearch:function(option){onSearch(option)},remove:function(size){remove(size)}},scope.updateCompany={id:"",patient_id:""},scope.company.load()}}}),angular.module("app.loggedIn.company.controllers.list",[]).controller("CompanyListController",function($scope,$state){$scope.actionCenter={runWhenFinish:function(){$scope.getPatientInfo()}}}),angular.module("app.loggedIn.company.directives.listParent",[]).directive("listParent",function(CompanyModel,$filter,$state){return{restrict:"EA",templateUrl:"modules/company/directives/templates/listParent.html",scope:{options:"=",limit:"@",onRowClick:"&",companyId:"="},link:function(scope,elem,attrs){var setPage=function(page){scope.company.search.offset=(page-1)*scope.company.search.limit,scope.company.load()},search={page:1,offset:0,limit:7,max_size:5,Company_name:"",Company_id:scope.companyId,Industry:"",Addr:"",country:""},load=function(){scope.company.loading=!0,CompanyModel.listParent(search).then(function(response){scope.company.loading=!1,scope.company.error="",scope.company.list=response.data,scope.company.count=response.count},function(error){scope.company.loading=!1,scope.company.error=$filter("translate")(error.data.code)})};scope.addClick=function(){$state.go("loggedIn.patient.company.add")};var onSearch=function(option){switch(option.field){case"Company_name":scope.company.search.Company_name=option.value;break;case"Industry":scope.company.search.Industry=option.value;break;case"Addr":scope.company.search.Addr=option.value}scope.company.load(),setPage(1)};scope.company={search:search,error:"",count:0,loading:!1,list:[],load:function(){load()},setPage:function(page){setPage(page)},onSearch:function(option){onSearch(option)}},scope.company.load()}}}),angular.module("app.loggedIn.company.controllers.listParent",[]).controller("CompanyListParentController",function($scope,$state){}),angular.module("app.loggedIn.company.directives.listInsurer",[]).directive("listInsurer",function(CompanyModel,$filter,$state,$modal,toastr){return{restrict:"EA",templateUrl:"modules/company/directives/templates/listInsurer.html",scope:{options:"=",limit:"@",onRowClick:"&",insurerArray:"=",responsedata:"="},link:function(scope,elem,attrs){var setPage=function(page){scope.company.search.offset=(page-1)*scope.company.search.limit,scope.company.load()},search={page:1,offset:0,limit:7,max_size:5,Company_name:"",insurerArray:scope.insurerArray,insurer_name:"",address:""},load=function(){scope.company.loading=!0,CompanyModel.listInsurer(search).then(function(response){scope.company.loading=!1,scope.company.error="",scope.company.list=response.data,scope.company.count=response.count},function(error){scope.company.loading=!1,scope.company.error=$filter("translate")(error.data.code)})},onSearch=function(option){switch(option.field){case"insurer_name":scope.company.search.insurer_name=option.value;break;case"address":scope.company.search.address=option.value}scope.company.load(),setPage(1)};scope.addNewInsurer=function(){$modal.open({templateUrl:"modules/company/dialogs/templates/addNewInsurer.html",controller:"CompanyAddNewInsurerDialgosController",size:""}).result.then(function(response){"success"===response.status&&CompanyModel.selectInsurer(response.data.insertId).then(function(response){scope.responsedata=response.data[0]})})},scope.company={search:search,error:"",count:0,loading:!1,list:[],load:function(){load()},setPage:function(page){setPage(page)},onSearch:function(option){onSearch(option)}},scope.company.load()}}}),angular.module("app.loggedIn.company.controllers.listInsurer",[]).controller("CompanylistInsurerController",function($scope,$state){}),angular.module("app.loggedIn.company.directives.addCompanyNotFollow",[]).directive("addCompanyNotFollow",function(CompanyModel,$filter,$state,$modal,$stateParams,toastr,$cookieStore,ConfigService,$q){return{restrict:"EA",templateUrl:"modules/company/directives/templates/add.html",scope:{options:"=",onRowClick:"&",success:"=",actionCenter:"="},link:function(scope,elem,attrs){var actionCenter=scope.actionCenter,form={Company_name:null,Industry:null,Addr:null,postcode:null,State:null,Description:null,latitude:null,longitude:null,country:null,result_email:null,invoice_email:null,PO_number:null,isProject:null,isCalendar:null,father_id:null,report_to_email:null,default_status:null,isInvoiceEmailToUser:null,isAddContactEmailToResult:null,IMA:null,Site_name:null,Medic_contact_no:null,Email:null,CODE:null,Insurer:null,Phone:null,Site_medic:null,User_id:$cookieStore.get("userInfo").id,isPO:null,isExtra:null,parent_id:null,listInsurerid:[]};scope.onRowClick=function(row){var postData={Insurer:row.id,id:$stateParams.companyId};scope.company.InsurerTemp=row.id,scope.company.checkColor=row.id,CompanyModel.updateInsurer(postData).then(function(response){toastr.success("Active Insurer Successfully")},function(error){})},scope.clickDisable=function(row){for(var i=0;i<=scope.company.listTemp.length;i++)scope.company.listTemp[i]==row.id&&(scope.company.listTemp.splice(i,1),scope.company.listInsurer.splice(i,1))};var remove=function(row){$modal.open({templateUrl:"modules/company/dialogs/templates/remove.html",controller:"CompanyRemoveDialog",size:"sm",resolve:{row:function(){return row}}}).result.then(function(row){CompanyModel.removeInsurer(row).then(function(response){toastr.success("Delete Successfully")},function(error){})})},addCompany=function(size){$modal.open({templateUrl:"modules/company/dialogs/templates/addParent.html",controller:"CompanyAddParentDialgosController",size:"",resolve:{companyId:function(){return-1}}}).result.then(function(row){scope.company.Company_name_Parent=row.Company_name,scope.company.form.parent_id=row.id,scope.company.form.father_id=row.id})},addInsurer=function(size){$modal.open({templateUrl:"modules/company/dialogs/templates/addInsurer.html",controller:"CompanyInsurerDialgosController",size:"",resolve:{insurerArray:function(){return scope.company.listTemp}}}).result.then(function(row){for(var flag=0,i=0;i<=scope.company.listTemp.length;i++)scope.company.listTemp[i]==row.id&&(flag+=1);0>=flag&&(scope.company.listTemp.push(row.id),scope.company.listInsurer.push(row));var postData={Insurer:row.id,id:$stateParams.companyId};scope.company.InsurerTemp=row.id,scope.company.checkColor=row.id,CompanyModel.updateInsurer(postData).then(function(response){},function(error){})})},save=function(){ConfigService.beforeSave(scope.company.errors);var postData=angular.copy(scope.company.form);postData.Insurer=""===scope.company.InsurerTemp?null:scope.company.InsurerTemp,postData.listInsurerid=scope.company.listTemp,CompanyModel.addCompanyNotFollow(postData).then(function(response){toastr.success("Add Company Successfully"),actionCenter.saveModal(postData.Company_name,response.data[0].id)},function(error){scope.company.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.company.errors)})};scope.company={form:form,listInsurer:[],listTemp:[],errors:[],Company_name_Parent:"",InsurerTemp:"",checkColor:"",save:function(){save()},addCompany:function(){addCompany()},addInsurer:function(){addInsurer()},remove:function(row){remove(row)}},scope.cancel=function(){actionCenter.closeModal()}}}}),angular.module("app.loggedIn.company.directives.add",[]).directive("addCompany",function(CompanyModel,$filter,$state,$modal,$stateParams,toastr,$cookieStore,ConfigService){return{restrict:"EA",templateUrl:"modules/company/directives/templates/add.html",scope:{options:"=",onRowClick:"&",actionCenter:"="},link:function(scope,elem,attrs){var parent=document.getElementsByClassName("un_tn_modal_remove_background")[0].parentNode;parent.style.background="none",console.log(parent.style.background);var form={Company_name:null,Industry:null,Addr:null,postcode:null,State:null,Description:null,latitude:null,longitude:null,country:null,result_email:null,invoice_email:null,PO_number:null,isProject:null,isCalendar:null,father_id:null,report_to_email:null,default_status:null,isInvoiceEmailToUser:null,isAddContactEmailToResult:null,IMA:null,Site_name:null,Medic_contact_no:null,Email:null,CODE:null,Insurer:null,Phone:null,Site_medic:[],User_id:$cookieStore.get("userInfo").id,isPO:null,isExtra:null,parent_id:null,listInsurerid:[],from_date:null,to_date:null,patient_id:$stateParams.patient_id,suburb:null};scope.onRowClick=function(row){var postData={Insurer:row.id,id:$stateParams.companyId};scope.company.InsurerTemp=row.id,scope.company.checkColor=row.id,CompanyModel.updateInsurer(postData).then(function(response){toastr.success("Active Insurer Successfully")},function(error){})},scope.clickDisable=function(row){for(var i=0;i<=scope.company.listTemp.length;i++)scope.company.listTemp[i]==row.id&&(scope.company.listTemp.splice(i,1),scope.company.listInsurer.splice(i,1))};var remove=function(row){$modal.open({templateUrl:"modules/company/dialogs/templates/remove.html",controller:"CompanyRemoveDialog",size:"sm",resolve:{row:function(){return row}}}).result.then(function(row){CompanyModel.removeInsurer(row).then(function(response){toastr.success("Delete Successfully")},function(error){})})},addCompany=function(size){$modal.open({templateUrl:"modules/company/dialogs/templates/addParent.html",controller:"CompanyAddParentDialgosController",size:"",resolve:{companyId:function(){return-1}}}).result.then(function(row){scope.company.Company_name_Parent=row.Company_name,scope.company.form.parent_id=row.id,scope.company.form.father_id=row.id})},addInsurer=function(size){$modal.open({templateUrl:"modules/company/dialogs/templates/addInsurer.html",controller:"CompanyInsurerDialgosController",size:"",resolve:{insurerArray:function(){return scope.company.listTemp}}}).result.then(function(row){for(var flag=0,i=0;i<=scope.company.listTemp.length;i++)scope.company.listTemp[i]==row.id&&(flag+=1);0>=flag&&(scope.company.listTemp.push(row.id),scope.company.listInsurer.push(row))})},save=function(){ConfigService.beforeSave(scope.company.errors),_.forEach(form.Site_medic,function(n){delete n.$$hashKey}),scope.company.form.Site_medic=form.Site_medic;var postData=angular.copy(scope.company.form);postData.Insurer=""===scope.company.InsurerTemp?null:scope.company.InsurerTemp,postData.listInsurerid=scope.company.listTemp,postData.from_date&&(postData.from_date=ConfigService.convertToDB(postData.from_date)),postData.to_date&&(postData.to_date=ConfigService.convertToDB(postData.to_date)),CompanyModel.add(postData).then(function(response){toastr.success("Add Company Successfully"),scope.actionCenter.closeModal()},function(error){scope.company.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.company.errors)})},showListCompanyRep=function(){$modal.open({templateUrl:"modules/company/dialogs/templates/listCompanyRep.html",controller:function($scope,$modalInstance){$scope.list=form.Site_medic,$scope.onRowClick=function(data){swal({title:"Confirm Delete",text:"Are You Sure Want To Delete This Company Rep?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){form.Site_medic.splice(data,1)})},$scope.addlist=function(){$modal.open({templateUrl:"modules/company/dialogs/templates/companyRep.html",controller:function($scope,$modalInstance,toastr){$scope.formAdd=!0,$scope.close=function(){$modalInstance.dismiss("cancel")},$scope.submitItem=function(){form.Site_medic.push({name:$scope.listInfo.name}),console.log(form.Site_medic),toastr.success("Add Company Rep Successfully"),$scope.close()}},size:"sm"})},$scope.editItem=function(name,index){var name=name,index=index;$modal.open({templateUrl:"modules/company/dialogs/templates/companyRep.html",controller:function($scope,$modalInstance){$scope.formAdd=!1,$scope.listInfo={name:name},$scope.close=function(){$modalInstance.dismiss("cancel")},$scope.saveItem=function(){form.Site_medic[index].name=$scope.listInfo.name,console.log(form.Site_medic),toastr.success("Edit Company Rep Successfully"),$scope.close()}},size:"sm"})},$scope.close=function(){$modalInstance.dismiss("cancel")}},size:"md"})};scope.company={form:form,listInsurer:[],listTemp:[],errors:[],Company_name_Parent:"",InsurerTemp:"",checkColor:"",save:function(){save()},addCompany:function(){addCompany()},addInsurer:function(){addInsurer()},remove:function(row){remove(row)},showListCompanyRep:function(){showListCompanyRep()}},scope.cancel=function(){scope.actionCenter.closeModal()}}}}),angular.module("app.loggedIn.company.controllers.add",[]).controller("CompanyAddController",function($scope,$state,$modalInstance){$scope.actionCenter={closeModal:function(){$modalInstance.close("success")}}}),angular.module("app.loggedIn.company.directives.edit",[]).directive("editCompany",function($filter,$state,$stateParams,CompanyModel,$modal,toastr,$cookieStore,ConfigService){return{restrict:"EA",templateUrl:"modules/company/directives/templates/edit.html",scope:{options:"="},link:function(scope,elem,attrs){var form={id:$stateParams.companyId,patient_id:$stateParams.patient_id,Company_name:null,Industry:null,Addr:null,postcode:null,State:null,Description:null,latitude:null,longitude:null,country:null,result_email:null,invoice_email:null,PO_number:null,isProject:null,isCalendar:null,father_id:null,report_to_email:null,default_status:null,isInvoiceEmailToUser:null,isAddContactEmailToResult:null,IMA:null,Site_name:null,Medic_contact_no:null,Email:null,CODE:null,Insurer:null,Phone:null,User_id:null,isPO:null,isExtra:null,parent_id:null,listInsurerid:[],from_date:null,to_date:null,suburb:null},load=function(row){scope.company.loading=!0,CompanyModel.byCompanyId(form).then(function(response){scope.company.loading=!1,scope.company.error="",scope.company.form=response.data[0],scope.company.form.User_id=$cookieStore.get("userInfo").id,scope.company.listInsurer=response.data1,scope.company.checkColor=scope.company.form.Insurer,_.forEach(scope.company.listInsurer,function(id){scope.company.listTemp.push(id.id)}),scope.company.Company_name_Parent=response.data2[0].Company_name,scope.company.form.from_date=ConfigService.convertToDate(scope.company.form.from_date),scope.company.form.to_date=ConfigService.convertToDate(scope.company.form.to_date),console.log(response.data[0].Site_medic),form.Site_medic=null==response.data[0].Site_medic||void 0==response.data[0].Site_medic||""==response.data[0].Site_medic?[]:JSON.parse(response.data[0].Site_medic),console.log(form.Site_medic)},function(error){scope.company.loading=!1,scope.company.error=$filter("translate")(error.data.code)})};scope.onRowClick=function(row){var postData={Insurer:row.id,id:$stateParams.companyId};scope.company.InsurerTemp=row.id,scope.company.checkColor=row.id,CompanyModel.updateInsurer(postData).then(function(response){toastr.success("Active Insurer Successfully")},function(error){})},scope.disableInsurer=function(row){var postData={company_id:$stateParams.companyId,insurer_id:row.id,isEnable:row.checkisEnable};CompanyModel.disableInsurer(postData).then(function(response){},function(error){});for(var i=0;i<=scope.company.listTemp.length;i++)scope.company.listTemp[i]==row.id&&(scope.company.listInsurer[i].checkisEnable=0==scope.company.listInsurer[i].checkisEnable?1:0)};var remove=function(row){$modal.open({templateUrl:"modules/company/dialogs/templates/remove.html",controller:"CompanyRemoveDialog",size:"sm",resolve:{row:function(){return row}}}).result.then(function(row){CompanyModel.removeInsurer(row).then(function(response){for(var i=0;i<=scope.company.listTemp.length;i++)scope.company.listTemp[i]==row.id&&(scope.company.listTemp.splice(i,1),scope.company.listInsurer.splice(i,1));toastr.success("Delete Successfully")},function(error){})})},save=function(){ConfigService.beforeSave(scope.company.errors),scope.company.form.patient_id=$stateParams.patient_id,_.forEach(form.Site_medic,function(n){delete n.$$hashKey}),scope.company.form.Site_medic=form.Site_medic;var postData=angular.copy(scope.company.form);console.log("chiennn",postData),postData.from_date&&(postData.from_date=ConfigService.convertToDB(postData.from_date)),postData.to_date&&(postData.to_date=ConfigService.convertToDB(postData.to_date)),postData.listInsurerid=scope.company.listInsurer,CompanyModel.edit(postData).then(function(response){toastr.success("Edit Company Successfully"),$state.go("loggedIn.patient.company")},function(error){scope.company.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.company.errors)})},addCompany=function(size){$modal.open({templateUrl:"modules/company/dialogs/templates/addParent.html",controller:"CompanyAddParentDialgosController",size:"",resolve:{companyId:function(){return $stateParams.companyId}}}).result.then(function(row){scope.company.Company_name_Parent=row.Company_name,scope.company.form.parent_id=row.id,scope.company.form.father_id=row.id})},addInsurer=function(size){$modal.open({templateUrl:"modules/company/dialogs/templates/addInsurer.html",controller:"CompanyInsurerDialgosController",size:"",resolve:{insurerArray:function(){return scope.company.listTemp}}}).result.then(function(row){row.checkisEnable=1;for(var flag=0,i=0;i<=scope.company.listTemp.length;i++)scope.company.listTemp[i]==row.id&&(flag+=1);0>=flag&&(scope.company.listTemp.push(row.id),scope.company.listInsurer.push(row))})},showListCompanyRep=function(){$modal.open({templateUrl:"modules/company/dialogs/templates/listCompanyRep.html",controller:function($scope,$modalInstance){$scope.list=form.Site_medic,$scope.onRowClick=function(data){swal({title:"Confirm Delete",text:"Are You Sure Want To Delete This Company Rep?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){form.Site_medic.splice(data,1)})},$scope.addlist=function(){$modal.open({templateUrl:"modules/company/dialogs/templates/companyRep.html",controller:function($scope,$modalInstance,toastr){$scope.formAdd=!0,$scope.close=function(){$modalInstance.dismiss("cancel")},$scope.submitItem=function(){form.Site_medic.push({name:$scope.listInfo.name}),console.log(form.Site_medic),toastr.success("Add Company Rep Successfully"),$scope.close()}},size:"sm"})},$scope.editItem=function(name,index){var name=name,index=index;$modal.open({templateUrl:"modules/company/dialogs/templates/companyRep.html",controller:function($scope,$modalInstance){$scope.formAdd=!1,$scope.listInfo={name:name},$scope.close=function(){$modalInstance.dismiss("cancel")},$scope.saveItem=function(){form.Site_medic[index].name=$scope.listInfo.name,console.log(form.Site_medic),toastr.success("Edit Company Rep Successfully"),$scope.close()}},size:"sm"})},$scope.close=function(){$modalInstance.dismiss("cancel")}},size:"md"})};scope.company={form:form,error:"",loading:!1,load:function(){load()},save:function(){save()},listInsurer:[],checkColor:"",listTemp:[],Company_name_Parent:"",save:function(){save()},addCompany:function(){addCompany()},addInsurer:function(){addInsurer()},remove:function(row){remove(row)},showListCompanyRep:function(){showListCompanyRep()}},scope.cancel=function(){$state.go("loggedIn.patient.company")},scope.company.load()}}}),angular.module("app.loggedIn.company.controllers.edit",[]).controller("CompanyEditController",function($scope,$state){}),angular.module("app.loggedIn.company.directives.listNotFollow",[]).directive("listCompanyNotfollow",function(CompanyModel,$filter,$state,$stateParams){return{restrict:"EA",templateUrl:"modules/company/directives/templates/listNotFollowPatient.html",scope:{options:"=",limit:"@",onRowClick:"&",listId:"=",actionCenter:"="},link:function(scope,elem,attrs){var setPage=function(page){scope.company.search.offset=(page-1)*scope.company.search.limit,scope.company.load()},search={page:1,offset:0,limit:7,max_size:5,Company_name:"",Industry:"",Addr:"",country:"",listId:scope.listId},load=function(){scope.company.loading=!0,CompanyModel.listNotFollow(search).then(function(response){scope.company.loading=!1,scope.company.error="",scope.company.list=response.data,scope.company.count=response.count},function(error){scope.company.loading=!1,scope.company.error=$filter("translate")(error.data.code)})},onSearch=function(option){switch(option.field){case"Company_name":scope.company.search.Company_name=option.value;break;case"Industry":scope.company.search.Industry=option.value;break;case"Addr":scope.company.search.Addr=option.value;break;case"country":scope.company.search.country=option.value}scope.company.load(),setPage(1)};scope.company={search:search,error:"",count:0,loading:!1,list:[],load:function(){load()},setPage:function(page){setPage(page)},onSearch:function(option){onSearch(option)}},scope.company.load()}}}),angular.module("app.loggedIn.company.controllers.listNotFollow",[]).controller("CompanyListNotFollowController",function($scope,$state){}),angular.module("app.loggedIn.company.dialog.addParent",[]).controller("CompanyAddParentDialgosController",function($scope,CompanyModel,$modalInstance,companyId){$scope.companyId=companyId,$scope.clickRow=function(row){$modalInstance.close(row)},$scope.ok=function(){$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")}}),angular.module("app.loggedIn.company.dialog.addNewInusrer",[]).controller("CompanyAddNewInsurerDialgosController",function($scope,CompanyModel,$modalInstance){$scope.responsedata=null,$scope.success=!1,$scope.$watch("success",function(success){success&&$scope.$watch("responsedata",function(success){$modalInstance.close($scope.responsedata)})}),$scope.cancel=function(){$modalInstance.dismiss("cancel")}}),angular.module("app.loggedIn.company.dialog.addInusrer",[]).controller("CompanyInsurerDialgosController",function($scope,CompanyModel,$modalInstance,insurerArray){$scope.insurerArray=insurerArray,$scope.responsedata=null,$scope.$watch("responsedata",function(success){success&&$modalInstance.close($scope.responsedata)}),$scope.clickRow=function(row){$modalInstance.close(row)},$scope.ok=function(){$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")}}),angular.module("app.loggedIn.company.dialog.listNoFollow",[]).controller("CompanyListNoFollowDialog",function($scope,CompanyModel,$modalInstance,listId){$scope.listId=listId,$scope.clickRow=function(row){$modalInstance.close(row)},$scope.ok=function(){$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")}}),angular.module("app.loggedIn.company.dialog.remove",[]).controller("CompanyRemoveDialog",function($scope,$modalInstance,row){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.ok=function(){$modalInstance.close(row)}}),angular.module("app.loggedIn.patient.exercise.directives.list",[]).controller("ExerciseDialog",function($scope,$modalInstance,list){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.ok=function(){$modalInstance.close(list)}}).controller("ExerciseAddDialog",function($scope,$modalInstance){$scope.exercise={success:!1},$scope.$watch("exercise.success",function(success){success&&$modalInstance.close("success")})}).controller("ExerciseEditDialog",function($scope,$modalInstance,list){$scope.exercise={id:list.Exercise_id,success:!1},$scope.$watch("exercise.success",function(success){success&&$modalInstance.close("success")})}).directive("listExercise",function($modal,ConsultationService,toastr,$stateParams){return{restrict:"EA",scope:{limit:"=",reload:"="},templateUrl:"modules/consultation/directives/templates/exercise/listExercise.html",link:function(scope,elem,attrs){var search={page:1,limit:scope.limit,offset:0,max_size:5,patient_id:$stateParams.patient_id,cal_id:$stateParams.cal_id},load=function(){var postData=angular.copy(scope.exercise.search);ConsultationService.listExercise(postData).then(function(response){scope.exercise.list=response.data,scope.exercise.count=response.count},function(error){})};scope.add=function(list){$modal.open({templateUrl:"dialogExerciseAdd",controller:"ExerciseAddDialog"}).result.then(function(list){scope.exercise.load(),toastr.success("Add Successfully")})},scope.edit=function(list){$modal.open({templateUrl:"dialogExerciseEdit",controller:"ExerciseEditDialog",resolve:{list:function(){return list}}}).result.then(function(list){scope.exercise.load(),toastr.success("Edit Successfully")})},scope["delete"]=function(list){$modal.open({templateUrl:"dialogExerciseRemove",controller:"ExerciseDialog",resolve:{list:function(){return list}}}).result.then(function(list){ConsultationService.deleteExercise(list).then(function(response){toastr.success("Delete Successfully"),scope.exercise.load()},function(error){})})};var onSearch=function(){scope.exercise.search.offset=0,scope.exercise.load(),scope.exercise.search.page=1},onPage=function(page){scope.exercise.search.offset=(page-1)*scope.exercise.search.limit,scope.exercise.load()};scope.exercise={search:angular.copy(search),load:function(){load()},list:[],onSearch:function(){onSearch()},onPage:function(page){onPage(page)}},scope.exercise.load()}}}).directive("addExercise",function($cookieStore,ConsultationService,ConfigService,$stateParams){return{restrict:"EA",scope:{success:"="},templateUrl:"modules/consultation/directives/templates/exercise/addExercise.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,form={exercise:"",lastest_weight:"",sets:"",reps:"",other:"",Created_by:user_id,Last_updated_by:user_id,patient_id:$stateParams.patient_id,cal_id:$stateParams.cal_id},save=function(){ConfigService.beforeSave(scope.exercise.errors);var postData=angular.copy(scope.exercise.form);postData.Last_update_date=moment().format("YYYY-MM-DD"),ConsultationService.addExercise(postData).then(function(response){scope.success=!0},function(error){scope.exercise.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.exercise.errors);
})},load=function(){};scope.exercise={form:angular.copy(form),load:function(){load()},errors:[],save:function(){save()}},scope.exercise.load()}}}).directive("editExercise",function($cookieStore,ConsultationService,ConfigService,$stateParams){return{restrict:"EA",scope:{success:"=",exerciseId:"="},templateUrl:"modules/consultation/directives/templates/exercise/addExercise.html",link:function(scope,elem,attrs){var form=($cookieStore.get("userInfo").id,{exercise:"",lastest_weight:"",sets:"",reps:"",other:"",patient_id:$stateParams.patient_id,cal_id:$stateParams.cal_id}),save=function(){ConfigService.beforeSave(scope.exercise.errors);var postData=angular.copy(scope.exercise.form);postData.Last_update_date=moment().format("YYYY-MM-DD"),ConsultationService.updateExercise(postData).then(function(response){scope.success=!0},function(error){scope.exercise.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.exercise.errors)})},load=function(){var postData={id:scope.exerciseId};ConsultationService.getOneExercise(postData).then(function(response){angular.extend(scope.exercise.form,response.data),delete scope.exercise.form.Creation_date},function(error){})};scope.exercise={form:angular.copy(form),load:function(){load()},errors:[],save:function(){save()}},scope.exercise.load()}}}),angular.module("app.loggedIn.patient.consult.directives",[]).directive("consultDrawing",function($window,Restangular,ConfigService,$timeout,toastr,socket){return{restrict:"E",scope:{patient:"=",calendar:"=",actionCenterDrawing:"=",consultid:"="},templateUrl:"modules/consultation/directives/templates/drawingConsult.html",link:function(scope,element,attrs){var lastX,lastY,canvas=element.context.querySelector("canvas"),imageLoader=element.context.querySelector("#imageLoader"),ctx=canvas.getContext("2d"),drawing=!1;scope.colors=[{color:"blue-ebonyclay"},{color:"green"},{color:"blue"},{color:"red"}],scope.color="black",scope.lineWidth=attrs.linewidth,scope.treeArr=[],canvas.width=attrs.width||element.width(),canvas.height=attrs.height||element.height(),Restangular.one("api/consultation/draw/templates").get().then(function(rs){if("success"==rs.status)for(var i=0;i<rs.data.length;i++){var node=rs.data[i];scope.treeArr.push({id:node.id,parent:null==node.parent?"#":node.parent,text:node.fileName,icon:1==node.isFolder?"fa fa-folder icon-state-warning":"fa fa-file icon-state-success"})}});var clearCanvas=function(){ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.restore()};scope.selectNodeCB=function(e){var idArr=String(e.target.id).split("_"),id=idArr[0];null!=id&&"undefined"!=typeof id&&""!=id&&Restangular.one("api/consultation/draw/template",id).get().then(function(rs){if("success"==rs.status){var img=new Image;img.onload=function(){ctx.drawImage(img,(canvas.width-img.width)/2,(canvas.height-img.height)/2)},img.src=rs.data}})},scope.changeColor=function(c){scope.color="blue-ebonyclay"==c?"black":c,scope.lineWidth=attrs.linewidth,scope.erasing=!1},scope.clear=function(){clearCanvas()},scope.erase=function(){scope.color=element.find("#myCanvas").css("background-color"),scope.lineWidth=50,scope.erasing=!0},scope.capture=function(){var imgData=canvas.toDataURL("image/png");Restangular.all("api/consultation/draw/saveImage").post({patient_id:scope.patient,cal_id:scope.calendar,imgData:imgData,consult_id:scope.consultid}).then(function(rs){"success"==rs.status?(toastr.success("Image Saved!"),scope.actionCenterDrawing&&scope.actionCenterDrawing.runWhenFinish&&scope.actionCenterDrawing.runWhenFinish()):toastr.error("Error!")})};var draw=function(lX,lY,cX,cY){ctx.lineCap="round",ctx.fillStyle="solid",ctx.strokeStyle=scope.color,ctx.lineWidth=scope.lineWidth,ctx.moveTo(lX,lY),ctx.lineTo(cX,cY),ctx.stroke()};angular.element(imageLoader).on("change",function(e){var reader=new FileReader;reader.onload=function(event){var img=new Image;img.onload=function(){ctx.drawImage(img,(canvas.width-img.width)/2,(canvas.height-img.height)/2)},img.src=event.target.result},reader.readAsDataURL(e.target.files[0])}),angular.element(canvas).on("mousedown mousemove mouseup mouseout touchstart touchmove touchend",function(event){if("mousemove"!==event.type||drawing)switch(event.preventDefault(),event.type){case"mousedown":case"touchstart":void 0!==event.offsetX?(lastX=event.offsetX,lastY=event.offsetY):(lastX=event.pageX-angular.element(canvas).offset().left,lastY=event.pageY-angular.element(canvas).offset().top),ctx.beginPath(),drawing=!0;break;case"mousemove":case"touchmove":drawing&&(void 0!==event.offsetX?(currentX=event.offsetX,currentY=event.offsetY):(currentX=event.pageX-angular.element(canvas).offset().left,currentY=event.pageY-angular.element(canvas).offset().top),draw(lastX,lastY,currentX,currentY),lastX=currentX,lastY=currentY);break;case"mouseup":case"touchend":case"mouseout":drawing=!1}})}}}).directive("consultationHistory",function(){return{restrict:"E",scope:{actionCenter:"="},templateUrl:"modules/consultation/directives/templates/consultation-history.html",controller:function($scope,ConsultationService){}}}),angular.module("app.loggedIn.patient.consult.services",[]).factory("ConsultationService",function(Restangular){var services={},api=Restangular.all("api"),info={};return services.listExercise=function(data){return api.all("consultation/listExercise").post({data:data})},services.addExercise=function(data){return api.all("consultation/addExercise").post({data:data})},services.getOneExercise=function(data){return api.all("consultation/getOneExercise").post({data:data})},services.updateExercise=function(data){return api.all("consultation/updateExercise").post({data:data})},services.deleteExercise=function(data){return api.all("consultation/deleteExercise").post({data:data})},services.getPatientProblem=function(patientId){return api.all("consultation/getPatientProblem").post({patient_id:patientId})},services.submitConsult=function(info){return api.all("consultation/submit").post({info:info})},services.submitMeasurements=function(info){return api.all("consultation/submit-measurements").post({info:info})},services.submitMedication=function(info){return api.all("consultation/submit-medication").post({info:info})},services.getPatientCompany=function(patientId){return api.all("consultation/patient/company").post({patient_id:patientId})},services.searchScript=function(info){return api.all("erm/v2/medicine/search").post({search:info})},services.getConsultInfo=function(){return info},services.setConsultInfo=function(consultInfo){info=angular.copy(consultInfo)},services.getListConsultOfPatient=function(patient_id){return api.all("consultation/listconsultofpatient").post({patient_id:patient_id})},services.beforeStartSession=function(postData){return api.all("consultation/beforeStartSession").post({postData:postData})},services.startSession=function(data){return api.all("consultation/startSession").post({data:data})},services.beforeFinishSession=function(data){return api.all("consultation/beforeFinishSession").post({data:data})},services.finishSession=function(data){return api.all("consultation/finishSession").post({data:data})},services.getApptPatient=function(data){return api.all("consultation/getApptPatient").post({data:data})},services.getByIdConsult=function(consult_id){return api.all("consultation/byidConsult").post({consult_id:consult_id})},services.checkConsultation=function(patient_id,cal_id){return api.all("consultation/check-consultation-patientID-calID").post({patient_id:patient_id,cal_id:cal_id})},services.getListMeasurements=function(patient_id){return api.all("consultation/list-measurements").post({patient_id:patient_id})},services.getListMedication=function(patient_id){return api.all("consultation/list-medication").post({patient_id:patient_id})},services.getListMeasurementsOfConsualt=function(patient_id,cal_id){return api.all("consultation/list-measurements-of-consualt").post({patient_id:patient_id,cal_id:cal_id})},services.getListMedicationOfConsualt=function(patient_id,cal_id){return api.all("consultation/list-medication-of-consualt").post({patient_id:patient_id,cal_id:cal_id})},services.setIsEnableMeasurements=function(measure_id,isEnable){return api.all("consultation/set-isenable-measurements").post({measure_id:measure_id,isEnable:isEnable})},services.setIsEnableMedication=function(id,isEnable){return api.all("consultation/set-isenable-medication").post({id:id,isEnable:isEnable})},services.getImgDrawingHistory=function(patient_id,cal_id){return api.all("consultation/get-img-drawing-history").post({patient_id:patient_id,cal_id:cal_id})},services.getDocumentFileOfPatientidAndCalid=function(patient_id,cal_id){return api.all("consultation/document-file-of-patientId-and-calId").post({patient_id:patient_id,cal_id:cal_id})},services.getListCor=function(data){return api.all("consultation/listCor").post({data:data})},services.postAddCor=function(data){return api.all("consultation/addCor").post({data:data})},services.postByIdCor=function(data){return api.all("consultation/byidCor").post({data:data})},services}),angular.module("app.loggedIn.patient.consult.itemsheetController",[]).controller("PatientConsultItemsheetController",function($filter,$cookieStore,$scope,$state,$modal,toastr,$stateParams,ConsultationService,PatientService,ReceptionistService,InvoiceService){alert("Controller PatientConsultItemsheetController khong con duoc du dung");var arrGetBy=$filter("arrGetBy");$scope.appointment={CAL_ID:$stateParams.cal_id,Patient_id:$stateParams.patient_id},$scope.items_search_panel={},$scope.deptItems=null,$scope.apptItems=[],$scope.extraItems=[],$scope.backClick=function(){$state.go("loggedIn.consult.patient",{patient_id:$stateParams.patient_id,cal_id:$stateParams.cal_id})};var isInDeptItems=function(item_id){for(var i=0,len=$scope.deptItems.length;len>i;++i)for(var cat=$scope.deptItems[i],j=0,len2=cat.items.length;len2>j;++j){var t_item=cat.items[j];if(item_id==t_item.ITEM_ID)return t_item}return!1};PatientService.initInvoice($scope.appointment.Patient_id,$scope.appointment.CAL_ID),ReceptionistService.apptDetail($scope.appointment.CAL_ID).then(function(response){return"success"===response.status?(delete response.data.Patient_id,angular.extend($scope.appointment,response.data),PatientService.getDeptItems($scope.appointment.CLINICAL_DEPT_ID)):void 0}).then(function(response){return"success"===response.status?($scope.deptItems=response.data.filter(function(item){return item.clnDeptItemList.ISENABLE}),InvoiceService.selectInvoiceLinesBySession($scope.appointment.Patient_id,$scope.appointment.CAL_ID)):void 0}).then(function(response){if("success"===response.status){$scope.apptItems=response.data;var item_id_list=[];return angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,function(item,key){item.PRICE=0,item.TIME_SPENT=0,item.QUANTITY=1,item_id_list.push(item.ITEM_ID)})}),angular.forEach($scope.apptItems,function(item){var t_item=isInDeptItems(item.ITEM_ID);t_item?(t_item.QUANTITY=item.QUANTITY,t_item.TIME_SPENT=item.TIME_SPENT,t_item.PRICE=item.PRICE,t_item.checked=1===item.is_enable?"1":"0",t_item.inserted="1"===t_item.checked):($scope.extraItems.push(item),item_id_list.push(item.ITEM_ID),item.checked=1===item.is_enable?"1":"0",item.inserted="1"===item.checked)}),ReceptionistService.itemFeeAppt($scope.appointment.SERVICE_ID,item_id_list)}}).then(function(response){if(response&&response.list){var list_fee=response.list;angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,function(item,key){var t_item=arrGetBy(list_fee,"CLN_ITEM_ID",item.ITEM_ID);t_item&&t_item.SCHEDULE_FEE>0&&(item.PRICE=t_item.SCHEDULE_FEE,item.disable_fee=!0)})}),angular.forEach($scope.extraItems,function(item,key){var t_item=arrGetBy(list_fee,"CLN_ITEM_ID",item.ITEM_ID);t_item&&t_item.SCHEDULE_FEE>0&&(item.PRICE=t_item.SCHEDULE_FEE,item.disable_fee=!0)})}}),$scope.itemOptions={click:function(item){"dept_item"!=item.type&&"extra_item"!=item.type&&($scope.extraItems.push(item),item.QUANTITY=1,item.TIME_SPENT=0,item.checked="1",ReceptionistService.itemFeeAppt($scope.appointment.SERVICE_ID,[item.ITEM_ID]).then(function(response){response.list.length>0?(item.PRICE=response.list[0].SCHEDULE_FEE,item.disable_fee=!0):(item.PRICE=0,item.disable_fee=!1)}))},"class":function(item){if(isInDeptItems(item.ITEM_ID))return item.type="dept_item","danger";var t_item=arrGetBy($scope.extraItems,"ITEM_ID",item.ITEM_ID);return t_item?(item.type="extra_item","info"):void 0},options:{api:"api/erm/v2/items/search",method:"post",scope:$scope.items_search_panel,columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"}}}},$scope.itemSearch={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1}},$scope.submitClick=function(){var insertArr=[],fnInsertArr=function(item){var t={CLN_ITEM_ID:item.ITEM_ID,Patient_id:$scope.appointment.Patient_id,cal_id:$scope.appointment.CAL_ID,PRICE:item.PRICE,TIME_SPENT:item.TIME_SPENT?item.TIME_SPENT:0,QUANTITY:item.QUANTITY,is_enable:"1"==item.checked?1:0};insertArr.push(t)};angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,fnInsertArr)}),angular.forEach($scope.extraItems,fnInsertArr)}}),angular.module("app.loggedIn.patient.consult.scriptController",[]).controller("ScriptController",function(medica,$timeout,OutreferralModel,AppointmentModel,ConfigService,$cookieStore,$scope,$filter,$state,$modal,toastr,$modalInstance,ConsultationService,$stateParams){var user_id=$cookieStore.get("userInfo").id;$scope.medicationInfo={id:null,medication_name:null,start_date:null,dose:null,end_date:null,unit:null,qty:null,route:null,doctor_id:null,NAME:null,frequency:null,condition_Indication:null},null!=medica&&($scope.medicationInfo=angular.copy(medica),$scope.medicationInfo.start_date=moment($scope.medicationInfo.start_date).format("DD-MM-YYYY"),$scope.medicationInfo.end_date=moment($scope.medicationInfo.end_date).format("DD-MM-YYYY"),console.log($scope.medicationInfo)),$scope.getDoctorname=function(){OutreferralModel.DotorFromUserId(user_id).then(function(response){$scope.medicationInfo.doctor_id=response.data[0].doctor_id,$scope.medicationInfo.NAME=response.data[0].NAME},function(error){})},$scope.getDoctorname(),$scope.listUnit=ptnConst.unit,$scope.listRoute=ptnConst.route,$scope.changeValue=function(){var frequency=0;if(null!==$scope.medicationInfo.frequency&&null!==$scope.medicationInfo.dose&&null!==$scope.medicationInfo.start_date&&null!==$scope.medicationInfo.end_date){switch($scope.medicationInfo.frequency){case"OD":frequency=1;break;case"BD":frequency=2;break;case"TDS":frequency=3;break;case"QID":frequency=4}var diffInDays=moment($scope.medicationInfo.end_date,"DD-MM-YYYY").diff(moment($scope.medicationInfo.start_date,"DD-MM-YYYY"),"days")+1;if(0>=diffInDays)$scope.medicationInfo.qty=null;else{var dose=$scope.medicationInfo.dose;$scope.medicationInfo.qty=diffInDays*frequency*dose}}},$scope.cancelClick=function(){$modalInstance.close({type:"cancel"})},$scope.okClick=function(){$scope.isSubmit=!0,$scope.medicationForm.$invalid||$modalInstance.close({type:"ok",value:$scope.medicationInfo})}}).directive("number",function(){return{require:"ngModel",link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.push(function(inputValue){if(void 0==inputValue)return"";var transformedInput=inputValue.replace(/[^0-9]/g,"");return transformedInput!=inputValue&&(modelCtrl.$setViewValue(transformedInput),modelCtrl.$render()),transformedInput}),element.bind("keypress",function(event){32===event.keyCode&&event.preventDefault()})}}}),angular.module("app.loggedIn.patient.consult.measurementController",[]).controller("MeasurementController",function($scope,$filter,$state,$modal,toastr,$modalInstance,$stateParams,measure){$scope.today=$filter("date")(new Date,"dd/MM/yyyy"),$scope.measurementInfo={measure_id:null,measure_date:moment().format("DD-MM-YYYY"),bp1:0,bp2:0,rate:0,height:0,weight:0,excessWt:0,bmi:0,waist:0,ratio:0,hips:0,neck:0,head_circ:0,cholesterol:0,psa:0,triglycerides:0,creatitine:0,hdl:0,acr:0,ldl:0,gfr:0,bsl:0,hbA1c:0,isMdrd:null,isCockroft_gault:null,microalbuminuria:0,potassium:0,fev1:0,fvc:0,gas_transfer:0,right_pressure:0,left_pressure:0,right_uncorrected:0,left_uncorrected:0,right_corrected:0,left_corrected:0},null!=measure&&($scope.measurementInfo=angular.copy(measure),$scope.measurementInfo.measure_date=moment($scope.measurementInfo.measure_date).format("DD-MM-YYYY"),console.log("$scope.measurementInfo",$scope.measurementInfo)),console.log("$scope.measurementInfo",$scope.measurementInfo),$scope.cancelClick=function(){$modalInstance.close({type:"cancel"})},$scope.okClick=function(){0==$scope.measurementInfo.isMdrd?$scope.measurementInfo.isCockroft_gault=1:1==$scope.measurementInfo.isMdrd&&($scope.measurementInfo.isCockroft_gault=0),$modalInstance.close({type:"ok",value:$scope.measurementInfo})},$scope.calculateBMI=function(height,weight){var w=null,h=null,bmi=0;w=null==weight||"undefined"==typeof weight||""==weight||isNaN(parseFloat(weight))?null:parseFloat(weight),h=null==height||"undefined"==typeof height||""==height||isNaN(parseFloat(height))?null:.01*parseFloat(height),null!=w&&null!=h?(bmi=w/(h*h),$scope.measurementInfo.bmi=$filter("number")(bmi,2)):$scope.measurementInfo.bmi=0}}),angular.module("app.loggedIn.patient.consult.consulthistoryController",[]).controller("ConsultHistoryController",function($scope,ConsultationService,consult_id,$modalInstance){$scope.setListConsultHistory=function(){ConsultationService.getByIdConsult(consult_id).then(function(response){"success"==response.status&&($scope.listConsult=response.data,console.log($scope.listConsult),ConsultationService.getImgDrawingHistory(response.data.patient_id,response.data.cal_id).then(function(data){"success"==data.status&&($scope.listImgDrawingHistory=data.data)}),ConsultationService.getDocumentFileOfPatientidAndCalid(response.data.patient_id,response.data.cal_id).then(function(data){"success"==data.status&&($scope.listDocumentFile=data.data)}),ConsultationService.getListMeasurementsOfConsualt(response.data.patient_id,response.data.cal_id).then(function(data){"success"==data.status&&($scope.listMeasurementsConsual=data.data)}),ConsultationService.getListMedicationOfConsualt(response.data.patient_id,response.data.cal_id).then(function(data){"success"==data.status&&($scope.listMedicationConsualt=data.data)}))})},$scope.setListConsultHistory(),$scope.cancelDetail=function(){$modalInstance.close({type:"cancel"})},$scope.popupMedication=function(){angular.element("#popupListMedicationOfConsualt").modal("show")},$scope.popupMeasurements=function(){angular.element("#popupListMeasurementsOfConsualt").modal("show")}}),angular.module("app.loggedIn.patient.consult.controller",[]).controller("PatientConsultController",function(AppointmentModel,InjuryManagementService,DoctorService,$filter,$rootScope,$interval,$window,$document,$cookieStore,$scope,$state,$modal,InsurerService,toastr,socket,OTSession,ReceptionistService,$stateParams,ConsultationService,PatientService,UserService,$interval,InvoiceService){function popup(url){return params="width="+screen.width,params+=", height="+screen.height,params+=", top=0, left=0",params+=", fullscreen=yes",(null==window.calling_screen||window.calling_screen.closed)&&(window.calling_screen=window.open(url,"RedimedCallingWindow",params),window.calling_screen.focus()),null==window.calling_screen||window.calling_screen.closed||window.calling_screen.open("","RedimedCallingWindow",""),!1}function refresh(patientId){ConsultationService.getPatientCompany(patientId).then(function(rs){exlog.log(rs),"success"==rs.status.toLowerCase()&&rs.info&&($scope.companyInfo=rs.info)},function(err){exlog.logErr(err)})}function cancelListenerHandler(){console.log("Remove Success")}$scope.templates=[],$scope.viewInjury=function(){InjuryManagementService.getInjuryById($scope.apptPatient.injury_id).then(function(rs){"success"==rs.status&&$modal.open({templateUrl:"modules/consultation/dialogs/dialog_injury_details.html",size:"md",resolve:{injuryInfo:function(){return rs.data}},controller:function($scope,$modalInstance,$stateParams,injuryInfo,InjuryManagementService){if($scope.info=injuryInfo,$scope.loadedImage=!1,$scope.injuryImages=[],$scope.imgArr=[],$scope.info.injury_date=moment.utc($scope.info.injury_date).format("DD/MM/YYYY - hh:mm:ss"),"undefined"!=typeof injuryInfo.injuryImg&&injuryInfo.injuryImg.length>0){$scope.loadedImage=!0;for(var i=0;i<injuryInfo.injuryImg.length;i++)$scope.imgArr.push({url:location.origin+"/api/im/image/"+injuryInfo.injuryImg[i].id,img:injuryInfo.injuryImg[i]})}$scope.cancelClick=function(){$modalInstance.close()},$scope.viewImage=function(img){$modal.open({templateUrl:"modules/injuryManagement/views/imageModal.html",size:"md",resolve:{imgObj:function(){return img}},controller:function($scope,$state,$modalInstance,UserService,socket,toastr,imgObj){$scope.img={image:location.origin+"/api/im/image/"+imgObj.id,description:imgObj.desc}}})}}})})},$scope.addTemplate=function(){$modal.open({templateUrl:"listTemplateDialog",controller:function($scope,$modalInstance,$stateParams){$scope.patient_id=$stateParams.patient_id,$scope.cal_id=$stateParams.cal_id,$scope.success=null,$scope.$watch("success",function(success){success&&$modalInstance.close(success)})}}).result.then(function(success){console.log(success),$scope.templates.push(success)})},$scope.loadDataAddMakeReferral={},$scope.referralAddForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.loadDataAddMakeReferral.load(),$scope.referralAddForm.close()}},$scope.patient_id=$stateParams.patient_id,$scope.cal_id=$stateParams.cal_id,$scope.userInfo=$cookieStore.get("userInfo"),$scope.patientInfo={},$scope.companyInfo={},$scope.problemArr=[],$scope.checktoasl=0,$scope.isConsult=!0,$scope.consultInfo={patient_id:$scope.patient_id,cal_id:$scope.cal_id,problem_id:null,history:null,examination:null,treatment:null,diagnosis:null,investigation:null,specialist:null,progress_note:null,attendance_record:null,communication_record:null,hand_therapist:null,measurements:null,medication:null,doctornote:null,consult_id:null,chooseNextAppt:null,nextApptDate:null,FROM_TIME:null},$scope.loadConsultationInfo=function(){ConsultationService.checkConsultation($scope.patient_id,$scope.cal_id).then(function(data){"success"==data.status?(console.log("aaaaaaaaaaaaaaaaaaaaaaaaa",data.data),$scope.consultInfo.problem_id=data.data.problem_id,$scope.consultInfo.history=data.data.history,$scope.consultInfo.examination=data.data.examination,$scope.consultInfo.treatment=data.data.treatment_plan,$scope.consultInfo.diagnosis=data.data.diagnosis,$scope.consultInfo.investigation=data.data.investigation,$scope.consultInfo.specialist=data.data.specialist,$scope.consultInfo.progress_note=data.data.progress_note,$scope.consultInfo.attendance_record=data.data.attendance_record,$scope.consultInfo.communication_record=data.data.communication_record,$scope.consultInfo.hand_therapist=data.data.hand_therapist,$scope.consultInfo.doctornote=data.data.doctornote,$scope.consultInfo.consult_id=data.data.consult_id,$scope.consultInfo.FROM_TIME=data.data.FROM_TIME,console.log("$scope.current_patient.FROM_TIME",moment($scope.consultInfo.FROM_TIME).format("YYYY-MM-DD")),null!=data.data.next_appt_date&&null!=data.data.next_appt_note&&($scope.showNextAppt="1",$scope.consultInfo.chooseNextAppt=data.data.next_appt_note,$scope.consultInfo.nextApptDate=new Date(data.data.next_appt_date)),$scope.alertCenter.load()):ConsultationService.submitConsult($scope.consultInfo).then(function(res){"success"==res.status&&($scope.consultInfo.consult_id=res.data.insertId,ConsultationService.checkConsultation($scope.patient_id,$scope.cal_id).then(function(data){"success"==data.status&&($scope.consultInfo.FROM_TIME=data.data.FROM_TIME,$scope.alertCenter.load())}))})})},$scope.loadConsultationInfo(),$scope.loadListMeasurements=function(){ConsultationService.getListMeasurements($scope.patient_id).then(function(data){"success"==data.status&&(console.log("measurements",data.data),$scope.consultInfo.measurements=data.data)})},$scope.loadListMeasurements(),$scope.loadListMedication=function(){ConsultationService.getListMedication($scope.patient_id).then(function(data){"success"==data.status&&(console.log("medication",data.data),$scope.consultInfo.medication=data.data)})},$scope.loadListMedication(),$scope.actionCenter={},$scope.setListConsultationOfPatient=function(){ConsultationService.getListConsultOfPatient($stateParams.patient_id).then(function(data){"success"==data.status&&($scope.actionCenter.listConsultOfPatient=data.data,console.log($scope.actionCenter.listConsultOfPatient))})},$scope.setListConsultationOfPatient(),$scope.actionCenter.popupMedication=function(data){$modal.open({templateUrl:"popupListMedicationOfConsualtation",controller:function($scope,$modalInstance,patient_id,cal_id,ConsultationService){$scope.loadListMedicationOfConsualt=function(){ConsultationService.getListMedicationOfConsualt(patient_id,cal_id).then(function(data){"success"==data.status&&($scope.listMedicationConsualt=data.data)})},$scope.loadListMedicationOfConsualt(),$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{patient_id:function(){return data.patient_id},cal_id:function(){return data.cal_id}},size:"lg"})},$scope.actionCenter.popupMeasurements=function(data){$modal.open({templateUrl:"popupListMeasurementsOfConsualtation",controller:function($scope,$modalInstance,patient_id,cal_id,ConsultationService){$scope.loadListMeasurementsOfConsualt=function(){ConsultationService.getListMeasurementsOfConsualt(patient_id,cal_id).then(function(data){"success"==data.status&&($scope.listMeasurementsConsual=data.data)})},$scope.loadListMeasurementsOfConsualt(),$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{patient_id:function(){return data.patient_id},cal_id:function(){return data.cal_id}},size:"md"})},$scope.actionCenter.showPopupHistory=function(data){$modal.open({templateUrl:"modules/consultation/dialogs/dialogs_consult_history.html",controller:"ConsultHistoryController",resolve:{consult_id:function(){return data}},size:"lg"})},$scope.actionCenter.showPopupHistoryPhysiotherapist=function(data){$modal.open({templateUrl:"modules/consultation/dialogs/dialogs_consult_history_physiotherapist.html",controller:"ConsultHistoryController",resolve:{consult_id:function(){return data}}})},$scope.actionCenter.showPopupHistoryHandtherapist=function(data){$modal.open({templateUrl:"modules/consultation/dialogs/dialogs_consult_history_handtherapist.html",controller:"ConsultHistoryController",resolve:{consult_id:function(){return data}}})},$scope.actionCenter.showPopupHistoryExercisePhysiologist=function(data){$modal.open({templateUrl:"modules/consultation/dialogs/dialogs_consult_history_exercise_physiologist.html",controller:"ConsultHistoryController",resolve:{consult_id:function(){return data}}})},$scope.getImgDrawingHistory=function(){$scope.listImgDrawingHistory={},ConsultationService.getImgDrawingHistory($stateParams.patient_id,$scope.cal_id).then(function(data){"success"==data.status&&($scope.listImgDrawingHistory=data.data)})},$scope.getImgDrawingHistory(),$scope.showPopupConsultationHistory=function(){$modal.open({templateUrl:"popupConsultationHistory",controller:function($scope,$modalInstance,actionCenter){$scope.actionCenter=actionCenter,$scope.cancel=function(){$modalInstance.dismiss("cancel")}},size:"lg",resolve:{actionCenter:function(){return $scope.actionCenter}}})},$scope.popupNewDrawing=function(){var modalInstance=$modal.open({templateUrl:"popupNewDrawing",size:"lg",controller:function($scope,$modalInstance,patient_id,cal_id,consult_id){$scope.patient_id=patient_id,$scope.cal_id=cal_id,$scope.consult_id=consult_id,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.actionCenterDrawing={runWhenFinish:function(){$modalInstance.dismiss({status:"success"})}}},resolve:{patient_id:function(){return $stateParams.patient_id},cal_id:function(){return $stateParams.cal_id},consult_id:function(){return $scope.consultInfo.consult_id}}});modalInstance.result.then(function(data){},function(data){"success"==data.status&&($scope.getImgDrawingHistory(),$scope.setListConsultationOfPatient())})},$scope.showChooseItem=function(){angular.element("#popupChooseItem").modal("show")},$scope.documentFileSuccess={runWhenFinish:function(){$scope.setListConsultationOfPatient()}},$scope.currDate=$filter("date")(new Date,"dd/MM/yyyy hh:mm a"),$scope.timerDisplay=null,$scope.problemAddForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&($scope.problemAddForm.close(),ConsultationService.getPatientProblem($scope.patient_id).then(function(rs){"success"==rs.status.toLowerCase()&&rs.data&&($scope.problemList=rs.data,$scope.consultInfo.problem_id=response.data.Problem_id,$scope.viewProblem(response.data.Problem_id))}))}},$scope.callInfo={isCalling:null,callUser:null},refresh($scope.patient_id),socket.removeListener("online",cancelListenerHandler()),socket.on("online",function(userList){refresh($scope.patient_id)}),PatientService.get($scope.patient_id).then(function(rs){if("success"==rs.status.toLowerCase()&&rs.data){var fName=[];fName.push(rs.data.First_name,rs.data.Sur_name,rs.data.Middle_name),$scope.patientInfo=rs.data,$scope.patientInfo.FullName=null!=rs.data.Title||""!=rs.data.Title?rs.data.Title+" . "+fName.join(" "):fName.join(" "),InsurerService.insurerByPatient($scope.patient_id).then(function(res){"success"==res.status.toLowerCase()&&res.data.length>0&&($scope.patientInfo.insurer=res.data[0].insurer_name)})}}),ConsultationService.getPatientProblem($scope.patient_id).then(function(rs){"success"==rs.status.toLowerCase()&&rs.data&&($scope.problemList=rs.data)}),$scope.viewProblem=function(id){if($scope.problemArr=[],null!=id){var index=_.findIndex($scope.problemList,{Problem_id:id});$scope.problemArr.push($scope.problemList[index])}else $scope.problemArr=[]},$scope.measureAction=function(type,info){if("new"==type){var modalInstance=$modal.open({templateUrl:"modules/consultation/views/modal/measureModal.html",size:"lg",controller:"MeasurementController",resolve:{measure:function(){return null}}});modalInstance.result.then(function(data){"ok"==data.type&&(data.value.patient_id=$scope.patient_id,data.value.cal_id=$scope.cal_id,console.log(data.value.measure_date),data.value.measure_date=moment(data.value.measure_date,"DD-MM-YYYY").format("YYYY-MM-DD"),console.log(data.value.measure_date),ConsultationService.submitMeasurements(data.value).then(function(data){"success"==data.status?($scope.loadListMeasurements(),toastr.success("Submit Measurements Success!")):toastr.error("Submit Measurements Failed!")}))})}if("edit"==type){var modalInstance=$modal.open({templateUrl:"modules/consultation/views/modal/measureModal.html",size:"lg",controller:"MeasurementController",resolve:{measure:function(){return info}}});modalInstance.result.then(function(data){"ok"==data.type&&(data.value.measure_date=moment(data.value.measure_date,"DD-MM-YYYY").format("YYYY-MM-DD"),console.log("data.value",data.value.measure_date),ConsultationService.submitMeasurements(data.value).then(function(data){"success"==data.status?($scope.loadListMeasurements(),toastr.success("Edit Measurements Success!")):toastr.error("Edit Measurements Failed!")}))})}"delete"==type&&swal({title:"Confirm Delete",text:"Are You Sure Want To Delete This Measure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){ConsultationService.setIsEnableMeasurements(info,0).then(function(data){"success"==data.status?($scope.loadListMeasurements(),toastr.success("Delete Measurements Success!")):toastr.error("Delete Measurements Failed!");
})})},$scope.changeNextAppt=function(){if(1==$scope.showNextAppt)switch($scope.consultInfo.chooseNextAppt){case"1W":$scope.consultInfo.nextApptDate=moment(new Date).add(1,"w").toDate();break;case"2W":$scope.consultInfo.nextApptDate=moment(new Date).add(2,"w").toDate();break;case"3W":$scope.consultInfo.nextApptDate=moment(new Date).add(3,"w").toDate();break;case"1M":$scope.consultInfo.nextApptDate=moment(new Date).add(1,"M").toDate();break;case"2M":$scope.consultInfo.nextApptDate=moment(new Date).add(2,"M").toDate();break;case"3M":$scope.consultInfo.nextApptDate=moment(new Date).add(3,"M").toDate();break;case"6M":$scope.consultInfo.nextApptDate=moment(new Date).add(6,"M").toDate();break;case"Others":$scope.consultInfo.nextApptDate=null}else $scope.consultInfo.chooseNextAppt=null,$scope.consultInfo.nextApptDate=null},$scope.medicationAction=function(type,info){if("new"==type){var modalInstance=$modal.open({templateUrl:"modules/consultation/views/modal/scriptModal.html",windowClass:"consult-modal-window",controller:"ScriptController",resolve:{medica:function(){return null}}});modalInstance.result.then(function(data){"ok"==data.type&&(data.value.patient_id=$scope.patient_id,data.value.consult_id=$scope.consultInfo.consult_id,data.value.cal_id=$scope.cal_id,data.value.end_date=moment(data.value.end_date,"DD-MM-YYYY").format("YYYY-MM-DD"),data.value.start_date=moment(data.value.start_date,"DD-MM-YYYY").format("YYYY-MM-DD"),ConsultationService.submitMedication(data.value).then(function(data){"success"==data.status?($scope.loadListMedication(),toastr.success("Submit Medication Success!")):toastr.error("Submit Medication Failed!")}))})}if("edit"==type){var modalInstance=$modal.open({templateUrl:"modules/consultation/views/modal/scriptModal.html",windowClass:"consult-modal-window",controller:"ScriptController",resolve:{medica:function(){return info}}});modalInstance.result.then(function(data){"ok"==data.type&&(data.value.end_date=moment(data.value.end_date,"DD-MM-YYYY").format("YYYY-MM-DD"),data.value.start_date=moment(data.value.start_date,"DD-MM-YYYY").format("YYYY-MM-DD"),console.log("data.value",data.value),ConsultationService.submitMedication(data.value).then(function(data){"success"==data.status?($scope.loadListMedication(),toastr.success("Edit Medication Success!")):toastr.error("Edit Medication Failed!")}))})}"delete"==type&&swal({title:"Confirm Delete",text:"Are You Sure Want To Delete This Medication?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){ConsultationService.setIsEnableMedication(info,0).then(function(data){"success"==data.status?($scope.loadListMedication(),toastr.success("Delete Medication Success!")):toastr.error("Delete Medication Failed!")})})},$scope.backClick=function(){var from=$cookieStore.get("fromState"),params={};(null!=from.fromParams||"undefined"!=typeof from.fromParams)&&angular.forEach(from.fromParams,function(value,key){params[key]=value}),$state.go(from.fromState.name,params)},$scope.makeCall=function(user){socket.removeListener("generateSessionSuccess",cancelListenerHandler()),socket.emit("generateSession",$scope.userInfo.id),socket.on("generateSessionSuccess",function(opentokRoom){opentokRoom&&popup($state.href("make_call",{apiKey:opentokRoom.apiKey,sessionId:opentokRoom.sessionId,token:opentokRoom.token,callUser:user.id,isCaller:1,patientId:$scope.patient_id,calId:$scope.cal_id}))})},$scope.dropzoneConfig={options:{url:"api/upload",addRemoveLinks:!0},eventHandlers:{sending:function(file,xhr,formData){formData.append("patient_id",$scope.patient_id)},success:function(file,response){"success"==response.status?(socket.emit("shareFile",response.id,response.fileName,$scope.callInfo.callUser),toastr.success("Upload File Successfully!")):toastr.error("Upload File Failed!")}}},$scope.selectedOpt=null,$scope.currWorkcover=null,$scope.first_opt=PatientService.workcoverSearchOpt("first",$scope.patient_id),$scope.progress_opt=PatientService.workcoverSearchOpt("progress",$scope.patient_id),$scope.final_opt=PatientService.workcoverSearchOpt("final",$scope.patient_id),$scope.general_opt=PatientService.workcoverSearchOpt("general",$scope.patient_id),$scope.viewWorkcover=function(i){switch($scope.selectedOpt=i,i){case 1:$scope.currWorkcover="First Assessment";break;case 2:$scope.currWorkcover="Progress Assessment";break;case 3:$scope.currWorkcover="Final Assessment";break;case 4:$scope.currWorkcover="General Assessment"}},$scope.addWorkcover=function(){if(null!=$scope.selectedOpt)switch($scope.selectedOpt){case 1:$state.go("loggedIn.waworkcover.first",{patient_id:$scope.patient_id,action:"add",cal_id:$scope.cal_id,wc_id:0});break;case 2:$state.go("loggedIn.waworkcover.progress",{patient_id:$scope.patient_id,action:"add",cal_id:$scope.cal_id,wc_id:0});break;case 3:$state.go("loggedIn.waworkcover.final",{patient_id:$scope.patient_id,action:"add",cal_id:$scope.cal_id,ass_id:0});break;case 4:$state.go("loggedIn.waworkcover.general",{patient_id:$scope.patient_id,action:"add",cal_id:$scope.cal_id,ass_id:0})}};var arrGetBy=$filter("arrGetBy");$scope.appointment={CAL_ID:$scope.cal_id,Patient_id:$scope.patient_id},$scope.items_search_panel={},$scope.deptItems=null,$scope.apptItems=[],$scope.extraItems=[];var isInDeptItems=function(item_id){if($scope.deptItems.length>0)for(var i=0,len=$scope.deptItems.length;len>i;++i)for(var cat=$scope.deptItems[i],j=0,len2=cat.items.length;len2>j;++j){var t_item=cat.items[j];if(item_id==t_item.ITEM_ID)return t_item}return!1};$scope.invoiceHeaderInfo=null,PatientService.initInvoice($scope.appointment.Patient_id,$scope.appointment.CAL_ID).then(function(data){InvoiceService.selectInvoiceHeaderBySession($scope.appointment.Patient_id,$scope.appointment.CAL_ID).then(function(data){"success"==data.status?$scope.invoiceHeaderInfo=data.data:(alert("Get Invoice Header Error."),exlog.logErr(data))},function(err){alert("Get Invoice Header Error."),exlog.logErr(err)})},function(err){alert("Init Invoice Error."),exlog.logErr(err)}),ReceptionistService.apptDetail($scope.appointment.CAL_ID).then(function(response){return"success"===response.status?(delete response.data.Patient_id,angular.extend($scope.appointment,response.data),PatientService.getDeptItems($scope.appointment.CLINICAL_DEPT_ID)):void 0}).then(function(response){return"success"===response.status?($scope.deptItems=response.data.filter(function(item){return item.clnDeptItemList.ISENABLE}),InvoiceService.selectInvoiceLinesBySession($scope.appointment.Patient_id,$scope.appointment.CAL_ID)):void 0}).then(function(response){if("success"===response.status){$scope.apptItems=response.data;var item_id_list=[];return angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,function(item,key){item.PRICE=0,item.TIME_SPENT=0,item.QUANTITY=1,item_id_list.push(item.ITEM_ID)})}),angular.forEach($scope.apptItems,function(item){var t_item=isInDeptItems(item.ITEM_ID);t_item?(t_item.QUANTITY=item.QUANTITY,t_item.TIME_SPENT=item.TIME_SPENT,t_item.PRICE=item.PRICE,t_item.checked=1===item.IS_ENABLE?"1":"0",t_item.inserted="1"===t_item.checked):($scope.extraItems.push(item),item_id_list.push(item.ITEM_ID),item.checked=1===item.IS_ENABLE?"1":"0",item.inserted="1"===item.checked)}),ReceptionistService.itemFeeAppt($scope.appointment.SERVICE_ID,item_id_list)}}).then(function(response){if(response&&response.list){var list_fee=response.list;angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,function(item,key){var t_item=arrGetBy(list_fee,"CLN_ITEM_ID",item.ITEM_ID);t_item&&t_item.SCHEDULE_FEE>0&&(item.PRICE=t_item.SCHEDULE_FEE,item.disable_fee=!0)})}),angular.forEach($scope.extraItems,function(item,key){var t_item=arrGetBy(list_fee,"CLN_ITEM_ID",item.ITEM_ID);t_item&&t_item.SCHEDULE_FEE>0&&(item.PRICE=t_item.SCHEDULE_FEE,item.disable_fee=!0)})}}),$scope.itemOptions={click:function(item){"dept_item"!=item.type&&"extra_item"!=item.type&&($scope.extraItems.push(item),item.QUANTITY=1,item.TIME_SPENT=0,item.checked="1",ReceptionistService.itemFeeAppt($scope.appointment.SERVICE_ID,[item.ITEM_ID]).then(function(response){response.list.length>0?(item.PRICE=response.list[0].SCHEDULE_FEE,item.disable_fee=!0):(item.PRICE=0,item.disable_fee=!1)}))},"class":function(item){if(isInDeptItems(item.ITEM_ID))return item.type="dept_item","danger";var t_item=arrGetBy($scope.extraItems,"ITEM_ID",item.ITEM_ID);return t_item?(item.type="extra_item","info"):void 0},options:{api:"api/erm/v2/items/search",method:"post",scope:$scope.items_search_panel,columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"},{field:"TAX_ID",label:"Tax Id",is_hide:!0},{field:"TAX_CODE",label:"Tax code"},{field:"TAX_RATE",label:"Tax rate"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"}}}},$scope.itemSearch={is_show:!1,open:function(){this.is_show=!0,angular.element("#popupSreachItem").modal("show")},close:function(){this.is_show=!1,angular.element("#popupSreachItem").modal("hide")}},$("#popupSreachItem").on("hidden.bs.modal",function(e){$scope.itemSearch.is_show=!1}),$scope.submitClick=function(){$scope.consultInfo.nextApptDate&&($scope.consultInfo.nextApptDate=moment($scope.consultInfo.nextApptDate).format("YYYY-MM-DD"));var consultInfoTemp=angular.copy($scope.consultInfo);consultInfoTemp.templates=$scope.templates,ConsultationService.submitConsult(consultInfoTemp).then(function(res){"success"==res.status?($scope.loadConsultationInfo(),$scope.setListConsultationOfPatient(),0===$scope.checktoasl&&toastr.success("Submit Consultation Success!")):toastr.success("Submit Consultation Failed!")})},console.log("extraItems",$scope.extraItems),$scope.saveItemInfo=function(){if(!$scope.invoiceHeaderInfo)return void alert("Error.Invoice Header Not Exist.");var insertArr=[],fnInsertArr=function(item){var t={HEADER_ID:$scope.invoiceHeaderInfo.header_id,ITEM_ID:item.ITEM_ID,QUANTITY:item.QUANTITY,TAX_ID:item.TAX_ID,TAX_CODE:item.TAX_CODE,TAX_RATE:item.TAX_RATE,TIME_SPENT:item.TIME_SPENT?item.TIME_SPENT:0,IS_ENABLE:"1"==item.checked?1:0};insertArr.push(t)};$scope.deptItems&&angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,fnInsertArr)}),$scope.extraItems&&angular.forEach($scope.extraItems,fnInsertArr);var postData={invoiceHeaderId:$scope.invoiceHeaderInfo.header_id,listLine:insertArr};InvoiceService.saveInvoiceLineSheet(postData).then(function(data){"success"==data.status?(toastr.success("Save invoice item success."),angular.element("#popupChooseItem").modal("hide")):(data.status=0===$scope.checktoasl)?toastr.warning("No invoice item."):0===$scope.checktoasl&&toastr.error("Save invoice item error.")},function(err){toastr.error("Save invoice item error.")})},$scope.apptPatient={},$scope.actual_doctor_id={},$scope.apptStatus=ptnConst.apptStatus,$scope.getApptPatient=function(){var postData={patientId:$scope.patient_id,calId:$scope.cal_id};ConsultationService.getApptPatient(postData).then(function(data){if("success"==data.status){if($scope.apptPatient=data.data,DoctorService.getById($scope.apptPatient.actual_doctor_id).then(function(data){void 0===data&&($scope.actual_doctor_id={NAME:null}),$scope.actual_doctor_id=data}),$scope.apptPatient.SESSION_START_TIME&&$scope.apptPatient.SESSION_END_TIME){var tempStart=moment(new Date($scope.apptPatient.SESSION_START_TIME)),tempEnd=moment(new Date($scope.apptPatient.SESSION_END_TIME)),x=tempEnd.diff(tempStart,"seconds");$scope.timerDisplay=kiss.msToTimer(x).display}$scope.apptPatient.appt_status==ptnConst.apptStatus.inConsult.value&&($scope.startSessionTime=$scope.apptPatient.SESSION_START_TIME)}else $scope.actual_doctor_id={NAME:null},exlog.log(data)},function(err){exlog.logErr(err)})},$scope.getApptPatient(),$scope.startSession=function(){function executeStart(){var startSessionTime=new Date,postData={patientId:$scope.patient_id,calId:$scope.cal_id,startSessionTime:moment(startSessionTime).format("YYYY/MM/DD HH:mm:ss")};ConsultationService.startSession(postData).then(function(data){"success"==data.status?($scope.apptPatient.appt_status=ptnConst.apptStatus.inConsult.value,toastr.success("Start progress success."),$scope.startSessionTime=startSessionTime,$scope.apptPatient.SESSION_START_TIME=startSessionTime,socket.emit("notifyReceptionist")):(exlog.logErr(data),toastr.error("Start progress error."))},function(err){exlog.logErr(err),toastr.error("Start progress error.")})}var doctorData={};doctorData.doctorId=$scope.apptPatient.DOCTOR_ID,$scope.apptPatient.actual_doctor_id&&(doctorData.actualDoctorId=$scope.apptPatient.actual_doctor_id),executeStart()},$scope.beforeFinishSession=function(){var postData={patientId:$scope.patient_id,calId:$scope.cal_id};ConsultationService.beforeFinishSession(postData).then(function(data){"success"==data.status?data.data.length>0?$scope.finishSession():$modal.open({templateUrl:"notifyChooseItem",controller:function($scope,$modalInstance){$scope.ok=function(){$modalInstance.dismiss("cancel")}},size:"sm"}):(exlog.logErr(data),toastr.error("Complete progress fail."))},function(err){exlog.logErr(err),toastr.error("Complete progress fail.")})},$scope.finishSession=function(){var endSessionTime=new Date,postData={patientId:$scope.patient_id,calId:$scope.cal_id,endSessionTime:moment(endSessionTime).format("YYYY/MM/DD HH:mm:ss")};ConsultationService.finishSession(postData).then(function(data){"success"==data.status?($scope.apptPatient.appt_status=ptnConst.apptStatus.completed.value,$scope.startSessionTime="close",$scope.apptPatient.SESSION_END_TIME=endSessionTime,toastr.success("Complete progress success."),socket.emit("notifyReceptionist")):(exlog.logErr(data),toastr.error("Complete progress fail."))},function(err){exlog.logErr(err),toastr.error("Complete progress fail.")})};var loadAlertCenter=function(){var postData={fromDate:moment($scope.consultInfo.FROM_TIME).format("YYYY-MM-DD"),patient_id:$scope.patient_id};$scope.alertCenter.list=[],AppointmentModel.alertCenterConsultation(postData).then(function(response){_.forEach(response.data,function(row){var flag=-1,i=0;if(_.forEach($scope.alertCenter.list,function(list){return list.Patient_id===row.Patient_id?void(flag=i):void i++}),-1!==flag){if(row.ALERT_ID){var alert_flag=!0;if(_.forEach($scope.alertCenter.list[flag].alert,function(alert){alert.id===row.ALERT_ID&&(alert_flag=!1)}),alert_flag){var object={id:row.ALERT_ID,name:row.ALERT_NAME,color:row.SERVICE_COLOR,patient_alert:row.ID,Check:row.Check,User:row.User,isUser:row.isUser,Patients_id:row.Patients_id};$scope.alertCenter.list[flag].alert.push(object)}var cal_flag=!0,i=0;if(_.forEach($scope.alertCenter.list[flag].cal,function(cal){cal.CAL_ID===row.CAL_ID&&(cal_flag=!1)}),cal_flag&&($scope.alertCenter.list[flag].test=row.IS_REFERRAL,$scope.alertCenter.list[flag].cal.push({IS_REFERRAL:row.IS_REFERRAL,CAL_ID:row.CAL_ID,FROM_TIME:row.FROM_TIME,TO_TIME:row.TO_TIME,OUTREFERRAL:"no",DOCTOR_ID:row.DOCTOR_ID}),row.outreferral_id)){var cal_length=$scope.alertCenter.list[flag].cal.length;$scope.alertCenter.list[flag].cal[cal_length-1].OUTREFERRAL="yes"}}}else{var object={Patient_id:row.Patient_id,First_name:row.First_name,Sur_name:row.Sur_name,alert:[],cal:[]};row.ALERT_ID&&object.alert.push({id:row.ALERT_ID,name:row.ALERT_NAME,color:row.SERVICE_COLOR,patient_alert:row.ID,Check:row.Check,User:row.User,isUser:row.isUser,Patients_id:row.Patients_id}),row.CAL_ID&&(object.test=row.IS_REFERRAL,object.cal.push({IS_REFERRAL:row.IS_REFERRAL,DOCTOR_ID:row.DOCTOR_ID,CAL_ID:row.CAL_ID,FROM_TIME:row.FROM_TIME,TO_TIME:row.TO_TIME,OUTREFERRAL:"no"}),row.outreferral_id&&(object.cal[0].OUTREFERRAL="yes")),$scope.alertCenter.list.push(object)}})},function(error){})},search={id:0,isCheck:0,isUser:0},onCheck=function(row){$scope.alertCenter.search.id=row.patient_alert,$scope.alertCenter.search.isCheck=row.Check,$scope.alertCenter.search.isUser=$scope.userInfo.id,$scope.alertCenter.search.Patients_id=row.Patients_id,AppointmentModel.PostCheck($scope.alertCenter.search).then(function(response){var temp=[],temp_r=[];angular.forEach($scope.alertCenter.list,function(value,index){$scope.alertCenter.list[index].Patient_id===$scope.alertCenter.search.Patients_id&&temp.push(value)}),angular.forEach(temp[0].alert,function(values,indexs){temp[0].alert[indexs].patient_alert===$scope.alertCenter.search.id&&temp_r.push(values)}),AppointmentModel.PostUser($scope.userInfo.id).then(function(resp){angular.forEach(temp_r,function(valuer,indexr){temp_r[indexr].User=resp.data[0].User}),angular.forEach($scope.alertCenter.list,function(value_y,index_y){angular.forEach(temp_r,function(value_x,index_x){$scope.alertCenter.list[index_y].Patient_id===temp_r[index_x].Patients_id&&angular.forEach($scope.alertCenter.list[index_y].alert,function(value_a,index_a){})})})},function(error){})},function(error){})};$scope.alertCenter={search:search,onCheck:function(row){onCheck(row)},load:function(){loadAlertCenter()},list:[],arrow:!1}}).directive("dropzone",function(){return function(scope,element,attrs){var config,dropzone;config=scope[attrs.dropzone],dropzone=new Dropzone(element[0],config.options),angular.forEach(config.eventHandlers,function(handler,event){dropzone.on(event,handler)})}}),angular.module("app.loggedIn.corres.list.controller",[]).controller("CorrespondenceController",function($scope,$state){}),angular.module("app.loggedIn.corres.list.directive",[]).directive("listCor",function(ConsultationService,ConfigService,$modal,$filter,$stateParams,$state,toastr){return{restrict:"EA",templateUrl:"modules/consultation/directives/template_cor/list.html",scope:{options:"="},link:function(scope,ele,attrs){var search={page:1,limit:20,offset:0,max_size:5,PATIENT_ID:$stateParams.patient_id,CAL_ID:$stateParams.cal_id},load=function(){ConsultationService.getListCor(search).then(function(response){scope.cor.list=response.data,scope.cor.list.Date=ConfigService.convertToDate_F(response.data.Date),scope.cor.count=response.count},function(error){})};scope.setPage=function(page){scope.cor.search.offset=(page-1)*scope.cor.search.limit,scope.cor.load()},scope.Action=function(type,index){"new"==type&&$modal.open({templateUrl:"CorAdd",controller:"CorrespondenceAddController"}).result.then(function(response){scope.cor.load()}),"update"==type&&(console.log("sdjkds ",index),$modal.open({templateUrl:"CorEdit",controller:"CorrespondenceEditController",resolve:{id:function(){return index}}}).result.then(function(response){scope.cor.load()}))},scope.cor={search:search,load:function(){load()},loading:!1,list:[],count:0,errors:[]},scope.cor.load()}}}),angular.module("app.loggedIn.corres.add.controller",[]).controller("CorrespondenceAddController",function($scope,$state,$modalInstance){$scope.addcor={success:!1},$scope.$watch("addcor.success",function(success){success&&$modalInstance.close("success")})}),angular.module("app.loggedIn.corres.add.directive",[]).directive("addCor",function(ConsultationService,ConfigService,$cookieStore,$modal,$filter,$stateParams,$state,toastr){return{restrict:"EA",templateUrl:"modules/consultation/directives/template_cor/add.html",scope:{options:"=",success:"="},link:function(scope,ele,attrs){var user_id=$cookieStore.get("userInfo").id,saveCor=function(){ConfigService.beforeSave(scope.scor.errors),scope.scor.errors=[];var postData=angular.copy(scope.scor.form);console.log("^^^^^^^, ",postData),postData.Date=moment().format("YYYY-MM-DD"),postData.Time=moment().format("hh:mm"),postData.CAL_ID=$stateParams.cal_id,postData.PATIENT_ID=$stateParams.patient_id,postData.Created_by=postData.Last_updated_by=user_id,postData.Creation_date=moment().format("YYYY-MM-DD"),postData.Last_update_date=moment().format("YYYY-MM-DD"),ConsultationService.postAddCor(postData).then(function(response){scope.success=!0,toastr.success("Saved Successfully")},function(error){scope.scor.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.scor.errors)})};scope.scor={save:function(params){saveCor(params)},errors:[],form:{Mode:"",Duration:"",Who:"",Details:"",Therapist:""}}}}}),angular.module("app.loggedIn.corres.edit.controller",[]).controller("CorrespondenceEditController",function($scope,$state,$modalInstance,id){$scope.editcor={success:!1,id:id},$scope.$watch("editcor.success",function(success){success&&$modalInstance.close("success")})}),angular.module("app.loggedIn.corres.edit.directive",[]).directive("editCor",function(ConsultationService,ConfigService,$cookieStore,$modal,$filter,$stateParams,$state,toastr){return{restrict:"EA",templateUrl:"modules/consultation/directives/template_cor/edit.html",scope:{options:"=",success:"=",id:"="},link:function(scope,ele,attrs){var user_id=$cookieStore.get("userInfo").id,saveCor=function(){ConfigService.beforeSave(scope.scor.errors),scope.scor.errors=[];var postData=angular.copy(scope.scor.form);console.log("^^^^^^^, ",postData),postData.Date=moment().format("YYYY-MM-DD"),postData.Time=moment().format("hh:mm"),postData.CAL_ID=$stateParams.cal_id,postData.PATIENT_ID=$stateParams.patient_id,postData.Created_by=postData.Last_updated_by=user_id,postData.Creation_date=moment().format("YYYY-MM-DD"),postData.Last_update_date=moment().format("YYYY-MM-DD"),ConsultationService.postAddCor(postData).then(function(response){scope.success=!0,toastr.success("Updated Successfully"),scope.scor.load()},function(error){scope.scor.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.scor.errors)})},load=function(){console.log("sdfsssssssdfd",scope.scor.form.ID),ConsultationService.postByIdCor(scope.id).then(function(response){console.log(response.data),scope.scor.form=angular.copy(response.data)},function(error){})};scope.scor={load:function(){load()},save:function(params){saveCor(params)},errors:[],form:{ID:"",Date:"",Time:"",Mode:"",Duration:"",Who:"",Details:"",Therapist:""}},scope.scor.load()}}}),angular.module("app.loggedIn.patient.consult",["app.loggedIn.patient.consult.controller","app.loggedIn.patient.consult.consulthistoryController","app.loggedIn.patient.consult.measurementController","app.loggedIn.patient.consult.scriptController","app.loggedIn.patient.consult.itemsheetController","app.loggedIn.patient.consult.services","app.loggedIn.patient.consult.directives","app.loggedIn.corres.list.controller","app.loggedIn.corres.list.directive","app.loggedIn.corres.add.controller","app.loggedIn.corres.add.directive","app.loggedIn.corres.edit.controller","app.loggedIn.corres.edit.directive","app.kiss.timer.directive","app.loggedIn.patient.exercise.directives.list"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.consult",{url:"/consult",views:{"main-content":{templateUrl:"modules/consultation/views/consult.html",controller:"PatientConsultController"}}})}),angular.module("app.loggedIn.department",["app.loggedIn.department.controller","app.loggedIn.department.services","app.loggedIn.department.directives"]).config(function($stateProvider){$stateProvider.state("loggedIn.department",{"abstract":!0,templateUrl:"modules/department/views/structure.html",controller:"DepartmentController"}).state("loggedIn.department.list",{url:"/department/list",views:{"main-content":{templateUrl:"modules/department/views/list.html",controller:"DepartmentListController"}}})}),angular.module("app.loggedIn.department.services",[]).factory("DepartmentService",function(Restangular){var instanceService={},appApi=Restangular.all("api/erm");return instanceService.detail=function(department_id){var detailApi=appApi.all("v2/dept/detail");return detailApi.post({CLINICAL_DEPT_ID:department_id})},instanceService.insert=function(data){var detailApi=appApi.all("v2/dept/insert");return detailApi.post(data)},instanceService.update=function(department_id,data){var detailApi=appApi.all("v2/dept/update");return detailApi.post(data)},instanceService["delete"]=function(department_id){var detailApi=appApi.all("v2/dept/delete");return detailApi.post(department_id)},instanceService.saveDeptHeaders=function(dept_id,header_list){for(var list=[],i=header_list.length-1;i>=0;i--)list.push(header_list[i].POPULAR_HEADER_ID);var detailApi=appApi.all("v2/dept/insert_dept_headers");return detailApi.post({dept_id:dept_id,headers:list})},instanceService.saveDeptServices=function(dept_id,service_list){for(var list=[],i=service_list.length-1;i>=0;i--)list.push(service_list[i].SERVICE_ID);var detailApi=appApi.all("v2/dept/insert_dept_services");return detailApi.post({dept_id:dept_id,services:list})},instanceService.disableDeptHeader=function(dept_id,header_id){if(dept_id&&header_id){var detailApi=appApi.all("v2/dept/update_dept_header");return detailApi.post({CLINICAL_DEPT_ID:dept_id,POPULAR_HEADER_ID:header_id,ISENABLE:0})}},instanceService.enableDeptHeader=function(dept_id,header_id){if(dept_id&&header_id){var detailApi=appApi.all("v2/dept/update_dept_header");return detailApi.post({CLINICAL_DEPT_ID:dept_id,POPULAR_HEADER_ID:header_id,ISENABLE:1})}},instanceService.disableDeptService=function(dept_id,service_id){if(dept_id&&service_id){var detailApi=appApi.all("v2/dept/update_dept_service");return detailApi.post({CLINICAL_DEPT_ID:dept_id,SERVICE_ID:service_id,ISENABLE:0})}},instanceService.enableDeptService=function(dept_id,service_id){if(dept_id&&service_id){var detailApi=appApi.all("v2/dept/update_dept_service");return detailApi.post({CLINICAL_DEPT_ID:dept_id,SERVICE_ID:service_id,ISENABLE:1})}},instanceService}),angular.module("app.loggedIn.department.directives",["app.loggedIn.department.detail.directive"]),angular.module("app.loggedIn.department.detail.directive",[]).directive("departmentDetail",function(ClnDepartmentModel,DepartmentService,ConfigService,toastr){return{restrict:"EA",scope:{data:"@",options:"=",on_success:"=onsuccess"},templateUrl:"modules/department/directives/templates/detail.html",link:function(scope,element,attrs){var loadData=function(id){DepartmentService.detail(id).then(function(data){angular.extend(scope.modelObjectMap,data.data),ConfigService.autoConvertData(scope.modelObjectMap)})};if(scope.modelObjectMap=angular.copy(ClnDepartmentModel),scope.mode={type:"add",text:"Add Department"},scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit Department"})}var addProcess=function(postData){DepartmentService.insert(postData).then(function(response){"success"===response.status&&(toastr.success("Added a new Department","Success"),scope.modelObjectMap=angular.copy(ClnDepartmentModel),scope.isSubmit=!1,scope.on_success&&scope.on_success(response))})},editProcess=function(postData){var id=postData.id;delete postData.id,DepartmentService.update(id,postData).then(function(response){"success"===response.status&&(toastr.success("Edit Department Successfully","Success"),scope.isSubmit=!1,scope.on_success&&scope.on_success(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.department.controller",["app.loggedIn.department.list.controller"]).controller("DepartmentController",function($scope,ConfigService){}),angular.module("app.loggedIn.department.list.controller",[]).controller("DepartmentListController",function($scope,$state,$filter,DepartmentService,toastr){var arrGetBy=$filter("arrGetBy");$scope.departmentInfo={},$scope.header_panel={},$scope.dept_panel={},$scope.service_panel={},$scope.department={select:0,"class":function(item){return{danger:0==item.ISENABLE,selected:item.CLINICAL_DEPT_ID==$scope.department.select}},options:{scope:$scope.dept_panel,api:"api/erm/v2/dept/search",method:"post",columns:[{field:"CLINICAL_DEPT_ID",is_hide:!0},{field:"CLINICAL_DEPT_NAME",label:"Department name"},{field:"ISENABLE",is_hide:!0,label:"Is Enable",type:"checkbox"}],use_actions:!0,actions:[{"class":"fa fa-check",title:"Show",callback:function(item){$scope.department.select=item.CLINICAL_DEPT_ID,$scope.invheader.show(item.CLINICAL_DEPT_ID),$scope.services.show(item.CLINICAL_DEPT_ID)}},{"class":"fa fa-pencil",title:"Edit",callback:function(item){console.log(item),$scope.departmentInfo.id=item.CLINICAL_DEPT_ID,$scope.formEditDept.open()}},{"class":"fa fa-check",title:"Enable"},{"class":"fa fa-times",title:"Disable"}]}},$scope.formAddDept={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){console.log(response),"success"==response.status&&$scope.dept_panel.reload()}},$scope.formEditDept={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){console.log(response),"success"==response.status&&$scope.dept_panel.reload()}},$scope.services={show:function(dept_id){$scope.services.options.search={CLINICAL_DEPT_ID:dept_id},$scope.service_panel.reload(),$scope.searchService.select_list=[]},"class":function(item){return item.just_add?"info":0==item.clnDeptService.ISENABLE?"danger":void 0},options:{scope:$scope.service_panel,api:"api/erm/v2/dept/dept_service",method:"post",columns:[{field:"SERVICE_ID",is_hide:!0},{field:"SERVICE_NAME",label:"Service Name"},{field:"DESCRIPTION",label:"Description"},{field:"SERVICE_COLOR",label:"Color",type:"color"}],use_filters:!0,search:{CLINICAL_DEPT_ID:0},not_load:!0,"static":!0,use_actions:!0,actions:[{"class":"fa fa-check",title:"Enable",callback:function(item){return 1==item.clnDeptService.ISENABLE?void toastr.info("Header is enable !!!","Information"):void DepartmentService.enableDeptService($scope.department.select,item.SERVICE_ID).then(function(response){"success"==response.status&&(toastr.success("Save Successfully!!!","Success"),item.clnDeptService.ISENABLE=1)})}},{"class":"fa fa-times",title:"Disable",callback:function(item){return 0==item.clnDeptService.ISENABLE?void toastr.info("Header is disable !!!","Information"):void DepartmentService.disableDeptService($scope.department.select,item.SERVICE_ID).then(function(response){"success"==response.status&&(toastr.success("Save Successfully!!!","Success"),item.clnDeptService.ISENABLE=0)})}}]}},$scope.invheader={show:function(dept_id){$scope.invheader.options.search={CLINICAL_DEPT_ID:dept_id},$scope.header_panel.reload(),$scope.searchHeader.select_list=[]},"class":function(item){return item.just_add?"info":0==item.clnDeptItemList.ISENABLE?"danger":void 0},options:{scope:$scope.header_panel,api:"api/erm/v2/dept/dept_header",method:"post",columns:[{field:"POPULAR_HEADER_ID",is_hide:!0},{field:"POPULAR_CODE",label:"Popular Code",width:"20%"},{field:"POPULAR_NAME",label:"Popular Name"}],use_filters:!0,search:{CLINICAL_DEPT_ID:0},not_load:!0,"static":!0,use_actions:!0,actions:[{"class":"fa fa-check",title:"Enable",callback:function(item){return 1==item.clnDeptItemList.ISENABLE?void toastr.info("Header is enable !!!","Information"):void DepartmentService.enableDeptHeader($scope.department.select,item.POPULAR_HEADER_ID).then(function(response){"success"==response.status&&(toastr.success("Save Successfully!!!","Success"),item.clnDeptItemList.ISENABLE=1)})}},{"class":"fa fa-times",title:"Disable",callback:function(item){return 0==item.clnDeptItemList.ISENABLE?void toastr.info("Header is disable !!!","Information"):void DepartmentService.disableDeptHeader($scope.department.select,item.POPULAR_HEADER_ID).then(function(response){"success"==response.status&&(toastr.success("Save Successfully!!!","Success"),item.clnDeptItemList.ISENABLE=0)})}}]}},$scope.searchHeader={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},select_list:[],"class":function(item){var t_item=arrGetBy($scope.header_panel.data.items,"POPULAR_HEADER_ID",item.POPULAR_HEADER_ID);if(t_item)return"success";var t_item=arrGetBy($scope.searchHeader.select_list,"POPULAR_HEADER_ID",item.POPULAR_HEADER_ID);
return t_item?"info":void 0},click:function(item){var t_item=arrGetBy($scope.header_panel.data.items,"POPULAR_HEADER_ID",item.POPULAR_HEADER_ID);if(!t_item){var t_item=arrGetBy($scope.searchHeader.select_list,"POPULAR_HEADER_ID",item.POPULAR_HEADER_ID);t_item||(item.just_add=!0,$scope.searchHeader.select_list.push(item),$scope.header_panel.data.more_items.push(item))}},save:function(){DepartmentService.saveDeptHeaders($scope.department.select,$scope.searchHeader.select_list).then(function(response){"success"===response.status&&(toastr.success("Save Successfully!!!","Success"),$scope.header_panel.reload())})},options:{api:"api/erm/v2/items/header_search",method:"post",columns:[{field:"POPULAR_HEADER_ID",is_hide:!0},{field:"POPULAR_CODE",label:"Code"},{field:"POPULAR_NAME",label:"Name"},{field:"ISENABLE",label:"Is enable"}]}},$scope.searchService={is_show:!1,select_list:[],"class":function(item){},click:function(item){var t_item=arrGetBy($scope.service_panel.data.items,"SERVICE_ID",item.SERVICE_ID);if(!t_item){var t_item=arrGetBy($scope.searchService.select_list,"SERVICE_ID",item.SERVICE_ID);t_item||(item.just_add=!0,$scope.searchService.select_list.push(item),$scope.service_panel.data.more_items.push(item))}},open:function(){this.is_show=!0},close:function(){this.is_show=!1},save:function(){DepartmentService.saveDeptServices($scope.department.select,$scope.searchService.select_list).then(function(response){"success"===response.status&&(toastr.success("Save Successfully!!!","Success"),$scope.service_panel.reload())})}}}),angular.module("app.loggedIn.doctor",["app.loggedIn.doctor.controller","app.loggedIn.doctor.services","app.loggedIn.doctor.directives"]).config(function($stateProvider){$stateProvider.state("loggedIn.doctor",{"abstract":!0,templateUrl:"modules/doctor/views/structure.html",controller:"DoctorController"}).state("loggedIn.doctor.paperless",{url:"/doctor/paperless/:patient_id/:cal_id",views:{"main-content":{templateUrl:"modules/doctor/views/paperless.html",controller:"DoctorPaperlessController"}}}).state("loggedIn.doctor.home",{url:"/doctor/home",views:{"main-content":{templateUrl:"modules/doctor/views/home.html",controller:"DoctorHomeController"}}}).state("loggedIn.doctor.add",{url:"/doctor/add",views:{"main-content":{templateUrl:"modules/doctor/views/add.html",controller:"DoctorAddController"}}}).state("loggedIn.doctor.list",{url:"/doctor/list",views:{"main-content":{templateUrl:"modules/doctor/views/doclist.html",controller:"DoctorListController"}}}).state("loggedIn.doctor.setting",{url:"/doctor/setting",views:{"main-content":{templateUrl:"modules/doctor/views/docSetting.html",controller:"DoctorSettingController"}}}).state("loggedIn.doctor.timetable",{url:"/doctor/timetable",views:{"main-content":{templateUrl:"modules/doctor/views/timetable.html",controller:"DoctorTimetableController"}}}).state("loggedIn.doctor.timetable.detail",{"abstract":!0,url:"/:doctorId",views:{"main-content@loggedIn.doctor":{templateUrl:"modules/doctor/views/structure-timetable.html",controller:"DoctorTimetableDetailController"}}}).state("loggedIn.doctor.timetable.detail.calendar",{url:"/calendar",views:{"main-content-timetable":{templateUrl:"modules/doctor/views/timetable-calendar.html",controller:"DoctorTimetableDetailCalendarController"}}}).state("loggedIn.doctor.timetable.detail.profile",{url:"/profile",views:{"main-content-timetable":{templateUrl:"modules/doctor/views/timetable-profile.html",controller:"DoctorTimetableDetailProfileController"}}}).state("loggedIn.doctor.timetable.detail.casual",{url:"/casual",views:{"main-content-timetable":{templateUrl:"modules/doctor/views/timetable-casual.html",controller:"DoctorTimetableDetailCasualController"}}}).state("loggedIn.doctor.timetable.detail.leave",{url:"/leave",views:{"main-content-timetable":{templateUrl:"modules/doctor/views/timetable-leave.html",controller:"DoctorTimetableDetailLeaveController"}}}).state("loggedIn.doctor.items",{url:"/doctor/items",views:{"main-content":{templateUrl:"modules/doctor/views/items.html",controller:"DoctorItemsController"}}}).state("loggedIn.doctor.items.cat",{url:"/cat",views:{"main-content@loggedIn.doctor":{templateUrl:"modules/doctor/views/items-cat.html",controller:"DoctorItemsCatController"}}}).state("loggedIn.doctor.items.add",{url:"/add",views:{"main-content@loggedIn.doctor":{templateUrl:"modules/doctor/views/items-form.html",controller:"DoctorItemsAddController"}}}).state("loggedIn.doctor.items.edit",{url:"/edit",views:{"main-content@loggedIn.doctor":{templateUrl:"modules/doctor/views/items-form.html",controller:"DoctorItemsEditController"}}}).state("loggedIn.doctor.patients",{url:"/doctor/patients",views:{"main-content":{templateUrl:"modules/doctor/views/patients.html",controller:"DoctorPatientsController"}}}).state("loggedIn.doctor.patients.detail",{url:"/detail",views:{"main-content@loggedIn.doctor":{templateUrl:"modules/doctor/views/patients-detail.html",controller:"DoctorPatientsDetailController"}}}).state("loggedIn.doctor.patients.detail.appt",{url:"/appt",views:{"main-content@loggedIn.doctor":{templateUrl:"modules/doctor/views/patients-detail-appt.html",controller:"DoctorPatientsDetailApptController"}}}).state("loggedIn.doctor.patients.detail.appt.more",{url:"/more",views:{"main-content@loggedIn.doctor":{templateUrl:"modules/doctor/views/patients-detail-appt-more.html",controller:"DoctorPatientsDetailApptMoreController"}}})}),angular.module("app.loggedIn.doctor.services",[]).factory("DoctorService",function(Restangular){var doctorService={},doctorApi=Restangular.all("api/erm"),mdtApi=Restangular.all("api/meditek/v1/doctor/");Restangular.all("api/restful"),doctorService.mdtSearch=function(options){var funcApi=mdtApi.all("search");return funcApi.post(options)},doctorService.doctor_calendar_by_date=function(doctor_id,user_id,from,to){var instanceApi=doctorApi.all("v2/doctor/calendar_by_date");return instanceApi.post({doctor_id:doctor_id,user_id:user_id,fromDate:from,toDate:to})},doctorService.getApptWorkInProgress=function(doctor_id,from,to){var instanceApi=doctorApi.all("v2/doctor/appt_work_in_progress");return instanceApi.post({doctor_id:doctor_id,fromDate:from,toDate:to})},doctorService.catItemDept=function(items){for(var newlist=[],i=0,len=items.length;len>i;++i){var item=items[i];if(0==newlist.length||newlist[newlist.length-1].cat!=item.POPULAR_HEADER_ID){var t2={cat:item.POPULAR_HEADER_ID,cattitle:item.POPULAR_NAME,list:[]};newlist.push(t2)}var t={ITEM_ID:item.ITEM_ID,ITEM_CODE:item.ITEM_CODE,ITEM_NAME:item.ITEM_NAME,PRICE:item.PRICE?item.PRICE:0,QUANTITY:item.QUANTITY?item.QUANTITY:1,TIME_SPENT:item.TIME_SPENT?item.TIME_SPENT:0,inserted:item.inserted?!0:!1,appt_item_id:item.appt_item_id,checked:item.checked?"1":"0"};newlist[newlist.length-1].list.push(t)}return newlist},doctorService.insertItemAppt=function(appt_id,patient_id,items){appt_id||console.log("MISSING INFO APPT_ID");var instanceApi=doctorApi.all("v1/appointment/insert_items");return instanceApi.post({cal_id:appt_id,patient_id:patient_id,items:items})},doctorService.updateItemAppt=function(appt_id,items){var instanceApi=doctorApi.all("v1/appointment/update_items");return instanceApi.post({cal_id:appt_id,items:items})},doctorService.deleteItemAppt=function(appt_id,patient_id,items){var instanceApi=doctorApi.all("v1/appointment/delete_items");return instanceApi.post({cal_id:appt_id,patient_id:patient_id,items:items})},doctorService.getItemAppt=function(appt_id,patient_id){var instanceApi=doctorApi.all("v1/appointment/get_items");return instanceApi.post({appt_id:appt_id,patient_id:patient_id})},doctorService.getItemByDept=function(dept_id,isenable){var instanceApi=doctorApi.one("v1/items/list_by_dept"),enable=void 0!==isenable?parseInt(isenable):1;return instanceApi.get({dept_id:dept_id,isenable:enable})},doctorService.getItemHeader=function(dept_id){var instanceApi=doctorApi.one("v1/items/get_header_by_dept");return instanceApi.get({dept_id:dept_id})},doctorService.insertItemHeader=function(dept_id,data){var instanceApi=doctorApi.all("v1/items/insert_header");return instanceApi.post({dept_id:dept_id,data:data})},doctorService.deleteItemHeader=function(dept_id,header_id){var instanceApi=doctorApi.all("v1/items/delete_header");return instanceApi.post({dept_id:dept_id,header_id:header_id})},doctorService.updateItemHeader=function(data){var instanceApi=doctorApi.all("v1/items/update_header");return instanceApi.post({data:data})},doctorService.insertItem=function(header_id,data){var instanceApi=doctorApi.all("v1/items/insert");return instanceApi.post({h_item:header_id,data:data})},doctorService.getItemByCode=function(item_id){var instanceApi=doctorApi.all("v1/items/get_item_by_id"),postData={item_id:item_id};return instanceApi.post(postData)},doctorService.editItem=function(editItem,old_header_id,new_header_id){var instanceApi=doctorApi.all("v1/items/edit_item"),postData={editItem:editItem,old_header_id:old_header_id,new_header_id:new_header_id};return instanceApi.post(postData)},doctorService.getApptById=function(appt_id){var instanceApi=doctorApi.one("v1/appointment/get_by_id");return instanceApi.get({cal_id:appt_id})},doctorService.updateAppt=function(appt_id,data){var instanceApi=doctorApi.all("v1/appointment/update"),postData={cal_id:appt_id,data:data};return console.log(postData),instanceApi.post(postData)},doctorService.listCurPatients=function(doctor_id){var instanceApi=doctorApi.one("v1/doctors/list_patients");return instanceApi.get({doctor_id:doctor_id,current:1})},doctorService.searchItem=function(option){var opt={limit:option.limit,offset:option.offset,k:option.data.name,code:option.data.code,type:option.data.type},instanceApi=doctorApi.one("v1/items/search");return instanceApi.get(opt)},doctorService.getMaxId=function(){var maxApi=doctorApi.one("doctors/getMaxId");return maxApi.get()},doctorService.update=function(options){var updateApi=doctorApi.all("doctors/update");return updateApi.post(options)},doctorService.insert=function(options){var insertApi=doctorApi.all("doctors/insert");return insertApi.post(options)},doctorService.getByUserId=function(user_id){var instanceApi=doctorApi.all("v1/doctors/by_user_id");return instanceApi.post({user_id:user_id})},doctorService.listPatients=function(option){var listApi=doctorApi.all("v1/patients/search");return listApi.post(option)},doctorService.all=function(){var allApi=doctorApi.one("doctors/list");return allApi.get()},doctorService.listByClinical=function(options){var listApi=doctorApi.all("doctors/listByClinical");return listApi.post(options)},doctorService.getById=function(id){var getApi=doctorApi.all("doctors/getById");return getApi.post({id:id})},doctorService.search=function(options){var searchApi=doctorApi.all("doctors/search");return searchApi.post({search:options})},doctorService.timetable=function(doctor_id){var timeApi=doctorApi.all("doctors/timetable");return timeApi.post({doctor_id:doctor_id})},doctorService.timetableWeekById=function(options){var timeApi=doctorApi.all("doctors/timetableWeekById");return timeApi.post(options)},doctorService.changeTimetable=function(options){var timeApi=doctorApi.all("doctors/changeTimetable");return timeApi.post(options)},doctorService.insertTimetable=function(options){var timeApi=doctorApi.all("doctors/insertTimetable");return timeApi.post(options)},doctorService.removeTimetable=function(options){var timeApi=doctorApi.all("doctors/removeTimetable");return timeApi.post(options)},doctorService.changeTimetableWeek=function(options){var timeApi=doctorApi.all("doctors/changeTimetableWeek");return timeApi.post(options)},doctorService.insertTimetableWeek=function(options){var timeApi=doctorApi.all("doctors/insertTimetableWeek");return timeApi.post(options)},doctorService.removeTimetableWeek=function(options){var timeApi=doctorApi.all("doctors/removeTimetableWeek");return timeApi.post(options)},doctorService.generateTimetable=function(data){var generateApi=doctorApi.all("doctors/generateTimetable");return generateApi.post({data:data})},doctorService.getCasualCalendar=function(data){var casualApi=doctorApi.all("doctors/getCasualCalendar");return casualApi.post(data)},doctorService.changeCasual=function(options){var casualApi=doctorApi.all("doctors/changeCasual");return casualApi.post(options)},doctorService.overviewCalendar=function(doctor_id,from_time,to_time){var api=doctorApi.all("v2/timetable/overview_doctor");return api.post({doctor_id:doctor_id,from_time:from_time,to_time:to_time})},doctorService.deleteDateCalendar=function(doctor_id,date){var api=doctorApi.all("v2/timetable/delete_date");return api.post({doctor_id:doctor_id,date:date})},doctorService.addCalendar=function(postData){var result=doctorApi.all("appointment/insert-casual-calendar");return result.post({postData:postData})},doctorService.editCalendar=function(postData){var result=doctorApi.all("appointment/edit-casual-calendar");return result.post({postData:postData})},doctorService.leaveCalendar=function(doctor_id,from_time,to_time){var api=doctorApi.all("v2/timetable/doctor_leave");return api.post({doctor_id:doctor_id,from_time:from_time,to_time:to_time})};var leaveApi=Restangular.all("api/meditek/v1/appointment");return doctorService.leaveCal=function(data){var instanceApi=leaveApi.all("leaveCal");return instanceApi.post({data:data})},doctorService.beforeLeaveCal=function(data){var instanceApi=leaveApi.all("beforePostLeaveCal");return instanceApi.post({data:data})},doctorService}),angular.module("app.loggedIn.doctor.controller",["app.loggedIn.doctor.home.controller","app.loggedIn.doctor.list.controller","app.loggedIn.doctor.setting.controller","app.loggedIn.doctor.timetable.controller","app.loggedIn.doctor.patients.controller","app.loggedIn.doctor.items.controller","app.loggedIn.doctor.add.controller","app.loggedIn.doctor.paperless.controller","app.loggedIn.doctor.fachoose.controller"]).controller("DoctorController",function($scope,$filter,$cookieStore,MODE_ROW,ConfigService,DoctorService){$scope.searchObject={limit:10,offset:0,maxSize:5,currentPage:1,data:{NAME:"",Email:"",Phone:null}},$scope.rows=MODE_ROW,$scope.searchPatientsObject={doctor_id:0,limit:10,offset:0,maxSize:5,currentPage:1,data:{First_name:"",Sur_name:"",Middle_name:"",Post_code:null}},$scope.modelDoctorObject={NAME:"",Email:"",Phone:"",Signature:"",Title:"",First_name:"",Middle_name:"",Sur_name:"",CLINICAL_DEPT_ID:null,Provider_no:0,Provider_type:"",Appt_interval:0,isReceiveEmailAfterHour:"0",Qualification_id:"",Prescriber_no:0,Sign_off:"",Payee_provider_no:0,ABN_no:0,Default_bank_account_id:"",Medical_Registration_no:0,OSHC_ID:"",isAppointmentBook:"0",Isenable:"0",isNewCalendarSlot:"0",Address:""},$scope.setClassAppt=function(type){return null===type||"ChangePers"===type?"danger":"Done"===type?"success":"NotYet"===type?"warning":"Billing"===type?"info":void 0},$scope.apptStatus=ptnConst.apptStatus,$scope.setColorAppt=function(status){return status==ptnConst.apptStatus.booking.value?"un_tn_row_blue un_tn_row_hover_blue":status==ptnConst.apptStatus.checkedIn.value?"un_tn_row_violet un_tn_row_hover_violet":status==ptnConst.apptStatus.waiting.value?"un_tn_row_red un_tn_row_hover_red":status==ptnConst.apptStatus.inConsult.value?"un_tn_row_yellow un_tn_row_hover_yellow":status==ptnConst.apptStatus.completed.value?"un_tn_row_green un_tn_row_hover_green":status==ptnConst.apptStatus.urgent.value?"un_tn_row_red un_tn_row_hover_red":"un_tn_row_blank un_tn_row_hover_blank"},$scope.views={patient_info:"modules/doctor/views/patient-info.html",paperless:"modules/doctor/views/paperless.html",patient_path:"modules/patient/views/patient/"},$scope.modeFormItem={reset:function(){$scope.isSubmit=!1,$scope.modelObjectMap={ITEM_TYPE:"Services",Prefix:""},$scope.invalid={}},validate:function(){var date_pattern=/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/,isValidDateFormat=function(date){return date&&!date_pattern.test(date)};return $scope.invalid.ITEM_START_DATE=isValidDateFormat($scope.modelObjectMap.ITEM_START_DATE),$scope.invalid.ITEM_END_DATE=isValidDateFormat($scope.modelObjectMap.ITEM_END_DATE),$scope.invalid.ITEM_END_DATE||$scope.invalid.ITEM_START_DATE?!1:!0},init:function(){$scope.modeFormItem.reset(),$scope.doctorInfo=$cookieStore.get("doctorInfo");var dept_id=$scope.doctorInfo.CLINICAL_DEPT_ID,initOption=function(){$scope.options={},ConfigService.taxes_option().then(function(data){$scope.options.taxes=data}),ConfigService.prefix_headers_option("item").then(function(data){$scope.options.prefix_headers=data}),ConfigService.provider_types_option().then(function(data){$scope.options.provider_types=data}),ConfigService.inv_uoms_option().then(function(data){$scope.options.uoms=data}),DoctorService.getItemHeader(dept_id).then(function(data){$scope.options.item_headers=data})};initOption()},submit:function(callback){var t_start=$scope.modelObjectMap.ITEM_START_DATE,t_end=$scope.modelObjectMap.ITEM_END_DATE;$scope.modelObjectMap.ITEM_START_DATE=ConfigService.getCommonDateDatabase(t_start),$scope.modelObjectMap.ITEM_END_DATE=ConfigService.getCommonDateDatabase(t_end),$scope.modelObjectMap.ITEM_START_DATE||delete $scope.modelObjectMap.ITEM_START_DATE,$scope.modelObjectMap.ITEM_END_DATE||delete $scope.modelObjectMap.ITEM_END_DATE;var arrFilter=$filter("arrGetBy"),obj=arrFilter($scope.options.prefix_headers,"PREFIX_NAME",$scope.modelObjectMap.ITEM_TYPE);$scope.modelObjectMap.Prefix=obj.PREFIX,callback()}}}),angular.module("app.loggedIn.doctor.home.controller",[]).controller("DoctorHomeController",function($scope,socket,$state,$cookieStore,DoctorService,ConfigService,localStorageService,toastr,moment,$modal){$scope.selectDate=moment().range(moment(),moment()),$scope.doctorInfo=null,$scope.userInfo=$cookieStore.get("userInfo"),$scope.list_appts=[],$scope.loadCalendar=function(){var fromDate=moment($scope.selectDate.start.format("YYYY-MM-DD")),toDate=moment($scope.selectDate.end.format("YYYY-MM-DD")),doctor_id=null!=$scope.doctorInfo?$scope.doctorInfo.doctor_id:null,user_id=$scope.userInfo.id;DoctorService.doctor_calendar_by_date(doctor_id,user_id,fromDate._i,toDate._i).then(function(data){"success"==data.status?($scope.list_appts=data.data,exlog.log($scope.list_appts),angular.forEach($scope.list_appts,function(value,key){var patientArr=[];patientArr.push(value.Title,value.First_name,value.Sur_name,value.Middle_name),value.PATIENT_NAME=patientArr.join(" ")})):(alert("error when load data."),exlog.logErr(data))},function(err){alert("error when load data."),exlog.logErr(data)})},$scope.goToApptDetail=function(item){return console.log("this is item",item),item.CAL_ID&&item.Patient_id?void $state.go("loggedIn.patient.consult",{patient_id:item.Patient_id,cal_id:item.CAL_ID}):void toastr.error("Unexpected error!","Error!")},$scope.checkIsDoctor=function(){$cookieStore.get("doctorInfo")&&$cookieStore.get("doctorInfo").doctor_id?$scope.doctorInfo=$cookieStore.get("doctorInfo"):DoctorService.getByUserId($scope.userInfo.id).then(function(data){data&&"fail"!=data.status&&($cookieStore.put("doctorInfo",{doctor_id:data.doctor_id,NAME:data.NAME,Provider_no:data.Provider_no,CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID}),$scope.doctorInfo=$cookieStore.get("doctorInfo"))}),$scope.loadCalendar()},$scope.checkIsDoctor(),socket.on("receiveNotifyDoctor",function(){$scope.checkIsDoctor()})}),angular.module("app.loggedIn.doctor.list.controller",[]).controller("DoctorListController",function($scope){$scope.doctor_panel={},$scope.doctor={},$scope.doctors={select:0,"class":function(doctor){return{selected:doctor.doco==$scope.doctors.select}},scope:$scope.doctor_panel,options:{api:"api/erm/v2/doctor/search",method:"post",scope:$scope.doctor_panel,columns:[{field:"doctor_id",is_hide:!0},{field:"NAME",label:"Full name"},{field:"Email",label:"Email"},{field:"Phone",label:"Phone"},{field:"Specialties",label:"Specialties",not_submit:!0,type:"custom",fn:function(item){if(!item.specialties||0==item.specialties.length)return"";var specialties=[];return angular.forEach(item.specialties,function(value,key){specialties.push(value.Specialties_name)}),specialties.join(", ")}}],use_filters:!0,filters:{NAME:{type:"text"},Email:{type:"text"},Phone:{type:"text"}},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(doctor){$scope.doctorEditForm.open(doctor.doctor_id)}}]}},$scope.doctorAddForm={is_show:!1,open:function(){$scope.params_doctor={permission:{create:!0,edit:!1}},this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.doctor_panel.reload()}},$scope.doctorEditForm={is_show:!1,open:function(doc_id){$scope.params_doctor={permission:{create:!1,edit:!0},id:doc_id},this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.doctor_panel.reload()}}}),angular.module("app.loggedIn.doctor.setting.controller",[]).controller("DoctorSettingController",function($scope,toastr,OnlineBookingAdminService,mdtDoctorService,DoctorService,ReceptionistService,UserService,ConfigService){$scope.userList=[],$scope.roomList=[],$scope.doctorInfo=null,$scope.room={selectedRooms:null},$scope.doctorList={"class":function(doctor){return{selected:doctor.doco==$scope.doctors.select}},scope:$scope.doctor_panel,options:{api:"api/erm/v2/doctor/search",method:"post",scope:$scope.doctor_panel,columns:[{field:"doctor_id",is_hide:!0},{field:"NAME",label:"Full name"},{field:"Email",label:"Email"},{field:"Phone",label:"Phone"},{field:"Specialties",label:"Specialties",not_submit:!0,type:"custom",fn:function(item){if(!item.specialties||0==item.specialties.length)return"";var specialties=[];return angular.forEach(item.specialties,function(value,key){specialties.push(value.Specialties_name)}),specialties.join(", ")}}],use_filters:!0,filters:{NAME:{type:"text"},Email:{type:"text"},Phone:{type:"text"}}}},DoctorService.all().then(function(rs){$scope.doctors=rs}),UserService.doctorAssistant().then(function(rs){$scope.userList=rs}),ReceptionistService.getSite().then(function(rs){"success"==rs.status&&($scope.siteList=rs.data)}),$scope.siteChange=function(siteId){$scope.roomList=[],$scope.room.selectedRooms=null,OnlineBookingAdminService.getAvailableRoom(siteId,$scope.doctorInfo.doctor_id).then(function(rs){"success"==rs.status&&($scope.roomList=rs.data,$scope.room.selectedRooms=null!=$scope.doctorInfo.rooms?$scope.doctorInfo.rooms:null)})},$scope.changeDoctor=function(item){$scope.roomList=[],$scope.room.selectedRooms=null,DoctorService.getById(item.doctor_id).then(function(rs){rs?($scope.doctorInfo=rs,$scope.doctorInfo.isOnline=1==rs.isOnline?"1":"0",OnlineBookingAdminService.getAvailableRoom($scope.doctorInfo.currentSite,item.doctor_id).then(function(rs){"success"==rs.status&&($scope.roomList=rs.data,null!=$scope.doctorInfo.rooms&&$scope.doctorInfo.rooms.length>0&&($scope.doctorInfo.rooms=JSON.parse("["+$scope.doctorInfo.rooms+"]"),$scope.room.selectedRooms=$scope.doctorInfo.rooms))})):$scope.doctorInfo=null})},$scope.submitClick=function(){$scope.room.selectedRooms.length>0?($scope.doctorInfo.rooms=[],$scope.doctorInfo.rooms=$scope.room.selectedRooms,$scope.doctorInfo.numsOfRoom=$scope.doctorInfo.rooms.length):$scope.doctorInfo.rooms=[];var postData=angular.copy($scope.doctorInfo);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));postData.Last_update_date=ConfigService.getCommonDatetime(new Date),(null==postData.numsOfRoom||""==postData.numsOfRoom)&&(postData.numsOfRoom=0),mdtDoctorService.edit($scope.doctorInfo.doctor_id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),toastr.success("Edit Successfully !!!","Success")})}}).filter("propsFilter",function(){return function(items,props){var out=[];return angular.isArray(items)?items.forEach(function(item){for(var itemMatches=!1,keys=Object.keys(props),i=0;i<keys.length;i++){var prop=keys[i],text=props[prop].toLowerCase();if(-1!==item[prop].toString().toLowerCase().indexOf(text)){itemMatches=!0;break}}itemMatches&&out.push(item)}):out=items,out}}),angular.module("app.loggedIn.doctor.add.controller",[]).controller("DoctorAddController",function($scope,$state,$cookieStore,$stateParams,toastr,ConfigService,DoctorService){$scope.newId=0;var loadOption=function(){ConfigService.clinical_option().then(function(list){$scope.options.clinicals=list}),ConfigService.provider_type_option().then(function(list){$scope.options.providers=list.list}),ConfigService.qualification_option().then(function(list){$scope.options.qualifications=list.list}),ConfigService.account_type_option().then(function(list){$scope.options.account_types=list.list})};loadOption(),$scope.modelObjectMap={};var init=function(){$scope.modelObjectMap=angular.copy($scope.modelDoctorObject),$scope.modelObjectMap.Created_by=$cookieStore.get("userInfo").id,DoctorService.getMaxId().then(function(data){$scope.newId=data.data.doctor_id+1,$scope.modelObjectMap.doctor_id=$scope.newId})};init(),$scope.isSubmit=!1,$scope.step=1,$scope.label_step="Next",$scope.prevStep=function(){$scope.step>1&&($scope.label_step="Next",$scope.step--)},$scope.nextStep=function(){switch($scope.isSubmit=!0,$scope.step){case 1:$scope.mainForm.$invalid||($scope.isSubmit=!1,$scope.step=2,$scope.label_step="Insert");break;case 2:$scope.mainForm.$invalid||($scope.isSubmit=!1,DoctorService.insert($scope.modelObjectMap).then(function(response){"success"===response.status&&(toastr.success("Insert Successfully","Success"),$scope.step=1,$scope.label_step="Next",init(),$state.go("loggedIn.doctor.timetable.detail.profile",{doctorId:$scope.newId}))}))}}}),angular.module("app.loggedIn.doctor.timetable.controller",["app.loggedIn.doctor.timetable.detail.controller"]).controller("DoctorTimetableController",function($scope,$state){$scope.$watch("itemUpdate",function(newItem){"undefined"!=typeof newItem&&newItem===!0&&(angular.element("#TimetableDoctorAdd").fadeOut(),$state.go("loggedIn.doctor.timetable",null,{reload:!0}),$scope.itemUpdate=!1)}),$scope.params_doctor_add={permission:{create:!0,popup:!0},popupId:"TimetableDoctorAdd"},$scope.relationships={specialties:{count:0}},$scope.openPopup=function(option){if("doctor"===option.module)switch(option.type){case"add":angular.element("#"+$scope.params_doctor_add.popupId).fadeIn()}},$scope.accordion={oneAtATime:!1,specialties:!0},$scope.selectedDoctor={},$scope.selectDoctor=function(row){$scope.selectedDoctor=row,$state.go("loggedIn.doctor.timetable.detail.calendar",{doctorId:$scope.selectedDoctor.doctor_id})}}),angular.module("app.loggedIn.doctor.timetable.detail.controller",["app.loggedIn.doctor.timetable.detail.calendar.controller","app.loggedIn.doctor.timetable.detail.profile.controller","app.loggedIn.doctor.timetable.detail.casual.controller","app.loggedIn.doctor.timetable.detail.leave.controller"]).controller("DoctorTimetableDetailController",function($scope,$state,$stateParams,DoctorService,ConfigService){$scope.modelDetail={};var loadDetail=function(){DoctorService.getById($stateParams.doctorId).then(function(detail){$scope.modelDetail=detail})};loadDetail(),$scope.getActive=function(state){return state===$state.current.name?"active":""}}),angular.module("app.loggedIn.doctor.timetable.detail.calendar.controller",[]).controller("DoctorTimetableDetailCalendarController",function($scope){}),angular.module("app.loggedIn.doctor.timetable.detail.profile.controller",[]).controller("DoctorTimetableDetailProfileController",function($scope,$stateParams,toastr,ConfigService,DoctorService,PatientService){$scope.params={permission:{create:!1,edit:!0},id:$stateParams.doctorId};var loadOption=function(){ConfigService.clinical_option().then(function(list){$scope.options.clinicals=list}),ConfigService.provider_type_option().then(function(list){$scope.options.providers=list.list}),ConfigService.qualification_option().then(function(list){$scope.options.qualifications=list.list}),ConfigService.account_type_option().then(function(list){$scope.options.account_types=list.list})};loadOption(),$scope.getImage=function(image){PatientService.getSkinApp(image).then(function(response){})},$scope.modelObjectMap={};var sign_map="",init=function(){$scope.modelObjectMap=angular.copy($scope.modelDoctorObject),DoctorService.getById($stateParams.doctorId).then(function(detail){angular.extend($scope.modelObjectMap,detail),sign_map=$scope.modelObjectMap.Signature,$scope.modelObjectMap.isReceiveEmailAfterHour&&($scope.modelObjectMap.isReceiveEmailAfterHour=$scope.modelObjectMap.isReceiveEmailAfterHour.toString()),$scope.modelObjectMap.isAppointmentBook&&($scope.modelObjectMap.isAppointmentBook=$scope.modelObjectMap.isAppointmentBook.toString()),$scope.modelObjectMap.isNewCalendarSlot&&($scope.modelObjectMap.isNewCalendarSlot=$scope.modelObjectMap.isNewCalendarSlot.toString()),$scope.modelObjectMap.Isenable&&($scope.modelObjectMap.Isenable=$scope.modelObjectMap.Isenable.toString())})};init(),$scope.isSubmit=!1,$scope.step=1,$scope.label_step="Next",$scope.prevStep=function(){$scope.step>1&&($scope.label_step="Next",$scope.step--)},$scope.nextStep=function(){switch($scope.isSubmit=!0,$scope.step){case 1:$scope.mainForm.$invalid||($scope.isSubmit=!1,$scope.step=2,$scope.label_step="Update");break;case 2:$scope.mainForm.$invalid||($scope.isSubmit=!1,DoctorService.update($scope.modelObjectMap).then(function(response){"success"===response.status&&(toastr.success("Updated Successfully","Success"),$scope.step=1,$scope.label_step="Next",init())}))}},$scope.resetSignature=function(){$scope.modelObjectMap.Signature=sign_map},$scope.clearSignature=function(){$scope.modelObjectMap.Signature=""}}),angular.module("app.loggedIn.doctor.timetable.detail.leave.controller",[]).controller("DoctorTimetableDetailLeaveController",function($scope,$state,$stateParams,DoctorService,ConfigService,mdtDoctorService,mdtTimetableService,sysServiceService,REAL_DAY_OF_WEEK,toastr,$modal){$scope.list_day_of_week=[{value:"Monday"},{value:"Tuesday"},{value:"Wednesday"},{value:"Thursday"},{value:"Friday"},{value:"Saturday"}];var submitLeave=function(){ConfigService.beforeSave($scope.leave.errors);var postData=angular.copy($scope.leave.form);postData.from_date=ConfigService.convertToDB(postData.from_date),postData.to_date=ConfigService.convertToDB(postData.to_date),postData.doctor_id=$stateParams.doctorId;var modalInstance=$modal.open({templateUrl:"notifyToLeaveCalendar",controller:function($scope,postData,$modalInstance){$scope.fromDateDisplay=moment(postData.from_date,"YYYY-MM-DD").format("DD/MM/YYYY"),$scope.toDateDisplay=moment(postData.to_date,"YYYY-MM-DD").format("DD/MM/YYYY"),DoctorService.beforeLeaveCal(postData).then(function(data){"success"==data.status?$scope.bookedList=data.data:toastr.error("Fail.")},function(err){toastr.error("Fail.")}),$scope.ok=function(){$modalInstance.close(postData)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{postData:function(){return postData}}});modalInstance.result.then(function(postData){postData&&DoctorService.leaveCal(postData).then(function(response){"success"==response.status?toastr.success("Success."):toastr.error("Fail.")},function(error){toastr.error("Fail."),$scope.leave.errors=error.data.errors,ConfigService.beforeError($scope.leave.errors)})})};$scope.leave={form:{from_date:null,to_date:null,doctor_id:""},errors:[],submitLeave:function(){submitLeave()}}}),angular.module("app.loggedIn.doctor.paperless.controller",[]).controller("DoctorPaperlessController",function($scope,$state,$modal,DocumentService,PatientService,$stateParams,localStorageService){var patient_id=$scope.patient_id=$stateParams.patient_id,cal_id=$scope.cal_id=$stateParams.cal_id;PatientService.get(patient_id).then(function(response){response.data&&localStorageService.set("tempPatient",response.data)}),$scope.navigator.add_general=function(){var params={patient_id:patient_id,cal_id:cal_id},str_state="loggedIn."+$scope.tab;$state.go(str_state,params)},$scope.faNewClick=function(){$modal.open({animation:!0,templateUrl:"modules/doctor/views/fachooseModal.html",
controller:"FaChooseController"})},$scope.OptionGorgonMA=DocumentService.optionGorgonMA(patient_id),$scope.OptionGorgonFA=DocumentService.optionGorgonFA(patient_id),$scope.OptionGorgonUQ=DocumentService.optionGorgonUQ(patient_id),$scope.OptionGorgonMH=DocumentService.optionGorgonMH(patient_id),$scope.OptionMRS=DocumentService.optionMRS(patient_id),$scope.OptionFA=DocumentService.OptionFA(patient_id),$scope.OptionMA=DocumentService.OptionMA(patient_id),$scope.OptionCategory2=DocumentService.optionCategory2(patient_id),$scope.OptionCategory3=DocumentService.optionCategory3(patient_id),$scope.OptionIDS=DocumentService.OptionIDS(patient_id),$scope.Optionform18=DocumentService.Optionform18(patient_id),$scope.OptionSA1=DocumentService.OptionSA1(patient_id),$scope.OptionSA2=DocumentService.OptionSA2(patient_id),$scope.OptionMH=DocumentService.OptionMH(patient_id),$scope.OptionCOE=DocumentService.OptionCOE(patient_id)}),angular.module("app.loggedIn.doctor.timetable.detail.casual.controller",[]).controller("DoctorTimetableDetailCasualController",function($scope,$stateParams,DoctorService,ConfigService,mdtDoctorService,mdtTimetableService,sysServiceService,REAL_DAY_OF_WEEK,toastr,TimetableModel,$modal){var doctor_id=$stateParams.doctorId;$scope.objectMap={},$scope.objectMap.from_time=moment(new Date).toDate(),$scope.objectMap.to_time=moment(new Date).add(30,"days").toDate(),$scope.timetable={add:function(item){if(!item.list[0]||null!==item.list[0].CAL_ID){var object={CAL_ID:null,SITE_ID:1,DOCTOR_ID:doctor_id,FROM_TIME:"00:00",TO_TIME:"00:00",SERVICE_ID:1};item.list.push(object)}},addRowData:function(item,cal){var from_time_part=moment(cal.FROM_TIME,"HHmm").format("HH:mm"),to_time_part=moment(cal.TO_TIME,"HHmm").format("HH:mm"),from_time=moment(item.DATE).format("YYYY-MM-DD")+" "+from_time_part+":00",to_time=moment(item.DATE).format("YYYY-MM-DD")+" "+to_time_part+":00",options={FROM_TIME:from_time,TO_TIME:to_time,SITE_ID:cal.SITE_ID,DOCTOR_ID:$stateParams.doctorId,CLINICAL_DEPT_ID:$scope.doctor.CLINICAL_DEPT_ID,SERVICE_ID:cal.SERVICE_ID};DoctorService.addCalendar(options).then(function(response){toastr.success("Add successfully !!!"),cal.CAL_ID=response.data},function(err){})},updateRow:function(item,cal){var from_time_part=moment(cal.FROM_TIME,"HHmm").format("HH:mm"),to_time_part=moment(cal.TO_TIME,"HHmm").format("HH:mm"),from_time=moment(item.DATE).format("YYYY-MM-DD")+" "+from_time_part+":00",to_time=moment(item.DATE).format("YYYY-MM-DD")+" "+to_time_part+":00",options={FROM_TIME:from_time,TO_TIME:to_time,SITE_ID:cal.SITE_ID,SERVICE_ID:cal.SERVICE_ID,CAL_ID:cal.CAL_ID};DoctorService.editCalendar(options).then(function(response){console.log(response),"success"==response.status?toastr.success("Edit successfully !!!"):toastr.error("Edit fail !!!")})},remove:function(options){if(null===options.cal.CAL_ID)$scope.data[options.parentIndex].list.splice(options.index,1);else{TimetableModel.beforeDeleteSelectedCalendar(options.cal.CAL_ID).then(function(data){if("success"==data.status){var bookedList=data.data,modalInstance=$modal.open({templateUrl:"notifyToDeleteSelectedCalendar",controller:function($scope,bookedList,$modalInstance){$scope.bookedList=bookedList,$scope.ok=function(){$modalInstance.close(bookedList)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{bookedList:function(){return bookedList}}});modalInstance.result.then(function(bookedList){bookedList&&executeDelete()})}else toastr.error("Delete fail.")},function(err){toastr.error("Delete fail.")});var executeDelete=function(){TimetableModel.deleteSelectedCalendar(options.cal.CAL_ID).then(function(data){"success"==data.status?(toastr.success("Delete success."),$scope.data[options.parentIndex].list.splice(options.index,1)):toastr.error("Delete fail.")},function(err){toastr.error("Delete fail.")})}}},removeAllDay:function(item){var postData={doctorId:doctor_id,date:item.DATE},modalInstance=$modal.open({templateUrl:"notifyToDeleteAllCalendarInDate",controller:function($scope,item,$modalInstance){TimetableModel.beforeDeleteAllCalendarInDate(postData).then(function(data){"success"==data.status?$scope.bookedList=data.data:toastr.error("Delete fail.")},function(err){toastr.error("Delete fail.")}),$scope.ok=function(){$modalInstance.close(item)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{item:function(){return item}}});modalInstance.result.then(function(item){item&&TimetableModel.deleteAllCalendarInDate(postData).then(function(data){"success"==data.status?(item.list=[],toastr.success("Delete success.")):toastr.error("Delete fail.")},function(err){toastr.error("Delete fail.")})})},getAllCalendarInDate:function(item){var postData={doctorId:doctor_id,date:item.DATE},updateData={DOCTOR_ID:doctor_id},modalInstance=$modal.open({templateUrl:"changeServiceOfCalendarsInDate",controller:function($scope,$modalInstance,$stateParams){$scope.updateData=updateData,$scope.doctor={},mdtDoctorService.byId($stateParams.doctorId).then(function(response){$scope.doctor=response.data,sysServiceService.byClinicalDepartment(response.data.CLINICAL_DEPT_ID).then(function(response){$scope.services=response.data})}),TimetableModel.getAllCalendarInDate(postData).then(function(data){"success"==data.status?$scope.calendarsInDate=data.data:toastr.error("Error when get data.")},function(err){toastr.error("Error when get data.")}),$scope.ok=function(){$modalInstance.close(updateData)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{updateData:function(){return updateData}}});modalInstance.result.then(function(updateData){updateData&&TimetableModel.updateServiceInDate(updateData).then(function(data){"success"==data.status?($scope.getAppointments(),toastr.success("Update success.")):toastr.error("Update fail.")},function(err){toastr.error("Update fail.")})})}},$scope.getAppointments=function(){toastr.info("Loading data from server");var str_from_time=moment($scope.objectMap.from_time).format("YYYY-MM-DD"),str_to_time=moment($scope.objectMap.to_time).format("YYYY-MM-DD"),get_date=new Date(str_from_time),get_to_date=new Date(str_to_time),timeDiff=Math.abs(get_to_date.getTime()-get_date.getTime()),num_date=Math.ceil(timeDiff/864e5)+1;if(console.log(num_date),console.log(timeDiff),1>num_date)return void alert("To time must be greater then from time");for(var cal_list=[],i=0;cal_list.length<num_date;++i){var run_date=new Date(get_date);run_date.setDate(get_date.getDate()+i);var str_date=run_date;cal_list.push({DATE:str_date,list:[]})}$scope.data=cal_list,DoctorService.overviewCalendar(doctor_id,str_from_time,str_to_time).then(function(response){for(var cal_list=response.data,i=0;i<cal_list.length;++i){var cal=cal_list[i],pos=_.findIndex($scope.data,function(item){return moment(item.DATE).format("DD/MM/YYYY")==cal.DATE});-1!==pos&&($scope.data[pos].list=cal.list)}})},$scope.getAppointments(),$scope.doctor={},mdtDoctorService.byId($stateParams.doctorId).then(function(response){$scope.doctor=response.data,sysServiceService.byClinicalDepartment(response.data.CLINICAL_DEPT_ID).then(function(response){$scope.options.clinical_depts=response.data})})}),angular.module("app.loggedIn.doctor.patients.controller",["app.loggedIn.doctor.patients.detail.controller"]).controller("DoctorPatientsController",function($scope,$state,$cookieStore,DoctorService,localStorageService,CompanyModel){var userInfo=$cookieStore.get("userInfo");$cookieStore.get("doctorInfo"),$scope.isFilterBelowDoctor=1,$scope.reset=function(){$scope.searchObjectMap=angular.copy($scope.searchPatientsObject),$scope.loadList()},$scope.loadList=function(){DoctorService.getByUserId(userInfo.id).then(function(data){1==$scope.isFilterBelowDoctor?$scope.searchObjectMap.doctor_id=data.doctor_id:delete $scope.searchObjectMap.doctor_id,DoctorService.listPatients($scope.searchObjectMap).then(function(response){console.log(response),$scope.list=response})})},$scope.setPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.loadList()},$scope.goToTimetableDetail=function(list){localStorageService.set("patientTempInfo",list);var postData={datetime:moment().format("YYYY-MM-DD hh:mm:ss"),patient_id:list.Patient_id};CompanyModel.getFromTime(postData).then(function(response){-1==response.data?$state.go("loggedIn.patient.appointment",{patient_id:list.Patient_id,cal_id:-1}):$state.go("loggedIn.patient.appointment",{patient_id:list.Patient_id,cal_id:response.data.CAL_ID})},function(error){})};var init=function(){$scope.searchObjectMap=angular.copy($scope.searchPatientsObject),$scope.list=[],$scope.loadList()};init()}),angular.module("app.loggedIn.doctor.patients.detail.controller",["app.loggedIn.doctor.patients.detail.appt.controller"]).controller("DoctorPatientsDetailController",function($scope,$state,$cookieStore,DoctorService,PatientService,localStorageService){$scope.goToApptDetail=function(row){var cal_id=row.CAL_ID,patient_id=$scope.patient.Patient_id;$state.go("loggedIn.patient.appointment",{patient_id:patient_id,cal_id:cal_id})};var doctorInfo=$cookieStore.get("doctorInfo"),init=function(){if(!doctorInfo)return void $state.go("loggedIn.doctor.patients");var doctor_id=doctorInfo.doctor_id;$scope.patient=localStorageService.get("patientTempInfo"),$scope.patient||$state.go("loggedIn.doctor.home"),PatientService.getAppointment($scope.patient.Patient_id,doctor_id).then(function(data){$scope.list_appt=data}),PatientService.getById($scope.patient.Patient_id).then(function(data){$scope.patient=data})};init()}),angular.module("app.loggedIn.doctor.patients.detail.appt.controller",["app.loggedIn.doctor.patients.detail.appt.more.controller"]).controller("DoctorPatientsDetailApptController",function($scope,$filter,$state,toastr,$cookieStore,ConfigService,DoctorService,PatientService,localStorageService){alert("form nay khong con su dung [tannv.dts@gmail.com]"),$scope.patient_detail_modules=[{name:"Patient",color:"blue-soft",desc:"Info",icon:"fa fa-user"},{name:"Companies",color:"red-soft",desc:"Total: 12",icon:"fa fa-building"},{name:"Claim",color:"green-soft",desc:"Available",icon:"fa fa-newspaper-o"},{name:"Outside Referral",color:"purple-soft",desc:"Total: 12",icon:"fa fa-envelope-o"}],$scope.patient_apt_modules=[{name:"Appointment",icon:"fa fa-bookmark-o",color:"blue soft",desc:"Info"},{name:"Paperless",icon:"fa fa-pencil-square-o",color:"red soft",desc:"Total: 12"},{name:"Workcover",icon:"fa fa-paper-plane-o",color:"green-soft",desc:"Has: 2"},{name:"Script, Referral",icon:"fa fa-envelope-square",color:"purple-soft",desc:"Has: 2"}],$scope.doctor_detail={permission:{create:"no"},Patient_id:localStorageService.get("patientTempInfo").Patient_id};var arrGetBy=$filter("arrGetBy"),active_item=function(){for(var i=0;i<$scope.list_appt_item.length;++i){var appt_item=$scope.list_appt_item[i],t_item=arrGetBy($scope.list_dept_item,"ITEM_ID",appt_item.ITEM_ID);t_item?(t_item.checked="1",t_item.inserted=!0,t_item.appt_item_id=appt_item.appt_item_id,t_item.QUANTITY=appt_item.QUANTITY?appt_item.QUANTITY:1):(t_item=arrGetBy($scope.extra_list,"ITEM_ID",appt_item.ITEM_ID),t_item?(t_item.chosen=!1,t_item.appt_item_id=appt_item.appt_item_id,t_item.QUANTITY=appt_item.QUANTITY?appt_item.QUANTITY:1):(appt_item.checked="1",appt_item.chosen=!1,$scope.extra_list.push(appt_item)))}for(var i=0;i<$scope.extra_list.length;++i){var extra_item=$scope.extra_list[i],t_item=arrGetBy($scope.list_dept_item,"ITEM_ID",extra_item.ITEM_ID);t_item&&$scope.extra_list.splice(i,1)}$scope.item_list=DoctorService.catItemDept($scope.list_dept_item),delete $scope.list_dept_item,delete $scope.list_appt_item},init=function(){$scope.patient=localStorageService.get("patientTempInfo"),$scope.patient||$state.go("loggedIn.doctor.home"),PatientService.getById($scope.patient.Patient_id).then(function(data){$scope.modelObjectMap=data,localStorageService.set("tempPatient",data),$scope.modelObjectMap.DOB=ConfigService.getCommonDateDefault($scope.modelObjectMap.DOB),$scope.modelObjectMap.Exp_medicare=ConfigService.getCommonDateDefault($scope.modelObjectMap.Exp_medicare),$scope.modelObjectMap.Exp_pension=ConfigService.getCommonDateDefault($scope.modelObjectMap.Exp_pension)});var doctorInfo=$cookieStore.get("doctorInfo");$scope.apptInfo=localStorageService.get("apptTempInfo"),DoctorService.getApptById($scope.apptInfo.CAL_ID).then(function(data){$scope.apptInfo=data,localStorageService.set("tempAppt",data),$scope.apptChange={},$scope.apptChange.NOTES=data.NOTES,$scope.apptChange.APP_TYPE=data.APP_TYPE}),$scope.options.app_status=ConfigService.appt_status_option();var extra_list=localStorageService.get("itemsTempList");extra_list?($scope.extra_list=extra_list,localStorageService.remove("itemsTempList")):$scope.extra_list=[],DoctorService.getItemByDept(doctorInfo.CLINICAL_DEPT_ID).then(function(data){return $scope.list_dept_item=data,DoctorService.getItemAppt($scope.apptInfo.CAL_ID)}).then(function(data){$scope.list_appt_item=data,active_item()},function(err){console.error(err),toastr.error("Error, please Refresh Page !!!","Error")})};init();var reloadpage=function(){$state.go($state.current,{},{reload:!0})};$scope.saveItemsheet=function(){var insert_list=[],update_list=[],delete_list=[];for(var key in $scope.item_list){var cat=$scope.item_list[key];for(var key2 in cat.list){var item=cat.list[key2];item.inserted?"1"==item.checked?update_list.push({appt_item_id:item.appt_item_id,QUANTITY:item.QUANTITY}):delete_list.push(item.ITEM_ID):"1"==item.checked&&insert_list.push({CLN_ITEM_ID:item.ITEM_ID,QUANTITY:item.QUANTITY})}}for(var i=0,len=$scope.extra_list.length;len>i;++i){var item=$scope.extra_list[i];({CLN_ITEM_ID:item.ITEM_ID,QUANTITY:item.QUANTITY}),item.chosen&&"1"==item.checked?insert_list.push({CLN_ITEM_ID:item.ITEM_ID,QUANTITY:item.QUANTITY}):"1"==item.checked?update_list.push({appt_item_id:item.appt_item_id,QUANTITY:item.QUANTITY}):delete_list.push(item.ITEM_ID)}submitItemSheet(insert_list,update_list,delete_list)};var submitItemSheet=function(insert_list,update_list,delete_list){var cal_id=$scope.apptInfo.CAL_ID,is_insert=0==insert_list.length,is_delete=0==delete_list.length,is_update=0==update_list.length;is_insert||DoctorService.insertItemAppt(cal_id,insert_list).then(function(data){is_insert=!0,is_delete&&is_update&&(reloadpage(),toastr.success("Save Successfully!!!","Success"))}),is_delete||DoctorService.deleteItemAppt(cal_id,delete_list).then(function(data){is_delete=!0,is_insert&&is_update&&(reloadpage(),toastr.success("Save Successfully!!!","Success"))}),is_update||DoctorService.updateItemAppt(cal_id,update_list).then(function(data){is_update=!0,is_delete&&is_insert&&(reloadpage(),toastr.success("Save Successfully!!!","Success"))})};$scope.saveAppt=function(){console.log($scope.apptChange);var obj=arrGetBy($scope.options.app_status,"code",$scope.apptChange.APP_TYPE);return null==obj?void toastr.error("Cannot set status of appointment !!!","Error"):($scope.apptChange.STATUS=obj.title,void DoctorService.updateAppt($scope.apptInfo.CAL_ID,$scope.apptChange).then(function(res){return"success"!=res.status?void toastr.error("Cannot update this Appointment !!!","Error"):void toastr.success("Update Successfully!!!","Success")}))},$scope.updateCompany=function(company){PatientService.update({Patient_id:$scope.patient.Patient_id,company_id:company.id}).then(function(data){"success"==data.status&&(toastr.success("Save Successfully!!!","Success"),reloadpage()),console.log(data)})},$scope.company_search_options={api:"api/erm/v2/companies/search",method:"post",columns:[{field:"id",is_hide:!0},{field:"Company_name",label:"Company Name"},{field:"Industry"}],use_filters:!0,filters:{Company_name:{type:"text"},Industry:{type:"text"}}},$scope.chooseCompany=function(item){console.log(item),$scope.updateCompany(item)},$scope.show_company_form=!1,$scope.show_company_search=!1,$scope.openCompanySearch=function(){$scope.show_company_search=!0},$scope.closeCompanySearch=function(){$scope.show_company_search=!1},$scope.openCompanyForm=function(){$scope.show_company_form=!0},$scope.closeCompanyForm=function(){$scope.show_company_form=!1}}),angular.module("app.loggedIn.doctor.patients.detail.appt.more.controller",[]).controller("DoctorPatientsDetailApptMoreController",function($scope,$filter,$state,toastr,$cookieStore,ConfigService,DoctorService,localStorageService){var arrGetBy=$filter("arrGetBy");$scope.loadList=function(){DoctorService.searchItem($scope.searchObjectMap).then(function(data){for(var i=0,len=data.list.length;len>i;++i)data.list[i].chosen=arrGetBy($scope.chosenItems,"ITEM_ID",data.list[i].ITEM_ID)?!0:!1;$scope.data=data})},$scope.setPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.loadList()},$scope.setPageLimit=function(){$scope.searchObjectMap.offset=0,$scope.searchObjectMap.currentPage=1,$scope.loadList()},$scope.reset=function(){$scope.searchObjectMap={limit:10,offset:0,maxSize:5,currentPage:1,data:{name:"",code:"",type:""}},$scope.chosenItems=[],$scope.loadList()};var init=function(){$scope.patient=localStorageService.get("patientTempInfo"),$scope.options={},$scope.patient||$state.go("loggedIn.doctor.home"),ConfigService.prefix_headers_option("item").then(function(data){$scope.options.prefixs=data}),$scope.reset()};init(),$scope.removeItem=function(item,index){var t=arrGetBy($scope.data.list,"ITEM_ID",item.ITEM_ID);t&&(t.chosen=!1),$scope.chosenItems.splice(index,1)},$scope.chooseItem=function(item){item.chosen=!0,$scope.chosenItems.push(item),console.log($scope.chosenItems)},$scope.submit=function(){$scope.chosenItems.length>0&&localStorageService.set("itemsTempList",$scope.chosenItems),$state.go("loggedIn.doctor.patients.detail.appt")}}),angular.module("app.loggedIn.doctor.items.controller",["app.loggedIn.doctor.items.cat.controller","app.loggedIn.doctor.items.add.controller","app.loggedIn.doctor.items.edit.controller"]).controller("DoctorItemsController",function($scope,$state,$cookieStore,DoctorService,localStorageService){console.log("ITEMS PAGE "),$scope.objectMap={},$scope.navigateEdit=function(item){var updateMode={isUpdateMode:!0,item_id:item.ITEM_ID,header_code:item.POPULAR_HEADER_ID};localStorageService.set("updateData",updateMode),$state.go("loggedIn.doctor.items.edit")};var init=function(){$scope.doctorInfo=$cookieStore.get("doctorInfo");var dept_id=$scope.doctorInfo.CLINICAL_DEPT_ID;DoctorService.getItemByDept(dept_id,!1).then(function(data){console.log(data),$scope.item_list=data}),DoctorService.getItemHeader(dept_id).then(function(data){$scope.optCat=data,$scope.optCat.unshift({POPULAR_HEADER_ID:"",POPULAR_NAME:"-- All Categories --"})}),$scope.optEnable=[{code:"",title:"All"},{code:"1",title:"Enable"},{code:"0",title:"Disable"}],$scope.searchObj={ISENABLE:"1",POPULAR_HEADER_ID:""}};init()}),angular.module("app.loggedIn.doctor.items.add.controller",[]).controller("DoctorItemsAddController",function($scope,$cookieStore,toastr,ConfigService,DoctorService){var init=function(){$scope.info={action:"Add"},$scope.modeFormItem.init()},submitForm=function(){var header_id=$scope.POPULAR_HEADER_ID;console.log("DATA SUBMIT ",$scope.modelObjectMap),DoctorService.insertItem(header_id,$scope.modelObjectMap).then(function(data){"success"==data.status?(toastr.success("Insert Successfully!!!","Success"),$scope.modeFormItem.reset(),$scope.isSubmit=!1):($scope.modelObjectMap.ITEM_START_DATE="",$scope.modelObjectMap.ITEM_END_DATE="")})};$scope.save=function(){return $scope.isSubmit=!0,$scope.mainForm.$invalid||!$scope.modeFormItem.validate()?void toastr.error("Please Check Your Information !!!","Error"):void $scope.modeFormItem.submit(submitForm)},init()}),angular.module("app.loggedIn.doctor.items.edit.controller",[]).controller("DoctorItemsEditController",function($scope,$state,toastr,localStorageService,ConfigService,DoctorService){var old_header_id="",getData=function(item_id){DoctorService.getItemByCode(item_id).then(function(data){console.log(data),"success"==data.status?(console.log(data),data.result[0].ITEM_START_DATE=ConfigService.getCommonDateDefault(data.result[0].ITEM_START_DATE),data.result[0].ITEM_END_DATE=ConfigService.getCommonDateDefault(data.result[0].ITEM_END_DATE),angular.extend($scope.modelObjectMap,data.result[0])):toastr.error("Something happened!","Error")})},init=function(){$scope.modeFormItem.init(),$scope.isSubmit=!1,$scope.info={action:"Edit"};var updateMode=localStorageService.get("updateData");$scope.inUpdateMode=updateMode.isUpdateMode,null!=updateMode&&void 0!=updateMode&&null!=updateMode.item_id&&""!=updateMode.item_id&&void 0!=updateMode.item_id&&(getData(updateMode.item_id),$scope.POPULAR_HEADER_ID=updateMode.header_code,old_header_id=updateMode.header_code)},submitForm=function(){var new_header_id=$scope.POPULAR_HEADER_ID;console.log("DATA SUBMIT ",$scope.modelObjectMap),DoctorService.editItem($scope.modelObjectMap,old_header_id,new_header_id).then(function(data){"success"==data.status&&(toastr.success("Update Successfully!!!","Success"),$state.go("loggedIn.doctor.items"))})};$scope.editItem=function(){return $scope.isSubmit=!0,$scope.mainForm.$invalid||!$scope.modeFormItem.validate()?void toastr.error("Please Check Your Information !!!","Error"):(delete $scope.modelObjectMap.CREATION_DATE,delete $scope.modelObjectMap.Last_update_date,delete $scope.modelObjectMap.BENEFIT_START_DATE,delete $scope.modelObjectMap.EMSN_START_DATE,delete $scope.modelObjectMap.EMSN_END_DATE,delete $scope.modelObjectMap.EMSN_CHANGE_DATE,delete $scope.modelObjectMap.EMSN_CHANGE_DATE,delete $scope.modelObjectMap.DERIVED_FEE_START_DATE,delete $scope.modelObjectMap.DESCRIPTION_START_DATE,delete $scope.modelObjectMap.QFE_START_DATE,delete $scope.modelObjectMap.QFE_END_DATE,void $scope.modeFormItem.submit(submitForm))},init()}),angular.module("app.loggedIn.doctor.items.cat.controller",[]).controller("DoctorItemsCatController",function($scope,$cookieStore,DoctorService,toastr){$scope.validateCat=function(cat){return""!=cat.POPULAR_CODE.trim()&&""!=cat.POPULAR_NAME.trim()},$scope.resetNewCat=function(){$scope.isNewCat=!1,$scope.newCatObj=angular.copy($scope.newCat)},$scope.setNewCat=function(){$scope.isNewCat=!0},$scope.saveNewCat=function(){return $scope.validateCat($scope.newCatObj)?void DoctorService.insertItemHeader($scope.doctorInfo.CLINICAL_DEPT_ID,$scope.newCatObj).then(function(data){console.log(data),"success"==data.status&&($scope.newCatObj.POPULAR_HEADER_ID=data.header_id,$scope.list_cat.push($scope.newCatObj),$scope.resetNewCat(),toastr.success("Insert Successfully !!!","Success"))}):void toastr.error("Please Fill All Information !!!","Error")},$scope.saveEditCat=function(){return $scope.validateCat($scope.editCatObj)?void DoctorService.updateItemHeader($scope.editCatObj).then(function(data){console.log(data),"success"==data.status?(toastr.success("Update Successfully !!!","Success"),$scope.list_cat[$scope.editIndex]=angular.copy($scope.editCatObj),$scope.isEditCat=!1):toastr.error(data.message,"Error")}):void toastr.error("Please Fill All Information !!!","Error")},$scope.setEditCat=function(index){var item=$scope.list_cat[index];$scope.editIndex=index,$scope.editCatObj=angular.copy(item),$scope.editCatObj.ISENABLE+="",$scope.isEditCat=!0},$scope.setDeleteCat=function(item,index){var x=confirm("Do you really want to delete ?");x&&DoctorService.deleteItemHeader($scope.doctorInfo.CLINICAL_DEPT_ID,item.POPULAR_HEADER_ID).then(function(data){console.log(data),"success"==data.status?(toastr.success("Delete Successfully !!!","Success"),$scope.list_cat.splice(index,1)):toastr.error(data.message,"Error")})};var init=function(){$scope.doctorInfo=$cookieStore.get("doctorInfo"),DoctorService.getItemHeader($scope.doctorInfo.CLINICAL_DEPT_ID).then(function(data){console.log(data),$scope.list_cat=data}),$scope.newCat={POPULAR_CODE:"",POPULAR_NAME:"",ISENABLE:"1"},$scope.isEditCat=!1,$scope.resetNewCat()};init()}),angular.module("app.loggedIn.doctor.fachoose.controller",[]).controller("FaChooseController",function($scope,$stateParams,$state){var patient_id=$scope.patient_id=$stateParams.patient_id,cal_id=$scope.cal_id=$stateParams.cal_id;$scope.fa_panel={},$scope.fa={select:0,scope:$scope.fa_panel,options:{api:"api/erm/v2/fa/fa_choose_search",method:"post",scope:$scope.fa_panel,columns:[{field:"FA_ID",is_hide:!0},{field:"TYPE",label:"Type"},{field:"FA_NAME",label:"Name"}],search:{patient_id:patient_id,cal_id:cal_id},use_filters:!0,filters:{TYPE:{type:"text"},FA_NAME:{type:"text"}}}},$scope.clickRow=function(item){console.log("this is choosen item",item);var params={patient_id:patient_id,cal_id:cal_id,fa_id:item.FA_ID},str_state="loggedIn.FA";$state.go(str_state,params)}}),angular.module("app.loggedIn.doctor.directives",["app.loggedIn.doctor.list.directive","app.loggedIn.doctor.search.directive","app.loggedIn.doctor.itemsearch.directive"]),angular.module("app.loggedIn.doctor.search.directive",[]).directive("doctorSearch",function(DoctorService){return{restrict:"EA",scope:{clickRow:"&",isClose:"@"},templateUrl:"modules/doctor/directives/templates/search.html",link:function(scope,element,attrs){if(scope.list={},scope.isClose)var idClose="#"+scope.isClose;scope.params={pagination:{limit:10,offset:0,current_page:1,max_size:5},filters:[{type:"text",name:"NAME",value:""},{type:"text",name:"Email",value:""}],select:["doctor_id","NAME","Email"]},scope.closePopup=function(){angular.element(idClose).fadeOut()};var loadList=function(){DoctorService.mdtSearch(scope.params).then(function(response){"success"===response.status&&(scope.list=response)},function(error){alert("Error Server")})};loadList(),scope.refreshList=function(){loadList()},scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.doctor.list.directive",[]).directive("doctorList",function(){return{restrict:"EA",scope:{},templateUrl:"modules/doctor/directives/templates/list.html",link:function(scope,element,attrs){scope.data_options={api:"api/erm/doctors/search",method:"post",columns:[{field:"doctor_id",is_hide:!0},{field:"NAME",label:"Doctor Name"},{field:"Email",label:"Email"}],show_index:!0,use_filters:!0,filters:{NAME:{type:"text"},Email:{type:"text"}}},scope.clickRow=function(item){console.log(item)}}}}),angular.module("app.loggedIn.doctor.itemsearch.directive",[]).directive("itemSearch",function($filter,PatientService,OutsideReferralModel,ReceptionistService,toastr){var arrGetBy=$filter("arrGetBy");return{restrict:"EA",scope:{list:"=",extra:"=",appt:"="},template:'<my-data-table options="data_options" rowclass="set_row_class" rowclick="row_click">',controller:function($scope){$scope.data_options={api:"api/erm/v2/items/search",method:"post",columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code"},{field:"ITEM_NAME",label:"Item Name"},{field:"ITEM_TYPE",label:"Type"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"},ITEM_TYPE:{type:"text"}}},$scope.set_row_class=function(item){var t_item=arrGetBy($scope.list,"ITEM_ID",item.ITEM_ID);if(t_item)return"success";var t_item=arrGetBy($scope.extra,"ITEM_ID",item.ITEM_ID);return t_item?"success":void 0},$scope.row_click=function(item){if(void 0!==$scope.extra&&null!==$scope.extra){var t_item=arrGetBy($scope.extra,"ITEM_ID",item.ITEM_ID);if(!t_item){var t_item=arrGetBy($scope.list,"ITEM_ID",item.ITEM_ID);t_item||(item.QUANTITY=1,item.checked="1",item.chosen=!0,$scope.extra.push(item),ReceptionistService.itemFeeAppt($scope.appt.SERVICE_ID,[item.ITEM_ID]).then(function(response){var list_fee=response.list,t_item=arrGetBy(list_fee,"CLN_ITEM_ID",item.ITEM_ID);t_item?(item.PRICE=t_item.SCHEDULE_FEE,item.disable_fee=!0):(item.PRICE=0,item.disable_fee=!1)},function(err){console.log(err)}))}}}}}}),angular.module("app.loggedIn.document",["app.loggedIn.document.cat2.controllers","app.loggedIn.document.cat3.controllers","app.loggedIn.document.FA.controllers","app.loggedIn.document.MA.controllers","app.loggedIn.document.IDS.controllers","app.loggedIn.document.gorgonFA.controllers","app.loggedIn.document.gorgonMA.controllers","app.loggedIn.document.gorgonMH.controllers","app.loggedIn.document.gorgonUQ.controllers","app.loggedIn.document.services","app.loggedIn.document.MH.controllers","app.loggedIn.document.MRS.controllers","app.loggedIn.document.SA1.controllers","app.loggedIn.document.SA2.controllers","app.loggedIn.document.COE.controllers","app.loggedIn.document.demo.controllers","app.loggedIn.document.detail.controllers","app.loggedIn.document.addPatient.controllers","app.loggedIn.document.form18.controllers","app.loggedIn.document.newFA.controllers"]).config(function($stateProvider){$stateProvider.state("loggedIn.demo",{url:"/demo",templateUrl:"modules/document/views/DemoDocument.html",controller:"demoController"}).state("loggedIn.Detail",{url:"/detail",templateUrl:"modules/document/views/patientDetail.html",controller:"detailController"}).state("loggedIn.addPatient",{url:"/addPatient",templateUrl:"modules/document/views/addPatient.html",controller:"addPatientController"}).state("loggedIn.COE",{url:"/COE/:patient_id/:cal_id",templateUrl:"modules/document/views/COE.html",controller:"COEController"}).state("loggedIn.category2",{url:"/category2/:patient_id/:cal_id",templateUrl:"modules/document/views/category2.html",controller:"Cat2Controller"}).state("loggedIn.category3",{url:"/category3/:patient_id/:cal_id",templateUrl:"modules/document/views/category3.html",controller:"Cat3Controller"}).state("loggedIn.MA",{url:"/MA/:patient_id/:cal_id",templateUrl:"modules/document/views/medicalAssessment.html",controller:"MAController"}).state("loggedIn.IDS",{url:"/IDS/:patient_id/:cal_id",templateUrl:"modules/document/views/instantScreen.html",controller:"IDSController"}).state("loggedIn.gorgonFA",{url:"/gorgonFA/:patient_id/:cal_id",templateUrl:"modules/document/views/gorgonFA.html",controller:"gorgonFAController"}).state("loggedIn.gorgonMA",{url:"/gorgonMA/:patient_id/:cal_id",templateUrl:"modules/document/views/gorgonMA.html",controller:"gorgonMAController"}).state("loggedIn.gorgonMH",{url:"/gorgonMH/:patient_id/:cal_id",templateUrl:"modules/document/views/gorgonMH.html",controller:"gorgonMHController"}).state("loggedIn.gorgonUQ",{url:"/gorgonUQ/:patient_id/:cal_id",templateUrl:"modules/document/views/gorgonUQ.html",controller:"gorgonUQController"}).state("loggedIn.Form18",{url:"/Form18/:patient_id/:cal_id",templateUrl:"modules/document/views/form18.html",controller:"form18Controller"}).state("loggedIn.MH",{url:"/MH/:patient_id/:cal_id",templateUrl:"modules/document/views/medicalhistory.html",controller:"MHController"}).state("loggedIn.MRS",{url:"/MRS/:patient_id/:cal_id",templateUrl:"modules/document/views/medicalresultsummary.html",controller:"MRSController"}).state("loggedIn.SA1",{url:"/SA1/:patient_id/:cal_id",templateUrl:"modules/document/views/audiogramresults1.html",controller:"SA1Controller"}).state("loggedIn.SA2",{url:"/SA2/:patient_id/:cal_id",templateUrl:"modules/document/views/audiogramresults2.html",controller:"SA2Controller"}).state("loggedIn.FA",{url:"/FA/:patient_id/:cal_id/:fa_id",templateUrl:"modules/document/views/newFunctionalAssessment.html",controller:"newFAController"}).state("loggedIn.newFA",{url:"/newFA/:patient_id/:cal_id/:fa_id",templateUrl:"modules/document/views/functionAssessment.html",controller:"FAController"})}),angular.module("app.loggedIn.document.services",[]).factory("DocumentService",function(Restangular,ConfigService,$state){var documentService={},api=Restangular.all("api");documentService.loadPatient=function(searchObj){var loadPatient=api.all("document/loadPatient");return loadPatient.post({searchObj:searchObj})},documentService.insertCOE=function(info){var insertCOE=api.all("document/insertCOE");return insertCOE.post({info:info})},documentService.updateCOE=function(info){var updateCOE=api.all("document/updateCOE");return updateCOE.post({info:info})},
documentService.checkCOE=function(PatientID,calID){var checkCOE=api.all("document/checkCOE");return checkCOE.post({PatientID:PatientID,calID:calID})},documentService.insertFA=function(infoH,infoL,infoD,infoC,fa_id){var insertFA=api.all("document/insertFA");return insertFA.post({infoL:infoL,infoH:infoH,infoD:infoD,infoC:infoC,fa_id:fa_id})},documentService.updateFA=function(infoH,infoL,infoD,infoC){var updateFA=api.all("document/updateFA");return updateFA.post({infoL:infoL,infoH:infoH,infoD:infoD,infoC:infoC})},documentService.checkFA=function(PatientID,calID,FA_ID){var checkFA=api.all("document/checkFA");return checkFA.post({PatientID:PatientID,calID:calID,fa_id:FA_ID})},documentService.checkRating=function(id,age,gender,val){var checkRating=api.all("document/checkRating");return checkRating.post({id:id,age:age,gender:gender,value:val})},documentService.insertMA=function(info){var insertMA=api.all("document/insertMA");return insertMA.post({info:info})},documentService.editMA=function(info){var editMA=api.all("document/editMA");return editMA.post({info:info})},documentService.checkMA=function(PatientID,calID,idC){var checkMA=api.all("document/checkMA");return checkMA.post({PatientID:PatientID,calID:calID,idC:idC})},documentService.loadIDS=function(infoLoad){var loadIDS=api.all("document/loadIDS");return loadIDS.post({info:infoLoad})},documentService.insertIDS=function(infoAdd){var insertIDS=api.all("document/insertIDS");return insertIDS.post({info:infoAdd})},documentService.updateIDS=function(infoUp){var checkIDS=api.all("document/updateIDS");return checkIDS.post({info:infoUp})},documentService.insertUQ=function(info){var insertUQ=api.all("document/insertUQ");return insertUQ.post({info:info})},documentService.updateUQ=function(info){var updateUQ=api.all("document/updateUQ");return updateUQ.post({info:info})},documentService.checkUser=function(PatientID,calID){var checkUser=api.all("document/checkUser");return checkUser.post({PatientID:PatientID,calID:calID})},documentService.insertGorgonFA=function(info){var insertGorgonFA=api.all("document/insertGorgonFA");return insertGorgonFA.post({info:info})},documentService.editGorgonFA=function(info){var edit=api.all("document/editGorgonFA");return edit.post({info:info})},documentService.checkGorgonFA=function(PatientID,calID){var checkGorgonFA=api.all("document/checkGorgonFA");return checkGorgonFA.post({PatientID:PatientID,calID:calID})},documentService.insertGorgonMA=function(info){var insertGorgonMA=api.all("document/insertGorgonMA");return insertGorgonMA.post({info:info})},documentService.editGorgonMA=function(info){var edit=api.all("document/editGorgonMA");return edit.post({info:info})},documentService.checkGorgonMA=function(PatientID,calID){var checkGorgonMA=api.all("document/checkGorgonMA");return checkGorgonMA.post({PatientID:PatientID,calID:calID})},documentService.loadMH=function(infoLoad){var info=api.all("document/loadMH");return info.post({info:infoLoad})},documentService.insertMH=function(infoAdd){var insertMH=api.all("document/insertMH");return insertMH.post({info:infoAdd})},documentService.editMH=function(infoEdit){var editMH=api.all("document/editMH");return editMH.post({info:infoEdit})},documentService.loadMRS=function(infoLoad){var loadMRS=api.all("document/loadMRS");return loadMRS.post({info:infoLoad})},documentService.insertMRS=function(infoAdd){var insertMRS=api.all("document/insertMRS");return insertMRS.post({info:infoAdd})},documentService.editMRS=function(infoEdit){var editMRS=api.all("document/editMRS");return editMRS.post({info:infoEdit})},documentService.loadForm18=function(infoLoad){var loadForm=api.all("document/loadForm18");return loadForm.post({info:infoLoad})},documentService.insertForm18=function(infoAdd){var insertForm18=api.all("document/insertForm18");return insertForm18.post({info:infoAdd})},documentService.editForm18=function(infoEdit){var editForm18=api.all("document/editForm18");return editForm18.post({info:infoEdit})},documentService.loadSA1=function(infoLoad){var loadSA1=api.all("document/loadSA1");return loadSA1.post({info:infoLoad})},documentService.insertSA1=function(infoAdd){var insertSA1=api.all("document/insertSA1");return insertSA1.post({info:infoAdd})},documentService.editSA1=function(infoEdit){var editSA1=api.all("document/editSA1");return editSA1.post({info:infoEdit})},documentService.loadSA2=function(infoLoad){var loadSA2=api.all("document/loadSA2");return loadSA2.post({info:infoLoad})},documentService.insertSA2=function(infoAdd){var insertSA2=api.all("document/insertSA2");return insertSA2.post({info:infoAdd})},documentService.editSA2=function(infoEdit){var editSA2=api.all("document/editSA2");return editSA2.post({info:infoEdit})},documentService.newAUD2=function(){var newAUD2=api.one("document/newAUD2");return newAUD2.get()},documentService.loadAUD2=function(){var loadAUD2=api.one("document/loadAUD2");return loadAUD2.get()},documentService.insertCat2=function(infoAdd){var insertCat2=api.all("document/insertCat2");return insertCat2.post({info:infoAdd})},documentService.loadCat2=function(infoFind){var loadCat2=api.all("document/loadCat2");return loadCat2.post({info:infoFind})},documentService.editCat2=function(infoUp){var editCat2=api.all("document/editCat2");return editCat2.post({info:infoUp})},documentService.loadCat3=function(infoFind){var info=api.all("document/loadCat3");return info.post({info:infoFind})},documentService.insertCat3=function(infoAdd){var info=api.all("document/insertCat3");return info.post({info:infoAdd})},documentService.findCat3=function(ids){var info=api.all("document/findCat3");return info.post({ids:ids})},documentService.editCat3=function(infoUp){var info=api.all("document/editCat3");return info.post({info:infoUp})},documentService.insertUQ=function(info){var insertUQ=api.all("document/insertUQ");return insertUQ.post({info:info})},documentService.loadGGMH=function(infoLoad){var info=api.all("document/loadGGMH");return info.post({info:infoLoad})},documentService.insertGGMH=function(infoAdd){var info=api.all("document/insertGGMH");return info.post({info:infoAdd})},documentService.editGGMH=function(infoUp){var info=api.all("document/editGGMH");return info.post({info:infoUp})},documentService.loadNewHeaderSections=function(fa_id){var info=api.all("document/newHeaderSections");return info.post({fa_id:fa_id})},documentService.loadNewLines=function(section_id,fa_id){var info=api.all("document/newLines");return info.post({section_id:section_id,fa_id:fa_id})},documentService.loadNewCommentsAndDetails=function(line_id){var info=api.all("document/newDetailsComments");return info.post({line_id:line_id})},documentService.autoRating=function(ratingData){var info=api.all("document/autoRating");return info.post({patient_age:ratingData.patient_age,patient_gender:ratingData.patient_gender,valueToRate:ratingData.valueToRate,rating_id:ratingData.rating_id})},documentService.checkExistFA=function(fa_id,patient_id,cal_id){var info=api.all("document/checkExistFA");return info.post({fa_id:fa_id,patient_id:patient_id,cal_id:cal_id})},documentService.loadExistHeaderSections=function(fa_id,patient_id,cal_id){var info=api.all("document/existHeaderSections");return info.post({fa_id:fa_id,patient_id:patient_id,cal_id:cal_id})},documentService.loadExistLines=function(section_id,fa_id,patient_id,cal_id){var info=api.all("document/existLines");return info.post({section_id:section_id,fa_id:fa_id,patient_id:patient_id,cal_id:cal_id})},documentService.loadExistCommentsAndDetails=function(line_id,patient_id,cal_id){var info=api.all("document/existDetailsComments");return info.post({line_id:line_id,patient_id:patient_id,cal_id:cal_id})},documentService.insertNewFA=function(insertData){var insertNewFA=api.all("document/insertNewFA");return insertNewFA.post({insertData:insertData})},documentService.updateNewFA=function(updateData,patient_id,cal_id){var updateNewFA=api.all("document/updateNewFA");return updateNewFA.post({updateData:updateData,patient_id:patient_id,cal_id:cal_id})},documentService.getDoctor=function(appt_info){var getDoctor=api.all("document/getDoctorFA");return getDoctor.post(appt_info)};var strPrefixAPI="api/erm/v2/paperless/";return documentService.optionGorgonMA=function(patient_id){return{api:strPrefixAPI+"gorgon_ma_search",method:"post",columns:[{field:"CalId",is_hide:!0},{field:"GORGON_ID",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.gorgonMA",{patient_id:patient_id,cal_id:item.CalId})}}]}},documentService.optionGorgonFA=function(patient_id){return{api:strPrefixAPI+"gorgon_fa_search",method:"post",columns:[{field:"CalId",is_hide:!0},{field:"id",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.gorgonFA",{patient_id:patient_id,cal_id:item.CalId})}}]}},documentService.optionGorgonUQ=function(patient_id){return{api:strPrefixAPI+"gorgon_uq_search",method:"post",columns:[{field:"CalId",is_hide:!0},{field:"Quest_Id",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.gorgonUQ",{patient_id:patient_id,cal_id:item.CalId})}}]}},documentService.optionGorgonMH=function(patient_id){return{api:strPrefixAPI+"gorgon_mh_search",method:"post",columns:[{field:"CalId",is_hide:!0},{field:"Gorgon_Id",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.gorgonMH",{patient_id:patient_id,cal_id:item.CalId})}}]}},documentService.optionMRS=function(patient_id){return{api:strPrefixAPI+"mrs_search",method:"post",columns:[{field:"cal_id",is_hide:!0},{field:"mrs_id",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.MRS",{patient_id:patient_id,cal_id:item.cal_id})}}]}},documentService.optionCategory2=function(patient_id){return{api:strPrefixAPI+"category2_search",method:"post",columns:[{field:"cal_id",is_hide:!0},{field:"cat_id",is_hide:!0},{field:"DATE",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.DATE)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.category2",{patient_id:patient_id,cal_id:item.cal_id})}}]}},documentService.optionCategory3=function(patient_id){return{api:strPrefixAPI+"category3_search",method:"post",columns:[{field:"cal_id",is_hide:!0},{field:"cat_id",is_hide:!0},{field:"PATIENT_DATE",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.PATIENT_DATE)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.category3",{patient_id:patient_id,cal_id:item.cal_id})}}]}},documentService.Optionform18=function(patient_id){return{api:strPrefixAPI+"form18_search",method:"post",columns:[{field:"CAL_ID",is_hide:!0},{field:"GORGON_ID",is_hide:!0},{field:"TIME_TEST",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.TIME_TEST)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.Form18",{patient_id:patient_id,cal_id:item.CAL_ID})}}]}},documentService.OptionSA1=function(patient_id){return{api:strPrefixAPI+"audiogram1_search",method:"post",columns:[{field:"CAL_ID",is_hide:!0},{field:"SA_ID",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.SA1",{patient_id:patient_id,cal_id:item.CAL_ID})}}]}},documentService.OptionSA2=function(patient_id){return{api:strPrefixAPI+"audiogram2_search",method:"post",columns:[{field:"CAL_ID",is_hide:!0},{field:"SA_ID",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.SA2",{patient_id:patient_id,cal_id:item.CAL_ID})}}]}},documentService.OptionMH=function(patient_id){return{api:strPrefixAPI+"medical_history_search",method:"post",columns:[{field:"cal_id",is_hide:!0},{field:"mh_id",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.MH",{patient_id:patient_id,cal_id:item.cal_id})}}]}},documentService.OptionCOE=function(patient_id){return{api:strPrefixAPI+"coe_search",method:"post",columns:[{field:"CalId",is_hide:!0},{field:"coe_id",is_hide:!0},{field:"coeDate",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.COE",{patient_id:patient_id,cal_id:item.CalId})}}]}},documentService.OptionIDS=function(patient_id){return{api:strPrefixAPI+"instant_drug_screen_search",method:"post",columns:[{field:"CAL_ID",is_hide:!0},{field:"IDAS_ID",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.IDS",{patient_id:patient_id,cal_id:item.CAL_ID})}}]}},documentService.OptionFA=function(patient_id){return{api:strPrefixAPI+"functional_assessment_search",method:"post",columns:[{field:"CAL_ID",is_hide:!0},{field:"FA_ID",is_hide:!0},{field:"TYPE",label:"Type"},{field:"FA_NAME",label:"Name"},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.FA",{patient_id:patient_id,cal_id:item.CAL_ID,fa_id:item.FA_ID})}},{"class":"fa fa-print",title:"Print",callback:function(item){window.open("http://testapp.redimed.com.au:3003/RedimedJavaREST/api/document/FA/"+item.FA_ID+"/"+item.CAL_ID+"/"+patient_id)}}]}},documentService.OptionMA=function(patient_id){return{api:strPrefixAPI+"medical_assessment_search",method:"post",columns:[{field:"CAL_ID",is_hide:!0},{field:"MA_ID",is_hide:!0},{field:"Creation_date",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.Creation_date)}}],"static":!0,search:{patient_id:patient_id},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){$state.go("loggedIn.MA",{patient_id:patient_id,cal_id:item.CAL_ID})}}]}},documentService}),angular.module("app.loggedIn.document.cat2.controllers",[]).controller("Cat2Controller",function($scope,DocumentService,$rootScope,$http,$cookieStore,toastr,$state,$filter,$stateParams,localStorageService){$scope.dateOptions={formatYear:"yy",startingDay:1};var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist!"),$state.go("loggedIn.home",null,{reload:!0});else{var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.Signature=tempSignature},$scope.clearClick=function(){$scope.info.Signature=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.Signature},$scope.today=new Date;var patientInfo=localStorageService.get("tempPatient");(null===patientInfo||"undefined"===patientInfo)&&(toastr.error("Load information fail!","Error"),$state.go("loggedIn.home",null,{reload:!0}));var Patient_ID=patientInfo.Patient_id,CalID=$stateParams.cal_id;$scope.info={cat_id:null,cal_id:CalID,DocId:null,patient_id:Patient_ID,Signature:null,has_declaration:null,has_safety:null,has_following:null,audiometric:null,q1_4:null,q1_4_c:null,q1_5_1:null,q1_5_2:null,q1_5_3:null,q1_5_3_c:null,q3_1_1:null,q3_1_1_c:null,q3_1_2:null,q3_1_2_c:null,q3_1_3_1:null,q3_1_3_2:null,q3_1_3_3:null,q3_1_3_4:null,q3_1_3_5:null,q3_1_3_6:null,q3_1_3_7:null,q3_1_3_8:null,q3_1_3_9:null,q3_1_3_10:null,q3_1_3_11:null,q3_1_3_12:null,q3_1_3_13:null,q3_1_3_14:null,q3_1_3_15:null,q3_1_3_16:null,q3_1_3_17:null,q3_1_3_18:null,q3_1_3_19:null,q3_1_3_20:null,q3_1_3_21:null,q3_1_3_22:null,q3_1_3_23:null,q3_1_4_1:null,q3_1_4_2:null,q3_1_4_3_1:null,q3_1_4_3_2:null,q3_1_4_3_3:null,q3_1_4_3_4:null,q3_1_4_3_5:null,q3_1_4_3_6:null,q3_1_4_3_7:null,q3_1_4_3_8:null,q3_1_5_1:null,q3_1_5_2:null,q3_1_5_3:null,q3_1_5_4:null,q3_1_5_5:null,q3_1_5_6:null,q3_1_5_7:null,q3_1_5_8:null,q3_1_5_9:null,q3_1_5_10:null,q3_1_6_1:null,q3_1_6_2:null,q3_1_6_3:null,q3_1_6_4:null,q3_1_6_5:null,q3_1_6_6:null,q3_1_6_7:null,q3_1_6_8:null,q3_1_6_9:null,q3_1_6_10:null,q3_1_6_c:null,q3_2:null,q4_2_1_1_1:null,q4_2_1_1_2:null,q4_2_1_2:null,q4_2_1_2_c:null,q4_2_1_3:null,q4_2_1_4:null,q4_2_2:null,q4_2_3:null,q4_2_4_c:null,q4_2_5_1:null,q4_2_5_2:null,q4_2_5_3_1:null,q4_2_5_3_2:null,q4_2_5_4_1:null,q4_2_5_4_2:null,q4_2_5_5:null,q4_2_5_6:null,q4_2_6_1:null,q4_2_6_2:null,q4_2_7_L_1:null,q4_2_7_L_2:null,q4_2_7_L_3:null,q4_2_7_L_4:null,q4_2_7_L_5:null,q4_2_7_L_6:null,q4_2_7_L_7:null,q4_2_7_L_8:null,q4_2_7_R_1:null,q4_2_7_R_2:null,q4_2_7_R_3:null,q4_2_7_R_4:null,q4_2_7_R_5:null,q4_2_7_R_6:null,q4_2_7_R_7:null,q4_2_7_R_8:null,q4_2_7:null,q4_2_8_c:null,q4_2_8_1_c:null,q4_2_8_2_1:null,q4_2_8_2_c:null,q4_2_8_3_1:null,q4_2_8_3_c:null,q4_2_8_4_1:null,q4_2_8_4_c:null,q4_2_8_5_1:null,q4_2_8_5_c:null,q4_2_8_6_1:null,q4_2_8_6_c:null,q4_2_8_7_1:null,q4_2_8_7_c:null,q4_2_8_8_1:null,q4_2_8_8_c:null,q4_2_8_9_1:null,q4_2_8_9_c:null,q4_2_9:0,q4_2_10_1:null,q4_2_10_2:null,q4_2_11:0,q4_2_12_1:0,q4_2_12_2:null,q4_2_13_1_1:null,q4_2_13_1_2:null,q4_2_13_1_3:null,q4_2_13_1_4:null,q4_2_13_1_5:null,q4_2_13_2:null,q4_2_13_3:null,q4_2_13_4:null,q4_2_13_5:null,q4_2_13_6:null,rel_cmt:null,rel_id:null,r1_1:null,r1_2:null,r1_3:null,r1_4_y:null,r1_5:null,r1_6:null,r1_7:null,r1_8:null,r1_8_c:null,r2_1:null,r2_2:null,r2_2_y:null,r2_3:null,r2_4:null,r2_5:null,r2_6:null,r2_7_c:null,r3_1:null,r3_2_c:null,r4_1:null,r4_2_c:null,r5_1:null,r5_2:null,DATE:new Date,DOCTOR_ID:null,Created_by:null,Last_updated_by:null};var oriInfo,info=$scope.info;DocumentService.loadCat2(info).then(function(response){if("fail"===response.status)$state.go("logged.home",null,{reload:!0}),toastr.error("Load fail!","Error");else if("findNull"===response[0].status)$scope.isNew=!0,$scope.info.patient=response[0].patient,$scope.info.apptInfo=response[0].appt,$scope.info.doctor=response[0].doctor,$scope.info.company=response[0].company,$scope.info.Created_by=userInfo.id,oriInfo=angular.copy($scope.info);else if("findFound"===response[0].status){$scope.isNew=!1;var data=response[0].dataCat2,timeAppt=(new Date(response[0].appt.FROM_TIME).getHours()%12<=9?"0"+new Date(response[0].appt.FROM_TIME).getHours()%12:new Date(response[0].appt.FROM_TIME).getHours()%12)+" : "+(new Date(response[0].appt.FROM_TIME).getMinutes()<=9?"0"+new Date(response[0].appt.FROM_TIME).getMinutes():new Date(response[0].appt.FROM_TIME).getMinutes())+(new Date(response[0].appt.FROM_TIME).getHours()>12?" PM":" AM");$scope.info={apptInfo:response[0].appt,patient:response[0].patient,doctor:response[0].doctor,company:response[0].company,timeAppt:timeAppt,cat_id:data.cat_id,cal_id:data.cal_id,DocId:data.DocId,patient_id:data.patient_id,Signature:data.Signature,has_declaration:data.has_declaration,has_safety:data.has_safety,has_following:data.has_following,audiometric:data.audiometric,q1_4:data.q1_4,q1_4_c:data.q1_4_c,q1_5_1:data.q1_5_1,q1_5_2:data.q1_5_2,q1_5_3:data.q1_5_3,q1_5_3_c:data.q1_5_3_c,q3_1_1:data.q3_1_1,q3_1_1_c:data.q3_1_1_c,q3_1_2:data.q3_1_2,q3_1_2_c:data.q3_1_2_c,q3_1_3_1:data.q3_1_3_1,q3_1_3_2:data.q3_1_3_2,q3_1_3_3:data.q3_1_3_3,q3_1_3_4:data.q3_1_3_4,q3_1_3_5:data.q3_1_3_5,q3_1_3_6:data.q3_1_3_6,q3_1_3_7:data.q3_1_3_7,q3_1_3_8:data.q3_1_3_8,q3_1_3_9:data.q3_1_3_9,q3_1_3_10:data.q3_1_3_10,q3_1_3_11:data.q3_1_3_11,q3_1_3_12:data.q3_1_3_12,q3_1_3_13:data.q3_1_3_13,q3_1_3_14:data.q3_1_3_14,q3_1_3_15:data.q3_1_3_15,q3_1_3_16:data.q3_1_3_16,q3_1_3_17:data.q3_1_3_17,q3_1_3_18:data.q3_1_3_18,q3_1_3_19:data.q3_1_3_19,q3_1_3_20:data.q3_1_3_20,q3_1_3_21:data.q3_1_3_21,q3_1_3_22:data.q3_1_3_22,q3_1_3_23:data.q3_1_3_23,q3_1_4_1:data.q3_1_4_1,q3_1_4_2:data.q3_1_4_2,q3_1_4_3_1:data.q3_1_4_3_1,q3_1_4_3_2:data.q3_1_4_3_2,q3_1_4_3_3:data.q3_1_4_3_3,q3_1_4_3_4:data.q3_1_4_3_4,q3_1_4_3_5:data.q3_1_4_3_5,q3_1_4_3_6:data.q3_1_4_3_6,q3_1_4_3_7:data.q3_1_4_3_7,q3_1_4_3_8:data.q3_1_4_3_8,q3_1_5_1:data.q3_1_5_1,q3_1_5_2:data.q3_1_5_2,q3_1_5_3:data.q3_1_5_3,q3_1_5_4:data.q3_1_5_4,q3_1_5_5:data.q3_1_5_5,q3_1_5_6:data.q3_1_5_6,q3_1_5_7:data.q3_1_5_7,q3_1_5_8:data.q3_1_5_8,q3_1_5_9:data.q3_1_5_9,q3_1_5_10:data.q3_1_5_10,q3_1_6_1:data.q3_1_6_1,q3_1_6_2:data.q3_1_6_2,q3_1_6_3:data.q3_1_6_3,q3_1_6_4:data.q3_1_6_4,q3_1_6_5:data.q3_1_6_5,q3_1_6_6:data.q3_1_6_6,q3_1_6_7:data.q3_1_6_7,q3_1_6_8:data.q3_1_6_8,q3_1_6_9:data.q3_1_6_9,q3_1_6_10:data.q3_1_6_10,q3_1_6_c:data.q3_1_6_c,q3_2:data.q3_2,q4_2_1_1_1:data.q4_2_1_1_1,q4_2_1_1_2:data.q4_2_1_1_2,q4_2_1_2:data.q4_2_1_2,q4_2_1_2_c:data.q4_2_1_2_c,q4_2_1_3:data.q4_2_1_3,q4_2_1_4:data.q4_2_1_4,q4_2_2:data.q4_2_2,q4_2_3:data.q4_2_3,q4_2_4_c:data.q4_2_4_c,q4_2_5_1:data.q4_2_5_1,q4_2_5_2:data.q4_2_5_2,q4_2_5_3_1:data.q4_2_5_3_1,q4_2_5_3_2:data.q4_2_5_3_2,q4_2_5_4_1:data.q4_2_5_4_1,q4_2_5_4_2:data.q4_2_5_4_2,q4_2_5_5:data.q4_2_5_5,q4_2_5_6:data.q4_2_5_6,q4_2_6_1:data.q4_2_6_1,q4_2_6_2:data.q4_2_6_2,q4_2_7_L_1:data.q4_2_7_L_1,q4_2_7_L_2:data.q4_2_7_L_2,q4_2_7_L_3:data.q4_2_7_L_3,q4_2_7_L_4:data.q4_2_7_L_4,q4_2_7_L_5:data.q4_2_7_L_5,q4_2_7_L_6:data.q4_2_7_L_6,q4_2_7_L_7:data.q4_2_7_L_7,q4_2_7_L_8:data.q4_2_7_L_8,q4_2_7_R_1:data.q4_2_7_R_1,q4_2_7_R_2:data.q4_2_7_R_2,q4_2_7_R_3:data.q4_2_7_R_3,q4_2_7_R_4:data.q4_2_7_R_4,q4_2_7_R_5:data.q4_2_7_R_5,q4_2_7_R_6:data.q4_2_7_R_6,q4_2_7_R_7:data.q4_2_7_R_7,q4_2_7_R_8:data.q4_2_7_R_8,q4_2_7:data.q4_2_7,q4_2_8_c:data.q4_2_8_c,q4_2_8_1_c:data.q4_2_8_1_c,q4_2_8_2_1:data.q4_2_8_2_1,q4_2_8_2_c:data.q4_2_8_2_c,q4_2_8_3_1:data.q4_2_8_3_1,q4_2_8_3_c:data.q4_2_8_3_c,q4_2_8_4_1:data.q4_2_8_4_1,q4_2_8_4_c:data.q4_2_8_4_c,q4_2_8_5_1:data.q4_2_8_5_1,q4_2_8_5_c:data.q4_2_8_5_c,q4_2_8_6_1:data.q4_2_8_6_1,q4_2_8_6_c:data.q4_2_8_6_c,q4_2_8_7_1:data.q4_2_8_7_1,q4_2_8_7_c:data.q4_2_8_7_c,q4_2_8_8_1:data.q4_2_8_8_1,q4_2_8_8_c:data.q4_2_8_8_c,q4_2_8_9_1:data.q4_2_8_9_1,q4_2_8_9_c:data.q4_2_8_9_c,q4_2_9:data.q4_2_9,q4_2_10_1:data.q4_2_10_1,q4_2_10_2:data.q4_2_10_2,q4_2_11:data.q4_2_11,q4_2_12_1:data.q4_2_12_1,q4_2_12_2:data.q4_2_12_2,q4_2_13_1_1:data.q4_2_13_1_1,q4_2_13_1_2:data.q4_2_13_1_2,q4_2_13_1_3:data.q4_2_13_1_3,q4_2_13_1_4:data.q4_2_13_1_4,q4_2_13_1_5:data.q4_2_13_1_5,q4_2_13_2:data.q4_2_13_2,q4_2_13_3:data.q4_2_13_3,q4_2_13_4:data.q4_2_13_4,q4_2_13_5:data.q4_2_13_5,q4_2_13_6:data.q4_2_13_6,rel_cmt:data.rel_cmt,rel_id:data.rel_id,r1_1:data.r1_1,r1_2:data.r1_2,r1_3:data.r1_3,r1_4_y:data.r1_4_y,r1_5:data.r1_5,r1_6:data.r1_6,r1_7:data.r1_7,r1_8:data.r1_8,r1_8_c:data.r1_8_c,r2_1:data.r2_1,r2_2:data.r2_2,r2_2_y:data.r2_2_y,r2_3:data.r2_3,r2_4:data.r2_4,r2_5:data.r2_5,r2_6:data.r2_6,r2_7_c:data.r2_7_c,r3_1:data.r3_1,r3_2_c:data.r3_2_c,r4_1:data.r4_1,r4_2_c:data.r4_2_c,r5_1:data.r5_1,r5_2:data.r5_2,DATE:data.DATE,DOCTOR_ID:response[0].doctor.DOCTOR_ID,Created_by:data.Created_by,Last_updated_by:userInfo.id},oriInfo=angular.copy($scope.info)}}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.cat2Form.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submit=function(cat2Form){if(cat2Form.$error.pattern||cat2Form.$error.maxlength||cat2Form.$error.required)toastr.error("Please Input All Required Information!","Error");else{var info=$scope.info;info.q4_2_9=$scope.info.q3_1_4_3_1+$scope.info.q3_1_4_3_2+$scope.info.q3_1_4_3_3+$scope.info.q3_1_4_3_4+$scope.info.q3_1_4_3_5+$scope.info.q3_1_4_3_6+$scope.info.q3_1_4_3_7+$scope.info.q3_1_4_3_8,info.q4_2_11=$scope.info.q3_1_5_1+$scope.info.q3_1_5_2+$scope.info.q3_1_5_3+$scope.info.q3_1_5_4+$scope.info.q3_1_5_5+$scope.info.q3_1_5_6+$scope.info.q3_1_5_7+$scope.info.q3_1_5_8+$scope.info.q3_1_5_9+$scope.info.q3_1_5_10,info.q4_2_12_1=$scope.info.q3_1_6_1+$scope.info.q3_1_6_2+$scope.info.q3_1_6_3+$scope.info.q3_1_6_4+$scope.info.q3_1_6_5+$scope.info.q3_1_6_6+$scope.info.q3_1_6_7+$scope.info.q3_1_6_8+$scope.info.q3_1_6_9+$scope.info.q3_1_6_10,$scope.isNew===!0?DocumentService.insertCat2(info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),$state.go("loggedIn.category2",null,{reload:!0})):"fail"===response.status&&toastr.error("Add new fail!","Error")}):$scope.isNew===!1&&DocumentService.editCat2(info).then(function(response){"success"===response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.category2",null,{reload:!0})):"fail"===response.status&&toastr.error("Update fail!","Error")})}}}}),angular.module("app.loggedIn.document.cat3.controllers",[]).controller("Cat3Controller",function($scope,DocumentService,$rootScope,$http,$cookieStore,toastr,$state,$stateParams,localStorageService){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.today=new Date;var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist!"),$state.go("loggedIn.home",null,{reload:!0});else{var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.PATIENT_SIGNATURE=tempSignature},$scope.clearClick=function(){$scope.info.PATIENT_SIGNATURE=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.PATIENT_SIGNATURE};var tempPatient=localStorageService.get("tempPatient");if("undefined"===tempPatient||null==tempPatient)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load information fail, please try again!","Error");else{var patient_id=tempPatient.Patient_id,cal_id=$stateParams.cal_id;$scope.info={cat_id:null,cal_id:cal_id,patient_id:patient_id,has_declaration:null,has_following:null,audiometric:null,q1_4:null,q1_4_c:null,q1_5_1:null,q1_5_2:null,q1_5_3:null,s3_q1_1_1:null,s3_q1_1_2:null,s3_q1_2_1:null,s3_q1_2_2:null,s3_q1_3:null,s3_q1_4:null,s3_q2_1_1:null,s3_q2_1_2:null,s3_q2_1_3:null,s3_q2_1_4:null,s3_q2_1_5:null,s3_q2_1_6:null,s3_q2_1_7:null,s3_q2_1_8:null,s3_q2_2_1:null,s3_q2_2_2:null,s3_q2_2_3:null,s3_q2_2_4:null,s3_q2_2_5:null,s3_q2_2_6:null,s3_q2_2_7:null,s3_q2_2_8:null,s3_q2_3:null,s3_q3_1:null,s3_q3_2:null,s3_q3_3_1:null,s3_q3_3_2:null,s3_q3_4_1:null,s3_q3_4_2:null,s3_q3_5:null,s3_q3_6:null,s3_q4:null,s3_q5_1_1_1:null,s3_q5_1_1_2:null,s3_q5_1_1_3:null,s3_q5_1_1_4:null,s3_q5_1_2:null,s3_q5_2:null,s3_q5_3:null,s3_q5_4:null,s3_q5_5:null,s3_q5_6:null,s3_q6_c:null,s3_q6_1:null,s3_q6_2_1:null,s3_q6_2_2:null,s3_q6_3_1:null,s3_q6_3_2:null,s3_q6_4_1:null,s3_q6_4_2:null,s3_q6_5_1:null,s3_q6_5_2:null,s3_q6_6_1:null,s3_q6_6_2:null,s3_q6_7_1:null,s3_q6_7_2:null,s3_q6_8_1:null,s3_q6_8_2:null,s3_q6_9_1:null,s3_q6_9_2:null,s3_q7_1:null,s3_q7_2:null,s4_c:null,s4_1:null,s4_2:null,r1_1:null,r1_2:null,r1_3:null,r1_4_y:null,r1_5:null,r1_6:null,r1_7:null,r1_8:null,r1_8_c:null,r2_1:null,r2_2:null,r2_2_y:null,r2_3:null,r2_4:null,r2_5:null,r2_6:null,r2_7_c:null,r3_1:null,r3_2_c:null,r4_1:null,r4_2_c:null,r5_1:null,r5_2:null,DocId:null,q1_5_3_c:null,PATIENT_SIGNATURE:null,PATIENT_DATE:new Date,DOCTOR_ID:null,Created_by:null,Last_updated_by:null};var oriInfo,info=$scope.info;DocumentService.loadCat3(info).then(function(response){if("fail"===response.status)$state.go("loggedIn.home",null,{reload:!0});else if("findNull"===response[0].status)$scope.isNew=!0,$scope.info.patient=response[0].patient,$scope.info.apptInfo=response[0].appt,$scope.info.doctor=response[0].doctor,$scope.info.company=response[0].company,$scope.info.Created_by=userInfo.id,oriInfo=angular.copy($scope.info);else if("findFound"===response[0].status){var data=response[0].data;$scope.isNew=!1;var timeAppt=(new Date(response[0].appt.FROM_TIME).getHours()%12<=9?"0"+new Date(response[0].appt.FROM_TIME).getHours()%12:new Date(response[0].appt.FROM_TIME).getHours()%12)+" : "+(new Date(response[0].appt.FROM_TIME).getMinutes()<=9?"0"+new Date(response[0].appt.FROM_TIME).getMinutes():new Date(response[0].appt.FROM_TIME).getMinutes())+(new Date(response[0].appt.FROM_TIME).getHours()>12?" PM":" AM");$scope.info={timeAppt:timeAppt,apptInfo:response[0].appt,patient:response[0].patient,doctor:response[0].doctor,company:response[0].company,cat_id:data.cat_id,cal_id:data.cal_id,patient_id:data.patient_id,has_declaration:data.has_declaration,has_following:data.has_following,audiometric:data.audiometric,q1_4:data.q1_4,q1_4_c:data.q1_4_c,q1_5_1:data.q1_5_1,q1_5_2:data.q1_5_2,q1_5_3:data.q1_5_3,s3_q1_1_1:data.s3_q1_1_1,s3_q1_1_2:data.s3_q1_1_2,s3_q1_2_1:data.s3_q1_2_1,s3_q1_2_2:data.s3_q1_2_2,s3_q1_3:data.s3_q1_3,s3_q1_4:data.s3_q1_4,s3_q2_1_1:data.s3_q2_1_1,s3_q2_1_2:data.s3_q2_1_2,s3_q2_1_3:data.s3_q2_1_3,s3_q2_1_4:data.s3_q2_1_4,s3_q2_1_5:data.s3_q2_1_5,s3_q2_1_6:data.s3_q2_1_6,s3_q2_1_7:data.s3_q2_1_7,s3_q2_1_8:data.s3_q2_1_8,s3_q2_2_1:data.s3_q2_2_1,s3_q2_2_2:data.s3_q2_2_2,s3_q2_2_3:data.s3_q2_2_3,s3_q2_2_4:data.s3_q2_2_4,s3_q2_2_5:data.s3_q2_2_5,s3_q2_2_6:data.s3_q2_2_6,s3_q2_2_7:data.s3_q2_2_7,s3_q2_2_8:data.s3_q2_2_8,s3_q2_3:data.s3_q2_3,s3_q3_1:data.s3_q3_1,s3_q3_2:data.s3_q3_2,s3_q3_3_1:data.s3_q3_3_1,s3_q3_3_2:data.s3_q3_3_2,s3_q3_4_1:data.s3_q3_4_1,s3_q3_4_2:data.s3_q3_4_2,s3_q3_5:data.s3_q3_5,s3_q3_6:data.s3_q3_6,s3_q4:data.s3_q4,s3_q5_1_1_1:data.s3_q5_1_1_1,s3_q5_1_1_2:data.s3_q5_1_1_2,s3_q5_1_1_3:data.s3_q5_1_1_3,s3_q5_1_1_4:data.s3_q5_1_1_4,s3_q5_1_2:data.s3_q5_1_2,s3_q5_2:data.s3_q5_2,s3_q5_3:data.s3_q5_3,s3_q5_4:data.s3_q5_4,s3_q5_5:data.s3_q5_5,s3_q5_6:data.s3_q5_6,s3_q6_c:data.s3_q6_c,s3_q6_1:data.s3_q6_1,s3_q6_2_1:data.s3_q6_2_1,s3_q6_2_2:data.s3_q6_2_2,s3_q6_3_1:data.s3_q6_3_1,s3_q6_3_2:data.s3_q6_3_2,s3_q6_4_1:data.s3_q6_4_1,s3_q6_4_2:data.s3_q6_4_2,s3_q6_5_1:data.s3_q6_5_1,s3_q6_5_2:data.s3_q6_5_2,s3_q6_6_1:data.s3_q6_6_1,s3_q6_6_2:data.s3_q6_6_2,s3_q6_7_1:data.s3_q6_7_1,s3_q6_7_2:data.s3_q6_7_2,s3_q6_8_1:data.s3_q6_8_1,s3_q6_8_2:data.s3_q6_8_2,s3_q6_9_1:data.s3_q6_9_1,s3_q6_9_2:data.s3_q6_9_2,s3_q7_1:data.s3_q7_1,s3_q7_2:data.s3_q7_2,s4_c:data.s4_c,s4_1:data.s4_1,s4_2:data.s4_2,r1_1:data.r1_1,r1_2:data.r1_2,r1_3:data.r1_3,r1_4_y:data.r1_4_y,r1_5:data.r1_5,
r1_6:data.r1_6,r1_7:data.r1_7,r1_8:data.r1_8,r1_8_c:data.r1_8_c,r2_1:data.r2_1,r2_2:data.r2_2,r2_2_y:data.r2_2_y,r2_3:data.r2_3,r2_4:data.r2_4,r2_5:data.r2_5,r2_6:data.r2_6,r2_7_c:data.r2_7_c,r3_1:data.r3_1,r3_2_c:data.r3_2_c,r4_1:data.r4_1,r4_2_c:data.r4_2_c,r5_1:data.r5_1,r5_2:data.r5_2,DocId:data.DocId,q1_5_3_c:data.q1_5_3_c,PATIENT_SIGNATURE:data.PATIENT_SIGNATURE,PATIENT_DATE:data.PATIENT_DATE,DOCTOR_ID:response[0].doctor.DOCTOR_ID,Created_by:data.Created_by,Last_updated_by:userInfo.id},oriInfo=angular.copy($scope.info)}else $state.go("loggedIn.home",null,{reload:!0})}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.category3Form.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submit=function(category3Form){if(category3Form.$error.pattern||category3Form.$error.maxlength)toastr.error("Please Input All Required Information!","Error");else{var info=$scope.info;$scope.isNew===!0?DocumentService.insertCat3(info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),$state.go("loggedIn.category3",null,{reload:!0})):"fail"===response.status&&toastr.error("Add new fail!","Error")}):$scope.isNew===!1&&DocumentService.editCat3(info).then(function(response){"success"===response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.category3",null,{reload:!0})):"fail"===response.status?toastr.error("Update fail!","Error"):$state.go("loggedIn.home",null,{reload:!0})})}}}}}),angular.module("app.loggedIn.document.FA.controllers",[]).controller("FAController",function($scope,$filter,$timeout,$state,ConfigService,DocumentService,$stateParams,localStorageService,$http,$cookieStore,toastr){function getAge(dateString){var now=new Date,birthDate=new Date(dateString),age=now.getFullYear()-birthDate.getFullYear(),m=now.getMonth()-birthDate.getMonth();return(0>m||0===m&&now.getDate()<birthDate.getDate())&&age--,age}var oriInfoH,oriInfoL,oriInfoD,oriInfoC,tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.infoH.ASSESSED_SIGN=tempSignature},$scope.clearClick=function(){$scope.infoH.ASSESSED_SIGN=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.infoH.ASSESSED_SIGN},$scope.patientInfo=localStorageService.get("tempPatient");var Patient_ID=$scope.patientInfo.Patient_id,CalID=$stateParams.cal_id,FA_ID=$stateParams.fa_id;$scope.listFA=[],$scope.infoH={},$scope.infoL={},$scope.infoS={},$scope.infoD={},$scope.infoC={},$scope.manage={},$scope.a={},$scope.total={};var rateTotal,value={},totalArr=[],age=getAge($scope.patientInfo.DOB),gender=$scope.patientInfo.Sex,val=0,sum=0,avg=0,total=0,dem=0;$scope.age=age;var date=new Date;$filter("date")(date,"ddMMyy"),$scope.rate=function(id){val=$scope.infoL.RATING_VALUE1[id],$scope.infoL.RATE1[id]=1==val?"Poor":2==val?"Fair":3==val?"Good":4==val?"Excellent":"",rateTotalFunction(id)};var rateTotalFunction=function(id){console.log("this is id",id),rateTotal=[],dem=0,console.log("this is total array",totalArr);for(var i in totalArr){total=0;for(var j in totalArr[i])"rating"!=j&&(j==id&&(totalArr[i][j]=$scope.infoL.RATING_VALUE1[id]),total+=1*totalArr[i][j]);$scope.infoL.RATING_VALUE1[i]=total,DocumentService.checkRating(totalArr[i].rating,age,gender,total).then(function(response){if("fail"!=response.status&&response.length>0){rateTotal.push(response[0].RATE),dem=0;for(var k in totalArr){for(var t=0;t<rateTotal.length;t++)t==dem&&($scope.infoL.RATE1[k]=rateTotal[t]);dem++}}else $scope.infoL.RATE1[i]=""})}};$scope.mathScore=function(idD,idL,score1,rating1,score2,rating2,type1,type2,rating_id,lineQuestion){if(1==score1)if(1==rating1){if(3==type1){sum=0,avg=0,value[idL]||(value[idL]=[]),value[idL][idD]=$scope.infoD.VAL1_VALUE[idD];for(var i in value[idL])sum+=1*value[idL][i],avg++;val=sum/avg,$scope.infoL.SCORE1[idL]=val}else if(10==type1){console.log("this is idL",value[idL]);var max=0;value[idL]||(value[idL]=[]),value[idL][idD]=$scope.infoD.VAL1_VALUE[idD];for(var i in value[idL])value[idL][i]>max&&(max=value[idL][i]);val=max,$scope.infoL.SCORE1[idL]=val}else 4==type1?"Recovery 1 min"===lineQuestion&&(val=$scope.infoD.VAL1_VALUE[idD]):6==type1&&(val=$scope.infoD.VAL1_VALUE[idD]);if(DocumentService.checkRating(rating_id,age,gender,val).then(function(response){console.log("this is response 1",response),"success"===response.status&&response.data.length>0?(console.log("this is response",response),$scope.infoL.RATING_VALUE1[idL]=response.data[0].VALUE,$scope.infoL.RATE1[idL]=response.data[0].RATE,console.log("this is response",response),rateTotalFunction(idL)):($scope.infoL.RATING_VALUE1[idL]=null,$scope.infoL.RATE1[idL]="",rateTotalFunction(idL))}),1==score2&&1==rating2&&3==type2){sum=0,avg=0,val=0,value[idL]||(value[idL]=[]),value[idL][idD]=$scope.infoD.VAL2_VALUE[idD];for(var i in value[idL])sum+=1*value[idL][i],avg++;val=sum/avg,$scope.infoL.SCORE2[idL]=val,DocumentService.checkRating(rating_id,age,gender,val).then(function(response){"success"===response.status&&response.data.length>0?($scope.infoL.RATING_VALUE2[idL]=response.data[0].VALUE,$scope.infoL.RATE2[idL]=response.data[0].RATE):($scope.infoL.RATING_VALUE2[idL]=null,$scope.infoL.RATE2[idL]="")})}}else if(0==rating1&&9==type1){var max=0;value[idL]||(value[idL]=[]),value[idL][idD]=1*$scope.infoD.VAL1_VALUE[idD];for(var i in value[idL])value[idL][i]>max&&(max=value[idL][i]);$scope.manage[idL]=max}},$scope.infoH={PATIENT_ID:Patient_ID,CAL_ID:CalID,FA_ID:FA_ID,ENTITY_ID:null,FA_TYPE:null,FA_NAME:null,ISENABLE:null,Created_by:null,Last_updated_by:null,Risk:null,Comments:null,Recommend:null,Att_Flexibility:0,Att_Core_Stability:0,Att_Wirst_Elbow_func:0,Att_Shoulder_func:0,Att_Lower_Limb_func:0,Att_Balance:0,ASSESSED_ID:null,ASSESSED_SIGN:null,ASSESSED_DATE:null,ASSESSED_NAME:null,ITEM_ID:null},oriInfoH=angular.copy($scope.infoH),$scope.infoL={SCORE1:{},RATING_VALUE1:{},COMMENTS:{},SCORE2:{},RATING_VALUE2:{},RATE1:{},RATE2:{}},$scope.infoD={VAL1_VALUE:{},VAL1_CHECKBOX:{},VAL2_VALUE:{},VAL2_CHECKBOX:{},COMMENTS:{}},$scope.infoC.VALUE={},$scope.resetForm=function(){$scope.infoH=angular.copy(oriInfoH),$scope.infoL=angular.copy(oriInfoL),$scope.infoD=angular.copy(oriInfoD),$scope.infoC.VALUE=angular.copy(oriInfoC),$scope.FAForm.$setPristine()},$scope.infoChanged=function(){return 0==!angular.equals(oriInfoH,$scope.infoH)&&0==!angular.equals(oriInfoL,$scope.infoL)&&0==!angular.equals(oriInfoD,$scope.infoD)&&0==!angular.equals(oriInfoC,$scope.infoC.VALUE)?!1:!0};var insert=!0;DocumentService.checkFA($scope.infoH.PATIENT_ID,$scope.infoH.CAL_ID,$scope.infoH.FA_ID).then(function(response){if(console.log(response),"new"===response.status)$scope.isNew=!0,insert=!0,oriInfoH=angular.copy($scope.infoH),oriInfoL=angular.copy($scope.infoL),oriInfoD=angular.copy($scope.infoD),oriInfoC=angular.copy($scope.infoC.VALUE);else{if("update"!==response.status)return void toastr.error("Fail","Error");$scope.isNew=!1,insert=!1}var data=response.data[0],dataH=data.Header[0];data.Section,$scope.listFA.push({header_name:dataH.FA_NAME,section:[]});var i=0;angular.forEach(data.Section,function(dataS){$scope.listFA[0].section.push({section_id:dataS.SECTION_ID,section_name:dataS.SECTION_NAME,line:[]});var j=0;angular.forEach(data.Line,function(dataL){dataL.SECTION_ID==$scope.listFA[0].section[i].section_id&&($scope.listFA[0].section[i].line.push({line_id:dataL.LINE_ID,image:dataL.PICTURE,rating_id1:dataL.RATING_ID1,rating_id2:dataL.RATING_ID2,line_name:dataL.QUESTION,line_type:dataL.LineType,line_comment:dataL.IsCommentsText,line_isscore1:dataL.ISSCORE1,line_isscore2:dataL.ISSCORE2,line_israting1:dataL.ISRATING1,line_israting2:dataL.ISRATING2,score_type1:dataL.SCORE_TYPE1,score_type2:dataL.SCORE_TYPE2,detail:[],comment:[]}),0==insert&&($scope.infoL.COMMENTS[dataL.LINE_ID]=dataL.COMMENTS,$scope.infoL.SCORE1[dataL.LINE_ID]=dataL.SCORE1,$scope.infoL.SCORE2[dataL.LINE_ID]=dataL.SCORE2,$scope.infoL.RATING_VALUE1[dataL.LINE_ID]=dataL.RATING_VALUE1,$scope.infoL.RATING_VALUE2[dataL.LINE_ID]=dataL.RATING_VALUE2,$scope.infoL.RATE1[dataL.LINE_ID]=dataL.RATE1,$scope.infoL.RATE2[dataL.LINE_ID]=dataL.RATE2,value[dataL.LINE_ID]={}),angular.forEach(data.Detail,function(dataD){dataD.LINE_ID==$scope.listFA[0].section[i].line[j].line_id&&($scope.listFA[0].section[i].line[j].detail.push({detail_id:dataD.DETAIL_ID,image:dataD.PICTURE,detail_name:dataD.QUESTION,val1_yes:dataD.VAL1_ISCOMMENT_WHEN_YES,val1_no:dataD.VAL1_ISCOMMENT_WHEN_NO,val2_yes:dataD.VAL2_ISCOMMENT_WHEN_YES,val2_no:dataD.VAL2_ISCOMMENT_WHEN_NO,val1Validate:dataD.VAL1_VALUE_IS_NUMBER,val2Validate:dataD.VAL2_VALUE_IS_NUMBER,val1_name:dataD.VAL1_NAME,val2_name:dataD.VAL2_NAME,val1_isvalue:dataD.VAL1_ISVALUE,val2_isvalue:dataD.VAL2_ISVALUE,val1_ischeckbox:dataD.VAL1_ISCHECKBOX,val2_ischeckbox:dataD.VAL2_ISCHECKBOX,comment_text:dataD.IsCommentText,summary:dataD.LineTestRefer}),0==insert&&($scope.infoD.COMMENTS[dataD.DETAIL_ID]=dataD.COMMENTS,$scope.infoD.VAL1_CHECKBOX[dataD.DETAIL_ID]=dataD.VAL1_CHECKBOX,$scope.infoD.VAL2_CHECKBOX[dataD.DETAIL_ID]=dataD.VAL2_CHECKBOX,$scope.infoD.VAL2_VALUE[dataD.DETAIL_ID]=dataD.VAL2_VALUE,$scope.infoD.VAL1_VALUE[dataD.DETAIL_ID]=dataD.VAL1_VALUE,value[dataL.LINE_ID][dataD.DETAIL_ID]=[dataD.VAL1_VALUE,dataD.VAL2_VALUE],1==dataL.ISSCORE1&&0==dataL.ISRATING1&&9==dataL.SCORE_TYPE1&&$scope.mathScore(dataD.DETAIL_ID,dataL.LINE_ID,1,0,null,null,9,null,null),null!=dataD.LineTestRefer&&(totalArr[dataD.LINE_ID]||(totalArr[dataD.LINE_ID]=[]),totalArr[dataD.LINE_ID][dataD.LineTestRefer]=dataD.VAL1_VALUE,totalArr[dataD.LINE_ID].rating=dataL.RATING_ID1,rateTotalFunction(dataD.LINE_ID))))}),angular.forEach(data.Comment,function(dataC){dataC.LINE_ID==$scope.listFA[0].section[i].line[j].line_id&&($scope.listFA[0].section[i].line[j].comment.push({comment_id:dataC.FA_COMMENT_ID,comment_name:dataC.NAME,comment_type:dataC.Comment_Type}),0==insert&&($scope.infoC.VALUE[dataC.FA_COMMENT_ID]=dataC.VALUE))}),j++)}),i++}),0==insert&&($scope.infoH={PATIENT_ID:dataH.PATIENT_ID,CAL_ID:dataH.CAL_ID,FA_ID:dataH.FA_ID,ENTITY_ID:dataH.ENTITY_ID,Created_by:dataH.Created_by,Creation_date:dataH.Creation_date,Last_updated_by:dataH.Last_updated_by,Last_update_date:dataH.Last_update_date,Risk:dataH.Risk,Comments:dataH.Comments,Recommend:dataH.Recommend,Att_Flexibility:dataH.Att_Flexibility,Att_Core_Stability:dataH.Att_Core_Stability,Att_Wirst_Elbow_func:dataH.Att_Wirst_Elbow_func,Att_Shoulder_func:dataH.Att_Shoulder_func,Att_Lower_Limb_func:dataH.Att_Lower_Limb_func,Att_Balance:dataH.Att_Balance,ASSESSED_ID:dataH.ASSESSED_ID,ASSESSED_SIGN:dataH.ASSESSED_SIGN,ASSESSED_DATE:dataH.ASSESSED_DATE,ASSESSED_NAME:dataH.ASSESSED_NAME,ITEM_ID:dataH.ITEM_ID},oriInfoH=angular.copy($scope.infoH),oriInfoL=angular.copy($scope.infoL),oriInfoD=angular.copy($scope.infoD),oriInfoC=angular.copy($scope.infoC.VALUE))}),$scope.submitFA=function(FAForm){$scope.showClickedValidation=!0,FAForm.$invalid?toastr.error("Please Input All Required Information!","Error"):1==insert?(console.log($scope.infoH),console.log($scope.infoL),console.log($scope.infoD),console.log($scope.infoC),DocumentService.insertFA($scope.infoH,$scope.infoL,$scope.infoD,$scope.infoC,FA_ID).then(function(response){"success"===response.status?(toastr.success("Successfully","Success"),$state.go("loggedIn.FA",null,{reload:!0})):toastr.error("Fail","Error")})):DocumentService.updateFA($scope.infoH,$scope.infoL,$scope.infoD,$scope.infoC).then(function(response){"success"===response.status?(toastr.success("Successfully","Success"),$state.go("loggedIn.FA",null,{reload:!0})):toastr.error("Fail","Error")})}}),angular.module("app.loggedIn.document.MA.controllers",["fcsa-number"]).controller("MAController",function($scope,$filter,DocumentService,ConfigService,$http,$cookieStore,$state,toastr,$stateParams,localStorageService){function getAge(dateString){var now=new Date,birthDate=new Date(dateString),age=now.getFullYear()-birthDate.getFullYear(),m=now.getMonth()-birthDate.getMonth();return(0>m||0===m&&now.getDate()<birthDate.getDate())&&age--,age}$scope.dateOptions={formatYear:"yy",startingDay:1};var Patient_ID,CalID,oriInfo,clearInfo,sex,date,value;$scope.patientInfo=localStorageService.get("tempPatient"),CalID=$stateParams.cal_id,Patient_ID=$scope.patientInfo.Patient_id,sex=$scope.patientInfo.Sex,$scope.patientInfo.DOB=$filter("date")($scope.patientInfo.DOB,"dd/MM/yyyy"),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.MAForm.$setPristine()},$scope.clearForm=function(){$scope.info=angular.copy(clearInfo),$scope.MAForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.infoClear=function(){return!angular.equals(clearInfo,$scope.info)},$scope.getColor=function(err){return $scope.showClickedValidation&&err?"red":void 0},$scope.Ratio=function(){value=$scope.info.WAIST/$scope.info.HIP,value>0&&100>value&&($scope.info.WHR=value.toFixed(2))};var weight,height;$scope.mathBMI=function(){height=$scope.info.HEIGHT,weight=$scope.info.WEIGHT,value=1e4*weight/(height*height),value=value.toFixed(1),value>0&&300>value?($scope.info.BMI=value,18.5>value?$scope.info.IS_BMI=0:value>=18.5&&24.9>=value?$scope.info.IS_BMI=1:value>=25&&29.9>=value?$scope.info.IS_BMI=2:value>=30&&($scope.info.IS_BMI=3)):($scope.info.BMI=null,$scope.info.IS_BMI=null)};var len,str,totalCom="";$scope.collectComment=function(){$scope.info.COMMENT_SEC10=(null!=$scope.info.COMMENT_SEC4&&""!=$scope.info.COMMENT_SEC4?$scope.info.COMMENT_SEC4+"\n":"")+(null!=$scope.info.COMMENT_SEC5&&""!=$scope.info.COMMENT_SEC5?$scope.info.COMMENT_SEC5+"\n":"")+(null!=$scope.info.COMMENT_SEC6&&""!=$scope.info.COMMENT_SEC6?$scope.info.COMMENT_SEC6+"\n":"")+(null!=$scope.info.COMMENT_SEC7&&""!=$scope.info.COMMENT_SEC7?$scope.info.COMMENT_SEC7+"\n":"")+(null!=$scope.info.COMMENT_SEC8&&""!=$scope.info.COMMENT_SEC8?$scope.info.COMMENT_SEC8+"\n":"")+(null!=$scope.info.COMMENT_SEC9&&""!=$scope.info.COMMENT_SEC9?$scope.info.COMMENT_SEC9+"\n":"")+totalCom},$scope.totalComment=function(){$scope.info.COMMENT_SEC10||($scope.info.COMMENT_SEC10=(null!=$scope.info.COMMENT_SEC4&&""!=$scope.info.COMMENT_SEC4?$scope.info.COMMENT_SEC4+"\n":"")+(null!=$scope.info.COMMENT_SEC5&&""!=$scope.info.COMMENT_SEC5?$scope.info.COMMENT_SEC5+"\n":"")+(null!=$scope.info.COMMENT_SEC6&&""!=$scope.info.COMMENT_SEC6?$scope.info.COMMENT_SEC6+"\n":"")+(null!=$scope.info.COMMENT_SEC7&&""!=$scope.info.COMMENT_SEC7?$scope.info.COMMENT_SEC7+"\n":"")+(null!=$scope.info.COMMENT_SEC8&&""!=$scope.info.COMMENT_SEC8?$scope.info.COMMENT_SEC8+"\n":"")+(null!=$scope.info.COMMENT_SEC9&&""!=$scope.info.COMMENT_SEC9?$scope.info.COMMENT_SEC9+"\n":"")),len=(null!=$scope.info.COMMENT_SEC4?$scope.info.COMMENT_SEC4.length:0)+(null!=$scope.info.COMMENT_SEC5?$scope.info.COMMENT_SEC5.length:0)+(null!=$scope.info.COMMENT_SEC6?$scope.info.COMMENT_SEC6.length:0)+(null!=$scope.info.COMMENT_SEC7?$scope.info.COMMENT_SEC7.length:0)+(null!=$scope.info.COMMENT_SEC8?$scope.info.COMMENT_SEC8.length:0)+(null!=$scope.info.COMMENT_SEC9?$scope.info.COMMENT_SEC9.length:0),str=$scope.info.COMMENT_SEC10.replace("\n","");for(var i=0;5>i;i++)str=str.replace("\n","");totalCom=str.substr(len)};var insert=!0;DocumentService.checkMA(Patient_ID,CalID,$scope.patientInfo.company_id).then(function(response){"insert"===response.status?(insert=!0,$scope.isNew=!0,date=new Date,$scope.sites=response.site,$scope.info={PATIENT_ID:Patient_ID,CAL_ID:CalID,STICKER:null,HEIGHT:null,WEIGHT:null,BMI:null,WAIST:null,HIP:null,WHR:null,IS_BMI:null,BLOOD_SEC1:null,IS_BLOOD:null,RESTING_HEART_RATE:null,IS_RESTING_HEART_RATE:null,HEART_SOUNDS:null,PERIPHERAL:null,VEINS_OTHER:null,COMMENT_SEC1:null,RIGHT_DIST:null,RIGHT_DIST_CORRECT:null,LEFT_DIST:null,LEFT_DIST_CORRECT:null,RIGHT_NEAR:null,RIGHT_NEAR_CORRECT:null,LEFT_NEAR:null,LEFT_NEAR_CORRECT:null,COLOUR_SEC2:null,SCORE_SEC2:null,PERIPHERAL_SEC2:null,VISUAL_AIDS:null,COMMENT_SEC2:null,PROTEIN:null,GLUCOSE:null,BLOOD:null,BLOOD_SUGAR_LEVEL:null,COMMENT_SEC3:null,SPIROMETRY:null,SYMMETRICAL:null,AUSCULTATION:null,EARS:null,HEARING:null,NOSE:null,THROAT:null,TEETH_GUMS:null,SKIN:null,DRUG:null,NAIL:null,SCAR:null,ABDOMEN:null,HERNIAL:null,LIVER:null,SPLEEN:null,KIDNEYS:null,BALANCE:null,COORDINATION:null,LYMPH:null,THYROID:null,COMMENT_SEC4:null,COMMENT_SEC5:null,COMMENT_SEC6:null,COMMENT_SEC7:null,COMMENT_SEC8:null,COMMENT_SEC9:"",AGE:getAge($scope.patientInfo.DOB),HYPER:0,SMOKER:0,KNOW:0,SEDENTARY:0,FAMILY:0,HISTORY:0,OBESITY:0,RISK:null,ECG:null,ECG_RESULT:null,GP:null,COMMENT_SEC10:null,DOCTOR_ID:response.docID,DOCTOR_NAME:response.docName,SIGN:response.docSign,LOCATION:null,Created_by:null,Creation_date:date,Last_updated_by:null,Last_update_date:null,DF_CODE:null,ISENABLE:null},$scope.companyName=response.nameCompany,oriInfo=angular.copy($scope.info)):"fail"===response.status?(toastr.error("Fail!","Fail"),$state.go("loggedIn.demo",null,{reload:!0})):"error"===response.status?(toastr.error("Error!","Error"),$state.go("loggedIn.demo",null,{reload:!0})):"update"===response.status&&(insert=!1,$scope.isNew=!1,$scope.companyName=response.nameCompany,$scope.sites=response.site,$scope.info=angular.copy(response.data),$scope.info.DOCTOR_NAME=response.docName,$scope.info.SIGN=response.docSign,$scope.totalComment(),oriInfo=angular.copy($scope.info)),clearInfo=1==$scope.isNew?angular.copy($scope.info):{PATIENT_ID:Patient_ID,CAL_ID:CalID,STICKER:null,HEIGHT:null,WEIGHT:null,BMI:null,WAIST:null,HIP:null,WHR:null,IS_BMI:null,BLOOD_SEC1:null,IS_BLOOD:null,RESTING_HEART_RATE:null,IS_RESTING_HEART_RATE:null,HEART_SOUNDS:null,PERIPHERAL:null,VEINS_OTHER:null,COMMENT_SEC1:null,RIGHT_DIST:null,RIGHT_DIST_CORRECT:null,LEFT_DIST:null,LEFT_DIST_CORRECT:null,RIGHT_NEAR:null,RIGHT_NEAR_CORRECT:null,LEFT_NEAR:null,LEFT_NEAR_CORRECT:null,COLOUR_SEC2:null,SCORE_SEC2:null,PERIPHERAL_SEC2:null,VISUAL_AIDS:null,COMMENT_SEC2:null,PROTEIN:null,GLUCOSE:null,BLOOD:null,BLOOD_SUGAR_LEVEL:null,COMMENT_SEC3:null,SPIROMETRY:null,SYMMETRICAL:null,AUSCULTATION:null,EARS:null,HEARING:null,NOSE:null,THROAT:null,TEETH_GUMS:null,SKIN:null,DRUG:null,NAIL:null,SCAR:null,ABDOMEN:null,HERNIAL:null,LIVER:null,SPLEEN:null,KIDNEYS:null,BALANCE:null,COORDINATION:null,LYMPH:null,THYROID:null,COMMENT_SEC4:null,COMMENT_SEC5:null,COMMENT_SEC6:null,COMMENT_SEC7:null,COMMENT_SEC8:null,COMMENT_SEC9:"",AGE:getAge($scope.patientInfo.DOB),HYPER:0,SMOKER:0,KNOW:0,SEDENTARY:0,FAMILY:0,HISTORY:0,OBESITY:0,RISK:null,ECG:null,ECG_RESULT:null,GP:null,COMMENT_SEC10:null,DOCTOR_ID:response.docID,DOCTOR_NAME:response.docName,SIGN:response.docSign,Created_by:null,Creation_date:date,Last_updated_by:null,Last_update_date:null,DF_CODE:null,ISENABLE:null}}),$scope.submitMA=function(MAForm){$scope.showClickedValidation=!0,MAForm.$invalid?toastr.error("Please Input All Required Information!","Error"):1==insert?DocumentService.insertMA($scope.info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),$scope.isNew=!1,$state.go("loggedIn.MA",null,{reload:!0})):toastr.error("Add new fail!","Error")}):DocumentService.editMA($scope.info).then(function(response){"success"===response.status?(toastr.success("Edit success!","Success"),$state.go("loggedIn.MA",null,{reload:!0})):toastr.error("Edit fail!","Error")})}}),angular.module("app.loggedIn.document.IDS.controllers",[]).controller("IDSController",function($scope,$state,DocumentService,$http,$cookieStore,$stateParams,toastr,localStorageService,$state){var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.headers[0].SIGNATURE=tempSignature},$scope.clearClick=function(){$scope.info.headers[0].SIGNATURE=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.headers[0].SIGNATURE};var patientInfo=localStorageService.get("tempPatient"),Patient_ID=patientInfo.Patient_id,CalID=$stateParams.cal_id;$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.info={PATIENT_ID:Patient_ID,CAL_ID:CalID};var oriInfo,info=$scope.info;DocumentService.loadIDS(info).then(function(response){"fail"==response.status?($state.go("loggedIn.IDS",null,{reload:!0}),toastr.error("Load information fail!","Error")):"findNull"==response[0].status?$scope.isNew=!0:"findFound"==response[0].status?$scope.isNew=!1:($state.go("loggedIn.IDS",null,{reload:!0}),toastr.error("Error not status!","Error"));var data=response[0];$scope.info.headers=[],$scope.patientInfo=response[0].patient,angular.forEach(data.headers,function(dataH,hIndex){$scope.info.headers.push({IDAS_ID:dataH.IDAS_DF_ID||dataH.IDAS_ID,PATIENT_ID:Patient_ID,CAL_ID:CalID,DOCTOR_ID:response[0].doctor.doctor_id,DF_CODE:dataH.DF_CODE,NAME:dataH.NAME,IDAS_DATE:dataH.IDAS_DATE||new Date,Temperature:dataH.Temperature,Creatinine:dataH.Creatinine,Drug_Test_Time:dataH.Drug_Test_Time,Expiry_Date:dataH.Expiry_Date||new Date,Notes:dataH.Notes,Alcohol_Test_Time:dataH.Alcohol_Test_Time,Reading:dataH.Reading,Positive_Negative:dataH.Positive_Negative,Reading2:dataH.Reading2,ITEM_ID:dataH.ITEM_ID,Created_by:dataH.Created_by,Last_updated_by:dataH.Last_updated_by,NAME_COMMENT:dataH.NAME_COMMENT,ISENABLE:dataH.ISENABLE,SIGNATURE:dataH.SIGNATURE,TesterName:response[0].doctor.NAME,TesterSign:response[0].doctor.Signature,TesterDate:dataH.TesterDate||new Date,groups:[]});var i=0;angular.forEach(data.groups,function(dataG,gIndex){($scope.info.headers[hIndex].IDAS_ID==dataG.IDAS_ID||$scope.info.headers[hIndex].IDAS_ID==dataG.IDAS_DF_ID)&&($scope.info.headers[hIndex].groups.push({IDAS_GROUP_ID:dataG.IDAS_GROUP_ID,IDAS_ID:dataG.IDAS_DF_ID||dataG.IDAS_ID,PATIENT_ID:Patient_ID,CAL_ID:CalID,ORD:dataG.ORD,GROUP_NAME:dataG.GROUP_NAME,USER_TYPE:dataG.USER_TYPE,Created_by:dataG.Created_by,Last_updated_by:dataG.Last_updated_by,ISENABLE:dataG.ISENABLE,lines:[]}),angular.forEach(data.lines,function(dataL,lIndex){$scope.info.headers[hIndex].groups[i].IDAS_GROUP_ID==dataL.IDAS_GROUP_ID&&$scope.info.headers[hIndex].groups[i].lines.push({IDAS_LINE_ID:dataL.IDAS_LINE_ID,IDAS_GROUP_ID:dataL.IDAS_GROUP_ID,IDAS_ID:dataL.IDAS_DF_ID||dataL.IDAS_ID,PATIENT_ID:Patient_ID,CAL_ID:CalID,ORD:dataL.ORD,QUESTION:dataL.QUESTION,YES_NO:dataL.YES_NO,Created_by:dataL.Created_by,Last_updated_by:dataL.Last_updated_by,ISENABLE:dataL.ISENABLE})}),i++)})}),oriInfo=angular.copy($scope.info)}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.mhForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submitIDS=function(IDSForm){var info=$scope.info;IDSForm.$error.required||IDSForm.$error.maxlength||IDSForm.pattern?toastr.error("Please Input All Required Information!","Error"):$scope.isNew===!0?DocumentService.insertIDS(info).then(function(response){"success"==response.status?(toastr.success("Add new success!","Success"),$state.go("loggedIn.IDS",null,{reload:!0})):"fail"===response.status&&toastr.error("Add new fail!","Error")}):$scope.isNew===!1&&DocumentService.updateIDS(info).then(function(response){"success"==response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.IDS",null,{reload:!0})):"fail"===response.status&&toastr.error("Update fail!","Error")})}}),angular.module("app.loggedIn.document.MH.controllers",[]).controller("MHController",function($scope,DocumentService,$http,$cookieStore,toastr,$state,localStorageService,$stateParams){var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist!");else{$scope.today=new Date,$scope.info=[];var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.dec_signed=tempSignature},$scope.clearClick=function(){$scope.info.dec_signed=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.dec_signed};var tempSignature1;$scope.isSignature1=!1,$scope.showSignature1=function(){$scope.isSignature1=!$scope.isSignature1},$scope.cancelClick1=function(){$scope.isSignature1=!$scope.isSignature1,$scope.info.rmi_signed_witness=tempSignature1},$scope.clearClick1=function(){$scope.info.rmi_signed_witness=""},$scope.okClick1=function(){$scope.isSignature1=!$scope.isSignature1,tempSignature1=$scope.info.rmi_signed_witness};var tempSignature2;$scope.isSignature2=!1,$scope.showSignature2=function(){$scope.isSignature2=!$scope.isSignature2},$scope.cancelClick2=function(){$scope.isSignature2=!$scope.isSignature2,$scope.info.dec_signed_witness=tempSignature2},$scope.clearClick2=function(){$scope.info.dec_signed_witness=""},$scope.okClick2=function(){$scope.isSignature2=!$scope.isSignature2,tempSignature2=$scope.info.dec_signed_witness},$scope.info.Date=new Date,$scope.info.Statement_Date=new Date;var tempPatient=localStorageService.get("tempPatient")||[];if(null==tempPatient||"undefined"===tempPatient)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load information fail, please try again!","Error");else{var patient_id=tempPatient.Patient_id,cal_id=$stateParams.cal_id;$scope.info={patient_id:patient_id,cal_id:cal_id};var oriInfo,clearInfo,clearWorks,clearMedications,medications=[{col1:null,col2:null,col3:null,stt:!0}],works=[{col1:null,col2:null,col3:null,col4:null,stt:!0}];clearWorks=works,clearMedications=medications;var info=$scope.info;DocumentService.loadMH(info).then(function(response){if("fail"===response.status)$state.go("loggedIn.home",null,{reload:!0});else if("findNull"===response[0].status)$scope.isNew=!0,$scope.count_sec2=0,$scope.count_sec3=0;else if("findFound"===response[0].status){$scope.isNew=!1;var dataTemp=response[0].data;works=[{col1:dataTemp.s2_occupation1||null,col2:dataTemp.s2_startdate1||null,col3:dataTemp.s2_enddate1||null,col4:dataTemp.s2_employ1||null,stt:null==dataTemp.s2_occupation1?!1:!0},{col1:dataTemp.s2_occupation2||null,col2:dataTemp.s2_startdate2||null,col3:dataTemp.s2_enddate2||null,col4:dataTemp.s2_employ2||null,stt:null==dataTemp.s2_occupation2?!1:!0},{col1:dataTemp.s2_occupation3||null,col2:dataTemp.s2_startdate3||null,col3:dataTemp.s2_enddate3||null,col4:dataTemp.s2_employ3||null,stt:null==dataTemp.s2_occupation3?!1:!0},{col1:dataTemp.s2_occupation4||null,col2:dataTemp.s2_startdate4||null,col3:dataTemp.s2_enddate4||null,col4:dataTemp.s2_employ4||null,stt:null==dataTemp.s2_occupation4?!1:!0},{col1:dataTemp.s2_occupation5||null,col2:dataTemp.s2_startdate5||null,col3:dataTemp.s2_enddate5||null,col4:dataTemp.s2_employ5||null,stt:null==dataTemp.s2_occupation5?!1:!0}],medications=[{col1:dataTemp.s3_name1||null,col2:dataTemp.s3_reason1||null,col3:dataTemp.s3_regularly1,stt:null==dataTemp.s3_name1?!1:!0},{col1:dataTemp.s3_name2||null,col2:dataTemp.s3_reason2||null,col3:dataTemp.s3_regularly2,stt:null==dataTemp.s3_name2?!1:!0},{col1:dataTemp.s3_name3||null,col2:dataTemp.s3_reason3||null,col3:dataTemp.s3_regularly3,stt:null==dataTemp.s3_name3?!1:!0},{col1:dataTemp.s3_name4||null,col2:dataTemp.s3_reason4||null,col3:dataTemp.s3_regularly4,stt:null==dataTemp.s3_name4?!1:!0},{col1:dataTemp.s3_name5||null,col2:dataTemp.s3_reason5||null,col3:dataTemp.s3_regularly5,stt:null==dataTemp.s3_name5?!1:!0},{col1:dataTemp.s3_name6||null,col2:dataTemp.s3_reason6||null,col3:dataTemp.s3_regularly6,stt:null==dataTemp.s3_name6?!1:!0}];for(var i=0;i<=works.length-1;i++)0==works[i].stt&&(works.splice(i,1),i--);for(var j=0;j<=medications.length-1;j++)0==medications[j].stt&&(medications.splice(j,1),j--);$scope.count_sec2=works.length-1,$scope.count_sec3=medications.length-1}else $state.go("loggedIn.home",null,{reload:!0});var data=response[0].data;$scope.info={mh_id:data.mh_id||null,patient_id:patient_id,cal_id:cal_id,s1_relationship:data.s1_relationship||null,s1_job_location:data.s1_job_location||null,s2_occupation1:data.s2_occupation1||null,s2_startdate1:data.s2_startdate1||null,s2_enddate1:data.s2_enddate1||null,s2_employ1:data.s2_employ1||null,s2_occupation2:data.s2_occupation2||null,s2_startdate2:data.s2_startdate2||null,s2_enddate2:data.s2_enddate2||null,s2_employ2:data.s2_employ2||null,s2_occupation3:data.s2_occupation3||null,s2_startdate3:data.s2_startdate3||null,s2_enddate3:data.s2_enddate3||null,s2_employ3:data.s2_employ3||null,s2_occupation4:data.s2_occupation4||null,s2_startdate4:data.s2_startdate4||null,s2_enddate4:data.s2_enddate4||null,s2_employ4:data.s2_employ4||null,s2_occupation5:data.s2_occupation5||null,s2_startdate5:data.s2_startdate5||null,s2_enddate5:data.s2_enddate5||null,s2_employ5:data.s2_employ5||null,s2_samework:data.s2_samework||null,s2_sameworkenvironment:data.s2_sameworkenvironment||null,s2_comments:data.s2_comments||null,s3_name1:data.s3_name1||null,s3_reason1:data.s3_reason1||null,s3_regularly1:data.s3_regularly1||null,s3_name2:data.s3_name2||null,s3_reason2:data.s3_reason2||null,s3_regularly2:data.s3_regularly2||null,s3_name3:data.s3_name3||null,s3_reason3:data.s3_reason3||null,s3_regularly3:data.s3_regularly3||null,s3_name4:data.s3_name4||null,s3_reason4:data.s3_reason4||null,s3_regularly4:data.s3_regularly4||null,s3_name5:data.s3_name5||null,s3_reason5:data.s3_reason5||null,s3_regular5:data.s3_regularly5||null,s3_comments:data.s3_comments||null,s4_concerning:data.s4_concerning||null,s4_weight_altered:data.s4_weight_altered||null,s4_medicaltreatment:data.s4_medicaltreatment||null,s4_hospital:data.s4_hospital||null,s4_stranfustion:data.s4_stranfustion||null,s4_diabetes:data.s4_diabetes||null,s4_pressure:data.s4_pressure||null,s4_asthma:data.s4_asthma||null,s4_emphysema:data.s4_emphysema||null,s4_veins:data.s4_veins||null,s4_epilepsy:data.s4_epilepsy||null,s4_episodes:data.s4_episodes||null,s4_cancer_or_tumour:data.s4_cancer_or_tumour||null,s4_concussion_or_headinjury:data.s4_concussion_or_headinjury||null,s4_migraine:data.s4_migraine||null,s4_eczema:data.s4_eczema||null,s4_hepatitis:data.s4_hepatitis||null,s4_desease:data.s4_desease||null,s4_hormonal:data.s4_hormonal||null,s4_allergies:data.s4_allergies||null,s4_comments:data.s4_comments||null,s5_disease:data.s5_disease||null,s5_claim:data.s5_claim||null,s5_claim_comment:data.s5_claim_comment||null,s5_lodged:data.s5_lodged||null,s5_closed:data.s5_closed||null,s5_duties:data.s5_duties||null,s5_sickness:data.s5_sickness||null,s5_equipment:data.s5_equipment||null,s5_chermicals:data.s5_chermicals||null,s5_noise:data.s5_noise||null,s5_radiation:data.s5_radiation||null,s5_dust:data.s5_dust||null,s5_asbestos:data.s5_asbestos||null,s5_solvents:data.s5_solvents||null,s5_other:data.s5_other||null,s5_comments:data.s5_comments||null,s6_neck:data.s6_neck||null,s6_shoulder:data.s6_shoulder||null,s6_elbow:data.s6_elbow||null,s6_wrist_or_hand:data.s6_wrist_or_hand||null,s6_lower_black:data.s6_lower_black||null,s6_hip:data.s6_hip||null,s6_knee:data.s6_knee||null,s6_ankle_or_foot:data.s6_ankle_or_foot||null,s6_comments1:data.s6_comments1||null,s6_cervical:data.s6_cervical||null,s6_lower:data.s6_lower||null,s6_sciatica:data.s6_sciatica||null,s6_pins_needles:data.s6_pins_needles||null,s6_muscle_aches_pains:data.s6_muscle_aches_pains||null,s6_joint_aches_pains:data.s6_joint_aches_pains||null,s6_comments2:data.s6_comments2||null,s6_rsi:data.s6_rsi||null,s6_tennis:data.s6_tennis||null,s6_carpal:data.s6_carpal||null,s6_hernia:data.s6_hernia||null,s6_osteoarthritis:data.s6_osteoarthritis||null,s6_arthritis:data.s6_arthritis||null,s6_osteoporosis:data.s6_osteoporosis||null,s6_fibromyalgia:data.s6_fibromyalgia||null,s6_fractured_bones:data.s6_fractured_bones||null,s6_affects:data.s6_affects||null,s6_joint_or_bones:data.s6_joint_or_bones||null,s6_comments3:data.s6_comments3||null,s7_directfamily:data.s7_directfamily||null,s7_undergone:data.s7_undergone||null,s7_conditions:data.s7_conditions||null,s7_disease:data.s7_disease||null,s7_murmurs:data.s7_murmurs||null,s7_palpitations:data.s7_palpitations||null,s7_angina:data.s7_angina||null,
s7_blood_presure:data.s7_blood_presure||null,s7_comments:data.s7_comments||null,s8_exercise:data.s8_exercise||null,s8_asthma:data.s8_asthma||null,s8_emphysema:data.s8_emphysema||null,s8_hay_fever:data.s8_hay_fever||null,s8_tuberculosis:data.s8_tuberculosis||null,s8_obstructive:data.s8_obstructive||null,s8_rheumatic_fever:data.s8_rheumatic_fever||null,s8_bronchitis:data.s8_bronchitis||null,s8_coughed_blood:data.s8_coughed_blood||null,s8_shortness:data.s8_shortness||null,s8_comments:data.s8_comments||null,s9_hearing:data.s9_hearing||null,s9_infections_or_discharge:data.s9_infections_or_discharge||null,s9_hearing_aid:data.s9_hearing_aid||null,s9_injury_or_condition:data.s9_injury_or_condition||null,s9_near_or_distance:data.s9_near_or_distance||null,s9_color_blind:data.s9_color_blind||null,s9_eyes_or_ears:data.s9_eyes_or_ears||null,s9_comments:data.s9_comments||null,s10_indigestion:data.s10_indigestion||null,s10_vomited_blood:data.s10_vomited_blood||null,s10_bowel_habit:data.s10_bowel_habit||null,s10_time_you_urinate:data.s10_time_you_urinate||null,s10_night_to_urinate:data.s10_night_to_urinate||null,s10_start_stop_urine:data.s10_start_stop_urine||null,s10_change_urine:data.s10_change_urine||null,s10_comments:data.s10_comments||null,s11_medicaltion_or_counselling:data.s11_medicaltion_or_counselling||null,s11_psychologist_or_psychiatrist:data.s11_psychologist_or_psychiatrist||null,s11_sleeping_tablets:data.s11_sleeping_tablets||null,s11_drug_or_alcohol:data.s11_drug_or_alcohol||null,s11_depression:data.s11_depression||null,s11_panic:data.s11_panic||null,s11_anxiety:data.s11_anxiety||null,s11_insomnia:data.s11_insomnia||null,s11_any_condition:data.s11_any_condition||null,s11_comments:data.s11_comments||null,s12_narcolepsy:data.s12_narcolepsy||null,s12_exhaustion:data.s12_exhaustion||null,s12_shift_work:data.s12_shift_work||null,s12_environment:data.s12_environment||null,s12_very_hot_environment:data.s12_very_hot_environment||null,s12_illness:data.s12_illness||null,s12_sweat:data.s12_sweat||null,s12_hormonal:data.s12_hormonal||null,s12_stones_or_renal:data.s12_stones_or_renal||null,s12_comments:data.s12_comments||null,s13_ever_smoked:data.s13_ever_smoked||null,s13_each_date:data.s13_each_date||null,s13_one_date:data.s13_one_date||null,s13_many_cigarettes:data.s13_many_cigarettes||null,s13_start_stop_smoked:data.s13_start_stop_smoked||null,s13_exercise:data.s13_exercise||null,s13_aspect:data.s13_aspect||null,s13_comments:data.s13_comments||null,s14_tetanus:data.s14_tetanus||null,s14_helpa_helpb:data.s14_helpa_helpb||null,s14_comments:data.s14_comments||null,rmi_physical:data.rmi_physical||null,rmi_physical_initials:data.rmi_physical_initials||null,rmi_mental:data.rmi_mental||null,rmi_mental_initials:data.rmi_mental_initials||null,rmi_date:data.rmi_date||new Date,rmi_witness:data.rmi_witness||null,rmi_signed_witness:data.rmi_signed_witness||null,dec_signed:data.dec_signed||null,dec_witness:data.dec_witness||null,dec_signed_witness:data.dec_signed_witness||null,dec_date:data.dec_date||new Date,doctor_id:response[0].doctor.doctor_id||null,created_by:data.created_by||null,last_updated_by:data.last_updated_by||null,patient:response[0].patient||[],doctor:response[0].doctor||[],company:response[0].company||[],works:works||[],medications:medications||[]},oriInfo=angular.copy($scope.info),$scope.isNew?($scope.info.created_by=userInfo.id,clearInfo=angular.copy($scope.info)):($scope.info.last_updated_by=userInfo.id,clearInfo={mh_id:$scope.info.mh_id||null,patient_id:patient_id,cal_id:cal_id,s1_relationship:null,s1_job_location:null,s2_occupation1:null,s2_startdate1:null,s2_enddate1:null,s2_employ1:null,s2_occupation2:null,s2_startdate2:null,s2_enddate2:null,s2_employ2:null,s2_occupation3:null,s2_startdate3:null,s2_enddate3:null,s2_employ3:null,s2_occupation4:null,s2_startdate4:null,s2_enddate4:null,s2_employ4:null,s2_occupation5:null,s2_startdate5:null,s2_enddate5:null,s2_employ5:null,s2_samework:null,s2_sameworkenvironment:null,s2_comments:null,s3_name1:null,s3_reason1:null,s3_regularly1:null,s3_name2:null,s3_reason2:null,s3_regularly2:null,s3_name3:null,s3_reason3:null,s3_regularly3:null,s3_name4:null,s3_reason4:null,s3_regularly4:null,s3_name5:null,s3_reason5:null,s3_regular5:null,s3_comments:null,s4_concerning:null,s4_weight_altered:null,s4_medicaltreatment:null,s4_hospital:null,s4_stranfustion:null,s4_diabetes:null,s4_pressure:null,s4_asthma:null,s4_emphysema:null,s4_veins:null,s4_epilepsy:null,s4_episodes:null,s4_cancer_or_tumour:null,s4_concussion_or_headinjury:null,s4_migraine:null,s4_eczema:null,s4_hepatitis:null,s4_desease:null,s4_hormonal:null,s4_allergies:null,s4_comments:null,s5_disease:null,s5_claim:null,s5_claim_comment:null,s5_lodged:null,s5_closed:null,s5_duties:null,s5_sickness:null,s5_equipment:null,s5_chermicals:null,s5_noise:null,s5_radiation:null,s5_dust:null,s5_asbestos:null,s5_solvents:null,s5_other:null,s5_comments:null,s6_neck:null,s6_shoulder:null,s6_elbow:null,s6_wrist_or_hand:null,s6_lower_black:null,s6_hip:null,s6_knee:null,s6_ankle_or_foot:null,s6_comments1:null,s6_cervical:null,s6_lower:null,s6_sciatica:null,s6_pins_needles:null,s6_muscle_aches_pains:null,s6_joint_aches_pains:null,s6_comments2:null,s6_rsi:null,s6_tennis:null,s6_carpal:null,s6_hernia:null,s6_osteoarthritis:null,s6_arthritis:null,s6_osteoporosis:null,s6_fibromyalgia:null,s6_fractured_bones:null,s6_affects:null,s6_joint_or_bones:null,s6_comments3:null,s7_directfamily:null,s7_undergone:null,s7_conditions:null,s7_disease:null,s7_murmurs:null,s7_palpitations:null,s7_angina:null,s7_blood_presure:null,s7_comments:null,s8_exercise:null,s8_asthma:null,s8_emphysema:null,s8_hay_fever:null,s8_tuberculosis:null,s8_obstructive:null,s8_disease:null,s8_rheumatic_fever:null,s8_bronchitis:null,s8_coughed_blood:null,s8_shortness:null,s8_comments:null,s9_hearing:null,s9_infections_or_discharge:null,s9_hearing_aid:null,s9_injury_or_condition:null,s9_near_or_distance:null,s9_color_blind:null,s9_eyes_or_ears:null,s9_comments:null,s10_indigestion:null,s10_vomited_blood:null,s10_bowel_habit:null,s10_time_you_urinate:null,s10_night_to_urinate:null,s10_start_stop_urine:null,s10_change_urine:null,s10_comments:null,s11_medicaltion_or_counselling:null,s11_psychologist_or_psychiatrist:null,s11_sleeping_tablets:null,s11_drug_or_alcohol:null,s11_depression:null,s11_panic:null,s11_anxiety:null,s11_insomnia:null,s11_any_condition:null,s11_comments:null,s12_narcolepsy:null,s12_exhaustion:null,s12_shift_work:null,s12_environment:null,s12_very_hot_environment:null,s12_illness:null,s12_sweat:null,s12_hormonal:null,s12_stones_or_renal:null,s12_comments:null,s13_ever_smoked:null,s13_many_cigarettes:null,s13_start_stop_smoked:null,s13_exercise:null,s13_aspect:null,s13_comments:null,s14_tetanus:null,s14_helpa_helpb:null,s14_comments:null,rmi_physical:null,rmi_physical_initials:null,rmi_mental:null,rmi_mental_initials:null,rmi_date:new Date,rmi_witness:null,rmi_signed_witness:null,dec_signed:null,dec_witness:null,dec_signed_witness:null,dec_date:new Date,doctor_id:null,created_by:null,last_updated_by:null,patient:$scope.info.patient||[],doctor:$scope.info.doctor||[],company:$scope.info.company||[],works:clearWorks,medications:clearMedications})}),$scope.add_sec2=function(){$scope.count_sec2<4&&($scope.info.works.push({col1:null,col2:null,col3:null,col4:null,stt:!0}),++$scope.count_sec2)},$scope.del_sec2=function(index){$scope.info.works.splice(index,1),--$scope.count_sec2},$scope.add_sec3=function(){$scope.count_sec3<5&&($scope.info.medications.push({col1:null,col2:null,col3:null,stt:!0}),++$scope.count_sec3)},$scope.del_sec3=function(index){$scope.info.medications.splice(index,1),--$scope.count_sec3},$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.mhForm.$setPristine()},$scope.maxDate=new Date,$scope.clearForm=function(){$scope.info=angular.copy(clearInfo),$scope.mhForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.infoClear=function(){return!angular.equals(clearInfo,$scope.info)},$scope.submit=function(mhForm){if(mhForm.$error.required||mhForm.$error.maxlength||mhForm.$error.pattern)toastr.error("Please Input All Required Information!","Error");else{var info=$scope.info;$scope.isNew?DocumentService.insertMH(info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),$state.go("loggedIn.MH",null,{reload:!0})):"fail"===response.status&&toastr.error("Add new fail!","Error")}):DocumentService.editMH(info).then(function(response){"success"===response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.MH",null,{reload:!0})):"fail"===response.status&&toastr.error("Update fail!","Error")})}}}}}),angular.module("app.loggedIn.document.MRS.controllers",[]).controller("MRSController",function($filter,$scope,DocumentService,$http,$cookieStore,$state,toastr,$stateParams,localStorageService){$scope.dateOptions={formatYear:"yy",startingDay:1};var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist!"),$state.go("loggedIn.MRS",null,{reload:!0});else{var tempSignature;if($scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.practitionSign=tempSignature},$scope.clearClick=function(){$scope.info.practitionSign=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.practitionSign},$scope.patientInfo=localStorageService.get("tempPatient"),null===$scope.patientInfo||"undefined"===$scope.patientInfo)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load information fail, Please try again","Error");else{var patient_id=$scope.patientInfo.Patient_id,cal_id=$stateParams.cal_id;$scope.patientInfo.DOB=$filter("date")($scope.patientInfo.DOB,"dd/MM/yyyy"),$scope.info={patient_id:patient_id,cal_id:cal_id,idC:$scope.patientInfo.company_id};var oriInfo,info=$scope.info;DocumentService.loadMRS(info).then(function(response){if("fail"===response.status)$state.go("loggedIn.MRS",null,{raw:!0});else{if("not"==response.status)return toastr.error("You have to make Medical Assessment first","Error"),void $state.go("loggedIn.MA",null,{reload:!0});"findNull"===response[0].status?$scope.isNew=!0:"findFound"===response[0].status&&($scope.isNew=!1)}if("findFound"===response[0].status||"findNull"===response[0].status){var data=response[0].data;$scope.companyName=response[0].nameCompany,$scope.patient=response[0].patient,$scope.doctor=response[0].doctor,$scope.appt=response[0].appt,$scope.info={mrs_id:data.mrs_id,patient_id:patient_id,cal_id:cal_id,sticker_here:data.sticker_here,proposed:data.proposed,as_height:response[0].dataMA.HEIGHT,as_weight:response[0].dataMA.WEIGHT,as_whr:response[0].dataMA.WHR,as_bmi:response[0].dataMA.BMI,as_height_weight:data.as_height_weight,as_medical_history:data.as_medical_history,as_medical_assessment:data.as_medical_assessment,as_functional_assessment:data.as_functional_assessment,as_hearing_test:data.as_hearing_test,as_spirometry:data.as_spirometry,as_drug_test:data.as_drug_test,as_other:data.as_other,ac_any_existing_or_active:data.ac_any_existing_or_active,ac_any_history:data.ac_any_history,ac_cardiovascular:data.ac_cardiovascular,ac_any_current_or_work_related:data.ac_any_current_or_work_related,ac_any_medical_or_functional:data.ac_any_medical_or_functional,ac_any_diagnosed_or_previous:data.ac_any_diagnosed_or_previous,ac_examiner_comment:data.ac_examiner_comment,risk_rating:data.risk_rating,rr_amber_comment:data.rr_amber_comment,rr_red_comment:data.rr_red_comment,mrs_review:data.mrs_review,mrs_doc_date:data.mrs_doc_date||new Date,doctor_id:$scope.doctor.doctor_id,created_by:$scope.isNew?userInfo.id:data.created_by,last_updated_by:$scope.isNew?data.last_updated_by:userInfo.id}}oriInfo=angular.copy($scope.info)}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.mrsForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submit=function(mrsForm){if(mrsForm.$error.pattern||mrsForm.$error.maxlength||mrsForm.$error.required)toastr.error("Please Input All Required Information!","Error");else{var info=$scope.info;$scope.isNew===!0?DocumentService.insertMRS(info).then(function(response){"fail"===response.status?toastr.error("Add new fail","Error"):"success"===response.status?(toastr.success("Add new success","Success"),$state.go("loggedIn.MRS",null,{reload:!0})):$state.go("loggedIn.MRS",null,{reload:!0})}):$scope.isNew===!1&&DocumentService.editMRS(info).then(function(response){"fail"===response.status?toastr.error("Update fail!","Error"):"success"===response.status&&(toastr.success("Update success!","Success"),$state.go("loggedIn.MRS",null,{reload:!0}))})}}}}}),angular.module("app.loggedIn.document.SA1.controllers",[]).controller("SA1Controller",function($scope,$state,DocumentService,$http,$cookieStore,toastr,$stateParams,localStorageService){$scope.patientInfo=localStorageService.get("tempPatient");var CalID=$stateParams.cal_id,Patient_ID=$scope.patientInfo.Patient_id;$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.today=new Date,$scope.info=[];var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist!"),$state.go("loggedIn.SA1",null,{reload:!0});else{var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.Signature=tempSignature},$scope.clearClick=function(){$scope.info.Signature=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.Signature};var oriInfo;$scope.info={patient_id:Patient_ID,CAL_ID:CalID};var info=$scope.info;DocumentService.loadSA1(info).then(function(response){"fail"===response.status?$state.go("loggedIn.home",null,{reload:!0}):"findNull"===response[0].status?$scope.isNew=!0:"findFound"===response[0].status&&($scope.isNew=!1);var data=response[0];$scope.info.headers=[],$scope.info.patient=response[0].patient,$scope.info.doctor=response[0].doctor,$scope.info.appt=response[0].appt,$scope.info.site=response[0].site,$scope.info.company=response[0].company,angular.forEach(data.headers,function(dataH,hIndex){$scope.info.headers.push({patient_id:Patient_ID,CAL_ID:CalID,SA_ID:dataH.SA_ID,SA_NAME:dataH.SA_NAME,ISENABLE:dataH.ISENABLE,SA_CODE:dataH.SA_CODE,test_date:dataH.test_date||new Date,tester:dataH.tester||(null!==$scope.info.doctor.Title&&""!==$scope.info.doctor.Title?$scope.info.doctor.Title+" ":"")+(null!==$scope.info.doctor.First_name&&""!==$scope.info.doctor.First_name?$scope.info.doctor.First_name+" ":"")+(null!==$scope.info.doctor.Sur_name&&""!==$scope.info.doctor.Sur_name?$scope.info.doctor.Sur_name+" ":""),report_type:dataH.report_type,RECIPIENT_NAME:dataH.RECIPIENT_NAME,DOCTOR_ID:dataH.DOCTOR_ID||response[0].doctor.doctor_id,Signature:dataH.Signature,LOCATION_ID:dataH.LOCATION_ID,Created_by:$scope.isNew?userInfo.id:dataH.Created_by,Last_updated_by:$scope.isNew?dataH.Last_updated_by:userInfo.id,sections:[]}),$scope.info.Signature=$scope.info.headers[hIndex].Signature,$scope.info.test_date=$scope.info.headers[hIndex].test_date,$scope.info.RECIPIENT_NAME=$scope.info.headers[hIndex].RECIPIENT_NAME,$scope.info.tester=$scope.info.headers[hIndex].tester;var j=0;angular.forEach(data.sections,function(dataS){$scope.info.headers[hIndex].SA_ID===dataS.SA_ID&&($scope.info.headers[hIndex].sections.push({patient_id:Patient_ID,CAL_ID:CalID,SECTION_ID:dataS.SECTION_ID,SA_ID:dataS.SA_ID,SECTION_NAME:dataS.SECTION_NAME,ORD:dataS.ORD,USER_TYPE:dataS.USER_TYPE,ISENABLE:dataS.ISENABLE,Created_by:$scope.isNew?userInfo.id:dataS.Created_by,Last_updated_by:$scope.isNew?dataS.Last_updated_by:userInfo.id,lines:[]}),angular.forEach(data.lines,function(dataL){$scope.info.headers[hIndex].sections[j].SECTION_ID===dataL.SECTION_ID&&$scope.info.headers[hIndex].sections[j].lines.push({patient_id:Patient_ID,CAL_ID:CalID,LINE_ID:dataL.LINE_ID,SECTION_ID:dataL.SECTION_ID,SA_ID:dataL.SA_ID,NAME:dataL.NAME||dataL.Name,VALUE_RIGHT:dataL.VALUE_RIGHT,VALUE_LEFT:dataL.VALUE_LEFT,ISENABLE:dataL.ISENABLE,Created_by:$scope.isNew?userInfo.id:dataL.Created_by,Last_updated_by:$scope.isNew?dataL.Last_updated_by:userInfo.id})}),j++)})}),oriInfo=angular.copy($scope.info)}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.SA1.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submit=function(SA1){var info=$scope.info;SA1.$error.required||SA1.$error.maxlength||SA1.$error.pattern?toastr.error("Please Input All Required Information!","Error"):$scope.isNew===!0?DocumentService.insertSA1(info).then(function(response){"fail"===response.status?toastr.error("Add fail!","Error"):"success"===response.status?(toastr.success("Add success!","Success"),$state.go("loggedIn.SA1",null,{reload:!0})):$state.go("loggedIn.home",null,{reload:!0})}):$scope.isNew===!1&&DocumentService.editSA1(info).then(function(response){"fail"===response.status?toastr.error("Update fail!","Error"):"success"===response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.SA1",null,{reload:!0})):$state.go("loggedIn.home",null,{reload:!0})})}}}),angular.module("app.loggedIn.document.SA2.controllers",[]).controller("SA2Controller",function($scope,$state,DocumentService,$http,$cookieStore,toastr,$stateParams,localStorageService){$scope.patientInfo=localStorageService.get("tempPatient");var CalID=$stateParams.cal_id,Patient_ID=$scope.patientInfo.Patient_id;$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.today=new Date,$scope.info=[];var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist!"),$state.go("loggedIn.SA1",null,{reload:!0});else{var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.Signature=tempSignature},$scope.clearClick=function(){$scope.info.Signature=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.Signature};var oriInfo;$scope.info={patient_id:Patient_ID,CAL_ID:CalID};var info=$scope.info;DocumentService.loadSA2(info).then(function(response){"fail"===response.status?$state.go("loggedIn.home",null,{reload:!0}):"findNull"===response[0].status?$scope.isNew=!0:"findFound"===response[0].status&&($scope.isNew=!1);var data=response[0];$scope.info.headers=[],$scope.info.patient=response[0].patient,$scope.info.doctor=response[0].doctor,$scope.info.appt=response[0].appt,$scope.info.site=response[0].site,$scope.info.company=response[0].company,angular.forEach(data.headers,function(dataH,hIndex){$scope.info.headers.push({patient_id:Patient_ID,CAL_ID:CalID,SA_ID:dataH.SA_ID,SA_NAME:dataH.SA_NAME,ISENABLE:dataH.ISENABLE,SA_CODE:dataH.SA_CODE,test_date:dataH.test_date||new Date,tester:dataH.tester,report_type:dataH.report_type,RECIPIENT_NAME:dataH.RECIPIENT_NAME,DOCTOR_ID:dataH.DOCTOR_ID||response[0].doctor.doctor_id,Signature:dataH.Signature,LOCATION_ID:dataH.LOCATION_ID,Created_by:$scope.isNew?userInfo.id:dataH.Created_by,Last_updated_by:$scope.isNew?dataH.Last_updated_by:userInfo.id,sections:[]}),$scope.info.Signature=$scope.info.headers[hIndex].Signature,$scope.info.test_date=$scope.info.headers[hIndex].test_date,$scope.info.RECIPIENT_NAME=$scope.info.headers[hIndex].RECIPIENT_NAME,$scope.info.tester=$scope.info.headers[hIndex].tester;var j=0;angular.forEach(data.sections,function(dataS){$scope.info.headers[hIndex].SA_ID===dataS.SA_ID&&($scope.info.headers[hIndex].sections.push({patient_id:Patient_ID,CAL_ID:CalID,SECTION_ID:dataS.SECTION_ID,SA_ID:dataS.SA_ID,SECTION_NAME:dataS.SECTION_NAME,ORD:dataS.ORD,USER_TYPE:dataS.USER_TYPE,ISENABLE:dataS.ISENABLE,Created_by:$scope.isNew?userInfo.id:dataS.Created_by,Last_updated_by:$scope.isNew?dataS.Last_updated_by:userInfo.id,lines:[]}),angular.forEach(data.lines,function(dataL){$scope.info.headers[hIndex].sections[j].SECTION_ID===dataL.SECTION_ID&&$scope.info.headers[hIndex].sections[j].lines.push({patient_id:Patient_ID,CAL_ID:CalID,LINE_ID:dataL.LINE_ID,SECTION_ID:dataL.SECTION_ID,SA_ID:dataL.SA_ID,NAME:dataL.NAME||dataL.Name,VALUE_RIGHT:dataL.VALUE_RIGHT,VALUE_LEFT:dataL.VALUE_LEFT,ISENABLE:dataL.ISENABLE,Created_by:$scope.isNew?userInfo.id:dataL.Created_by,Last_updated_by:$scope.isNew?dataL.Last_updated_by:userInfo.id})}),j++)})}),oriInfo=angular.copy($scope.info)}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.SA2.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submit=function(SA2){var info=$scope.info;SA2.$error.required||SA2.$error.maxlength||SA2.$error.pattern?toastr.error("Please Input All Required Information!","Error"):$scope.isNew===!0?DocumentService.insertSA2(info).then(function(response){"fail"===response.status?toastr.error("Add fail!","Error"):"success"===response.status?(toastr.success("Add success!","Success"),$state.go("loggedIn.SA2",null,{reload:!0})):$state.go("loggedIn.home",null,{reload:!0})}):$scope.isNew===!1&&DocumentService.editSA2(info).then(function(response){"fail"===response.status?toastr.error("Update fail!","Error"):"success"===response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.SA2",null,{reload:!0})):$state.go("loggedIn.home",null,{reload:!0})})}}}),angular.module("app.loggedIn.document.form18.controllers",[]).controller("form18Controller",function($scope,DocumentService,$rootScope,$http,$cookieStore,toastr,$state,$stateParams,localStorageService){$scope.dateOptions={formatYear:"yy",startingDay:1};var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist"),$state.go("loggedIn.home",null,{reload:!0});else{$scope.today=new Date;var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.PERSON_ARRANGING_SIGNATURE=tempSignature},$scope.clearClick=function(){$scope.info.PERSON_ARRANGING_SIGNATURE=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.PERSON_ARRANGING_SIGNATURE};var tempSignature1;$scope.isSignature1=!1,$scope.showSignature1=function(){$scope.isSignature1=!$scope.isSignature1},$scope.cancelClick1=function(){$scope.isSignature1=!$scope.isSignature1,$scope.info.WORKER_SIGNATURE=tempSignature1},$scope.clearClick1=function(){$scope.info.WORKER_SIGNATURE=""},$scope.okClick1=function(){$scope.isSignature1=!$scope.isSignature1,tempSignature1=$scope.info.WORKER_SIGNATURE};var patientInfo=localStorageService.get("tempPatient");if(null==patientInfo||"undefined"==patientInfo)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load some information fail, please try again!","Error");else{var Patient_ID=patientInfo.Patient_id,CalID=$stateParams.cal_id;$scope.info={GORGON_ID:null,PATIENT_ID:Patient_ID,CAL_ID:CalID,DocId:null,TIME_TEST:new Date,WORK_COVER_NO:null,PERSON_ARRANGING_SIGNATURE:null,PERSON_ARRANGING_NAME:null,PERSON_ARRANGING_POSITION:null,DOCTOR_ID:null,WORKER_SIGNATURE:null};var oriInfo,info=$scope.info;DocumentService.loadForm18(info).then(function(response){if("fail"===response.status)$state.go("loggedIn.demo",null,{reload:!0}),toastr.error("Load information fail, Please try again!","Error");else if("findNull"===response[0].status)$scope.isNew=!0,$scope.info.patient=response[0].patient,$scope.info.doctor=response[0].doctor,$scope.info.APPT=response[0].APPT,$scope.info.rmSite=response[0].rmSite,$scope.info.company=response[0].company,$scope.info.Created_by=userInfo.id,oriInfo=angular.copy($scope.info);else if("findFound"===response[0].status){$scope.isNew=!1;var data=response[0].dataF18;$scope.info={doctorInfo:response[0].doctor,apptInfo:response[0].APPT,patient:response[0].patient,doctor:response[0].doctor,APPT:response[0].APPT,rmSite:response[0].rmSite,company:response[0].company,GORGON_ID:data.GORGON_ID,PATIENT_ID:data.PATIENT_ID,CAL_ID:data.CAL_ID,DocId:data.DocId,TIME_TEST:data.TIME_TEST,WORK_COVER_NO:data.WORK_COVER_NO,PERSON_ARRANGING_SIGNATURE:data.PERSON_ARRANGING_SIGNATURE,PERSON_ARRANGING_NAME:data.PERSON_ARRANGING_NAME,PERSON_ARRANGING_POSITION:data.PERSON_ARRANGING_POSITION,DOCTOR_ID:response[0].doctor.DOCTOR_ID,WORKER_SIGNATURE:data.WORKER_SIGNATURE,Created_by:data.Created_by,Last_updated_by:userInfo.id},oriInfo=angular.copy($scope.info)}else $state.go("loggedIn.home",null,{reload:!0})}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.form18.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submit=function(form18){if(form18.$error.maxlength||form18.$error.required||form18.$error.pattern)toastr.error("Please Input All Required Information!","Success");else{var info=$scope.info;$scope.isNew===!0?DocumentService.insertForm18(info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),$state.go("loggedIn.Form18",null,{reload:!0})):"fail"===response.status?toastr.error("Add new fail!","Error"):$state.go("loggedIn.home",null,{reload:!0})}):$scope.isNew===!1&&DocumentService.editForm18(info).then(function(response){"success"===response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.Form18",null,{reload:!0})):"fail"===response.status?toastr.error("Update fail!","Error"):$state.go("loggedIn.home",null,{reload:!0})})}}}}}),angular.module("app.loggedIn.document.gorgonFA.controllers",[]).controller("gorgonFAController",function($scope,$filter,DocumentService,ConfigService,$http,$cookieStore,$state,toastr,$window,$stateParams,localStorageService){function getAge(dateString){var now=new Date,birthDate=new Date(dateString),age=now.getFullYear()-birthDate.getFullYear(),m=now.getMonth()-birthDate.getMonth();return(0>m||0===m&&now.getDate()<birthDate.getDate())&&age--,age}var tempSignature,oriInfo;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.fsign=tempSignature},$scope.clearClick=function(){$scope.info.fsign=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.fsign},$scope.dateOptions={formatYear:"yy",startingDay:1};var date=new Date;$filter("date")(date,"dd/MM/yyyy"),$scope.patientInfo=localStorageService.get("tempPatient");var Patient_ID=$scope.patientInfo.Patient_id,CalID=$stateParams.cal_id,sex=$scope.patientInfo.Sex;$scope.print=function(){$window.location.href="/api/document/gorgonFA/print/7"};var value;$scope.grip=function(){value=0,$scope.info.c_Right3>0||$scope.info.c_Left3>0?(1*$scope.info.c_Right3>=$scope.info.c_Left3?value=$scope.info.c_Right3:1*$scope.info.c_Right3<$scope.info.c_Left3&&(value=$scope.info.c_Left3),"Male"==sex?40>value?$scope.info.c_Result3=1:value>=40&&45>=value?$scope.info.c_Result3=2:value>=46&&51>=value?$scope.info.c_Result3=3:value>=52&&55>=value?$scope.info.c_Result3=4:value>55&&($scope.info.c_Result3=5):"Female"==sex&&(23>value?$scope.info.c_Result3=1:value>=23&&26>=value?$scope.info.c_Result3=2:value>=27&&29>=value?$scope.info.c_Result3=3:value>=30&&33>=value?$scope.info.c_Result3=4:value>33&&($scope.info.c_Result3=5))):""==$scope.info.c_Left3?$scope.info.c_Result3=0:null==$scope.info.c_Left3?$scope.info.c_Result3=0:""==$scope.info.c_Right3?$scope.info.c_Result3=0:null==$scope.info.c_Right3&&($scope.info.c_Result3=0)},$scope.d_Push_ups=function(){value=$scope.info.d_Push_ups_total3,value>0?"Male"==sex?value>=1&&5>=value?$scope.info.d_Result3=1:value>=6&&8>=value?$scope.info.d_Result3=2:value>=9&&12>=value?$scope.info.d_Result3=3:value>=13&&15>=value?$scope.info.d_Result3=4:value>15&&($scope.info.d_Result3=5):"Female"==sex&&(value>=1&&2>=value?$scope.info.d_Result3=1:value>=3&&4>=value?$scope.info.d_Result3=2:value>=5&&6>=value?$scope.info.d_Result3=3:value>=7&&10>=value?$scope.info.d_Result3=4:value>10&&($scope.info.d_Result3=5)):$scope.info.d_Result3=0},$scope.e_total3=function(){value=$scope.info.e_total3,value?value>=0&&30>=value?$scope.info.e_Result3=1:value>30&&60>=value?$scope.info.e_Result3=2:value>60&&90>=value?$scope.info.e_Result3=3:value>90&&120>=value?$scope.info.e_Result3=4:value>120&&($scope.info.e_Result3=5):$scope.info.e_Result3=null},$scope.aSec4=function(){value=$scope.info.aSec4,value?0==value?$scope.info.aResult4=1:value>=1&&20>=value?$scope.info.aResult4=2:value>=21&&40>=value?$scope.info.aResult4=3:value>=41&&60>=value?$scope.info.aResult4=4:value>60&&($scope.info.aResult4=5):$scope.info.aResult4=null},$scope.bTotal4=function(){value=$scope.info.bTotal4,value?0==value?$scope.info.bResult4=1:value>=1&&9>=value?$scope.info.bResult4=2:value>=10&&14>=value?$scope.info.bResult4=3:value>=15&&19>=value?$scope.info.bResult4=4:value>=20&&($scope.info.bResult4=5):$scope.info.bResult4=null},$scope.cKneeling4=function(){value=$scope.info.cKneeling4,value?0==value?$scope.info.cResult4=1:value>=1&&10>=value?$scope.info.cResult4=2:value>=11&&20>=value?$scope.info.cResult4=3:value>=21&&30>=value?$scope.info.cResult4=4:value>30&&($scope.info.cResult4=5):$scope.info.cResult4=null},$scope.aMax=function(){value=$scope.info.aMax6,value?value>45?$scope.info.aResult6=5:value>=23&&45>=value?$scope.info.aResult6=4:value>=10&&22>=value?$scope.info.aResult6=3:value>=6&&9>=value?$scope.info.aResult6=2:value>=0&&5>=value&&($scope.info.aResult6=1):$scope.info.aResult6=null},$scope.bMax=function(){value=$scope.info.bMax6,value?value>23?$scope.info.bResult6=5:value>=12&&23>=value?$scope.info.bResult6=4:value>=6&&11>=value?$scope.info.bResult6=3:value>=4&&5>=value?$scope.info.bResult6=2:value>=0&&3>=value&&($scope.info.bResult6=1):$scope.info.bResult6=null},$scope.cStrenght5=function(){value=$scope.info.cStrenght5,value?0==value?$scope.info.cResult5=1:value>=1&&20>=value?$scope.info.cResult5=2:value>=21&&40>=value?$scope.info.cResult5=3:value>=41&&60>=value?$scope.info.cResult5=4:value>60&&($scope.info.cResult5=5):$scope.info.cResult5=null},$scope.dTotal5=function(){value=$scope.info.dTotal5,value?0==value?$scope.info.dResult5=1:value>=1&&5>=value?$scope.info.dResult5=2:value>5&&10>=value?$scope.info.dResult5=3:value>=11&&15>=value?$scope.info.dResult5=4:value>15&&($scope.info.dResult5=5):$scope.info.dResult5=null};var len,str,totalCom="";$scope.collectComment=function(){$scope.info.LComment=(null!=$scope.info.Rom_Comments1&&""!=$scope.info.Rom_Comments1?$scope.info.Rom_Comments1+"\n":"")+(null!=$scope.info.Comments2&&""!=$scope.info.Comments2?$scope.info.Comments2+"\n":"")+totalCom},$scope.totalComment=function(){"undefined"==typeof $scope.info.LComment&&($scope.info.LComment=(null!=$scope.info.Rom_Comments1&&""!=$scope.info.Rom_Comments1?$scope.info.Rom_Comments1+"\n":"")+(null!=$scope.info.Comments2&&""!=$scope.info.Comments2?$scope.info.Comments2+"\n":"")),len=(null!=$scope.info.Rom_Comments1?$scope.info.Rom_Comments1.length:0)+(null!=$scope.info.Comments2?$scope.info.Comments2.length:0),str=$scope.info.LComment.replace("\n",""),str=str.replace("\n",""),totalCom=str.substr(len)},$scope.maxDateDOB=new Date(date.getFullYear()-1,date.getMonth(),date.getDate()),$scope.maxDate=date,$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.gorgonFAForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)};var insert=!0,FName="",SName="",MName="";DocumentService.checkGorgonFA(Patient_ID,CalID).then(function(response){"not"==response.status?(toastr.error("You have to make Pre-employment Health Assessment first","Error"),$state.go("loggedIn.gorgonMA",null,{reload:!0})):"insert"===response.status?(insert=!0,$scope.isNew=!0,FName=null!=$scope.patientInfo.First_name?$scope.patientInfo.First_name:"",SName=null!=$scope.patientInfo.Sur_name?$scope.patientInfo.Sur_name:"",
MName=null!=$scope.patientInfo.Middle_name?$scope.patientInfo.Middle_name:"",$scope.info={id:null,patientId:Patient_ID,fName:FName+" "+MName+" "+SName,age:null,JAF:null,DOB:$scope.patientInfo.DOB,DOA:date,IsConsentReason:null,fsign:null,fsignDate:date,Estimated:null,EstimatedComments:null,MS_HeartConditions:null,MS_HeartConditions_Comment:null,MS_Lung_Asthma:null,MS_Lung__Asthma_Comment:null,MS_Diabetes:null,MS_Diabetes_Comment:null,MS_Fits:null,MS_Fits_Comment:null,MS_Medication:null,MS_Medication_Comment:null,MS_Other:null,MS_Other_Comment:null,MS_ie_Comment:null,MS_Mx_Heart_Rage_1:null!=$scope.patientInfo.DOB?getAge($scope.patientInfo.DOB):0,MS_Mx_Heart_Rage_2:null,MS_Mx_Weight_1:response.data.WEIGHT,MS_MX_Weight_2:null,MS_Blood_Pressure_1:response.data.SYSTOLIC_BP,MS_Blood_Pressure_2:response.data.DIASTOLIC_BP,MS_Resting_Heart_Rate:response.data.PULSE,Rom_Neck1:null,Rom_Thoracic1:null,Rom_Lumbar1:null,Rom_Shoulder1:null,Rom_Elbow1:null,Rom_Wrist1:null,Rom_Fingers1:null,Rom_Hips1:null,Rom_Knees1:null,Rom_Ankles1:null,Rom_Comments1:null,Rom_Total1:0,Heart_Rate_30S2:null,Heart_Rate_1M2:null,Heart_Rate_1M_30S2:null,Heart_Rate_2M2:null,Heart_Rate_2M_30S2:null,Heart_Rate_3M2:null,Heart_Rate_1M_Post2:null,Step_Result2:null,Step_Correct2:null,Comments2:null,Total2:null,a_Right3:null,a_Left3:null,b_Right3:null,b_Left3:null,c_Grip3:null,c_Right3:null,c_Left3:null,c_Result3:0,d_Push_ups_total3:null,d_Result3:0,e_total3:null,e_Result3:0,Comments3:null,Total3:0,aSec4:null,aResult4:null,bTotal4:null,bCrepitus4:null,bResult4:null,cKneeling4:null,cResult4:null,Comments4:null,Total4:0,aPosture5:null,bHoverResult5:null,cStrenght5:null,cResult5:null,dTotal5:null,dResult5:null,eWaitesBow5:null,eResult5:null,fRight5:null,fLeft5:null,gRight5:null,gFloat5:null,Total5:0,aMax6:null,aResult6:null,bMax6:null,bResult6:null,c_16:0,c_1Comment6:null,c_26:0,c_2Comment6:null,c_36:0,c_3Comment6:null,c_46:0,c_4Comment6:null,c_56:0,c_5Comment6:null,Comments6:null,Total6:0,Score1Comment:null,Score2Comment:null,Score3Comment:null,Score4Comment:null,Score5Comment:null,Score6Comment:null,Score7Comment:null,Score8Comment:null,FCAToTal:0,FCAResult:null,LEPDC:null,LAPC:null,LComment:null,DocId:response.docID,LName:response.docName,LPosition:"",Chest:0,Lsign:response.docSign,LDate:date,Created_by:null,Last_updated_by:null,CalId:CalID},oriInfo=angular.copy($scope.info)):"update"==response.status?(insert=!1,$scope.isNew=!1,$scope.info={id:response.data.id,patientId:response.data.patientId,fName:response.data.fName,JAF:response.data.JAF,DOB:response.data.DOB,DOA:response.data.DOA,IsConsentReason:response.data.IsConsentReason,fsign:response.data.fsign,fsignDate:response.data.fsignDate,Estimated:response.data.Estimated,EstimatedComments:response.data.EstimatedComments,MS_HeartConditions:response.data.MS_HeartConditions,MS_HeartConditions_Comment:response.data.MS_HeartConditions_Comment,MS_Lung_Asthma:response.data.MS_Lung_Asthma,MS_Lung__Asthma_Comment:response.data.MS_Lung__Asthma_Comment,MS_Diabetes:response.data.MS_Diabetes,MS_Diabetes_Comment:response.data.MS_Diabetes_Comment,MS_Fits:response.data.MS_Fits,MS_Fits_Comment:response.data.MS_Fits_Comment,MS_Medication:response.data.MS_Medication,MS_Medication_Comment:response.data.MS_Medication_Comment,MS_Other:response.data.MS_Other,MS_Other_Comment:response.data.MS_Other_Comment,MS_ie_Comment:response.data.MS_ie_Comment,MS_Mx_Heart_Rage_1:response.data.MS_Mx_Heart_Rage_1,MS_Mx_Heart_Rage_2:response.data.MS_Mx_Heart_Rage_2,MS_Mx_Weight_1:response.data.MS_Mx_Weight_1,MS_MX_Weight_2:response.data.MS_MX_Weight_2,MS_Blood_Pressure_1:response.data.MS_Blood_Pressure_1,MS_Blood_Pressure_2:response.data.MS_Blood_Pressure_2,MS_Resting_Heart_Rate:response.data.MS_Resting_Heart_Rate,Rom_Neck1:response.data["1Rom_Neck"],Rom_Thoracic1:response.data["1Rom_Thoracic"],Rom_Lumbar1:response.data["1Rom_Lumbar"],Rom_Shoulder1:response.data["1Rom_Shoulder"],Rom_Elbow1:response.data["1Rom_Elbow"],Rom_Wrist1:response.data["1Rom_Wrist"],Rom_Fingers1:response.data["1Rom_Fingers"],Rom_Hips1:response.data["1Rom_Hips"],Rom_Knees1:response.data["1Rom_Knees"],Rom_Ankles1:response.data["1Rom_Ankles"],Rom_Comments1:response.data["1Rom_Comments"],Rom_Total1:response.data["1Rom_Total"],Heart_Rate_30S2:response.data["2Heart_Rate_30S"],Heart_Rate_1M2:response.data["2Heart_Rate_1M"],Heart_Rate_1M_30S2:response.data["2Heart_Rate_1M_30S"],Heart_Rate_2M2:response.data["2Heart_Rate_2M"],Heart_Rate_2M_30S2:response.data["2Heart_Rate_2M_30S"],Heart_Rate_3M2:response.data["2Heart_Rate_3M"],Heart_Rate_1M_Post2:response.data["2Heart_Rate_1M_Post"],Step_Result2:response.data["2Step_Result"],Step_Correct2:response.data["2Step_Correct"],Comments2:response.data["2Comments"],Total2:response.data["2Total"],a_Right3:response.data["3a_Right"],a_Left3:response.data["3a_Left"],b_Right3:response.data["3b_Right"],b_Left3:response.data["3b_Left"],c_Grip3:response.data["3c_Grip"],c_Right3:response.data["3c_Right"],c_Left3:response.data["3c_Left"],c_Result3:response.data["3c_Result"],d_Push_ups_total3:response.data["3d_Push_ups_total"],d_Result3:response.data["3d_Result"],e_total3:response.data["3e_total"],e_Result3:response.data["3e_Result"],Comments3:response.data["3Comments"],Total3:response.data["3Total"],aSec4:response.data["4aSec"],aResult4:response.data["4aResult"],bTotal4:response.data["4bTotal"],bCrepitus4:response.data["4bCrepitus"],bResult4:response.data["4bResult"],cKneeling4:response.data["4cKneeling"],cResult4:response.data["4cResult"],Comments4:response.data["4Comments"],Total4:response.data["4Total"],aPosture5:response.data["5aPosture"],bHoverResult5:response.data["5bHoverResult"],cStrenght5:response.data["5cStrenght"],cResult5:response.data["5cResult"],dTotal5:response.data["5dTotal"],dResult5:response.data["5dResult"],eWaitesBow5:response.data["5eWaitesBow"],eResult5:response.data["5eResult"],fRight5:response.data["5fRight"],fLeft5:response.data["5fLeft"],gRight5:response.data["5gRight"],gFloat5:response.data["5gFloat"],Total5:response.data["5Total"],aMax6:response.data["6aMax"],aResult6:response.data["6aResult"],bMax6:response.data["6bMax"],bResult6:response.data["6bResult"],c_16:response.data["6c_1"],c_1Comment6:response.data["6c_1Comment"],c_26:response.data["6c_2"],c_2Comment6:response.data["6c_2Comment"],c_36:response.data["6c_3"],c_3Comment6:response.data["6c_3Comment"],c_46:response.data["6c_4"],c_4Comment6:response.data["6c_4Comment"],c_56:response.data["6c_5"],c_5Comment6:response.data["6c_5Comment"],Comments6:response.data["6Comments"],Total6:response.data["6Total"],Score1Comment:response.data.Score1Comment,Score2Comment:response.data.Score2Comment,Score3Comment:response.data.Score3Comment,Score4Comment:response.data.Score4Comment,Score5Comment:response.data.Score5Comment,Score6Comment:response.data.Score6Comment,Score7Comment:response.data.Score7Comment,Score8Comment:response.data.Score8Comment,FCAToTal:response.data.FCAToTal,FCAResult:response.data.FCAResult,LEPDC:response.data.LEPDC,LAPC:response.data.LAPC,LComment:response.data.LComment,Created_by:response.data.Created_by,Lsign:response.data.Lsign,LName:response.data.LName,LDate:response.data.LDate,LPosition:response.data.LPosition,Chest:response.data.Chest,Last_updated_by:response.data.Last_updated_by,CalId:response.data.CalId,DocId:response.data.DocId},oriInfo=angular.copy($scope.info),$scope.totalComment()):"error"==response.status&&toastr.error("Fail","Error")}),$scope.submitGorgonFA=function(gorgonFAForm){if($scope.showClickedValidation=!0,gorgonFAForm.$invalid)toastr.error("Please Input All Required Information!","Error");else if(1==insert){var info=$scope.info;DocumentService.insertGorgonFA(info).then(function(response){"success"===response.status?(toastr.success("Successfully","Success"),$state.go("loggedIn.gorgonFA",null,{reload:!0})):toastr.error("Fail","Error")})}else DocumentService.editGorgonFA($scope.info).then(function(response){"success"===response.status?(toastr.success("Successfully","Success"),$state.go("loggedIn.gorgonFA",null,{reload:!0})):toastr.error("Fail","Error")})}}),angular.module("app.loggedIn.document.gorgonMA.controllers",[]).controller("gorgonMAController",function($scope,$filter,DocumentService,ConfigService,$http,$cookieStore,$state,toastr,$stateParams,localStorageService){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.patientInfo=localStorageService.get("tempPatient");var CalID=$stateParams.cal_id,Patient_ID=$scope.patientInfo.Patient_id;$scope.checkAudiogram=function(){1==$scope.info.AUDIOGRAM&&($scope.info.RIGHT_EAR_500=null,$scope.info.RIGHT_EAR_1000=null,$scope.info.RIGHT_EAR_1500=null,$scope.info.RIGHT_EAR_2000=null,$scope.info.RIGHT_EAR_3000=null,$scope.info.RIGHT_EAR_4000=null,$scope.info.RIGHT_EAR_6000=null,$scope.info.RIGHT_EAR_8000=null,$scope.info.LEFT_EAR_500=null,$scope.info.LEFT_EAR_1000=null,$scope.info.LEFT_EAR_1500=null,$scope.info.LEFT_EAR_2000=null,$scope.info.LEFT_EAR_3000=null,$scope.info.LEFT_EAR_4000=null,$scope.info.LEFT_EAR_6000=null,$scope.info.LEFT_EAR_8000=null)},$scope.checkSpirometry=function(){1==$scope.info.SPIROMETRY&&($scope.info.PRE_BR1_V1=null,$scope.info.PRE_BR1_V2=null,$scope.info.PRE_BR1_V3=null,$scope.info.PRE_BR1_V4=null,$scope.info.PRE_BR1_V5=null,$scope.info.PRE_BR1_V6=null,$scope.info.PRE_BR1_V7=null,$scope.info.PRE_BR2_V1=null,$scope.info.PRE_BR2_V2=null,$scope.info.PRE_BR2_V3=null,$scope.info.PRE_BR2_V4=null,$scope.info.PRE_BR2_V5=null,$scope.info.PRE_BR2_V6=null,$scope.info.PRE_BR2_V7=null)};var date=new Date;$filter("date")(date,"dd/MM/yyyy"),$scope.maxDate=new Date(date.getFullYear()-1,date.getMonth(),date.getDate()),$scope.info={GORGON_ID:null,PATIENT_ID:Patient_ID,PHOTO_ID:null,HAND_DOR:null,HEIGHT:null,WEIGHT:null,PROTEIN:null,GLUCOSE:null,BLOOD:null,CANNABIS:null,OPIATES:null,AMPHETS:null,ANCOHOL:null,BENZOS:null,COCAIN:null,METHAMPH:null,AUDIOGRAM:0,SPIROMETRY:0,SPIROMETRY_STATIS:null,CANDIDATE_EVER:null,YES_TO_EITHER:null,SPI_EXAMINERS_COMMENTS:null,VA_UNCORRECTED_LEFT:null,VA_UNCORRECTED_RIGHT:null,VA_CORRECTED_LEFT:null,VA_CORRECTED_RIGHT:null,NV_UNCORRECTED_LEFT:null,NV_UNCORRECTED_RIGHT:null,NV_CORRECTED_LEFT:null,NV_CORRECTED_RIGHT:null,VF_LEFT:null,VF_RIGHT:null,ISHIHARA_RESPONSE:null,AS_Nil:0,AS_Wide:0,AS_Basal:0,AS_Wheezes:0,AS_Rub:0,EC_normal:0,EC_dermatitis:0,EC_fungal:0,EC_structural:0,EC_wax:0,TM_normal:0,TM_effusion:0,TM_wet:0,TM_dry:0,SYSTOLIC_BP:null,DIASTOLIC_BP:null,PULSE:null,HEART_RHYTHM:null,HEART_SOUNDS:null,PACEMAKER:null,CHEST:null,UPPER_ZONES:null,LOWER_ZONES:null,ECZEMA:null,PSORIASIS:null,TINEA:null,SOLAR_DAMAGE:null,FOLLICULITIS:null,EC_OTHER:null,SKIN_EXAMINERS_COMMENTS:null,SCARS_NIL:0,SCARS_APPENDIX:0,SCARS_GALLBLADDER:0,SCARS_HERNIA:0,SCARS_OTHER:0,HERNIAL:null,HERNIAL_LEFT:0,HERNIAL_RIGHT:0,RECTUS:null,MUSCLE_TONE:null,MUSCLE_POWER:null,MUSCLE_WASTING:null,TREMOR:null,GAIT:null,LOWER_LEFT:null,LOWER_RIGHT:null,CNS_COMMENTS:null,NECK_POSTURE:null,NECK_RHYTHM:null,NECK_FLEXION:null,NECK_EXTENSION:null,NECK_LATERAL:null,NECK_ROTATION:null,BACK_POSTURE:null,BACK_RHYTHM:null,BACK_FLEXION:null,BACK_EXTENSION:null,BACK_LATERAL:null,BACK_ROTATION:null,BACK_EXAMINERS_COMMENTS:null,SHOULDER:null,ELBOWS:null,WRISTS:null,KNEES:null,ANKLES:null,GRIP_STRENGTH:null,EPICONDYLES:null,HEEL_WALK:null,DUCK_WALK:null,TOE_WALK:null,RHOMBERGS:null,FUTHER_COMMENTS:null,LIMB_EXAMINERS_COMMENTS:null,GORGON_DATE:null,SIGNATURE:null,Created_by:null,Last_updated_by:null,CalId:CalID,EXAMINER_NAME:null,EXAMINER_ADDRESS:null,RIGHT_EAR_500:null,RIGHT_EAR_1000:null,RIGHT_EAR_1500:null,RIGHT_EAR_2000:null,RIGHT_EAR_3000:null,RIGHT_EAR_4000:null,RIGHT_EAR_6000:null,RIGHT_EAR_8000:null,LEFT_EAR_500:null,LEFT_EAR_1000:null,LEFT_EAR_1500:null,LEFT_EAR_2000:null,LEFT_EAR_3000:null,LEFT_EAR_4000:null,LEFT_EAR_6000:null,LEFT_EAR_8000:null,PRE_BR1_V1:null,PRE_BR1_V2:null,PRE_BR1_V3:null,PRE_BR1_V4:null,PRE_BR1_V5:null,PRE_BR1_V6:null,PRE_BR1_V7:null,PRE_BR2_V1:null,PRE_BR2_V2:null,PRE_BR2_V3:null,PRE_BR2_V4:null,PRE_BR2_V5:null,PRE_BR2_V6:null,PRE_BR2_V7:null,PROTEIN_COMMENT:null,GLUCOSE_COMMENT:null,BLOOD_COMMENT:null,DocId:null,docName:null,docSign:null};var oriInfo;$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.gorgonMAForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)};var len,str,totalCom="";$scope.collectComment=function(){$scope.info.BLOOD_COMMENT=1==$scope.info.BLOOD?"":$scope.info.BLOOD_COMMENT,$scope.info.GLUCOSE_COMMENT=1==$scope.info.GLUCOSE?"":$scope.info.GLUCOSE_COMMENT,$scope.info.PROTEIN_COMMENT=1==$scope.info.PROTEIN?"":$scope.info.PROTEIN_COMMENT,$scope.info.SPI_EXAMINERS_COMMENTS=(null!=$scope.info.PROTEIN_COMMENT&&""!=$scope.info.PROTEIN_COMMENT?$scope.info.PROTEIN_COMMENT+"\n":"")+(null!=$scope.info.GLUCOSE_COMMENT&&""!=$scope.info.GLUCOSE_COMMENT?$scope.info.GLUCOSE_COMMENT+"\n":"")+(null!=$scope.info.BLOOD_COMMENT&&""!=$scope.info.BLOOD_COMMENT?$scope.info.BLOOD_COMMENT+"\n":"")+totalCom},$scope.totalComment=function(){"undefined"==typeof $scope.info.SPI_EXAMINERS_COMMENTS&&($scope.info.SPI_EXAMINERS_COMMENTS=(null!=$scope.info.PROTEIN_COMMENT&&""!=$scope.info.PROTEIN_COMMENT?$scope.info.PROTEIN_COMMENT+"\n":"")+(null!=$scope.info.GLUCOSE_COMMENT&&""!=$scope.info.GLUCOSE_COMMENT?$scope.info.GLUCOSE_COMMENT+"\n":"")+(null!=$scope.info.BLOOD_COMMENT&&""!=$scope.info.BLOOD_COMMENT?$scope.info.BLOOD_COMMENT+"\n":"")),len=(null!=$scope.info.PROTEIN_COMMENT?$scope.info.PROTEIN_COMMENT.length:0)+(null!=$scope.info.GLUCOSE_COMMENT?$scope.info.GLUCOSE_COMMENT.length:0)+(null!=$scope.info.BLOOD_COMMENT?$scope.info.BLOOD_COMMENT.length:0),str=$scope.info.SPI_EXAMINERS_COMMENTS.replace("\n",""),str=str.replace("\n",""),str=str.replace("\n",""),totalCom=str.substr(len)};var insert=!0;DocumentService.checkGorgonMA(Patient_ID,CalID).then(function(response){"insert"===response.status?(insert=!0,$scope.isNew=!0,$scope.info.DocId=response.DocId,$scope.info.docName=response.docName,$scope.info.docSign=response.docSign,oriInfo=angular.copy($scope.info),console.log($scope.info)):"update"==response.status?(insert=!1,$scope.isNew=!1,console.log(response.data),$scope.info=angular.copy(response.data),$scope.info.docName=response.docName,$scope.info.docSign=response.docSign,oriInfo=angular.copy($scope.info),$scope.totalComment()):"error"==response.status&&toastr.error("Fail","Error")}),$scope.submitGorgonMA=function(gorgonMAForm){$scope.showClickedValidation=!0,gorgonMAForm.$invalid?(toastr.error("Please Input All Required Information!","Error"),ConfigService.focus_input(gorgonMAForm)):1==insert?DocumentService.insertGorgonMA($scope.info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),$scope.isNew=!1,$state.go("loggedIn.gorgonMA",null,{reload:!0})):toastr.error("Add new fail!","Error")}):DocumentService.editGorgonMA($scope.info).then(function(response){"success"===response.status?(toastr.success("Edit success!","Success"),$state.go("loggedIn.gorgonMA",null,{reload:!0})):toastr.error("Edit fail!","Error")})}}),angular.module("app.loggedIn.document.gorgonMH.controllers",[]).controller("gorgonMHController",function($filter,DocumentService,$scope,$rootScope,$http,$cookieStore,toastr,$state,$stateParams,localStorageService,ConfigService){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.today=new Date;var userInfo=$cookieStore.get("userInfo");if(void 0===userInfo)console.log("ERROR: Cookies not exist"),$state.go("loggedIn.home",null,{reload:!0});else{var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.Signature=tempSignature},$scope.clearClick=function(){$scope.info.Signature=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.Signature};var tempPatient=localStorageService.get("tempPatient")||[];if(null===tempPatient||"undefined"===tempPatient)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load some information fail, please try again!","Error");else{var patient_id=tempPatient.Patient_id,cal_id=$stateParams.cal_id;$scope.info={Gorgon_Id:null,Patient_Id:patient_id,JobNo:null,Occupation:null,JobLocation:null,SpecificLocation:null,PhoneNumber:null,Q1_YearFrom1:new Date,Q1_YearFrom2:new Date,Q1_YearTo1:new Date,Q1_YearTo2:new Date,Q1_Job1:null,Q1_Job2:null,Q1_Employer1:null,Q1_Employer2:null,Q1_TypeOfWork:null,Q1_WorkPast:null,Q1_WorkEnvironment:null,Q1_AnyProblems:null,Q1_CauseProblems:null,Q1_Underground:null,Q1_GrainDust:null,Q1_RemoteEnv:null,Q1_AtHeights:null,Q1_WetConditions:null,Q1_Nickel:null,Q1_HumidConditions:null,Q1_FIFO:null,Q1_FIFODone:null,Q1_FIFOProblems:null,Q1_ShiftWork:null,Q1_ShiftWorkDone:null,Q1_ShiftWorkProblems:null,Q1_SafetyEquipment:null,Q1_ExaminersComments:null,Q2_Operation:null,Q2_Accident:null,Q2_SportsInjury:null,Q2_YesWhen:null,Q2_TimeOfWork:null,Q2_HowLongOff:null,Q2_HowLongModified:null,Q2_HowLongTreatment:null,Q2_NormalDuties:null,Q2_Compensation:null,Q2_PsychologicalProblems:null,Q2_ExaminersComments:null,Q2_DentalHealth:null,Q2_Diabetic:null,Q2_Seizure:null,Q2_Epileptic:null,Q2_Asthmatic:null,Q2_AnyScars:null,Q2_MedicAlert:null,Q3_NeckInjury:null,Q3_DiskInjury:null,Q3_Backache:null,Q3_Physio:null,Q3_BackInjury:null,Q3_Sciatica:null,Q3_BackSurgery:null,Q3_SwollenJoints:null,Q3_ArthriticKnee:null,Q3_Arm:null,Q3_HandInjury:null,Q3_LegInjury:null,Q3_KneeCartilage:null,Q3_KneeReconstruction:null,Q3_FootProblems:null,Q3_OtherBone:null,Q3_Rheumatism:null,Q3_RSI:null,Q3_Hernia:null,Q4_MentalHealth:null,Q4_Psychologist:null,Q4_DrugsProblems:null,Q4_Depression:null,Q4_PanicAttacks:null,Q4_NervousProblem:null,Q4_Anxiety:null,Q4_Insomnia:null,Q5_Eczema:null,Q5_Psoriasis:null,Q5_SkinProblem:null,Q5_Dermatitis:null,Q5_SkinCancers:null,Q6_Asthma:null,Q6_LungDisease:null,Q6_Artery:null,Q6_HighBloodPressure:null,Q6_DVT:null,Q6_UsedPuffer:null,Q6_CardiacPacemaker:null,Q6_Emphysema:null,Q6_HeartDisease:null,Q6_Bronchitis:null,Q6_CollapsedLung:null,Q6_HeartAttack:null,Q7_HeadInjury:null,Q7_Epilepsy:null,Q7_SevereHeadaches:null,Q7_NeurologicalDisorder:null,Q8_DOInsulin:null,Q8_DOMedication:null,Q8_DietControl:null,Q8_KidneyProblems:null,Q8_LiverDisease:null,Q8_HearingLoss:null,Q8_Exhaustion:null,Q8_Arthritis:null,Q8_BloodDisorder:null,Q8_Cancer:null,Q8_BowelProblems:null,Q8_Hepatitis:null,Q8_VisionProblem:null,Q8_ChronicIllness:null,Q9_Pregnant:null,Q9_BreastFeeding:null,Q9_ExaminersComments:null,Q10_Disabilities:null,Q11_Climb:null,Q11_Bend:null,Q11_WorkOverhead:null,Q11_WorkHeights:null,Q11_WorkIsolation:null,Q11_Instruments:null,Q11_WorkAwkward:null,Q11_Squat:null,Q11_Push:null,Q11_WorkUnderground:null,Q11_WorkDusty:null,Q11_WorkConfined:null,Q11_WorkGround:null,Q11_WorkVibration:null,Q12_LossFullBack:null,Q12_LossFullLeg:null,Q12_DifficultyHearing:null,Q12_LossEye:null,Q12_Glasses:null,Q12_OtherLoss:null,Q12_LossFullMovements:null,Q12_OtherProblem:null,Q12_LossFullArm:null,Q12_Psychological:null,Q12_Breathing:null,Q12_ChronicSkin:null,Q12_AlcoholMisuse:null,Q12_LossMobility:null,Q12_LossFullNeck:null,Q12_ExaminersComments:null,Q13_AdvisedToChange:null,Q13_AdvisedToChangeComment:null,Q13_AdvisedToLimit:null,Q13_AdvisedToLimitComment:null,Q13_OffInjury:null,Q13_OffInjuryComment:null,Q13_WhatWas:null,Q13_Medi_Vac:null,Q13_Details:null,Q13_ExaminersComments:null,Q14_WorkRelatedDisease:null,Q14_Year:null,Q14_HowLongOff:null,Q14_HowLongModified:null,Q14_HowLongTreatment:null,Q14_NormalDuties:null,Q14_Compensation:null,Q14_Psychological:null,Q14_Details:null,Q14_WCClaim:null,Q14_ExaminersComments:null,Q15_TakeMedications:null,Q15_ListMedication:null,Q16_HayFever:null,Q16_Eczema:null,Q16_Allergic:null,Q16_Adrenaline:null,Q16_Epipen:null,Q16_Asthma:null,Q17_QFever:null,Q17_HepatitisA:null,Q17_Tetanus:null,Q17_HepatitisB:null,Q17_ExaminersComments:null,Q18_IncreasedCough:null,Q18_ChestIllness:null,Q18_SOBHurrying:null,Q18_SOBwalking:null,Q18_SOBWakeUp:null,Q18_CESWheezy:null,Q18_CEFTight:null,Q18_GivenPuffer:null,Q18_LastTimePuffer:null,Q19_Smoke:null,Q19_SmokeDay:null,Q19_SmokeWeek:null,Q19_SmokeYear:null,Q20_DrinkWeek:null,Q20_DrinkMax:null,Q21_Exercise:null,Q21_PlaySport:null,Q21_SportDetails:null,Q21_IsFootball:null,Q21_IsGolf:null,Q21_IsTennis:null,Q21_IsSquash:null,Q21_IsBowls:null,Q21_IsGym:null,Q21_IsOther:null,Q22_SleepDisorder:null,Q22_Choking:null,Q22_UseCPAP:null,Q23_SittingReading:null,Q23_WatchingTV:null,Q23_Inactive:null,Q23_Passenger:null,Q23_LyingDown:null,Q23_SittingTalking:null,Q23_SittingQuietly:null,Q23_InACar:null,Q23_TotalScore:null,Signature:null,GorgonDate:new Date,Created_by:null,Last_updated_by:null,CalId:cal_id,DocId:null,Q21_IsComment:null,Q21Other1Comment:null,PATIENT_SIGNATURE:null};var oriInfo;$scope.totals=[{id:0},{id:1},{id:2},{id:3}],$scope.maxDate=new Date;var info=$scope.info;DocumentService.loadGGMH(info).then(function(response){if("fail"===response.status)$state.go("loggedIn.home",null,{reload:!0});else if("findNull"===response[0].status)$scope.isNew=!0,$scope.info.patient=response[0].patient,$scope.info.Created_by=userInfo.id,oriInfo=angular.copy($scope.info);else if("findFound"===response[0].status){$scope.isNew=!1;var data=response[0].data;$scope.info={patient:response[0].patient,Gorgon_Id:data.Gorgon_Id,Patient_Id:patient_id,JobNo:data.JobNo,Occupation:data.Occupation,JobLocation:data.JobLocation,SpecificLocation:data.SpecificLocation,PhoneNumber:data.PhoneNumber,Q1_YearFrom1:data.Q1_YearFrom1,Q1_YearFrom2:data.Q1_YearFrom2,Q1_YearTo1:data.Q1_YearTo1,Q1_YearTo2:data.Q1_YearTo2,Q1_Job1:data.Q1_Job1,Q1_Job2:data.Q1_Job2,Q1_Employer1:data.Q1_Employer1,Q1_Employer2:data.Q1_Employer2,Q1_TypeOfWork:data.Q1_TypeOfWork,Q1_WorkPast:data.Q1_WorkPast,Q1_WorkEnvironment:data.Q1_WorkEnvironment,Q1_AnyProblems:data.Q1_AnyProblems,Q1_CauseProblems:data.Q1_CauseProblems,Q1_Underground:data.Q1_Underground,Q1_GrainDust:data.Q1_GrainDust,Q1_RemoteEnv:data.Q1_RemoteEnv,Q1_AtHeights:data.Q1_AtHeights,Q1_WetConditions:data.Q1_WetConditions,Q1_Nickel:data.Q1_Nickel,Q1_HumidConditions:data.Q1_HumidConditions,Q1_FIFO:data.Q1_FIFO,Q1_FIFODone:data.Q1_FIFODone,Q1_FIFOProblems:data.Q1_FIFOProblems,Q1_ShiftWork:data.Q1_ShiftWork,Q1_ShiftWorkDone:data.Q1_ShiftWorkDone,Q1_ShiftWorkProblems:data.Q1_ShiftWorkProblems,Q1_SafetyEquipment:data.Q1_SafetyEquipment,Q1_ExaminersComments:data.Q1_ExaminersComments,Q2_Operation:data.Q2_Operation,Q2_Accident:data.Q2_Accident,Q2_SportsInjury:data.Q2_SportsInjury,Q2_YesWhen:data.Q2_YesWhen,Q2_TimeOfWork:data.Q2_TimeOfWork,Q2_HowLongOff:data.Q2_HowLongOff,Q2_HowLongModified:data.Q2_HowLongModified,Q2_HowLongTreatment:data.Q2_HowLongTreatment,Q2_NormalDuties:data.Q2_NormalDuties,Q2_Compensation:data.Q2_Compensation,Q2_PsychologicalProblems:data.Q2_PsychologicalProblems,Q2_ExaminersComments:data.Q2_ExaminersComments,Q2_DentalHealth:data.Q2_DentalHealth,Q2_Diabetic:data.Q2_Diabetic,Q2_Seizure:data.Q2_Seizure,Q2_Epileptic:data.Q2_Epileptic,Q2_Asthmatic:data.Q2_Asthmatic,Q2_AnyScars:data.Q2_AnyScars,Q2_MedicAlert:data.Q2_MedicAlert,Q3_NeckInjury:data.Q3_NeckInjury,Q3_DiskInjury:data.Q3_DiskInjury,Q3_Backache:data.Q3_Backache,Q3_Physio:data.Q3_Physio,Q3_BackInjury:data.Q3_BackInjury,Q3_Sciatica:data.Q3_Sciatica,Q3_BackSurgery:data.Q3_BackSurgery,Q3_SwollenJoints:data.Q3_SwollenJoints,Q3_ArthriticKnee:data.Q3_ArthriticKnee,Q3_Arm:data.Q3_Arm,Q3_HandInjury:data.Q3_HandInjury,Q3_LegInjury:data.Q3_LegInjury,Q3_KneeCartilage:data.Q3_KneeCartilage,Q3_KneeReconstruction:data.Q3_KneeReconstruction,Q3_FootProblems:data.Q3_FootProblems,Q3_OtherBone:data.Q3_OtherBone,Q3_Rheumatism:data.Q3_Rheumatism,Q3_RSI:data.Q3_RSI,Q3_Hernia:data.Q3_Hernia,Q4_MentalHealth:data.Q4_MentalHealth,Q4_Psychologist:data.Q4_Psychologist,Q4_DrugsProblems:data.Q4_DrugsProblems,Q4_Depression:data.Q4_Depression,Q4_PanicAttacks:data.Q4_PanicAttacks,Q4_NervousProblem:data.Q4_NervousProblem,Q4_Anxiety:data.Q4_Anxiety,Q4_Insomnia:data.Q4_Insomnia,Q5_Eczema:data.Q5_Eczema,Q5_Psoriasis:data.Q5_Psoriasis,Q5_SkinProblem:data.Q5_SkinProblem,Q5_Dermatitis:data.Q5_Dermatitis,Q5_SkinCancers:data.Q5_SkinCancers,Q6_Asthma:data.Q6_Asthma,Q6_LungDisease:data.Q6_LungDisease,Q6_Artery:data.Q6_Artery,Q6_HighBloodPressure:data.Q6_HighBloodPressure,Q6_DVT:data.Q6_DVT,Q6_UsedPuffer:data.Q6_UsedPuffer,Q6_CardiacPacemaker:data.Q6_CardiacPacemaker,Q6_Emphysema:data.Q6_Emphysema,Q6_HeartDisease:data.Q6_HeartDisease,Q6_Bronchitis:data.Q6_Bronchitis,Q6_CollapsedLung:data.Q6_CollapsedLung,Q6_HeartAttack:data.Q6_HeartAttack,Q7_HeadInjury:data.Q7_HeadInjury,Q7_Epilepsy:data.Q7_Epilepsy,Q7_SevereHeadaches:data.Q7_SevereHeadaches,Q7_NeurologicalDisorder:data.Q7_NeurologicalDisorder,Q8_DOInsulin:data.Q8_DOInsulin,Q8_DOMedication:data.Q8_DOMedication,Q8_DietControl:data.Q8_DietControl,Q8_KidneyProblems:data.Q8_KidneyProblems,Q8_LiverDisease:data.Q8_LiverDisease,Q8_HearingLoss:data.Q8_HearingLoss,Q8_Exhaustion:data.Q8_Exhaustion,Q8_Arthritis:data.Q8_Arthritis,Q8_BloodDisorder:data.Q8_BloodDisorder,Q8_Cancer:data.Q8_Cancer,Q8_BowelProblems:data.Q8_BowelProblems,Q8_Hepatitis:data.Q8_Hepatitis,Q8_VisionProblem:data.Q8_VisionProblem,Q8_ChronicIllness:data.Q8_ChronicIllness,Q9_Pregnant:data.Q9_Pregnant,Q9_BreastFeeding:data.Q9_BreastFeeding,Q9_ExaminersComments:data.Q9_ExaminersComments,Q10_Disabilities:data.Q10_Disabilities,Q11_Climb:data.Q11_Climb,Q11_Bend:data.Q11_Bend,Q11_WorkOverhead:data.Q11_WorkOverhead,Q11_WorkHeights:data.Q11_WorkHeights,Q11_WorkIsolation:data.Q11_WorkIsolation,Q11_Instruments:data.Q11_Instruments,Q11_WorkAwkward:data.Q11_WorkAwkward,Q11_Squat:data.Q11_Squat,Q11_Push:data.Q11_Push,Q11_WorkUnderground:data.Q11_WorkUnderground,Q11_WorkDusty:data.Q11_WorkDusty,Q11_WorkConfined:data.Q11_WorkConfined,Q11_WorkGround:data.Q11_WorkGround,Q11_WorkVibration:data.Q11_WorkVibration,Q12_LossFullBack:data.Q12_LossFullBack,Q12_LossFullLeg:data.Q12_LossFullLeg,Q12_DifficultyHearing:data.Q12_DifficultyHearing,Q12_LossEye:data.Q12_LossEye,Q12_Glasses:data.Q12_Glasses,Q12_OtherLoss:data.Q12_OtherLoss,Q12_LossFullMovements:data.Q12_LossFullMovements,Q12_OtherProblem:data.Q12_OtherProblem,Q12_LossFullArm:data.Q12_LossFullArm,Q12_Psychological:data.Q12_Psychological,Q12_Breathing:data.Q12_Breathing,Q12_ChronicSkin:data.Q12_ChronicSkin,Q12_AlcoholMisuse:data.Q12_AlcoholMisuse,Q12_LossMobility:data.Q12_LossMobility,Q12_LossFullNeck:data.Q12_LossFullNeck,Q12_ExaminersComments:data.Q12_ExaminersComments,Q13_AdvisedToChange:data.Q13_AdvisedToChange,Q13_AdvisedToChangeComment:data.Q13_AdvisedToChangeComment,Q13_AdvisedToLimit:data.Q13_AdvisedToLimit,Q13_AdvisedToLimitComment:data.Q13_AdvisedToLimitComment,Q13_OffInjury:data.Q13_OffInjury,Q13_OffInjuryComment:data.Q13_OffInjuryComment,Q13_WhatWas:data.Q13_WhatWas,Q13_Medi_Vac:data.Q13_Medi_Vac,Q13_Details:data.Q13_Details,Q13_ExaminersComments:data.Q13_ExaminersComments,Q14_WorkRelatedDisease:data.Q14_WorkRelatedDisease,Q14_Year:data.Q14_Year,Q14_HowLongOff:data.Q14_HowLongOff,Q14_HowLongModified:data.Q14_HowLongModified,Q14_HowLongTreatment:data.Q14_HowLongTreatment,Q14_NormalDuties:data.Q14_NormalDuties,Q14_Compensation:data.Q14_Compensation,Q14_Psychological:data.Q14_Psychological,Q14_Details:data.Q14_Details,Q14_WCClaim:data.Q14_WCClaim,Q14_ExaminersComments:data.Q14_ExaminersComments,Q15_TakeMedications:data.Q15_TakeMedications,Q15_ListMedication:data.Q15_ListMedication,Q16_HayFever:data.Q16_HayFever,Q16_Eczema:data.Q16_Eczema,Q16_checkAllergic:data.Q16_checkAllergic,Q16_Allergic:data.Q16_Allergic,Q16_Adrenaline:data.Q16_Adrenaline,Q16_Epipen:data.Q16_Epipen,Q16_Asthma:data.Q16_Asthma,Q17_QFever:data.Q17_QFever,Q17_HepatitisA:data.Q17_HepatitisA,Q17_Tetanus:data.Q17_Tetanus,Q17_HepatitisB:data.Q17_HepatitisB,Q17_ExaminersComments:data.Q17_ExaminersComments,Q18_IncreasedCough:data.Q18_IncreasedCough,Q18_ChestIllness:data.Q18_ChestIllness,Q18_SOBHurrying:data.Q18_SOBHurrying,Q18_SOBwalking:data.Q18_SOBwalking,Q18_SOBWakeUp:data.Q18_SOBWakeUp,Q18_CESWheezy:data.Q18_CESWheezy,Q18_CEFTight:data.Q18_CEFTight,Q18_GivenPuffer:data.Q18_GivenPuffer,Q18_LastTimePuffer:data.Q18_LastTimePuffer,Q19_Smoke:data.Q19_Smoke,Q19_SmokeDay:data.Q19_SmokeDay,Q19_SmokeWeek:data.Q19_SmokeWeek,Q19_SmokeYear:data.Q19_SmokeYear,Q20_DrinkWeek:data.Q20_DrinkWeek,Q20_DrinkMax:data.Q20_DrinkMax,Q21_Exercise:data.Q21_Exercise,Q21_PlaySport:data.Q21_PlaySport,Q21_SportDetails:data.Q21_SportDetails,Q21_IsFootball:data.Q21_IsFootball,Q21_IsGolf:data.Q21_IsGolf,Q21_IsTennis:data.Q21_IsTennis,Q21_IsSquash:data.Q21_IsSquash,Q21_IsBowls:data.Q21_IsBowls,Q21_IsGym:data.Q21_IsGym,Q21_IsOther:data.Q21_IsOther,Q22_SleepDisorder:data.Q22_SleepDisorder,Q22_Choking:data.Q22_Choking,Q22_UseCPAP:data.Q22_UseCPAP,Q23_SittingReading:data.Q23_SittingReading,Q23_WatchingTV:data.Q23_WatchingTV,Q23_Inactive:data.Q23_Inactive,Q23_Passenger:data.Q23_Passenger,Q23_LyingDown:data.Q23_LyingDown,Q23_SittingTalking:data.Q23_SittingTalking,Q23_SittingQuietly:data.Q23_SittingQuietly,Q23_InACar:data.Q23_InACar,Q23_TotalScore:data.Q23_TotalScore,Signature:data.Signature,GorgonDate:data.GorgonDate,Created_by:data.Created_by,Last_updated_by:userInfo.id,CalId:data.CalId,DocId:data.DocId,Q21_IsComment:data.Q21Other1Comment,Q21Other1Comment:data.Q21Other1Comment,PATIENT_SIGNATURE:data.PATIENT_SIGNATURE};for(var Examiner_Comments=$scope.info.Q9_ExaminersComments,temp=[],i=0;""!=Examiner_Comments&&null!=Examiner_Comments&&"undefined"!=Examiner_Comments;){var location=Examiner_Comments.search("\r\n");-1==location?(temp[i]=Examiner_Comments,Examiner_Comments=""):(temp[i]=Examiner_Comments.substring(0,location),Examiner_Comments=Examiner_Comments.substring(temp[i].length+2,Examiner_Comments.length)),i++}$scope.info.Q3_ExaminersComments=temp[0],$scope.info.Q4_ExaminersComments=temp[1],$scope.info.Q5_ExaminersComments=temp[2],$scope.info.Q6_ExaminersComments=temp[3],$scope.info.Q7_ExaminersComments=temp[4],$scope.info.Q8_ExaminersComments=temp[5],$scope.info.Q9_ExaminersComments_details=temp[6],oriInfo=angular.copy($scope.info)}else $state.go("loggedIn.home",null,{reload:!0})}),$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.gorgonMHForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.submit=function(gorgonMHForm){if($scope.info.Q23_TotalScore=$scope.info.Q23_SittingReading+$scope.info.Q23_WatchingTV+$scope.info.Q23_Inactive+$scope.info.Q23_Passenger+$scope.info.Q23_LyingDown+$scope.info.Q23_SittingTalking+$scope.info.Q23_SittingQuietly+$scope.info.Q23_InACar+0,$scope.info.Q9_ExaminersComments=(null!=$scope.info.Q3_ExaminersComments&&""!=$scope.info.Q3_ExaminersComments&&"undefined"!=$scope.info.Q3_ExaminersComments?$scope.info.Q3_ExaminersComments:"")+"\r\n"+(null!=$scope.info.Q4_ExaminersComments&&""!=$scope.info.Q4_ExaminersComments&&"undefined"!=$scope.info.Q4_ExaminersComments?$scope.info.Q4_ExaminersComments:"")+"\r\n"+(null!=$scope.info.Q5_ExaminersComments&&""!=$scope.info.Q5_ExaminersComments&&"undefined"!=$scope.info.Q5_ExaminersComments?$scope.info.Q5_ExaminersComments:"")+"\r\n"+(null!=$scope.info.Q6_ExaminersComments&&""!=$scope.info.Q6_ExaminersComments&&"undefined"!=$scope.info.Q6_ExaminersComments?$scope.info.Q6_ExaminersComments:"")+"\r\n"+(null!=$scope.info.Q7_ExaminersComments&&""!=$scope.info.Q7_ExaminersComments&&"undefined"!=$scope.info.Q7_ExaminersComments?$scope.info.Q7_ExaminersComments:"")+"\r\n"+(null!=$scope.info.Q8_ExaminersComments&&""!=$scope.info.Q8_ExaminersComments&&"undefined"!=$scope.info.Q8_ExaminersComments?$scope.info.Q8_ExaminersComments:"")+"\r\n"+(null!=$scope.info.Q9_ExaminersComments_details&&""!=$scope.info.Q9_ExaminersComments_details&&"undefined"!=$scope.info.Q9_ExaminersComments_details?$scope.info.Q9_ExaminersComments_details:""),gorgonMHForm.$error.maxlength||gorgonMHForm.$error.required)toastr.error("Please Input All Required Information!","Error"),ConfigService.focus_input(gorgonMHForm);else{var info=$scope.info;$scope.isNew===!0?DocumentService.insertGGMH(info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),
$state.go("loggedIn.gorgonMH",null,{reload:!0})):"fail"===response.status&&toastr.error("Add new fail!","Error")}):$scope.isNew===!1&&DocumentService.editGGMH(info).then(function(response){"success"===response.status?(toastr.success("Update success!","Success"),$state.go("loggedIn.gorgonMH",null,{reload:!0})):"fail"===response.status&&toastr.error("Update fail!","Error")})}}}}}),angular.module("app.loggedIn.document.gorgonUQ.controllers",[]).controller("gorgonUQController",function($scope,$filter,DocumentService,$http,$cookieStore,localStorageService,$state,toastr,$window,$stateParams){function getAge(dateString){var now=new Date,birthDate=new Date(dateString),age=now.getFullYear()-birthDate.getFullYear(),m=now.getMonth()-birthDate.getMonth();return(0>m||0===m&&now.getDate()<birthDate.getDate())&&age--,age}$scope.dateOptions={formatYear:"yy",startingDay:1},"undefined"!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo"):"fail",$scope.patientInfo=localStorageService.get("tempPatient");var Patient_ID=$scope.patientInfo.Patient_id,CalID=$stateParams.cal_id;$scope.info={Patient_Id:Patient_ID,CalId:CalID};var oriInfo=angular.copy($scope.info);$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.gorgonUQForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},$scope.checkUseRespirator=function(value){1==value&&($scope.info.isEyeIrritation=null,$scope.info.isSkinAllergies=null,$scope.info.isAnxiety=null,$scope.info.isGeneralWeakness=null,$scope.info.isOtherProblem=null)},DocumentService.checkUser(Patient_ID,CalID).then(function(response){if("fail"===response[0].status)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load fail!","Error");else if("findNull"===response[0].status){var date=new Date;$scope.isNew=!0,$scope.maxDate=new Date(date.getFullYear()-1,date.getMonth(),date.getDate())}else"findFound"===response[0].status?$scope.isNew=!1:($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load fail!","Error"));var data=response[0].data;$scope.info={Quest_Id:data.Quest_Id,Patient_Id:Patient_ID,age:getAge($scope.patientInfo.DOB),sex:$scope.patientInfo.Sex,TodayDate:data.TodayDate||new Date,Height:data.Height,Weight:data.Weight,JobTitle:data.JobTitle,PhoneNumber:data.PhoneNumber,BestTime:data.BestTime,isReviewQuest:data.isReviewQuest,isNRP:data.isNRP,isOtherType:data.isOtherType,isRespirator:data.isRespirator,RespiratorType:data.RespiratorType,isSmoke:data.isSmoke,isSeizuresCondition:data.isSeizuresCondition,isDiabetes:data.isDiabetes,isAllergicReactions:data.isAllergicReactions,isClaustrophobia:data.isClaustrophobia,isTrouble:data.isTrouble,isAsbestosis:data.isAsbestosis,isAsthma:data.isAsthma,isBronchitis:data.isBronchitis,isEmphysema:data.isEmphysema,isPneumonia:data.isPneumonia,isTuberculosis:data.isTuberculosis,isSilicosis:data.isSilicosis,isPneumothorax:data.isPneumothorax,isLungCancer:data.isLungCancer,isBrokenRibs:data.isBrokenRibs,isInjuries:data.isInjuries,isOtherLung:data.isOtherLung,OtherLungComment:data.OtherLungComment,isSOB:data.isSOB,isSOBWalkingFast:data.isSOBWalkingFast,isSOBWalkingOther:data.isSOBWalkingOther,isStopForBreath:data.isStopForBreath,isSOBWashing:data.isSOBWashing,isSOBInterferes:data.isSOBInterferes,isCoughingPhlegm:data.isCoughingPhlegm,isCoughingMorning:data.isCoughingMorning,isCoughingLyingDown:data.isCoughingLyingDown,isCoughingUpBlood:data.isCoughingUpBlood,isWheezing:data.isWheezing,isWheezingInterferes:data.isWheezingInterferes,isChestPain:data.isChestPain,isOtherSymptomsPulmonary:data.isOtherSymptomsPulmonary,isHeartAttack:data.isHeartAttack,isStroke:data.isStroke,isAngina:data.isAngina,isHeartFailure:data.isHeartFailure,isSwelling:data.isSwelling,isHeartArrhythmia:data.isHeartArrhythmia,isBloodPressureHeart:data.isBloodPressureHeart,isOtherHeart:data.isOtherHeart,OtherHeartComment:data.OtherHeartComment,isFrequentPain:data.isFrequentPain,isPOTPhysical:data.isPOTPhysical,isPOTInterferes:data.isPOTInterferes,isMissingBeat:data.isMissingBeat,isHeartburn:data.isHeartburn,isOtherSymptomsHeart:data.isOtherSymptomsHeart,isBreathing:data.isBreathing,isHeartTrouble:data.isHeartTrouble,isBloodPressureMedication:data.isBloodPressureMedication,isSeizuresMedication:data.isSeizuresMedication,isEyeIrritation:data.isEyeIrritation,isSkinAllergies:data.isSkinAllergies,isAnxiety:data.isAnxiety,isGeneralWeakness:data.isGeneralWeakness,isOtherProblem:data.isOtherProblem,isTalk:data.isTalk,isLostVision:data.isLostVision,isContactLenses:data.isContactLenses,isWearGlasses:data.isWearGlasses,isColourBlind:data.isColourBlind,isOtherEye:data.isOtherEye,isInjuryEars:data.isInjuryEars,isHearingProblems:data.isHearingProblems,isDifficultyHearing:data.isDifficultyHearing,isHearingAid:data.isHearingAid,isOtherHearing:data.isOtherHearing,isBackInjury:data.isBackInjury,isWeaknessAny:data.isWeaknessAny,isBackPain:data.isBackPain,isDFMArmsLegs:data.isDFMArmsLegs,isDFMHead:data.isDFMHead,isPOSLeanForward:data.isPOSLeanForward,isPODHead:data.isPODHead,isDifficultyBending:data.isDifficultyBending,isDifficultySquatting:data.isDifficultySquatting,isClimbing:data.isClimbing,isOtherMuscle:data.isOtherMuscle,Department:data.Department,SocialSecurity:data.SocialSecurity,Supervisor:data.Supervisor,isAtmosphere:data.isAtmosphere,isContinuous:data.isContinuous,isOpen:data.isOpen,isClose:data.isClose,isSupplied:data.isSupplied,isCombination:data.isCombination,isAir_NonPow:data.isAir_NonPow,isAir_Pow:data.isAir_Pow,LevelOfWE:data.LevelOfWE,ExtentUsage:data.ExtentUsage,LengthOfTime:data.LengthOfTime,WorkCons:data.WorkCons,Safety:data.Safety,HealthCare:data.HealthCare,Class:data.Class,Restrictions:data.Restrictions,UQDate:data.UQDate||new Date,Created_by:data.Created_by,Creation_date:data.Creation_date,Last_updated_by:data.Last_updated_by,Last_update_date:data.Last_update_date,CalId:CalID,DocId:response[0].doctor.doctor_id,SIGNATURE:data.SIGNATURE,isUseRespirator:data.isUseRespirator,patient:response[0].patient,doctor:response[0].doctor},oriInfo=angular.copy($scope.info)}),$scope.submitGorgonUQ=function(gorgonUQForm){$scope.showClickedValidation=!0,gorgonUQForm.$error.required||gorgonUQForm.$error.pattern?toastr.error("Please Input All Required Information!","Error"):1==$scope.isNew?DocumentService.insertUQ($scope.info).then(function(response){"success"===response.status?(toastr.success("Successfully","Success"),$state.go("loggedIn.gorgonUQ",null,{reload:!0})):toastr.error("Fail","Error")}):0==$scope.isNew&&DocumentService.updateUQ($scope.info).then(function(response){"success"===response.status?(toastr.success("Successfully","Success"),$state.go("loggedIn.gorgonUQ",null,{reload:!0})):toastr.error("Fail","Error")})}}),angular.module("app.loggedIn.document.demo.controllers",[]).controller("demoController",function($scope,MODE_ROW,$filter,DocumentService,$http,$cookieStore,$state,toastr,localStorageService){$scope.setPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.loadList()},$scope.reset=function(){$scope.searchObjectMap=angular.copy($scope.searchPatientsObject),$scope.loadList()},$scope.loadList=function(){DocumentService.loadPatient($scope.searchObjectMap).then(function(response){"fail"!=response[status]?$scope.list=response:toastr.error("loading fail")})},$scope.goToTimetableDetail=function(list){localStorageService.set("tempPatient",list),$state.go("loggedIn.Detail")};var init=function(){$scope.searchObject={limit:10,offset:0,maxSize:5,currentPage:1,data:{NAME:"",Email:"",Phone:null}},$scope.rows=MODE_ROW,$scope.searchPatientsObject={doctor_id:0,limit:10,offset:0,maxSize:5,currentPage:1,data:{First_name:"",Sur_name:"",Middle_name:"",Post_code:null}},$scope.searchObjectMap=angular.copy($scope.searchPatientsObject),$scope.list={},$scope.loadList(),$scope.dateOptions={formatYear:"yy",startingDay:1}};init()}),angular.module("app.loggedIn.document.detail.controllers",[]).controller("detailController",function($scope,$filter,DocumentService,$http,$cookieStore,$state,localStorageService){$scope.patient=localStorageService.get("tempPatient")}),angular.module("app.loggedIn.document.addPatient.controllers",[]).controller("addPatientController",function($scope,$filter,PatientService,ReceptionistService,toastr,$http,$cookieStore,$state,ConfigService){$scope.params={permission:{create:!0,edit:!1}},$scope.modelObjectMap={},$scope.modelObject={Title:"Mr",First_name:"",Sur_name:"",Middle_name:"",Known_as:"",Address1:"",Address2:"",Post_code:null,Country:"AU",DOB:"",Sex:"Male",Home_phone:null,Work_phone:null,Mobile:null,No_SMS:"0",Account_type:"",Account_holder:"",Account_Seft:null,Medicare_no:null,Ref:null,Exp_medicare:"",Private_fund_id:"",MemberShip_no:null,UPI:null,HCC_Pension_No:null,Exp_pension:"",DVA_No:null,Balance:null,Pays_Gap_Only:"1",Email:"",Suburb:"",Alias_First_name:"",Alias_Sur_name:"",Phone_ext:null},$scope.options={titles:ConfigService.title_option(),sexes:ConfigService.sex_option(),sms:ConfigService.yes_no_option(),countries:ConfigService.country_option(),gaps:ConfigService.yes_no_option(),acc_types:ConfigService.acc_type_option(),app_types:ConfigService.app_type_option()};var init=function(){$scope.modelObjectMap=angular.copy($scope.modelObject)};init(),$scope.insert_step=1,$scope.isSubmit=!1;var reset=function(){$scope.insert_step=1,$scope.modelObjectMap=angular.copy($scope.modelObject)};$scope.insertNextStep=function(form){switch($scope.isSubmit=!0,$scope.insert_step){case 1:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.insert_step++,$scope.isSubmit=!1);break;case 2:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.insert_step++,$scope.isSubmit=!1);break;case 3:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.modelObjectMap.DOB=ConfigService.getCommonDateDatabase($scope.modelObjectMap.DOB),$scope.modelObjectMap.Exp_medicare=ConfigService.getCommonDateDatabase($scope.modelObjectMap.Exp_medicare),$scope.modelObjectMap.Exp_pension=ConfigService.getCommonDateDatabase($scope.modelObjectMap.Exp_pension),PatientService.insertPatient({patient:$scope.modelObjectMap}).then(function(data){return"success"!=data.status?void toastr.error("Cannot Insert!","Error"):(reset(),toastr.success("Insert Successfully !!!","Success"),void $state.go("loggedIn.demo"))}),$scope.isSubmit=!1)}},$scope.insertBackStep=function(){$scope.insert_step>1&&$scope.insert_step--}}),angular.module("app.loggedIn.document.COE.controllers",[]).controller("COEController",function($scope,$state,DocumentService,$http,$stateParams,$cookieStore,toastr,localStorageService,$filter){var tempSignature,insert=!0;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.Signature1=tempSignature},$scope.clearClick=function(){$scope.info.Signature1=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.Signature1};var tempSignature1;$scope.isSignature1=!1,$scope.showSignature1=function(){$scope.isSignature1=!$scope.isSignature1},$scope.cancelClick1=function(){$scope.isSignature1=!$scope.isSignature1,$scope.info.Signature2=tempSignature1},$scope.clearClick1=function(){$scope.info.Signature2=""},$scope.okClick1=function(){$scope.isSignature1=!$scope.isSignature1,tempSignature1=$scope.info.Signature2},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.patientInfo=localStorageService.get("tempPatient");var Patient_ID=$scope.patientInfo.Patient_id,CalID=$stateParams.cal_id,date=new Date;$filter("date")(date,"dd/MM/yyyy"),$scope.info={coe_id:null,DocId:null,DOCTOR_ID:null,CalId:CalID,PatientId:Patient_ID,isEmployed:null,dateEmployed:date,inPosition:null,Signature1:null,coeName:null,coeTitle:null,coeDate:date,Signature2:null};var oriInfo=angular.copy($scope.info);$scope.resetForm=function(){$scope.info=angular.copy(oriInfo),$scope.COEForm.$setPristine()},$scope.infoChanged=function(){return!angular.equals(oriInfo,$scope.info)},DocumentService.checkCOE(Patient_ID,CalID).then(function(response){"fail"===response.status?(insert=!0,$scope.isNew=!0):(insert=!1,$scope.isNew=!1,$scope.info=response,console.log($scope.info),oriInfo=angular.copy($scope.info))}),$scope.submitCOE=function(COEForm){if($scope.showClickedValidation=!0,COEForm.$invalid)toastr.error("Please Input All Required Information!","Error");else{var info=$scope.info;if(1==insert)DocumentService.insertCOE(info).then(function(response){"success"===response.status?(toastr.success("Add new success!","Success"),$scope.isNew=!1,$state.go("loggedIn.COE",null,{reload:!0})):toastr.error("Add new fail!","Error")});else{var info=$scope.info;DocumentService.updateCOE(info).then(function(response){"success"===response.status?(toastr.success("Edit success!","Success"),$state.go("loggedIn.COE",null,{reload:!0})):toastr.error("Edit fail!","Error")})}}}}),angular.module("app.loggedIn.document.newFA.controllers",[]).controller("newFAController",function($scope,$stateParams,$cookieStore,DocumentService,PatientService,toastr,moment){$scope.editMode=null;var fa_id=1*$stateParams.fa_id,patient_id=1*$stateParams.patient_id,cal_id=1*$stateParams.cal_id;$scope.print_fa_id=fa_id,$scope.print_patient_id=patient_id,$scope.print_cal_id=cal_id,$scope.patient_age=null,$scope.header={},$scope.header.Comments="Met all manual handling requirements with good technique.",$scope.header.ASSESSED_DATE=moment().format("YYYY-MM-DD hh:mm:ss"),$scope.patient_info={},$scope.isSignatureShow=!1,$scope.clickedValidation=!1;var getNewFA=function(fa_id){var getHeaderId=fa_id;DocumentService.loadNewHeaderSections(getHeaderId).then(function(headerAndSectionRes){"error"===headerAndSectionRes.status?toastr.error("Unexpected error","Error!"):($scope.header=headerAndSectionRes.data,$scope.header.PATIENT_ID=patient_id,$scope.header.CAL_ID=cal_id,$scope.header.ASSESSED_SIGN="",$scope.header.ASSESSED_DATE=moment().format("YYYY-MM-DD hh:mm:ss"),$scope.header.Comments="Met all manual handling requirements with good technique.",getDoctorInfo(cal_id,patient_id),$scope.header.sections.forEach(function(section){section.PATIENT_ID=patient_id,section.CAL_ID=cal_id,DocumentService.loadNewLines(section.SECTION_ID,getHeaderId).then(function(lineRes){"error"===lineRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(section.lines=lineRes.data,section.lines.forEach(function(line){if(line.PATIENT_ID=patient_id,line.CAL_ID=cal_id,null!==line.PICTURE){var strarr=line.PICTURE.split("\\"),fileName=strarr[strarr.length-1];line.previewPath="https://"+location.host+"/document/fa/images/"+fileName}DocumentService.loadNewCommentsAndDetails(line.LINE_ID).then(function(detailAndCommentRes){"error"===detailAndCommentRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(line.details=detailAndCommentRes.data.details,line.comments=detailAndCommentRes.data.comments,line.details.forEach(function(detail){if(detail.PATIENT_ID=patient_id,detail.CAL_ID=cal_id,null!==detail.PICTURE){var strarr=detail.PICTURE.split("\\"),fileName=strarr[strarr.length-1];detail.previewPath="https://"+location.host+"/document/fa/images/"+fileName}(7===line.SCORE_TYPE1||9===line.SCORE_TYPE1)&&$scope.autoCalculationVal1(line,detail)}),line.comments.forEach(function(comment){comment.PATIENT_ID=patient_id,comment.CAL_ID=cal_id}))})}))})}))})},getExistFA=function(fa_id,patient_id,cal_id){var getHeaderId=fa_id;DocumentService.loadExistHeaderSections(getHeaderId,patient_id,cal_id).then(function(headerAndSectionRes){"error"===headerAndSectionRes.status?toastr.error("Unexpected error","Error!"):($scope.header=headerAndSectionRes.data,$scope.header.ASSESSED_DATE=moment($scope.header.ASSESSED_DATE).format("YYYY-MM-DD hh:mm:ss"),$scope.header.sections.forEach(function(section){DocumentService.loadExistLines(section.SECTION_ID,getHeaderId,patient_id,cal_id).then(function(lineRes){"error"===lineRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(section.lines=lineRes.data,section.lines.forEach(function(line){if(null!==line.PICTURE){var strarr=line.PICTURE.split("\\"),fileName=strarr[strarr.length-1];line.previewPath="https://"+location.host+"/document/fa/images/"+fileName}DocumentService.loadExistCommentsAndDetails(line.LINE_ID,patient_id,cal_id).then(function(detailAndCommentRes){"error"===detailAndCommentRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(line.details=detailAndCommentRes.data.details,line.comments=detailAndCommentRes.data.comments,line.details.forEach(function(detail){if(null!==detail.PICTURE){var strarr=detail.PICTURE.split("\\"),fileName=strarr[strarr.length-1];detail.previewPath="https://"+location.host+"/document/fa/images/"+fileName}}))})}))})}))})},getPatientInfo=function(patient_id){PatientService.getById(patient_id).then(function(result){null!==result&&(console.log("this is patient info",result),result.Sex="0"===result.Sex?"Male":"Female",$scope.patient_info=result,getPatientAge($scope.patient_info.DOB))})},getDoctorInfo=function(cal_id,patient_id){var userInfo=$cookieStore.get("u\nserInfo"),apptInfo={user_id:userInfo.id};DocumentService.getDoctor(apptInfo).then(function(result){"error"===result.status?toastr.error("Unexpected error!","Error"):"no doctor"===result.status?toastr.error("The account treating this assessment have no doctor link with it","Error!"):($scope.header.ASSESSED_NAME=result.data[0].Booking_Person,$scope.header.ASSESSED_SIGN=result.data[0].Signature)})},getPatientAge=function(dateString){var now=new Date,birthDate=new Date(dateString),age=now.getFullYear()-birthDate.getFullYear(),m=now.getMonth()-birthDate.getMonth();(0>m||0===m&&now.getDate()<birthDate.getDate())&&age--,console.log("this is patient age",age),$scope.patient_age=age},checkExistFA=function(fa_id,patient_id,cal_id){DocumentService.checkExistFA(fa_id,patient_id,cal_id).then(function(result){"error"===result.status?toastr.error("Unexpected error!","Error!"):"not existed"===result.status?(getNewFA(fa_id),$scope.editMode=!1):(getExistFA(fa_id,patient_id,cal_id),$scope.editMode=!0)})},init=function(){checkExistFA(fa_id,patient_id,cal_id),getPatientInfo(patient_id)};init();var calculateFunctionsVal1={calAvg:function(line){for(var sum=0,numberOfValue=0,i=0;i<line.details.length;i++)null!==line.details[i].VAL1_VALUE&&""!==line.details[i].VAL1_VALUE&&1===line.details[i].VAL1_VALUE_IS_NUMBER&&(sum+=1*line.details[i].VAL1_VALUE,numberOfValue++);line.SCORE1=sum/numberOfValue,20!==line.SCORE_TYPE1&&autoRatingVal1(line,line.SCORE1,0)},calMax:function(line){for(var max=1*line.details[0].VAL1_VALUE,i=1;i<line.details.length;i++)null!==line.details[i].VAL1_VALUE&&""!==line.details[i].VAL1_VALUE&&1===line.details[i].VAL1_VALUE_IS_NUMBER&&1*line.details[i].VAL1_VALUE>max&&(max=1*line.details[i].VAL1_VALUE);line.SCORE1=max,autoRatingVal1(line,line.SCORE1,0)},calMin:function(line){for(var min=1*line.details[0].VAL1_VALUE,i=1;i<line.details.length;i++)null!==line.details[i].VAL1_VALUE&&""!==line.details[i].VAL1_VALUE&&1===line.details[i].VAL1_VALUE_IS_NUMBER&&1*line.details[i].VAL1_VALUE<min&&(min=1*line.details[i].VAL1_VALUE);line.SCORE1=min,autoRatingVal1(line,line.SCORE1,0)},calSum:function(line){for(var sum=0,i=0;i<line.details.length;i++)null!==line.details[i].VAL1_VALUE&&""!==line.details[i].VAL1_VALUE&&1===line.details[i].VAL1_VALUE_IS_NUMBER&&(sum+=1*line.details[i].VAL1_VALUE);line.SCORE1=sum,20!==line.SCORE_TYPE1&&autoRatingVal1(line,line.SCORE1,0)}};$scope.autoCalculationVal1=function(line,detail){if(void 0!==detail)if(4===detail.VAL1_ISCHECKBOX||5===detail.VAL1_ISCHECKBOX){line.RATING_VALUE1=0;for(var i=0;i<line.details.length;i++)if(4===line.details[i].VAL1_ISCHECKBOX)switch(line.details[i].VAL1_CHECKBOX){default:case"0":case"1":line.RATING_VALUE1+=0;break;case"2":line.RATING_VALUE1+=1}else if(5===line.details[i].VAL1_ISCHECKBOX)switch(line.details[i].VAL1_CHECKBOX){default:case"0":line.RATING_VALUE1+=0;break;case"1":line.RATING_VALUE1+=1;break;case"2":line.RATING_VALUE1+=2}switch(line.RATING_VALUE1){default:case 0:line.RATE1="";break;case 1:line.RATE1="Poor";break;case 2:line.RATE1="Fair";break;case 3:line.RATE1="Good";break;case 4:line.RATE1="Excellent"}autoSummary(line)}else($scope.header.TYPE=12===detail.VAL1_ISCHECKBOX)&&(console.log("this is line details index",line.details.indexOf(detail)),console.log("this is line details length",line.details.length),line.details.indexOf(detail)===line.details.length-1&&("1"===detail.VAL1_CHECKBOX?line.RATE1="Satisfactory":(detail.VAL1_CHECKBOX=0,line.RATE1="Unsatisfactory")));if(9!==line.SCORE_TYPE1||7!==detail.VAL1_ISVALUE&&8!==detail.VAL1_ISVALUE&&9!==detail.VAL1_ISVALUE&&10!==detail.VAL1_ISVALUE){if(7===line.SCORE_TYPE1&&(7===detail.VAL1_ISVALUE||8===detail.VAL1_ISVALUE||9===detail.VAL1_ISVALUE||10===detail.VAL1_ISVALUE)){var default_details_value=line.details[0].VAL1_VALUE,start_value=5;7!==line.details[0].VAL1_ISVALUE&&8!==line.details[0].VAL1_ISVALUE&&9!==line.details[0].VAL1_ISVALUE&&10!==line.details[0].VAL1_ISVALUE||2!==line.details.length||(line.details[1].VAL1_VALUE=angular.copy(default_details_value))}}else{var default_details_value=line.details[0].VAL1_VALUE,start_value=5;if(2===line.details)line.details[1].VAL1_VALUE=angular.copy(default_details_value);else for(var i=1;i<line.details.length;i++)line.details[i].VAL1_VALUE=angular.copy(start_value),default_details_value>start_value&&(start_value+=5)}if(1===line.ISSCORE1)switch(line.SCORE_TYPE1){case 20:case 3:calculateFunctionsVal1.calAvg(line);break;case 28:calculateFunctionsVal1.calSum(line);break;case 9:line.SCORE1=line.details[line.details.length-1].VAL1_VALUE;break;case 10:calculateFunctionsVal1.calMax(line);break;case 11:calculateFunctionsVal1.calMin(line);break;case 8:autoRatingVal1(line,1*line.SCORE1,0);break;case 12:break;case 23:break;case 29:break;default:line.SCORE1=line.details[line.details.length-1].VAL1_VALUE,""===line.SCORE1&&(line.SCORE1=null),autoRatingVal1(line,line.SCORE1,0)}};var calculateFunctionsVal2={calAvg:function(line){for(var sum=0,numberOfValue=0,i=0;i<line.details.length;i++)null!==line.details[i].VAL2_VALUE&&""!==line.details[i].VAL2_VALUE&&1===line.details[i].VAL2_VALUE_IS_NUMBER&&(sum+=1*line.details[i].VAL2_VALUE,numberOfValue++);line.SCORE2=sum/numberOfValue,20!==line.SCORE_TYPE2&&autoRatingVal2(line,line.SCORE2)},calMax:function(line){for(var max=1*line.details[0].VAL2_VALUE,i=1;i<line.details.length;i++)null!==line.details[i].VAL2_VALUE&&""!==line.details[i].VAL2_VALUE&&1===line.details[i].VAL2_VALUE_IS_NUMBER&&1*line.details[i].VAL2_VALUE>max&&(max=1*line.details[i].VAL2_VALUE);line.SCORE2=max,autoRatingVal2(line,line.SCORE2)},calMin:function(line){for(var min=1*line.details[0].VAL2_VALUE,i=1;i<line.details.length;i++)null!==line.details[i].VAL2_VALUE&&""!==line.details[i].VAL2_VALUE&&1===line.details[i].VAL2_VALUE_IS_NUMBER&&1*line.details[i].VAL2_VALUE<min&&(min=1*line.details[i].VAL2_VALUE);line.SCORE2=min,autoRatingVal2(line,line.SCORE2)},calSum:function(line){for(var sum=0,i=0;i<line.details.length;i++)null!==line.details[i].VAL2_VALUE&&""!==line.details[i].VAL2_VALUE&&1===line.details[i].VAL2_VALUE_IS_NUMBER&&(sum+=1*line.details[i].VAL2_VALUE);line.SCORE2=sum,20!==line.SCORE_TYPE2&&autoRatingVal2(line,line.SCORE2)}};$scope.autoCalculationVal2=function(line){if(1===line.ISSCORE2)switch(line.SCORE_TYPE2){case 20:case 3:calculateFunctionsVal2.calAvg(line);break;case 28:calculateFunctionsVal2.calSum(line);break;case 9:line.SCORE2=line.details[line.details.length-1].VAL2_VALUE;break;case 10:calculateFunctionsVal2.calMax(line);break;case 11:calculateFunctionsVal2.calMin(line);break;case 8:autoRatingVal2(line,line.SCORE2);break;default:line.SCORE2=line.details[line.details.length-1].VAL2_VALUE,autoRatingVal2(line,1*line.SCORE2)}};var autoRatingVal1=function(line,valueToRate,totalMode){if(null!==line.RATING_ID1&&""!==line.RATING_ID1){var ratingData={patient_age:$scope.patient_age,patient_gender:$scope.patient_info.Sex,valueToRate:valueToRate,rating_id:line.RATING_ID1};DocumentService.autoRating(ratingData).then(function(result){console.log("this is result",result),"error"===result.status?toastr.error("Something wrong with auto rating function.","Error!"):"unrated"===result.status?(line.RATE1="UNRATED",1!==totalMode&&(line.RATING_VALUE1=null,autoSummary(line))):3===line.SCORE_TYPE1?(console.log("rating result",result),line.RATE1=result.data[0].RATE,line.RATING_VALUE1=line.SCORE1<result.data[0].FROM_VALUE?1:line.SCORE1>result.data[0].TO_VALUE?3:2):(line.RATE1=result.data[0].RATE,1!==totalMode&&(line.RATING_VALUE1=result.data[0].VALUE,autoSummary(line)))})}else if(8===line.SCORE_TYPE1)switch(valueToRate){case 4:line.RATE1="Excellent",line.RATING_VALUE1=valueToRate,autoSummary(line);break;case 3:line.RATE1="Good",line.RATING_VALUE1=valueToRate,autoSummary(line);break;case 2:line.RATE1="Fair",line.RATING_VALUE1=valueToRate,autoSummary(line);break;case 1:line.RATE1="Poor",line.RATING_VALUE1=valueToRate,autoSummary(line)}},autoRatingVal2=function(line,valueToRate){if(null!==line.RATING_ID2&&""!==line.RATING_ID2){var ratingData={patient_age:$scope.patient_age,patient_gender:$scope.patient_info.Sex,valueToRate:line.SCORE2,rating_id:line.RATING_ID2};DocumentService.autoRating(ratingData).then(function(result){"error"===result.status?toastr.error("Something wrong with auto rating function.","Error!"):"unrated"===result.status?(line.RATE2="UNRATED",line.RATING_VALUE2=null):3===line.SCORE_TYPE1?(console.log("rating result",result),line.RATE2=result.data[0].RATE,line.RATING_VALUE2=line.SCORE2<result.data[0].FROM_VALUE?1:line.SCORE2>result.data[0].TO_VALUE?3:2):(line.RATE2=result.data[0].RATE,line.RATING_VALUE2=result.data[0].VALUE)})}else if(8===line.SCORE_TYPE2)switch(valueToRate){case 4:line.RATE2="Excellent",line.RATING_VALUE2=4;break;case 3:line.RATE2="Good",line.RATING_VALUE2=3;break;case 2:line.RATE2="Fair",line.RATING_VALUE2=2;break;case 1:line.RATE2="Poor",line.RATING_VALUE2=1}},autoSummary=function(line){console.log("this is line satis",line);var sectionId=line.SECTION_ID;console.log("this is line satis",line);for(var lineId=line.LINE_ID,detailNeedChanged={},lineTotalInSummary={},i=0;i<$scope.header.sections.length;i++)if($scope.header.sections[i].SECTION_ID===sectionId){for(var j=0;j<$scope.header.sections[i].lines.length;j++)if(1===$scope.header.sections[i].lines[j].LineType){lineTotalInSummary=$scope.header.sections[i].lines[j];for(var k=0;k<$scope.header.sections[i].lines[j].details.length;k++)if($scope.header.sections[i].lines[j].details[k].LineTestRefer===lineId){detailNeedChanged=$scope.header.sections[i].lines[j].details[k];break}break}break}detailNeedChanged.VAL1_VALUE=line.RATING_VALUE1,detailNeedChanged.VAL2_VALUE=line.RATE1;for(var lineTotal=0,m=0;m<lineTotalInSummary.details.length;m++)lineTotal+=null!==lineTotalInSummary.details[m].VAL1_VALUE&&""!==lineTotalInSummary.details[m].VAL1_VALUE?1*lineTotalInSummary.details[m].VAL1_VALUE:0;lineTotalInSummary.RATING_VALUE1=lineTotal;var totalMode=1;console.log("this is lineTotalInSummary",lineTotalInSummary),autoRatingVal1(lineTotalInSummary,1*lineTotalInSummary.RATING_VALUE1,totalMode)};$scope.showSignature=function(){$scope.isSignatureShow=!0},$scope.okClick=function(){$scope.isSignatureShow=!1},$scope.cancelClick=function(){$scope.isSignatureShow=!1},$scope.clearClick=function(){$scope.header.PATIENT_SIGN=""},$scope.newFASubmit=function(){if($scope.clickedValidation=!0,$scope.FAForm.$invalid)toastr.error("Invalid fields!","Error!");else{var insertInfo=getInsertInformation($scope.header);console.log("this is insert info",insertInfo),DocumentService.insertNewFA(insertInfo).then(function(result){"success"===result.status?($scope.editMode=!0,toastr.success("Functional Assessment Submitted!","Success!"),init()):toastr.error("Failed to submit functional assessment!","Error!")})}},$scope.faUpdate=function(){if($scope.clickedValidation=!0,$scope.FAForm.$invalid)toastr.error("Invalid fields!","Error!");else{var updateInfo=getInsertInformation($scope.header);console.log("this is update info",updateInfo),DocumentService.updateNewFA(updateInfo,patient_id,cal_id).then(function(result){"success"===result.status?toastr.success("Functional assessment updated!","Success!"):toastr.error("Failed to update functional assessment!","Error!")})}};var getInsertInformation=function(header){var insertHeader={},insertSections=[],insertLines=[],insertDetails=[],insertComments=[],dateFormatString="YYYY-MM-DD hh:mm:ss",tmpHeader=angular.copy(header);delete tmpHeader.sections,tmpHeader.Creation_date=$scope.editMode===!1?moment().format(dateFormatString):moment(tmpHeader.Creation_date).format(dateFormatString),tmpHeader.Last_update_date=moment().format(dateFormatString),insertHeader=tmpHeader;for(var i=0;i<header.sections.length;i++){var tmpSection=angular.copy(header.sections[i]);delete tmpSection.lines,tmpSection.Creation_date=$scope.editMode===!1?moment().format(dateFormatString):moment(tmpSection.Creation_date).format(dateFormatString),tmpSection.Last_update_date=moment().format(dateFormatString),insertSections.push(tmpSection);for(var j=0;j<header.sections[i].lines.length;j++){var tmpLine=angular.copy(header.sections[i].lines[j]);delete tmpLine.details,delete tmpLine.comments,delete tmpLine.previewPath,tmpLine.Creation_date=$scope.editMode===!1?moment().format(dateFormatString):moment(tmpLine.Creation_date).format(dateFormatString),tmpLine.Last_update_date=moment().format(dateFormatString),insertLines.push(tmpLine);for(var k=0;k<header.sections[i].lines[j].details.length;k++){var tmpDetail=angular.copy(header.sections[i].lines[j].details[k]);delete tmpDetail.previewPath,tmpDetail.Creation_date=$scope.editMode===!1?moment().format(dateFormatString):moment(tmpDetail.Creation_date).format(dateFormatString),tmpDetail.Last_update_date=moment().format(dateFormatString),insertDetails.push(tmpDetail)}for(var m=0;m<header.sections[i].lines[j].comments.length;m++){var tmpComment=angular.copy(header.sections[i].lines[j].comments[m]);tmpComment.Creation_date=$scope.editMode===!1?moment().format(dateFormatString):moment(tmpComment.Creation_date).format(dateFormatString),tmpComment.Last_update_date=moment().format(dateFormatString),insertComments.push(tmpComment)}}}var submitInformations={insertHeader:insertHeader,insertSections:insertSections,insertLines:insertLines,insertDetails:insertDetails,insertComments:insertComments};return submitInformations}}),angular.module("app.loggedIn.fadefine",["app.loggedIn.fadefine.controller","app.loggedIn.fadefine.service"]).config(function($stateProvider){$stateProvider.state("loggedIn.fadefine",{"abstract":!0,templateUrl:"modules/fadefine/views/home.html",controller:"FaDefineController"}).state("loggedIn.fadefine.list",{url:"/fa/list",views:{"main-content":{templateUrl:"modules/fadefine/views/list.html",controller:"FaDefineListController"}}}).state("loggedIn.fadefine.detail",{url:"/fa/:action/:headerId",views:{"main-content":{templateUrl:"modules/fadefine/views/detail.html",controller:"FaDefineDetailController"}}})}),angular.module("app.loggedIn.fadefine.controller",["app.loggedIn.fadefine.list.controller","app.loggedIn.fadefine.detail.controller","app.loggedIn.fadefine.imageDialog.controller"]).controller("FaDefineController",function($scope){}),angular.module("app.loggedIn.fadefine.list.controller",[]).controller("FaDefineListController",function($scope,$state,FaDefineService,toastr){$scope.fa_panel={},$scope.clickRow=function(item){$state.go("loggedIn.fadefine.detail",{action:"edit",headerId:item.FA_ID})},$scope.fa={select:0,scope:$scope.fa_panel,options:{api:"api/erm/v2/fa/search",method:"post",scope:$scope.fa_panel,columns:[{field:"FA_ID",is_hide:!0},{field:"TYPE",label:"Type"},{field:"FA_NAME",label:"Name"},{label:"Status",type:"status",isEnable:function(item){return item.ISENABLE},disableFn:function($event,item){$event.stopPropagation(),console.log("run here 1"),FaDefineService.changeFaStt(0,item.FA_ID).then(function(res){
"success"===res.status&&$scope.fa_panel.reload()})},enableFn:function($event,item){$event.stopPropagation(),console.log("run here 2"),FaDefineService.changeFaStt(1,item.FA_ID).then(function(res){"success"===res.status&&$scope.fa_panel.reload()})}},{type:"button",btnlabel:"Clone to new definition",btnclass:"fa fa-files-o",btnfn:function(item){$state.go("loggedIn.fadefine.detail",{action:"add",headerId:item.FA_ID})}}],use_filters:!0,filters:{TYPE:{type:"text"},FA_NAME:{type:"text"}}}},$scope.newDefine=function(){$state.go("loggedIn.fadefine.detail",{action:"add",headerId:0})}}),angular.module("app.loggedIn.fadefine.detail.controller",["ngDraggable"]).controller("FaDefineDetailController",function($scope,$stateParams,$state,$modal,ConfigService,FaHeaderModel,FaSectionModel,FaLineModel,FaLineDetailModel,FaCommentModel,FaDefineService,toastr,moment){$scope.isEdit="edit"===$stateParams.action?!0:!1,$scope.header=angular.copy(FaHeaderModel),$scope.header.ISENABLE=1,$scope.header.FA_NAME="Untitled Function Assessment Header",$scope.header.Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"),$scope.header.sections=[];var section_init=angular.copy(FaSectionModel);section_init.ISENABLE=1,section_init.lines=[];var line_init=angular.copy(FaLineModel);line_init.ISENABLE=1,line_init.details=[],line_init.comments=[];var line_detail_init=angular.copy(FaLineDetailModel);line_detail_init.ISENABLE=1;var line_comment_init=angular.copy(FaCommentModel);if(line_comment_init.ISENABLE=1,$scope.oneAtATime=!1,$scope.score_type_opt=ConfigService.score_type_option(),$scope.comment_type_opt=ConfigService.comment_type_option(),$scope.value_type_opt=ConfigService.value_type_option(),$scope.section_display_type_opt=ConfigService.section_display_type_option(),ConfigService.rank_type_option().then(function(result){$scope.rating_type_opt=result.list}),$scope.isSectionDropable=!0,"edit"===$stateParams.action&&$stateParams.headerId){var getHeaderId=$stateParams.headerId;FaDefineService.getHeaderAndSection(getHeaderId).then(function(headerAndSectionRes){"error"===headerAndSectionRes.status?toastr.error("Unexpected error","Error!"):($scope.header=headerAndSectionRes.data,$scope.header.action="edit",$scope.header.sections.forEach(function(section){section.action="edit",FaDefineService.getLines(section.SECTION_ID,getHeaderId).then(function(lineRes){"error"===lineRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(section.lines=lineRes.data,section.lines.forEach(function(line){if(null!==line.PICTURE){var strarr=line.PICTURE.split("\\"),fileName=strarr[strarr.length-1];line.previewPath="https://"+location.host+"/document/fa/images/"+fileName}line.action="edit",FaDefineService.getDetailsAndComments(line.LINE_ID).then(function(detailAndCommentRes){"error"===detailAndCommentRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(line.details=detailAndCommentRes.data.details,line.comments=detailAndCommentRes.data.comments,line.details.forEach(function(detail){if(detail.action="edit",null!==detail.PICTURE){var strarr=detail.PICTURE.split("\\"),fileName=strarr[strarr.length-1];detail.previewPath="https://"+location.host+"/document/fa/images/"+fileName}}),line.comments.forEach(function(comment){comment.action="edit"}))})}))})}))})}else if("add"===$stateParams.action&&0!==$stateParams.headerId){var getHeaderId=$stateParams.headerId;FaDefineService.getHeaderAndSection(getHeaderId).then(function(headerAndSectionRes){"error"===headerAndSectionRes.status?toastr.error("Unexpected error","Error!"):($scope.header=headerAndSectionRes.data,$scope.header.FA_ID=null,$scope.header.Created_by=null,$scope.header.Creation_date=null,$scope.header.Last_updated_by=null,$scope.header.Last_update_date=null,$scope.header.sections.forEach(function(section){var sectionId=angular.copy(section.SECTION_ID);section.SECTION_ID=null,section.FA_ID=null,section.Created_by=null,section.Creation_date=null,section.Last_updated_by=null,section.Last_update_date=null,FaDefineService.getLines(sectionId,getHeaderId).then(function(lineRes){"error"===lineRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(section.lines=lineRes.data,section.lines.forEach(function(line){var lineId=angular.copy(line.LINE_ID);if(line.LINE_ID=null,line.SECTION_ID=null,line.FA_ID=null,line.Created_by=null,line.Creation_date=null,line.Last_updated_by=null,line.Last_update_date=null,null!==line.PICTURE){var strarr=line.PICTURE.split("\\"),fileName=strarr[strarr.length-1];line.previewPath="https://"+location.host+"/document/fa/images/"+fileName}FaDefineService.getDetailsAndComments(lineId).then(function(detailAndCommentRes){"error"===detailAndCommentRes.status?($scope.header={},toastr.error("Unexpected error","Error!")):(line.details=detailAndCommentRes.data.details,line.comments=detailAndCommentRes.data.comments,line.details.forEach(function(detail){if(detail.DETAIL_ID=null,detail.LINE_ID=null,detail.Created_by=null,detail.Creation_date=null,detail.Last_updated_by=null,detail.Last_update_date=null,null!==detail.PICTURE){var strarr=detail.PICTURE.split("\\"),fileName=strarr[strarr.length-1];detail.previewPath="https://"+location.host+"/document/fa/images/"+fileName}}),line.comments.forEach(function(comment){comment.FA_COMMENT_ID=null,comment.LINE_ID=null,comment.Created_by=null,comment.Creation_date=null,comment.Last_updated_by=null,comment.Last_update_date=null}))})}))})}))})}$scope.addSection=function(){var newSection=angular.copy(section_init);$scope.isEdit===!0&&(newSection.action="add"),newSection.SECTION_NAME="Untitled Section",newSection.Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"),$scope.header.sections.push(newSection)},$scope.removeSection=function(section){var indexToRemove=$scope.header.sections.indexOf(section);if($scope.isEdit===!1)$scope.header.sections.splice(indexToRemove,1);else if("add"===section.action)$scope.header.sections.splice(indexToRemove,1);else{section.action="delete";for(var k=0;k<section.lines.length;k++)if("add"===section.lines[k].action)section.lines.splice(k,1);else{section.lines[k].action="delete";for(var i=0;i<section.lines[k].details.length;i++)"add"===section.lines[k].details[i].action?section.lines[k].details.splice(i,1):section.lines[k].details[i].action="delete";for(var j=0;j<section.lines[k].comments.length;j++)"add"===section.lines[k].comments[j].action?section.lines[k].comments.splice(j,1):section.lines[k].comments[j].action="delete"}}},$scope.addLine=function(section){var newLine=angular.copy(line_init);$scope.isEdit===!0&&(newLine.action="add"),newLine.QUESTION="Untitled line",newLine.Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"),section.lines.push(newLine)},$scope.removeLine=function(section,line){var indexToRemove=section.lines.indexOf(line);if($scope.isEdit===!1)section.lines.splice(indexToRemove,1);else if("add"===line.action)section.lines.splice(indexToRemove,1);else{line.action="delete";for(var i=0;i<line.details.length;i++)"add"===line.details[i].action?line.details.splice(i,1):line.details[i].action="delete";for(var j=0;j<line.comments.length;j++)"add"===line.comments[j].action?line.comments.splice(j,1):line.comments[j].action="delete"}},$scope.addDetail=function(line){var newDetail=angular.copy(line_detail_init);$scope.isEdit===!0&&(newDetail.action="add"),newDetail.QUESTION="Untitled detail",newDetail.Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"),line.details.push(newDetail)},$scope.removeDetail=function(detail,line){var indexToRemove=line.details.indexOf(detail);$scope.isEdit===!1?line.details.splice(indexToRemove,1):"add"===detail.action?line.details.splice(indexToRemove,1):detail.action="delete"},$scope.addComment=function(line){var newComment=angular.copy(line_comment_init);$scope.isEdit===!0&&(newComment.action="add"),newComment.NAME="Untitled comment",line.comments.push(newComment)},$scope.removeComment=function(comment,line){var indexToRemove=line.comments.indexOf(comment);$scope.isEdit===!1?line.comments.splice(indexToRemove,1):"add"===comment.action?line.comments.splice(indexToRemove,1):comment.action="delete"},$scope.value1TypeWatch=function(detail,val1_type){0===val1_type?(detail.VAL1_ISVALUE=1,detail.VAL1_ISCHECKBOX=null,detail.VAL1_CHECKBOX=null):-1===val1_type?(detail.VAL1_NAME=null,detail.VAL1_ISVALUE=null,detail.VAL1_VALUE=null,detail.VAL1_ISCHECKBOX=null,detail.VAL1_CHECKBOX=null,detail.VAL1_ISCOMMENT_WHEN_YES=null,detail.VAL1_ISCOMMENT_WHEN_NO=null,detail.VAL1_VALUE_IS_NUMBER=null):7===val1_type?(detail.VAL1_ISVALUE=val1_type,detail.VAL1_ISCHECKBOX=null,detail.VAL1_CHECKBOX=null,detail.VAL1_NAME="Weight",detail.VAL1_VALUE_IS_NUMBER=1):8===val1_type?(detail.VAL1_ISVALUE=val1_type,detail.VAL1_ISCHECKBOX=null,detail.VAL1_CHECKBOX=null,detail.VAL1_NAME="Distance",detail.VAL1_VALUE_IS_NUMBER=1):9===val1_type?(detail.VAL1_ISVALUE=val1_type,detail.VAL1_ISCHECKBOX=null,detail.VAL1_CHECKBOX=null,detail.VAL1_NAME="Height",detail.VAL1_VALUE_IS_NUMBER=1):10===val1_type?(detail.VAL1_ISVALUE=val1_type,detail.VAL1_ISCHECKBOX=null,detail.VAL1_CHECKBOX=null,detail.VAL1_NAME="Weight",detail.VAL1_VALUE_IS_NUMBER=1):(detail.VAL1_ISVALUE=null,detail.VAL1_VALUE_IS_NUMBER=null,detail.VAL1_ISCHECKBOX=val1_type),1!==val1_type&&(detail.VAL1_ISCOMMENT_WHEN_YES=null,detail.VAL1_ISCOMMENT_WHEN_NO=null),console.log($scope.header)},$scope.value2TypeWatch=function(detail,val2_type){0===val2_type?(detail.VAL2_ISVALUE=1,detail.VAL2_ISCHECKBOX=null,detail.VAL2_CHECKBOX=null):-1===val2_type?(detail.VAL2_NAME=null,detail.VAL2_ISVALUE=null,detail.VAL2_VALUE=null,detail.VAL2_ISCHECKBOX=null,detail.VAL2_CHECKBOX=null,detail.VAL2_ISCOMMENT_WHEN_YES=null,detail.VAL2_ISCOMMENT_WHEN_NO=null,detail.VAL2_VALUE_IS_NUMBER=null):7===val2_type?(detail.VAL2_ISVALUE=val2_type,detail.VAL2_ISCHECKBOX=null,detail.VAL2_CHECKBOX=null,detail.VAL2_NAME="Weight",detail.VAL2_VALUE_IS_NUMBER=1):8===val2_type?(detail.VAL2_ISVALUE=val2_type,detail.VAL2_ISCHECKBOX=null,detail.VAL2_CHECKBOX=null,detail.VAL2_NAME="Distance",detail.VAL2_VALUE_IS_NUMBER=1):9===val2_type?(detail.VAL2_ISVALUE=val2_type,detail.VAL2_ISCHECKBOX=null,detail.VAL2_CHECKBOX=null,detail.VAL2_NAME="Height",detail.VAL2_VALUE_IS_NUMBER=1):10===val2_type?(detail.VAL2_ISVALUE=val2_type,detail.VAL2_ISCHECKBOX=null,detail.VAL2_CHECKBOX=null,detail.VAL2_NAME="Weight",detail.VAL2_VALUE_IS_NUMBER=1):(detail.VAL2_ISVALUE=null,detail.VAL2_VALUE_IS_NUMBER=null,detail.VAL2_ISCHECKBOX=val2_type),1!==val2_type&&(detail.VAL2_ISCOMMENT_WHEN_YES=null,detail.VAL2_ISCOMMENT_WHEN_NO=null)},$scope.value1TypeInit=function(detail){return("add"!==$stateParams.action||"add"===$stateParams.action&&0!==$stateParams.headerId)&&(0!==detail.VAL1_ISVALUE&&null!==detail.VAL1_ISVALUE||0!==detail.VAL1_ISCHECKBOX&&null!==detail.VAL1_ISCHECKBOX)?7===detail.VAL1_ISVALUE?7:8===detail.VAL1_ISVALUE?8:9===detail.VAL1_ISVALUE?9:10===detail.VAL1_ISVALUE?10:1===detail.VAL1_ISVALUE?0:detail.VAL1_ISCHECKBOX:-1},$scope.value2TypeInit=function(detail){return("add"!==$stateParams.action||"add"===$stateParams.action&&0!==$stateParams.headerId)&&(0!==detail.VAL2_ISVALUE&&null!==detail.VAL2_ISVALUE||0!==detail.VAL2_ISCHECKBOX&&null!==detail.VAL2_ISCHECKBOX)?7===detail.VAL2_ISVALUE?7:8===detail.VAL2_ISVALUE?8:9===detail.VAL2_ISVALUE?9:10===detail.VAL2_ISVALUE?10:1===detail.VAL2_ISVALUE?0:detail.VAL2_ISCHECKBOX:-1},$scope.IsCommentTextWatch=function(detail,IsCommentTextValue){"0"===IsCommentTextValue&&(detail.VAL1_ISCOMMENT_WHEN_YES=null,detail.VAL1_ISCOMMENT_WHEN_NO=null,detail.VAL2_ISCOMMENT_WHEN_YES=null,detail.VAL2_ISCOMMENT_WHEN_NO=null)},$scope.moveDetailUp=function(detail,line){var index=line.details.indexOf(detail);line.details.splice(index,1),line.details.splice(index-1,0,detail)},$scope.moveDetailDown=function(detail,line){var index=line.details.indexOf(detail);line.details.splice(index,1),line.details.splice(index+1,0,detail)},$scope.moveCommentUp=function(comment,line){var index=line.comments.indexOf(comment);line.comments.splice(index,1),line.comments.splice(index-1,0,comment)},$scope.moveCommentDown=function(comment,line){var index=line.comments.indexOf(comment);line.comments.splice(index,1),line.comments.splice(index+1,0,comment)},$scope.moveLineUp=function(line,section){var index=section.lines.indexOf(line);section.lines.splice(index,1),section.lines.splice(index-1,0,line)},$scope.moveLineDown=function(line,section){var index=section.lines.indexOf(line);section.lines.splice(index,1),section.lines.splice(index+1,0,line)},$scope.onSectionDropComplete=function(index,movedSection,event,replacedSection,header){var movedSection=movedSection,replacedSection=replacedSection,oldIndex=header.sections.indexOf(movedSection),newIndex=index;header.sections[oldIndex]=replacedSection,header.sections[newIndex]=movedSection},$scope.addFaDefinition=function(){0===$scope.header.sections.length?toastr.error("Functional Assessment must have at least one section","Error!"):addOrder($scope.header).then(function(result){FaDefineService.insertFa($scope.header).then(function(res){"success"===res.status?(toastr.success("New functional assessment definition added","Success!"),$state.go("loggedIn.fadefine.list")):toastr.error("Failed to add new functional assessment definition","Error!")})},function(error){console.log(error)})},$scope.editDefinition=function(){0===$scope.header.sections.length?toastr.error("Functional Assessment must have at least one section","Error!"):addOrder($scope.header).then(function(result){console.log(result),FaDefineService.editFa(result).then(function(res){"success"===res.status?(toastr.success("Edit successfully!","Success!"),$state.go("loggedIn.fadefine.list")):toastr.error("Edit failed!","Error!")})})};var addOrder=function(header){return new Promise(function(resolve,reject){$scope.isEdit===!1?header.Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"):(header.Creation_date=""===header.Creation_date?moment().format("YYYY-MM-DD hh:mm:ss"):moment(header.Creation_date).format("YYYY-MM-DD hh:mm:ss"),header.Last_update_date=moment().format("YYYY-MM-DD hh:mm:ss"));for(var i=0;i<header.sections.length;i++)if(header.sections[i].ORD=i+1,$scope.isEdit===!1?header.sections[i].Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"):(header.sections[i].Creation_date=""===header.sections[i].Creation_date?moment().format("YYYY-MM-DD hh:mm:ss"):moment(header.sections[i].Creation_date).format("YYYY-MM-DD hh:mm:ss"),header.sections[i].Last_update_date=moment().format("YYYY-MM-DD hh:mm:ss")),0===header.sections[i].lines.length){if(i!==header.sections.length-1)continue;resolve(header)}else for(var j=0;j<header.sections[i].lines.length;j++)if(header.sections[i].lines[j].ORD=j+1,header.sections[i].lines[j].previewPath&&delete header.sections[i].lines[j].previewPath,$scope.isEdit===!1?header.sections[i].lines[j].Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"):(header.sections[i].lines[j].Creation_date=""===header.sections[i].lines[j].Creation_date?moment().format("YYYY-MM-DD hh:mm:ss"):moment(header.sections[i].lines[j].Creation_date).format("YYYY-MM-DD hh:mm:ss"),header.sections[i].lines[j].Last_update_date=moment().format("YYYY-MM-DD hh:mm:ss")),0===header.sections[i].lines[j].details.length){if(j!==header.sections[i].lines.length-1||i!==header.sections.length-1)continue;resolve(header)}else for(var k=0;k<header.sections[i].lines[j].details.length;k++)header.sections[i].lines[j].details[k].ORD=k+1,header.sections[i].lines[j].details[k].previewPath&&delete header.sections[i].lines[j].details[k].previewPath,$scope.isEdit===!1?header.sections[i].lines[j].details[k].Creation_date=moment().format("YYYY-MM-DD hh:mm:ss"):(header.sections[i].lines[j].details[k].Creation_date=""===header.sections[i].lines[j].details[k].Creation_date?moment().format("YYYY-MM-DD hh:mm:ss"):moment(header.sections[i].lines[j].details[k].Creation_date).format("YYYY-MM-DD hh:mm:ss"),header.sections[i].lines[j].details[k].Last_update_date=moment().format("YYYY-MM-DD hh:mm:ss")),k===header.sections[i].lines[j].details.length-1&&j===header.sections[i].lines.length-1&&i===header.sections.length-1&&resolve(header)})};$scope.openModal=function(data){var modalInstance=$modal.open({animation:!0,templateUrl:"modules/fadefine/views/imageModal.html",controller:"ImageDialogController",size:"lg"});modalInstance.result.then(function(selectedImg){data.PICTURE=selectedImg.realPath,selectedImg.previewPath&&null!==selectedImg.previewPath&&""!==selectedImg.previewPath?data.previewPath=selectedImg.previewPath:delete data.previewPath})}}),angular.module("app.loggedIn.fadefine.imageDialog.controller",[]).controller("ImageDialogController",function($scope,$timeout,$modalInstance,FileUploader,FaDefineService,toastr){var getImages=function(){FaDefineService.getImageFiles().then(function(result){(result.status="success")?($scope.images=[],result.files.forEach(function(file){var image={realPath:".\\download\\documentImage\\"+file,previewPath:"https://"+location.host+"/document/fa/images/"+file};$scope.images.push(image),console.log($scope.images)})):toastr.error("Unexpected error when getting images.","Error")})};getImages(),$scope.info_upload={total_size:0,progress_percent:0,pre_progress_percent:0},$scope.uploader=new FileUploader({url:"/api/erm/v2/fa/upload_image",autoUpload:!0,removeAfterUpload:!0,filters:[{name:"img_filter",fn:function(item){return"image/jpeg"===item.type||"image/png"===item.type?!0:(toastr.error("Only jpg, jpeg and png allowed!","Error!"),!1)}}],onSuccessItem:function(item,response,status,headers){var uploaded_percent=100*item.file.size/$scope.info_upload.total_size;$scope.info_upload.pre_progress_percent+=uploaded_percent,console.log($scope.info_upload.pre_progress_percent)},onProgressItem:function(item,progress){var uploaded_size=progress*item.file.size/100,uploaded_percent=100*uploaded_size/$scope.info_upload.total_size;$scope.info_upload.progress_percent=$scope.info_upload.pre_progress_percent+uploaded_percent},onCompleteAll:function(res){$scope.info_upload={total_size:0,progress_percent:0,pre_progress_percent:0},getImages()},onAfterAddingAll:function(items){angular.forEach(items,function(f){$scope.info_upload.total_size+=f.file.size}),$scope.info_upload.step_size=$scope.info_upload.total_size/100}}),$scope.openUploader=function(){$timeout(function(){$("#image_upload").click()},100)},$scope.chooseImage=function(image){$modalInstance.close(image)},$scope.chooseNoImg=function(){var noImg={realPath:null,previewPath:null};$modalInstance.close(noImg)}}),angular.module("app.loggedIn.fadefine.service",[]).factory("FaDefineService",function(Restangular){var instanceService={},v2_api=Restangular.all("api/erm/v2");return instanceService.insertFa=function(postData){var faApi=v2_api.all("fa/insert");return faApi.post(postData)},instanceService.deleteFa=function(headerId){var deleteFaApi=v2_api.all("fa/delete");return deleteFaApi.post({id:headerId})},instanceService.getHeaderAndSection=function(headerId){var getHeaderAndSectionApi=v2_api.all("fa/get_header_and_sections");return getHeaderAndSectionApi.post({id:headerId})},instanceService.getLines=function(sectionId,headerId){var getLinesApi=v2_api.all("fa/get_lines");return getLinesApi.post({sectionId:sectionId,headerId:headerId})},instanceService.getDetailsAndComments=function(lineId){var getDetailsAndCommentsApi=v2_api.all("fa/get_details_and_comments");return getDetailsAndCommentsApi.post({lineId:lineId})},instanceService.editFa=function(postData){var editFaApi=v2_api.all("fa/edit");return editFaApi.post(postData)},instanceService.changeFaStt=function(status,headerId){var changeFaSttApi=v2_api.all("fa/change_header_stt");return changeFaSttApi.post({headerId:headerId,status:status})},instanceService.getImageFiles=function(){var getImagesApi=v2_api.all("fa/get_images");return getImagesApi.post()},instanceService}),angular.module("app.loggedIn.pr",["app.loggedIn.pr.controller","app.loggedIn.pr.service","app.loggedIn.pr.directive","app.loggedIn.pr.prImportTaxList.directive","app.loggedIn.pr.prTaxList.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.pr",{url:"/pr",templateUrl:"modules/hrPayroll/views/pr.html",controller:"prController"}).state("loggedIn.pr.prTaxList",{url:"/taxlist",templateUrl:"modules/hrPayroll/views/prTaxList.html",controller:"prTaxListController"})}),angular.module("app.loggedIn.pr.controller",[]).controller("prController",function($scope,prService){}),angular.module("app.loggedIn.pr.directive",[]),angular.module("app.loggedIn.pr.prImportTaxList.directive",[]).directive("prImportTaxList",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{},templateUrl:"modules/hrPayroll/directives/prImportTaxList.html",controller:function($scope,prService,FileUploader){var uploader=$scope.uploader=new FileUploader({url:"/api/pr/fornightly-tax/import-tax-list"});uploader.filters.push({name:"customFilter",fn:function(item,options){return this.queue.length<10}}),uploader.onWhenAddingFileFailed=function(item,filter,options){console.info("onWhenAddingFileFailed",item,filter,options)},uploader.onAfterAddingFile=function(fileItem){uploader.queue.splice(0,uploader.queue.length-1),console.info("onAfterAddingFile",fileItem)},uploader.onAfterAddingAll=function(addedFileItems){console.info("onAfterAddingAll",addedFileItems)},uploader.onBeforeUploadItem=function(item){console.info("onBeforeUploadItem",item)},uploader.onProgressItem=function(fileItem,progress){console.info("onProgressItem",fileItem,progress)},uploader.onProgressAll=function(progress){console.info("onProgressAll",progress)},uploader.onSuccessItem=function(fileItem,response,status,headers){console.info("onSuccessItem",fileItem,response,status,headers)},uploader.onErrorItem=function(fileItem,response,status,headers){console.info("onErrorItem",fileItem,response,status,headers)},uploader.onCancelItem=function(fileItem,response,status,headers){console.info("onCancelItem",fileItem,response,status,headers)},uploader.onCompleteItem=function(fileItem,response,status,headers){console.info("onCompleteItem",fileItem,response,status,headers)},uploader.onCompleteAll=function(){console.info("onCompleteAll")},console.info("uploader",uploader),$scope.importTaxList=function(){uploader.uploadAll()}}}}),angular.module("app.loggedIn.pr.service",[]).factory("prService",function(Restangular,$http,$q,$window){var prService={},api=Restangular.all("api");return prService.taxList={getAllTaxListHeader:function(){var result=api.one("pr/fornightly-tax/get-all-taxlist-header");return result.get()},getTaxListDetail:function(taxHeaderId,startIndex,numberOfItems){var result=api.all("pr/fornightly-tax/get-taxlist-detail");return result.post({taxHeaderId:taxHeaderId,startIndex:startIndex,numberOfItems:numberOfItems})}},prService}),angular.module("app.loggedIn.pr.prTaxList.controller",[]).controller("prTaxListController",function($scope,prService){$scope.getAllTaxListHeader=function(){$scope.taxList=[],prService.taxList.getAllTaxListHeader().then(function(data){$scope.taxList="success"==data.status?data.data:[]},function(err){$scope.taxList=[]})},$scope.getAllTaxListHeader(),$scope.taxListDetail=[],$scope.getTaxListDetail=function(taxHeaderId){prService.taxList.getTaxListDetail(taxHeaderId).then(function(data){$scope.taxListDetail="success"==data.status?data.data:[]},function(err){$scope.taxListDetail=[]})},$scope.selectedTaxList={},$scope.setSelectedTaxList=function(item){$scope.selectedTaxList=item,$scope.taxListLoader=new TaxListDetailLoader(item.id,100),$scope.taxListLoader.loadMore()};var TaxListDetailLoader=function(taxHeaderId,numberOfItems){this.taxListDetail=[],this.busy=!1,this.after=-1,this.taxHeaderId=taxHeaderId,this.numberOfItems=numberOfItems};TaxListDetailLoader.prototype.loadMore=function(){this.busy||(this.busy=!0,prService.taxList.getTaxListDetail(this.taxHeaderId,this.after+1,this.numberOfItems).then(function(data){"success"==data.status&&(this.taxListDetail=this.taxListDetail.concat(data.data),this.after=this.after+data.data.length,this.busy=!1)}.bind(this),function(err){}))}}),angular.module("app.loggedIn.function",["app.loggedIn.function.controller","app.loggedIn.function.services"]).config(function($stateProvider){$stateProvider.state("loggedIn.function",{url:"/functions",templateUrl:"modules/function/views/function.html",controller:"FunctionController"})}),angular.module("app.loggedIn.function.services",[]).factory("FunctionService",function(Restangular){var functionService={},api=Restangular.all("api");return functionService.getList=function(){var list=api.one("function/list");return list.get()},functionService.saveFunction=function(f){var saveApi=api.all("function/edit");return saveApi.post({f:f})},functionService.insertFunction=function(f){var insertApi=api.all("function/new");return insertApi.post({f:f})},functionService.delFunction=function(id){var del=api.all("function/delete");return del.post({id:id})},functionService.getFunctionInfo=function(id){var info=api.all("function/id");return info.post({id:id})},functionService}),angular.module("app.loggedIn.function.controller",[]).controller("FunctionController",function($scope,$state,$modal,$filter,ngTableParams,FunctionService,$http,toastr){$scope.data=[],$scope.rs=[],FunctionService.getList().then(function(response){$scope.data=response,$scope.tableParams=new ngTableParams({page:1,count:10},{total:response.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.editFunction=function(f){var modalInstance=$modal.open({templateUrl:"modules/function/views/functionDetails.html",controller:"EditFunctionController",size:"md",resolve:{functionId:function(){return f.function_id}}});modalInstance.result.then(function(){$scope.rs=[],FunctionService.getList().then(function(response){$scope.data=response,$scope.$watch("data",function(data){$scope.tableParams.reload()})})})},$scope.deleteFunction=function(f){FunctionService.delFunction(f.function_id).then(function(data){"success"===data.status?($scope.rs=[],toastr.success("Delete Function Successfully!","Success"),FunctionService.getList().then(function(response){$scope.data=response,$scope.$watch("data",function(data){$scope.tableParams.reload()})})):toastr.error("Delete Function Failed!","Error")})},$scope.addNewFunction=function(){var modalInstance=$modal.open({templateUrl:"modules/function/views/functionDetails.html",controller:"NewFunctionController",size:"md"});modalInstance.result.then(function(){$scope.rs=[],FunctionService.getList().then(function(response){$scope.data=response,$scope.$watch("data",function(data){$scope.tableParams.reload()})})})}}).controller("NewFunctionController",function($scope,$filter,$state,$modalInstance,FunctionService,toastr){$scope.info={decription:null,definition:null,isWeb:"1",isMobile:"0"},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.submitFunction=function(){$scope.showClickedValidation=!0,$scope.functionForm.$invalid?toastr.error("Please Input All Required Information!","Error"):FunctionService.insertFunction($scope.info).then(function(response){"success"===response.status?(toastr.success("Insert New Function Successfully!","Success"),$modalInstance.close()):toastr.error("Insert New Function Failed!","Error")})}}).controller("EditFunctionController",function($scope,$filter,$state,$modalInstance,FunctionService,functionId,toastr){$scope.info={function_id:functionId,decription:null,definition:null,isWeb:null,isMobile:null},FunctionService.getFunctionInfo(functionId).then(function(data){console.log(data),$scope.info=data,$scope.info.isWeb=1==data.isWeb?"1":"0",$scope.info.isMobile=1==data.isMobile?"1":"0"}),$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.submitFunction=function(){$scope.showClickedValidation=!0,$scope.functionForm.$invalid?toastr.error("Please Input All Required Information!","Error"):FunctionService.saveFunction($scope.info).then(function(response){"success"===response.status?(toastr.success("Edit Function Successfully!","Success"),$modalInstance.close()):toastr.error("Edit Function Failed!","Error")})}}),angular.module("app.loggedIn.patient.injuryManagement",["app.loggedIn.patient.injuryManagement.map.controller","app.loggedIn.patient.injuryManagement.detail.controller","app.loggedIn.patient.injuryManagement.list.controller","app.loggedIn.patient.injuryManagement.bluetooth.controller","app.loggedIn.patient.injuryManagement.services"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.im_Map",{url:"/im/maps",views:{"main-content":{templateUrl:"modules/injuryManagement/views/injuryMap.html",controller:"InjuryMapController"}}}).state("loggedIn.patient.im_List",{url:"/im/list",views:{"main-content":{templateUrl:"modules/injuryManagement/views/injuryList.html",controller:"InjuryListController"}}}).state("loggedIn.patient.im_Bluetooth",{url:"/im/bluetooth",views:{"main-content":{templateUrl:"modules/injuryManagement/views/bluetooth.html",controller:"BluetoothController"}}}).state("loggedIn.patient.im_Detail",{url:"/im/details/:id",views:{"main-content":{templateUrl:"modules/injuryManagement/views/injuryDetails.html",controller:"InjuryDetailController"}}})}),angular.module("app.loggedIn.patient.injuryManagement.map.controller",[]).controller("InjuryMapController",function($scope,$filter,$state,InjuryManagementService,UserService,toastr,socket,$interval,$modal,$modalInstance){function refreshMap(){$scope.injuryMarker=[],InjuryManagementService.getInjuryList().then(function(rs){if("success"==rs.status)for(var i=0;i<rs.data.length;i++){var isCurrDate=moment(rs.data[i].injury_date).isSame(moment(),"day");if(isCurrDate&&1==rs.data[i].isPickUp&&("New"==rs.data[i].STATUS||"Picking"==rs.data[i].STATUS)){var icon,patient=rs.data[i],positionArr=[];null!=patient.latitude&&positionArr.push(patient.latitude),null!=patient.longitude&&positionArr.push(patient.longitude),"Picking"==patient.STATUS?icon="modules/injuryManagement/icons/icon-orange.png":"New"==patient.STATUS&&(icon="modules/injuryManagement/icons/icon-blue.png"),$scope.patientData={id:patient.injury_id,patientId:patient.Patient_id,position:positionArr,pickupAddr:patient.pickup_address,FullName:patient.FullName,gender:patient.Sex,injuryDesc:patient.injury_description,status:patient.STATUS,icon:icon,driverUser:patient.driverUser,driverName:patient.driverName},$scope.injuryMarker.push($scope.patientData)}}})}$scope.injuryMarker=[],$scope.driverMarker=[],$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.selectedDriver={driverId:null},refreshMap(),socket.on("driverLocation",function(driverArr){if($scope.driverMarker=[],driverArr.length>0){for(var icon="modules/injuryManagement/icons/ambulance.png",i=0;i<driverArr.length;i++){var driver=driverArr[i];if($scope.driverData={driverId:driver.id,position:[driver.latitude,driver.longitude],username:driver.userName,icon:icon,patientList:driver.patientList},$scope.driverMarker.length>0){var index=_.findIndex($scope.driverMarker,{driverId:driver.id});-1==index?$scope.driverMarker.push($scope.driverData):($scope.driverMarker[index].position=$scope.driverData.position,$scope.driverMarker[index].patientList=$scope.driverData.patientList)}else $scope.driverMarker.push($scope.driverData)}for(var i=0;i<$scope.driverMarker.length;i++)if($scope.driverMarker[i].patientList.length>0)for(var j=0;j<$scope.driverMarker[i].patientList.length;j++)$scope.driverMarker[i].patientList[j].position=[$scope.driverMarker[i].patientList[j].latitude,$scope.driverMarker[i].patientList[j].longitude]}}),socket.on("receiveNotifyReceptionist",function(){refreshMap()}),$scope.showDetails=function(id){InjuryManagementService.getInjuryById(id).then(function(rs){"success"==rs.status&&$modal.open({templateUrl:"modules/consultation/dialogs/dialog_injury_details.html",
size:"md",resolve:{injuryInfo:function(){return rs.data}},controller:function($scope,$modalInstance,$stateParams,injuryInfo,InjuryManagementService){if($scope.info=injuryInfo,$scope.loadedImage=!1,$scope.injuryImages=[],$scope.imgArr=[],$scope.info.injury_date=moment.utc($scope.info.injury_date).format("DD/MM/YYYY - hh:mm:ss"),"undefined"!=typeof injuryInfo.injuryImg&&injuryInfo.injuryImg.length>0){$scope.loadedImage=!0;for(var i=0;i<injuryInfo.injuryImg.length;i++)$scope.imgArr.push({url:location.origin+"/api/im/image/"+injuryInfo.injuryImg[i].id,img:injuryInfo.injuryImg[i]})}$scope.cancelClick=function(){$modalInstance.close()},$scope.viewImage=function(img){$modal.open({templateUrl:"modules/injuryManagement/views/imageModal.html",size:"md",resolve:{imgObj:function(){return img}},controller:function($scope,$state,$modalInstance,UserService,socket,toastr,imgObj){$scope.img={image:location.origin+"/api/im/image/"+imgObj.id,description:imgObj.desc}}})}}})})},$scope.allocateDriver=function(injury){InjuryManagementService.allocateDriver($scope.selectedDriver.driverId,injury.patientId,injury.id).then(function(rs){"error"==rs.status?toastr.error("Send Notification Failed!","Error"):(toastr.success("Send Notification Successfully!","Success"),$scope.selectedDriver.driverId=null,refreshMap())})},$scope.refreshMap=function(){refreshMap()},setInterval(refreshMap,6e4)}),angular.module("app.loggedIn.patient.injuryManagement.list.controller",[]).controller("InjuryListController",function($scope,$filter,$state,InjuryManagementService,UserService,toastr,socket,$stateParams,$cookieStore){function refreshList(){$scope.search.driver="",$scope.search.dateRange=null,$scope.injuryList=[],$scope.injuryListTemp=[],InjuryManagementService.getInjuryListByPatient($scope.patient_id).then(function(rs){if("success"==rs.status)if(rs.data.length>0){$scope.haveData=!0;for(var j=0;j<rs.data.length;j++)(null==rs.data[j].driverUser||"undefined"==typeof rs.data[j].driverUser)&&(rs.data[j].driverUser="");$scope.injuryListTemp=rs.data,$scope.injuryList=$scope.injuryListTemp}else $scope.haveData=!1;else $scope.haveData=!1})}function filterDate(from,to){$scope.injuryList=[],$scope.injuryListTemp=[],InjuryManagementService.searchByDatePatient(from,to,$scope.patient_id).then(function(rs){if("success"==rs.status){for(var j=0;j<rs.data.length;j++)(null==rs.data[j].driverUser||"undefined"==typeof rs.data[j].driverUser)&&(rs.data[j].driverUser="");$scope.injuryListTemp=rs.data,$scope.injuryList=$scope.injuryListTemp}})}$scope.patient_id=$stateParams.patient_id,$scope.search={driver:"",dateRange:null},$scope.haveData=!1;var from=$cookieStore.get("fromState"),params={};(null!=from.fromParams||"undefined"!=typeof from.fromParams)&&angular.forEach(from.fromParams,function(value,key){params[key]=value}),$scope.goBack=function(){$state.go(from.fromState.name,params,{location:"replace",reload:!0})},$scope.refreshList=function(){refreshList()},$scope.showDetails=function(id){$state.go("loggedIn.patient.im_Detail",{id:id})},$scope.searchInjury=function(s){$scope.injuryList=$filter("filter")($scope.injuryListTemp,{driverUser:s.driver})},$scope.getDateRange=function(range){filterDate($filter("date")(range.start.toDate(),"yyyy-MM-dd"),$filter("date")(range.end.toDate(),"yyyy-MM-dd")),$scope.search.patient="",$scope.search.driver=""},InjuryManagementService.getInjuryListByPatient($scope.patient_id).then(function(rs){if("success"==rs.status)if(rs.data.length>0){$scope.haveData=!0;for(var j=0;j<rs.data.length;j++)(null==rs.data[j].driverUser||"undefined"==typeof rs.data[j].driverUser)&&(rs.data[j].driverUser="");$scope.injuryListTemp=rs.data,$scope.injuryList=$scope.injuryListTemp}else $scope.haveData=!1;else $scope.haveData=!1})}),angular.module("app.loggedIn.patient.injuryManagement.detail.controller",[]).controller("InjuryDetailController",function($scope,$http,$modal,$filter,$state,$stateParams,InjuryManagementService,toastr){$scope.injuryInfo={},$scope.injuryImages=[],$scope.loadedImage=!1,$scope.imgArr=[],InjuryManagementService.getInjuryById(injuryId).then(function(rs){if("success"==rs.status&&($scope.injuryInfo=rs.data[0],$scope.injuryInfo.injuryImg.length>0)){$scope.loadedImage=!0;for(var i=0;i<$scope.injuryInfo.injuryImg.length;i++)$scope.imgArr.push({url:location.origin+"/api/im/image/"+$scope.injuryInfo.injuryImg[i].id,img:$scope.injuryInfo.injuryImg[i]})}}),$scope.viewImage=function(img){$modal.open({templateUrl:"modules/injuryManagement/views/imageModal.html",size:"md",resolve:{imgObj:function(){return img}},controller:function($scope,$state,$modalInstance,UserService,socket,toastr,imgObj){$scope.img={image:location.origin+"/api/im/image/"+imgObj.id,description:imgObj.desc}}})}}),angular.module("app.loggedIn.patient.injuryManagement.bluetooth.controller",[]).controller("BluetoothController",function($scope,$filter,$state,InjuryManagementService,UserService,toastr,socket,$stateParams,$cookieStore,ngTableParams){$scope.patient_id=$stateParams.patient_id,$scope.deviceList=[];var colors=["blue-soft","red-soft","purple-soft","green-soft"],icons=["fa fa-plus-square","fa fa-medkit","fa fa-heart","fa fa-stethoscope"];$scope.haveData=!1,$scope.currDevice=null,$scope.chartData=[],socket.on("getMeasureData",function(rs){if(rs.info){var data=angular.copy(rs.info);delete data.deviceType,delete data.rawData,$scope.$apply(function(){$scope.onlineDevice=rs.info.deviceType,$scope.onlineData=data})}}),InjuryManagementService.getMedicalDevices().then(function(rs){if("success"==rs.status){for(var i=0;i<rs.data.length;i++)rs.data[i].color=colors[Math.floor(Math.random()*colors.length)],rs.data[i].icon=icons[Math.floor(Math.random()*icons.length)];$scope.deviceList=rs.data}}),$scope.updateMeasure=function(measure){var m={};m.notes=measure.notes,InjuryManagementService.editDeviceMeasure(m,measure.measure_id).then(function(rs){"success"==rs.status?toastr.success("Edit Success!"):toastr.error("Edit Failed!")})},$scope.chartOptions={series:{lines:{show:!0},points:{show:!0}},xaxis:{tickLength:0,tickDecimals:0,mode:"categories",min:0,font:{lineHeight:14,style:"normal",variant:"small-caps",color:"#6F7B8A"}},yaxis:{ticks:5,tickDecimals:0,tickColor:"#eee",font:{lineHeight:14,style:"normal",variant:"small-caps",color:"#6F7B8A"}},grid:{hoverable:!0,clickable:!0,tickColor:"#eee",borderColor:"#eee",borderWidth:1}},$scope.changeHistory=function(dateRange){null!=$scope.data&&null!=$scope.currDevice&&getHistory($scope.currDevice.toLowerCase(),_.sortBy($scope.data,"measure_date"),moment(dateRange.start),moment(dateRange.end))},$scope.showHistory=function(device){$scope.data=null,$scope.haveData=!1,$scope.currDevice=device.device_name,InjuryManagementService.getDeviceDataByPatient(device.id,$scope.patient_id).then(function(rs){if("success"==rs.status)if(rs.data.length>0){$scope.haveData=!0;for(var deviceType=null,i=0;i<rs.data.length;i++)(null!=rs.data[i].measureData||""!=rs.data[i].measureData)&&(deviceType=rs.data[0].device_name.toLowerCase(),rs.data[i].jsonData=JSON.parse(rs.data[i].measureData));$scope.data=rs.data,$scope.historyDates=moment().range(moment().subtract(1,"days"),moment()),getHistory(deviceType,_.sortBy($scope.data,"measure_date"),moment().subtract(1,"days"),moment()),null!=$scope.data&&($scope.tableParams=new ngTableParams({page:1,count:10},{total:rs.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}))}else $scope.haveData=!1;else $scope.haveData=!1})};var getHistory=function(deviceType,data,from,to){var fromDate=moment(from).format("YYYY-MM-DD"),toDate=moment(to).format("YYYY-MM-DD"),pulse=[],spO2=[],fev1=[],fvc=[],pef=[],sys=[],dia=[],bpm=[],mmHg=[];$scope.chartData=[];for(var i=0;i<data.length;i++){var measureDate=$filter("date")(data[i].measure_date,"yyyy-MM-dd"),measureDateHrs=$filter("date")(data[i].measure_date,"dd/MM/yyyy-hh:mm a");switch(deviceType){case"pulse oximeter":(moment(measureDate).isBefore(toDate)&&moment(measureDate).isAfter(fromDate)||moment(measureDate).isSame(fromDate)||moment(measureDate).isSame(toDate))&&(pulse.push([measureDateHrs,data[i].jsonData.pulse]),spO2.push([measureDateHrs,data[i].jsonData.spO2]));break;case"spirometer":(moment(measureDate).isBefore(toDate)&&moment(measureDate).isAfter(fromDate)||moment(measureDate).isSame(fromDate)||moment(measureDate).isSame(toDate))&&(fev1.push([measureDateHrs,data[i].jsonData.FEV1]),fvc.push([measureDateHrs,data[i].jsonData.FVC]),pef.push([measureDateHrs,data[i].jsonData.PEF]));break;case"blood pressure":(moment(measureDate).isBefore(toDate)&&moment(measureDate).isAfter(fromDate)||moment(measureDate).isSame(fromDate)||moment(measureDate).isSame(toDate))&&(sys.push([measureDateHrs,data[i].jsonData.sys]),dia.push([measureDateHrs,data[i].jsonData.dia]),bpm.push([measureDateHrs,data[i].jsonData.bpm]),mmHg.push([measureDateHrs,data[i].jsonData.mmHg]))}}switch(deviceType){case"pulse oximeter":$scope.chartData.push({data:pulse,label:"Pulse"}),$scope.chartData.push({data:spO2,label:"SpO2"});break;case"spirometer":$scope.chartData.push({data:fev1,label:"FEV1"}),$scope.chartData.push({data:fvc,label:"FVC"}),$scope.chartData.push({data:pef,label:"PEF"});break;case"blood pressure":$scope.chartData.push({data:sys,label:"SYS"}),$scope.chartData.push({data:dia,label:"DIA"}),$scope.chartData.push({data:bpm,label:"BPM"}),$scope.chartData.push({data:mmHg,label:"mmHg"})}}}),angular.module("app.loggedIn.patient.injuryManagement.services",[]).factory("InjuryManagementService",function(Restangular){var imService={},api=Restangular.all("api");return imService.getInjuryList=function(){return api.one("im/list").get()},imService.getInjuryListByPatient=function(patient_id){return api.all("im/listByPatient").post({patient_id:patient_id})},imService.getInjuryById=function(id){return api.all("im/getById").post({injury_id:id})},imService.getImageByInjury=function(id){return api.all("im/images").post({injury_id:id})},imService.listDriver=function(){return api.one("im/getListDriver").get()},imService.allocateDriver=function(dId,pId,iId){return api.all("im/allocateDriver").post({driverId:dId,patientId:pId,injuryId:iId})},imService.searchByDate=function(from,to){return api.all("im/searchByDate").post({from:from,to:to})},imService.searchByDatePatient=function(from,to,patient_id){return api.all("im/searchByDatePatient").post({from:from,to:to,patient_id:patient_id})},imService.getMedicalDevices=function(){return api.one("im/getDevices").get()},imService.getDeviceDataByPatient=function(id,patientId){return api.all("medicalDevice/getData").post({id:id,patient_id:patientId})},imService.editDeviceMeasure=function(info,id){return api.all("medicalDevice/edit").post({id:id,info:info})},imService}),angular.module("app.loggedIn.insurer",["app.loggedIn.insurer.controller","app.loggedIn.insurer.services","app.loggedIn.insurer.directives"]).config(function($stateProvider){$stateProvider.state("loggedIn.insurer",{"abstract":!0,templateUrl:"modules/insurer/views/structure.html",controller:"InsurerController"}).state("loggedIn.insurer.list",{url:"/insurer/list",views:{"main-content":{templateUrl:"modules/insurer/views/list.html",controller:"InsurerListController"}}}).state("loggedIn.insurer.detail",{url:"/insurer/detail",views:{"main-content":{templateUrl:"modules/insurer/views/detail.html",controller:"InsurerDetailController"}}}).state("loggedIn.insurer.add",{url:"/insurer/add",views:{"main-content":{templateUrl:"modules/insurer/views/add.html",controller:"InsurerAddController"}}})}),angular.module("app.loggedIn.insurer.services",[]).factory("InsurerService",function(Restangular){var instanceService={},appApi=Restangular.all("api/erm"),insurerApi=Restangular.all("api/meditek/v1/insurer");return instanceService.detail=function(id){var instanceApi=appApi.one("v2/insurers/detail");return instanceApi.get({id:id})},instanceService.insert=function(data){var instanceApi=appApi.all("v2/insurers/insert");return instanceApi.post({data:data})},instanceService.update=function(id,data){var instanceApi=appApi.all("v2/insurers/update");return instanceApi.post({id:id,data:data})},instanceService["delete"]=function(id){var instanceApi=appApi.all("v2/insurer/delete");return instanceApi.post({id:id})},instanceService.oneFollowPatient=function(data){var instanceApi=insurerApi.all("oneFollowPatient");return instanceApi.post({data:data})},instanceService.getFeeGroup=function(data){var instanceApi=insurerApi.all("getFeeGroup");return instanceApi.post({data:data})},instanceService.oneFollowCompany=function(data){var instanceApi=insurerApi.all("oneFollowCompany");return instanceApi.post({data:data})},instanceService.insurerByPatient=function(patient_id){return insurerApi.all("getByPatient").post({patient_id:patient_id})},instanceService}),angular.module("app.loggedIn.insurer.directives",["app.loggedIn.insurer.detail.directive"]),angular.module("app.loggedIn.insurer.detail.directive",[]).directive("insurerDetail",function(InsurerModel,InsurerService,ConfigService,toastr,InvoiceService,InvoiceService){return{restrict:"EA",scope:{data:"@",options:"=",on_success:"=onsuccess",success:"=",responsedata:"="},templateUrl:"modules/insurer/directives/templates/detail.html",link:function(scope,element,attrs){scope.getFeegrouptype=function(){var postData={FEE_GROUP_TYPE:"private_fund"};InsurerService.getFeeGroup(postData).then(function(response){scope.feeGroupType=response.data})},scope.getFeegrouptype();var loadData=function(id){InsurerService.detail(id).then(function(data){angular.extend(scope.modelObjectMap,data.row),InvoiceService.getFeegroupbyid({FEE_GROUP_ID:data.row.FEE_GROUP_ID}).then(function(response){scope.modelObjectMap.FEE_GROUP_ID=response.data[0].FEE_GROUP_ID}),scope.modelObjectMap.isenable+="",ConfigService.autoConvertData(scope.modelObjectMap)})};if(ConfigService.countries_option().then(function(result){scope.country_options=result.data}),scope.modelObjectMap=angular.copy(InsurerModel),scope.mode={type:"add",text:"Add Company"},scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit Insurer"})}var addProcess=function(postData){InsurerService.insert(postData).then(function(response){"success"===response.status&&(toastr.success("Added a new Insurer","Success"),scope.modelObjectMap=angular.copy(InsurerModel),scope.isSubmit=!1,scope.success=!0,scope.responsedata=response,scope.on_success&&scope.on_success(response))})},editProcess=function(postData){var id=postData.id;delete postData.id,InsurerService.update(id,postData).then(function(response){"success"===response.status&&(toastr.success("Edit Insurer Successfully","Success"),scope.isSubmit=!1,scope.success=!0,scope.on_success&&scope.on_success(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.insurer.controller",["app.loggedIn.insurer.list.controller","app.loggedIn.insurer.detail.controller","app.loggedIn.insurer.add.controller"]).controller("InsurerController",function($scope){}),angular.module("app.loggedIn.insurer.list.controller",[]).controller("InsurerListController",function($scope,$state,localStorageService,$modal){$scope.insurer_panel={},$scope.data_options={api:"api/erm/v2/insurers/search",method:"post",scope:$scope.insurer_panel,search:{},columns:[{field:"id",is_hide:!0},{field:"insurer_name",label:"Company Name"},{field:"address",label:"Address"},{field:"suburb",label:"Suburb"},{field:"isenable"}]},$scope.add_forminsurer=function(){$modal.open({templateUrl:"add_forminsurer",controller:function($scope,$modalInstance,add_form){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.add_form={success:!1},$scope.$watch("add_form.success",function(success){success&&$modalInstance.close("success")})},resolve:{add_form:function(){return $scope.add_form}}}).result.then(function(response){"success"===response&&$scope.insurer_panel.reload()})},$scope.edit_forminsurer=function(){$modal.open({templateUrl:"edit_forminsurer",controller:function($scope,$modalInstance,edit_form,id){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.edit_form={success:!1,id:id},$scope.$watch("edit_form.success",function(success){success&&$modalInstance.close("success")})},resolve:{edit_form:function(){return $scope.edit_form},id:function(){return $scope.insurerInfo.id}}}).result.then(function(response){"success"===response&&$scope.insurer_panel.reload()})},$scope.add_form={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){$scope.insurer_panel.reload()}},$scope.edit_form={is_show:!1,open:function(){$scope.edit_forminsurer()},close:function(){this.is_show=!1},success:function(response){console.log("edit reloading"),$scope.insurer_panel.reload()}},$scope.clickRow=function(item){$scope.add_form.is_show&&$scope.add_form.close(),$scope.insurerInfo=item,$scope.edit_form.open()},$scope.reload=function(){console.log($scope.data_options.search.SHOW_ALL),$scope.insurer_panel.reload()}}),angular.module("app.loggedIn.insurer.detail.controller",[]).controller("InsurerDetailController",function($scope,$state,localStorageService){$scope.insurerInfo=localStorageService.get("tempInsurerInfo"),$scope.insurerInfo||$state.go("loggedIn.insurer.list")}),angular.module("app.loggedIn.insurer.add.controller",[]).controller("InsurerAddController",function($scope,$state){});var invConst={billTo:{privateFund:{display:"Private Funds",value:"private_fund"},otherFeeType:{display:"Other Fee Types",value:"other_fee_type"}},feeGroupType:{private_fund:{value:"private_fund",display:"Private Fund",haveStartDate:!0,sourceFileTypes:{txt:{value:"txt",display:"txt"}}},medicare:{value:"medicare",display:"Medicare",haveStartDate:!1,sourceFileTypes:{xml:{value:"xml",display:"xml"}}},dva:{value:"dva",display:"DVA",haveStartDate:!0,sourceFileTypes:{xml:{value:"xml",display:"xml"}}},public_hospital:{value:"public_hospital",haveStartDate:!1,display:"Public Hospital"},workcover:{value:"workcover",haveStartDate:!1,display:"Workcover"}},feeGroupTypeAuto:{private_fund:{value:"private_fund",display:"Private Fund",haveStartDate:!0,sourceFileTypes:{txt:{value:"txt",display:"txt"}}},workcover:{value:"workcover",haveStartDate:!1,display:"Workcover"}}},testReport=!1;angular.module("app.loggedIn.invoice",["app.loggedIn.invoice.directives","app.loggedIn.invoice.services","app.loggedIn.invoice.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.invoice",{"abstract":!0,templateUrl:"modules/invoice/views/structure.html",controller:"InvoiceController"}).state("loggedIn.invoice.list",{url:"/invoice/list",views:{"main-content":{templateUrl:"modules/invoice/views/list.html",controller:"InvoiceListController"}}})}),angular.module("app.loggedIn.invoice.services",[]).factory("InvoiceService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/erm/v2"),api=Restangular.all("api");return mdtService.headerDetail=function(id){var funcApi=mdtApi.all("invoice/detail");return funcApi.post({header_id:id})},mdtService.save=function(id,postData){var funcApi=mdtApi.all("invoice/save");return funcApi.post({header_id:id,status:postData.STATUS,lines:postData.lines,service_id:postData.SERVICE_ID,postData:postData})},mdtService.update=function(id,postData){var funcApi=mdtApi.all("invoice/update");return funcApi.post({header_id:id,data:postData})},mdtService.add=function(postData){var funcApi=mdtApi.all("invoice/add");return funcApi.post({data:postData})},mdtService.removeInvoiceLine=function(data){var funcApi=mdtApi.all("invoice/remove_invoice_line");return funcApi.post({data:data})},mdtService.getInvoiceHeader=function(invoiceHeaderId){var result=api.all("invoice/vn/get-invoice-header");return result.post({invoiceHeaderId:invoiceHeaderId})},mdtService.getInvoiceListLines=function(invoiceHeaderId){var result=api.all("invoice/vn/get-invoice-list-lines");return result.post({invoiceHeaderId:invoiceHeaderId})},mdtService.createInvoiceLine=function(postData){var result=mdtApi.all("invoice/create_invoice_line");return result.post({postData:postData})},mdtService.updateInvoiceLine=function(postData){var result=mdtApi.all("invoice/update_invoice_line");return result.post({postData:postData})},mdtService.saveInvoiceLineSheet=function(postData){var result=mdtApi.all("invoice/save_invoice_line_sheet");return result.post({postData:postData})},mdtService.selectInvoiceHeaderBySession=function(patientId,calId){var result=mdtApi.all("invoice/select_invoice_header_by_session");return result.post({patientId:patientId,calId:calId})},mdtService.selectInvoiceLinesBySession=function(patientId,calId){var result=mdtApi.all("invoice/select_invoice_lines_by_session");return result.post({patientId:patientId,calId:calId})},mdtService.getitemfillterfeeid=function(postData){var funcApi=mdtApi.all("invoice/getitemfillterfeeid");return funcApi.post({data:postData})},mdtService.getpatientbyid=function(postData){var funcApi=mdtApi.all("invoice/getpatientbyid");return funcApi.post({data:postData})},mdtService.getFeegroupbyid=function(postData){var funcApi=mdtApi.all("invoice/feegroupbyid");return funcApi.post({data:postData})},mdtService.getFeeGroupByInsurer=function(postData){var funcApi=mdtApi.all("invoice/get_fee_group_by_insurer");return funcApi.post({data:postData})},mdtService.getFeeGroupByType=function(postData){var funcApi=mdtApi.all("invoice/get_fee_group_by_type");return funcApi.post({data:postData})},mdtService.getFeeType=function(postData){var funcApi=mdtApi.all("invoice/feetype");return funcApi.post({data:postData})},mdtService.getSaveManual=function(postData){var funcApi=mdtApi.all("invoice/savemanual");return funcApi.post({data:postData})},mdtService.getEditManual=function(postData){var funcApi=mdtApi.all("invoice/editmanual");return funcApi.post({data:postData})},mdtService.getOnemanual=function(postData){var funcApi=mdtApi.all("invoice/onemanual");return funcApi.post({data:postData})},mdtService.getfeetypefillter=function(postData){var funcApi=mdtApi.all("invoice/getfeetypefillter");return funcApi.post({data:postData})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService.getCurrentFeeOfItems=function(postData){var funcApi=mdtApi.all("invoice/get_current_fee_of_items");return funcApi.post({postData:postData})},mdtService}),angular.module("app.loggedIn.invoice.controller",["app.loggedIn.invoice.list.controller"]).controller("InvoiceController",function($scope,ConfigService){}),angular.module("app.loggedIn.invoice.list.controller",[]).controller("InvoiceListController",function($scope,$state,toastr,ItemService,ConfigService,$modal){var invoice_status=[{label:"-- All --"}].concat($scope.options.invoice_status);$scope.invoiceClass=function(item){return{warning:"approach"==item.STATUS,success:"done"==item.STATUS,danger:"enter"==item.STATUS||null==item.STATUS}},$scope.invoicePanel={},$scope.invoiceOption={api:"api/erm/v2/invoice/search",method:"post",scope:$scope.invoicePanel,columns:[{field:"header_id",is_hide:!0},{field:"cal_id",is_hide:!0},{field:"Patient_id",label:"Patient",type:"custom",fn:function(item){return item.patient?item.patient.Title+". "+item.patient.First_name:void 0}},{field:"SOURCE_ID",label:"Bill to",type:"custom",fn:function(item){return item.cal_id?item.Insurer_id?item.insurer?"Insurer:"+item.insurer.insurer_name:null:item.Company_id?item.company?"Company:"+item.company.Company_name:null:item.patient?"Patient:"+item.patient.First_name+" "+item.patient.Sur_name:null:item.FEE_GROUP_TYPE==itemConst.feeGroupType.private_fund.value?item.insurer?itemConst.feeGroupType.private_fund.value+": "+item.insurer.insurer_name:null:item.feeGroup?item.feeGroup.FEE_GROUP_TYPE+": "+item.feeGroup.FEE_GROUP_NAME:null}},{field:"cal_id",label:"Invoice type",type:"custom",fn:function(item){return item.cal_id?"Auto":"Manual"}},{field:"Company_id",label:"Company",is_hide:!0,type:"custom",fn:function(item){return item.company?item.company.Company_name:void 0}},{field:"Insurer_id",label:"Insurer",is_hide:!0,type:"custom",fn:function(item){return item.insurer?item.insurer.insurer_name:void 0}},{field:"DOCTOR_ID",label:"Doctor",type:"custom",fn:function(item){return item.doctor?item.doctor.NAME:void 0}},{field:"SITE_ID",label:"Site",type:"custom",fn:function(item){return item.site?item.site.Site_name:void 0}},{field:"SERVICE_ID",label:"Service",type:"custom",fn:function(item){return item.service?item.service.SERVICE_NAME:void 0}},{field:"CREATION_DATE",order:"DESC",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.CREATION_DATE)}},{field:"STATUS",label:"Invoice status"}],use_filters:!0,filters:{STATUS:{type:"dropdown",values:invoice_status}},use_actions:!0,actions:[{"class":"fa fa-money",title:"Detail",callback:function(item){item.cal_id?$state.go("loggedIn.patient.invoice_detail",{header_id:item.header_id,patient_id:item.Patient_id,cal_id:item.cal_id}):$modal.open({templateUrl:"popupEditManualInvoice",controller:function($scope,$modalInstance,options,item){$scope.options=options,$scope.addmanual={success:"",headerdata:item},$scope.$watch("addmanual.success",function(response){1==response&&$modalInstance.close({status:"success",data:response})}),$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{options:function(){return $scope.options},item:function(){return item}},size:"lg"}).result.then(function(response){"success"==response.status&&$scope.invoicePanel.reload()})}},{"class":"fa fa-list-alt",title:"Print Invoice",callback:function(item){window.open(getUrlReport()+"/redimedInvoice/"+item.header_id)}}]},$scope.invoiceParams={permission:{add:!0}},$scope.showAddFormInvoice=function(){$modal.open({templateUrl:"popupAddManualInvoice",controller:function($scope,$modalInstance,options){$scope.options=options,$scope.addmanual={success:""},$scope.$watch("addmanual.success",function(response){1==response&&$modalInstance.close({status:"success",data:response})}),$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{options:function(){return $scope.options}},size:"lg"}).result.then(function(response){"success"==response.status&&(toastr.success("Add Manual Invoice Success !"),$scope.invoicePanel.reload())})},$scope.addFormInvoice={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(){$scope.addFormInvoice.close(),$scope.invoicePanel.reload()}}}),angular.module("app.loggedIn.invoice.directives",["app.loggedIn.invoice.detail.directive","app.loggedIn.invoice.tnInvoiceDetail.directive","app.loggedIn.invoice.search.directive","app.loggedIn.invoice.add.directive","app.loggedIn.invoice.addMaunalInvoice.directive"]),angular.module("app.loggedIn.invoice.detail.directive",[]).directive("invoiceDetail",function(InvoiceHeaderModel,ConfigService,InvoiceService,ReceptionistService,toastr,$state,$timeout,$filter,CompanyService,$modal){var arrGetBy=$filter("arrGetBy");return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/invoice/directives/templates/detail.html",controller:function($scope){$scope.goToAppt=function(patient_id,cal_id){$state.go("loggedIn.patient.appointment",{patient_id:patient_id,cal_id:cal_id})},$scope.feeGroupType=invConst.feeGroupType,$scope.feeGroups=[],$scope.feeTypes=[],$scope.InvoiceMap={FEE_GROUP_TYPE:null,FEE_GROUP_ID:null,FEE_TYPE_ID:null},$scope.feeGroupTypeChange=function(value){$scope.feeGroups=[],$scope.InvoiceMap.FEE_GROUP_ID=null,$scope.InvoiceMap.feeTypes=[],$scope.InvoiceMap.FEE_TYPE_ID=null,"private_fund"==value?InvoiceService.getFeeGroupByInsurer({id:$scope.InvoiceMap.Insurer_id}).then(function(response){$scope.feeGroups=response.data,$scope.InvoiceMap.FEE_GROUP_ID=response.data[0].FEE_GROUP_ID,$scope.feeGroupChange($scope.InvoiceMap.FEE_GROUP_ID)}):InvoiceService.getFeeGroupByType(value).then(function(response){$scope.feeGroups=response.data})},$scope.feeGroupChange=function(value){$scope.InvoiceMap.feeTypes=[],$scope.InvoiceMap.FEE_TYPE_ID=null,InvoiceService.getFeeType(value).then(function(response){$scope.feeTypes=response.data})},$scope.feeTypeChange=function(value){if(value){for(var postData={feeTypeId:value,listItem:[]},i=0;i<$scope.InvoiceMap.lines.length;i++)postData.listItem.push($scope.InvoiceMap.lines[i].ITEM_ID);InvoiceService.getCurrentFeeOfItems(postData).then(function(data){if("success"==data.status){toastr.success("Get current fee of items success","success");for(var feeMap={},i=0;i<data.data.length;i++){var item=data.data[i];feeMap[item.ITEM_ID]={FEE:item.FEE,PERCENT:item.PERCENT,FEE_START_DATE:item.FEE_START_DATE,ITEM_CODE:item.ITEM_CODE,TAX_ID:item.TAX_ID,TAX_CODE:item.TAX_CODE,TAX_RATE:item.TAX_RATE}}for(var i=0;i<$scope.InvoiceMap.lines.length;i++){var item=$scope.InvoiceMap.lines[i];item.PRICE=null,item.PRICE=feeMap[item.ITEM_ID]?feeMap[item.ITEM_ID].FEE:null}}else toastr.error("Get current fee of items fail.","error"),exlog.logErr("InvoiceDetailDirective->feeTypeChange",data)},function(err){toastr.error("Get current fee of items fail.","error"),exlog.logErr("InvoiceDetailDirective->feeTypeChange",err)})}},$scope.doctorSearch={open:function(){$modal.open({templateUrl:"popupDoctorSearch",controller:function($scope,$modalInstance,ConfigService){$scope.rowClick=function(item){ConfigService.system_service_by_clinical(item.CLINICAL_DEPT_ID).then(function(response){$modalInstance.close({item:item,response:response})})}},size:"md"}).result.then(function(data){$scope.InvoiceMap.DOCTOR_ID=data.item.doctor_id,$scope.InvoiceMap.DEPT_ID=data.item.CLINICAL_DEPT_ID,$scope.InvoiceMap.doctor={NAME:data.item.NAME},$scope.opt_services=[{SERVICE_ID:"",SERVICE_NAME:"-- Choose Service --"}].concat(data.response)})}},$scope.patientClaim={open:function(){$modal.open({templateUrl:"popupSelectClaim",controller:function($scope,$modalInstance,patient_id){$scope.patientClaimPanel={},$scope.options={api:"api/erm/v2/patients/claims",method:"post",scope:$scope.patientClaimPanel,columns:[{field:"Claim_id",is_hide:!0},{field:"Injury_name",label:"Injury"},{field:"Insurer"},{field:"insurer_id",is_hide:!0}],not_load:!1,search:{Patient_id:patient_id}},$scope.rowClick=function(item){$modalInstance.close({item:item})}},size:"md",resolve:{patient_id:function(){return $scope.patientClaim.Patient_id}}}).result.then(function(data){var postData={claim_id:data.item.Claim_id};InvoiceService.update($scope.params.id,postData).then(function(response){"success"==response.status&&($scope.InvoiceMap.claim=data.item,$scope.InvoiceMap.Insurer_id=data.item.insurer_id,$scope.InvoiceMap.claim_id=data.item.Claim_id,$scope.InvoiceMap.insurer={insurer_name:data.item.Insurer},toastr.success("Save Claim Successfully !!!","Success"))})})}},$scope.itemSearch={open:function(){$modal.open({templateUrl:"popupChooseItem",controller:function($scope,$modalInstance){$scope.itemSearchPanel={},$scope.itemSearchOption={api:"api/erm/v2/items/search",method:"post",scope:$scope.itemSearchPanel,columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"},{field:"TAX_ID",label:"Tax Id",is_hide:!0},{field:"TAX_CODE",label:"Tax Code"},{field:"TAX_RATE",label:"Tax Rate"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"}}},$scope.rowClick=function(item){$modalInstance.close({item:item})}},size:"md"}).result.then(function(data){var t_item=arrGetBy($scope.InvoiceMap.lines,"ITEM_ID",data.item.ITEM_ID);
if(!t_item){var newLine=data.item;newLine.HEADER_ID=$scope.InvoiceMap.header_id,newLine.QUANTITY=1,newLine.PRICE=0,newLine.has_price=!1,newLine.AMOUNT=0,newLine.TIME_SPENT=0,newLine.IS_ENABLE=1,newLine.invItem={ITEM_CODE:data.item.ITEM_CODE,ITEM_NAME:data.item.ITEM_NAME};var postData={ITEM_ID:newLine.ITEM_ID,FEE_TYPE_ID:$scope.InvoiceMap.FEE_TYPE_ID,CurrentDate:moment().format("YYYY-MM-DD hh:mm:ss")};InvoiceService.getfeetypefillter(postData).then(function(data){if("post-data-fail"==data.status)toastr.warning("Fee type no selected"),$scope.InvoiceMap.lines.push(newLine);else if("not-found"==data.status)toastr.warning("Price of item not found"),$scope.InvoiceMap.lines.push(newLine);else if("success"==data.status){var fee=data.data;newLine.FEE=fee.FEE,newLine.PRICE=fee.FEE,newLine.ITEM_FEE_ID=fee.ITEM_FEE_ID,newLine.has_price=!0,$scope.InvoiceMap.lines.push(newLine)}else toastr.error("Error when get price for item")})}})}}},link:function(scope,element,attrs){scope.showSave=!0,scope.statusDisable=!1,scope.claimShow=!0;var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&InvoiceService.headerDetail(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.InvoiceMap,response.data),ConfigService.autoConvertData(scope.InvoiceMap),response.data.feeGroup&&(scope.InvoiceMap.FEE_GROUP_TYPE=response.data.SOURCE_TYPE,scope.feeGroupTypeChange(scope.InvoiceMap.FEE_GROUP_TYPE),scope.InvoiceMap.FEE_GROUP_ID=response.data.feeGroup.FEE_GROUP_ID),response.data.feeType&&(scope.feeGroupChange(scope.InvoiceMap.FEE_GROUP_ID),scope.InvoiceMap.FEE_TYPE_ID=response.data.feeType.FEE_TYPE_ID),scope.InvoiceMap.patient.full_name=scope.InvoiceMap.patient.Title+". "+scope.InvoiceMap.patient.First_name+" "+scope.InvoiceMap.patient.Sur_name,scope.InvoiceMap.lines=scope.InvoiceMap.lines.filter(function(item){return 1==item.IS_ENABLE});for(var i=0,amount=0,len=scope.InvoiceMap.lines.length;len>i;++i){var line=scope.InvoiceMap.lines[i];amount+=line.AMOUNT}scope.InvoiceMap.AMOUNT=amount,"done"===scope.InvoiceMap.STATUS&&(scope.showSave=!1,scope.statusDisable=!0,scope.claimShow=!1),scope.patientClaim.Patient_id=scope.InvoiceMap.Patient_id,ConfigService.system_service_by_clinical(scope.InvoiceMap.doctor.CLINICAL_DEPT_ID).then(function(response){scope.opt_services=[{SERVICE_ID:"",SERVICE_NAME:"-- Choose Service --"}].concat(response)})}),scope.InvoiceMap=angular.copy(InvoiceHeaderModel)};init(),scope.clickAction=function(){if(scope.params.permission.edit===!0)if(scope.InvoiceMap.lines&&0!==scope.InvoiceMap.lines.length){if("done"===scope.InvoiceMap.STATUS){var r=confirm('You cannot change this invoice information once you change the status to "Done". \n Are you sure?');if(0==r)return}InvoiceService.save(scope.params.id,scope.InvoiceMap).then(function(response){"fail"==response.status?toastr.error("Cannot send to ERP","Error"):toastr.success("Edit Successfully !!!","Success"),init()})}else toastr.error("Missing header / lines","Error!");else InvoiceService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init()},scope.removeInvoiceLine=function(item){for(var index=-1,i=0;i<scope.InvoiceMap.lines.length;i++){var line=scope.InvoiceMap.lines[i];if(line.ITEM_ID==item.ITEM_ID){index=i;break}}scope.InvoiceMap.lines.splice(index,1)},scope.updateInvoiceLine=function(item){var postData={invoiceLine:item};InvoiceService.updateInvoiceLine(postData).then(function(data){"success"==data.status?(toastr.success("Update success.","Success"),item.notSave=!1):(exlog.logErr(data),toastr.error("Update error.","Error"))},function(err){exlog.logErr(err),toastr.error("Update error.","Error")})},scope.handleWhenLineChanged=function(item){item.notSave=!0;for(var amount=0,i=0;i<scope.InvoiceMap.lines.length;i++){var line=scope.InvoiceMap.lines[i];line.AMOUNT=line.QUANTITY*line.PRICE,amount+=line.AMOUNT}scope.InvoiceMap.AMOUNT=amount},scope.removeClaim=function(){var postData={claim_id:null};InvoiceService.update(scope.params.id,postData).then(function(response){"success"==response.status&&(toastr.success("Remove Claim Successfully !!!","Success"),scope.InvoiceMap.claim=null,scope.InvoiceMap.claim_id=null)})},scope.printReport=function(){window.open(getUrlReport()+"/redimedInvoice/"+scope.InvoiceMap.header_id)}}}}),angular.module("app.loggedIn.invoice.tnInvoiceDetail.directive",[]).directive("tnInvoiceDetail",function(){return{restrict:"E",scope:{invoiceHeaderId:"="},templateUrl:"modules/invoice/directives/templates/tnInvoiceDetail.html",controller:function($scope,ConsultationService,InvoiceService){$scope.apptPatient=null,$scope.invoiceHeader=null,$scope.invoiceListLines=null,InvoiceService.getInvoiceHeader($scope.invoiceHeaderId).then(function(data){if("success"==data.status){$scope.invoiceHeader=data.data;var postData={patientId:$scope.invoiceHeader.Patient_id,calId:$scope.invoiceHeader.cal_id};return ConsultationService.getApptPatient(postData)}exlog.logErr(data)},function(err){exlog.logErr(err)}).then(function(data){return"success"==data.status?($scope.apptPatient=data.data,InvoiceService.getInvoiceListLines($scope.invoiceHeaderId)):void exlog.logErr(data)},function(err){exlog.logErr(err)}).then(function(data){"success"==data.status?($scope.invoiceListLines=data.data,exlog.alert($scope.invoiceListLines)):exlog.logErr(data)},function(err){exlog.logErr(err)})}}}),angular.module("app.loggedIn.invoice.search.directive",[]).directive("invoiceSearch",function(InvoiceService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/invoice/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"cal_id",value:""},{type:"text",name:"claim_id",value:""},{type:"text",name:"Patient_id",value:""}],select:["cal_id","claim_id","Patient_id"]}},loadList=function(){InvoiceService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.invoice.add.directive",[]).directive("invoiceAdd",function($stateParams,$modal,PatientService,InvoiceHeaderModel,ConfigService,InvoiceService,ReceptionistService,toastr,$filter,$state,CompanyService){var arrGetBy=$filter("arrGetBy");return{restrict:"EA",scope:{options:"=",params:"=",patient:"=",calendar:"=",onsuccess:"="},templateUrl:"modules/invoice/directives/templates/add.html",controller:function($scope){var init=function(){$scope.isSubmit=!1,$scope.InvoiceMap=angular.copy(InvoiceHeaderModel),$scope.InvoiceMap.SITE_ID=1,$scope.InvoiceMap.STATUS="enter",$scope.InvoiceMap.lines=[]};init(),$scope.patient&&($scope.InvoiceMap.Patient_id=$scope.patient,PatientService.mdtById($scope.patient).then(function(data){"success"==data.status&&($scope.InvoiceMap.patient={full_name:data.data.First_name+" "+data.data.Middle_name+" "+data.data.Sur_name},data.company&&($scope.InvoiceMap.Company_id=data.data.company_id,$scope.InvoiceMap.company={Company_name:data.company.Company_name}))})),$scope.calendar&&($scope.InvoiceMap.cal_id=$scope.calendar),$scope.doctorSearch={open:function(){$modal.open({templateUrl:"popupDoctorSearch",controller:function($scope,$modalInstance,ConfigService){$scope.rowClick=function(item){ConfigService.system_service_by_clinical(item.CLINICAL_DEPT_ID).then(function(response){$modalInstance.close({item:item,response:response})})}},size:"md"}).result.then(function(data){$scope.InvoiceMap.DOCTOR_ID=data.item.doctor_id,$scope.InvoiceMap.DEPT_ID=data.item.CLINICAL_DEPT_ID,$scope.InvoiceMap.doctor={NAME:data.item.NAME},$scope.opt_services=[{SERVICE_ID:"",SERVICE_NAME:"-- Choose Service --"}].concat(data.response)})}},$scope.patientClaim={open:function(){$modal.open({templateUrl:"popupSelectClaim",controller:function($scope,$modalInstance,patient_id){$scope.patientClaimPanel={},$scope.options={api:"api/erm/v2/patients/claims",method:"post",scope:$scope.patientClaimPanel,columns:[{field:"Claim_id",is_hide:!0},{field:"Injury_name",label:"Injury"},{field:"Insurer"},{field:"insurer_id",is_hide:!0}],not_load:!1,search:{Patient_id:patient_id}},$scope.rowClick=function(item){$modalInstance.close({item:item})}},size:"md",resolve:{patient_id:function(){return $scope.patient}}}).result.then(function(data){$scope.InvoiceMap.claim=data.item,$scope.InvoiceMap.Insurer_id=data.item.insurer_id,$scope.InvoiceMap.claim_id=data.item.Claim_id,$scope.InvoiceMap.insurer={insurer_name:data.item.Insurer}})}},$scope.itemSearch={open:function(){$modal.open({templateUrl:"popupChooseItem",controller:function($scope,$modalInstance){$scope.itemSearchPanel={},$scope.itemSearchOption={api:"api/erm/v2/items/search",method:"post",scope:$scope.itemSearchPanel,columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"},{field:"TAX_ID",label:"Tax Id",is_hide:!0},{field:"TAX_CODE",label:"Tax Code"},{field:"TAX_RATE",label:"Tax Rate"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"}}},$scope.rowClick=function(item){$modalInstance.close({item:item})}},size:"md"}).result.then(function(data){var t_item=arrGetBy($scope.InvoiceMap.lines,"ITEM_ID",data.item.ITEM_ID);t_item||(data.item.ITEM_NAME=data.item.ITEM_NAME.substring(0,50),data.item.QUANTITY=1,data.item.TIME_SPENT=0,data.item.IS_ENABLE=1,$scope.InvoiceMap.lines.push(data.item),ReceptionistService.itemFeeAppt($scope.InvoiceMap.SERVICE_ID,[data.item.ITEM_ID]).then(function(response){response.list.length>0?(data.item.PRICE=response.list[0].SCHEDULE_FEE,data.item.has_price=!0):(data.item.PRICE=0,data.item.has_price=!1)}))})}},$scope.isHeaderOk=function(opt){for(var fields=[{field:"SERVICE_ID",label:"Service"},{field:"doctor",label:"Doctor"},{field:"patient",label:"Patient"}],i=fields.length-1;i>=0;i--){var f=fields[i];if(!$scope.InvoiceMap[f.field])return opt&&"alert"==opt&&toastr.error("Please choose `"+f.label+"`","Error"),!1}return!0},$scope.amountBill=function(){for(var amount=0,i=0,len=$scope.InvoiceMap.lines.length;len>i;++i){var line=$scope.InvoiceMap.lines[i];line.AMOUNT=line.PRICE*line.QUANTITY,amount+=line.AMOUNT}return Math.round(100*amount)/100}},link:function(scope,element,attrs){scope.removeInvoiceLine=function(item){scope.InvoiceMap.lines=_.remove(scope.InvoiceMap.lines,function(n){return n!=item})},scope.clickAction=function(){if(scope.isHeaderOk("alert")){var postData=angular.copy(scope.InvoiceMap);delete postData.doctor,delete postData.patient,delete postData.company;for(var insertArr=[],i=0;i<postData.lines.length;i++){var t={CLN_ITEM_ID:postData.lines[i].ITEM_ID,Patient_id:$stateParams.patient_id,cal_id:$stateParams.cal_id,PRICE:postData.lines[i].PRICE,TIME_SPENT:postData.lines[i].TIME_SPENT?postData.lines[i].TIME_SPENT:0,QUANTITY:postData.lines[i].QUANTITY,is_enable:1};insertArr.push(t)}InvoiceService.add(postData).then(function(response){"error"==response.status?toastr.error("Cannot Insert","Error"):"success"==response.status&&scope.onsuccess&&scope.onsuccess()})}}}}}),angular.module("app.loggedIn.invoice.addMaunalInvoice.directive",[]).directive("addmaunalInvoice",function($cookieStore,$stateParams,$modal,PatientService,InvoiceHeaderModel,ConfigService,InvoiceService,ReceptionistService,toastr,$filter,$state,CompanyService){return{restrict:"EA",scope:{options:"=",success:"=",checkedit:"=",headerdata:"=",patientid:"="},templateUrl:"modules/invoice/directives/templates/manualAdd.html",controller:function($scope){if($filter("arrGetBy"),$scope.user_id=$cookieStore.get("userInfo").id,$scope.modelObjectMap={FEE_GROUP_TYPE:null,FEE_GROUP_ID:null,FEE_TYPE_ID:null},$scope.patientTest=!1,$scope.FORMULACal=[],$scope.insurers,$scope.patientName,$scope.patient,$scope.claim,$scope.feeGroupType=invConst.feeGroupType,$scope.feeGroupID=[],$scope.feeTypes=[],$scope.FORMULA,$scope.ArrayLineRoot=[],$scope.ArrayInv_ITEM={ITEM_FEE_ID:"",FEE:""},$scope.InvoiceMap={lines:[]},$scope.patientid){$scope.patientTest=!0;var postDataPatient={Patient_id:$scope.patientid};InvoiceService.getpatientbyid(postDataPatient).then(function(response){$scope.patient=response.data[0],$scope.patientName=response.data[0].First_name+" "+response.data[0].Sur_name})}$scope.patientSearch={open:function(){$modal.open({templateUrl:"popupPatientSearch",controller:function($scope,$modalInstance,ConfigService,options){$scope.options=options,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.rowClick=function(item){$modalInstance.close(item)},$scope.patients={select:0,"class":function(patient){return{selected:patient.ID==$scope.patients.select}},options:{api:"api/erm/v2/patient/search",method:"post",columns:[{field:"Patient_id",is_hide:!0},{field:"First_name",label:"First name"},{field:"Sur_name",label:"Last name"},{field:"Address1",label:"Address"},{field:"Post_code",label:"Post Code"}],use_filters:!0,filters:{First_name:{type:"text"},Sur_name:{type:"text"},Address1:{type:"text"},Post_code:{type:"text"}}}},$scope.showAddPatient=function(){$modal.open({templateUrl:"popupAddPatient",controller:function($scope,$modalInstance,options){$scope.options=options,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.patientAddForm={params:{permission:{edit:!1,create:!0}},is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){}},$scope.actionCenter={runWhenFinish:function(data){$modalInstance.close({status:"success",data:data})}}},resolve:{options:function(){return $scope.options}},size:"lg"}).result.then(function(response){"success"==response.status&&$modalInstance.close(response.data)})}},size:"lg",resolve:{options:function(){return $scope.options}}}).result.then(function(data){$scope.patientName=data.First_name+" "+data.Sur_name,$scope.patient=data,$scope.modelObjectMap.FEE_GROUP_TYPE=null})}},$scope.insurerSearch={open:function(){$scope.claim=null,$modal.open({templateUrl:"popupInsurerSearch",controller:function($scope,$modalInstance,ConfigService){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.rowClick=function(item){$modalInstance.close(item)},$scope.insurer={select:0,"class":function(insurer){return{selected:insurer.ID==$scope.insurer.select}},options:{api:"api/erm/v2/insurers/search",method:"post",columns:[{field:"id",is_hide:!0},{field:"insurer_name",label:"Company Name"},{field:"address",label:"Address"},{field:"suburb",label:"Suburb"},{field:"isenable"},{field:"FEE_GROUP_ID",is_hide:!0}],use_filters:!0,filters:{insurer_name:{type:"text"},address:{type:"text"},suburb:{type:"text"},isenable:{type:"text"}}}}},size:"lg"}).result.then(function(data){$scope.insurers=data,$scope.feeGroupChange($scope.insurers.FEE_GROUP_ID)})}},$scope.claimSearch={open:function(){$modal.open({templateUrl:"popupClaimSearchInsurer",controller:function($scope,$modalInstance,ConfigService,ClaimModel,patientData,insurers){$scope.claim,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.onRowClick=function(item){$modalInstance.close(item)},$scope.load=function(){var postData={page:1,limit:10,offset:0,max_size:5,Claim_no:"",Claim_date:"desc",Injury_name:"",Injury_date:"asc",Patient_id:patientData.Patient_id,insurer_id:insurers.id};ClaimModel.listFollowPatientInsurer(postData).then(function(response){$scope.claim=response.data})},$scope.load(),$scope.showAddClaim=function(){$modal.open({templateUrl:"popupAddClaim",controller:function($scope,$modalInstance,insurers,patientData){$scope.claim={Patient_id:patientData.Patient_id,insurers:insurers,success:""},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.$watch("claim.success",function(response){response.Claim_id&&$modalInstance.close({status:"success",data:response})})},resolve:{patientData:function(){return patientData},insurers:function(){return insurers}},size:"lg"}).result.then(function(response){"success"==response.status&&$modalInstance.close(response.data)})}},size:"lg",resolve:{patientData:function(){return $scope.patient},insurers:function(){return $scope.insurers}}}).result.then(function(data){$scope.claim=data})}},$scope.feeGroupTypeChange=function(value){$scope.feeGroupChange(""),$scope.modelObjectMap.FEE_GROUP_TYPE=value,$scope.insurers=null,$scope.feeTypes=null,InvoiceService.getFeeGroupByType(value).then(function(response){$scope.feeGroupID=response.data})},$scope.feeGroupChange=function(value){$scope.feeTypeChange(""),$scope.InvoiceMap.lines=[],$scope.modelObjectMap.FEE_TYPE_ID=null,$scope.modelObjectMap.FEE_GROUP_ID=value;for(var i=0;i<$scope.feeGroupID.length;i++)value==$scope.feeGroupID[i].FEE_GROUP_ID&&($scope.FORMULA=$scope.feeGroupID[i].FORMULA?$scope.feeGroupID[i].FORMULA:"100");InvoiceService.getFeeType(value).then(function(response){$scope.feeTypeID=response.data})},$scope.feeTypeChange=function(value){$scope.InvoiceMap.lines=[]},$scope.itemSearch={open:function(){$modal.open({templateUrl:"popupChooseMaunalItem",controller:function($scope,$modalInstance,FEE_TYPE_ID,ItemService){var search={page:1,limit:7,offset:0,max_size:5,ITEM_CODE:"",ITEM_NAME:"",TAX_CODE:"",TAX_RATE:"",FEE_TYPE_ID:FEE_TYPE_ID},load=function(){$scope.ItemAll.loading=!0,ItemService.insertManualLine(search).then(function(response){$scope.ItemAll.list=response.data,$scope.ItemAll.count=response.count})};$scope.rowClick=function(item){$modalInstance.close({item:item})};var setPage=function(page){$scope.ItemAll.search.offset=(page-1)*$scope.ItemAll.search.limit,$scope.ItemAll.load()},onSearch=function(option){switch(option.field){case"ITEM_CODE":$scope.ItemAll.search.ITEM_CODE=option.value;break;case"ITEM_NAME":$scope.ItemAll.search.ITEM_NAME=option.value}$scope.ItemAll.load(),setPage(1)};$scope.ItemAll={search:search,count:0,loading:!1,list:[],load:function(){load()},setPage:function(page){setPage(page)},onSearch:function(option){onSearch(option)}},$scope.ItemAll.load(),$scope.clickOnRow=function(value){var postData={ITEM_ID:value.ITEM_ID,FEE_TYPE_ID:FEE_TYPE_ID,CurrentDate:moment().format("YYYY-MM-DD hh:mm:ss")};InvoiceService.getfeetypefillter(postData).then(function(response){$modalInstance.close(response.data)})}},size:"lg",resolve:{FEE_TYPE_ID:function(){return $scope.modelObjectMap.FEE_TYPE_ID}}}).result.then(function(data){function sortLine(a,b){return a.FEE<b.FEE?1:a.FEE>b.FEE?-1:0}var checkExit=0;for(key in $scope.InvoiceMap.lines)$scope.InvoiceMap.lines[key].ITEM_CODE==data.ITEM_CODE&&checkExit++;if($scope.FORMULACal=$scope.FORMULA.split(":"),0==checkExit){$scope.ArrayInv_ITEM.ITEM_FEE_ID=data.ITEM_FEE_ID,$scope.ArrayInv_ITEM.FEE=data.FEE,data.ITEM_NAME=data.ITEM_NAME.substring(0,50),data.QUANTITY=1,data.TIME_SPENT=0,data.IS_ENABLE=1,$scope.InvoiceMap.lines.push(data),$scope.InvoiceMap.lines.sort(sortLine);for(var i=0;i<$scope.InvoiceMap.lines.length;i++)$scope.FORMULACal[i]?($scope.InvoiceMap.lines[i].PRICE=$scope.InvoiceMap.lines[i].FEE*$scope.FORMULACal[i]/100,$scope.InvoiceMap.lines[i].Percent=$scope.FORMULACal[i]):($scope.InvoiceMap.lines[i].PRICE=$scope.InvoiceMap.lines[i].FEE*$scope.FORMULACal[$scope.FORMULACal.length-1]/100,$scope.InvoiceMap.lines[i].Percent=$scope.FORMULACal[$scope.FORMULACal.length-1])}})}},$scope.amountAll=function(){for(var amount=0,i=0,len=$scope.InvoiceMap.lines.length;len>i;++i){var line=$scope.InvoiceMap.lines[i];line.AMOUNT=line.PRICE*line.QUANTITY,amount+=line.AMOUNT}return Math.round(100*amount)/100},$scope.taxAmountAll=function(){for(var amount=0,i=0,len=$scope.InvoiceMap.lines.length;len>i;++i){var line=$scope.InvoiceMap.lines[i];line.AMOUNT=line.PRICE*line.QUANTITY*line.TAX_RATE,amount+=line.AMOUNT}return Math.round(100*amount)/100},$scope.totalAmount=function(){for(var amount=0,i=0,len=$scope.InvoiceMap.lines.length;len>i;++i){var line=$scope.InvoiceMap.lines[i];line.AMOUNT=line.PRICE*line.QUANTITY*line.TAX_RATE+line.PRICE*line.QUANTITY,amount+=line.AMOUNT}return Math.round(100*amount)/100},$scope.save=function(){$scope.isSubmit=!0,$scope.mainForm.$invalid||(postData="private_fund"==$scope.modelObjectMap.FEE_GROUP_TYPE?{Patient_id:$scope.patient.Patient_id,SOURCE_TYPE:$scope.modelObjectMap.FEE_GROUP_TYPE,SOURCE_ID:$scope.insurers.FEE_GROUP_ID,FEE_TYPE:$scope.modelObjectMap.FEE_TYPE_ID,FORMULA:$scope.FORMULA,Insurer_id:$scope.insurers.id,listLines:$scope.InvoiceMap.lines,claim_id:$scope.claim.Claim_id}:{Patient_id:$scope.patient.Patient_id,SOURCE_TYPE:$scope.modelObjectMap.FEE_GROUP_TYPE,SOURCE_ID:$scope.modelObjectMap.FEE_GROUP_ID,FEE_TYPE:$scope.modelObjectMap.FEE_TYPE_ID,FORMULA:$scope.FORMULA,listLines:$scope.InvoiceMap.lines},$scope.checkedit!==!0?(postData.CREATION_DATE=moment().format("YYYY-MM-DD HH:mm:ss"),postData.LAST_UPDATE_DATE=moment().format("YYYY-MM-DD HH:mm:ss"),postData.STATUS="enter",postData.user_id=$scope.user_id,InvoiceService.getSaveManual(postData).then(function(response){$scope.success=!0})):(postData.header_id=$scope.headerdata.header_id,postData.LAST_UPDATE_DATE=moment().format("YYYY-MM-DD HH:mm:ss"),postData.STATUS="enter",postData.user_id=$scope.user_id,InvoiceService.getEditManual(postData).then(function(response){toastr.success("Edit Manual Invoice Success !"),$scope.success=!0})))},$scope.removeInvoiceLine=function(item){for(var i=0;i<$scope.InvoiceMap.lines.length;i++)$scope.InvoiceMap.lines[i].ITEM_ID==item.ITEM_ID&&$scope.InvoiceMap.lines.splice(i,1)},$scope.resetEdit=function(){var postData={header_id:$scope.headerdata.header_id};InvoiceService.getOnemanual(postData).then(function(response){function sortLine(a,b){return a.FEE<b.FEE?1:a.FEE>b.FEE?-1:0}$scope.patientName=response.data[0].First_name+""+response.data[0].Sur_name,$scope.patient={Patient_id:response.data[0].Patient_id},$scope.feeGroupType=invConst.feeGroupType,$scope.feeGroupTypeChange(response.data[0].SOURCE_TYPE),$scope.feeGroupChange(response.data[0].groupFEE_GROUP_ID),$scope.modelObjectMap.FEE_TYPE_ID=response.data[0].typesFEE_TYPE_ID,$scope.InvoiceMap.lines=response.dataline,$scope.FORMULA=response.data[0].FORMULA?response.data[0].FORMULA:"100",$scope.FORMULACal=response.data[0].FORMULA.split(":"),$scope.InvoiceMap.lines.sort(sortLine);for(var i=0;i<$scope.InvoiceMap.lines.length;i++)$scope.InvoiceMap.lines[i].Percent=$scope.FORMULACal[i]?$scope.FORMULACal[i]:$scope.FORMULACal[$scope.FORMULACal.length-1];for(var i=0;i<$scope.InvoiceMap.lines.length;i++)$scope.InvoiceMap.lines[i].ITEM_NAME=$scope.InvoiceMap.lines[i].ITEM_NAME.substring(0,50);$scope.insurers={insurer_name:response.data[0].insurer_name,id:response.data[0].Insurer_id},$scope.claim={Claim_no:response.data[0].Claim_no}})},1==$scope.checkedit&&$scope.resetEdit(),$scope.printReport=function(){window.open(getUrlReport()+"/redimedInvoice/"+$scope.headerdata.header_id)}}}}),angular.module("app.loggedIn.iso",["app.loggedIn.iso.controller","app.loggedIn.iso.main.controller","app.loggedIn.iso.service","app.loggedIn.iso.directive","app.loggedIn.iso.selectionUserName.directive","app.loggedIn.iso.selectionGroupUser.directive","app.loggedIn.iso.grantUserPermission.directive","app.loggedIn.isoSubmitStatusPendingController.controller","app.loggedIn.iso.userGroup.controller","app.loggedIn.iso.isoApproverListController.controller","app.loggedIn.iso.isoAdminController.controller","app.loggedIn.isoHierarchyApprovalController.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.iso",{url:"/iso",templateUrl:"modules/iso/views/iso.html",controller:"isoController"}).state("loggedIn.iso.main",{url:"/main",templateUrl:"modules/iso/views/isoMain.html",controller:"isoMainController"}).state("loggedIn.iso.isoSubmitStatusPending",{url:"/isoSubmitStatusPending",templateUrl:"modules/iso/views/isoSubmitStatusPending.html",controller:"isoSubmitStatusPendingController"}).state("loggedIn.iso.userGroup",{url:"/user-group",templateUrl:"modules/iso/views/isoUserGroup.html",controller:"isoUserGroupController"}).state("loggedIn.iso.isoApproverList",{url:"/approver-list",templateUrl:"modules/iso/views/isoApproverList.html",controller:"isoApproverListController"}).state("loggedIn.iso.isoAdminList",{url:"/isoAdminList",templateUrl:"modules/iso/views/isoAdminList.html",controller:"isoAdminController"}).state("loggedIn.iso.isoHierarchyApproval",{url:"/hierarchy-approval",templateUrl:"modules/iso/views/isoHierarchyApproval.html",controller:"isoHierarchyApprovalController"})}),angular.module("app.loggedIn.iso.controller",[]).controller("isoController",function($scope,isoService){$scope.permissionFunction=isoConst.permissionFunction,$scope.isoAdminFunction=isoConst.isoAdminFunction,isoTest&&($scope.permissionFunction[1]=angular.copy($scope.permissionFunction[0]),$scope.permissionFunction[2]=angular.copy($scope.permissionFunction[0]),$scope.permissionFunction[3]=angular.copy($scope.permissionFunction[0]),$scope.permissionFunction[4]=angular.copy($scope.permissionFunction[0])),$scope.checkInStatus=isoConst.checkInStatus,$scope.submitStatus=isoConst.submitStatus,$scope.isoPermission=isoConst.isoPermission,$scope.requestEditStatus=isoConst.requestEditStatus,$scope.isIsoAdminSystem=0,isoService.isoAdmin.checkIsAdminIsoSystem().then(function(data){$scope.isIsoAdminSystem="success"==data.status?1:0},function(err){$scope.isIsoAdminSystem=0}),$scope.isIsoAdminSystemMaster=0,isoService.isoAdmin.checkIsAdminIsoSystemMaster().then(function(data){$scope.isIsoAdminSystemMaster="success"==data.status?1:0},function(err){$scope.isIsoAdminSystemMaster=0}),$scope.isIsoApprover=0,isoService.isoApprover.checkIsIsoApprover().then(function(data){$scope.isIsoApprover="success"==data.status?1:0},function(err){$scope.isIsoApprover=0}),$scope.departmentList=[],isoService.core.getDepartmentList().then(function(data){$scope.departmentList="success"==data.status?data.data:[]},function(err){$scope.departmentList=[]}),$scope.documentTypeList=isoConst.documentTypeList}),angular.module("app.loggedIn.iso.main.controller",[]).controller("isoMainController",function($scope,$http,$state,$window,$cookieStore,FileUploader,toastr,isoService){$scope.testHierarchy=function(){var approvalInfo={userApprovalId:7,hierarchyHeaderId:199,hierarchyLineId:379,hierarchyNodeId:24,sourceLineId:69,status:"approved",isoNodeId:112};isoService.hierarchyApproval.approval(approvalInfo).then(function(data){exlog.alert(data)},function(err){})},$scope.userInfo=$cookieStore.get("userInfo"),$scope.nodeType=isoConst.nodeType;var msgPopup=isoMsg.popup;$scope.tempData={},$scope.tempData[-1]={},$scope.treeData={},$scope.isIsoAdminSystem=0,$scope.getTreeDir=function(){isoService.treeDir.getTreeDir($scope.userInfo.id,$scope.isIsoAdminSystem).then(function(data){if("success"==data.status){for(var i=0;i<data.data.length;i++)$scope.tempData[data.data[i].NODE_ID]=data.data[i];for(var i=data.data.length-1;i>=0;i--)console.log(">>>>>>>>>>>node_id:"+data.data[i].NODE_ID+">>>father:"+data.data[i].FATHER_NODE_ID),-1==data.data[i].FATHER_NODE_ID?$scope.tempData[data.data[i].FATHER_NODE_ID].relativePath="":$scope.tempData[data.data[i].FATHER_NODE_ID]&&($scope.tempData[data.data[i].FATHER_NODE_ID].relativePath||($scope.tempData[data.data[i].FATHER_NODE_ID].relativePath="\\"+$scope.tempData[data.data[i].FATHER_NODE_ID].NODE_NAME)),$scope.tempData[data.data[i].FATHER_NODE_ID]&&($scope.tempData[data.data[i].NODE_ID].relativePath=$scope.tempData[data.data[i].FATHER_NODE_ID].relativePath+"\\"+$scope.tempData[data.data[i].NODE_ID].NODE_NAME),$scope.tempData[data.data[i].FATHER_NODE_ID]&&$scope.tempData[data.data[i].NODE_ID].ACCESSIBLE_USER_ID!=$scope.userInfo.id&&isoNode.inheritPermission($scope.tempData[data.data[i].NODE_ID],$scope.tempData[data.data[i].FATHER_NODE_ID]);for(var i=0;i<data.data.length;i++)$scope.tempData[data.data[i].FATHER_NODE_ID]&&($scope.tempData[data.data[i].FATHER_NODE_ID].nodes||($scope.tempData[data.data[i].FATHER_NODE_ID].nodes={}),$scope.tempData[data.data[i].FATHER_NODE_ID].nodes[data.data[i].NODE_ID]=angular.copy(data.data[i]));$scope.treeData=$scope.tempData[-1].nodes}},function(err){})},isoService.isoAdmin.checkIsAdminIsoSystem().then(function(data){$scope.isIsoAdminSystem="success"==data.status?1:0},function(err){$scope.isIsoAdminSystem=0}).then(function(){$scope.getTreeDir()}),$scope.treeActions={createFolder:{name:"createFolder",url:"iso_create_folder_template.html",header:"Create Folder"},createDocument:{name:"createDocument",url:"iso_create_document_template.html",header:"Create Document"},grantNodePermission:{name:"grantNodePermission",url:"iso_grant_node_permission.html",header:"Grant Node Permission"},checkInDocument:{name:"checkInDocument",url:"iso_check_in_document.html",header:"Check In Document"},getFullVersionDocument:{name:"getFullVersionDocument",url:"iso_get_full_version_document.html",header:"Version Control",sizeLarge:!0},getFullCheckinDocument:{name:"getFullCheckinDocument",url:"iso_get_full_checkin_document.html",header:"Check In History",sizeLarge:!0},requestEditDocument:{name:"requestEditDocument",url:"iso_request_edit_document.html",header:"Request to Edit Document"},viewYourRequest:{name:"viewYourRequest",url:"iso_view_your_request.html",header:"Your Requests"},viewAllRequest:{name:"viewAllRequest",url:"iso_view_all_request.html",header:"All Requests"},forceCheckInDocument:{name:"forceCheckInDocument",url:"iso_force_check_in_document.html",header:"Force Check In Document"},createNewCheckInDocument:{name:"createNewCheckInDocument",url:"iso_create_new_check_in_document.html",header:"Create New Check In Document (skip Check Out)"},renameNode:{name:"renameNode",url:"iso_rename_node_template.html",header:"Rename"}},$scope.currentTreeAction={},$scope.selectedTreeNode={},$scope.showTreeActionsMenuPopup=function(node){angular.element("#document").fadeOut(),$scope.selectedTreeNode=node,console.log($scope.selectedTreeNode.PERMISSION),$scope.newFolder=angular.copy($scope.newFolderBlank),$scope.newDocument=angular.copy($scope.newDocumentBlank),$scope.newRequestEditDocument=angular.copy($scope.newRequestEditDocumentBlank),$("#iso-tree-actions-menu-popup").modal({show:!0,backdrop:"static"})},$scope.newFolderBlank={fatherNodeId:"",nodeType:$scope.nodeType.folder,nodeName:"",description:"",createdBy:$scope.userInfo.id,relativePath:""},$scope.newDocumentBlank={fatherNodeId:"",nodeType:$scope.nodeType.document,nodeName:"",docCode:"",description:"",createdBy:$scope.userInfo.id,relativePath:""},$scope.newRequestEditDocumentBlank={description:""},$scope.resetFlag=0,$scope.showTreeActionContentPopup=function(treeAction){switch(treeAction){case $scope.treeActions.createFolder.name:$scope.currentTreeAction=$scope.treeActions.createFolder,angular.element(".form-group").removeClass("has-success"),angular.element(".form-group").removeClass("has-error");break;case $scope.treeActions.createDocument.name:$scope.currentTreeAction=$scope.treeActions.createDocument,angular.element(".form-group").removeClass("has-success"),angular.element(".form-group").removeClass("has-error");break;case $scope.treeActions.grantNodePermission.name:$scope.currentTreeAction=$scope.treeActions.grantNodePermission,$scope.resetFlag=$scope.resetFlag+1;break;case $scope.treeActions.checkInDocument.name:$scope.currentTreeAction=$scope.treeActions.checkInDocument;break;case $scope.treeActions.getFullVersionDocument.name:$scope.currentTreeAction=$scope.treeActions.getFullVersionDocument,$scope.getFullVersionDoccument();break;case $scope.treeActions.getFullCheckinDocument.name:$scope.currentTreeAction=$scope.treeActions.getFullCheckinDocument,$scope.getFullCheckinDocument();break;case $scope.treeActions.requestEditDocument.name:$scope.currentTreeAction=$scope.treeActions.requestEditDocument;break;case $scope.treeActions.viewYourRequest.name:$scope.currentTreeAction=$scope.treeActions.viewYourRequest,$scope.selectedYourRequest.DESCRIPTION=null,
$scope.getAllYourRequest($scope.selectedTreeNode.NODE_ID),console.log($scope.selectedTreeNode.NODE_ID);break;case $scope.treeActions.viewAllRequest.name:$scope.currentTreeAction=$scope.treeActions.viewAllRequest,$scope.selectedRequest.DESCRIPTION=null,$scope.getAllRequest($scope.selectedTreeNode.NODE_ID),console.log($scope.selectedTreeNode.NODE_ID);break;case $scope.treeActions.forceCheckInDocument.name:$scope.currentTreeAction=$scope.treeActions.forceCheckInDocument;break;case $scope.treeActions.createNewCheckInDocument.name:$scope.currentTreeAction=$scope.treeActions.createNewCheckInDocument;break;case $scope.treeActions.renameNode.name:$scope.currentTreeAction=$scope.treeActions.renameNode,$scope.newName={value:$scope.selectedTreeNode.NODE_NAME}}$("#iso-tree-actions-menu-popup").modal("hide"),$("#iso-tree-action-content-popup").modal({show:!0,backdrop:"static"})},$scope.newFolderBackErrorTemplate={name:""},$scope.beforeCreateFolder=function(){$scope.$broadcast("show-errors-check-validity"),$scope.actionContentForm.$valid&&null!=$scope.newFolder.nodeName&&""!=$scope.newFolder.nodeName&&($scope.newFolder.fatherNodeId=$scope.selectedTreeNode.NODE_ID,$scope.newFolder.relativePath=$scope.selectedTreeNode.relativePath+"\\"+$scope.newFolder.nodeName,$scope.newFolder.departmentId=null==$scope.selectedTreeNode.DEPARTMENT_ID?$scope.newFolder.department.DEPARTMENT_ID:$scope.selectedTreeNode.DEPARTMENT_ID,$scope.newFolderBackError=angular.copy($scope.newFolderBackErrorTemplate),isoService.treeDir.checkDupEntry($scope.newFolder.fatherNodeId,$scope.newFolder.nodeName).then(function(data){"success"==data.status&&(data.data.isDup?data.data.counts.NAME&&($scope.newFolderBackError.name="Name has been used!"):$scope.createFolder())}))},$scope.createFolder=function(){isoService.treeDir.createFolder($scope.selectedTreeNode.NODE_ID,$scope.newFolder).then(function(data){"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,isoLang.createFolderSuccess),$scope.selectedTreeNode.nodes||($scope.selectedTreeNode.nodes={}),$scope.selectedTreeNode.nodes[data.data.NODE_ID]=angular.copy(data.data),null==$scope.selectedTreeNode.DEPARTMENT_ID?($scope.selectedTreeNode.nodes[data.data.NODE_ID].DEPARTMENT_ID=$scope.newFolder.department.DEPARTMENT_ID,$scope.selectedTreeNode.nodes[data.data.NODE_ID].DEPARTMENT_NAME=$scope.newFolder.department.DEPARTMENT_NAME):($scope.selectedTreeNode.nodes[data.data.NODE_ID].DEPARTMENT_ID=$scope.selectedTreeNode.DEPARTMENT_ID,$scope.selectedTreeNode.nodes[data.data.NODE_ID].DEPARTMENT_NAME=$scope.selectedTreeNode.DEPARTMENT_NAME),$scope.selectedTreeNode.nodes[data.data.NODE_ID].relativePath=$scope.selectedTreeNode.relativePath+"\\"+$scope.selectedTreeNode.nodes[data.data.NODE_ID].NODE_NAME,data.data.ACCESSIBLE_USER_ID||isoNode.inheritPermission($scope.selectedTreeNode.nodes[data.data.NODE_ID],$scope.selectedTreeNode)):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,isoLang.createFolderError),$("#iso-tree-action-content-popup").modal("hide")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,isoLang.createFolderError)})},$scope.newDocumentBackErrorTemplate={name:"",docCode:""},$scope.beforeCreateDocument=function(){$scope.$broadcast("show-errors-check-validity"),$scope.actionContentForm.$valid&&null!=$scope.newDocument.nodeName&&""!=$scope.newDocument.nodeName&&($scope.newDocument.nodeId=$scope.selectedTreeNode.NODE_ID,$scope.newDocument.fatherNodeId=$scope.selectedTreeNode.NODE_ID,$scope.newDocument.relativePath=$scope.selectedTreeNode.relativePath+"\\"+$scope.newDocument.nodeName,$scope.newDocument.departmentId=null==$scope.selectedTreeNode.DEPARTMENT_ID?$scope.newDocument.department.DEPARTMENT_ID:$scope.selectedTreeNode.DEPARTMENT_ID,$scope.newDocument.documentTypeValue=$scope.newDocument.documentType.value,$scope.newDocumentBackError=angular.copy($scope.newDocumentBackErrorTemplate),isoService.treeDir.checkDupEntry($scope.newDocument.fatherNodeId,$scope.newDocument.nodeName,$scope.newDocument.docCode).then(function(data){"success"==data.status&&(data.data.isDup?(data.data.counts.NAME&&($scope.newDocumentBackError.name="Name has been used!"),data.data.counts.CODE&&($scope.newDocumentBackError.docCode="Document Code has been used!")):$scope.createDocument())}))},$scope.createDocument=function(){uploader.queue[0]?(uploader.queue[0].formData[0]={},uploader.queue[0].formData[0]=$scope.newDocument,uploader.uploadAll()):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,isoLang.pleaseSelectFile)};var uploader=$scope.uploader=new FileUploader({url:"/api/iso/iso-tree-dir/create-document-with-file"});uploader.filters.push({name:"customFilter",fn:function(item,options){return this.queue.length<10}}),uploader.onWhenAddingFileFailed=function(item,filter,options){console.info("onWhenAddingFileFailed",item,filter,options)},uploader.onAfterAddingFile=function(fileItem){uploader.queue.splice(0,uploader.queue.length-1),console.info("onAfterAddingFile",fileItem)},uploader.onAfterAddingAll=function(addedFileItems){console.info("onAfterAddingAll",addedFileItems)},uploader.onBeforeUploadItem=function(item){console.info("onBeforeUploadItem",item)},uploader.onProgressItem=function(fileItem,progress){console.info("onProgressItem",fileItem,progress)},uploader.onProgressAll=function(progress){console.info("onProgressAll",progress)},uploader.onSuccessItem=function(fileItem,response,status,headers){console.info("onSuccessItem",fileItem,response,status,headers)},uploader.onErrorItem=function(fileItem,response,status,headers){console.info("onErrorItem",fileItem,response,status,headers)},uploader.onCancelItem=function(fileItem,response,status,headers){console.info("onCancelItem",fileItem,response,status,headers)},uploader.onCompleteItem=function(fileItem,response,status,headers){$("#iso-tree-action-content-popup").modal("hide"),response.status&&("success"==response.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,isoLang.createDocumentSuccess),$scope.selectedTreeNode.nodes||($scope.selectedTreeNode.nodes={}),$scope.selectedTreeNode.nodes[response.data.NODE_ID]=angular.copy(response.data),null==$scope.selectedTreeNode.DEPARTMENT_ID?($scope.selectedTreeNode.nodes[response.data.NODE_ID].DEPARTMENT_ID=$scope.newDocument.department.DEPARTMENT_ID,$scope.selectedTreeNode.nodes[response.data.NODE_ID].DEPARTMENT_NAME=$scope.newDocument.department.DEPARTMENT_NAME):($scope.selectedTreeNode.nodes[response.data.NODE_ID].DEPARTMENT_ID=$scope.selectedTreeNode.DEPARTMENT_ID,$scope.selectedTreeNode.nodes[response.data.NODE_ID].DEPARTMENT_NAME=$scope.selectedTreeNode.DEPARTMENT_NAME),$scope.selectedTreeNode.nodes[response.data.NODE_ID].relativePath=$scope.selectedTreeNode.relativePath+"\\"+$scope.selectedTreeNode.nodes[response.data.NODE_ID].NODE_NAME):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,isoLang.createDocumentError)),uploader.queue.splice(0),console.info("onCompleteItem",fileItem,response,status,headers)},uploader.onCompleteAll=function(){console.info("onCompleteAll")},console.info("uploader",uploader),$scope.checkOutDocument=function(){isoService.checkOutIn.checkOutDocument($scope.selectedTreeNode.NODE_ID,$scope.selectedTreeNode.relativePath).then(function(data){$("#iso-tree-actions-menu-popup").modal("hide"),"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Check out success, document has locked"),$window.location.href="/api/iso/iso-check-out-in/download-check-out-document?nodeId="+$scope.selectedTreeNode.NODE_ID+"&relativePath="+$scope.selectedTreeNode.relativePath,$scope.selectedTreeNode.CHECK_IN_STATUS=data.data.CHECK_IN_STATUS,$scope.selectedTreeNode.CHECK_IN_NO=data.data.CHECK_IN_NO):"lock"==data.status?msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Document is locked"):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Check out fail!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Check out fail!")})},$scope.beforeCheckIn=function(){isoService.checkOutIn.canCheckInDocument($scope.selectedTreeNode.NODE_ID).then(function(data){"success"==data.status?"1"==data.info?$scope.showTreeActionContentPopup($scope.treeActions.checkInDocument.name):"0"==data.info?msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Cannot check in because not check out"):"2"==data.info?msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"You cannot check in"):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error"):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error")},function(err){})},$scope.SubmitDocument=function(){isoService.hierarchyApproval.addHierarchyApprovalHeader($scope.selectedTreeNode.NODE_ID).then(function(data){"success"==data.status?(msgPopup("Submit Document",isoConst.msgPopupType.success,"Submit Document Success"),$scope.selectedTreeNode.SUBMIT_STATUS=isoConst.submitStatus.pending,$scope.selectedTreeNode.CHECK_IN_STATUS=isoConst.checkInStatus.lock):msgPopup("Submit Document",isoConst.msgPopupType.error,"Submit Document Error")},function(err){msgPopup("Submit Document",isoConst.msgPopupType.error,"Submit Document Error")})},$scope.cancelSubmitDocument=function(){isoService.checkOutIn.cancelSubmitDocument($scope.selectedTreeNode.NODE_ID).then(function(data){"success"==data.status?(msgPopup("Cancel Submit Document",isoConst.msgPopupType.success,"Cancel submit document success!"),$scope.selectedTreeNode.SUBMIT_STATUS=data.data.SUBMIT_STATUS,$scope.selectedTreeNode.CHECK_IN_STATUS=data.data.CHECK_IN_STATUS):msgPopup("Cancel Submit Document",isoConst.msgPopupType.error,"Cancel Submit Document Error")},function(err){msgPopup("Cancel Submit Document",isoConst.msgPopupType.error,"Cancel Submit Document Error")})},$scope.grantNodePermissionItem=function(nodeId,accessibleUserId,permission){isoService.treeUser.grantNodePermission(nodeId,accessibleUserId,permission).then(function(data){"success"==data.status?(alert("dung roi"),item.STATUS=data.status):(alert("sai roi"),item.STATUS=data.status)},function(err){item.STATUS="error"})},$scope.checkCanPermission=function(nodeId,userGrant,userIsGranted,permission){isoService.treeUser.checkCanPermission(nodeId,userGrant,userIsGranted,permission).then(function(data){},function(err){})},$scope.downloadNewestVersionDocument=function(){isoService.checkOutIn.downloadNewestVersionDocument($scope.selectedTreeNode.NODE_ID).then(function(){})},$scope.deleteNode=function(){isoService.treeDir.deleteNode($scope.selectedTreeNode.NODE_ID).then(function(data){if("success"==data.status){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Delete success!");var deletex=function(node){node.ISENABLE=0,node.nodes&&angular.forEach(node.nodes,function(value,key){deletex(value)})};deletex($scope.selectedTreeNode),$scope.getTreeDir()}else msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Cannot delete!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Cannot delete!")}).then(function(){$("#iso-tree-actions-menu-popup").modal("hide")})},$scope.restoreNode=function(){isoService.treeDir.restoreNode($scope.selectedTreeNode.NODE_ID).then(function(data){if("success"==data.status){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Restore success!");var restore=function(node){node.ISENABLE=1,node.nodes&&angular.forEach(node.nodes,function(value,key){restore(value)})};restore($scope.selectedTreeNode)}else msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Cannot restore!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Cannot restore!")}).then(function(){$("#iso-tree-actions-menu-popup").modal("hide")})},$scope.downloadFolderSelected=function(){var listNode=[],dequy=function(node){var item={NODE_ID:node.NODE_ID,relativePath:node.relativePath,NODE_TYPE:node.NODE_TYPE,NODE_NAME:node.NODE_NAME};listNode.push(item),node.nodes&&angular.forEach(node.nodes,function(values){dequy(values)})};dequy($scope.selectedTreeNode),console.log(listNode),isoService.treeDir.handlingCloneFolder($scope.selectedTreeNode.NODE_ID,listNode).then(function(data){"success"==data.status?isoService.treeDir.cloneFolder($scope.selectedTreeNode.NODE_ID,data.data.downloadPackName):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Download folder fail!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Download folder fail!")})},$scope.fullVersionDocumentData={},$scope.getFullVersionDoccument=function(){isoService.treeDir.getFullVersionDoccument($scope.selectedTreeNode.NODE_ID).then(function(data){"success"==data.status&&(console.log(data),$scope.fullVersionDocumentData=data.data)})},$scope.downloadVersionNo=function(FILE_NAME,CHECK_IN_FOLDER_STORAGE,NODE_ID){isoService.treeDir.handlingDownloadVersionDocument(FILE_NAME,CHECK_IN_FOLDER_STORAGE,NODE_ID)},$scope.fullCheckinDocumentData={},$scope.getFullCheckinDocument=function(){isoService.treeDir.getFullCheckinDoccument($scope.selectedTreeNode.NODE_ID).then(function(data){"success"==data.status&&(console.log(data),$scope.fullCheckinDocumentData=data.data)})},$scope.showDocumentInfo=function(Type,documentID){$scope.documentInfo=null,Type==$scope.nodeType.document?(console.log(Type),console.log(documentID),isoService.treeDir.selectDocument(documentID).then(function(data){"success"==data.status&&(console.log(data.data),data.data.Lasted_Edited_On=null!=data.data.LAST_UPDATED_DATE?moment(data.data.LAST_UPDATED_DATE).format("l"):null,$scope.documentInfo=data.data)}),angular.element("#document").fadeIn()):angular.element("#document").fadeOut()},$scope.closeDocument=function(){angular.element("#document").fadeOut()},$scope.sendRequestEditDocument=function(){$scope.newRequestEditDocument.nodeId=$scope.selectedTreeNode.NODE_ID,isoService.treeDir.sendRequestEditDocument($scope.newRequestEditDocument).then(function(data){"success"==data.status?msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Send request success!"):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Send request fail!"),$("#iso-tree-action-content-popup").modal("hide")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Send request fail!")})},$scope.listYourRequest=[],$scope.getAllYourRequest=function(nodeId){isoService.requestEdit.getAllRequestOfUserLogin(nodeId).then(function(data){$scope.listYourRequest="success"==data.status?data.data:[]},function(err){$scope.listYourRequest=[]})},$scope.selectedYourRequest={},$scope.setSelectedYourRequest=function(item){$scope.selectedYourRequest=item,isoService.replyEdit.updateAdminReply(item.ID,0).then(function(data){"success"==data.status&&(console.log($scope.selectedTreeNode.NODE_ID),$scope.selectedYourRequest.HAVE_NEW_ADMIN_REPLY=0,$scope.getNumberAdminReplyOfRequest(item.NODE_ID))})},$scope.cancelYourRequest=function(id){isoService.requestEdit.cancelRequest(id).then(function(data){"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Cancel request success!"),$scope.getAllYourRequest($scope.selectedTreeNode.NODE_ID)):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Cancel request fail!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Cancel request fail!")})},$scope.listAllRequest=[],$scope.getAllRequest=function(nodeId){isoService.requestEdit.getAllRequest(nodeId).then(function(data){"success"==data.status?($scope.listAllRequest=data.data,console.log($scope.listAllRequest)):$scope.listAllRequest=[]},function(err){$scope.listAllRequest=[]})},$scope.selectedRequest={},$scope.setSelectedRequest=function(item){$scope.selectedRequest=item,console.log($scope.selectedRequest),isoService.replyEdit.updateStaffReply(item.ID,0).then(function(data){"success"==data.status&&(console.log(item),$scope.selectedRequest.HAVE_NEW_STAFF_REPLY=0,$scope.getNumberStaffReplyOfRequest(item.NODE_ID))})},$scope.getNumberOfRequestUnread=function(nodeId){isoService.requestEdit.getNumberOfRequestUnread(nodeId).then(function(data){"success"==data.status&&($scope.selectedTreeNode.NUM_OF_REQUEST=data.data>0?data.data:null)},function(err){})},$scope.getNumberStaffReplyOfRequest=function(nodeId){isoService.replyEdit.getNumberStaffReplyOfRequest(nodeId).then(function(data){"success"==data.status&&(console.log(data.data),$scope.selectedTreeNode.NUM_STAFF_REPLY_OF_REQUEST=data.data.NUM_STAFF_REPLY_OF_REQUEST>0?data.data.NUM_STAFF_REPLY_OF_REQUEST:0)},function(err){})},$scope.getNumberAdminReplyOfRequest=function(nodeId){isoService.replyEdit.getNumberAdminReplyOfRequest(nodeId).then(function(data){"success"==data.status&&(console.log(data.data),$scope.selectedTreeNode.NUM_ADMIN_REPLY_OF_REQUEST=data.data.NUM_ADMIN_REPLY_OF_REQUEST>0?data.data.NUM_ADMIN_REPLY_OF_REQUEST:0)},function(err){})},$scope.setRequestIsRead=function(item){isoService.requestEdit.setRequestIsRead(item.ID).then(function(data){"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Update success!"),$scope.getNumberOfRequestUnread(item.NODE_ID),item.IS_READ=1):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Update fail!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Update fail!")})},$scope.setRequestStar=function(item){var star=1==item.STAR?0:1;isoService.requestEdit.setRequestStar(item.ID,star).then(function(data){"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Update success!"),item.STAR=star,$scope.getNumberOfRequestUnread(item.NODE_ID)):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Update fail!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Update fail!")})},$scope.releaseDocumentOneClick=function(){isoService.checkOutIn.submitDocument($scope.selectedTreeNode.NODE_ID).then(function(data){if("success"==data.status){var checkOutInId=data.data.checkOutInId;isoService.checkOutIn.approvedDocument($scope.selectedTreeNode.NODE_ID,checkOutInId).then(function(data){"success"==data.status?(msgPopup("Release",isoConst.msgPopupType.success,"Release Document Success"),$scope.selectedTreeNode.SUBMIT_STATUS=data.data.SUBMIT_STATUS,$scope.selectedTreeNode.CHECK_IN_STATUS=data.data.CHECK_IN_STATUS,$scope.selectedTreeNode.CURRENT_VERSION_ID=data.data.CURRENT_VERSION_ID,isoService.checkOutIn.sendEmailNotificationNewDocumentVersion($scope.selectedTreeNode.NODE_ID).then(function(data){},function(err){})):msgPopup("Release",isoConst.msgPopupType.error,"Release Error")},function(err){msgPopup("Release",isoConst.msgPopupType.error,"Release Error")})}else msgPopup("Release",isoConst.msgPopupType.error,"Release Document Error")},function(err){msgPopup("Release",isoConst.msgPopupType.error,"Release Document Error")})},$scope.forceReleaseDocumentOneClick=function(){isoService.checkOutIn.forceSubmitDocument($scope.selectedTreeNode.NODE_ID).then(function(data){if("success"==data.status){var checkOutInId=data.data.checkOutInId;isoService.checkOutIn.forceApprovedDocument($scope.selectedTreeNode.NODE_ID,checkOutInId).then(function(data){"success"==data.status?(msgPopup("Force Release",isoConst.msgPopupType.success,"Force Release Document Success"),$scope.selectedTreeNode.SUBMIT_STATUS=data.data.SUBMIT_STATUS,$scope.selectedTreeNode.CHECK_IN_STATUS=data.data.CHECK_IN_STATUS,$scope.selectedTreeNode.CURRENT_VERSION_ID=data.data.CURRENT_VERSION_ID,isoService.checkOutIn.sendEmailNotificationNewDocumentVersion($scope.selectedTreeNode.NODE_ID).then(function(data){},function(err){})):msgPopup("Force Release",isoConst.msgPopupType.error,"Force Release Error")},function(err){msgPopup("Force Release",isoConst.msgPopupType.error,"Force Release Error")})}else msgPopup("Force Release",isoConst.msgPopupType.error,"Force Release Document Error")},function(err){msgPopup("Force Release",isoConst.msgPopupType.error,"Force Release Document Error")})},$scope.makeCurrentVersion=function(nodeId,checkOutInId){isoService.checkOutIn.makeCurrentVersion(nodeId,checkOutInId).then(function(data){"success"==data.status?(msgPopup("Make Current Version",isoConst.msgPopupType.success,"Make Current Version Success"),$scope.getFullVersionDoccument()):msgPopup("Make Current Version",isoConst.msgPopupType.error,"Make Current Version Error")},function(err){msgPopup("Make Current Version",isoConst.msgPopupType.error,"Make Current Version Error")})},$scope.forceCheckOutDocument=function(item){isoService.checkOutIn.forceCheckOutDocument(item.NODE_ID,item.ID).then(function(data){$("#iso-tree-actions-menu-popup").modal("hide"),"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Check out success, document has locked"),$scope.selectedTreeNode.CHECK_IN_STATUS=data.data.CHECK_IN_STATUS,$scope.selectedTreeNode.CHECK_IN_NO=data.data.CHECK_IN_NO,isoService.checkOutIn.downloadSpecificCheckIn(item.NODE_ID,item.ID)):"lock"==data.status?msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Document is locked"):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Check out fail!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Check out fail!")})},$scope.downloadSpecificCheckIn=function(item){isoService.checkOutIn.downloadSpecificCheckIn(item.NODE_ID,item.ID)},$scope.newName={value:""},$scope.changeNodeName=function(){$scope.actionContentForm.$valid&&isoService.treeDir.renameNode($scope.selectedTreeNode.NODE_ID,$scope.selectedTreeNode.NODE_NAME,$scope.newName.value).then(function(data){"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Rename success!"),$scope.getTreeDir()):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Rename fail!")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Rename fail!")}).then(function(){$("#iso-tree-action-content-popup").modal("hide"),$scope.newName={value:""}})},$scope.deleteNodeForever=function(){isoService.treeDir.deleteNodeForever($scope.selectedTreeNode.NODE_ID).then(function(data){"success"==data.status?(msgPopup(isoLang.isoHeader,isoConst.msgPopupType.success,"Delete node forever success."),$scope.getTreeDir()):msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Delete node forever fail.")},function(err){msgPopup(isoLang.isoHeader,isoConst.msgPopupType.error,"Delete node forever fail.")}).then(function(){$("#iso-tree-actions-menu-popup").modal("hide")})}}),angular.module("app.loggedIn.iso.directive",[]).directive("isoDemoDirective",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{message:"@",type:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_fade_in_out_template.html",controller:function($scope){}}}).directive("isoNoticeFinishRenderDirectoryTree",function(){return function(scope,element,attrs){scope.$last&&($(".tree > ul").attr("role","tree").find("ul").attr("role","group"),$(".tree").find("li:has(ul)").addClass("parent_li").attr("role","treeitem").find(" > span").attr("title","Collapse this branch").unbind("click"),$(".tree").find("li:has(ul)").addClass("parent_li").attr("role","treeitem").find(" > span").attr("title","Collapse this branch").on("click",function(e){var children=$(this).parent("li.parent_li").find(" > ul > li");children.is(":visible")?(children.hide("fast"),$(this).attr("title","Expand this branch").find(" > i").addClass("fa-plus").removeClass("fa-minus")):(children.show("fast"),$(this).attr("title","Collapse this branch").find(" > i").addClass("fa-minus").removeClass("fa-plus")),e.stopPropagation()}))}}).directive("isoCheckInDocument",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedTreeNode:"=",isCreateNewCheckIn:"="},templateUrl:"modules/iso/directives/isoCheckInDocument.html",controller:function($scope,isoService,FileUploader){if($scope.checkInInfo={checkInComment:""},$scope.isCreateNewCheckIn===!0)var uploader=$scope.uploader=new FileUploader({url:"/api/iso/iso-check-out-in/create-new-check-in-document"});else var uploader=$scope.uploader=new FileUploader({url:"/api/iso/iso-check-out-in/check-in-document"});uploader.filters.push({name:"customFilter",fn:function(item,options){return this.queue.length<10}}),uploader.onWhenAddingFileFailed=function(item,filter,options){console.info("onWhenAddingFileFailed",item,filter,options)},uploader.onAfterAddingFile=function(fileItem){uploader.queue.splice(0,uploader.queue.length-1),console.info("onAfterAddingFile",fileItem)},uploader.onAfterAddingAll=function(addedFileItems){console.info("onAfterAddingAll",addedFileItems)},uploader.onBeforeUploadItem=function(item){console.info("onBeforeUploadItem",item)},uploader.onProgressItem=function(fileItem,progress){console.info("onProgressItem",fileItem,progress)},uploader.onProgressAll=function(progress){console.info("onProgressAll",progress)},uploader.onSuccessItem=function(fileItem,response,status,headers){console.info("onSuccessItem",fileItem,response,status,headers)},uploader.onErrorItem=function(fileItem,response,status,headers){console.info("onErrorItem",fileItem,response,status,headers)},uploader.onCancelItem=function(fileItem,response,status,headers){console.info("onCancelItem",fileItem,response,status,headers)},uploader.onCompleteItem=function(fileItem,response,status,headers){$("#iso-tree-action-content-popup").modal("hide"),response.status&&("success"==response.status?(isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Check in success!"),$scope.selectedTreeNode.CHECK_IN_STATUS=response.data.CHECK_IN_STATUS,$scope.selectedTreeNode.CHECK_IN_NO=response.data.CHECK_IN_NO,$scope.selectedTreeNode.SUBMIT_STATUS=response.data.SUBMIT_STATUS,uploader.queue.splice(0)):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Check in fail!")),console.info("onCompleteItem",fileItem,response,status,headers)},uploader.onCompleteAll=function(){console.info("onCompleteAll")},console.info("uploader",uploader),$scope.checkIn=function(){$scope.checkInForm.$valid&&($scope.checkInInfo.nodeId=$scope.selectedTreeNode.NODE_ID,$scope.checkInInfo.relativePath=$scope.selectedTreeNode.relativePath,uploader.queue[0]?(uploader.queue[0].formData[0]={},uploader.queue[0].formData[0]=$scope.checkInInfo,uploader.uploadAll()):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,isoLang.pleaseSelectFile))}}}}).directive("showErrors",function($timeout,showErrorsConfig){var getShowSuccess,linkFn;return getShowSuccess=function(options){var showSuccess;return showSuccess=showErrorsConfig.showSuccess,options&&null!=options.showSuccess&&(showSuccess=options.showSuccess),showSuccess},linkFn=function(scope,el,attrs,formCtrl){var blurred,inputEl,inputName,inputNgEl,options,showSuccess,toggleClasses;if(blurred=!1,options=scope.$eval(attrs.showErrors),showSuccess=getShowSuccess(options),inputEl=el[0].querySelector("[name]"),inputNgEl=angular.element(inputEl),inputName=inputNgEl.attr("name"),!inputName)throw"show-errors element has no child input elements with a 'name' attribute";return inputNgEl.bind("blur",function(){return blurred=!0,toggleClasses(formCtrl[inputName].$invalid)}),scope.$watch(function(){return formCtrl[inputName]&&formCtrl[inputName].$invalid},function(invalid){return blurred?toggleClasses(invalid):void 0}),scope.$on("show-errors-check-validity",function(){return toggleClasses(formCtrl[inputName].$invalid)}),scope.$on("show-errors-reset",function(){return $timeout(function(){return el.removeClass("has-error"),el.removeClass("has-success"),blurred=!1},0,!1)}),toggleClasses=function(invalid){return el.toggleClass("has-error",invalid),showSuccess?el.toggleClass("has-success",!invalid):void 0}},{restrict:"A",require:"^form",compile:function(elem,attrs){if(!elem.hasClass("form-group"))throw"show-errors element does not have the 'form-group' class";return linkFn}}}).provider("showErrorsConfig",function(){var _showSuccess;_showSuccess=!1,this.showSuccess=function(showSuccess){return _showSuccess=showSuccess},this.$get=function(){return{showSuccess:_showSuccess}}}).directive("isoReplyEditDocument",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{requestData:"=",adminData:"="},templateUrl:"modules/iso/directives/isoReplyEditDocument.html",controller:function($scope,isoService,$cookieStore){$scope.setListReply=function(IDREQUEST){isoService.replyEdit.getAllReplyEditDocument(IDREQUEST).then(function(data){"success"==data.status&&($scope.listReplyEditDocument=data.data,console.log($scope.listReplyEditDocument))})},$scope.$watch("requestData",function(oldValue,newValue){$scope.setListReply($scope.requestData)}),$scope.insertReply=function(comment){console.log($scope.adminData),console.log(isoConst.isoPermission.administrator);var value=1;isoService.replyEdit.insertReplyEditDocument($scope.requestData,comment).then(function(data){"success"==data.status&&($scope.adminData==isoConst.isoPermission.administrator?isoService.replyEdit.updateAdminReply($scope.requestData,value).then(function(data){"success"==data.status&&($scope.comment=null,$scope.setListReply($scope.requestData))}):isoService.replyEdit.updateStaffReply($scope.requestData,value).then(function(data){"success"==data.status&&($scope.comment=null,$scope.setListReply($scope.requestData))}))})}}}}),angular.module("app.loggedIn.iso.selectionUserName.directive",[]).directive("isoSelectionUserName",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{show:"=",selectedUserName:"="},templateUrl:"modules/iso/directives/isoSelectionUserName.html",controller:function($scope,isoService){$scope.userNameKey="",$scope.userNameList=[],$scope.filterUserName=function(){$scope.currentPage=1,$scope.handleUserNameListPaging()},$scope.handleUserNameListPaging=function(){$scope.userNameList=[],isoService.core.getCountUserName($scope.userNameKey).then(function(data){"success"==data.status&&($scope.totalItems=data.data.NUM_OF_USER_NAME,$scope.itemsPerPage=5,$scope.maxSize=7,isoService.core.getUserNameList($scope.userNameKey,$scope.currentPage,$scope.itemsPerPage).then(function(data){"success"==data.status&&($scope.userNameList=data.data)},function(err){}))},function(err){})},$scope.filterUserName(),$scope.autoInc=0,$scope.getSelectedUserName=function(user){$scope.selectedUserName.user_name=user.user_name,$scope.selectedUserName.id=user.id,$scope.autoInc++,$scope.selectedUserName.autoInc=$scope.autoInc,$scope.show=!1}}}}),angular.module("app.loggedIn.iso.selectionGroupUser.directive",[]).directive("isoSelectionGroupUser",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{show:"=",selectedGroup:"="},templateUrl:"modules/iso/directives/isoSelectionGroupUser.html",controller:function($scope,isoService){$scope.groupList=[],isoService.isoUserGroup.getUserGroupList().then(function(data){$scope.groupList="success"==data.status?data.data:[]},function(err){$scope.groupList=[]}),$scope.setSelectedGroup=function(group){$scope.selectedGroup.GROUP_NAME=group.GROUP_NAME,$scope.selectedGroup.GROUP_ID=group.GROUP_ID,$scope.show=!1}}}}),angular.module("app.loggedIn.iso.grantUserPermission.directive",[]).directive("isoGrantUserPermission",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedTreeNode:"="},templateUrl:"modules/iso/directives/isoGrantUserPermission.html",controller:function($scope,isoService,FileUploader){$scope.currentIsoCustom=currentIsoCustom,$scope.refreshNodePermission=function(){$scope.administratorUserList={},isoService.core.gerUsersInPermissionGroup($scope.selectedTreeNode.NODE_ID,isoConst.isoPermission.administrator).then(function(data){if("success"==data.status){for(var i=0;i<data.data.length;i++)$scope.administratorUserList[data.data[i].GROUP_NAME]||($scope.administratorUserList[data.data[i].GROUP_NAME]=[]),$scope.administratorUserList[data.data[i].GROUP_NAME].push(data.data[i]);exlog.log($scope.administratorUserList)}},function(err){}),$scope.createUserList={},isoService.core.gerUsersInPermissionGroup($scope.selectedTreeNode.NODE_ID,isoConst.isoPermission.create).then(function(data){if("success"==data.status)for(var i=0;i<data.data.length;i++)$scope.createUserList[data.data[i].GROUP_NAME]||($scope.createUserList[data.data[i].GROUP_NAME]=[]),
$scope.createUserList[data.data[i].GROUP_NAME].push(data.data[i])},function(err){}),$scope.updateUserList={},isoService.core.gerUsersInPermissionGroup($scope.selectedTreeNode.NODE_ID,isoConst.isoPermission.update).then(function(data){if("success"==data.status)for(var i=0;i<data.data.length;i++)$scope.updateUserList[data.data[i].GROUP_NAME]||($scope.updateUserList[data.data[i].GROUP_NAME]=[]),$scope.updateUserList[data.data[i].GROUP_NAME].push(data.data[i])},function(err){}),$scope.readUserList={},isoService.core.gerUsersInPermissionGroup($scope.selectedTreeNode.NODE_ID,isoConst.isoPermission.read).then(function(data){if("success"==data.status)for(var i=0;i<data.data.length;i++)$scope.readUserList[data.data[i].GROUP_NAME]||($scope.readUserList[data.data[i].GROUP_NAME]=[]),$scope.readUserList[data.data[i].GROUP_NAME].push(data.data[i])},function(err){})},$scope.$watchCollection("selectedTreeNode",function(newValues,oldValues){$scope.selectedTreeNode&&$scope.refreshNodePermission()}),$scope.grantNodePermission=function(nodeId,user,permission){isoService.treeUser.checkCanPermission(nodeId,user.id,permission).then(function(data){"success"==data.status?1==data.info?isoService.treeUser.grantNodePermission(nodeId,user.id,permission).then(function(data){"success"==data.status?(permission<isoConst.isoPermission.notPermission?isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Add "+user.user_name+" to group success!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Remove "+user.user_name+" from group success!"),$scope.refreshNodePermission()):permission<isoConst.isoPermission.notPermission?isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Add "+user.user_name+" to group fail!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Remove "+user.user_name+" from group fail!")},function(err){permission<isoConst.isoPermission.notPermission?isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Add "+user.user_name+" to group fail!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Remove "+user.user_name+" from group fail!")}):permission<isoConst.isoPermission.notPermission?isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"You cannot grant permission to "+user.user_name):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"You cannot remove "+user.user_name+" from group"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")},function(err){isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")})},$scope.showSelectionAdminUserName=!1,$scope.newAdminUserName={},$scope.$watchCollection("newAdminUserName",function(oldValues,newValues){$scope.newAdminUserName&&$scope.newAdminUserName.user_name&&$scope.grantNodePermission($scope.selectedTreeNode.NODE_ID,$scope.newAdminUserName,isoConst.isoPermission.administrator)}),$scope.showSelectionCreateUserName=!1,$scope.newCreateUserName={},$scope.$watchCollection("newCreateUserName",function(oldValues,newValues){$scope.newCreateUserName&&$scope.newCreateUserName.user_name&&$scope.grantNodePermission($scope.selectedTreeNode.NODE_ID,$scope.newCreateUserName,isoConst.isoPermission.create)}),$scope.showSelectionUpdateUserName=!1,$scope.newUpdateUserName={},$scope.$watchCollection("newUpdateUserName",function(oldValues,newValues){$scope.newUpdateUserName&&$scope.newUpdateUserName.user_name&&$scope.grantNodePermission($scope.selectedTreeNode.NODE_ID,$scope.newUpdateUserName,isoConst.isoPermission.update)}),$scope.showSelectionReadUserName=!1,$scope.newReadUserName={},$scope.$watchCollection("newReadUserName",function(oldValues,newValues){$scope.newReadUserName&&$scope.newReadUserName.user_name&&$scope.grantNodePermission($scope.selectedTreeNode.NODE_ID,$scope.newReadUserName,isoConst.isoPermission.read)}),$scope.showSelectionAdminGroup=!1,$scope.newAdminGroup={},$scope.$watchCollection("newAdminGroup",function(oldValues,newValues){$scope.newAdminGroup&&$scope.newAdminGroup.GROUP_NAME&&isoService.treeUser.grantGroupUserPermission($scope.selectedTreeNode.NODE_ID,$scope.newAdminGroup.GROUP_ID,isoConst.isoPermission.administrator).then(function(data){"success"==data.status?"success"==data.status?(isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Add group success!"),$scope.refreshNodePermission()):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Add group fail!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")},function(err){isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")})}),$scope.showSelectionCreateGroup=!1,$scope.newCreateGroup={},$scope.$watchCollection("newCreateGroup",function(oldValues,newValues){$scope.newCreateGroup&&$scope.newCreateGroup.GROUP_NAME&&isoService.treeUser.grantGroupUserPermission($scope.selectedTreeNode.NODE_ID,$scope.newCreateGroup.GROUP_ID,isoConst.isoPermission.create).then(function(data){"success"==data.status?"success"==data.status?(isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Add group success!"),$scope.refreshNodePermission()):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Add group fail!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")},function(err){isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")})}),$scope.showSelectionUpdateGroup=!1,$scope.newUpdateGroup={},$scope.$watchCollection("newUpdateGroup",function(oldValues,newValues){$scope.newUpdateGroup&&$scope.newUpdateGroup.GROUP_NAME&&isoService.treeUser.grantGroupUserPermission($scope.selectedTreeNode.NODE_ID,$scope.newUpdateGroup.GROUP_ID,isoConst.isoPermission.update).then(function(data){"success"==data.status?"success"==data.status?(isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Add group success!"),$scope.refreshNodePermission()):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Add group fail!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")},function(err){isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")})}),$scope.showSelectionReadGroup=!1,$scope.newReadGroup={},$scope.$watchCollection("newReadGroup",function(oldValues,newValues){$scope.newReadGroup&&$scope.newReadGroup.GROUP_NAME&&isoService.treeUser.grantGroupUserPermission($scope.selectedTreeNode.NODE_ID,$scope.newReadGroup.GROUP_ID,isoConst.isoPermission.read).then(function(data){"success"==data.status?"success"==data.status?(isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Add group success!"),$scope.refreshNodePermission()):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Add group fail!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")},function(err){isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")})}),$scope.removePermission=function(u){var user={id:u.id,user_name:u.user_name};$scope.grantNodePermission($scope.selectedTreeNode.NODE_ID,user,isoConst.isoPermission.notPermission)},$scope.removePermissionOfGroup=function(groupId){return groupId?void isoService.treeUser.grantGroupUserPermission($scope.selectedTreeNode.NODE_ID,groupId,isoConst.isoPermission.notPermission).then(function(data){"success"==data.status?"success"==data.status?(isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.success,"Remove permission of this group success!"),$scope.refreshNodePermission()):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Remove permission of this group fail!"):isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")},function(err){isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")}):void isoMsg.popup(isoLang.isoHeader,isoConst.msgPopupType.error,"Error!")}}}});var isoTest=!1,isoCustomList={full:{admin:{value:0,display:"Admin"},create:{value:1,display:"Create"},update:{value:2,display:"Update"},read:{value:3,display:"Read"}},zipQms:{admin:{value:0,display:"Admin"},update:{value:2,display:"Staff"},read:{value:3,display:"Viewer"}}},currentIsoCustom=isoCustomList.zipQms,isoHelper={setSlimCroll:function(selector){$(selector).slimscroll({})}},isoConst={nodeType:{folder:"FOLDER",document:"DOC"},msgPopupType:{success:"success",error:"error"},dbError:{ER_DUP_ENTRY:"ER_DUP_ENTRY"},submitStatus:{pending:"PENDING",approved:"APPROVED",reject:"REJECTED",cancel:"CANCEL"},isoPermission:{administrator:0,create:1,update:2,read:3,notPermission:4},isoAdminFunction:{restoreFolder:!0,restoreDocument:!0,forceCheckInDocument:!0,forceReleaseDocumentOneClick:!0,createNewCheckInDocument:!0,deleteNodeForever:!0},userFunction:{createFolder:"createFolder",deleteFolder:"deleteFolder",cloneToPC:"cloneToPC",grantFolderPermission:"cloneFolderPermission",createDocument:"createDocument",checkOut:"checkOut",forceCheckOut:"forceCheckOut",checkIn:"checkIn",createNewCheckInDocument:"createNewCheckInDocument",submitDocument:"submitDocument",cancelSubmitDocument:"cancelSubmitDocument",requestEditDocument:"requestEditDocument",viewYourRequest:"viewYourRequest",viewAllRequest:"viewAllRequest",deleteDocument:"deleteDocument",grantDocumentPermission:"grantDocumentPermission",downloadNewestVersion:"downloadNewestVersion",releaseDocumentOneClick:"releaseDocumentOneClick",makeCurrentVersion:"makeCurrentVersion",renameNode:"renameNode"},permissionFunction:{0:{createFolder:!0,deleteFolder:!0,cloneToPC:!0,grantFolderPermission:!0,createDocument:!0,checkOut:!0,forceCheckOut:!0,checkIn:!0,submitDocument:!1,cancelSubmitDocument:!1,deleteDocument:!0,grantDocumentPermission:!0,downloadNewestVersion:!0,getFullVersionDoccument:!0,getFullCheckinDoccument:!0,viewAllRequest:!0,releaseDocumentOneClick:!0,makeCurrentVersion:!0,renameNode:!0},1:{createFolder:!1,deleteFolder:!1,cloneToPC:!0,createDocument:!1,checkOut:!1,forceCheckOut:!1,checkIn:!1,submitDocument:!1,cancelSubmitDocument:!1,deleteDocument:!1,downloadNewestVersion:!0,getFullVersionDoccument:!0,getFullCheckinDoccument:!0,requestEditDocument:!0,viewYourRequest:!0},2:{cloneToPC:!0,checkOut:!1,forceCheckOut:!1,checkIn:!1,submitDocument:!1,cancelSubmitDocument:!1,downloadNewestVersion:!0,getFullVersionDoccument:!0,getFullCheckinDoccument:!0,requestEditDocument:!0,viewYourRequest:!0},3:{cloneToPC:!0,downloadNewestVersion:!0,getFullVersionDoccument:!0,getFullCheckinDoccument:!0}},checkInStatus:{lock:"LOCK",unlock:"UNLOCK"},hierarchyApprovalStatus:{notYetReview:"not underReviewyet review",underReview:"under review",approved:"approved",rejected:"rejected"},requestEditStatus:{pending:"PENDING",accept:"ACCEPT",reject:"REJECT",cancel:"CANCEL"},documentTypeList:[{value:"Procedure"},{value:"User Manual"},{value:"Policy"},{value:"Templates"}]},isoLang={isoHeader:"ISO SYSTEM",createFolderSuccess:"Create folder success!",createFolderError:"Create folder error!",createDocumentSuccess:"Create document success!",createDocumentError:"Create document error!",pleaseSelectFile:"Please select file!"},isoMsg={popup:function(header,type,content){$("#iso-global-msg-popup .iso-global-msg-popup-header").text(header),type==isoConst.msgPopupType.success&&($("#iso-global-msg-popup .iso-global-msg-popup-success").show(),$("#iso-global-msg-popup .iso-global-msg-popup-error").hide(),$("#iso-global-msg-popup .iso-global-msg-popup-success .iso-global-msg-popup-content").text(content)),type==isoConst.msgPopupType.error&&($("#iso-global-msg-popup .iso-global-msg-popup-error").show(),$("#iso-global-msg-popup .iso-global-msg-popup-success").hide(),$("#iso-global-msg-popup .iso-global-msg-popup-error .iso-global-msg-popup-content").text(content)),$("#iso-global-msg-popup").modal({show:!0,backdrop:"static"})}},isoNode={inheritPermission:function(child,parent){parent&&parent.PERMISSION&&(child.PERMISSION=parent.PERMISSION)}},isoFolder={inheritPermission:function(child,parent){parent&&(child.ACCESSIBLE_USER_ID=parent.ACCESSIBLE_USER_ID,child.IS_READ=parent.IS_READ,child.IS_CREATE=parent.IS_CREATE,child.IS_UPDATE=parent.IS_UPDATE,child.IS_DELETE=parent.IS_DELETE,child.IS_GRANT_PERMISSION=parent.IS_GRANT_PERMISSION)}},isoDocument={inheritPermission:function(child,parent){parent&&(child.ACCESSIBLE_USER_ID=parent.ACCESSIBLE_USER_ID,child.IS_READ=parent.IS_READ,child.IS_CREATE=parent.IS_CREATE,child.IS_UPDATE=parent.IS_UPDATE,child.IS_DELETE=parent.IS_DELETE,child.IS_GRANT_PERMISSION=parent.IS_GRANT_PERMISSION)}};angular.module("app.loggedIn.isoSubmitStatusPendingController.controller",[]).controller("isoSubmitStatusPendingController",function($scope,$http,$state,$window,$cookieStore,FileUploader,toastr,isoService){isoService.checkOutIn.checkCanAccessApprovalPage().then(function(data){"success"!=data.status&&$state.go("loggedIn.iso.main")},function(err){$state.go("loggedIn.iso.main")}),$scope.checkInOutStatusPending={};var msgPopup=isoMsg.popup,getAllOutInStatusPending=function(){$scope.currentPage=1,$scope.handleListPaging()};$scope.handleListPaging=function(){isoService.checkOutIn.countOutIn().then(function(data){"success"==data.status&&($scope.totalItems=data.data[0].SumData,$scope.itemsPerPage=5,$scope.maxSize=7,isoService.checkOutIn.getAllOutInStatusPending($scope.currentPage,$scope.itemsPerPage).then(function(data){"success"==data.status&&($scope.checkInOutStatusPending=data.data)}))})},getAllOutInStatusPending(),$scope.approved=function(id,node_id){var info={ID:id,status:isoConst.submitStatus.approved,Node_ID:node_id};isoService.checkOutIn.approvedAndReject(info).then(function(data){"success"==data.status?(msgPopup("Approved",isoConst.msgPopupType.success,"Approved Success"),getAllOutInStatusPending()):msgPopup("Approved",isoConst.msgPopupType.error,"Approved Error")})},$scope.rejects=function(id,node_id){var info={ID:id,status:isoConst.submitStatus.reject,Node_ID:node_id};isoService.checkOutIn.approvedAndReject(info).then(function(data){"success"==data.status?(msgPopup("Reject",isoConst.msgPopupType.success,"Reject Success"),getAllOutInStatusPending()):msgPopup("Reject",isoConst.msgPopupType.Error,"Reject Error")})},$scope.downloadFile=function(nodeId,checkOutInId){isoService.checkOutIn.dowloadFile(nodeId,checkOutInId).then(function(data){})},$scope.approvedDocument=function(nodeId,checkOutInId){isoService.checkOutIn.approvedDocument(nodeId,checkOutInId).then(function(data){"success"==data.status?(msgPopup("Approved",isoConst.msgPopupType.success,"Approved Success"),getAllOutInStatusPending(),isoService.checkOutIn.sendEmailNotificationNewDocumentVersion(nodeId).then(function(data){},function(err){})):msgPopup("Approved",isoConst.msgPopupType.error,"Approved Error")},function(err){msgPopup("Approved",isoConst.msgPopupType.error,"Approved Error")})},$scope.rejectedDocument=function(checkOutInId){isoService.checkOutIn.rejectedDocument(checkOutInId).then(function(data){"success"==data.status?(msgPopup("Reject",isoConst.msgPopupType.success,"Reject Success"),getAllOutInStatusPending()):msgPopup("Reject",isoConst.msgPopupType.error,"Reject Error")},function(err){msgPopup("Reject",isoConst.msgPopupType.error,"Reject Error")})}}),angular.module("app.loggedIn.isoHierarchyApprovalController.controller",[]).controller("isoHierarchyApprovalController",function($scope,$http,$state,$window,$cookieStore,FileUploader,toastr,isoService){$scope.hierarchyApprovalStatus=isoConst.hierarchyApprovalStatus,$scope.submitStatus=isoConst.submitStatus,$scope.hierarchyApprovalTreeTemp={},$scope.hierarchyApprovalTree={},isoService.hierarchyApproval.getAllHierarchyLineForUser().then(function(data){if("success"==data.status){for(var i=0;i<data.data.length;i++){var item=data.data[i];$scope.hierarchyApprovalTreeTemp[item.APPR_LINE_ID]=item}for(var i=0;i<data.data.length;i++){var item=data.data[i];$scope.hierarchyApprovalTreeTemp[item.PREVIOUS_LINE_ID]&&($scope.hierarchyApprovalTreeTemp[item.PREVIOUS_LINE_ID].NEXT_LINE_ID=item.APPR_LINE_ID)}for(var i=0;i<data.data.length;i++){var item=data.data[i];$scope.hierarchyApprovalTreeTemp[item.NEXT_LINE_ID]&&($scope.hierarchyApprovalTreeTemp[item.NEXT_LINE_ID].nodes={},$scope.hierarchyApprovalTreeTemp[item.NEXT_LINE_ID].nodes[item.APPR_LINE_ID]=item)}angular.forEach($scope.hierarchyApprovalTreeTemp,function(value,key){null==value.NEXT_LINE_ID&&($scope.hierarchyApprovalTree[value.APPR_LINE_ID]=value)}),console.log(">>>>>"),console.log($scope.hierarchyApprovalTree)}},function(err){}),$scope.approved=function(line){var approvalInfo={hierarchyHeaderId:line.APPR_HEADER_ID,hierarchyLineId:line.APPR_LINE_ID,hierarchyNodeId:line.NODE_ID,sourceLineId:line.SOURCE_LINE_ID,status:isoConst.hierarchyApprovalStatus.approved,isoNodeId:line.SOURCE_HEADER_ID};isoService.hierarchyApproval.approval(approvalInfo).then(function(data){"success"==data.status?(line.STATUS=isoConst.hierarchyApprovalStatus.approved,isoMsg.popup("Approved",isoConst.msgPopupType.success,"Approved Document Success!"),data.info&&"release"==data.info&&isoService.checkOutIn.sendEmailNotificationNewDocumentVersion(line.SOURCE_HEADER_ID).then(function(data){},function(err){})):isoMsg.popup("Approved",isoConst.msgPopupType.error,"Approved Document fail!")},function(err){isoMsg.popup("Approved",isoConst.msgPopupType.error,"Approved Document fail!")})},$scope.rejected=function(line){var approvalInfo={hierarchyHeaderId:line.APPR_HEADER_ID,hierarchyLineId:line.APPR_LINE_ID,hierarchyNodeId:line.NODE_ID,sourceLineId:line.SOURCE_LINE_ID,status:isoConst.hierarchyApprovalStatus.rejected,isoNodeId:line.SOURCE_HEADER_ID};isoService.hierarchyApproval.approval(approvalInfo).then(function(data){"success"==data.status?(line.STATUS=isoConst.hierarchyApprovalStatus.rejected,isoMsg.popup("Rejected",isoConst.msgPopupType.success,"Rejected Document Success!")):isoMsg.popup("Rejected",isoConst.msgPopupType.error,"Rejected Document fail!")},function(err){isoMsg.popup("Rejected",isoConst.msgPopupType.error,"Rejected Document fail!")})},$scope.downloadFile=function(line){isoService.hierarchyApproval.downloadFileCheckOutIn(line.SOURCE_HEADER_ID,line.SOURCE_LINE_ID).then(function(data){})}}),angular.module("app.loggedIn.iso.userGroup.controller",[]).controller("isoUserGroupController",function($scope,isoService,$state){isoService.isoAdmin.checkIsAdminIsoSystem().then(function(data){"success"!=data.status&&$state.go("loggedIn.iso.main")},function(err){$state.go("loggedIn.iso.main")}),isoService.isoUserGroup.getUserGroupList().then(function(data){$scope.userGroupList="success"==data.status?data.data:[]},function(err){$scope.userGroupList=[]}),$scope.actions={editGroup:{name:"editGroup",header:"Edit Group",buttonLabel:"OK",url:"iso_user_group_edit_template.html"},addGroup:{name:"addGroup",header:"Add Group",buttonLabel:"Add",url:"iso_user_group_add_template.html"},editUser:{name:"editUser",header:"Edit User",buttonLabel:"OK",url:"iso_user_group_edit_user_template.html"},addUser:{name:"addUser",header:"Add User",buttonLabel:"Add",url:"iso_user_group_add_user_template.html"}},$scope.currentAction={},$scope.newGroupInfo={},$scope.newGroupUpdateTemplate={ISENABLE:1},$scope.newGroupItemInfo={},$scope.newGroupItemInfoTemplate={ISENABLE:1},$scope.showActionContentPopup=function(action){switch(action){case $scope.actions.editGroup.name:$scope.currentAction=$scope.actions.editGroup;break;case $scope.actions.addGroup.name:$scope.currentAction=$scope.actions.addGroup,$scope.newGroupInfo=angular.copy($scope.newGroupUpdateTemplate);break;case $scope.actions.editUser.name:$scope.currentAction=$scope.actions.editUser;break;case $scope.actions.addUser.name:$scope.currentAction=$scope.actions.addUser,$scope.newGroupItemInfo=angular.copy($scope.newGroupItemInfoTemplate)}$("#iso-user-group-content-popup").modal({show:!0,backdrop:"static"})},$scope.selectedGroup={},$scope.groupUpdateInfo={},$scope.setSelectedGroup=function(group){$scope.selectedGroup=group,$scope.groupUpdateInfo=angular.copy($scope.selectedGroup)},$scope.updateGroupInfo=function(){isoService.isoUserGroup.updateGroupInfo($scope.groupUpdateInfo).then(function(data){"success"==data.status?(isoMsg.popup("ISO User Groups",isoConst.msgPopupType.success,"Update success!"),$scope.selectedGroup.GROUP_NAME=data.data.GROUP_NAME,$scope.selectedGroup.ISENABLE=data.data.ISENABLE,1==$scope.groupUpdateInfo.ISENABLE?isoService.treeUser.enablePermissionOfGroup($scope.selectedGroup.GROUP_ID).then(function(data){},function(err){}):isoService.treeUser.disablePermissionOfGroup($scope.selectedGroup.GROUP_ID).then(function(data){},function(err){})):isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Update fail!")},function(err){isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Update fail!")}).then(function(){$scope.groupUpdateInfo={},$("#iso-user-group-content-popup").modal("hide")})},$scope.addGroup=function(){isoService.isoUserGroup.addGroup($scope.newGroupInfo).then(function(data){"success"==data.status?(isoMsg.popup("ISO User Groups",isoConst.msgPopupType.success,"Add success!"),$scope.userGroupList.push(data.data),$scope.selectedGroup=$scope.userGroupList[$scope.userGroupList.length-1]):isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Add fail!")},function(err){isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Add fail!")}).then(function(){$scope.newGroupInfo=angular.copy($scope.newGroupUpdateTemplate),$("#iso-user-group-content-popup").modal("hide")})},$scope.getUserInGroup=function(groupId){isoService.isoUserGroup.getUsersInGroup(groupId).then(function(data){$scope.userList="success"==data.status?data.data:[]},function(err){$scope.userList=[]})},$scope.$watchCollection("selectedGroup",function(oldValues,newValues){$scope.selectedGroup&&$scope.getUserInGroup($scope.selectedGroup.GROUP_ID)}),$scope.selectedGroupItem={},$scope.groupItemUpdateInfo={},$scope.setSelectedGroupItem=function(user){$scope.selectedGroupItem=user,$scope.groupItemUpdateInfo=angular.copy($scope.selectedGroupItem),$scope.groupItemUpdateInfo.NEW_USER_ID=$scope.selectedGroupItem.USER_ID},$scope.showSelectionUser=!1,$scope.newUserSelected={},$scope.$watchCollection("newUserSelected",function(newValues,oldValues){$scope.newUserSelected&&$scope.newUserSelected.id&&($scope.groupItemUpdateInfo.NEW_USER_ID=$scope.newUserSelected.id,$scope.groupItemUpdateInfo.user_name=$scope.newUserSelected.user_name)}),$scope.grantPermissionForUserInGroup=function(groupId,userId){isoService.treeUser.grantPermissionForUserInGroup(groupId,userId).then(function(data){"success"==data.status||"fail"==data.status},function(err){})},$scope.removeAllPermissionOfUserInGroup=function(groupId,userId){isoService.treeUser.removeAllPermissionOfUserInGroup(groupId,userId).then(function(data){"success"==data.status},function(err){})},$scope.updateGroupItemInfo=function(){isoService.isoUserGroup.updateGroupItemInfo($scope.groupItemUpdateInfo).then(function(data){"success"==data.status?(isoMsg.popup("ISO User Groups",isoConst.msgPopupType.success,"Update success!"),$scope.selectedGroupItem.USER_ID=data.data.USER_ID,$scope.selectedGroupItem.user_name=data.data.user_name,$scope.selectedGroupItem.ISENABLE=data.data.ISENABLE,$scope.groupItemUpdateInfo.USER_ID!=$scope.groupItemUpdateInfo.NEW_USER_ID?1==$scope.groupItemUpdateInfo.ISENABLE?($scope.removeAllPermissionOfUserInGroup($scope.groupItemUpdateInfo.GROUP_ID,$scope.groupItemUpdateInfo.USER_ID),$scope.grantPermissionForUserInGroup($scope.groupItemUpdateInfo.GROUP_ID,$scope.groupItemUpdateInfo.NEW_USER_ID)):($scope.removeAllPermissionOfUserInGroup($scope.groupItemUpdateInfo.GROUP_ID,$scope.groupItemUpdateInfo.USER_ID),$scope.removeAllPermissionOfUserInGroup($scope.groupItemUpdateInfo.GROUP_ID,$scope.groupItemUpdateInfo.NEW_USER_ID)):1==$scope.groupItemUpdateInfo.ISENABLE?$scope.grantPermissionForUserInGroup($scope.groupItemUpdateInfo.GROUP_ID,$scope.groupItemUpdateInfo.USER_ID):$scope.removeAllPermissionOfUserInGroup($scope.groupItemUpdateInfo.GROUP_ID,$scope.groupItemUpdateInfo.USER_ID)):isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Add fail!")},function(err){isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Add fail!")}).then(function(){$scope.groupItemUpdateInfo={},$("#iso-user-group-content-popup").modal("hide")})},$scope.showSelectionUserForItem=!1,$scope.newUserSelectedForItem={},$scope.$watchCollection("newUserSelectedForItem",function(newValues,oldValues){$scope.newUserSelectedForItem&&$scope.newUserSelectedForItem.id&&($scope.newGroupItemInfo.USER_ID=$scope.newUserSelectedForItem.id,$scope.newGroupItemInfo.user_name=$scope.newUserSelectedForItem.user_name,$scope.newGroupItemInfo.GROUP_ID=$scope.selectedGroup.GROUP_ID)}),$scope.addGroupItem=function(){isoService.isoUserGroup.addGroupItem($scope.newGroupItemInfo).then(function(data){"success"==data.status?(isoMsg.popup("ISO User Groups",isoConst.msgPopupType.success,"Add success!"),$scope.userList.push(data.data),$scope.selectedGroupItem=$scope.userList[$scope.userList.length-1],$scope.grantPermissionForUserInGroup($scope.newGroupItemInfo.GROUP_ID,$scope.newGroupItemInfo.USER_ID)):isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Add fail!")},function(err){isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Add fail!")}).then(function(){$scope.newGroupItemInfo=angular.copy($scope.newGroupItemInfoTemplate),$("#iso-user-group-content-popup").modal("hide")})},$scope.deleteGroupItem=function(item){isoService.isoUserGroup.deleteGroupItem(item.GROUP_ID,item.USER_ID).then(function(data){"success"==data.status&&data.info>0?(isoMsg.popup("ISO User Groups",isoConst.msgPopupType.success,"Delete success!"),$scope.getUserInGroup($scope.selectedGroup.GROUP_ID),$scope.removeAllPermissionOfUserInGroup($scope.groupItemUpdateInfo.GROUP_ID,$scope.groupItemUpdateInfo.USER_ID)):isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Delete fail!")},function(err){isoMsg.popup("ISO User Groups",isoConst.msgPopupType.error,"Delete fail!")})}}),angular.module("app.loggedIn.iso.isoApproverListController.controller",[]).controller("isoApproverListController",function($scope,$http,$state,$window,$cookieStore,toastr,isoService){isoTest||isoService.isoAdmin.checkIsAdminIsoSystem().then(function(data){"success"!=data.status&&$state.go("loggedIn.iso.main")},function(err){$state.go("loggedIn.iso.main")});var msgPopup=isoMsg.popup;$scope.approverList={},$scope.getApproverList=function(){isoService.isoApprover.getApproverList().then(function(data){"success"==data.status&&($scope.approverList=data.data)})},$scope.getApproverList(),$scope.addNewUserToApproverList=function(){$("#iso-approver-list-popup").modal({show:!0,backdrop:"static"}),$scope.showSelectionAdminUserName=!0},$scope.showSelectionAdminUserName=!1,$scope.newAdminUserName={},$scope.$watchCollection("newAdminUserName",function(newval,oldval){$scope.newAdminUserName&&$scope.newAdminUserName.user_name&&isoService.isoApprover.insertNewUserToApprover(newval.id).then(function(data){"success"==data.status?(msgPopup("Add New User To Approver",isoConst.msgPopupType.success,"Add New User Success"),$scope.getApproverList()):msgPopup("Add New User To Approver",isoConst.msgPopupType.error,"Add New User Error"),$("#iso-approver-list-popup").modal("hide")})}),$scope.changeEnable=function(id,enable){isoService.isoApprover.updateEnableApprover(id,enable).then(function(data){"success"==data.status?msgPopup("Update Enable Approver",isoConst.msgPopupType.success,"Update Enable Approver Success"):msgPopup("Update Enable Approver",isoConst.msgPopupType.error,"Update Enable Approver Error")})}}),angular.module("app.loggedIn.iso.isoAdminController.controller",[]).controller("isoAdminController",function($scope,$http,$state,$window,$cookieStore,toastr,isoService){var msgPopup=isoMsg.popup;$scope.userName=$cookieStore.get("userInfo").user_name,console.log($scope.userName),$scope.adminList={},$scope.getAdminList=function(){isoService.isoAdmin.getAdminList().then(function(data){"success"==data.status&&($scope.adminList=data.data)})},$scope.getAdminList(),$scope.newAdminUserName={},$scope.addNewUserToAdminList=function(){$("#iso-admin-insert-list-popup").modal({show:!0,backdrop:"static"}),$scope.newAdminUserName={},$scope.role=null},$scope.addAdmin=function(id,role){console.log(id),console.log(role),id&&role?(console.log("aaaaaaaaaa"),isoService.isoAdmin.insertNewUserToAdmin(id,role).then(function(data){"success"==data.status?(msgPopup("Add New User To Admin",isoConst.msgPopupType.success,"Add New User Success"),$scope.getAdminList()):msgPopup("Add New User To Admin",isoConst.msgPopupType.error,"Add New User Error"),$("#iso-admin-insert-list-popup").modal("hide")})):(msgPopup("Add New User To Admin",isoConst.msgPopupType.error,"Add New User Error"),$("#iso-admin-insert-list-popup").modal("hide"))},$scope.editAdmin=function(info){console.log(info),console.log(info.ISENABLE),$scope.newAdminUserName.user_name=info.user_name,$scope.idAdmin=info.ADMIN_ID,$scope.roleAdmin=info.ROLE,$scope.enableAdmin=info.ISENABLE,console.log($scope.idAdmin),$("#iso-admin-edit-list-popup").modal({show:!0,backdrop:"static"})},$scope.updateAdmin=function(adId,idAdminNew,adRole,adEnable){console.log(adId),console.log(adRole),console.log(adEnable),$scope.enableAdmin=adEnable,adId&&adRole?isoService.isoAdmin.updateEnableAdmin(adId,idAdminNew,adRole,adEnable).then(function(data){"success"==data.status?(console.log("okokokok"),$("#iso-admin-edit-list-popup").modal("hide"),msgPopup("Edit User To Admin",isoConst.msgPopupType.success,"Edit User Success"),$scope.getAdminList()):msgPopup("Edit User To Admin",isoConst.msgPopupType.error,"Edit User Error"),$("#iso-admin-edit-list-popup").modal("hide"),$scope.newAdminUserName={}}):(msgPopup("EDit User To Admin",isoConst.msgPopupType.error,"Add New User Error"),$("#iso-admin-edit-list-popup").modal("hide"))},$scope.deleteAdmin=function(id){isoService.isoAdmin.deleteAdminUser(id).then(function(data){"success"==data.status&&$scope.getAdminList()})}}),angular.module("app.loggedIn.iso.service",[]).factory("isoService",function(Restangular,$http,$q,$window){var isoService={},api=Restangular.all("api");return isoService.core={getCountUserName:function(userNameKey){var result=api.one("iso/core/get-count-user-name");return result.get({userNameKey:userNameKey})},getUserNameList:function(userNameKey,pageIndex,itemsPerPage){var result=api.one("iso/core/get-user-name-list");return result.get({userNameKey:userNameKey,pageIndex:pageIndex,itemsPerPage:itemsPerPage})},gerUsersInPermissionGroup:function(nodeId,groupValue){var result=api.all("iso/core/get-users-in-permission-group");return result.post({nodeId:nodeId,groupValue:groupValue})},getDepartmentList:function(){var result=api.one("iso/core/get-department-list");return result.get()}},isoService.treeDir={getTreeDir:function(accessibleUserId,isIsoAdmin){var result=api.all("iso/iso-tree-dir/get-tree-dir");return result.post({accessibleUserId:accessibleUserId,isIsoAdmin:isIsoAdmin})},createFolder:function(nodeId,newFolder){var result=api.all("iso/iso-tree-dir/create-folder");return result.post({nodeId:nodeId,info:newFolder})},checkDupEntry:function(fatherNodeId,nodeName,docCode){var result=api.all("iso/iso-tree-dir/check-dup-entry");return result.post({fatherNodeId:fatherNodeId,nodeName:nodeName,docCode:docCode})},deleteNode:function(nodeId){var result=api.all("iso/iso-tree-dir/delete-node");return result.post({nodeId:nodeId})},restoreNode:function(nodeId){var result=api.all("iso/iso-tree-dir/restore-node");return result.post({nodeId:nodeId})},handlingCloneFolder:function(nodeId,listNode){var result=api.all("iso/iso-tree-dir/handling-clone-folder");return result.post({nodeId:nodeId,listNode:listNode})},cloneFolder:function(nodeId,downloadPackName){$window.location.href="/api/iso/iso-tree-dir/clone-folder?downloadPackName="+downloadPackName+"&nodeId="+nodeId},getFullVersionDoccument:function(nodeId){var result=api.all("iso/iso-tree-dir/getFullVersionDoccument");return result.post({nodeId:nodeId})},getFullCheckinDoccument:function(nodeId){var result=api.all("iso/iso-tree-dir/getFullCheckinDoccument");return result.post({nodeId:nodeId})},selectDocument:function(nodeId){var result=api.all("iso/iso-tree-dir/select-document-info");return result.post({
nodeId:nodeId})},handlingDownloadVersionDocument:function(FILE_NAME,CHECK_IN_FOLDER_STORAGE,nodeId){$window.location.href="/api/iso/iso-tree-dir/handlingDownloadVersionDocument?nodeId="+nodeId+"&FILE_NAME="+FILE_NAME+"&CHECK_IN_FOLDER_STORAGE="+CHECK_IN_FOLDER_STORAGE},sendRequestEditDocument:function(userRequestInfo){var result=api.all("iso/iso-tree-dir/send-request-to-edit-document");return result.post({userRequestInfo:userRequestInfo})},renameNode:function(nodeId,oldName,newName){var result=api.all("iso/iso-tree-dir/rename-node");return result.post({nodeId:nodeId,oldName:oldName,newName:newName})},deleteNodeForever:function(nodeId){var result=api.all("iso/iso-tree-dir/delete-node-forever");return result.post({nodeId:nodeId})},deleteNodeForever:function(nodeId){var result=api.all("iso/iso-tree-dir/delete-node-forever");return result.post({nodeId:nodeId})}},isoService.treeUser={grantNodePermission:function(nodeId,accessibleUserId,permission){var result=api.all("iso/iso-tree-users/grant-node-permission");return result.post({nodeId:nodeId,accessibleUserId:accessibleUserId,permission:permission})},checkCanPermission:function(nodeId,userIsGranted,permission){var result=api.all("iso/iso-tree-users/check-can-permission");return result.post({nodeId:nodeId,userIsGranted:userIsGranted,permission:permission})},grantGroupUserPermission:function(nodeId,groupId,permission){var result=api.all("iso/iso-tree-users/grant-user-group-permission");return result.post({nodeId:nodeId,groupId:groupId,permission:permission})},grantPermissionForUserInGroup:function(groupId,userIsGrantedId){var result=api.all("iso/iso-tree-users/grant-permission-for-user-in-group");return result.post({groupId:groupId,userIsGrantedId:userIsGrantedId})},removeAllPermissionOfUserInGroup:function(groupId,userIsGrantedId){var result=api.all("iso/iso-tree-users/remove-all-permission-of-user-of-group");return result.post({userIsGrantedId:userIsGrantedId,groupId:groupId})},disablePermissionOfGroup:function(groupId){var result=api.all("iso/iso-tree-users/disable-permission-of-group");return result.post({groupId:groupId})},enablePermissionOfGroup:function(groupId){var result=api.all("iso/iso-tree-users/enable-permission-of-group");return result.post({groupId:groupId})}},isoService.checkOutIn={checkOutDocument:function(nodeId,relativePath){var result=api.all("iso/iso-check-out-in/check-out-document");return result.post({nodeId:nodeId,relativePath:relativePath})},canCheckInDocument:function(nodeId){var result=api.one("iso/iso-check-out-in/can-check-in-document");return result.get({nodeId:nodeId})},selectIdFromCheckOutIn:function(NODE_ID){var result=api.one("iso/iso-check-out-in/selectIdFromCheckOutIn");return result.get({NODE_ID:NODE_ID})},submitDocument:function(nodeId){var result=api.all("iso/iso-check-out-in/submit-document");return result.post({nodeId:nodeId})},cancelSubmitDocument:function(nodeId){var result=api.all("iso/iso-check-out-in/cancel-submit-document");return result.post({nodeId:nodeId})},checkCanAccessApprovalPage:function(){var result=api.one("iso/iso-check-out-in/access-approval-page");return result.get()},getAllOutInStatusPending:function(pageIndex,itemsPerPage){var result=api.one("iso/iso-check-out-in/getAllOutInStatusPending");return result.get({pageIndex:pageIndex,itemsPerPage:itemsPerPage})},approvedDocument:function(nodeId,checkOutInId){var result=api.all("iso/iso-check-out-in/approved-document");return result.post({nodeId:nodeId,checkOutInId:checkOutInId})},rejectedDocument:function(checkOutInId){var result=api.all("iso/iso-check-out-in/rejected-document");return result.post({checkOutInId:checkOutInId})},approvedAndReject:function(info){var result=api.all("iso/iso-check-out-in/approvedAndReject");return result.post({data:info})},dowloadFile:function(nodeId,checkOutInId){$window.location.href="/api/iso/iso-check-out-in/downloadFileCheckOutIn?nodeId="+nodeId+"&checkOutInId="+checkOutInId},downloadNewestVersionDocument:function(Node_ID){$window.location.href="/api/iso/iso-check-out-in/downloadNewestVersionDocument?nodeId="+Node_ID},countOutIn:function(){var result=api.one("iso/iso-check-out-in/countOutInStatusPending");return result.get()},sendEmailNotificationNewDocumentVersion:function(nodeId){var result=api.all("iso/iso-check-out-in/send-email-all-user-document-release");return result.post({nodeId:nodeId})},makeCurrentVersion:function(nodeId,checkOutInId){var result=api.all("iso/iso-check-out-in/make-current-version");return result.post({nodeId:nodeId,checkOutInId:checkOutInId})},forceSubmitDocument:function(nodeId){var result=api.all("iso/iso-check-out-in/force-submit-document");return result.post({nodeId:nodeId})},forceApprovedDocument:function(nodeId,checkOutInId){var result=api.all("iso/iso-check-out-in/force-approved-document");return result.post({nodeId:nodeId,checkOutInId:checkOutInId})},forceCheckOutDocument:function(nodeId,checkOutInId){var result=api.all("iso/iso-check-out-in/force-check-out-document");return result.post({nodeId:nodeId,checkOutInId:checkOutInId})},downloadSpecificCheckIn:function(nodeId,checkOutInId){$window.location.href="/api/iso/iso-check-out-in/download-specific-check-in?nodeId="+nodeId+"&checkOutInId="+checkOutInId}},isoService.isoAdmin={checkIsAdminIsoSystemMaster:function(){var result=api.all("iso/iso-admin/check-is-admin-iso-system-master");return result.post()},checkIsAdminIsoSystem:function(){var result=api.all("iso/iso-admin/check-is-admin-iso-system");return result.post()},getAdminList:function(){var result=api.one("iso/iso-admin/getAdminList");return result.get()},insertNewUserToAdmin:function(id,role){var result=api.all("iso/iso-admin/insertNewUserToAdmin");return result.post({id:id,role:role})},updateEnableAdmin:function(id,idnew,role,enable){var result=api.all("iso/iso-admin/updateEnableAdmin");return result.post({id:id,idnew:idnew,role:role,enable:enable})},deleteAdminUser:function(id){var result=api.all("iso/iso-admin/deleteAdmin");return result.post({id:id})}},isoService.isoUserGroup={checkCanAccessUserGroupPage:function(){var result=api.one("iso/iso-user-group/access-user-group-page");return result.get()},getUserGroupList:function(){var result=api.one("iso/iso-user-group/get-user-group-list");return result.get()},updateGroupInfo:function(groupInfo){var result=api.all("iso/iso-user-group/update-group-info");return result.post({groupInfo:groupInfo})},addGroup:function(groupInfo){var result=api.all("iso/iso-user-group/add-group");return result.post({groupInfo:groupInfo})},getUsersInGroup:function(groupId){var result=api.all("iso/iso-user-group/get-user-in-group");return result.post({groupId:groupId})},updateGroupItemInfo:function(groupItemInfo){var result=api.all("iso/iso-user-group/update-group-item-info");return result.post({groupItemInfo:groupItemInfo})},addGroupItem:function(groupItemInfo){var result=api.all("iso/iso-user-group/add-group-item");return result.post({groupItemInfo:groupItemInfo})},deleteGroupItem:function(groupId,itemId){var result=api.all("iso/iso-user-group/delete-group-item");return result.post({groupId:groupId,itemId:itemId})}},isoService.isoApprover={getApproverList:function(){var result=api.one("iso/iso-approver/getApproverList");return result.get()},insertNewUserToApprover:function(id){var result=api.all("iso/iso-approver/insertNewUserToApprover");return result.post({id:id})},updateEnableApprover:function(id,enable){var result=api.all("iso/iso-approver/updateEnableApprover");return result.post({id:id,enable:enable})},checkIsIsoApprover:function(){var result=api.one("iso/iso-approver/check-is-iso-approver");return result.get()}},isoService.hierarchyApproval={addHierarchyApprovalHeader:function(isoNodeId){var result=api.all("iso/iso-hierarchy-approval/add-hierarchy-approval-header");return result.post({isoNodeId:isoNodeId})},approval:function(approvalInfo){var result=api.all("iso/iso-hierarchy-approval/approval");return result.post({approvalInfo:approvalInfo})},getAllHierarchyLineForUser:function(){var result=api.one("iso/iso-hierarchy-approval/get-all-hierarchy-line-for-user");return result.get()},downloadFileCheckOutIn:function(nodeId,checkOutInId){$window.location.href="/api/iso/iso-hierarchy-approval/download-file-check-out-in?nodeId="+nodeId+"&checkOutInId="+checkOutInId},sendEmailNotificationApprovalToNextNode:function(hierarchyLineId,hierarchyNodeId,isoNodeId,checkOutInId){var result=api.all("iso/iso-hierarchy-approval/send-email-notification-approval-to-next-node");return result.post({hierarchyLineId:hierarchyLineId,hierarchyNodeId:hierarchyNodeId,isoNodeId:isoNodeId,checkOutInId:checkOutInId})}},isoService.requestEdit={getAllRequestOfUserLogin:function(nodeId){var result=api.all("iso/iso-request-edit-document/get-all-request-of-user-login");return result.post({nodeId:nodeId})},cancelRequest:function(requestId){var result=api.all("iso/iso-request-edit-document/cancel-request");return result.post({requestId:requestId})},getAllRequest:function(nodeId){var result=api.all("iso/iso-request-edit-document/get-all-request");return result.post({nodeId:nodeId})},setRequestIsRead:function(requestId){var result=api.all("iso/iso-request-edit-document/set-request-is-read");return result.post({requestId:requestId})},setRequestStar:function(requestId,star){var result=api.all("iso/iso-request-edit-document/set-request-star");return result.post({requestId:requestId,star:star})},getNumberOfRequestUnread:function(nodeId){var result=api.one("iso/iso-request-edit-document/get-number-of-request-unread");return result.get({nodeId:nodeId})}},isoService.replyEdit={insertReplyEditDocument:function(IDREQUEST,DESCRIPTION){var result=api.all("iso/iso-reply-edit-document/insert-iso-reply-edit-document");return result.post({IDREQUEST:IDREQUEST,DESCRIPTION:DESCRIPTION})},getAllReplyEditDocument:function(IDREQUEST){var result=api.all("iso/iso-reply-edit-document/get-list-iso-reply-edit-document");return result.post({IDREQUEST:IDREQUEST})},updateAdminReply:function(ID,VALUE){var result=api.all("iso/iso-reply-edit-document/update-admin-reply");return result.post({ID:ID,VALUE:VALUE})},updateStaffReply:function(ID,VALUE){var result=api.all("iso/iso-reply-edit-document/updete-staff-reply");return result.post({ID:ID,VALUE:VALUE})},getNumberStaffReplyOfRequest:function(nodeId){var result=api.one("iso/iso-reply-edit-document/get-number-staff-reply-of-request");return result.get({nodeId:nodeId})},getNumberAdminReplyOfRequest:function(nodeId){var result=api.one("iso/iso-reply-edit-document/get-number-admin-reply-of-request");return result.get({nodeId:nodeId})},getHaveNewReply:function(ID){var result=api.one("iso/iso-reply-edit-document/get-have-new-reply");return result.get({ID:ID})}},isoService});var itemConst={feeGroupType:{private_fund:{value:"private_fund",display:"Private Fund",haveStartDate:!0,sourceFileTypes:{txt:{value:"txt",display:"txt"}}},medicare:{value:"medicare",display:"Medicare",haveStartDate:!1,sourceFileTypes:{xml:{value:"xml",display:"xml"}}},dva:{value:"dva",display:"DVA",haveStartDate:!0,sourceFileTypes:{xml:{value:"xml",display:"xml"}}},public_hospital:{value:"public_hospital",haveStartDate:!1,display:"Public Hospital"},workcover:{value:"workcover",haveStartDate:!1,display:"Workcover"}},sourceFileType:{xml:"xml",txt:"txt",xls:"xls"}};angular.module("app.loggedIn.item",["app.loggedIn.item.controller","app.loggedIn.item.services","app.loggedIn.item.directives"]).config(function($stateProvider){$stateProvider.state("loggedIn.item",{"abstract":!0,templateUrl:"modules/item/views/structure.html",controller:"ItemController"}).state("loggedIn.item.list",{url:"/item/list",views:{"main-content":{templateUrl:"modules/item/views/list.html",controller:"ItemListController"}}}).state("loggedIn.item.fee",{url:"/item/fee",views:{"main-content":{templateUrl:"modules/item/views/fee.html",controller:"ItemFeeController"}}}).state("loggedIn.item.fee.search",{url:"/search",views:{"main-content@loggedIn.item":{templateUrl:"modules/item/views/fee_search.html",controller:"ItemFeeSearchController"}}}).state("loggedIn.item.header",{url:"/item/header",views:{"main-content":{templateUrl:"modules/item/views/header.html",controller:"ItemHeaderController"}}})}),angular.module("app.loggedIn.item.services",[]).factory("ItemService",function(Restangular){var instanceService={},appApi=Restangular.all("api/erm");return instanceService.saveHeaderItems=function(header_id,item_list){for(var list=[],i=item_list.length-1;i>=0;i--)list.push(item_list[i].ITEM_ID);var data={header_id:header_id,items:list},detailApi=appApi.all("v2/items/insert_header_items");return detailApi.post(data)},instanceService.insertManualLine=function(data){var detailApi=appApi.all("v2/items/searchmanual");return detailApi.post(data)},instanceService.insertHeader=function(data){var detailApi=appApi.all("v2/items/insert_header");return detailApi.post(data)},instanceService.insert=function(data){var detailApi=appApi.all("v2/items/insert");return detailApi.post(data)},instanceService.insertFromSource=function(){var detailApi=appApi.all("v2/items/insert_from_source");return detailApi.post(data)},instanceService.detail=function(item_id){var detailApi=appApi.all("v2/items/detail");return detailApi.post({ITEM_ID:item_id})},instanceService.update=function(ITEM_ID,data){var detailApi=appApi.all("v2/items/update");return detailApi.post(data)},instanceService.getItemFees=function(item_id){var detailApi=appApi.one("v2/fees/get_item_fees");return detailApi.get({item_id:item_id})},instanceService.insertItemFees=function(item_id,fee_list){var list=[];console.log(fee_list);for(var i=fee_list.length-1;i>=0;i--)void 0!==fee_list[i].SCHEDULE_FEE&&list.push(fee_list[i]);var data={item_id:item_id,fees:list},detailApi=appApi.all("v2/fees/insert_item_fees");return detailApi.post(data)},instanceService.insertItemFundFees=function(item_id,fee_list){for(var list=[],i=fee_list.length-1;i>=0;i--)(void 0!==fee_list[i].FEE||void 0!==fee_list[i].PERCENT_FEE)&&list.push(fee_list[i]);var data={item_id:item_id,fees:list},detailApi=appApi.all("v2/fees/insert_item_fund_fees");return detailApi.post(data)},instanceService.updateTypePriceSource=function(type_id){var detailApi=appApi.all("v2/fees/update_type_price_source");return detailApi.post({FEE_TYPE_ID:type_id})},instanceService.updateGroupPriceSource=function(group_id){var detailApi=appApi.all("v2/fees/update_group_price_source");return detailApi.post({FEE_GROUP_ID:group_id})},instanceService.feegroupinsert=function(data){var detailApi=appApi.all("v2/fees/group/insert");return detailApi.post(data)},instanceService.feegroupdetail=function(group_id){console.log(group_id);var detailApi=appApi.all("v2/fees/group/detail");return detailApi.post({FEE_GROUP_ID:group_id})},instanceService.feegroupupdate=function(data){var detailApi=appApi.all("v2/fees/group/update");return detailApi.post(data)},instanceService.feetypeinsert=function(data){var detailApi=appApi.all("v2/fees/type/insert");return detailApi.post(data)},instanceService.feetypedetail=function(type_id){var detailApi=appApi.all("v2/fees/type/detail");return detailApi.post({FEE_TYPE_ID:type_id})},instanceService.feetypeupdate=function(data){var detailApi=appApi.all("v2/fees/type/update");return detailApi.post(data)},instanceService.privatefundsinsert=function(data){var detailApi=appApi.all("v2/fees/funds/insert");return detailApi.post(data)},instanceService.privatefundsdetail=function(pf_id){var detailApi=appApi.all("v2/fees/funds/detail");return detailApi.post({PF_id:pf_id})},instanceService.privatefundsupdate=function(data){var detailApi=appApi.all("v2/fees/funds/update");return detailApi.post(data)},instanceService.all_fee_types=function(){var detailApi=appApi.all("v2/fees/search_type_fees");return detailApi.post()},instanceService.importItemFromXML=function(){var detailApi=appApi.all("v2/items/import_from_source");return detailApi.post()},instanceService.importMedicareFeeFromSource=function(postData){var detailApi=appApi.all("v2/fees/group/import_medicare_fee_from_source");return detailApi.post({postData:postData})},instanceService.importFeeFromTxtSource=function(postData){var detailApi=appApi.all("v2/fees/group/import_fee_from_txt_source");return detailApi.post({postData:postData})},instanceService.importDvaFeeFromSource=function(postData){var detailApi=appApi.all("v2/fees/group/import_dva_fee_from_source");return detailApi.post({postData:postData})},instanceService.showHistory=function(data){var detailApi=appApi.all("v2/items/show_history");return detailApi.post(data)},instanceService.getListGroupFee=function(){var detailApi=appApi.all("v2/fees/group/get_list_group_fee");return detailApi.post()},instanceService.getItemFeeTypes=function(postData){var detailApi=appApi.all("v2/fees/type/get_item_fee_types");return detailApi.post({postData:postData})},instanceService.getItemFeeList=function(postData){var detailApi=appApi.all("v2/items/get_item_fee_list");return detailApi.post({postData:postData})},instanceService.saveAllItemFeeInGroupFee=function(feeGroup){var detailApi=appApi.all("v2/fees/group/save_all_item_fee_in_group_fee");return detailApi.post({feeGroup:feeGroup})},instanceService.removeItemFee=function(itemFeeId){var detailApi=appApi.all("v2/fees/remove_item_fee");return detailApi.post({itemFeeId:itemFeeId})},instanceService}),angular.module("app.loggedIn.item.directives",["app.loggedIn.item.detail.directive","app.loggedIn.item.search.directive","app.loggedIn.item.header_detail.directive","app.loggedIn.item.item_fees.directive","app.loggedIn.item.feegroup.detail.directive","app.loggedIn.item.feetype.detail.directive","app.loggedIn.item.privatefunds.detail.directive","app.loggedIn.item.showhistory.detail.directive"]),angular.module("app.loggedIn.item.detail.directive",[]).directive("itemDetail",function(ItemModel,ItemService,ConfigService,toastr,$timeout){return{restrict:"EA",scope:{data:"@",on_success:"=onsuccess"},templateUrl:"modules/item/directives/templates/detail.html",controller:function($scope,ConfigService){ConfigService.taxes_option().then(function(data){$scope.taxes=data,exlog.log(data)}),ConfigService.prefix_headers_option("item").then(function(data){$scope.prefix_headers=data}),ConfigService.inv_uoms_option().then(function(data){$scope.uoms=data}),$scope.loadData=function(id){$scope.id=id,ItemService.detail(id).then(function(data){angular.extend($scope.modelObjectMap,data.data),ConfigService.autoConvertData($scope.modelObjectMap)})}},link:function(scope,element,attrs){if(scope.modelObjectMap=angular.copy(ItemModel),scope.mode={type:"add",text:"Add Item"},scope.data){var data=scope.$eval(scope.data);data.id&&(scope.itemId=data.id,scope.loadData(data.id),scope.mode={type:"edit",text:"Save Item"})}var addProcess=function(postData){ItemService.insert(postData).then(function(response){"success"===response.status&&(toastr.success("Added a new Item","Success"),scope.isSubmit=!1,scope.modelObjectMap=angular.copy(response.data),scope.mode={type:"edit",text:"Save Item"})},function(error){toastr.error("Fail to add a new Item","Error")})},editProcess=function(postData){var id=postData.id;delete postData.id,ItemService.update(id,postData).then(function(response){"success"===response.status&&(toastr.success("Edit Item Successfully","Success"),scope.isSubmit=!1,scope.on_success&&scope.on_success(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);postData.TAX_ID&&_.filter(scope.taxes,function(n){n.TAX_ID==postData.TAX_ID&&(console.log("postData",postData),postData.TAX_CODE=n.TAX_CODE,postData.TAX_RATE=n.TAX_RATE)});for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.item.search.directive",[]).directive("itemSearch",function(ItemModel,ItemService,ConfigService,toastr){}),angular.module("app.loggedIn.item.item_fees.directive",[]).directive("itemFees",function(ItemService,ConfigService,toastr){return{restrict:"EA",scope:{item_id:"=id"},templateUrl:"modules/item/directives/templates/item_fees.html",controller:function($scope,$modal){var currentFeeGroupId=$scope.currentFeeGroupId=null;$scope.setCurrentFeeGroupId=function(feeGroup){currentFeeGroupId=feeGroup.FEE_GROUP_ID},$scope.loadFeeArr=function(){var feeStruct=$scope.feeStruct={},feeArr=$scope.feeArr=[];ItemService.getItemFeeList({itemId:$scope.item_id}).then(function(data){if("success"==data.status){for(var i=0;i<data.data.length;i++){var item=data.data[i];if(feeStruct[item.FEE_GROUP_ID]||(feeStruct[item.FEE_GROUP_ID]={FEE_GROUP_ID:item.FEE_GROUP_ID,FEE_GROUP_NAME:item.FEE_GROUP_NAME,FEE_GROUP_TYPE:item.FEE_GROUP_TYPE,FEE_TYPES:{}}),item.FEE_TYPE_ID&&!feeStruct[item.FEE_GROUP_ID].FEE_TYPES[item.FEE_TYPE_ID]&&(feeStruct[item.FEE_GROUP_ID].FEE_TYPES[item.FEE_TYPE_ID]={FEE_TYPE_ID:item.FEE_TYPE_ID,FEE_TYPE_NAME:item.FEE_TYPE_NAME,LIST_FEE:[]}),item.ITEM_FEE_ID){var fee={ITEM_FEE_ID:item.ITEM_FEE_ID,CLN_ITEM_ID:item.CLN_ITEM_ID,FEE_START_DATE:item.FEE_START_DATE,FEE_START_DATE_DISPLAY:moment(new Date(item.FEE_START_DATE)).format("DD-MM-YYYY"),FEE:item.FEE,PERCENT:item.PERCENT};feeStruct[item.FEE_GROUP_ID].FEE_TYPES[item.FEE_TYPE_ID].LIST_FEE.push(fee);var currentDate=moment(),startDate=moment(new Date(item.FEE_START_DATE));!feeStruct[item.FEE_GROUP_ID].FEE_TYPES[item.FEE_TYPE_ID].currentFee&&startDate.isBefore(currentDate)&&(feeStruct[item.FEE_GROUP_ID].FEE_TYPES[item.FEE_TYPE_ID].currentFee=fee)}}angular.forEach(feeStruct,function(feeGroupItem,key){var feeGroup={FEE_GROUP_ID:feeGroupItem.FEE_GROUP_ID,FEE_GROUP_NAME:feeGroupItem.FEE_GROUP_NAME,FEE_GROUP_TYPE:feeGroupItem.FEE_GROUP_TYPE,FEE_TYPES:[]};feeGroup.FEE_GROUP_ID==currentFeeGroupId&&(feeGroup.isCurrent=!0),feeArr.push(feeGroup),angular.forEach(feeGroupItem.FEE_TYPES,function(feeTypeItem,key){var feeType={FEE_TYPE_ID:feeTypeItem.FEE_TYPE_ID,FEE_TYPE_NAME:feeTypeItem.FEE_TYPE_NAME,LIST_FEE:feeTypeItem.LIST_FEE,currentFee:feeTypeItem.currentFee};feeGroup.FEE_TYPES.push(feeType)})}),null==currentFeeGroupId&&(feeArr[0].isCurrent=!0);var feeGroupSort=function(a,b){var A=a.FEE_GROUP_TYPE.toLowerCase(),B=b.FEE_GROUP_TYPE.toLowerCase();if(B>A)return-1;if(A>B)return 1;var C=a.FEE_GROUP_NAME.toLowerCase(),D=b.FEE_GROUP_NAME.toLowerCase();return D>C?-1:C>D?1:0},feeTypeSort=function(a,b){var A=a.FEE_TYPE_NAME.toLowerCase(),B=b.FEE_TYPE_NAME.toLowerCase();return B>A?-1:A>B?1:0},feeListSort=function(a,b){var A=moment(new Date(a.FEE_START_DATE)),B=moment(new Date(b.FEE_START_DATE));return A.isBefore(B)?1:A.isAfter(B)?-1:0};feeArr.sort(feeGroupSort);for(var i=0;i<feeArr.length;i++){var feeTypes=feeArr[i].FEE_TYPES;feeTypes.sort(feeTypeSort);for(var j=0;j<feeTypes.length;j++)feeTypes[j].LIST_FEE.sort(feeListSort)}}else exlog.logErr("item->itemFeesDirective",data)},function(err){exlog.logErr("item->itemFeesDirective",err)})},$scope.$watch("item_id",function(newValue,oldValue){$scope.item_id&&$scope.loadFeeArr()}),$scope.addNewFeeItem=function(feeType){$modal.open({templateUrl:"addNewFeeItemTemplate",controller:function($scope,$modalInstance,feeType,itemId){var newFeeItem=$scope.newFeeItem={CLN_ITEM_ID:itemId};$scope.add=function(){newFeeItem.FEE_START_DATE=moment(newFeeItem.FEE_START_DATE_DISPLAY,"DD/MM/YYYY").toDate(),newFeeItem.FEE_START_DATE_DISPLAY=moment(newFeeItem.FEE_START_DATE).format("DD-MM-YYYY");for(var i=0;i<feeType.LIST_FEE.length;i++)if(feeType.LIST_FEE[i].FEE_START_DATE_DISPLAY==newFeeItem.FEE_START_DATE_DISPLAY)return void toastr.warning("Duplicate Start Date.","Warning");feeType.LIST_FEE.push($scope.newFeeItem),feeType.currentFee=newFeeItem,$modalInstance.close("success")},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{feeType:function(){return feeType},itemId:function(){return $scope.item_id}}})},$scope.saveAllItemFeeInGroupFee=function(groupFee){ItemService.saveAllItemFeeInGroupFee(groupFee).then(function(data){"success"==data.status?(toastr.success("Save success.","Success"),$scope.loadFeeArr()):"empty"==data.status?(toastr.warning("Data empty.","Warning"),exlog.logErr(data)):(toastr.error("Save error.","Error"),exlog.logErr(data))},function(err){toastr.error("Save error.","Error"),exlog.logErr(err)})},$scope.removeItemFee=function(itemFee){if(itemFee){var modalInstance=$modal.open({templateUrl:"notifyRemoveItemFeeTemplate",controller:function($scope,$modalInstance){$scope.ok=function(){$modalInstance.close("ok")},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},size:"sm"});modalInstance.result.then(function(result){"ok"==result&&ItemService.removeItemFee(itemFee.ITEM_FEE_ID).then(function(data){"success"==data.status?(toastr.success("Remove item fee success.","Success"),$scope.loadFeeArr()):(toastr.error("Remove item fee error.","Error"),exlog.logErr(data))},function(err){toastr.error("Remove item fee error.","Error"),exlog.logErr(err)})},function(reason){})}else toastr.warning("No Fee Exist.","Warning")}}}}),angular.module("app.loggedIn.item.header_detail.directive",[]).directive("itemHeaderDetail",function(ItemHeaderModel,ItemService,ConfigService,toastr){return{restrict:"EA",scope:{data:"@",onsuccess:"=onsuccess"},templateUrl:"modules/item/directives/templates/header_detail.html",link:function(scope,element,attrs){var loadData=function(id){ItemService.detailHeader(id).then(function(data){angular.extend(scope.modelObjectMap,data.row),ConfigService.autoConvertData(scope.modelObjectMap)})};if(scope.modelObjectMap=angular.copy(ItemHeaderModel),scope.mode={type:"add",text:"Add Popular"},scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit Item"})}var addProcess=function(postData){console.log(postData),ItemService.insertHeader(postData).then(function(response){console.log(response),"success"===response.status&&(toastr.success("Added a Popular","Success"),scope.modelObjectMap=angular.copy(ItemHeaderModel),scope.isSubmit=!1,scope.onsuccess&&(console.log(scope.onsuccess),scope.onsuccess(response)))})},editProcess=function(postData){var id=postData.id;delete postData.id,ItemService.update(id,postData).then(function(response){"success"===response.status&&(toastr.success("Edit Item Successfully","Success"),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.item.feegroup.detail.directive",[]).directive("feeGroupDetail",function(FeeGroupModel,ItemService,ConfigService,toastr,$modal){return{restrict:"EA",scope:{data:"@",options:"=",on_success:"=onsuccess"},templateUrl:"modules/item/directives/templates/fee_group_detail.html",link:function(scope,element,attrs){scope.feeGroupType=itemConst.feeGroupType,scope.currentGroupType={},scope.feeMapping={},scope.feeGroupTypeChange=function(){scope.currentGroupType=scope.feeGroupType[scope.modelObjectMap.FEE_GROUP_TYPE],scope.modelObjectMap.SOURCE_FILE_TYPE=null};var loadData=function(id){ItemService.feegroupdetail(id).then(function(data){if(angular.extend(scope.modelObjectMap,data.data),scope.currentGroupType=scope.feeGroupType[scope.modelObjectMap.FEE_GROUP_TYPE],ConfigService.autoConvertData(scope.modelObjectMap),scope.modelObjectMap.COLUMN_MAPPING){scope.modelObjectMap.COLUMN_MAPPING=JSON.parse(scope.modelObjectMap.COLUMN_MAPPING);var feeMapping=scope.modelObjectMap.COLUMN_MAPPING;scope.modelObjectMap.itemCode=feeMapping.itemCode,console.log(scope.modelObjectMap),scope.feeMapping=feeMapping.feeMapping}scope.modelObjectMap.SOURCE_START_DATE&&(scope.modelObjectMap.SOURCE_START_DATE=moment(scope.modelObjectMap.SOURCE_START_DATE).format("DD/MM/YYYY"))})};if(scope.modelObjectMap=angular.copy(FeeGroupModel),scope.mode={type:"add",text:"Save Fee Group"},scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Save Fee Group"})}var addProcess=function(postData){ItemService.feegroupinsert(postData).then(function(response){"success"===response.status&&(toastr.success("Add successfully","Success"),scope.modelObjectMap=angular.copy(FeeGroupModel),scope.isSubmit=!1,scope.on_success&&scope.on_success(response))})},editProcess=function(postData){postData.id,delete postData.id,ItemService.feegroupupdate(postData).then(function(response){"success"===response.status&&(toastr.success("Edit successfully","Success"),scope.isSubmit=!1,scope.on_success&&scope.on_success(response))})};scope.deleteFeeMapping=function(key){$modal.open({templateUrl:"deleteFeeMapping",controller:function($scope,$modalInstance,feeMapping,key){$scope.Ok=function(){for(keys in feeMapping)keys===key&&delete feeMapping[key];console.log(feeMapping,key),$modalInstance.close(feeMapping)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{feeMapping:function(){return scope.feeMapping},key:function(){return key}}}).result.then(function(response){scope.feeMapping=response})},scope.addFeeMapping=function(){$modal.open({templateUrl:"addFeeMapping",controller:function($scope,$modalInstance,feeMapping){$scope.FeeMapping={FEE_TYPE_ORDER:"",col:"",uom:""},$scope.saveFeeMapping=function(){if($scope.isSubmitFee=!0,!$scope.FeeMappingForm.$invalid){var countkey=0,countcol=0,object={col:$scope.FeeMapping.col,uom:$scope.FeeMapping.uom};for(key in feeMapping)key===$scope.FeeMapping.FEE_TYPE_ORDER&&countkey++;for(key in feeMapping)feeMapping[key].col===$scope.FeeMapping.col&&countcol++;0===countkey?0===countcol?(feeMapping[$scope.FeeMapping.FEE_TYPE_ORDER]=object,$modalInstance.close(feeMapping)):toastr.error("Colum Index exits"):toastr.error("Fee Type Order exits")}},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{feeMapping:function(){return scope.feeMapping}}}).result.then(function(response){scope.feeMapping=response})},scope.editFeeMapping=function(key){$modal.open({templateUrl:"addFeeMapping",controller:function($scope,$modalInstance,feeMapping){var keyroot="",colroot="";for(keys in feeMapping)keys==key&&(keyroot=keys,colroot=feeMapping[keys].col,$scope.FeeMapping={FEE_TYPE_ORDER:keys,col:feeMapping[keys].col,uom:feeMapping[keys].uom});$scope.saveFeeMapping=function(){if($scope.isSubmitFee=!0,!$scope.FeeMappingForm.$invalid){var countkey=0,countcol=0,object={col:$scope.FeeMapping.col,uom:$scope.FeeMapping.uom};for(key in feeMapping)key===$scope.FeeMapping.FEE_TYPE_ORDER&&key!==keyroot&&countkey++;for(key in feeMapping)feeMapping[key].col===$scope.FeeMapping.col&&feeMapping[key].col!==colroot&&countcol++;console.log(countkey),0===countkey?0===countcol?(keyroot!==$scope.FeeMapping.FEE_TYPE_ORDER?(delete feeMapping[keyroot],feeMapping[$scope.FeeMapping.FEE_TYPE_ORDER]=object):feeMapping[$scope.FeeMapping.FEE_TYPE_ORDER]=object,$modalInstance.close(feeMapping)):toastr.error("Colum Index exits"):toastr.error("Fee Type Order exits")}},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{feeMapping:function(){return scope.feeMapping}}}).result.then(function(response){scope.feeMapping=response})},scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){scope.modelObjectMap.SOURCE_START_DATE=ConfigService.convertToDB(scope.modelObjectMap.SOURCE_START_DATE);var postData=angular.copy(scope.modelObjectMap),columnMapping={itemCode:scope.modelObjectMap.itemCode,feeMapping:scope.feeMapping};postData.COLUMN_MAPPING=columnMapping;for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));if("txt"!==postData.SOURCE_FILE_TYPE)for(key in postData)"COLUMN_MAPPING"===key&&delete postData[key];"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData);
}}}}}),angular.module("app.loggedIn.item.feetype.detail.directive",[]).directive("feeTypeDetail",function(FeeTypesModel,ItemService,ConfigService,toastr){return{restrict:"EA",scope:{data:"@",options:"=",success:"=",on_success:"=onsuccess"},templateUrl:"modules/item/directives/templates/fee_type_detail.html",link:function(scope,element,attrs){console.log(scope.options),scope.groupOptions=scope.options.groupSelect.data.items;var loadData=function(id){ItemService.feetypedetail(id).then(function(data){angular.extend(scope.modelObjectMap,data.data),ConfigService.autoConvertData(scope.modelObjectMap)})};if(scope.modelObjectMap=angular.copy(FeeTypesModel),scope.mode={type:"add",text:"Add Fee Type"},console.log(scope.data),scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit Fee Type"})}var addProcess=function(postData){ItemService.feetypeinsert(postData).then(function(response){"success"===response.status&&(toastr.success("Add successfully","Success"),scope.modelObjectMap=angular.copy(FeeTypesModel),scope.isSubmit=!1,scope.success=!0,console.log(scope.success),scope.on_success&&scope.on_success(response))})},editProcess=function(postData){postData.id,delete postData.id,ItemService.feetypeupdate(postData).then(function(response){"success"===response.status&&(toastr.success("Edit successfully","Success"),scope.isSubmit=!1,scope.success=!0,scope.on_success&&scope.on_success(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.item.showhistory.detail.directive",[]).directive("itemShowhistory",function(ConfigService,toastr,ItemService){return{restrict:"EA",scope:{id:"="},templateUrl:"modules/item/directives/templates/showhistory.html",link:function(scope,element,attrs){var loadData=function(id){var postData={id:id};ItemService.showHistory(postData).then(function(response){var now=moment();if("success"==data.status){for(var obj={},arr=data.data,i=0;i<arr.length;i++){var item=arr[i];obj[item.FEE_TYPE_ID]?obj[item.FEE_TYPE_ID].listFee.push({ITEM_FEE_ID:item.ITEM_FEE_ID,FEE_START_DATE:moment(item.FEE_START_DATE).format("DD-MM-YYYY"),FEE:item.FEE,FEE_STARTDATE:item.FEE_START_DATE,ISENABLE:item.ISENABLE}):(obj[item.FEE_TYPE_ID]={listFee:[],FEE_TYPE_NAME:item.FEE_TYPE_NAME,historyFee:""},obj[item.FEE_TYPE_ID].listFee.push({ITEM_FEE_ID:item.ITEM_FEE_ID,FEE_START_DATE:moment(item.FEE_START_DATE).format("DD-MM-YYYY"),FEE_STARTDATE:item.FEE_START_DATE,FEE:item.FEE,ISENABLE:item.ISENABLE}))}for(var key in obj)for(var count=0,countsame=0,i=0;i<obj[key].listFee.length;i++)moment(obj[key].listFee[i].FEE_STARTDATE).isBefore(now)&&0===count&&(obj[key].historyFee=obj[key].listFee[i].FEE,count=1),moment(obj[key].listFee[i].FEE_STARTDATE).isSame(now)&&0===countsame&&(obj[key].historyFee=obj[key].listFee[i].FEE,countsame=1);scope.obj=obj}})};loadData(scope.id),scope.colors=[{name:"white"},{name:"black"}],scope.myColor="white"}}}),angular.module("app.loggedIn.item.privatefunds.detail.directive",[]).directive("privateFundsDetail",function(PrivateFundsModel,ItemService,ConfigService,toastr){return{restrict:"EA",scope:{data:"@",options:"=",on_success:"=onsuccess"},templateUrl:"modules/item/directives/templates/private_fund_detail.html",link:function(scope,element,attrs){var loadData=function(id){ItemService.privatefundsdetail(id).then(function(data){angular.extend(scope.modelObjectMap,data.data),ConfigService.autoConvertData(scope.modelObjectMap),scope.AHSAorBUPA="1"===scope.modelObjectMap.isAHSA?0:1})};if(scope.modelObjectMap=angular.copy(PrivateFundsModel),scope.mode={type:"add",text:"Add Private Funds"},scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit Private Funds"})}var addProcess=function(postData){ItemService.privatefundsinsert(postData).then(function(response){"success"===response.status&&(toastr.success("Add successfully","Success"),scope.modelObjectMap=angular.copy(PrivateFundsModel),scope.isSubmit=!1,scope.on_success&&scope.on_success(response))})},editProcess=function(postData){postData.id,delete postData.id,ItemService.privatefundsupdate(postData).then(function(response){"success"===response.status&&(toastr.success("Edit successfully","Success"),scope.isSubmit=!1,scope.on_success&&scope.on_success(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){console.log(scope.AHSAorBUPA),"0"===scope.AHSAorBUPA?(scope.modelObjectMap.isAHSA=1,scope.modelObjectMap.isBUPA=0):(scope.modelObjectMap.isAHSA=0,scope.modelObjectMap.isBUPA=1);var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.item.controller",["app.loggedIn.item.list.controller","app.loggedIn.item.header.controller","app.loggedIn.item.fee.controller","app.loggedIn.item.fee.search.controller"]).controller("ItemController",function($scope,ConfigService){$scope.data_options={api:"api/erm/v2/items/search",method:"post",columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"},{field:"ITEM_TYPE",label:"Type",width:"15%"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"},ITEM_TYPE:{type:"text"}}}}),angular.module("app.loggedIn.item.list.controller",[]).controller("ItemListController",function($scope,$state,toastr,ItemService,$modal){$scope.item_panel={},$scope.itemInfo={},$scope.items={select:0,"class":function(item){return{selected:item.ITEM_ID==$scope.items.select}},options:{api:"api/erm/v2/items/search",method:"post",scope:$scope.item_panel,columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"},{field:"ITEM_TYPE",label:"Type",width:"15%"},{field:"ISENABLE",label:"Enable",is_hide:!0}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"},ITEM_TYPE:{type:"text"}},use_actions:!0,actions:[{"class":"fa fa-info",title:"Info",callback:function(item){$scope.itemInfo.ITEM_ID=item.ITEM_ID,$modal.open({templateUrl:"showItemTemplate",controller:function($scope,$modalInstance,options,editForm,itemInfo){$scope.options=options,$scope.editForm=editForm,$scope.itemInfo=itemInfo},resolve:{options:function(){return $scope.options},editForm:function(){return $scope.editForm},itemInfo:function(){return $scope.itemInfo}},size:"lg"})}},{"class":"fa fa-money",title:"Fees",callback:function(item){$scope.items.select=item.ITEM_ID,$scope.itemFees.panel.reload(item.ITEM_ID),$scope.itemFees.open()}},{"class":"fa fa-history",title:"Show History",callback:function(item){$modal.open({templateUrl:"ShowHistory",controller:function($scope,$modalInstance,id){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.ShowHistory={success:!1,id:id},$scope.$watch("ShowHistory.success",function(success){success&&$modalInstance.close("success")})},resolve:{id:function(){return item.ITEM_CODE}}}).result.then(function(response){"success"===response&&$scope.fee_types_panel.reload()})}}]}},$scope.itemFees={is_show:!1,open:function(){this.is_show=!0,angular.element("#popupItemFee").modal("show")},close:function(){this.is_show=!1},panel:{}},$("#popupItemFee").on("hidden.bs.modal",function(e){$scope.itemFees.close()}),console.log("options.taxes",$scope.options),$scope.addForm={is_show:!1,open:function(){this.is_show=!0,angular.element("#popupAddItem").modal("show")},close:function(){this.is_show=!1},success:function(response){$scope.item_panel.reload()}},$("#popupAddItem").on("hidden.bs.modal",function(e){$scope.addForm.close()}),$scope.editForm={is_show:!1,open:function(){this.is_show=!0,angular.element("#popupEditItem").modal("show")},close:function(){this.is_show=!1},success:function(response){$scope.item_panel.reload()}},$("#popupEditItem").on("hidden.bs.modal",function(e){$scope.editForm.close()}),$scope.importItemsFromSource=function(){ItemService.insertFromSource().then(function(response){"success"==response.status&&toastr.success("Update successfully !!!")})}}),angular.module("app.loggedIn.item.header.controller",[]).controller("ItemHeaderController",function($scope,$filter,$state,toastr,ItemService){var arrGetBy=$filter("arrGetBy");$scope.header_color=function(item){return $scope.header_selected==item.POPULAR_HEADER_ID?"success":void 0},$scope.header_click=function(item){$scope.header_selected!=item.POPULAR_HEADER_ID&&($scope.header_selected=item.POPULAR_HEADER_ID,$scope.itemSearch.close(),$scope.showHeaderItem())},$scope.showHeaderItem=function(){$scope.selectList=[],$scope.item_panel.data.more_items=[],$scope.isShowHeaderItem=!0,$scope.item_options.search={POPULAR_HEADER_ID:$scope.header_selected},$scope.item_panel.reload()},$scope.itemHeaderClass=function(item){return item.just_add?"info":void 0},$scope.itemSearch={is_show:!1,open:function(){return 0==$scope.header_selected?void toastr.warning("Please select Header first","Warning"):void(this.is_show=!0)},close:function(){this.is_show=!1},save:function(){ItemService.saveHeaderItems($scope.header_selected,$scope.selectList).then(function(response){"success"===response.status&&(toastr.success("Save Successfully!!!","Success"),$scope.item_panel.reload())})}},$scope.headerAddForm={is_show:!1,open:function(){this.is_show=!0,$scope.itemSearch.close()},close:function(){this.is_show=!1},success:function(response){$scope.header_panel.data.items.unshift(response.data),$scope.headerAddForm.close(),$scope.header_click(response.data)}},$scope.success_add_header=function(response){console.log(response)},$scope.itemSearchClass=function(item){var t_item=arrGetBy($scope.item_panel.data.items,"ITEM_ID",item.ITEM_ID);if(t_item)return"success";var t_item=arrGetBy($scope.selectList,"ITEM_ID",item.ITEM_ID);return t_item?"info":void 0},$scope.itemSearchClick=function(item){var t_item=arrGetBy($scope.item_panel.data.items,"ITEM_ID",item.ITEM_ID);if(!t_item){var t_item=arrGetBy($scope.selectList,"ITEM_ID",item.ITEM_ID);t_item||($scope.selectList.push(item),item.just_add=!0,$scope.item_panel.data.more_items.push(item))}};var init=function(){$scope.item_panel={},$scope.header_panel={},$scope.header_options={api:"api/erm/v2/items/header_search",method:"post",columns:[{field:"POPULAR_HEADER_ID",is_hide:!0},{field:"POPULAR_CODE",label:"Code",width:"10%"},{field:"POPULAR_NAME",label:"Name"},{field:"ISENABLE",label:"Is enable"}],scope:$scope.header_panel},$scope.item_options={api:"api/erm/v2/items/header_item",method:"post",columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"20%"},{field:"ITEM_NAME",label:"Item Name"}],use_filters:!0,search:{POPULAR_HEADER_ID:0},not_load:!0,scope:$scope.item_panel,"static":!0},$scope.search_item_options={api:"api/erm/v2/items/search",method:"post",columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"},{field:"ITEM_TYPE",label:"Type",width:"15%"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"},ITEM_TYPE:{type:"text"}}},$scope.header_selected=0,$scope.isShowSearchItem=!1,$scope.isShowHeaderItem=!1};init()}),angular.module("app.loggedIn.item.fee.controller",[]).controller("ItemFeeController",function($scope,$http,$state,$timeout,toastr,FileUploader,ItemService,$modal){$scope.fee_types_panel={},$scope.private_funds_panel={},$scope.fee_groups_panel={},$scope.feeGroup={},$scope.feeType={},$scope.pf={},$scope.fee_groups={select_item:{},options:{api:"api/erm/v2/fees/search_group_fees",scope:$scope.fee_groups_panel,not_paging:!0,method:"post",search:{},columns:[{field:"FEE_GROUP_ID",is_hide:!0},{field:"FEE_GROUP_NAME",label:"Group name"},{field:"FEE_GROUP_TYPE",label:"Code"},{field:"SOURCE_FILE_TYPE",label:"Source file type"},{field:"PRICE_SOURCE",label:"Price Source"},{field:"FORMULA",label:"Formula"},{field:"SOURCE_START_DATE",label:"Start date",type:"custom",fn:function(item){return item.SOURCE_START_DATE?moment(new Date(item.SOURCE_START_DATE)).format("DD-MM-YYYY"):null}},{field:"ISENABLE",label:"Is enable"}],use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){console.log(item),$scope.feeGroup.id=item.FEE_GROUP_ID,$scope.editGroupFee()}},{"class":"fa fa-upload",title:"Upload Price Source",is_hide:function(item){return item.SOURCE_FILE_TYPE?!1:!0},callback:function(item){$scope.fee_groups.select_item=item,$scope.uploadSourceFileFee(item)}},{"class":"fa fa-check-circle",title:"Update Price Source",is_hide:function(item){return item.PRICE_SOURCE?!1:!0},callback:function(item){function chooseImportFunction(){return item.FEE_GROUP_TYPE==itemConst.feeGroupType.medicare.value?ItemService.importMedicareFeeFromSource({feeGroupId:item.FEE_GROUP_ID}):item.FEE_GROUP_TYPE==itemConst.feeGroupType.dva.value?ItemService.importDvaFeeFromSource({feeGroupId:item.FEE_GROUP_ID}):ItemService.importFeeFromTxtSource(item.FEE_GROUP_TYPE==itemConst.feeGroupType.private_fund.value?{feeGroupId:item.FEE_GROUP_ID}:{feeGroupId:item.FEE_GROUP_ID})}exlog.log(item),$scope.fee_groups.select_item=item,chooseImportFunction().then(function(data){"success"==data.status?toastr.success("Update fee success"):(toastr.error("Error when update fee.","Error"),exlog.logErr("Loi update fee tu file",err))},function(err){toastr.error("Error when update fee.","Error"),exlog.logErr("Loi update fee tu file",err)})}}]}},$scope.fee_types={select_item:{},options:{api:"api/erm/v2/fees/search_type_fees",method:"post",scope:$scope.fee_types_panel,not_paging:!0,columns:[{field:"FEE_TYPE_ID",is_hide:!0},{field:"FEE_TYPE_NAME",label:"Fund name"},{field:"FEE_GROUP_ID",label:"Group",type:"custom",fn:function(item){return null==item.feeGroup?"No Group":item.feeGroup.FEE_GROUP_NAME}},{field:"FEE_GROUP_ORDER",label:"Order"},{field:"ISENABLE",is_hide:!0}],use_actions:!0,action_show:function(item){return null==item.feeGroup?!0:""!=item.feeGroup.FEE_GROUP_TYPE?!0:!1},actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){console.log(item),$scope.feeType.id=item.FEE_TYPE_ID,$scope.editTypeFormopen()}}]}},$scope.private_funds={options:{api:"api/erm/v2/fees/search_fund_fees",scope:$scope.private_funds_panel,not_paging:!0,method:"post",columns:[{field:"PF_id",is_hide:!0},{field:"Isenable",is_hide:!0},{field:"Fund_name",label:"Fund name"},{field:"isAHSA",label:"AHSA",type:"checkbox",disabled:!0},{field:"isBUPA",label:"BUPA",type:"checkbox",disabled:!0}],use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:function(item){console.log(item),$scope.pf.id=item.PF_id,$scope.editPrivateFundsForm.open()}}]}},$scope.addGroupForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.fee_groups_panel.reload()}},$scope.editGroupForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.fee_groups_panel.reload(),$scope.fee_types_panel.reload()}},$scope.addTypeFormopen=function(){$modal.open({templateUrl:"addTypeForm",controller:function($scope,$modalInstance,options,addTypeForm){$scope.options=options,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.addTypeFormopen={success:!1},$scope.$watch("addTypeFormopen.success",function(success){success&&$modalInstance.close("success")})},resolve:{options:function(){return $scope.addTypeForm.options},addTypeForm:function(){return $scope.addTypeForm}}}).result.then(function(response){"success"===response&&$scope.fee_types_panel.reload()})},$scope.editTypeFormopen=function(){$modal.open({templateUrl:"editTypeForm",controller:function($scope,$modalInstance,options,editTypeForm,id){$scope.options=options,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.editTypeFormopen={id:id,success:!1},$scope.$watch("editTypeFormopen.success",function(success){success&&$modalInstance.close("success")})},resolve:{options:function(){return $scope.editTypeForm.options},editTypeForm:function(){return $scope.editTypeForm},id:function(){return $scope.feeType.id}}}).result.then(function(response){"success"===response&&$scope.fee_types_panel.reload()})},$scope.addTypeForm={options:{groupSelect:$scope.fee_groups_panel},is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.fee_types_panel.reload()}},$scope.editTypeForm={options:{groupSelect:$scope.fee_groups_panel},is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.fee_types_panel.reload()}},$scope.addPrivateFundsForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.private_funds_panel.reload()}},$scope.editPrivateFundsForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.private_funds_panel.reload()}},$scope.addGroupFee=function(){var fee_groups_panel=$scope.fee_groups_panel,modalInstance=$modal.open({templateUrl:"addGroupFeeTemplate",controller:function($scope,$modalInstance,options){$scope.options=options,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.onSuccess=function(response){"success"==response.status&&(fee_groups_panel.reload(),$modalInstance.close("success"))}},resolve:{options:function(){return $scope.options}}});modalInstance.result.then(function(data){exlog.log(data)},function(reason){exlog.log(reason)})},$scope.editGroupFee=function(){var fHeader="item->ItemFeeController->editGroupFee",fee_groups_panel=$scope.fee_groups_panel,fee_types_panel=$scope.fee_types_panel,modalInstance=$modal.open({templateUrl:"editGroupFeeTemplate",controller:function($scope,$modalInstance,options,feeGroup){$scope.options=options,$scope.feeGroup=feeGroup,$scope.onSuccess=function(response){"success"==response.status&&(fee_groups_panel.reload(),fee_types_panel.reload(),$modalInstance.close("success"))},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{options:function(){return $scope.options},feeGroup:function(){return $scope.feeGroup}}});modalInstance.result.then(function(data){exlog.log(fHeader,data)},function(reason){exlog.log(fHeader,reason)})},$scope.importMedicareFeeFromSource=function(){ItemService.importMedicareFeeFromSource({feeGroupId:4}).then(function(data){exlog.alert(data)},function(err){})},$scope.importFeeFromTxtSource=function(){ItemService.importFeeFromTxtSource({feeGroupId:18}).then(function(data){exlog.alert(data)},function(err){exlog.alert(err)})},$scope.importDvaFeeFromSource=function(){ItemService.importDvaFeeFromSource({feeGroupId:3}).then(function(data){exlog.alert(data)},function(err){exlog.alert(err)})},$scope.uploadSourceFileFee=function(feeGroup){$modal.open({templateUrl:"uploadFeeSourceTemplate",controller:function($scope,$modalInstance,feeGroup,fee_groups_panel){var uploader=$scope.uploader=new FileUploader({url:"api/erm/v2/fees/group/upload_source_file_fee",autoUpload:!0});uploader.filters.push({name:"checkFileType",fn:function(item){var name=item.name;return name.toLowerCase().indexOf(feeGroup.SOURCE_FILE_TYPE)>0}}),uploader.onWhenAddingFileFailed=function(item,filter,options){"checkFileType"==filter.name&&toastr.error("Source file type invalid","Error")},uploader.onCompleteItem=function(item,response,status,headers){return"success"!=response.status?void toastr.error("Upload fail !","error"):(toastr.success("Upload successfully !","Success"),void finishUploadFeeSourceFile())},uploader.url="api/erm/v2/fees/group/upload_source_file_fee",uploader.formData[0]={},uploader.formData[0].feeGroupId=feeGroup.FEE_GROUP_ID,$scope.cancel=function(){$modalInstance.dismiss("cancel")};var finishUploadFeeSourceFile=function(){$modalInstance.close("success"),fee_groups_panel.reload()}},resolve:{feeGroup:function(){return feeGroup},fee_groups_panel:function(){return $scope.fee_groups_panel}}})}}),angular.module("app.loggedIn.item.fee.search.controller",[]).controller("ItemFeeSearchController",function($scope,$state,toastr,ItemService){$scope.item_panel={},$scope.items={options:{api:"api/erm/v2/items/search_item_fees",method:"post",scope:$scope.item_panel,columns:[{field:"ITEM_ID",is_hide:!0},{field:"INV_GROUP",label:"Group"},{field:"ITEM_CODE",label:"Code"},{field:"ITEM_NAME",label:"Description"},{field:"ISENABLE",is_hide:!0}],use_filters:!0,filters:{INV_GROUP:{type:"text"},ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"}}}};var combine_item_fee=function(){var options=$scope.items.options;angular.forEach($scope.fee_list,function(fee,key){options.columns.push({field:"t"+fee.FEE_TYPE_ID,not_submit:!0,label:fee.FEE_TYPE_NAME,type:"custom",fn:function(item){if(!item.feeTypes||0==item.feeTypes.length)return"";for(var i=item.feeTypes.length-1;i>=0;i--){var fee_type=item.feeTypes[i];if(fee_type.FEE_TYPE_ID==fee.FEE_TYPE_ID)return fee_type.clnItemFee.SCHEDULE_FEE}return""}})})},init=function(){ItemService.all_fee_types().then(function(res){$scope.fee_list=res.list,combine_item_fee()})};init()});var kiss={concat:function(){for(var str="",i=0;i<arguments.length;i++)str+=arguments[i];return str},msToTimer:function(num){var timerItem={x:null,hour:null,minute:null,second:null,display:null};timerItem.x=num,timerItem.hour=Math.floor(timerItem.x/3600);var temp=timerItem.x%3600;timerItem.minute=Math.floor(temp/60);var temp=timerItem.x%60;timerItem.second=temp;var pad=function(num,size){var s="000000000"+num;return s.substr(s.length-size)};return timerItem.display=pad(timerItem.hour,2)+":"+pad(timerItem.minute,2)+":"+pad(timerItem.second,2),timerItem}};angular.module("app.kiss.timer.directive",[]).directive("kissTimer",function($interval){return{restrict:"E",scope:{startSessionTime:"=",returnValue:"="},templateUrl:"modules/kissModule/directives/templates/kissTimer.html",link:function($scope,element,attrs){var run=function(){var startSessionTime=moment(new Date($scope.startSessionTime)),currentTime=moment(),x=currentTime.diff(startSessionTime,"seconds"),timerItem={x:null,hour:null,minute:null,second:null};timerItem.x=x,timerItem.hour=Math.floor(timerItem.x/3600);var temp=timerItem.x%3600;timerItem.minute=Math.floor(temp/60);var temp=timerItem.x%60;timerItem.second=temp;var pad=function(num,size){var s="000000000"+num;return s.substr(s.length-size)},updateTime=function(){timerItem.hour=Math.floor(timerItem.x/3600);var temp=timerItem.x%3600;timerItem.minute=Math.floor(temp/60);var temp=timerItem.x%60;timerItem.second=temp,timerItem.x=timerItem.x+1,$scope.returnValue=String(pad(timerItem.hour,2)+":"+pad(timerItem.minute,2)+":"+pad(timerItem.second,2))};$scope.timer=$interval(updateTime,1e3)};$scope.$watch("startSessionTime",function(newValue,oldValue){$scope.startSessionTime&&("close"!=$scope.startSessionTime?run():$interval.cancel($scope.timer))}),element.on("$destroy",function(){$interval.cancel($scope.timer)})}}}),angular.module("app.calling",[]).config(function($stateProvider){$stateProvider.state("test_call",{url:"/testCall/:apiKey/:clientId/:callUser/:isCaller/:patientId",views:{root:{templateUrl:"modules/makeCall/views/call_apiRTC.html",controller:"callControllerApiRTC"}}}).state("make_call",{url:"/makeCall/:apiKey/:sessionId/:token/:callUser/:isCaller/:patientId/:calId",views:{root:{templateUrl:"modules/makeCall/views/call.html",controller:"callController"}}}).state("whiteboard",{url:"/whiteboard/:apiKey/:sessionId/:token/:patientId/:calId",views:{root:{templateUrl:"modules/makeCall/views/whiteboard.html",controller:"whiteboardController"}}})}),angular.module("app.calling").controller("callController",function($timeout,$scope,$document,$modalStack,$interval,$location,$rootScope,OTSession,$state,$modal,$cookieStore,toastr,$window,socket,UserService,$stateParams){function cancelListenerHandler(){console.log("Remove Success")}function disconnect(){0==$scope.streams.length?(socket.emit("sendMessage",$scope.userInfo.id,$stateParams.callUser,{type:"cancel"}),window.close(),null==window.whiteboard_screen&&window.whiteboard_screen.closed||window.whiteboard_screen.close()):UserService.getUserInfo($scope.userInfo.id).then(function(data){var signal={type:"cancelCall",data:data.user_name};OTSession.session.signal(signal,function(err){err?TB.error(err):(window.close(),null==window.whiteboard_screen&&window.whiteboard_screen.closed||window.whiteboard_screen.close())})})}function popup(url){return params="width="+screen.width,params+=", height="+screen.height,params+=", left=0",params+=", top=0",params+=", fullscreen=yes",(null==window.whiteboard_screen||window.whiteboard_screen.closed)&&(window.whiteboard_screen=window.open(url,"RedimedWhiteboard",params),window.whiteboard_screen.focus()),null==window.whiteboard_screen||window.whiteboard_screen.closed||window.open("","RedimedWhiteboard",""),!1}var audio=new Audio("theme/assets/phone_calling.mp3"),params=($cookieStore.get("toState"),{}),apiKey=$stateParams.apiKey,sessionId=$stateParams.sessionId,token=$stateParams.token;$scope.newwin=null,$scope.session=null,$scope.streams=OTSession.streams,$scope.connections=OTSession.connections,$scope.userInfo=null,$scope.callUserInfo=null,$scope.patientId=null!=$stateParams.patientId||void 0!=$stateParams.patientId?$stateParams.patientId:null,$scope.calId=null!=$stateParams.calId||void 0!=$stateParams.calId?$stateParams.calId:null,$scope.isCaller=1==$stateParams.isCaller||"1"==$stateParams.isCaller?!0:!1,$scope.isAccept=!1,UserService.getUserInfo($stateParams.callUser).then(function(data){data.img="theme/assets/icon.png",$scope.callUserInfo=data}),$scope.$on("onUnload",function(e){audio.pause(),disconnect()}),$scope.isAudioMuted=!1,$scope.isVideoMuted=!1,$scope.sharingMyScreen=!1,$scope.publishing=!1,$scope.screenBig=!0,$scope.screenShareSupported=!1,$scope.connected=!1,$scope.screenShareFailed=null,$scope.mouseMove=!1,$scope.selectingScreenSource=!1,$scope.promptToInstall=!1,$scope.showWhiteboard=!1,$scope.showBluetooth=!1,$scope.whiteboardUnread=!1,OT.registerScreenSharingExtension("chrome","pkakgggplhfilfbailbaibljfpalofjn"),OT.checkScreenSharingCapability(function(response){$scope.screenShareSupported=response.supported&&response.extensionRegistered!==!1,$scope.$apply()}),$scope.screenPublisherProps={name:"screen",style:{nameDisplayMode:"off"},publishAudio:!1,maxResolution:{width:1920,height:1080},videoSource:"screen"},$scope.facePublisherProps={name:"face",width:"100%",height:"100%",style:{nameDisplayMode:"off"},resolution:"1280x720",frameRate:30},$scope.notMine=function(stream){return stream.connection.connectionId!==$scope.session.connection.connectionId},null==$cookieStore.get("userInfo")||"undefined"==typeof $cookieStore.get("userInfo")?disconnect():$scope.userInfo=$cookieStore.get("userInfo"),$scope.session&&$scope.session.disconnect(),OTSession.init(apiKey,sessionId,token,function(err,session){$scope.session=session;var connectDisconnect=function(connected){$scope.$apply(function(){$scope.connected=connected,connected||($scope.publishing=!1)})};(session.is&&session.is("connected")||session.connected)&&(connectDisconnect(!0),$scope.publishing=!0),$scope.session.on("sessionConnected",connectDisconnect.bind($scope.session,!0)),$scope.session.on("sessionDisconnected",connectDisconnect.bind($scope.session,!1));var whiteboardUpdated=function(){$scope.showWhiteboard||$scope.whiteboardUnread||$scope.$apply(function(){$scope.whiteboardUnread=!0,$scope.mouseMove=!0})},deviceUpdated=function(){$scope.showBluetooth||$scope.$apply(function(){$scope.mouseMove=!0})};$scope.$on("otWhiteboardUpdate",whiteboardUpdated),$scope.$on("medicalDeviceUpdate",deviceUpdated),$scope.isCaller?(audio.loop=!0,audio.play(),socket.emit("sendMessage",$scope.userInfo.id,$stateParams.callUser,{type:"call",sessionId:sessionId,patientId:$scope.patientId,calId:$scope.calId})):socket.emit("sendMessage",$scope.userInfo.id,$stateParams.callUser,{type:"answer"})}),socket.removeListener("messageReceived",cancelListenerHandler),socket.on("messageReceived",function(fromId,fromUser,message){"answer"===message.type&&(audio.pause(),$scope.isAccept=!0,$modalStack.dismissAll()),"ignore"===message.type&&(toastr.info(fromUser+" Has Ignored The Call!"),0==$scope.streams.length?(audio.pause(),disconnect()):$modalStack.dismissAll()),"cancel"===message.type&&(audio.pause(),toastr.info(fromUser+" Has Left The Call!"),disconnect())}),$scope.muteAudio=function(){$scope.isAudioMuted=!$scope.isAudioMuted},$scope.muteVideo=function(){$scope.isVideoMuted=!$scope.isVideoMuted},$scope.cancelCall=function(){swal({title:"Are you sure want to cancel the call?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){audio.pause(),disconnect()})},OTSession.session&&OTSession.session.on({"signal:cancelCall":function(event){toastr.info(event.data+" Has Left The Call!"),$timeout(function(){0==$scope.streams.length&&(window.close(),null==window.whiteboard_screen&&window.whiteboard_screen.closed||window.whiteboard_screen.close())},1500)}}),$scope.installScreenshareExtension=function(){chrome.webstore.install("https://chrome.google.com/webstore/detail/pkakgggplhfilfbailbaibljfpalofjn",function(){console.log("successfully installed")},function(){console.error("failed to install",arguments)})},$scope.toggleWhiteboard=function(){popup($state.href("whiteboard",{apiKey:apiKey,sessionId:sessionId,token:token,patientId:$scope.patientId,calId:$scope.calId}))},$scope.toggleBluetooth=function(){$scope.showBluetooth=!$scope.showBluetooth,setTimeout(function(){$scope.$emit("otLayout")},10)},$scope.toggleShareScreen=function(){$scope.connected&&($scope.sharingMyScreen||$scope.selectingScreenSource?$scope.sharingMyScreen&&($scope.sharingMyScreen=!1):($scope.selectingScreenSource=!0,$scope.screenShareFailed=null,OT.checkScreenSharingCapability(function(response){response.supported&&response.extensionRegistered!==!1?response.extensionInstalled===!1?($scope.promptToInstall=!0,$scope.selectingScreenSource=!1):($scope.sharingMyScreen=!0,$scope.selectingScreenSource=!1):($scope.screenShareSupported=!1,$scope.selectingScreenSource=!1),$scope.$apply()})))},$scope.addPeople=function(){if(console.log($scope.streams),0==$scope.streams.length)toastr.warning("Please Wait For Calling Person First!");else if($scope.streams.length<2&&$scope.streams.length>0){for(var arrUser=[],i=0;i<$scope.streams.length;i++)arrUser.push($scope.streams[i].name);$modal.open({templateUrl:"modules/makeCall/views/dialogs/invitePeople.html",size:"sm",backdrop:"static",keyboard:!1,resolve:{userInfo:function(){return $scope.userInfo},arrUser:function(){return arrUser},sessionId:function(){return sessionId},OTSession:function(){return OTSession},patientId:function(){return $scope.patientId},calId:function(){return $scope.calId}},controller:function($scope,UserService,$modalInstance,toastr,socket,userInfo,sessionId,OTSession,patientId,arrUser){$scope.isMakeCall=!1,$scope.callUser=null,$scope.userInfo=userInfo,UserService.getOnlineUsers().then(function(rs){$scope.onlineUsers=rs.data}),$scope.cancelCall=function(){socket.emit("sendMessage",userInfo.id,$scope.callUser.id,{type:"cancel"}),$modalInstance.close({type:"cancel"})},$scope.callUser=function(u){$scope.isMakeCall=!0,$scope.callUser=u,socket.emit("sendMessage",userInfo.id,u.id,{type:"call",sessionId:sessionId,patientId:patientId,calId:calId})},$scope.cancelClick=function(){$modalInstance.close({type:"cancel"})}}})}else toastr.warning("Can Only Make A Group Call With 3 People!");
},$scope.$on("changeSize",function(event){event.targetScope.stream.oth_large=void 0===event.targetScope.stream.oth_large?"screen"!==event.targetScope.stream.name:!event.targetScope.stream.oth_large,setTimeout(function(){event.targetScope.$emit("otLayout")},10)}),$scope.$on("changeScreenSize",function(event){$scope.screenBig=!$scope.screenBig,setTimeout(function(){event.targetScope.$emit("otLayout")},10)}),$scope.$on("otPublisherError",function(event,error,publisher){"screenPublisher"===publisher.id&&$scope.$apply(function(){$scope.screenShareFailed=error.message,$scope.toggleShareScreen()})}),$scope.$on("otStreamDestroyed",function(event){"screenPublisher"===event.targetScope.publisher.id&&$scope.$apply(function(){$scope.sharingMyScreen=!1})});var mouseMoveTimeout,mouseMoved=function(event){$scope.mouseMove||$scope.$apply(function(){$scope.mouseMove=!0}),mouseMoveTimeout&&clearTimeout(mouseMoveTimeout),mouseMoveTimeout=setTimeout(function(){$scope.$apply(function(){$scope.mouseMove=!1})},5e3)};$window.addEventListener("mousemove",mouseMoved),$window.addEventListener("touchstart",mouseMoved),$document.context.body.addEventListener("orientationchange",function(){$scope.$emit("otLayout")}),$scope.$on("$destroy",function(){$scope.session&&$scope.connected&&($scope.session.disconnect(),$scope.connected=!1),$scope.session=null,disconnect()})}).controller("whiteboardController",function($scope,OTSession,$stateParams,$window){var apiKey=$stateParams.apiKey,sessionId=$stateParams.sessionId,token=$stateParams.token;$scope.patientId=$stateParams.patientId,$scope.calId=$stateParams.calId,$scope.mouseMove=!1,$scope.connected=!1,$scope.session=null,$scope.session&&$scope.session.disconnect(),OTSession.init(apiKey,sessionId,token,function(err,session){$scope.session=session;var connectDisconnect=function(connected){$scope.$apply(function(){$scope.connected=connected})};(session.is&&session.is("connected")||session.connected)&&connectDisconnect(!0),$scope.session.on("sessionConnected",connectDisconnect.bind($scope.session,!0)),$scope.session.on("sessionDisconnected",connectDisconnect.bind($scope.session,!1));var whiteboardUpdated=function(){$scope.$apply(function(){$scope.mouseMove=!0})};$scope.$on("otWhiteboardUpdate",whiteboardUpdated)});var mouseMoveTimeout,mouseMoved=function(event){$scope.mouseMove||$scope.$apply(function(){$scope.mouseMove=!0}),mouseMoveTimeout&&clearTimeout(mouseMoveTimeout),mouseMoveTimeout=setTimeout(function(){$scope.$apply(function(){$scope.mouseMove=!1})},5e3)};$window.addEventListener("mousemove",mouseMoved),$window.addEventListener("touchstart",mouseMoved)}).directive("medicalDevice",function(OTSession,$window,Restangular,socket){return{restrict:"E",scope:{callSession:"="},templateUrl:"modules/makeCall/views/medicalDevice.html",link:function(scope,element,attrs){scope.onlineDevice=null,scope.onlineData=null,scope.session=null,scope.session=scope.callSession?scope.callSession:OTSession.session;var signalError=function(err){err?TB.error(err):console.log("success")};socket.on("getMeasureData",function(rs){if(rs.info){var data=angular.copy(rs.info);delete data.deviceType,delete data.rawData,scope.$apply(function(){scope.onlineDevice=rs.info.deviceType,scope.onlineData=data});var signal={type:"bluetooth_data",data:rs.info};scope.session.signal(signal,signalError)}}),scope.session&&scope.session.on({"signal:bluetooth_data":function(event){if(event.from.connectionId!==scope.session.connection.connectionId){var info=event.data;if(info){var rs=angular.copy(info);delete rs.deviceType,delete rs.rawData,scope.$apply(function(){scope.onlineDevice=info.deviceType,scope.onlineData=rs})}scope.$emit("medicalDeviceUpdate")}}})}}}),angular.module("app.calling").controller("callControllerApiRTC",function($timeout,$scope,$document,$modalStack,$interval,$location,$rootScope,$state,$modal,$cookieStore,toastr,$window,socket,UserService,$stateParams){function userMediaErrorHandler(e){console.log("userMediaErrorHandler"),console.log(e)}function hangupHandler(e){console.log("hangupHandler"),console.log(e.detail.reason)}function incomingCallHandler(e){console.log("========Incoming Call========="),audio.pause(),$scope.isAccept=!0}function callAttemptHandler(e){alert("Id :"+e.detail.callerId+"is trying to reach you")}function errorHandler(e){console.log("errorHandler"),console.log(e)}function sessionReadyHandler(e){apiRTC.addEventListener("incomingCall",incomingCallHandler),apiRTC.addEventListener("userMediaError",userMediaErrorHandler),apiRTC.addEventListener("callAttempt",callAttemptHandler),apiRTC.addEventListener("hangup",hangupHandler),apiRTC.addEventListener("error",errorHandler);var webRTCClient=apiCC.session.createWebRTCClient({localVideo:"myLocalVideo",minilocalVideo:"myMiniVideo",remoteVideo:"myRemoteVideo",status:"status"});$scope.isCaller?(audio.loop=!0,audio.play(),socket.emit("sendMessage",$scope.userInfo.id,$stateParams.callUser,{type:"call",apiKey:$stateParams.apiKey,clientId:webRTCClient.webRTCClient.clientId})):$stateParams.clientId&&webRTCClient.call($stateParams.clientId)}function disconnect(){socket.emit("sendMessage",$scope.userInfo.id,$stateParams.callUser,{type:"cancel"}),window.close(),null==$scope.newwin&&$scope.newwin.closed||$scope.newwin.close()}var audio=new Audio("theme/assets/phone_calling.mp3");$stateParams.apiKey,$scope.newwin=null,$scope.userInfo=null,$scope.callUserInfo=null,$scope.patientId=null!=$stateParams.patientId||void 0!=$stateParams.patientId?$stateParams.patientId:null,$scope.isCaller=1==$stateParams.isCaller||"1"==$stateParams.isCaller?!0:!1,$scope.isAccept=!1,UserService.getUserInfo($stateParams.callUser).then(function(data){data.img="theme/assets/icon.png",$scope.callUserInfo=data}),$scope.userInfo=$cookieStore.get("userInfo"),apiRTC.init({apiKey:$stateParams.apiKey,appId:"RedimedApp",onReady:sessionReadyHandler}),socket.removeListener("messageReceived"),socket.on("messageReceived",function(fromId,fromUser,message){"ignore"===message.type&&(audio.pause(),toastr.info(fromUser+" Has Ignored The Call!"),disconnect()),"cancel"===message.type&&(audio.pause(),toastr.info(fromUser+" Has Left The Call!"),disconnect())})}),angular.module("app.loggedIn.mdtappointment",["app.loggedIn.mdtappointment.directives","app.loggedIn.mdtappointment.services"]),angular.module("app.loggedIn.mdtappointment.services",[]).factory("mdtAppointmentService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/erm/v2/appt/");return mdtService.byId=function(id){var funcApi=mdtApi.one("detail");return funcApi.get({id:id})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("update");return funcApi.post({data:postData,cal_id:id})},mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.mdtappointment.directives",["app.loggedIn.mdtappointment.detail.directive","app.loggedIn.mdtappointment.search.directive"]),angular.module("app.loggedIn.mdtappointment.detail.directive",[]).directive("mdtAppointmentDetail",function(mdtAppointmentModel,ConfigService,mdtAppointmentService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/mdtappointment/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&-1!=scope.params.id&&mdtAppointmentService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtAppointmentMap,response.data),ConfigService.autoConvertData(scope.mdtAppointmentMap);for(var cols=["ARR_TIME","ATTEND_TIME","FROM_TIME","TO_TIME"],i=0;i<cols.length;++i){var col=cols[i];scope.mdtAppointmentMap[col]=new Date(scope.mdtAppointmentMap[col])}ConfigService.system_service_by_clinical(scope.mdtAppointmentMap.CLINICAL_DEPT_ID).then(function(response){scope.serviceList=response})}),scope.mdtAppointmentMap=angular.copy(mdtAppointmentModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtappointmentForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtAppointmentMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));if(scope.params.permission.edit===!0){for(var cols=["doctor","Patient_id","CAL_ID","CLINICAL_DEPT_ID","SITE_ID","DOCTOR_ID","FROM_TIME","TO_TIME","PATIENTS"],i=0;i<cols.length;++i){var col=cols[i];delete postData[col]}mdtAppointmentService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")})}else mdtAppointmentService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init()}}}}}),angular.module("app.loggedIn.mdtappointment.search.directive",[]).directive("mdtappointmentSearch",function(mdtAppointmentService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/mdtappointment/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"DOCTOR_ID",value:""},{type:"text",name:"SITE_ID",value:""},{type:"text",name:"FROM_TIME",value:""}],select:["DOCTOR_ID","SITE_ID","FROM_TIME"]}},loadList=function(){mdtAppointmentService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtdept",["app.loggedIn.mdtdept.directives","app.loggedIn.mdtdept.services"]),angular.module("app.loggedIn.mdtdept.services",[]).factory("mdtDeptService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtdept/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService.listAll=function(){var funcApi=mdtApi.one("list");return funcApi.get()},mdtService}),angular.module("app.loggedIn.mdtdept.directives",["app.loggedIn.mdtdept.detail.directive","app.loggedIn.mdtdept.search.directive"]),angular.module("app.loggedIn.mdtdept.detail.directive",[]).directive("mdtdeptDetail",function(mdtDeptModel,ConfigService,mdtDeptService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/mdtdept/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&mdtDeptService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtDeptMap,response.data);for(var key in scope.mdtDeptMap)scope.mdtDeptMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtDeptMap[key]=scope.mdtDeptMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtDeptMap[key]=new Date(scope.mdtDeptMap[key])))}),scope.mdtDeptMap=angular.copy(mdtDeptModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtdeptForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtDeptMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?mdtDeptService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(mdtDeptService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.mdtdept.search.directive",[]).directive("mdtdeptSearch",function(mdtDeptService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/mdtdept/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"CLINICAL_DEPT_NAME",value:""},{type:"text",name:"ISENABLE",value:""},{type:"text",name:"Created_by",value:""}],select:["CLINICAL_DEPT_NAME","ISENABLE","Created_by"]}},loadList=function(){mdtDeptService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtdoctor",["app.loggedIn.mdtdoctor.directives","app.loggedIn.mdtdoctor.services"]),angular.module("app.loggedIn.mdtdoctor.services",[]).factory("mdtDoctorService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtdoctor/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService.specialities=function(option){var funcApi=mdtApi.all("specialities");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.mdtdoctor.directives",["app.loggedIn.mdtdoctor.detail.directive","app.loggedIn.mdtdoctor.search.directive"]),angular.module("app.loggedIn.mdtdoctor.detail.directive",[]).controller("SpecialtyRemoveDialog",function($scope,$modalInstance,list){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.ok=function(){$modalInstance.close(list)}}).directive("mdtdoctorDetail",function(mdtDoctorModel,ConfigService,mdtDoctorService,mdtSpecialtyService,UserService,ReceptionistService,toastr,$cookieStore,$modal,$stateParams){return{restrict:"EA",scope:{options:"=",params:"=",itemUpdate:"=",onsuccess:"=onsuccess"},templateUrl:"modules/mdtdoctor/directives/templates/detail.html",link:function(scope,element,attrs){scope.closePopup=function(){angular.element("#"+scope.params.popupId).fadeOut()},scope.users=null,scope.siteList=null,UserService.all().then(function(response){scope.users=response.data}),ReceptionistService.getSite().then(function(rs){"success"==rs.status&&(scope.siteList=rs.data)});var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&mdtDoctorService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtDoctorMap,response.data);for(var key in scope.mdtDoctorMap)scope.mdtDoctorMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtDoctorMap[key]=scope.mdtDoctorMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtDoctorMap[key]=new Date(scope.mdtDoctorMap[key])));scope.mdtDoctorMap.Title=parseInt(scope.mdtDoctorMap.Title),scope.mdtDoctorMap.Created_by=$cookieStore.get("userInfo").id,scope.mdtDoctorMap.Last_updated_by=$cookieStore.get("userInfo").id,scope.mdtDoctorMap.Medical_Registration_no=parseInt(scope.mdtDoctorMap.Medical_Registration_no)}),scope.mdtDoctorMap=angular.copy(mdtDoctorModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,!scope.mdtdoctorForm.$invalid){var postData=angular.copy(scope.mdtDoctorMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));postData.Last_update_date=ConfigService.getCommonDatetime(new Date),scope.params.permission.edit===!0?mdtDoctorService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success"),scope.itemUpdate=!0,scope.onsuccess&&(console.log(scope.onsuccess),scope.onsuccess(response))}):(postData.Creation_date=ConfigService.getCommonDatetime(new Date),mdtDoctorService.add(postData).then(function(response){"error"==response.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init(),scope.itemUpdate=!0,scope.onsuccess&&(console.log(scope.onsuccess),scope.onsuccess(response))}),init())}},scope.clearSignature=function(){scope.mdtDoctorMap.Signature=""};var addDialog=function(){$modal.open({templateUrl:"dialogSelectSpeciality",controller:function($scope,$modalInstance,doctorId){var clickRow=function(row){$modalInstance.close(row)};$scope.speciality={limit:10,reload:!1,doctorId:doctorId,clickRow:function(row){clickRow(row)}}},size:"lg",resolve:{doctorId:function(){return $stateParams.doctorId}}}).result.then(function(row){var postData={doctor_id:$stateParams.doctorId,Specialties_id:row.Specialties_id,Isenable:1};mdtSpecialtyService.selectServiceDoctor(postData).then(function(response){toastr.success("Select Successfully"),scope.speciality.load()},function(error){})})},load=function(){var postData={doctor_id:$stateParams.doctorId};mdtSpecialtyService.listByServiceDoctor(postData).then(function(response){scope.speciality.list=response.data},function(error){})},onActiveList=function(list){mdtSpecialtyService.active({doctor_id:$stateParams.doctorId,Specialty_id:list.Specialties_id}).then(function(response){toastr.success("Active Successfully"),scope.doctor.load(),scope.speciality.load()},function(error){})},removeDialog=function(list){$modal.open({templateUrl:"dialogSpecialtyRemove",controller:"SpecialtyRemoveDialog",size:"sm",resolve:{list:function(){return list}}}).result.then(function(list){var postData={doctor_id:$stateParams.doctorId,Specialties_id:list.Specialties_id};mdtSpecialtyService.removeServiceDoctor(postData).then(function(response){toastr.success("Delete Successfully"),scope.speciality.load()},function(error){})})};scope.disable=function(list){var postData={doctor_id:$stateParams.doctorId,Specialties_id:list.Specialties_id,Isenable:list.Isenable};mdtSpecialtyService.removeServiceDoctor(postData).then(function(response){scope.speciality.load()},function(error){})},scope.speciality={list:[],onActiveList:function(list){onActiveList(list)},load:function(){load()},dialog:{add:function(){addDialog()},remove:function(list){removeDialog(list)}},active:0},scope.option={titles:null,providers:null,qualifications:null,departments:null},ConfigService.title_option().then(function(response){"success"===response.status&&(scope.option.titles=response.data)}),ConfigService.provider_option().then(function(response){"success"===response.status&&(scope.option.providers=response.data)}),ConfigService.department_option().then(function(response){"success"===response.status&&(scope.option.departments=response.data)}),ConfigService.qualification_option().then(function(response){"success"===response.status&&(scope.option.qualifications=response.data)}),scope.speciality.load();var doctorLoad=function(){mdtDoctorService.byId($stateParams.doctorId).then(function(response){scope.speciality.active=response.data.Specialty_id},function(error){})};scope.doctor={item:{},load:function(){doctorLoad()}},scope.doctor.load()}}}),angular.module("app.loggedIn.mdtdoctor.search.directive",[]).directive("mdtdoctorSearch",function(mdtDoctorService,toastr,$modal){return{restrict:"EA",scope:{clickRow:"&",isClose:"@"},templateUrl:"modules/mdtdoctor/directives/templates/search.html",link:function(scope,element,attrs){scope.closePopup=function(){angular.element("#"+scope.isClose).fadeOut()};var init=function(){scope.list={},scope.params={pagination:{limit:7,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"NAME",value:""},{type:"text",name:"Email",value:""},{type:"text",name:"Phone",value:""},{type:"text",name:"Isenable",value:"1"}],select:["doctor_id","NAME","Email","Phone","CLINICAL_DEPT_ID"]},scope.isClose&&scope.closePopup()},loadList=function(){mdtDoctorService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()},scope.addDoctor=function(){$modal.open({templateUrl:"AddDoctorDialog",size:"lg",controller:function($scope,$modalInstance){$scope.params_doctor={permission:{create:!0,edit:!1}},$scope.itemUpdate=!1,$scope.$watch("itemUpdate",function(item){item===!0&&$modalInstance.close("success")})}}).result.then(function(response){})},scope.refresh=function(){loadList()}}}}),angular.module("app.loggedIn.mdtinsurer",["app.loggedIn.mdtinsurer.directives","app.loggedIn.mdtinsurer.services"]),angular.module("app.loggedIn.mdtinsurer.services",[]).factory("mdtInsurerService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtinsurer/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService.list=function(){var funcApi=mdtApi.one("list");return funcApi.get()},mdtService}),angular.module("app.loggedIn.mdtinsurer.directives",["app.loggedIn.mdtinsurer.detail.directive","app.loggedIn.mdtinsurer.search.directive"]),angular.module("app.loggedIn.mdtinsurer.detail.directive",[]).directive("mdtinsurerDetail",function(mdtInsurerModel,ConfigService,mdtInsurerService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/mdtinsurer/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&mdtInsurerService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtInsurerMap,response.data);for(var key in scope.mdtInsurerMap)scope.mdtInsurerMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtInsurerMap[key]=scope.mdtInsurerMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtInsurerMap[key]=new Date(scope.mdtInsurerMap[key])))}),scope.mdtInsurerMap=angular.copy(mdtInsurerModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtinsurerForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtInsurerMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?mdtInsurerService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(mdtInsurerService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.mdtinsurer.search.directive",[]).directive("mdtinsurerSearch",function(mdtInsurerService,toastr){return{restrict:"EA",scope:{clickRow:"&",isClose:"@"},templateUrl:"modules/mdtinsurer/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"insurer_name",value:""},{type:"text",name:"address",value:""},{type:"text",name:"suburb",value:""}],select:["insurer_name","address","suburb"]}};scope.closePopup=function(){angular.element(idClose).fadeOut()};var loadList=function(){mdtInsurerService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtoutdoctor",["app.loggedIn.mdtoutdoctor.directives","app.loggedIn.mdtoutdoctor.services","app.loggedIn.mdtoutdoctor.add.dialog"]),angular.module("app.loggedIn.mdtoutdoctor.services",[]).factory("mdtOutdoctorService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtoutdoctor/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.mdtoutdoctor.directives",["app.loggedIn.mdtoutdoctor.detail.directive","app.loggedIn.mdtoutdoctor.search.directive","app.loggedIn.mdtoutdoctor.add.directive"]),angular.module("app.loggedIn.mdtoutdoctor.detail.directive",[]).directive("mdtoutdoctorDetail",function(mdtOutdoctorModel,ConfigService,mdtOutdoctorService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/mdtoutdoctor/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&mdtOutdoctorService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtOutdoctorMap,response.data);for(var key in scope.mdtOutdoctorMap)scope.mdtOutdoctorMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtOutdoctorMap[key]=scope.mdtOutdoctorMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtOutdoctorMap[key]=new Date(scope.mdtOutdoctorMap[key])))}),scope.mdtOutdoctorMap=angular.copy(mdtOutdoctorModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtoutdoctorForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtOutdoctorMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?mdtOutdoctorService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(mdtOutdoctorService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.mdtoutdoctor.search.directive",[]).directive("mdtoutdoctorSearch",function(mdtOutdoctorService,toastr,$modal){return{restrict:"EA",scope:{clickRow:"&",isClose:"@",data:"="},templateUrl:"modules/mdtoutdoctor/directives/templates/search.html",link:function(scope,element,attrs){scope.closePopup=function(){angular.element("#"+scope.isClose).fadeOut()},scope.OutSideDoctor=function(size){$modal.open({templateUrl:"modules/mdtoutdoctor/dialogs/templates/add.html",controller:"MdtoutdoctorAdddialog",size:"lg"}).result.then(function(response){"success"===response.status&&(toastr.success("Add Successfully"),scope.data=response.data,loadList())})};var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"provider_no",value:""},{type:"text",name:"name",value:""},{type:"text",name:"address",value:""}],select:["doctor_id","provider_no","name","address"]},scope.isClose&&scope.closePopup()},loadList=function(){mdtOutdoctorService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()},scope.refresh=function(){loadList()}}}}),angular.module("app.loggedIn.mdtoutdoctor.add.directive",[]).directive("mdtoutdoctorAdd",function(mdtOutdoctorModel,ConfigService,mdtOutdoctorService,toastr){return{restrict:"EA",scope:{options:"=",params:"=",success:"=",data:"="},templateUrl:"modules/mdtoutdoctor/directives/templates/add.html",link:function(scope,element,attrs){scope.mdtOutdoctorMap={provider_no:null,name:null,address:null,suburb:null,state:null,phone:null},scope.errors=[],scope.save=function(){ConfigService.beforeSave(scope.errors);var postData=angular.copy(scope.mdtOutdoctorMap);mdtOutdoctorService.add(postData).then(function(data){scope.success=!0,scope.data=data},function(error){scope.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.errors)})}}}}),angular.module("app.loggedIn.mdtoutdoctor.add.dialog",[]).controller("MdtoutdoctorAdddialog",function($scope,$modalInstance){$scope.OutsideDoctor={success:!1,data:null},$scope.$watch("OutsideDoctor.success",function(success){success&&$scope.$watch("OutsideDoctor.data",function(success){$modalInstance.close($scope.OutsideDoctor.data)})})}),angular.module("app.loggedIn.mdtoutreferral",["app.loggedIn.mdtoutreferral.directives","app.loggedIn.mdtoutreferral.services"]),angular.module("app.loggedIn.mdtoutreferral.services",[]).factory("mdtoutreferralService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtoutreferral/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.mdtoutreferral.directives",["app.loggedIn.mdtoutreferral.detail.directive","app.loggedIn.mdtoutreferral.search.directive"]),angular.module("app.loggedIn.mdtoutreferral.detail.directive",[]).directive("mdtoutreferralDetail",function(mdtoutreferralModel,mdtDoctorService,mdtOutdoctorService,ConfigService,mdtoutreferralService,toastr,$cookieStore,$state,$stateParams){return{restrict:"EA",scope:{options:"=",params:"=",isClose:"@",itemUpdate:"="},templateUrl:"modules/mdtoutreferral/directives/templates/detail.html",link:function(scope,element,attrs){scope.closePopup=function(){angular.element("#"+scope.isClose).fadeOut()},scope.module_id={doctor:"DoctorModule",referred_doctor:"DoctorReferredModule"},scope.module_id_edit={doctor:"DoctorEditModule",referred_doctor:"DoctorReferredEditModule"},scope.$watch("params.id",function(newId,oldId){scope.params.permission.edit===!0&&"undefined"!=typeof newId&&0!==newId&&mdtoutreferralService.byId(newId).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtoutreferralMap,response.data);
for(var key in scope.mdtoutreferralMap)scope.mdtoutreferralMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtoutreferralMap[key]=scope.mdtoutreferralMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtoutreferralMap[key]=new Date(scope.mdtoutreferralMap[key])),scope.mdtoutreferralMap.last_updated_by=$cookieStore.get("userInfo").id);mdtDoctorService.byId(scope.mdtoutreferralMap.referred_to_doctor).then(function(response){scope.selectedReferredDoctor=response.data}),mdtOutdoctorService.byId(scope.mdtoutreferralMap.doctor_id).then(function(response){scope.selectedDoctor=response.data})})});var init=function(){scope.isSubmit=!1,scope.mdtoutreferralMap=angular.copy(mdtoutreferralModel),scope.mdtoutreferralMap.patient_id=$stateParams.patient_id,scope.mdtoutreferralMap.created_by=$cookieStore.get("userInfo").id,scope.mdtoutreferralMap.last_updated_by=$cookieStore.get("userInfo").id,scope.isClose&&scope.closePopup(),scope.selectedReferredDoctor={NAME:"Select Referred Doctor"},scope.selectedDoctor={name:"Select Doctor"}};init(),scope.clickReferredDoctor=function(){scope.params.permission.edit===!0?angular.element("#"+scope.module_id_edit.referred_doctor).fadeIn():angular.element("#"+scope.module_id.referred_doctor).fadeIn()},scope.selectReferredDoctor=function(row){scope.selectedReferredDoctor=row,scope.params.permission.edit===!0?angular.element("#"+scope.module_id_edit.referred_doctor).fadeOut():angular.element("#"+scope.module_id.referred_doctor).fadeOut()},scope.clickDoctor=function(){scope.params.permission.edit===!0?angular.element("#"+scope.module_id_edit.doctor).fadeIn():angular.element("#"+scope.module_id.doctor).fadeIn()},scope.selectDoctor=function(row){scope.selectedDoctor=row,scope.params.permission.edit===!0?angular.element("#"+scope.module_id_edit.doctor).fadeOut():angular.element("#"+scope.module_id.doctor).fadeOut()},scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtoutreferralForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtoutreferralMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));postData.referred_to_doctor=scope.selectedReferredDoctor.doctor_id,postData.doctor_id=scope.selectedDoctor.doctor_id,postData.last_update_date=ConfigService.getCommonDatetime(new Date),scope.params.permission.edit===!0?mdtoutreferralService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),scope.itemUpdate=!0,toastr.success("Edit Successfully !!!","Success")}):(postData.creation_date=ConfigService.getCommonDatetime(new Date),mdtoutreferralService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init(),scope.itemUpdate=!0}))}}}}}),angular.module("app.loggedIn.mdtoutreferral.search.directive",[]).directive("mdtoutreferralSearch",function(mdtoutreferralService,toastr,ConfigService){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/mdtoutreferral/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"date_issued",value:""},{type:"text",name:"date_started",value:""},{type:"text",name:"duration",value:""}],select:["id","date_issued","date_started","expire_date","duration"]}},loadList=function(){mdtoutreferralService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response;for(var i=0;i<scope.list.data.length;i++)scope.list.data[i].date_issued_map=ConfigService.getCommonDateDefault(scope.list.data[i].date_issued),scope.list.data[i].expire_date_map=ConfigService.getCommonDateDefault(scope.list.data[i].expire_date)})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtprovider",["app.loggedIn.mdtprovider.directives","app.loggedIn.mdtprovider.services"]),angular.module("app.loggedIn.mdtprovider.services",[]).factory("mdtProviderService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtprovider/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.mdtprovider.directives",["app.loggedIn.mdtprovider.detail.directive","app.loggedIn.mdtprovider.search.directive"]),angular.module("app.loggedIn.mdtprovider.detail.directive",[]).directive("mdtproviderDetail",function(mdtProviderModel,ConfigService,mdtProviderService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/mdtprovider/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&mdtProviderService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtProviderMap,response.data);for(var key in scope.mdtProviderMap)scope.mdtProviderMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtProviderMap[key]=scope.mdtProviderMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtProviderMap[key]=new Date(scope.mdtProviderMap[key])))}),scope.mdtProviderMap=angular.copy(mdtProviderModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtproviderForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtProviderMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?mdtProviderService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(mdtProviderService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.mdtprovider.search.directive",[]).directive("mdtproviderSearch",function(mdtProviderService,toastr){return{restrict:"EA",scope:{clickRow:"="},templateUrl:"modules/mdtprovider/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"Provider_types_name",value:""},{type:"text",name:"Isenable",value:""},{type:"text",name:"Created_by",value:""}],select:["Provider_types_name","Isenable","Created_by"]}},loadList=function(){mdtProviderService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtrecall",["app.loggedIn.mdtrecall.directives","app.loggedIn.mdtrecall.services"]),angular.module("app.loggedIn.mdtrecall.services",[]).factory("mdtRecallService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtrecall/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.mdtrecall.directives",["app.loggedIn.mdtrecall.detail.directive","app.loggedIn.mdtrecall.search.directive"]),angular.module("app.loggedIn.mdtrecall.detail.directive",[]).directive("mdtrecallDetail",function(mdtRecallModel,ConfigService,mdtRecallService,toastr){return{restrict:"EA",scope:{options:"=",params:"=",onsuccess:"=",actionCenter:"="},templateUrl:"modules/mdtrecall/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.mdtRecallMap=angular.copy(mdtRecallModel),scope.isSubmit=!1,scope.params.permission.edit===!0?mdtRecallService.byId(scope.params.id).then(function(response){if("error"==response.status)return void toastr.error("Error Get Detail","Error");angular.extend(scope.mdtRecallMap,response.data);for(var key in scope.mdtRecallMap)scope.mdtRecallMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtRecallMap[key]=scope.mdtRecallMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtRecallMap[key]=new Date(scope.mdtRecallMap[key])))}):(scope.mdtRecallMap.transaction_date=new Date,scope.mdtRecallMap.patient_id=scope.params.patient_id,scope.mdtRecallMap.created_by=scope.params.created_by)};init(),scope.setRecallDate=function(){scope.mdtRecallMap.recall_period&&(scope.recall_date_temp=moment(scope.mdtRecallMap.transaction_date).add(scope.mdtRecallMap.recall_period,"months"),scope.mdtRecallMap.recall_date=new Date(scope.recall_date_temp))},scope.actionCenter.updateRecall=function(){mdtRecallService.byId(scope.params.id).then(function(response){if("error"==response.status)return void toastr.error("Error Get Detail","Error");angular.extend(scope.mdtRecallMap,response.data);for(var key in scope.mdtRecallMap)scope.mdtRecallMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtRecallMap[key]=scope.mdtRecallMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtRecallMap[key]=new Date(scope.mdtRecallMap[key])))})},console.log(scope.onsuccess),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtrecallForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtRecallMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?mdtRecallService.edit(scope.params.id,postData).then(function(response){return"error"==response.status?void toastr.error("Error Get Detail","Error"):(scope.onsuccess&&scope.onsuccess(),void toastr.success("Update Successfully !!!","Success"))}):(mdtRecallService.add(postData).then(function(response){return"error"==response.status?void toastr.error("Error Get Detail","Error"):(scope.onsuccess&&scope.onsuccess(),void toastr.success("Insert Successfully !!!","Success"))}),init())}}}}}),angular.module("app.loggedIn.mdtrecall.search.directive",[]).directive("mdtrecallSearch",function(mdtRecallService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/mdtrecall/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"patient_id",value:""},{type:"text",name:"notes",value:""},{type:"text",name:"transaction_date",value:""}],select:["patient_id","notes","transaction_date"]}},loadList=function(){mdtRecallService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtredimedsites",["app.loggedIn.mdtredimedsites.directives","app.loggedIn.mdtredimedsites.services"]),angular.module("app.loggedIn.mdtredimedsites.services",[]).factory("mdtRedimedsitesService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtredimedsites/");return mdtService.list=function(){var funcApi=mdtApi.one("list");return funcApi.get()},mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.mdtredimedsites.directives",["app.loggedIn.mdtredimedsites.detail.directive","app.loggedIn.mdtredimedsites.search.directive"]),angular.module("app.loggedIn.mdtredimedsites.detail.directive",[]).directive("mdtredimedsitesDetail",function(mdtRedimedsitesModel,ConfigService,mdtRedimedsitesService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/mdtredimedsites/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&mdtRedimedsitesService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtRedimedsitesMap,response.data);for(var key in scope.mdtRedimedsitesMap)scope.mdtRedimedsitesMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtRedimedsitesMap[key]=scope.mdtRedimedsitesMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtRedimedsitesMap[key]=new Date(scope.mdtRedimedsitesMap[key])))}),scope.mdtRedimedsitesMap=angular.copy(mdtRedimedsitesModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtredimedsitesForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtRedimedsitesMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?mdtRedimedsitesService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(mdtRedimedsitesService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.mdtredimedsites.search.directive",[]).directive("mdtredimedsitesSearch",function(mdtRedimedsitesService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/mdtredimedsites/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"Site_name",value:""},{type:"text",name:"Site_addr",value:""},{type:"text",name:"postcode",value:""}],select:["Site_name","Site_addr","postcode"]}},loadList=function(){mdtRedimedsitesService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtspecialty",["app.loggedIn.mdtspecialty.directives","app.loggedIn.mdtspecialty.services"]),angular.module("app.loggedIn.mdtspecialty.services",[]).factory("mdtSpecialtyService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdtspecialty/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService.loadWithoutDoctor=function(data){var funcApi=mdtApi.all("loadWithoutDoctor");return funcApi.post({data:data})},mdtService.selectServiceDoctor=function(data){var funcApi=mdtApi.all("selectServiceDoctor");return funcApi.post({data:data})},mdtService.listByServiceDoctor=function(data){var funcApi=mdtApi.all("listByServiceDoctor");return funcApi.post({data:data})},mdtService.active=function(data){var funcApi=mdtApi.all("active");return funcApi.post({data:data})},mdtService.removeServiceDoctor=function(data){var funcApi=mdtApi.all("removeServiceDoctor");return funcApi.post({data:data})},mdtService}),angular.module("app.loggedIn.mdtspecialty.directives",["app.loggedIn.mdtspecialty.detail.directive","app.loggedIn.mdtspecialty.search.directive","app.loggedIn.mdtspecialty.search_by_doctor.directive","app.loggedIn.mdtspecialty.listByDoctor.dialog"]),angular.module("app.loggedIn.mdtspecialty.detail.directive",[]).directive("mdtspecialtyDetail",function(mdtSpecialtyModel,ConfigService,mdtSpecialtyService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/mdtspecialty/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&mdtSpecialtyService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.mdtSpecialtyMap,response.data);for(var key in scope.mdtSpecialtyMap)scope.mdtSpecialtyMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.mdtSpecialtyMap[key]=scope.mdtSpecialtyMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.mdtSpecialtyMap[key]=new Date(scope.mdtSpecialtyMap[key])))}),scope.mdtSpecialtyMap=angular.copy(mdtSpecialtyModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.mdtspecialtyForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.mdtSpecialtyMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?mdtSpecialtyService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(mdtSpecialtyService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.mdtspecialty.search.directive",[]).directive("mdtspecialtySearch",function(mdtSpecialtyService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/mdtspecialty/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"Specialties_name",value:""},{type:"text",name:"Isenable",value:""},{type:"text",name:"Created_by",value:""}],select:["Specialties_name","Isenable","Created_by"]}},loadList=function(){mdtSpecialtyService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.mdtspecialty.search_by_doctor.directive",[]).directive("mdtspecialtySearchbydoctor",function(mdtDoctorService,toastr){return{restrict:"EA",scope:{clickRow:"&",options:"=",doctor:"=",count:"="},templateUrl:"modules/mdtspecialty/directives/templates/searchByDoctor.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"Specialties_name",value:""},{type:"select",name:"RL_TYPE_ID",value:""},{type:"text",name:"cln_specialties.Isenable",value:1}],doctor_id:0}};scope.$watch("doctor",function(newDoctor){"undefined"!=typeof newDoctor.doctor_id&&(init(),scope.params.doctor_id=newDoctor.doctor_id,loadList())});var loadList=function(){mdtDoctorService.specialities(scope.params).then(function(response){scope.list=response,scope.count=response.count},function(error){console.log(error)})};scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()},scope.refresh=function(){loadList()}}}}),angular.module("app.loggedIn.mdtspecialty.listByDoctor.dialog",[]).directive("mdtspecialtyListbydoctor",function($modal,mdtSpecialtyService,toastr){return{restrict:"EA",scope:{limit:"=",reload:"=",doctorId:"=",onRowClick:"&"},templateUrl:"modules/mdtspecialty/dialogs/templates/listDoctor.html",link:function(scope,elem,attrs){var search={page:1,limit:scope.limit,offset:0,max_size:5,Specialties_name:"",Creation_date:"desc",doctor_id:scope.doctorId},load=function(){var postData=angular.copy(scope.speciality.search);mdtSpecialtyService.loadWithoutDoctor(postData).then(function(response){scope.speciality.list=response.data,scope.speciality.count=response.count})},onSearch=function(){scope.speciality.search.offset=0,scope.speciality.load(),scope.speciality.search.page=1},onOrderBy=function(option){switch(option.field){case"Creation_date":scope.speciality.search.Creation_date=option.order}scope.speciality.load()},remove=function(list){$modal.open({templateUrl:"dialogAlertRemove",controller:"AlertRemoveDialog",size:"sm",resolve:{list:function(){return list}}}).result.then(function(list){AlertModel.remove(list).then(function(response){toastr.success("Delete Successfully"),scope.speciality.load()},function(error){})})},edit=function(list){$modal.open({templateUrl:"dialogAlertEdit",controller:"AlertEditDialog",size:"lg",resolve:{list:function(){return list}}}).result.then(function(response){"success"===response&&(toastr.success("Edit Successfully"),scope.speciality.load())})},onPage=function(page){scope.speciality.search.offset=(page-1)*scope.speciality.search.limit,scope.speciality.load()};scope.speciality={dialog:{remove:function(list){remove(list)},edit:function(list){edit(list)}},search:angular.copy(search),load:function(){load()},list:[],onSearch:function(){onSearch()},onOrderBy:function(option){onOrderBy(option)},onPage:function(page){onPage(page)}},scope.speciality.load(),scope.$watch("reload",function(reload){reload&&(scope.speciality.search=angular.copy(search),scope.speciality.load())})}}}),angular.module("app.loggedIn.timetable_old",["app.loggedIn.timetable.directives","app.loggedIn.timetable.services"]),angular.module("app.loggedIn.timetable.services",[]).factory("mdtTimetableService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/mdttimetable/");return mdtService.byDoctor=function(doctor_id){var funcApi=mdtApi.all("byDoctor");return funcApi.post({doctor_id:doctor_id})},mdtService.showWeek=function(doctor_id,cal_header_df_id){var funcApi=mdtApi.all("showWeek");return funcApi.post({doctor_id:doctor_id,cal_header_df_id:cal_header_df_id})},mdtService.addSite=function(doctor_id,cal_header_df_id,content){var funcApi=mdtApi.all("addSite");return funcApi.post({doctor_id:doctor_id,cal_header_df_id:cal_header_df_id,content:content})},mdtService.add=function(timetable,doctor_id){var funcApi=mdtApi.all("add");return funcApi.post({timetable:timetable,doctor_id:doctor_id})},mdtService.addRow=function(data){var funcApi=mdtApi.all("addRow");return funcApi.post(data)},mdtService.generate=function(doctor_id,interval,clinical_id){var funcApi=mdtApi.all("generate");return funcApi.post({doctor_id:doctor_id,interval:interval,clinical_id:clinical_id})},mdtService.remove=function(cal_id){var funcApi=mdtApi.all("remove");return funcApi.post({cal_id:cal_id})},mdtService.timetableRemove=function(cal_header_df_id){var funcApi=mdtApi.all("timetableRemove");return funcApi.post({cal_header_df_id:cal_header_df_id})},mdtService}),angular.module("app.loggedIn.timetable.directives",["app.loggedIn.timetable.main.directive"]),angular.module("app.loggedIn.timetable.main.directive",[]).directive("timetableGenerate",function(mdtTimetableService,mdtDoctorService,sysServiceService,mdtRedimedsitesService,ConfigService,toastr,$timeout){return{restrict:"EA",scope:{options:"=",doctorId:"="},templateUrl:"modules/mdttimetable/directives/templates/timetable.html",link:function(scope,element,attrs){scope.selectedDoctor={},scope.removeTimetable=function(data){mdtTimetableService.timetableRemove(data.cal_header_df_id).then(function(data){toastr.success("Remove Successfully"),init()})},mdtDoctorService.byId(scope.doctorId).then(function(response){scope.selectedDoctor=response.data,sysServiceService.byClinicalDepartment(response.data.CLINICAL_DEPT_ID).then(function(response){scope.options.clinical_depts=response.data})});var init=function(){scope.timetable_list=[],scope.selectedCalHeader=[],scope.selectedCalHeaderId=0,mdtTimetableService.byDoctor(scope.doctorId).then(function(response){for(var i=0;i<scope.options.timetable_dow.length;i++){scope.timetable_list.push({dow:scope.options.timetable_dow[i].code,data:[]}),"undefined"!=typeof response.data[i]&&(scope.timetable_list[i].doctor_id=response.data[i].doctor_id);for(var j=0;j<response.data.length;j++)response.data[j].day_of_Week===scope.options.timetable_dow[i].code&&(scope.timetable_list[i].data.push(response.data[j]),scope.timetable_list[i].cal_header_df_id=response.data[j].cal_header_df_id)}for(var i=0;i<scope.timetable_list.length;i++)if(0==scope.timetable_list[i].data.length)scope.timetable_list[i].data.push({from_time_display:"00:00",to_time_display:"00:00",isexists:!1});else for(var j=0;j<scope.timetable_list[i].data.length;j++)scope.timetable_list[i].data[j].from_time_display=ConfigService.convertToTimeString(scope.timetable_list[i].data[j].from_time),scope.timetable_list[i].data[j].to_time_display=ConfigService.convertToTimeString(scope.timetable_list[i].data[j].to_time),scope.timetable_list[i].data[j].isexists=!0})};init(),scope.clickInput=function(option){"add"===option.type?scope.timetable_list[option.pindex].data.push({from_time_display:"00:00",to_time_display:"00:00",isexists:!1}):"remove"===option.type&&scope.timetable_list[option.pindex].data.splice(option.index,1)},scope.clickInputCalHeader=function(option){"add"===option.type?scope.selectedCalHeader.push({week_ord_of_month:"2",site_id:"0",isexists:!1}):"remove"===option.type&&scope.selectedCalHeader.splice(option.index,1)},scope.saveCalHeader=function(){mdtTimetableService.addSite(scope.doctorId,scope.selectedCalHeaderId,scope.selectedCalHeader).then(function(response){toastr.success("Saving State Successful"),init()})},scope.saveTimetable=function(option){mdtTimetableService.add(scope.timetable_list[option.pindex],scope.doctorId).then(function(response){toastr.success("Saving Timetable Successful"),init()})},scope.saveNewTimetable=function(data,pindex){data.dow=scope.timetable_list[pindex].dow,mdtTimetableService.add(data,scope.doctorId).then(function(response){toastr.success("Saving Timetable Successful"),init()})},scope.showState=function(data){data.cal_header_df_id?(scope.selectedCalHeaderId=data.cal_header_df_id,scope.selectedCalHeader=[],mdtTimetableService.showWeek(scope.doctorId,data.cal_header_df_id).then(function(response){if(response.data.length>0){scope.selectedCalHeader=response.data;for(var i=0;i<scope.selectedCalHeader.length;i++)scope.selectedCalHeader[i].isexists=!0}else scope.selectedCalHeader.push({week_ord_of_month:0,site_id:0,isexists:!1})})):(scope.selectedCalHeader=[],scope.selectedCalHeader.push({week_ord_of_month:0,site_id:0,isexists:!1}))},scope.generate=function(){mdtTimetableService.generate(scope.selectedDoctor.doctor_id,scope.selectedDoctor.Appt_interval,scope.selectedDoctor.CLINICAL_DEPT_ID).then(function(response){toastr.success("Generate Timetable Successfully")})}}}}),angular.module("app.loggedIn.medicine",["app.loggedIn.medicine.controller","app.loggedIn.medicine.service","app.loggedIn.medicine.directive"]).config(function($stateProvider){$stateProvider.state("loggedIn.medicine",{url:"/medicine","abstract":!0,templateUrl:"modules/medicine/views/structure.html",controller:"MedicineController"}).state("loggedIn.medicine.list",{url:"/list",views:{"main-content":{templateUrl:"modules/medicine/views/list.html",controller:"MedicineListController"}}})}),angular.module("app.loggedIn.medicine.controller",["app.loggedIn.medicine.list.controller"]).controller("MedicineController",function(){}),angular.module("app.loggedIn.medicine.list.controller",[]).controller("MedicineListController",function($scope){$scope.medicine_panel={},$scope.medicine={select:0,scope:$scope.patient_panel,options:{api:"api/erm/v2/medicine/search",method:"post",scope:$scope.medicine_panel,columns:[{field:"medicine_id",is_hide:!0},{field:"medicine_name",label:"Medicine Name"},{field:"medicine_price",label:"Price per unit"}],use_filters:!0,filters:{medicine_name:{type:"text"}},use_actions:!0,actions:[{"class":"fa fa-info",title:"Edit",callback:function(item){console.log("this is selected item",item),$scope.medicine.id=item.medicine_id,$scope.medicineEditForm.open()}}]}},$scope.medicineAddForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.medicine_panel.reload(),$scope.medicineAddForm.close()}},$scope.medicineEditForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.medicine_panel.reload(),$scope.medicineEditForm.close()}}}),angular.module("app.loggedIn.medicine.service",[]).factory("MedicineService",function(Restangular,ConfigService,$state){var instanceService={},v2_api=Restangular.all("api/erm/v2");return instanceService.insert=function(postData){var detailApi=v2_api.all("medicine/insert");return detailApi.post(postData)},instanceService.detail=function(postData){var detailApi=v2_api.all("medicine/detail");return detailApi.post({ID:postData})},instanceService.update=function(postData){var detailApi=v2_api.all("medicine/update");return detailApi.post(postData)},instanceService}),angular.module("app.loggedIn.medicine.directive",["app.loggedIn.medicine.detail.directive"]),angular.module("app.loggedIn.medicine.detail.directive",[]).directive("medicineDetail",function(MedicineModel,MedicineService,ConfigService,toastr){return{restrict:"EA",scope:{data:"@",options:"=",onsuccess:"=onsuccess"},templateUrl:"modules/medicine/directives/templates/detail.html",link:function(scope,element,attrs){scope.medicine_unit_options=ConfigService.medicine_unit_option();var loadData=function(id){MedicineService.detail(id).then(function(data){angular.extend(scope.modelObjectMap,data.data),ConfigService.autoConvertData(scope.modelObjectMap)})};if(scope.modelObjectMap=angular.copy(MedicineModel),scope.mode={type:"add",text:"Add medicine"},scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit referral"})}var addProcess=function(postData){MedicineService.insert(postData).then(function(response){"success"===response.status&&(toastr.success("Medicine added","Success"),scope.modelObjectMap=angular.copy(MedicineModel),
scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})},editProcess=function(postData){MedicineService.update(postData).then(function(response){"success"===response.status&&(toastr.success("Edit referral Successfully","Success"),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.menu",["app.loggedIn.menu.controller","app.loggedIn.menu.services"]).config(function($stateProvider){$stateProvider.state("loggedIn.menu",{url:"/menus",templateUrl:"modules/menu/views/menu.html",controller:"MenuController"})}),angular.module("app.loggedIn.menu.services",[]).factory("MenuService",function(Restangular){var menuService={},api=Restangular.all("api");return menuService.menuRootList=function(){var menuList=api.one("menu/list/root");return menuList.get()},menuService.menuList=function(id){var list=api.all("menu/list/id");return list.post({id:id})},menuService.functionList=function(){var functionList=api.one("function/list");return functionList.get()},menuService.insertMenu=function(info){var insert=api.all("menu/new");return insert.post({info:info})},menuService.editMenu=function(info){var edit=api.all("menu/edit");return edit.post({info:info})},menuService.menuInfo=function(id){var info=api.all("menu/id");return info.post({id:id})},menuService.deleteRootMenu=function(id){var a=api.all("menu/delete");return a.post({id:id,isRoot:!0})},menuService.deleteMenu=function(id){var a=api.all("menu/delete");return a.post({id:id,isRoot:!1})},menuService}),angular.module("app.loggedIn.menu.controller",[]).controller("MenuController",function($scope,$modal,$state,$filter,ngTableParams,MenuService,$http,toastr){$scope.functionList=[],$scope.data=[],$scope.data1=[],$scope.isSelected=!1,$scope.selectedId=null,$scope.tableParams2=new ngTableParams({page:1,count:25},{total:$scope.data1.length,getData:function($defer,params){var orderedData=params.sorting()?$filter("orderBy")($scope.data1,params.orderBy()):$scope.data1;orderedData=params.filter()?$filter("filter")(orderedData,params.filter()):orderedData,params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),MenuService.menuRootList().then(function(data){MenuService.functionList().then(function(data){$scope.functionList=data}),$scope.data=data,$scope.tableParams=new ngTableParams({page:1,count:10},{total:$scope.data.length,getData:function($defer,params){var orderedData=params.sorting()?$filter("orderBy")($scope.data,params.orderBy()):$scope.data;orderedData=params.filter()?$filter("filter")(orderedData,params.filter()):orderedData,params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.showChild=function(m){$scope.childTitle=m.description,$scope.selectedId=m.menu_id,$scope.isSelected=!0,$scope.data1=[],MenuService.menuList(m.menu_id).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})},$scope.addNewMenu=function(){var modalInstance=$modal.open({templateUrl:"modules/menu/views/menuDetails.html",controller:"NewMenuController",size:"md",resolve:{isSub:function(){return!1},parentId:function(){return null}}});$scope.data=[],modalInstance.result.then(function(){MenuService.menuRootList().then(function(data){$scope.data=data,$scope.$watch("data",function(data){$scope.tableParams.reload()})})})},$scope.editMenu=function(m){$scope.showChild(m);var modalInstance=$modal.open({templateUrl:"modules/menu/views/menuDetails.html",controller:"EditMenuController",size:"md",resolve:{menuId:function(){return m.menu_id},isSub:function(){return!1}}});$scope.data=[],modalInstance.result.then(function(){MenuService.menuRootList().then(function(data){$scope.data=data,$scope.$watch("data",function(data){$scope.tableParams.reload()})})})},$scope.deleteRootMenu=function(m){MenuService.deleteRootMenu(m.menu_id).then(function(data){"success"===data.status?(toastr.success("Delete Menu Successfully!","Success"),$scope.data=[],MenuService.menuRootList().then(function(data){$scope.data=data,$scope.$watch("data",function(data){$scope.tableParams.reload()})}),$scope.selectedId=null):toastr.error("Delete Menu Failed!","Error")})},$scope.deleteSubMenu=function(m){MenuService.deleteMenu(m.menu_id).then(function(data){"success"===data.status?(toastr.success("Delete Menu Successfully!","Success"),$scope.data1=[],MenuService.menuList($scope.selectedId).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})):toastr.error("Delete Menu Failed!","Error")})},$scope.addNewSubMenu=function(){var modalInstance=$modal.open({templateUrl:"modules/menu/views/menuDetails.html",controller:"NewMenuController",size:"md",resolve:{isSub:function(){return!0},parentId:function(){return $scope.selectedId}}});modalInstance.result.then(function(){$scope.data1=[],MenuService.menuList($scope.selectedId).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})})},$scope.editSubMenu=function(m){var modalInstance=$modal.open({templateUrl:"modules/menu/views/menuDetails.html",controller:"EditMenuController",size:"md",resolve:{menuId:function(){return m.menu_id},isSub:function(){return!0}}});modalInstance.result.then(function(){$scope.data1=[],MenuService.menuList($scope.selectedId).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})})}}).controller("NewMenuController",function($scope,$filter,$state,$modalInstance,MenuService,isSub,parentId,toastr){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.info={MenuDescription:null,MenuDefinition:null,MenuType:null,MenuEnable:"1",MenuWeb:"1",MenuMobile:null,FunctionID:null,ParentID:parentId},$scope.isSub=isSub,1==$scope.isSub&&MenuService.functionList().then(function(data){$scope.functionList=data}),$scope.submitMenu=function(menuForm){$scope.showClickedValidation=!0,menuForm.$invalid?toastr.error("Please Input All Required Information!","Error"):MenuService.insertMenu($scope.info).then(function(data){"success"===data.status?(toastr.success("Insert New Menu Successfully!","Success"),$modalInstance.close()):toastr.error("Insert New Menu Failed!","Error")})}}).controller("EditMenuController",function($scope,$filter,$state,$modalInstance,MenuService,isSub,menuId,toastr){$scope.cancel=function(){$modalInstance.dismiss("cancel")},console.log(menuId),$scope.isSub=isSub,1==$scope.isSub&&MenuService.functionList().then(function(data){$scope.functionList=data}),$scope.info={MenuID:null,MenuDescription:null,MenuDefinition:null,MenuEnable:null,MenuWeb:null,MenuMobile:null,MenuType:null,FunctionID:null},MenuService.menuInfo(menuId).then(function(data){$scope.info.MenuID=data.menu_id,$scope.info.MenuDescription=data.description,$scope.info.MenuDefinition=data.definition,$scope.info.MenuEnable=1==data.isEnable?"1":"0",$scope.info.MenuWeb=1==data.isWeb?"1":"0",$scope.info.MenuMobile=1==data.isMobile?"1":"0",$scope.info.MenuType=data.type,$scope.info.FunctionID=null!=data.function_id||""!=data.function_id?data.function_id:null}),$scope.submitMenu=function(menuForm){$scope.showClickedValidation=!0,menuForm.$invalid?toastr.error("Please Input All Required Information!","Error"):MenuService.editMenu($scope.info).then(function(data){"success"===data.status?(toastr.success("Edit Menu Successfully!","Success"),$modalInstance.close()):toastr.error("Edit Menu Failed!","Error")})}}),angular.module("app.loggedIn.booking",["app.loggedIn.booking.make.controller","app.loggedIn.booking.list.controller","app.loggedIn.booking.package.controller","app.loggedIn.booking.position.controller","app.loggedIn.booking.setting.controller","app.loggedIn.booking.services"]).config(function($stateProvider){$stateProvider.state("loggedIn.makeBooking",{url:"/onlineBooking/make",templateUrl:"modules/onlineBooking/views/makeBooking.html",controller:"MakeBookingController"}).state("loggedIn.bookingList",{url:"/onlineBooking/booking",templateUrl:"modules/onlineBooking/views/booking.html",controller:"BookingListController"}).state("loggedIn.package",{url:"/onlineBooking/package",templateUrl:"modules/onlineBooking/views/package.html",controller:"PackageController"}).state("loggedIn.position",{url:"/onlineBooking/position",templateUrl:"modules/onlineBooking/views/position.html",controller:"PositionController"}).state("loggedIn.setting",{url:"/onlineBooking/setting",templateUrl:"modules/onlineBooking/views/settings.html",controller:"SettingController"}).state("loggedIn.newUser",{url:"/onlineBooking/setting/newUser",templateUrl:"modules/onlineBooking/views/newUser.html",controller:"NewUserController"}).state("loggedIn.editUser",{url:"/onlineBooking/setting/editUser/:id",templateUrl:"modules/onlineBooking/views/newUser.html",controller:"EditUserController"})}),angular.module("app.loggedIn.booking.make.controller",[]).controller("MakeBookingController",function($scope,$state,$modal,$filter,ngTableParams,OnlineBookingService,$http,toastr,$cookieStore,$timeout){var companyInfo,userInfo;"undefined"!=typeof $cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo")),"undefined"!=typeof $cookieStore.get("userInfo")&&(userInfo=$cookieStore.get("userInfo")),$scope.companyName=null===companyInfo.Company_name?"":companyInfo.Company_name,$scope.companyList=[],$scope.packageList=[],$scope.data=[];var mPO,mResult,mInvoice,mIsProject;$scope.c={SubCompanyId:"",PO_number:"",result_email:"",invoice_email:"",Project:"",Comment:"",PackId:"",isProject:null==companyInfo.isProject?0:companyInfo.isProject},OnlineBookingService.deleteAllPending(),$scope.c=companyInfo,mPO=companyInfo.PO_number,mResult=companyInfo.result_email,mInvoice=companyInfo.invoice_email,mIsProject=companyInfo.isProject,null!=$scope.data&&($scope.tableParams=new ngTableParams({page:1,count:20},{counts:[],total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})),OnlineBookingService.getSubCompany(companyInfo.id).then(function(response){"success"===response.status&&($scope.companyList=response.rs)}),OnlineBookingService.getPackage(companyInfo.id).then(function(data){"success"===data.status&&($scope.packageList=data.rs,$scope.packageList.push({PackId:-1,package_name:"Custom Package"}))});var arrCustomAss=[],period=null;$scope.packageChange=function(PackId){var arrAss=[];if(null!==PackId)if(-1==PackId){$scope.packAss=[];var modalInstance=$modal.open({templateUrl:"modules/onlineBooking/views/customPackage.html",controller:"CustomPackageController",size:"md"});modalInstance.result.then(function(data){for(var i=0;i<data.length;i++)arrAss.push({head_name:null==data[i].HeaderName||""==data[i].HeaderName?"":data[i].HeaderName,ass_name:data[i].ass_name}),arrCustomAss.push({ass_id:data[i].ass_id,ass_name:data[i].ass_name});$scope.packAss=_.groupBy(arrAss,"head_name"),$scope.newCandidate()},function(err){console.log(err)})}else{arrCustomAss=[],OnlineBookingService.getPackageAssById(PackId).then(function(data){if("success"===data.status){for(var i=0;i<data.rs.length;i++)arrAss.push({head_name:null==data.rs[i].HeaderName||""==data.rs[i].HeaderName?"":data.rs[i].HeaderName,ass_name:data.rs[i].ass_name});$scope.packAss=_.groupBy(arrAss,"head_name")}});for(var i=0;i<$scope.packageList.length;i++)PackId===$scope.packageList[i].PackId&&(period=$scope.packageList[i].period);$scope.newCandidate()}else $scope.packAss=[]},$scope.subChange=function(subId){null!==subId&&OnlineBookingService.getSubCompanyInfo(subId).then(function(data){$scope.c.SubCompanyId=data.id,$scope.c.PO_number=data.PO_number,$scope.c.result_email=data.result_email,$scope.c.invoice_email=data.invoice_email,$scope.c.isProject=null==data.isProject?0:data.isProject}),null===subId&&($scope.c.PO_number=mPO,$scope.c.result_email=mResult,$scope.c.invoice_email=mInvoice,$scope.c.isProject=mIsProject)},$scope.newCandidate=function(){if(null==$scope.c.PackId)toastr.error("Please Choose A Package First!","Error");else{var modalInstance=$modal.open({templateUrl:"modules/onlineBooking/views/newCandidate.html",controller:"NewCandidateController",size:"md",resolve:{companyId:function(){return companyInfo.id},editInfo:function(){return null},period:function(){return period},status:function(){return null==companyInfo.default_status||""==companyInfo.default_status?"Pending":companyInfo.default_status}}});modalInstance.result.then(function(candidateInfo){$scope.data.push(candidateInfo),$scope.tableParams.reload()},function(err){console.log(err)})}},$scope.editCandidate=function(b){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking/views/newCandidate.html",controller:"NewCandidateController",size:"md",resolve:{companyId:function(){return companyInfo.id},editInfo:function(){return b},period:function(){return period},status:function(){return null==companyInfo.default_status||""==companyInfo.default_status?"Pending":companyInfo.default_status}}});modalInstance.result.then(function(candidateInfo){var index=$scope.data.indexOf(b);$scope.data[index]=candidateInfo,$scope.tableParams.reload()},function(err){console.log(err)})},$scope.deleteCandidate=function(b){OnlineBookingService.deletePending(b).then(function(data){if("success"==data.status){var index=$scope.data.indexOf(b);index>-1&&$scope.data.splice(index,1),$scope.tableParams.reload()}else toastr.error("Delete Failed!","Error")})},$scope.submitBooking=function(bookingForm){$scope.headInfo={PO_number:$scope.c.PO_number,result_email:$scope.c.result_email,invoice_email:$scope.c.invoice_email,ProjectIdentification:$scope.c.Project,Comment:$scope.c.Comment,PackageId:$scope.c.PackId,CompanyId:null==companyInfo.father_id?companyInfo.id:companyInfo.father_id,Booking_Person:userInfo.Booking_Person,contact_number:userInfo.Contact_number,subCompany_Id:null==$scope.c.SubCompanyId?null:$scope.c.SubCompanyId,contact_email:userInfo.Contact_email,arrCustomAss:arrCustomAss.length<=0?null:arrCustomAss},$scope.showClickedValidation=!0,bookingForm.$invalid?toastr.error("Please Input All Required Information!","Error"):$scope.data.length<=0?toastr.error("Please Add Some Candidate For Booking!","Error"):OnlineBookingService.submitBook($scope.data,$scope.headInfo).then(function(data){"success"===data.status?(toastr.success("Submit Booking Successfully!","Success"),$state.go("loggedIn.makeBooking",null,{reload:!0})):"error"===data.status&&toastr.error("Submit Booking Failed!","Error")})}}).controller("CustomPackageController",function($scope,$state,$modalInstance,OnlineBookingService,OnlineBookingAdminService,toastr){$scope.info={checkedAss:[]},OnlineBookingAdminService.getAssessment().then(function(data){$scope.assList=data}),$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.okClick=function(){OnlineBookingService.customPackage($scope.info.checkedAss).then(function(data){$modalInstance.close(data)})}}).controller("NewCandidateController",function($scope,$filter,$state,$modalInstance,OnlineBookingService,companyId,editInfo,period,status,toastr){if($scope.info={siteId:null,fromDate:null,toDate:null,calId:null,candidateName:null,dob:null,position:null,phone:null,email:null,stateId:null,suburbId:null,stateName:null,suburbName:null},$scope.siteList=[],$scope.calList=[],$scope.positionList=[],$scope.cancel=function(){$modalInstance.dismiss("cancel")},null!==editInfo&&($scope.info=editInfo,console.log($scope.info),null!=$scope.info.stateId&&OnlineBookingService.getSiteState($scope.info.siteId).then(function(data){$scope.stateList=data}),null!=$scope.info.suburbId&&OnlineBookingService.getStateSuburb($scope.info.stateId).then(function(data){$scope.suburbList=data})),"undefined"!=typeof $scope.info.siteId&&null!==$scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate){var id=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd");OnlineBookingService.getCalendar(id,from,to).then(function(data){$scope.calList=data})}OnlineBookingService.getSite().then(function(data){$scope.siteList=data}),OnlineBookingService.getPositionList(companyId).then(function(data){$scope.positionList=data}),$scope.minDate=new Date,$scope.maxDate=new Date,$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.haveState=!1,$scope.haveSuburb=!1,$scope.siteChange=function(){if("undefined"!=typeof $scope.info.siteId&&null!==$scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate){$scope.info.stateId=null,$scope.info.suburbId=null;var id=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd");OnlineBookingService.getSiteState(id).then(function(data){null!=data&&data.length>0?($scope.calList=[],$scope.info.appointmentTime="",$scope.haveState=!0,$scope.stateList=data):($scope.haveState=!1,$scope.haveSuburb=!1,OnlineBookingService.getCalendar(id,from,to).then(function(data){$scope.calList=data}))})}else $scope.info.stateId=null,$scope.info.suburbId=null,$scope.haveState=!1,$scope.haveSuburb=!1,$scope.calList=[],$scope.info.appointmentTime=""},$scope.siteStateChange=function(id){null!=id?($scope.info.suburbId=null,$scope.suburbList=[],OnlineBookingService.getStateSuburb(id).then(function(data){null!=data&&data.length>0&&($scope.haveSuburb=!0,$scope.suburbList=data)})):($scope.info.suburbId=null,$scope.haveSuburb=!1)},$scope.fromDateChange=function(){if("undefined"!=typeof $scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate){var id=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd");OnlineBookingService.getCalendar(id,from,to).then(function(data){$scope.calList=data})}else $scope.calList=[],$scope.info.appointmentTime=""},$scope.toDateChange=function(){if("undefined"!=typeof $scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate){var id=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd");OnlineBookingService.getCalendar(id,from,to).then(function(data){$scope.calList=data})}else $scope.calList=[],$scope.info.appointmentTime=""},$scope.submitCandidate=function(candidateForm){if($scope.showClickedValidation=!0,candidateForm.$invalid)toastr.error("Please Input All Required Information!","Error");else{if($scope.candidateInfo={siteId:"",fromDate:"",toDate:"",calId:"",candidateName:"",dob:"",position:"",phone:"",email:"",siteName:"",submitDate:"",displayDate:"",stateId:"",suburbId:"",stateName:"",suburbName:"",calId2:null,calId3:null,calId4:null,calId5:null,status:status,candidateId:null},$scope.candidateInfo.candidateName=$scope.info.candidateName,$scope.candidateInfo.dob=$filter("date")($scope.info.dob,"yyyy-MM-dd"),$scope.candidateInfo.position=$scope.info.position,$scope.candidateInfo.phone=$scope.info.phone,$scope.candidateInfo.email=$scope.info.email,$scope.candidateInfo.siteId=$scope.info.siteId,$scope.candidateInfo.fromDate=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),$scope.candidateInfo.toDate=$filter("date")($scope.info.toDate,"yyyy-MM-dd"),$scope.candidateInfo.calId=$scope.info.calId,$scope.candidateInfo.stateId=$scope.info.stateId,$scope.candidateInfo.suburbId=$scope.info.suburbId,"undefined"!=typeof $scope.stateList||null!=$scope.stateList)for(var i=0;i<$scope.stateList.length;i++)$scope.info.stateId==$scope.stateList[i].state_id&&($scope.candidateInfo.stateName=$scope.stateList[i].state_name);if("undefined"!=typeof $scope.suburbList||null!=$scope.suburbList)for(var i=0;i<$scope.suburbList.length;i++)$scope.info.suburbId==$scope.suburbList[i].suburb_id&&($scope.candidateInfo.suburbName=$scope.suburbList[i].suburb_name);if($scope.candidateInfo.stateId=$scope.info.stateId,$scope.candidateInfo.suburbId=$scope.info.suburbId,"undefined"!=typeof $scope.stateList||null!=$scope.stateList)for(var i=0;i<$scope.stateList.length;i++)$scope.info.stateId==$scope.stateList[i].state_id&&($scope.candidateInfo.stateName=$scope.stateList[i].state_name);if("undefined"!=typeof $scope.suburbList||null!=$scope.suburbList)for(var i=0;i<$scope.suburbList.length;i++)$scope.info.suburbId==$scope.suburbList[i].suburb_id&&($scope.candidateInfo.suburbName=$scope.suburbList[i].suburb_name);null!==$scope.info.calId&&OnlineBookingService.getAppointmentTime($scope.info.calId).then(function(data){var submitDate=$filter("date")(data[0].From_time,"yyyy-MM-dd HH:mm:ss"),displayDate=$filter("date")(data[0].From_time,"dd/MM/yyyy HH:mm:ss");$scope.candidateInfo.submitDate=submitDate,$scope.candidateInfo.displayDate=displayDate});for(var i=0;i<$scope.siteList.length;i++)$scope.info.siteId===$scope.siteList[i].id&&($scope.candidateInfo.siteName=$scope.siteList[i].Site_name);for(var i=0;i<$scope.calList.length;i++)$scope.candidateInfo.calId==$scope.calList[i].cal_id&&(2==period?$scope.candidateInfo.calId2=$scope.calList[i+1].cal_id:3==period&&($scope.candidateInfo.calId2=$scope.calList[i+1].cal_id,$scope.candidateInfo.calId3=$scope.calList[i+2].cal_id));OnlineBookingService.pendingCalendar($scope.candidateInfo).then(function(data){"success"==data.status?($scope.candidateInfo.candidateId=data.newCanId,$modalInstance.close($scope.candidateInfo)):toastr.error("Submit Error!","Error")})}}}),angular.module("app.loggedIn.booking.list.controller",[]).controller("BookingListController",function($scope,$modal,$filter,ngTableParams,OnlineBookingService,$http,toastr,$cookieStore){var companyInfo;$scope.selectedCanId=null,$scope.selectedBookId=null,$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.cId=null,$scope.isExtra=0,"undefined"!==$cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo"),$scope.cId=companyInfo.id,$scope.isExtra=1==companyInfo.isExtra?1:0),OnlineBookingService.getBookingList(companyInfo.id).then(function(data){"success"===data.status&&($scope.data=data.rs,$scope.tableParams=new ngTableParams({page:1,count:10},{total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}))}),$scope.bookingSelected=function(b){$scope.selectedCanId=b.Candidate_id,$scope.selectedBookId=b.Booking_id},$scope.openDetail=function(b){$modal.open({templateUrl:"modules/onlineBooking/views/bookingDetailModal.html",controller:"BookingDetailController",size:"lg",resolve:{bookingId:function(){return b.Booking_id},candidateId:function(){return b.Candidate_id}}})},$scope.cancelBooking=function(b){$modal.open({templateUrl:"modules/onlineBooking/views/confirmCancel.html",controller:"CancelController",size:"md",resolve:{bookingId:function(){return b.Booking_id}}})},$scope.changeBookingTime=function(b){$modal.open({templateUrl:"modules/onlineBooking/views/changeBookingTime.html",controller:"ChangeBookingController",size:"md",resolve:{bookingId:function(){return b.Booking_id}}})},$scope.searchModal=function(){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking/views/searchBookingModal.html",controller:"SearchBookingController",size:"md",resolve:{companyId:function(){return companyInfo.id}}});modalInstance.result.then(function(data){$scope.data=data,$scope.$watch("data",function(data){$scope.data=data,$scope.tableParams.reload()})})},$scope.updateNote=function(b){var a={bookingId:b.Booking_id,candidateId:b.Candidate_id,note:b.Appointment_notes};OnlineBookingService.updateNote(a).then(function(data){"success"===data.status?toastr.success("Edit Successfully!","Success"):toastr.error("Edit Failed!","Error")})}}).controller("SearchBookingController",function($scope,$modalInstance,OnlineBookingService,companyId){$scope.minDate=new Date,$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.info={companyId:companyId,companyName:null,candidateName:null,fromDate:null,toDate:null,bookingPerson:null,status:null,siteName:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.search=function(){OnlineBookingService.searchBooking($scope.info).then(function(data){$modalInstance.close(data)})},$scope.reset=function(){OnlineBookingService.getBookingList(companyId).then(function(data){$modalInstance.close(data.rs)})}}).controller("BookingDetailController",function($scope,$modalInstance,OnlineBookingService,bookingId,candidateId){$scope.cancel=function(){$modalInstance.dismiss("cancel")},OnlineBookingService.getBookingDetail(bookingId,candidateId).then(function(data){var arrAss=[];$scope.detail=data.rs[0],"undefined"!=typeof data.rs[0].package_id&&OnlineBookingService.getPackageAssById(data.rs[0].package_id).then(function(data){if("success"===data.status){for(var i=0;i<data.rs.length;i++)arrAss.push({head_name:data.rs[i].HeaderName,ass_name:data.rs[i].ass_name});$scope.detail.ass=_.groupBy(arrAss,"head_name")}})})}).controller("CancelController",function($scope,$state,$modalInstance,OnlineBookingService,bookingId){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.okClick=function(){OnlineBookingService.cancelBooking(bookingId).then(function(data){"success"===data.status?($modalInstance.dismiss("cancel"),$state.go("loggedIn.bookingList",null,{reload:!0})):alert("Failed")})}}).controller("ChangeBookingController",function($scope,$filter,$state,$modalInstance,OnlineBookingService,toastr,bookingId){$scope.info={siteId:"",fromDate:"",toDate:"",calId:"",appointmentTime:"",submitTime:""},$scope.siteList=[],$scope.calList=[],$scope.cancel=function(){$modalInstance.dismiss("cancel")},OnlineBookingService.getSite().then(function(data){$scope.siteList=data}),$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.siteChange=function(){if("undefined"!=typeof $scope.info.siteId&&null!==$scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate){var id=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd");OnlineBookingService.getCalendar(id,from,to).then(function(data){$scope.calList=data})}else $scope.calList=[],$scope.info.appointmentTime=""},$scope.fromDateChange=function(){if("undefined"!=typeof $scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate){var id=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd");OnlineBookingService.getCalendar(id,from,to).then(function(data){$scope.calList=data})}else $scope.calList=[],$scope.info.appointmentTime=""},$scope.toDateChange=function(){if("undefined"!=typeof $scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate){var id=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd");OnlineBookingService.getCalendar(id,from,to).then(function(data){$scope.calList=data})}else $scope.calList=[],$scope.info.appointmentTime=""},$scope.calChange=function(){if(null!==$scope.info.calId&&"undefined"!=typeof $scope.info.calId){var calId=$scope.info.calId;OnlineBookingService.getAppointmentTime(calId).then(function(data){var date=$filter("date")(data[0].From_time,"dd/MM/yyyy HH:mm:ss"),submitDate=$filter("date")(data[0].From_time,"yyyy-MM-dd HH:mm:ss");$scope.info.appointmentTime=date,$scope.info.submitTime=submitDate})}else $scope.info.appointmentTime=""},$scope.submit=function(){if(null!==$scope.info.siteId&&"undefined"!=typeof $scope.info.fromDate&&"undefined"!=typeof $scope.info.toDate&&null!==$scope.info.calId){var siteId=$scope.info.siteId,from=$filter("date")($scope.info.fromDate,"yyyy-MM-dd"),to=$filter("date")($scope.info.toDate,"yyyy-MM-dd"),calId=$scope.info.calId,time=$scope.info.submitTime;OnlineBookingService.changeBookingTime(siteId,from,to,calId,time,bookingId).then(function(data){"success"===data.status?($modalInstance.dismiss("cancel"),toastr.success("Submit Successfully!","Success"),$state.go("loggedIn.bookingList",null,{reload:!0})):toastr.error("Submit Failed!","Error")})}}}),angular.module("app.loggedIn.booking.package.controller",[]).controller("PackageController",function($scope,$state,$modal,$filter,ngTableParams,OnlineBookingService,$http,toastr,$cookieStore){var companyInfo;$scope.isSelected=!1,$scope.selectedPack=null;var ass=[];$scope.assList=[],$scope.data=[],$scope.data1=[],"undefined"!==$cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo")),OnlineBookingService.getPackage(companyInfo.id).then(function(data){"success"===data.status&&(OnlineBookingService.getAssList().then(function(data){$scope.assList=data}),$scope.data=data.rs,$scope.tableParams=new ngTableParams({page:1,count:10},{total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),OnlineBookingService.getPackageAss().then(function(data){ass=data.rs,$scope.tableParams2=new ngTableParams({page:1,count:10},{total:$scope.data1.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data1,params.filter()):$scope.data1,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data1;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}))}),$scope.removePackage=function(p){OnlineBookingService.deletePackage(p.PackId,companyInfo.id).then(function(data){"success"===data.status?(OnlineBookingService.getPackage(companyInfo.id).then(function(d){"success"===d.status&&($scope.data=d.rs),$scope.$watch("data",function(data){$scope.data=data,$scope.tableParams.reload()})}),toastr.success("Delete Successfully","Success")):toastr.error("Delete Failed","Error")})},$scope.addPackage=function(){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking/views/addPackage.html",controller:"AddPackageController",size:"md",resolve:{comId:function(){return companyInfo.id}}});modalInstance.result.then(function(){OnlineBookingService.getPackage(companyInfo.id).then(function(d){"success"===d.status&&($scope.data=d.rs),$scope.$watch("data",function(data){$scope.data=data,$scope.tableParams.reload()})})})},$scope.addPackageAss=function(){$modal.open({templateUrl:"modules/onlineBooking/views/addPackageAss.html",controller:"AddPackageAssController",size:"md",resolve:{packId:function(){return $scope.selectedPack}}})},$scope.showChild=function(p){$scope.data1=[],$scope.isSelected=!0,$scope.selectedPack=p.PackId;for(var i=0;i<ass.length;i++)p.PackId===ass[i].pack_id&&$scope.data1.push(ass[i]);$scope.tableParams2.reload()},$scope.removeAss=function(a){$scope.data1=[],OnlineBookingService.removePackAss(a.ass_id,a.pack_id).then(function(data){"success"===data.status?(toastr.success("Delete Successfully!","Success"),
OnlineBookingService.getPackageAss().then(function(data){ass=data.rs;for(var i=0;i<ass.length;i++)p.PackId===ass[i].pack_id&&$scope.data1.push(ass[i])}),$scope.tableParams2.reload()):toastr.error("Delete Failed!","Error")})}}).controller("AddPackageController",function($scope,$state,toastr,$modalInstance,OnlineBookingService,comId){$scope.info={packName:""},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.submit=function(){""!==$scope.info.packName&&OnlineBookingService.insertPackage($scope.info.packName,comId).then(function(data){"success"===data.status?(toastr.success("Insert Successfully!","Success"),$modalInstance.close()):toastr.error("Insert Failed!","Error")})}}).controller("AddPackageAssController",function($scope,$state,toastr,$modalInstance,OnlineBookingService,packId){OnlineBookingService.getAssList().then(function(data){$scope.assList=data}),$scope.a={id:""},$scope.b={price:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.getPrice=function(id){null!=id?OnlineBookingService.getAssPrice(id).then(function(data){console.log(data[0].price),$scope.b.price=data[0].price}):$scope.b.price=""},$scope.submit=function(){null!==$scope.a.id&&OnlineBookingService.insertPackAss($scope.a.id,packId).then(function(data){"success"===data.status?(toastr.success("Insert Successfully!","Success"),$modalInstance.dismiss("cancel"),$state.go("loggedIn.package",null,{reload:!0})):toastr.error("Insert Failed!","Error")})}}),angular.module("app.loggedIn.booking.position.controller",[]).controller("PositionController",function($scope,$state,$modal,$filter,ngTableParams,OnlineBookingService,$http,toastr,$cookieStore){var companyInfo;"undefined"!==$cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo")),$scope.data=[],OnlineBookingService.getPositionList(companyInfo.id).then(function(data){$scope.data=data,$scope.tableParams=new ngTableParams({page:1,count:10},{total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.removePosition=function(p){OnlineBookingService.deletePosition(p.Position_name,companyInfo.id).then(function(data){"success"===data.status?(toastr.success("Delete Successfully!","Success"),$state.go("loggedIn.position",null,{reload:!0})):toastr.error("Delete Failed!","Error")})},$scope.addPosition=function(){$modal.open({templateUrl:"modules/onlineBooking/views/addPosition.html",controller:"AddPositionController",size:"md",resolve:{comId:function(){return companyInfo.id}}})}}).controller("AddPositionController",function($scope,$state,toastr,$modalInstance,OnlineBookingService,comId){$scope.info={positionName:""},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.submit=function(){""!==$scope.info.positionName&&OnlineBookingService.insertPos($scope.info.positionName,comId).then(function(data){"success"===data.status?(toastr.success("Insert Successfully!","Success"),$modalInstance.dismiss("cancel"),$state.go("loggedIn.position",null,{reload:!0})):toastr.error("Insert Failed!","Error")})}}),angular.module("app.loggedIn.booking.setting.controller",[]).controller("SettingController",function($scope,$state,$modal,$filter,ngTableParams,OnlineBookingService,$http,toastr,$cookieStore){var companyInfo,userInfo;$scope.data=[],"undefined"!=typeof $cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo")),"undefined"!=typeof $cookieStore.get("userInfo")&&(userInfo=$cookieStore.get("userInfo")),OnlineBookingService.getUserByCompany(companyInfo.id).then(function(data){$scope.data=data,$scope.tableParams=new ngTableParams({page:1,count:10},{total:data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.newUser=function(){$state.go("loggedIn.newUser")},$scope.editUser=function(b){$state.go("loggedIn.editUser",{id:b.id})}}).controller("NewUserController",function($scope,$state,OnlineBookingService,toastr,$cookieStore){var companyInfo;$scope.isEdit=!1,$scope.data=[],"undefined"!=typeof $cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo")),$scope.info={bookPerson:null,email:null,isDownload:"1",isEnable:"1",isMakeBooking:"1",isPackage:"1",isPosition:"1",isSetting:"1",isShowAll:"1",isShowBooking:"1",isViewAllData:"1",password:null,phone:null,username:null,userType:"Company",companyId:companyInfo.id,poNum:null,invoiceEmail:null,resultEmail:null,reportEmail:null,function_id:null,empId:null,isCalendar:null,isProject:null,isAdmin:null,isReceiveEmail:null},$scope.submitUser=function(userForm){$scope.showClickedValidation=!0,userForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingService.insertNewUser($scope.info).then(function(data){"success"===data.status?(toastr.success("Submit New User Successfully!","Success"),$state.go("loggedIn.newUser",null,{reload:!0})):"error"===data.status&&toastr.error("Submit New User Failed!","Error")})}}).controller("EditUserController",function($scope,$state,$stateParams,$modal,OnlineBookingService,toastr,$cookieStore){var companyInfo;$scope.isEdit=!0,$scope.data=[],"undefined"!=typeof $cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo")),$scope.info={userId:$stateParams.id,bookPerson:null,email:null,isDownload:"1",isEnable:"1",isMakeBooking:"1",isPackage:"1",isPosition:"1",isSetting:"1",isShowAll:"1",isShowBooking:"1",isViewAllData:"1",phone:null,username:null,companyId:companyInfo.id,userType:"Company"},OnlineBookingService.getUserInfo($stateParams.id).then(function(data){$scope.info.bookPerson=data.Booking_Person,$scope.info.email=data.Contact_email,$scope.info.isDownload=1==data.isDownloadResult?"1":"0",$scope.info.isEnable=1==data.isEnable?"1":"0",$scope.info.isMakeBooking=1==data.isMakeBooking?"1":"0",$scope.info.isPackage=1==data.isPackage?"1":"0",$scope.info.isPosition=1==data.isPosition?"1":"0",$scope.info.isSetting=1==data.isSetting?"1":"0",$scope.info.isShowAll=1==data.isAll?"1":"0",$scope.info.isShowBooking=1==data.isBooking?"1":"0",$scope.info.isViewAllData=1==data.isAllCompanyData?"1":"0",$scope.info.phone=data.Contact_number,$scope.info.username=data.user_name}),$scope.submitUser=function(userForm){$scope.showClickedValidation=!0,userForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingService.editUserInfo($scope.info).then(function(data){"success"===data.status?toastr.success("Submit New User Successfully!","Success"):"error"===data.status&&toastr.error("Submit New User Failed!","Error")})},$scope.changePass=function(){$modal.open({templateUrl:"modules/onlineBooking/views/changePassModal.html",controller:"ChangePassController",size:"md",resolve:{userId:function(){return $stateParams.id}}})}}).controller("ChangePassController",function($scope,$filter,$state,$modalInstance,OnlineBookingService,userId,toastr){$scope.info={oldPass:null,newPass:null,id:userId},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.okClick=function(){OnlineBookingService.changeUserPassword($scope.info).then(function(data){"success"===data.status?toastr.success("Change Password Successfully","Success"):"error"===data.status&&toastr.error("Change Password Failed","Error")})}}),angular.module("app.loggedIn.booking.services",[]).factory("OnlineBookingService",function(Restangular){var bookingService={},api=Restangular.all("api");return bookingService.getSubCompany=function(id){var sub=api.all("company/sub");return sub.post({id:id})},bookingService.getSubCompanyInfo=function(id){var sub=api.all("company/info");return sub.post({comId:id})},bookingService.getPackage=function(id){var package=api.all("booking/packageList");return package.post({id:id})},bookingService.insertPackage=function(name,comId){var insert=api.all("package/insert");return insert.post({name:name,comId:comId})},bookingService.insertPackAss=function(id,packId){var insert=api.all("package/assessment/insert");return insert.post({id:id,packId:packId})},bookingService.insertPos=function(name,comId){var insert=api.all("booking/position/insert");return insert.post({name:name,comId:comId})},bookingService.getPackageAssById=function(id){var ass=api.all("package/assessment/id");return ass.post({id:id})},bookingService.getPackageAss=function(){var ass=api.one("package/assessment");return ass.get()},bookingService.getAssPrice=function(id){var ass=api.all("assessment/price");return ass.post({id:id})},bookingService.updatePackAss=function(oldId,newId,packId){var ass=api.all("package/assessment/update");return ass.post({oldId:oldId,newId:newId,packId:packId})},bookingService.removePackAss=function(id,packid){var del=api.all("package/assessment/delete");return del.post({id:id,packId:packid})},bookingService.getBookingList=function(id){var list=api.all("booking/list/companyId");return list.post({id:id})},bookingService.getBookingDetail=function(id,canId){var detail=api.all("booking/detail");return detail.post({id:id,canId:canId})},bookingService.cancelBooking=function(id){var cancel=api.all("booking/cancel");return cancel.post({id:id})},bookingService.getSite=function(){var site=api.one("redimedsite/list");return site.get()},bookingService.getCalendar=function(id,from,to){var cal=api.all("booking/calendar");return cal.post({siteId:id,fromDate:from,toDate:to})},bookingService.getAppointmentTime=function(id){var time=api.all("booking/appointmentTime");return time.post({id:id})},bookingService.changeBookingTime=function(siteId,from,to,calId,appTime,bookId){var submit=api.all("booking/changeBookingTime");return submit.post({siteId:siteId,from:from,to:to,calId:calId,appTime:appTime,bookId:bookId})},bookingService.deletePackage=function(id,comId){var delPackage=api.all("booking/delete/package");return delPackage.post({id:id,comId:comId})},bookingService.getAssList=function(){var assList=api.one("booking/assList");return assList.get()},bookingService.getPositionList=function(comId){var position=api.all("booking/position/list");return position.post({comId:comId})},bookingService.deletePosition=function(name,comId){var del=api.all("booking/position/delete");return del.post({name:name,comId:comId})},bookingService.submitBook=function(info,head){var submit=api.all("booking/submit");return submit.post({info:info,header:head})},bookingService.pendingCalendar=function(info){var submit=api.all("booking/pending");return submit.post({info:info})},bookingService.deleteAllPending=function(){var del=api.all("booking/delete/allPending");return del.post()},bookingService.deletePending=function(info){var del=api.all("booking/delete/pending");return del.post({info:info})},bookingService.getUserByCompany=function(comId){var user=api.all("users/company");return user.post({comId:comId})},bookingService.insertNewUser=function(info){var user=api.all("users/insert");return user.post({info:info})},bookingService.getUserInfo=function(id){var user=api.all("users/id");return user.post({id:id})},bookingService.editUserInfo=function(info){var user=api.all("users/edit");return user.post({info:info})},bookingService.changeUserPassword=function(info){var pass=api.all("users/changePass");return pass.post({info:info})},bookingService.getSiteState=function(id){var state=api.all("redimedsite/state");return state.post({id:id})},bookingService.getStateSuburb=function(id){var suburb=api.all("redimedsite/state/suburb");return suburb.post({id:id})},bookingService.customPackage=function(id){var pack=api.all("package/custom");return pack.post({id:id})},bookingService.searchBooking=function(info){var search=api.all("booking/search");return search.post({info:info})},bookingService.updateNote=function(info){var note=api.all("booking/edit/note");return note.post({info:info})},bookingService.exportExcel=function(){var ex=api.one("booking/export");return ex.get()},bookingService}),angular.module("app.loggedIn.booking.admin",["app.loggedIn.booking.admin.services","app.loggedIn.booking.admin.booking.controller","app.loggedIn.booking.admin.assessment.controller","app.loggedIn.booking.admin.company.controller","app.loggedIn.booking.admin.user.controller","app.loggedIn.booking.admin.site.controller","app.loggedIn.booking.admin.requiment.controller","app.loggedIn.booking.admin.requirement.directive"]).config(function($stateProvider){$stateProvider.state("loggedIn.admin_booking",{url:"/admin/booking/booking",templateUrl:"modules/onlineBooking_Admin/views/booking.html",controller:"AdminBookingController"}).state("loggedIn.admin_assessment",{url:"/admin/booking/assessment",templateUrl:"modules/onlineBooking_Admin/views/assessment.html",controller:"AdminAssessmentController"}).state("loggedIn.admin_company",{url:"/admin/booking/companies",templateUrl:"modules/onlineBooking_Admin/views/companies.html",controller:"AdminCompanyController"}).state("loggedIn.admin_company_new",{url:"/admin/booking/company/new/:id",templateUrl:"modules/onlineBooking_Admin/views/addNewCompany.html",controller:"AdminNewCompanyController"}).state("loggedIn.admin_company_edit",{url:"/admin/booking/company/edit/:fatherId/:subId",templateUrl:"modules/onlineBooking_Admin/views/addNewCompany.html",controller:"AdminEditCompanyController"}).state("loggedIn.admin_user",{url:"/admin/booking/user",templateUrl:"modules/onlineBooking_Admin/views/user.html",controller:"AdminUserController"}).state("loggedIn.admin_user_new",{url:"/admin/booking/user/new",templateUrl:"modules/onlineBooking_Admin/views/newUser.html",controller:"AdminNewUserController"}).state("loggedIn.admin_user_edit",{url:"/admin/booking/user/:id",templateUrl:"modules/onlineBooking_Admin/views/newUser.html",controller:"AdminEditUserController"}).state("loggedIn.admin_sites",{url:"/admin/booking/sites",templateUrl:"modules/onlineBooking_Admin/views/sites.html",controller:"AdminSiteController"}).state("loggedIn.admin_sites_new",{url:"/admin/booking/sites/new",templateUrl:"modules/onlineBooking_Admin/views/newSite.html",controller:"AdminNewSiteController"}).state("loggedIn.admin_sites_edit",{url:"/admin/booking/sites/:id",templateUrl:"modules/onlineBooking_Admin/views/newSite.html",controller:"AdminEditSiteController"})}),angular.module("app.loggedIn.booking.admin.booking.controller",[]).controller("AdminBookingController",function($scope,$modal,$filter,ngTableParams,FileUploader,OnlineBookingAdminService,OnlineBookingService,$http,toastr,$cookieStore){$scope.data=[],$scope.isSelected=!1,$scope.selectedCanId=null,$scope.selectedBookId=null,$scope.isChangeFile=!1,$scope.info={},$scope.dateOptions={formatYear:"yy",startingDay:1};var uploader=$scope.uploader=new FileUploader({url:"/api/booking/upload"});uploader.onAfterAddingFile=function(fileItem){fileItem.formData[0]={Booking_id:$scope.info.Booking_id,Candidate_id:$scope.info.Candidate_id,fileName:uploader.queue[0].file.name},console.info("onAfterAddingFile",fileItem)},OnlineBookingAdminService.getList().then(function(data){"success"===data.status&&($scope.data=data.rs,$scope.tableParams=new ngTableParams({page:1,count:10},{total:data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}))}),$scope.openDetail=function(b){$modal.open({templateUrl:"modules/onlineBooking_Admin/views/bookingDetailModal.html",controller:"AdminBookingDetailController",size:"lg",resolve:{bookingId:function(){return b.Booking_id},candidateId:function(){return b.Candidate_id}}})},$scope.showDetail=function(b){$scope.selectedCanId=b.Candidate_id,$scope.selectedBookId=b.Booking_id,$scope.isSelected=!0,uploader.clearQueue(),OnlineBookingService.getBookingDetail(b.Booking_id,b.Candidate_id).then(function(data){var arrAss=[];$scope.info=data.rs[0],OnlineBookingService.getSite().then(function(rs){$scope.siteList=rs});var from=$filter("date")(data.rs[0].from_date,"yyyy-MM-dd"),to=$filter("date")(data.rs[0].to_date,"yyyy-MM-dd");OnlineBookingService.getCalendar(data.rs[0].site_id,from,to).then(function(data){$scope.calList=data}),OnlineBookingService.getPackageAssById(data.rs[0].package_id).then(function(data){if("success"===data.status){for(var i=0;i<data.rs.length;i++)arrAss.push({head_name:data.rs[i].HeaderName,ass_name:data.rs[i].ass_name});$scope.packAss=_.groupBy(arrAss,"head_name")}})})},$scope.saveInfo=function(){uploader.filters.push({name:"customFilter",fn:function(item,options){return this.queue.length<10}}),uploader.uploadAll(),console.log(uploader),uploader.onCompleteAll=function(){console.info("onCompleteAll")},OnlineBookingAdminService.editBookingInfo($scope.info).then(function(data){"success"===data.status?toastr.success("Edit Successfully!","Success"):toastr.error("Edit Failed!","Error")})},$scope.sendEmail=function(){OnlineBookingAdminService.confirmBooking($scope.info).then(function(data){"success"===data.status?toastr.success("Send Mail Successfully! Please check your email!","Success"):toastr.error("Send Mail Failed!","Error")})},$scope.searchModal=function(){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking/views/searchBookingModal.html",controller:"SearchAdminBookingController",size:"md",resolve:{companyId:function(){return null}}});modalInstance.result.then(function(data){$scope.data=data,$scope.$watch("data",function(data){$scope.data=data,$scope.tableParams.reload()})})}}).controller("SearchAdminBookingController",function($scope,$modalInstance,OnlineBookingService,OnlineBookingAdminService,companyId){$scope.minDate=new Date,$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.info={companyId:companyId,companyName:null,candidateName:null,fromDate:null,toDate:null,bookingPerson:null,status:null,siteName:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.search=function(){OnlineBookingService.searchBooking($scope.info).then(function(data){$modalInstance.close(data)})},$scope.reset=function(){OnlineBookingAdminService.getList().then(function(data){$modalInstance.close(data.rs)})}}).controller("AdminBookingDetailController",function($scope,$modalInstance,OnlineBookingService,bookingId,candidateId){$scope.cancel=function(){$modalInstance.dismiss("cancel")},OnlineBookingService.getBookingDetail(bookingId,candidateId).then(function(data){var arrAss=[];$scope.detail=data.rs[0],"undefined"!=typeof data.rs[0].package_id&&OnlineBookingService.getPackageAssById(data.rs[0].package_id).then(function(data){if("success"===data.status){for(var i=0;i<data.rs.length;i++)arrAss.push({head_name:data.rs[i].HeaderName,ass_name:data.rs[i].ass_name});$scope.detail.ass=_.groupBy(arrAss,"head_name")}})})}),angular.module("app.loggedIn.booking.admin.assessment.controller",[]).controller("AdminAssessmentController",function($scope,$state,$modal,$filter,ngTableParams,FileUploader,OnlineBookingAdminService,OnlineBookingService,$http,toastr,$cookieStore){$scope.data=[],$scope.data1=[],$scope.selectedHeader="",$scope.ass=[],$scope.isSelected=!1,$scope.selectedId=null,OnlineBookingAdminService.getAssHeader().then(function(data){$scope.data=data,$scope.tableParams=new ngTableParams({page:1,count:10},{total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),OnlineBookingAdminService.getAssessment().then(function(data){$scope.ass=data,$scope.tableParams2=new ngTableParams({page:1,count:10},{total:$scope.data1.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data1,params.filter()):$scope.data1,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data1;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.showChild=function(p){$scope.selectedId=p.id,$scope.data1=[],$scope.isSelected=!0,$scope.selectedHeader=p.id;for(var i=0;i<$scope.ass.length;i++)p.id===$scope.ass[i].HEADER_ID&&$scope.data1.push($scope.ass[i]);$scope.tableParams2.reload()},$scope.removeHeaderAssessment=function(p){var headerId=p.id;OnlineBookingAdminService.deleteHeaderAssessment(headerId).then(function(data){"success"===data.status?(toastr.success("Delete Successfully!","Success"),$state.go("loggedIn.admin_assessment",null,{reload:!0})):"error"===data.status&&toastr.error("Delete Failed!","Error")})},$scope.removeAssessment=function(a){var id=a.id;OnlineBookingAdminService.deleteAssessment(id).then(function(data){"success"===data.status?(toastr.success("Delete Successfully!","Success"),$state.go("loggedIn.admin_assessment",null,{reload:!0})):"error"===data.status&&toastr.error("Delete Failed!","Error")})},$scope.addHeader=function(){$modal.open({templateUrl:"modules/onlineBooking_Admin/views/assessmentHeaderModal.html",controller:"AddAssHeaderController",size:"md"})},$scope.addAssessment=function(){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking_Admin/views/assessmentModal.html",controller:"AddAssessmentController",size:"md",resolve:{headId:function(){return $scope.selectedHeader}}});modalInstance.result.then(function(headId){$scope.ass=[],$scope.data1=[],OnlineBookingAdminService.getAssessment().then(function(data){$scope.ass=data}),$scope.$watch("ass",function(ass){for(var i=0;i<$scope.ass.length;i++)headId===$scope.ass[i].HEADER_ID&&$scope.data1.push($scope.ass[i]);$scope.tableParams2.reload()})})},$scope.editAssessment=function(b){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking_Admin/views/assessmentModal.html",controller:"EditAssessmentController",size:"md",resolve:{headId:function(){return $scope.selectedHeader},assId:function(){return b.id}}});modalInstance.result.then(function(headId){$scope.ass=[],$scope.data1=[],OnlineBookingAdminService.getAssessment().then(function(data){$scope.ass=data}),$scope.$watch("ass",function(ass){for(var i=0;i<$scope.ass.length;i++)headId===$scope.ass[i].HEADER_ID&&$scope.data1.push($scope.ass[i]);$scope.tableParams2.reload()})})}}).controller("AddAssHeaderController",function($scope,$state,$modalInstance,OnlineBookingAdminService,toastr){$scope.info={name:""},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.submit=function(){OnlineBookingAdminService.addNewHeaderAssessment($scope.info).then(function(data){"success"===data.status?(toastr.success("Insert Successfully!","Success"),$modalInstance.dismiss("cancel"),$state.go("loggedIn.admin_assessment",null,{reload:!0})):"error"===data.status&&toastr.error("Insert Failed!","Error")})}}).controller("AddAssessmentController",function($scope,$state,$modalInstance,OnlineBookingAdminService,toastr,headId){$scope.info={headId:headId,name:null,itemCode:null,itemName:null,price:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.submit=function(){OnlineBookingAdminService.addNewAssessment($scope.info).then(function(data){"success"===data.status?(OnlineBookingAdminService.updatePrice(),toastr.success("Insert Successfully!","Success"),$modalInstance.close(headId)):"error"===data.status&&toastr.error("Insert Failed!","Error")})}}).controller("EditAssessmentController",function($scope,$state,$modalInstance,OnlineBookingAdminService,toastr,headId,assId){$scope.info={headId:headId,assId:assId,name:null,itemCode:null,itemName:null,price:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},OnlineBookingAdminService.getAssessmentInfo(assId).then(function(data){$scope.info.headId=data[0].HEADER_ID,$scope.info.assId=data[0].id,$scope.info.name=data[0].ass_name,$scope.info.itemCode=data[0].item_code,$scope.info.itemName=data[0].item_name,$scope.info.price=data[0].price}),$scope.submit=function(){OnlineBookingAdminService.updateAssessment($scope.info).then(function(data){"success"===data.status?(OnlineBookingAdminService.updatePrice(),toastr.success("Edit Successfully!","Success"),$modalInstance.close(headId)):"error"===data.status&&toastr.error("Edit Failed!","Error")})}}),angular.module("app.loggedIn.booking.admin.company.controller",[]).controller("AdminCompanyController",function($scope,$state,$modal,$filter,ngTableParams,$cookieStore,FileUploader,OnlineBookingAdminService,toastr){$scope.data=[];var comArr=[];$scope.data1=[],$scope.patientData=[],$scope.isSelected=!1,$scope.selectedId=null,void 0!=$cookieStore.get("companyInfo")&&($scope.companyInfo=$cookieStore.get("companyInfo")),OnlineBookingAdminService.getCompanyList().then(function(data){comArr=data;for(var i=0;i<comArr.length;i++)null===comArr[i].father_id&&$scope.data.push(comArr[i]);$scope.tableParams=new ngTableParams({page:1,count:10},{total:$scope.data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data,params.filter()):$scope.data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams2=new ngTableParams({page:1,count:10},{total:$scope.data1.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data1,params.filter()):$scope.data1,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data1;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams3=new ngTableParams({page:1,count:10},{total:$scope.patientData.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.patientData,params.filter()):$scope.patientData,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.patientData;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.showSubCompany=function(b){$scope.selectedId=b.id,$scope.selectedComp=b.Company_name,$scope.data1=[],$scope.patientData=[],$scope.isSelected=!0;for(var i=0;i<comArr.length;i++)comArr[i].father_id===b.id&&$scope.data1.push(comArr[i]);OnlineBookingAdminService.getCompanyPatients(b.id).then(function(rs){if("success"==rs.status){$scope.patientData=rs.data;for(var i=0;i<$scope.patientData.length;i++){var nameArr=[];nameArr.push($scope.patientData[i].Title),nameArr.push($scope.patientData[i].First_name),nameArr.push($scope.patientData[i].Sur_name),nameArr.push($scope.patientData[i].Middle_name),$scope.patientData[i].fullName=nameArr.join(" ")}$scope.tableParams3.reload()}}),$scope.tableParams2.reload()},$scope.addNewCompany=function(){$state.go("loggedIn.admin_company_new")},$scope.editCompany=function(b){$state.go("loggedIn.admin_company_edit",{fatherId:b.id},{reload:!0})},$scope.addSubCompany=function(){$state.go("loggedIn.admin_company_new",{id:$scope.selectedId},{reload:!0})},$scope.editSubCompany=function(a){$state.go("loggedIn.admin_company_edit",{fatherId:$scope.selectedId,subId:a.id},{reload:!0})},$scope.viewPatient=function(a){$state.go("loggedIn.patient.appointment",{patient_id:a.Patient_id,cal_id:1},{reload:!0})},$scope.showRequirement=function(){$modal.open({templateUrl:"Requirements",controller:"RequirementController",size:"lg",resolve:{idr:function(){return $scope.selectedId}}}).result.then(function(response){console.log(response)})}}).controller("AdminNewCompanyController",function($scope,$state,ngTableParams,$stateParams,toastr,$cookieStore,OnlineBookingAdminService){$scope.isEdit=!1;var comId=null;(null!==$stateParams.id||""!==$stateParams.id||"undefined"!=typeof $stateParams.id)&&(comId=$stateParams.id),$scope.info={companyName:null,industry:null,addr:null,postCode:null,state:null,country:null,description:null,poNum:null,isInvoice:null,invoiceEmail:null,isResult:null,resultEmail:null,reportEmail:null,status:null,isProject:null,isPO:null,isExtra:null,phone:null,fatherId:comId},$scope.submitCompany=function(companyForm){$scope.showClickedValidation=!0,companyForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.checkCompanyName($scope.info.companyName).then(function(data){"error"==data.status?(toastr.error("Company Name is already exists!"),$scope.isExist=!0):($scope.isExist=!1,OnlineBookingAdminService.insertNewCompany($scope.info).then(function(data){"success"===data.status?(toastr.success("Submit New Company Successfully!","Success"),$state.go("loggedIn.admin_company",null,{reload:!0})):"error"===data.status&&toastr.error("Submit New Company Failed!","Error")}))})}}).controller("AdminEditCompanyController",function($scope,$filter,ngTableParams,$state,$stateParams,OnlineBookingService,toastr,$cookieStore,OnlineBookingAdminService){$scope.isEdit=!0,$scope.fatherId=null!=$stateParams.fatherId||void 0!=$stateParams.fatherId?$stateParams.fatherId:null,$scope.subId=null!=$stateParams.subId||void 0!=$stateParams.subId?$stateParams.subId:null,$scope.patientData=[],$scope.data1=[],$scope.tableParams2=new ngTableParams({page:1,count:10},{total:$scope.data1.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.data1,params.filter()):$scope.data1,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.data1;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams3=new ngTableParams({page:1,count:10},{total:$scope.patientData.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.patientData,params.filter()):$scope.patientData,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.patientData;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),OnlineBookingAdminService.getCompanyList().then(function(data){for(var i=0;i<data.length;i++)data[i].father_id==$scope.fatherId&&$scope.data1.push(data[i]);$scope.tableParams2.reload()}),OnlineBookingAdminService.getCompanyPatients(null==$scope.fatherId?$scope.subId:$scope.fatherId).then(function(rs){if("success"==rs.status){$scope.patientData=rs.data;for(var i=0;i<$scope.patientData.length;i++){var nameArr=[];nameArr.push($scope.patientData[i].Title),nameArr.push($scope.patientData[i].First_name),nameArr.push($scope.patientData[i].Sur_name),nameArr.push($scope.patientData[i].Middle_name),$scope.patientData[i].fullName=nameArr.join(" ")}$scope.tableParams3.reload()}}),$scope.addSubCompany=function(){$state.go("loggedIn.admin_company_new",{id:$scope.fatherId},{reload:!0})},$scope.editSubCompany=function(a){$state.go("loggedIn.admin_company_edit",{fatherId:$scope.fatherId,subId:a.id},{reload:!0})},$scope.viewPatient=function(a){$state.go("loggedIn.patient.appointment",{patient_id:a.Patient_id,cal_id:1},{reload:!0})},$scope.info={id:null==$scope.fatherId?$scope.subId:$scope.fatherId,companyName:null,industry:null,addr:null,postCode:null,state:null,country:null,description:null,poNum:null,isInvoice:null,invoiceEmail:null,isResult:null,resultEmail:null,reportEmail:null,
status:null,isProject:null,isPO:null,isExtra:null,phone:null},OnlineBookingAdminService.getCompanyInfo(null==$scope.fatherId?$scope.subId:$scope.fatherId).then(function(data){$scope.info={id:null==$scope.fatherId?$scope.subId:$scope.fatherId,companyName:data.Company_name,industry:data.Industry,addr:data.Addr,postCode:data.postcode,state:data.State,country:data.country,description:data.Description,poNum:data.PO_number,isInvoice:1!=data.isInvoiceEmailToUser?"0":"1",invoiceEmail:data.invoice_email,isResult:1!=data.isAddContactEmailToResult?"0":"1",resultEmail:data.result_email,reportEmail:data.report_to_email,status:data.default_status,phone:data.Phone,isProject:1!=data.isProject?"0":"1",isPO:1!=data.isPO?"0":"1",isExtra:1!=data.isExtra?"0":"1"}}),$scope.submitCompany=function(companyForm){$scope.showClickedValidation=!0,companyForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.checkCompanyName($scope.info.companyName).then(function(data){"error"==data.status?($scope.isExist=!0,toastr.error("Company Name is already exists!")):($scope.isExist=!1,OnlineBookingAdminService.editCompanyInfo($scope.info).then(function(data){"success"===data.status?toastr.success("Edit Company Successfully!","Success"):"error"===data.status&&toastr.error("Edit Company Failed!","Error")}))})}}),angular.module("app.loggedIn.booking.admin.user.controller",[]).controller("AdminUserController",function($scope,$state,$modal,$filter,ngTableParams,OnlineBookingAdminService,toastr){$scope.selectedId=null,$scope.selectedRow=null,$scope.arr=[],$scope.info={id:null,user_id:null,user_name:null,menu_id:null,isEnable:null},OnlineBookingAdminService.getListUser().then(function(data){$scope.tableParams=new ngTableParams({page:1,count:10},{total:data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")(data,params.filter()):data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams2=new ngTableParams({page:1,count:10},{total:$scope.arr.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.arr,params.filter()):$scope.arr,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.arr;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.addNewUser=function(){$state.go("loggedIn.admin_user_new")},$scope.editUser=function(b){$state.go("loggedIn.admin_user_edit",{id:b.id})},$scope.showMenu=function(b){$scope.selectedId=b.id,$scope.selectedRow=null,$scope.info={id:null,user_id:null,user_name:null,menu_id:null,isEnable:null},$scope.showClickedValidation=!1,$scope.arr=[],$scope.rs=[],OnlineBookingAdminService.getUserMenu(b.id).then(function(data){$scope.rs=data}),$scope.$watch("rs",function(rs){$scope.arr=rs,$scope.tableParams2.reload()})},$scope.showMenuDetails=function(b){$scope.selectedRow=b.id,OnlineBookingAdminService.getMenuList().then(function(data){$scope.menuList=[];for(var i=0;i<data.length;i++)1==data[i].isEnable&&$scope.menuList.push(data[i])}),OnlineBookingAdminService.getUserMenuDetails(b.id).then(function(data){$scope.info.id=data[0].id,$scope.info.user_id=data[0].user_id,$scope.info.user_name=data[0].user_name,$scope.info.menu_id=data[0].menu_id,$scope.info.isEnable=1==data[0].isEnable?"1":"0"})},$scope.submitUserMenu=function(menuForm){$scope.showClickedValidation=!0,menuForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.editUserMenu($scope.info).then(function(data){"success"===data.status?(toastr.success("Edit Successfully!","Success"),OnlineBookingAdminService.getUserMenu($scope.selectedId).then(function(data){$scope.rs=data}),$scope.$watch("rs",function(rs){$scope.arr=rs,$scope.tableParams2.reload()})):toastr.success("Edit Failed!","Error")})},$scope.addNewUserMenu=function(){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking_Admin/views/newSubMenu.html",controller:"AddNewUserMenuController",size:"md",resolve:{userId:function(){return $scope.selectedId}}});modalInstance.result.then(function(){OnlineBookingAdminService.getUserMenu($scope.selectedId).then(function(data){$scope.rs=data}),$scope.$watch("rs",function(rs){$scope.arr=rs,$scope.tableParams2.reload()})})},$scope.deleteUserMenu=function(b){OnlineBookingAdminService.delUserMenu(b.id).then(function(data){"success"==data.status?(toastr.success("Delete Successfully!","Success"),OnlineBookingAdminService.getUserMenu($scope.selectedId).then(function(data){$scope.rs=data}),$scope.$watch("rs",function(rs){$scope.arr=rs,$scope.tableParams2.reload()}),$scope.info={id:null,user_id:null,user_name:null,menu_id:null,isEnable:null}):toastr.error("Delete Failed","Error")})}}).controller("AddNewUserMenuController",function($scope,$state,$modal,$modalInstance,$filter,ngTableParams,OnlineBookingAdminService,UserService,userId,toastr){$scope.info={user_id:userId,menu_id:null,isEnable:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},OnlineBookingAdminService.getMenuList().then(function(data){$scope.menuList=[];for(var i=0;i<data.length;i++)1==data[i].isEnable&&$scope.menuList.push(data[i])}),$scope.addNew=function(menuForm){$scope.showClickedValidation=!0,menuForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.insertUserMenu($scope.info).then(function(data){"success"===data.status?(toastr.success("Insert Successfully!","Success"),$modalInstance.close()):toastr.success("Insert Failed!","Error")})}}).controller("AdminNewUserController",function($scope,$state,$modal,$filter,ngTableParams,OnlineBookingAdminService,UserService,toastr,SecurityService){$scope.isEdit=!1,$scope.isCompany=!1,$scope.usernameExist=!1,$scope.emailExist=!1,$scope.typeList=[],$scope.userTypeChange=function(b){console.log("type change");for(var i=0;i<$scope.typeList.length;i++)"Company"==$scope.typeList[i].user_type&&($scope.isCompany=$scope.typeList[i].ID==b?!0:!1)},$scope.checkUsername=function(username){SecurityService.checkUserName(username).then(function(data){$scope.usernameExist=null==data||data.length<=0?!1:!0})},$scope.checkEmail=function(email){SecurityService.checkEmail(email).then(function(data){$scope.emailExist=null==data||data.length<=0?!1:!0})},UserService.getUserType().then(function(data){$scope.typeList=data}),$scope.info={bookPerson:null,email:null,isDownload:null,isEnable:"1",isMakeBooking:null,isPackage:null,isPosition:null,isSetting:null,isShowAll:null,isShowBooking:null,isViewAllData:null,password:null,phone:null,username:null,userType:null,companyId:null,poNum:null,invoiceEmail:null,resultEmail:null,reportEmail:null,function_id:null,function_mobile:null,empId:null,isCalendar:null,isProject:null,isAdmin:null,isReceiveEmail:null},OnlineBookingAdminService.getListCompany().then(function(data){$scope.companyList=data}),OnlineBookingAdminService.getListFunction().then(function(data){for(var listWeb=[],listMobile=[],i=0;i<data.length;i++)1==data[i].isWeb&&listWeb.push(data[i]),1==data[i].isMobile&&listMobile.push(data[i]);$scope.functionList=listWeb,$scope.functionMobList=listMobile}),OnlineBookingAdminService.getListEmployee().then(function(data){$scope.empList=data}),$scope.submitUser=function(userForm){$scope.showClickedValidation=!0,userForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.insertNewUser($scope.info).then(function(data){"success"===data.status?(toastr.success("Submit New User Successfully!","Success"),$state.go("loggedIn.admin_user_new",null,{reload:!0})):"error"===data.status&&toastr.error("Submit New User Failed!","Error")})}}).controller("AdminEditUserController",function($scope,$state,$stateParams,$modal,OnlineBookingService,OnlineBookingAdminService,toastr,UserService,$cookieStore){$scope.typeList=[],$scope.isEdit=!0,$scope.isCompany=!1,UserService.getUserType().then(function(data){$scope.typeList=data}),$scope.userTypeChange=function(b){for(var i=0;i<$scope.typeList.length;i++)"Company"==$scope.typeList[i].user_type&&($scope.isCompany=$scope.typeList[i].ID==b?!0:!1)},$scope.info={userId:$stateParams.id,bookPerson:null,email:null,isDownload:null,isEnable:null,isMakeBooking:null,isPackage:null,isPosition:null,isSetting:null,isShowAll:null,isShowBooking:null,isViewAllData:null,password:null,phone:null,username:null,userType:null,companyId:null,poNum:null,invoiceEmail:null,resultEmail:null,reportEmail:null,function_id:null,function_mobile:null,empId:null,isCalendar:null,isProject:null,isAdmin:null,isReceiveEmail:null},OnlineBookingAdminService.getListCompany().then(function(data){$scope.companyList=data}),OnlineBookingAdminService.getListFunction().then(function(data){for(var listWeb=[],listMobile=[],i=0;i<data.length;i++)1==data[i].isWeb&&listWeb.push(data[i]),1==data[i].isMobile&&listMobile.push(data[i]);$scope.functionList=listWeb,$scope.functionMobList=listMobile}),OnlineBookingAdminService.getListEmployee().then(function(data){$scope.empList=data}),OnlineBookingService.getUserInfo($stateParams.id).then(function(data){$scope.info.bookPerson=data.Booking_Person,$scope.info.email=data.Contact_email,$scope.info.isDownload=1==data.isDownloadResult?"1":"0",$scope.info.isEnable=1==data.isEnable?"1":"0",$scope.info.isMakeBooking=1==data.isMakeBooking?"1":"0",$scope.info.isPackage=1==data.isPackage?"1":"0",$scope.info.isPosition=1==data.isPosition?"1":"0",$scope.info.isSetting=1==data.isSetting?"1":"0",$scope.info.isShowAll=1==data.isAll?"1":"0",$scope.info.isShowBooking=1==data.isBooking?"1":"0",$scope.info.isViewAllData=1==data.isAllCompanyData?"1":"0",$scope.info.phone=data.Contact_number,$scope.info.username=data.user_name,$scope.info.userType=data.UserType.id,$scope.info.companyId=data.company_id,$scope.info.poNum=data.PO_number,$scope.info.invoiceEmail=data.invoiceemail,$scope.info.resultEmail=data.result_email,$scope.info.reportEmail=data.Report_To_email,$scope.info.function_id=data.function_id,$scope.info.function_mobile=data.function_mobile,$scope.info.empId=data.employee_id,$scope.info.isCalendar=1==data.isCalendar?"1":"0",$scope.info.isProject=1==data.isProject?"1":"0",$scope.info.isAdmin=1==data.isAdmin?"1":"0",$scope.isReceiveEmail=1==data.isReceiveEmailAfterHour?"1":"0";for(var i=0;i<$scope.typeList.length;i++)"Company"==$scope.typeList[i].user_type&&$scope.typeList[i].ID==$scope.info.userType&&($scope.isCompany=!0)}),$scope.submitUser=function(userForm){$scope.showClickedValidation=!0,userForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingService.editUserInfo($scope.info).then(function(data){"success"===data.status?toastr.success("Submit New User Successfully!","Success"):"error"===data.status&&toastr.error("Submit New User Failed!","Error")})},$scope.changePass=function(){$modal.open({templateUrl:"modules/onlineBooking_Admin/views/changePassModal.html",controller:"AdminChangePassController",size:"md",resolve:{userId:function(){return $stateParams.id}}})}}).controller("AdminChangePassController",function($scope,$filter,$state,$modalInstance,OnlineBookingService,userId,toastr){$scope.info={oldPass:null,newPass:null,id:userId},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.okClick=function(){OnlineBookingService.changeUserPassword($scope.info).then(function(data){"success"===data.status?(toastr.success("Change Password Successfully","Success"),$modalInstance.dismiss("cancel")):"error"===data.status&&toastr.error("Change Password Failed","Error")})}}),angular.module("app.loggedIn.booking.admin.site.controller",[]).controller("AdminSiteController",function($scope,$state,$modal,$filter,ngTableParams,FileUploader,OnlineBookingAdminService,OnlineBookingService,$http,toastr,$cookieStore){$scope.selectedId=null,$scope.selectedCal=null,$scope.selectedState=null,$scope.selectedSuburb=null,$scope.selectedSite=null,$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.arr=[],$scope.arrState=[],$scope.arrSuburb=[],$scope.dataRooms=[],$scope.info={site_id:null,cal_id:null,From_time:null,to_time:null,available:null,booking:null},$scope.stateInfo={state_id:null,site_id:null,state_name:null,isenable:null},$scope.suburbInfo={suburb_id:null,state_id:null,site_id:null,suburb_name:null,isenable:null},OnlineBookingAdminService.getSiteList().then(function(data){$scope.tableParams=new ngTableParams({page:1,count:10},{total:data.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")(data,params.filter()):data,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):data;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams2=new ngTableParams({page:1,count:10},{total:$scope.arr.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.arr,params.filter()):$scope.arr,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.arr;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams3=new ngTableParams({page:1,count:10},{total:$scope.arrState.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.arrState,params.filter()):$scope.arrState,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.arrState;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams4=new ngTableParams({page:1,count:10},{total:$scope.arrSuburb.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.arrSuburb,params.filter()):$scope.arrSuburb,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.arrSuburb;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),$scope.tableParams5=new ngTableParams({page:1,count:10},{total:$scope.dataRooms.length,getData:function($defer,params){var filteredData=params.filter()?$filter("filter")($scope.dataRooms,params.filter()):$scope.dataRooms,orderedData=params.sorting()?$filter("orderBy")(filteredData,params.orderBy()):$scope.dataRooms;params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.editRoom=function(roomInfo,isEdit){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking_Admin/views/modals/roomModal.html",controller:"RoomController",size:"md",resolve:{site:function(){return $scope.selectedSite},isEdit:function(){return isEdit},room:function(){return roomInfo}}});modalInstance.result.then(function(){OnlineBookingAdminService.getSiteRoom($scope.selectedId).then(function(data){$scope.rsRoom=data}),$scope.$watch("rsRoom",function(rs){$scope.dataRooms=rs,$scope.tableParams5.reload()})})},$scope.addNewSite=function(){$state.go("loggedIn.admin_sites_new")},$scope.editSite=function(b){$state.go("loggedIn.admin_sites_edit",{id:b.id})},$scope.showSiteCalendar=function(b){$scope.selectedSite=b,$scope.selectedId=b.id,$scope.selectedCal=null,$scope.arr=[],$scope.arrState=[],$scope.arrSuburb=[],$scope.rs=[],$scope.rsState=[],$scope.rsSuburb=[],$scope.rsRoom=[],OnlineBookingAdminService.getCalendarBySiteId(b.id).then(function(data){$scope.rs=data}),OnlineBookingService.getSiteState(b.id).then(function(data){$scope.rsState=data}),OnlineBookingAdminService.getSiteRoom(b.id).then(function(data){$scope.rsRoom=data}),$scope.$watch("rs",function(rs){$scope.arr=rs,$scope.tableParams2.reload()}),$scope.$watch("rsState",function(rs){$scope.arrState=rs,$scope.tableParams3.reload()}),$scope.$watch("rsSuburb",function(rs){$scope.arrSuburb=rs,$scope.tableParams4.reload()}),$scope.$watch("rsRoom",function(rs){$scope.dataRooms=rs,$scope.tableParams5.reload()})},$scope.showStateDetail=function(b){$scope.selectedState=b.state_id,$scope.arrSuburb=[],$scope.rsSuburb=[],OnlineBookingService.getStateSuburb(b.state_id).then(function(data){$scope.rsSuburb=data}),$scope.$watch("rsSuburb",function(rs){$scope.arrSuburb=rs,$scope.tableParams4.reload()}),OnlineBookingAdminService.getStateById(b.state_id).then(function(data){$scope.stateInfo=data[0],$scope.stateInfo.isenable=1==data[0].isenable?"1":"0"})},$scope.showSuburbDetail=function(b){$scope.selectedSuburb=b.suburb_id,OnlineBookingAdminService.getSuburbById(b.suburb_id).then(function(data){$scope.suburbInfo=data[0],$scope.suburbInfo.isenable=1==data[0].isenable?"1":"0"})},$scope.showCalendarDetail=function(b){$scope.selectedCal=b.cal_id,OnlineBookingAdminService.getCalendarById(b.cal_id).then(function(data){$scope.info=data})},$scope.submitState=function(stateForm){$scope.showStateValidation=!0,stateForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.editStateInfo($scope.stateInfo).then(function(data){"success"===data.status?(toastr.success("Edit State Successfully!","Success"),OnlineBookingService.getSiteState($scope.selectedId).then(function(data){$scope.rsState=data}),$scope.$watch("rsState",function(rs){$scope.arrState=rs,$scope.tableParams3.reload()})):"error"===data.status&&toastr.error("Edit State Failed!","Error")})},$scope.submitSuburb=function(suburbForm){$scope.showSuburbValidation=!0,suburbForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.editSuburbInfo($scope.suburbInfo).then(function(data){"success"===data.status?(toastr.success("Edit Suburb Successfully!","Success"),OnlineBookingService.getStateSuburb($scope.selectedState).then(function(data){$scope.rsSuburb=data}),$scope.$watch("rsSuburb",function(rs){$scope.arrSuburb=rs,$scope.tableParams4.reload()})):"error"===data.status&&toastr.error("Edit Suburb Failed!","Error")})},$scope.submitCalendar=function(calendarForm){$scope.showClickedValidation=!0,calendarForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.submitNewCalendar($scope.info).then(function(data){"success"===data.status?(toastr.success("Edit Calendar Successfully!","Success"),OnlineBookingAdminService.getCalendarBySiteId($scope.selectedId).then(function(data){$scope.rs=data}),$scope.$watch("rs",function(rs){$scope.arr=rs,$scope.tableParams2.reload()})):"error"===data.status&&toastr.error("Edit Calendar Failed!","Error")})},$scope.addNewState=function(){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking_Admin/views/newStateModal.html",controller:"NewStateController",size:"md",resolve:{siteId:function(){return $scope.selectedId}}});modalInstance.result.then(function(){OnlineBookingService.getSiteState($scope.selectedId).then(function(data){$scope.rsState=data}),$scope.$watch("rsState",function(rs){$scope.arrState=rs,$scope.tableParams3.reload()})})},$scope.addNewSuburb=function(){var modalInstance=$modal.open({templateUrl:"modules/onlineBooking_Admin/views/newSuburbModal.html",controller:"NewSuburbController",size:"md",resolve:{siteId:function(){return $scope.selectedId},stateId:function(){return $scope.selectedState}}});modalInstance.result.then(function(){OnlineBookingService.getStateSuburb($scope.selectedState).then(function(data){$scope.rsSuburb=data}),$scope.$watch("rsSuburb",function(rs){$scope.arrSuburb=rs,$scope.tableParams4.reload()})})}}).controller("RoomController",function($scope,toastr,$filter,$state,site,isEdit,room,$modalInstance,OnlineBookingAdminService){$scope.siteObj=null!=site?site:null,$scope.isEdit=null!=isEdit?isEdit:!1,$scope.roomObj=null!=room?room:null,$scope.roomInfo={room_name:null,description:null,site_id:$scope.siteObj.id,isEnable:"1"},$scope.isEdit&&null!=room&&OnlineBookingAdminService.getRoom(room.id).then(function(rs){"success"==rs.status?($scope.roomInfo=rs.data,$scope.roomInfo.isEnable=1==rs.data.isEnable?"1":"0"):toast.error("Cannot Get Room Data")}),$scope.cancelClick=function(){$modalInstance.close()},$scope.okClick=function(roomForm){$scope.isSubmit=!0,roomForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.editRoom($scope.roomInfo,$scope.isEdit).then(function(rs){"success"==rs.status.toLowerCase()?(toastr.success("Success"),$modalInstance.close()):toastr.error("Error")})}}).controller("NewStateController",function($scope,$filter,$state,$modalInstance,OnlineBookingService,OnlineBookingAdminService,siteId,toastr){$scope.stateInfo={state_id:null,site_id:siteId,state_name:null,isenable:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.addState=function(stateForm){$scope.showStateValidation=!0,stateForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.insertState($scope.stateInfo).then(function(data){"success"===data.status?(toastr.success("Insert State Successfully!","Success"),$modalInstance.close()):"error"===data.status&&toastr.error("Insert State Failed!","Error")})}}).controller("NewSuburbController",function($scope,$filter,$state,$modalInstance,OnlineBookingService,OnlineBookingAdminService,siteId,stateId,toastr){$scope.suburbInfo={suburb_id:null,state_id:stateId,site_id:siteId,suburb_name:null,isenable:null},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.addSuburb=function(suburbForm){$scope.showSuburbValidation=!0,suburbForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.insertSuburb($scope.suburbInfo).then(function(data){"success"===data.status?(toastr.success("Insert Suburb Successfully!","Success"),$modalInstance.close()):"error"===data.status&&toastr.error("Insert Suburb Failed!","Error")})}}).controller("AdminNewSiteController",function($scope,$state,OnlineBookingAdminService,toastr){$scope.isEdit=!1,$scope.info={Site_name:null,Site_addr:null,postcode:null,State:null,latitude:null,longitude:null,country:null,Available_def:null,booking_status:null,isPreEmpBK:null},$scope.submitSite=function(siteForm){$scope.showClickedValidation=!0,siteForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.insertNewSite($scope.info).then(function(data){"success"===data.status?(toastr.success("Submit New Site Successfully!","Success"),$state.go("loggedIn.admin_sites_new",null,{reload:!0})):"error"===data.status&&toastr.error("Submit New Site Failed!","Error")})}}).controller("AdminEditSiteController",function($scope,$state,$stateParams,OnlineBookingAdminService,toastr,$cookieStore){$scope.isEdit=!0;var id=$stateParams.id;$scope.info={id:id,Site_name:null,Site_addr:null,postcode:null,State:null,latitude:null,longitude:null,country:null,Available_def:null,booking_status:null,isPreEmpBK:null},OnlineBookingAdminService.getSiteInfo(id).then(function(data){$scope.info=data,$scope.info.isPreEmpBK=1==data.isPreEmpBK?"1":"0"}),$scope.submitSite=function(siteForm){$scope.showClickedValidation=!0,siteForm.$invalid?toastr.error("Please Input All Required Information!","Error"):OnlineBookingAdminService.editSiteInfo($scope.info).then(function(data){"success"===data.status?toastr.success("Edit Site Successfully!","Success"):"error"===data.status&&toastr.error("Edit Site Failed!","Error")})}}),angular.module("app.loggedIn.booking.admin.requiment.controller",[]).controller("RequirementController",function($scope,$state,$modalInstance,idr){$scope.reqmt={idr:idr,success:!1},$scope.$watch("success",function(success){success&&$modalInstance.close($scope.reqmt)})}),angular.module("app.loggedIn.booking.admin.services",[]).factory("OnlineBookingAdminService",function(Restangular){var adminBooking={},api=Restangular.all("api");return adminBooking.getList=function(){var list=api.one("booking/list");return list.get()},adminBooking.editBookingInfo=function(info){var edit=api.all("booking/edit");return edit.post({info:info})},adminBooking.confirmBooking=function(info){var confirm=api.all("booking/confirm");return confirm.post({info:info})},adminBooking.getAssHeader=function(){var head=api.one("assessment/header/list");return head.get()},adminBooking.getAssessment=function(){var a=api.one("assessment/list");return a.get()},adminBooking.deleteHeaderAssessment=function(id){var del=api.all("assessment/header/delete");return del.post({id:id})},adminBooking.addNewHeaderAssessment=function(info){var add=api.all("assessment/header/new");return add.post({info:info})},adminBooking.deleteAssessment=function(id){var del=api.all("assessment/delete");return del.post({id:id})},adminBooking.addNewAssessment=function(info){var add=api.all("assessment/new");return add.post({info:info})},adminBooking.updateAssessment=function(info){var add=api.all("assessment/edit");return add.post({info:info})},adminBooking.getAssessmentInfo=function(id){var a=api.all("assessment/info");return a.post({id:id})},adminBooking.updatePrice=function(){var a=api.all("package/updateFee");return a.post()},adminBooking.getCompanyList=function(){var list=api.one("company/list");return list.get()},adminBooking.getSubCompany=function(id){var sub=api.all("company/sub");return sub.post({id:id})},adminBooking.getCompanyPatients=function(id){return api.all("company/patients").post({companyId:id})},adminBooking.getCompanyInfo=function(id){var sub=api.all("company/info");return sub.post({comId:id})},adminBooking.checkCompanyName=function(name){return api.all("company/checkName").post({name:name})},adminBooking.insertNewCompany=function(info){var add=api.all("company/new");return add.post({info:info})},adminBooking.editCompanyInfo=function(info){var edit=api.all("company/edit");return edit.post({info:info})},adminBooking.getListUser=function(){var list=api.one("users/list");return list.get()},adminBooking.getListCompany=function(){var list=api.one("company/list");return list.get()},adminBooking.getListFunction=function(){var list=api.one("function/list");return list.get()},adminBooking.getListEmployee=function(){var list=api.one("users/employee/list");return list.get()},adminBooking.insertNewUser=function(info){var user=api.all("users/insert");return user.post({info:info,isReg:!1})},adminBooking.getSiteList=function(){var list=api.one("redimedsite/list");return list.get()},adminBooking.getSiteInfo=function(id){var info=api.all("redimedsite/info");return info.post({id:id})},adminBooking.insertNewSite=function(info){var insert=api.all("redimedsite/insert");return insert.post({info:info})},adminBooking.editSiteInfo=function(info){var edit=api.all("redimedsite/edit");return edit.post({info:info})},adminBooking.getCalendarBySiteId=function(id){var info=api.all("calendar/siteId");return info.post({id:id})},adminBooking.getCalendarById=function(id){var info=api.all("calendar/info");return info.post({id:id})},adminBooking.submitNewCalendar=function(info){var submit=api.all("calendar/submit");return submit.post({info:info})},adminBooking.getUserMenu=function(id){var list=api.all("users/menu");return list.post({id:id})},adminBooking.getMenuList=function(){var list=api.one("menu/list/root");return list.get()},adminBooking.getUserMenuDetails=function(id){var detail=api.all("users/menu/details");return detail.post({id:id})},adminBooking.editUserMenu=function(info){var edit=api.all("users/menu/edit");return edit.post({info:info})},adminBooking.insertUserMenu=function(info){var insert=api.all("users/menu/insert");return insert.post({info:info})},adminBooking.getStateById=function(id){var state=api.all("redimedsite/state/id");return state.post({id:id})},adminBooking.getSuburbById=function(id){var suburb=api.all("redimedsite/state/suburb/id");return suburb.post({id:id})},adminBooking.editStateInfo=function(info){var edit=api.all("redimedsite/state/edit");return edit.post({info:info})},adminBooking.editSuburbInfo=function(info){var edit=api.all("redimedsite/state/suburb/edit");return edit.post({info:info})},adminBooking.insertState=function(info){var insert=api.all("redimedsite/state/insert");return insert.post({info:info})},adminBooking.insertSuburb=function(info){var insert=api.all("redimedsite/state/suburb/insert");return insert.post({info:info})},adminBooking.getSiteRoom=function(site_id){return api.all("redimedsite/room").post({site_id:site_id})},adminBooking.delUserMenu=function(id){var del=api.all("users/menu/delete");return del.post({id:id})},adminBooking.getAlert=function(data){var get=api.all("booking/getalert");return get.post({data:data})},adminBooking.updateAlert=function(data){var get=api.all("booking/updatealert");return get.post({data:data})},adminBooking.getDisable=function(data){var get=api.all("booking/getdisable");return get.post({data:data})},adminBooking.editRoom=function(roomInfo,isEdit){return api.all("redimedsite/room/edit").post({info:roomInfo,isEdit:isEdit})},adminBooking.getRoom=function(id){return api.all("redimedsite/room/details").post({room_id:id})},adminBooking.getAvailableRoom=function(siteId,doctorId){return api.all("redimedsite/room/available").post({site_id:siteId,doctor_id:doctorId})},adminBooking}),angular.module("app.loggedIn.booking.admin.requirement.directive",[]).directive("requirementList",function(OnlineBookingAdminService,$filter,$modal,$state,$stateParams,toastr){return{restrict:"EA",templateUrl:"modules/onlineBooking_Admin/directives/templates/requirements.html",scope:{options:"=",idr:"=",success:"="},link:function(scope,ele,attrs){var search={limit:5,offset:0,max_size:5,page:1,company_id:scope.idr},load=function(){OnlineBookingAdminService.getAlert(search).then(function(response){scope.req.list=angular.copy(response.data),scope.req.count=response.count},function(error){})};scope.setPage=function(page){scope.req.search.offset=(page-1)*scope.req.search.limit,scope.req.load()};var add=function(){$modal.open({templateUrl:"ReAlertAdd_R",controller:function($scope,alert_id,$modalInstance){$scope.alerts={success:!1,alert_id:alert_id},$scope.$watch("alerts.success",function(success){success&&$modalInstance.close("success")})},resolve:{alert_id:function(){return scope.idr}}}).result.then(function(response){scope.req.load(),scope.success="success"})},disable=function(d){OnlineBookingAdminService.getDisable(d).then(function(response){scope.req.load()},function(error){})},edit=function(g){$modal.open({templateUrl:"ReAlertEdit_R",controller:function($scope,alert_id,$modalInstance){$scope.alertedit={success:!1,alert_id:alert_id},$scope.$watch("alertedit.success",function(success){success&&$modalInstance.close("success")})},resolve:{alert_id:function(){return g.id}}}).result.then(function(response){scope.req.load()})};scope.req={search:search,list:{id:0,name:"",description:"",company_id:0},loading:!1,error:[],count:0,load:function(){load()},add:function(){add()},edit:function(g){edit(g)},disable:function(d){disable(d)}},scope.req.load()}}}),angular.module("app.loggedIn.outreferral",["app.loggedIn.outreferral.include"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.outreferral",{"abstract":!0,url:"/outreferral"}).state("loggedIn.patient.outreferral.list",{url:"/list",views:{"main-content@loggedIn.patient":{templateUrl:"modules/outreferral/views/patient/list.html",controller:"OutreferralPatientListController"}}})}),angular.module("app.loggedIn.outreferral.include",["app.loggedIn.outreferral.directives.patientList","app.loggedIn.outreferral.directives.patientAdd","app.loggedIn.outreferral.directives.patientEdit","app.loggedIn.outreferral.directives.patientShow","app.loggedIn.outreferral.controllers.patientList","app.loggedIn.outreferral.model"]),angular.module("app.loggedIn.outreferral.model",[]).factory("OutreferralModel",function(Restangular){var instanceService={},appApi=Restangular.all("api/meditek/v1/outreferral");
return instanceService.checkPatientCalendar=function(data){var detailApi=appApi.all("checkPatientCalendar");return detailApi.post({data:data})},instanceService.listFollowPatient=function(data){var detailApi=appApi.all("listFollowPatient");return detailApi.post({data:data})},instanceService.listNoFollowPatient=function(data){var detailApi=appApi.all("listNoFollowPatient");return detailApi.post({data:data})},instanceService.checkReferral=function(data){var detailApi=appApi.all("checkReferral");return detailApi.post({data:data})},instanceService.add=function(data){var detailApi=appApi.all("add");return detailApi.post({data:data})},instanceService.select=function(data){var detailApi=appApi.all("selectPatient");return detailApi.post({data:data})},instanceService.addPatient=function(data){var detailApi=appApi.all("addPatient");return detailApi.post({data:data})},instanceService.edit=function(data){var detailApi=appApi.all("edit");return detailApi.post({data:data})},instanceService.remove=function(data){var detailApi=appApi.all("remove");return detailApi.post({data:data})},instanceService.one=function(data){var detailApi=appApi.all("one");return detailApi.post({data:data})},instanceService.updateEnable=function(data){var detailApi=appApi.all("updateEnable");return detailApi.post({data:data})},instanceService.DotorFromUserId=function(data){var detailApi=appApi.all("DotorFromUserId");return detailApi.post({data:data})},instanceService.DotorFromDoctorId=function(data){var detailApi=appApi.all("DotorFromDoctorId");return detailApi.post({data:data})},instanceService}),angular.module("app.loggedIn.outreferral.controllers.patientList",[]).controller("OutreferralPatientListController",function($scope,$modal,$stateParams,toastr){var add=function(){$modal.open({templateUrl:"dialogOutreferralAdd",controller:"OutreferralPatientAddDialog",size:"lg",resolve:{patientId:function(){return $stateParams.patient_id}}}).result.then(function(response){"success"===response&&(toastr.success("Added Successfully"),$scope.outreferral.reload=!0)})};$scope.outreferral={dialog:{add:function(){add(),$scope.outreferral.reload=!1}},reload:!1,limit:20,Patient_id:$stateParams.patient_id}}).controller("OutreferralPatientAddDialog",function($scope,$modalInstance,$stateParams,patientId,AppointmentModel){$scope.patientId=patientId,$scope.calId=$stateParams.cal_id,$scope.success=!1,AppointmentModel.one({CAL_ID:$scope.calId}).then(function(response){$scope.doctorId=response.data.DOCTOR_ID}),$scope.$watch("success",function(success){success&&$modalInstance.close("success")})}),angular.module("app.loggedIn.outreferral.directives.patientList",[]).controller("OutreferralPatientRemoveDialog",function($scope,$modalInstance,list){$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.ok=function(){$modalInstance.close(list)}}).controller("OutreferralPatientEditDialog",function($scope,$modalInstance,$stateParams,list){$scope.outreferral={id:list.id,patient_id:list.patient_id,success:!1},$scope.$watch("outreferral.success",function(success){success&&$modalInstance.close("success")})}).controller("OutreferralPatientShowDialog",function($scope,$modalInstance,$stateParams,list){$scope.outreferral={id:list.id,patient_id:list.patient_id,success:!1},$scope.$watch("outreferral.success",function(success){success&&$modalInstance.close("success")})}).directive("outreferralPatientList",function(OutreferralModel,$modal,toastr,$stateParams,$timeout){return{restrict:"EA",scope:{reload:"=",limit:"=",patientId:"=",calId:"=",doctorId:"=",withoutPatient:"@",permission:"@",onRowClick:"&",addSuccess:"="},templateUrl:"modules/outreferral/directives/templates/patientList.html",link:function(scope,elem,attrs){scope.action="undefined"==typeof scope.permission?{edit:!0,remove:!0,add:trues}:scope.$eval(scope.permission);var search={page:1,limit:scope.limit,offset:0,max_size:5,patient_id:scope.patientId},load=function(){var postData=angular.copy(scope.outreferral.search);"undefined"!=typeof scope.withoutPatient&&scope.withoutPatient?OutreferralModel.listNoFollowPatient(postData).then(function(response){scope.outreferral.list=response.data,scope.outreferral.count=response.count},function(error){}):OutreferralModel.listFollowPatient(postData).then(function(response){scope.outreferral.list=response.data,scope.outreferral.count=response.count},function(error){})},clickDisale=function(row){var postData={CAL_ID:$stateParams.cal_id,patient_id:row.patient_id,outreferral_id:row.id,isEnable:row.isEnable};console.log(postData),OutreferralModel.updateEnable(postData).then(function(response){scope.outreferral.load()},function(error){})},onPage=function(page){scope.outreferral.search.offset=(page-1)*scope.outreferral.search.limit,scope.outreferral.load()},onSearch=function(){scope.outreferral.load(),scope.outreferral.search.page=1},onOrderBy=function(option){switch(option.field){case"Claim_date":scope.outreferral.search.Claim_date=option.order;break;case"Injury_date":scope.outreferral.search.Injury_date=option.order}scope.outreferral.load()},remove=function(list){$modal.open({templateUrl:"dialogOutreferralRemove",controller:"OutreferralPatientRemoveDialog",size:"sm",resolve:{list:function(){return list}}}).result.then(function(list){OutreferralModel.remove(list).then(function(response){toastr.success("Deleted Successfully"),scope.outreferral.load()},function(error){})})},edit=function(list){$modal.open({templateUrl:"dialogOutreferralEdit",controller:"OutreferralPatientEditDialog",size:"lg",resolve:{list:function(){return list}}}).result.then(function(response){"success"===response&&(toastr.success("Edit Successfully"),scope.outreferral.load())})},add=function(){$modal.open({templateUrl:"referralAdd",controller:function($scope,$modalInstance,patientId,calId,doctorId){$scope.outreferral={Patient_id:patientId,success:!1,calId:calId},$timeout(function(){$scope.outreferral.doctorId=doctorId,$scope.outreferral.calId=calId},600),$scope.$watch("outreferral.success",function(success){success&&$modalInstance.close("success")})},size:"lg",resolve:{patientId:function(){return scope.patientId},calId:function(){return scope.calId},doctorId:function(){return scope.doctorId}}}).result.then(function(success){"success"===success&&(toastr.success("Add Successfully"),scope.addSuccess=!0)})},show=function(list){$modal.open({templateUrl:"dialogOutreferralShow",controller:"OutreferralPatientShowDialog",size:"lg",resolve:{list:function(){return list}}}).result.then(function(response){"success"===response&&(toastr.success("Edit Successfully"),scope.outreferral.load())})};scope.outreferral={dialog:{add:function(){add()},remove:function(list){remove(list)},edit:function(list){edit(list)},show:function(list){show(list)}},load:function(){load()},list:[],count:0,search:angular.copy(search),onPage:function(page){onPage(page)},onSearch:function(){onSearch()},onOrderBy:function(option){onOrderBy(option)},clickEnable:function(row){clickEnable(row)},clickDisale:function(row){clickDisale(row)}},scope.outreferral.load(),scope.$watch("reload",function(reload){scope.outreferral.search=angular.copy(search),reload&&scope.outreferral.load()})}}}),angular.module("app.loggedIn.outreferral.directives.patientAdd",[]).directive("outreferralPatientAdd",function($cookieStore,$modal,OutreferralModel,ConfigService,$stateParams){return{restrict:"EA",scope:{patientId:"=",calId:"=",success:"=",doctorId:"=",data:"="},templateUrl:"modules/outreferral/directives/templates/patientAdd.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,form=($cookieStore.get("userInfo").user_type,{CAL_ID:scope.calId,patient_id:scope.patientId,date_issued:null,date_started:null,duration:null,expire_date:null,referred_to_doctor:null,doctor_id:null,created_by:user_id,last_updated_by:user_id});scope.$watch("calId",function(calId){"undefined"!=typeof calId&&(form.CAL_ID=calId)});var save=function(){ConfigService.beforeSave(scope.outreferral.errors);var postData=angular.copy(scope.outreferral.form);postData.Creation_date=postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.date_issued&&(postData.date_issued=ConfigService.convertToDB(postData.date_issued)),postData.date_started&&(postData.date_started=ConfigService.convertToDB(postData.date_started)),postData.expire_date&&(postData.expire_date=ConfigService.convertToDB(postData.expire_date)),OutreferralModel.addPatient(postData).then(function(response){scope.success=!0},function(error){scope.outreferral.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.outreferral.errors)})};scope.$watch("doctorId",function(doctorId){if("undefined"!=typeof doctorId){var postData=doctorId;OutreferralModel.DotorFromUserId(postData).then(function(response){scope.outreferral.form.referred_to_doctor=response.data[0].doctor_id,scope.referdoctor.name=response.data[0].NAME},function(error){})}});var load=function(){},outdoctorSelect=function(){$modal.open({templateUrl:"selectOutdoctorDialog",size:"lg",controller:function($scope,$modalInstance){$scope.$watch("data",function(data){"undefined"!=typeof data&&$modalInstance.close(data)}),$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.outreferral.form.doctor_id=row.doctor_id,scope.outdoctor.name=row.name})},doctorSelect=function(){$modal.open({templateUrl:"selectDoctorDialog",size:"lg",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.outreferral.form.referred_to_doctor=row.doctor_id,scope.referdoctor.name=row.NAME})};scope.outreferral={form:angular.copy(form),errors:[],save:function(){save()}},scope.outdoctor={name:"Select Outside Doctor",dialog:{select:function(){outdoctorSelect()}}},scope.referdoctor={name:"Referred To Doctor",dialog:{select:function(){doctorSelect()}}},scope.onChange=function(){if(null!=scope.outreferral.form.date_started)if(null==scope.outreferral.form.duration)scope.outreferral.form.expire_date=scope.outreferral.form.date_started;else{var a=parseInt(scope.outreferral.form.duration),date_started=ConfigService.convertToDB(scope.outreferral.form.date_started);date_started=moment(date_started).format();var b=moment(date_started).add(a,"months").toString(),date=moment(b).format("YYYY-MM-DD");date=ConfigService.convertToDate(date),scope.outreferral.form.expire_date=date}},scope.outreferral={form:angular.copy(form),load:function(){load()},errors:[],save:function(){save()}},scope.outreferral.load()}}}),angular.module("app.loggedIn.outreferral.directives.patientShow",[]).directive("outreferralPatientShow",function($cookieStore,$modal,OutreferralModel,ConfigService){return{restrict:"EA",scope:{patientId:"=",id:"=",success:"="},templateUrl:"modules/outreferral/directives/templates/patientShow.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,form={patient_id:scope.patientId,date_issued:null,date_started:null,duration:null,expire_date:null,referred_to_doctor:null,doctor_id:null,created_by:user_id,last_updated_by:user_id},save=function(){ConfigService.beforeSave(scope.outreferral.errors);var postData=angular.copy(scope.outreferral.form);postData.Creation_date=postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.date_issued&&(postData.date_issued=ConfigService.convertToDB(postData.date_issued)),postData.date_started&&(postData.date_started=ConfigService.convertToDB(postData.date_started)),postData.expire_date&&(postData.expire_date=ConfigService.convertToDB(postData.expire_date)),OutreferralModel.edit(postData).then(function(response){scope.success=!0},function(error){scope.outreferral.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.outreferral.errors)})},outdoctorSelect=function(){$modal.open({templateUrl:"selectOutdoctorDialog",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.outreferral.form.doctor_id=row.doctor_id,scope.outdoctor.name=row.name})},doctorSelect=function(){$modal.open({templateUrl:"selectDoctorDialog",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.outreferral.form.referred_to_doctor=row.doctor_id,scope.referdoctor.name=row.NAME})},load=function(){var postData={id:scope.id};OutreferralModel.one(postData).then(function(response){angular.extend(scope.outreferral.form,response.data),scope.outreferral.form.date_issued=ConfigService.convertToDate(scope.outreferral.form.date_issued),scope.outreferral.form.expire_date=ConfigService.convertToDate(scope.outreferral.form.expire_date),scope.outreferral.form.date_started=ConfigService.convertToDate(scope.outreferral.form.date_started),scope.referdoctor.name=scope.outreferral.form.doctor_name,scope.outdoctor.name=scope.outreferral.form.outdoctor_name,delete scope.outreferral.form.creation_date,delete scope.outreferral.form.doctor_name,delete scope.outreferral.form.outdoctor_name},function(error){})};scope.outreferral={form:angular.copy(form),load:function(){load()},errors:[],save:function(){save()}},scope.outdoctor={name:"Select Outside Doctor",dialog:{select:function(){outdoctorSelect()}}},scope.referdoctor={name:"Referred To Doctor",dialog:{select:function(){doctorSelect()}}},scope.outreferral.load()}}}),angular.module("app.loggedIn.outreferral.directives.patientEdit",[]).directive("outreferralPatientEdit",function($cookieStore,$modal,OutreferralModel,ConfigService){return{restrict:"EA",scope:{patientId:"=",id:"=",success:"=",data:"="},templateUrl:"modules/outreferral/directives/templates/patientEdit.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,form={patient_id:scope.patientId,date_issued:null,date_started:null,duration:null,expire_date:null,referred_to_doctor:null,doctor_id:null,created_by:user_id,last_updated_by:user_id},save=function(){ConfigService.beforeSave(scope.outreferral.errors);var postData=angular.copy(scope.outreferral.form);postData.Creation_date=postData.last_update_date=moment().format("YYYY-MM-DD"),postData.date_issued&&(postData.date_issued=ConfigService.convertToDB(postData.date_issued)),postData.date_started&&(postData.date_started=ConfigService.convertToDB(postData.date_started)),postData.expire_date&&(postData.expire_date=ConfigService.convertToDB(postData.expire_date)),OutreferralModel.edit(postData).then(function(response){scope.success=!0},function(error){scope.outreferral.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.outreferral.errors)})},outdoctorSelect=function(){$modal.open({templateUrl:"selectOutdoctorDialog",size:"lg",controller:function($scope,$modalInstance){$scope.$watch("data",function(data){"undefined"!=typeof data&&$modalInstance.close(data)}),$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.outreferral.form.doctor_id=row.doctor_id,scope.outdoctor.name=row.name})},doctorSelect=function(){$modal.open({templateUrl:"selectDoctorDialog",size:"lg",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.outreferral.form.referred_to_doctor=row.doctor_id,scope.referdoctor.name=row.NAME})},load=function(){var postData={id:scope.id};OutreferralModel.one(postData).then(function(response){angular.extend(scope.outreferral.form,response.data),scope.outreferral.form.date_issued=ConfigService.convertToDate(scope.outreferral.form.date_issued),scope.outreferral.form.expire_date=ConfigService.convertToDate(scope.outreferral.form.expire_date),scope.outreferral.form.date_started=ConfigService.convertToDate(scope.outreferral.form.date_started),scope.referdoctor.name=scope.outreferral.form.doctor_name,scope.outdoctor.name=scope.outreferral.form.outdoctor_name,delete scope.outreferral.form.creation_date,delete scope.outreferral.form.doctor_name,delete scope.outreferral.form.outdoctor_name},function(error){})};scope.onChange=function(){if(null!=scope.outreferral.form.date_started)if(null==scope.outreferral.form.duration)scope.outreferral.form.expire_date=scope.outreferral.form.date_started;else{var a=parseInt(scope.outreferral.form.duration),date_started=ConfigService.convertToDB(scope.outreferral.form.date_started);date_started=moment(date_started).format();var b=moment(date_started).add(a,"months").toString(),date=moment(b).format("YYYY-MM-DD");date=ConfigService.convertToDate(date),scope.outreferral.form.expire_date=date}},scope.outreferral={form:angular.copy(form),load:function(){load()},errors:[],save:function(){save()}},scope.outdoctor={name:"Select Outside Doctor",dialog:{select:function(){outdoctorSelect()}}},scope.referdoctor={name:"Referred To Doctor",dialog:{select:function(){doctorSelect()}}},scope.outreferral.load()}}});var ptnConst={apptStatus:{booking:{value:"Booking",display:"Booking"},checkedIn:{value:"Checked In",display:"Checked In"},waiting:{value:"Waiting",display:"Waiting"},urgent:{value:"Urgent",display:"Urgent"},inConsult:{value:"In Consult",display:"In Consult"},completed:{value:"Completed",display:"Completed"},billing:{value:"Billing",display:"Billing"},close:{value:"Close",display:"Close"},cancelled:{value:"Cancelled",display:"Cancelled"}},apptStatusDisplay:{Booking:"Booking","Checked In":"Checked In",Waiting:"Waiting",Urgent:"Urgent","In Consult":"In Consult",Completed:"Completed",Billing:"Billing",Close:"Close",Cancelled:"Cancelled"},unit:{mg:{value:"mg",display:"mg"},g:{value:"g",display:"g"},litre:{value:"litre",display:"litre"},tablet:{value:"tablet",display:"tablet"},capsule:{value:"capsule",display:"capsule"}},route:{PO:{value:"PO",display:"PO"},PR:{value:"PR",display:"PR"},IV:{value:"IV",display:"IV"},IM:{value:"IM",display:"IM"},SC:{value:"S/C",display:"S/C"},Topical:{value:"Topical",display:"Topical"}},frequency:{OD:{value:"1",display:"OD"},BD:{value:"2",display:"BD"},TDS:{value:"3",display:"TDS"},QID:{value:"4",display:"QID"}}};angular.module("app.loggedIn.patient",["app.loggedIn.patient.controller","app.loggedIn.patient.services","app.loggedIn.patient.directives","app.loggedIn.patient.listall.controller","app.loggedIn.patient.claim","app.loggedIn.patient.consult","app.loggedIn.patient.injuryManagement","app.loggedIn.patient.problem","app.loggedIn.patient.makecall.directive"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient",{url:"/patient/:patient_id/:cal_id",templateUrl:"modules/patient/views/structure.html",controller:"PatientController"}).state("loggedIn.patient.list",{url:"/list",views:{"main-content":{templateUrl:"modules/patient/views/list.html",controller:"PatientListController"}}}).state("loggedIn.patient.appointment",{url:"/appointment",views:{"main-content":{templateUrl:"modules/patient/views/appointment.html",controller:"PatientAppointmentController"}}}).state("loggedIn.patient.detail",{url:"/detail",views:{"main-content":{templateUrl:"modules/patient/views/detail.html",controller:"PatientDetailController"}}}).state("loggedIn.patient.invoice_detail",{url:"/:header_id/invoices/detail",views:{"main-content":{templateUrl:"modules/patient/views/invoice_detail.html",controller:"PatientInvoiceDetailController"}}}).state("loggedIn.patient.invoices",{url:"/invoices",views:{"main-content":{templateUrl:"modules/patient/views/invoices.html",controller:"PatientInvoicesController"}}}).state("loggedIn.patient.recall",{url:"/recall",views:{"main-content":{templateUrl:"modules/patient/views/recall.html",controller:"PatientRecallController"}}}).state("loggedIn.patient.appt",{url:"/appt",views:{"main-content":{templateUrl:"modules/patient/views/appt.html",controller:"PatientApptListController"}}}).state("loggedIn.patient.workcover",{url:"/workcover",views:{"main-content":{templateUrl:"modules/patient/views/workcover.html",controller:"PatientWorkcoverController"}}}).state("loggedIn.patient.booking",{url:"/booking",views:{"main-content":{templateUrl:"modules/patient/views/booking.html",controller:"PatientBookingController"}}}).state("loggedIn.patient.referrals",{url:"/referrals",views:{"main-content":{templateUrl:"modules/patient/views/referrals.html",controller:"PatientReferralsController"}}}).state("loggedIn.patient.itemsheet",{url:"/appointment/itemsheet",views:{"main-content":{templateUrl:"modules/patient/views/itemsheet.html",controller:"PatientItemSheetController"}}}).state("loggedIn.patient.apptdoc",{url:"/appointment/document",views:{"main-content":{templateUrl:"modules/patient/views/apptdoc.html",controller:"PatientApptDocController"}}}).state("loggedIn.listall",{url:"/allPatients",templateUrl:"modules/patient/views/allpatients.html",controller:"PatientListAllController"}).state("loggedIn.checkin",{url:"/checkin",templateUrl:"modules/patient/views/checkin.html",controller:"PatientCheckinController"})}),angular.module("app.loggedIn.patient.services",[]).factory("PatientService",function(Restangular,ConfigService,$state){var instanceService={},appApi=Restangular.all("api"),mdtApi=Restangular.all("api/meditek/v1/patient/"),khankAPI=Restangular.all("api/erm/v2"),restfulAPI=Restangular.all("api/restful");return instanceService.getP=function(patient_id){var fP=mdtApi.all("getID");return fP.post({patient_id:patient_id})},instanceService.get=function(patient_id){return restfulAPI.one("Patient/"+patient_id).get()},instanceService.getApptClaim=function(patient_id,cal_id){return restfulAPI.one("mdtPatientClaim").get({CAL_ID:cal_id,Patient_id:patient_id})},instanceService.insertApptClaim=function(data){return restfulAPI.all("mdtPatientClaim").post(data)},instanceService.getListAllergyinPatient=function(search){var funcApi=khankAPI.all("allergy/list_patient_allergy_enable");return funcApi.post({search:search})},instanceService.numCompanies=function(patient_id){var funcApi=khankAPI.one("patients/num_companies");return funcApi.get({id:patient_id})},instanceService.numClaims=function(patient_id){var funcApi=khankAPI.one("patients/num_claims");return funcApi.get({id:patient_id})},instanceService.mumReferrals=function(patient_id){var funcApi=khankAPI.one("patients/num_referrals");return funcApi.get({id:patient_id})},instanceService.numOutReferrals=function(patient_id){var funcApi=khankAPI.one("patients/num_outside_referrals");return funcApi.get({id:patient_id})},instanceService.numScripts=function(patient_id){var funcApi=khankAPI.one("patients/num_scripts");return funcApi.get({id:patient_id})},instanceService.numDocuments=function(patient_id){var funcApi=khankAPI.one("patients/num_documents");return funcApi.get({id:patient_id})},instanceService.numRecalls=function(patient_id){var funcApi=khankAPI.one("patients/num_recalls");return funcApi.get({id:patient_id})},instanceService.checkPatietnInfo=function(First_name,Sur_name,Middle_name,DOB){var funcApi=khankAPI.all("patients/check_patient_info");return funcApi.post({First_name:First_name,Sur_name:Sur_name,Middle_name:Middle_name,DOB:DOB})},instanceService.getDoctorInfoByUserId=function(user_id){var funcApi=khankAPI.all("doctor/doctor_info_by_user_id");return funcApi.post({user_id:user_id})},instanceService.initInvoice=function(patient_id,cal_id){var funcApi=khankAPI.all("invoice/init");return funcApi.post({patient_id:patient_id,cal_id:cal_id})},instanceService.endInvoice=function(patient_id,cal_id){var funcApi=khankAPI.all("invoice/end");return funcApi.post({patient_id:patient_id,cal_id:cal_id})},instanceService.invoiceDetail=function(header_id){var funcApi=khankAPI.all("invoice/detail");return funcApi.post({header_id:header_id})},instanceService.invoiceSave=function(header_id){var funcApi=khankAPI.all("invoice/save");return funcApi.post({header_id:header_id})},instanceService.getAppointments=function(patient_id){var funcApi=khankAPI.all("patients/appointments");return funcApi.post({patient_id:patient_id})},instanceService.getRecallAppointments=function(patient_id){var funcApi=khankAPI.all("patients/recall_appointments");return funcApi.post({patient_id:patient_id})},instanceService.getRecallAppointmentsNew=function(postData){var funcApi=khankAPI.all("patients/recall_appointments_new");return funcApi.post({data:postData})},instanceService.getDeptItems=function(dept_id){var funcApi=khankAPI.all("itemsheet/dept_items");return funcApi.post({id:dept_id})},instanceService.saveItemSheet=function(listitem){var funcApi=khankAPI.all("itemsheet/insert_dept_items");return funcApi.post({list:listitem})},instanceService.getApptItems=function(appt_id,patient_id){var funcApi=khankAPI.all("itemsheet/appt_items");return funcApi.post({appt_id:appt_id,patient_id:patient_id})},instanceService.deleteFile=function(id){var funcApi=khankAPI.all("apptdoc/delete");return funcApi.post({ID:id})},instanceService.checkIn=function(cal_id,patient_id){var funcApi=khankAPI.all("appt/check_in");return funcApi.post({CAL_ID:cal_id,Patient_id:patient_id,data:{appt_status:ptnConst.apptStatus.checkedIn.value}})},instanceService.mdtVerifiedMedicare=function(options){return khankAPI.all("patient/verified_medicare").post(options)},instanceService.mdtSearch=function(options){var funcApi=mdtApi.all("search");return funcApi.post(options)},instanceService.mdtEdit=function(postData){var funcApi=mdtApi.all("edit");return funcApi.post(postData)},instanceService.mdtAdd=function(postData){var funcApi=mdtApi.all("add");return funcApi.post(postData)},instanceService.mdtById=function(Patient_id){var funcApi=mdtApi.all("byId");return funcApi.post({Patient_id:Patient_id})},instanceService.mdtInsertWaitingList=function(params){var funcApi=mdtApi.all("waiting_list/add");return funcApi.post(params)},instanceService.mdtClaimSearch=function(options){var funcApi=mdtApi.all("claim/search");return funcApi.post(options)},instanceService.getClaim=function(claim_id){var claimApi=appApi.all("patient/getClaim");return claimApi.post({Claim_id:claim_id})},instanceService.insertClaim=function(data,Patient_id,CAL_ID){var claimApi=appApi.all("patient/insertClaim");return claimApi.post({add_data:data,Patient_id:Patient_id,CAL_ID:CAL_ID})},instanceService.editClaim=function(data){var claimApi=appApi.all("patient/editClaim");return claimApi.post(data)},instanceService.getSkinApp=function(image){var skinappApi=appApi.all("v1/skinapp/patient/image");return skinappApi.post({image:image})},instanceService.update=function(patient_info){var Patient_id=patient_info.Patient_id;delete patient_info.Patient_id;var detailApi=appApi.all("erm/v2/patients/update");return detailApi.post({Patient_id:Patient_id,data:patient_info})},instanceService.getAppointment=function(patient_id,doctor_id){var detailApi=appApi.one("erm/v1/appointment/get_by_patient");return detailApi.get({patient_id:patient_id,doctor_id:doctor_id})},instanceService.getById=function(patient_id){var detailApi=appApi.one("erm/v1/patients/get_by_id");return detailApi.get({patient_id:patient_id})},instanceService.search=function(option){var listApi=appApi.all("erm/v1/patients/search");return listApi.post(option)},instanceService.getByOption=function(option){var detailApi=appApi.all("patient/get_by_option");return detailApi.post(option)},instanceService.getTotals=function(){var detailApi=appApi.one("patient/totals");return detailApi.get()},instanceService.listAccType=function(){var detailApi=appApi.one("patient/list_account_type");return detailApi.get()},instanceService.listPrvFund=function(){var detailApi=appApi.one("patient/list_private_fund");return detailApi.get()},instanceService.insertPatient=function(data){var detailApi=appApi.all("patient/insert");return detailApi.post(data)},instanceService.updatePatient=function(data){var detailApi=appApi.all("patient/update");return detailApi.post(data)},instanceService.getPatient=function(patient_id){var detailApi=appApi.all("patient/get_by_id");return detailApi.post({patient_id:patient_id})},instanceService.post=function(data){var detailApi=appApi.all("patient/post");return detailApi.post(data)},instanceService.getReferral=function(option){var detailApi=appApi.all("patient/getReferral");return detailApi.post(option)},instanceService.insertReferral=function(data){var detailApi=appApi.all("patient/insertReferral");return detailApi.post({data:data})},instanceService.updateReferral=function(data){var detailApi=appApi.all("patient/updateReferral");return detailApi.post({data:data})},instanceService.getScript=function(option){var detailApi=appApi.all("patient/getScript");return detailApi.post(option)},instanceService.updateScript=function(data){var detailApi=appApi.all("patient/updateScript");return detailApi.post({data:data})},instanceService.insertScript=function(data){var detailApi=appApi.all("patient/insertScript");return detailApi.post({data:data})},instanceService.workcoverSearch=function(patient_id){var detailApi=khankAPI.all("assessments/group_search");return detailApi.post({patient_id:patient_id})},instanceService.workcoverSearchOpt=function(type,patient_id){var cols=[],time_field={field:"Creation_date",label:"Creation date",type:"custom",fn:function(item){return ConfigService.convertToDatetime(item.Creation_date)}},doctor_field={field:"doctor",not_submit:!0,label:"Doctor",type:"custom",fn:function(item){return item.user?item.user.Booking_Person:void 0}},edit_action=null,print_href="http://testapp.redimed.com.au:3003/RedimedJavaREST/api/document/",print_action=null;switch(type){case"first":cols=[{field:"Ass_id",is_hide:!0},{field:"cal_id"},doctor_field,time_field],edit_action=function(item){$state.go("loggedIn.waworkcover.first",{action:"edit",patient_id:patient_id,cal_id:item.cal_id,wc_id:item.Ass_id})},print_action=function(item){print_href+="firstWA/"+item.Ass_id,window.open(print_href)};break;case"progress":cols=[{field:"progress_id",is_hide:!0},{field:"cal_id"},doctor_field,time_field],edit_action=function(item){$state.go("loggedIn.waworkcover.progress",{action:"edit",patient_id:patient_id,cal_id:item.cal_id,wc_id:item.progress_id})},print_action=function(item){print_href+="progressWA/"+item.progress_id,window.open(print_href)};break;case"final":cols=[{field:"id",is_hide:!0},{field:"cal_id"},doctor_field,time_field],edit_action=function(item){$state.go("loggedIn.waworkcover.final",{action:"edit",patient_id:patient_id,cal_id:item.cal_id,wc_id:item.id})},print_action=function(item){print_href+="finalWA/"+item.id,window.open(print_href)};break;case"general":cols=[{field:"id",is_hide:!0},{field:"cal_id"},doctor_field,time_field],edit_action=function(item){$state.go("loggedIn.waworkcover.general",{action:"edit",patient_id:patient_id,cal_id:item.cal_id,wc_id:item.id})},print_action=function(item){print_href+="general/"+item.id,window.open(print_href)}}return{api:"api/erm/v2/assessments/search",method:"post",columns:cols,"static":!0,search:{patient_id:patient_id,type:type},use_actions:!0,actions:[{"class":"fa fa-pencil",title:"Edit",callback:edit_action},{"class":"fa fa-print",title:"Print",callback:print_action}]}},instanceService.Add_CAL=function(data){var funcApi=mdtApi.all("appt_add");return funcApi.post({data:data})},instanceService}),angular.module("app.loggedIn.patient.directives",["app.loggedIn.patient.detail.directive","app.loggedIn.patient.claim.directive","app.loggedIn.patient.outside_referral.directive","app.loggedIn.patient.waiting_list.directive","app.loggedIn.patient.search.directive","app.loggedIn.patient.companies.directive","app.loggedIn.patient.ngthumb.directive"]),angular.module("app.loggedIn.patient.detail.directive",["app.loggedIn.patient.detail.master.controller"]).directive("patientDetail",function(){return{restrict:"EA",scope:{options:"=",isClose:"@",patient:"=",params:"=",onsuccess:"=",actionCenter:"="},templateUrl:"modules/patient/directives/templates/detail.html",controller:"PatientDetailMasterController"}}).directive("patientRegister",function(){return{restrict:"EA",scope:{options:"=",params:"=",actionCenter:"="},templateUrl:"modules/patient/directives/templates/detail-register.html",controller:"PatientDetailMasterController"}}),angular.module("app.loggedIn.patient.waiting_list.directive",[]).directive("mdtWaitingList",function(WaitingListModel,PatientService,toastr,$cookieStore){
return{restrict:"EA",scope:{options:"=",isClose:"@"},templateUrl:"modules/patient/directives/templates/waiting_list.html",link:function(scope,element,attrs){var initObject=function(){scope.modelObjectMap=angular.copy(WaitingListModel),scope.modelObjectMap.Last_updated_by=$cookieStore.get("userInfo").id,scope.modelObjectMap.Created_by=$cookieStore.get("userInfo").id,scope.isSubmit=!1,scope.selectedDoctor={},scope.selectedDoctor.NAME="Select Doctor",scope.selectedDoctor.error=!0,scope.selectedPatient={},scope.selectedPatient.First_name="Select",scope.selectedPatient.Sur_name="Patient",scope.selectedPatient.error=!0};if(initObject(),scope.isClose)var idClose="#"+scope.isClose;var idSearchDoctor="#searchDoctor",idSearchPatient="#searchPatient";scope.mode={type:"add",text:"Add Waiting List"},scope.closePopup=function(){angular.element(idClose).fadeOut()},scope.selectDoctor=function(row){angular.extend(scope.selectedDoctor,row),scope.selectedDoctor.error=!1,angular.element(idSearchDoctor).fadeOut()},scope.clickDoctor=function(){angular.element(idSearchDoctor).fadeIn()},scope.selectPatient=function(row){angular.extend(scope.selectedPatient,row),scope.selectedPatient.error=!1,angular.element(idSearchPatient).fadeOut()},scope.clickPatient=function(){angular.element(idSearchPatient).fadeIn()},scope.clickAction=function(){if(scope.isSubmit=!0,!scope.waitingForm.$invalid&&!scope.selectedPatient.error&&!scope.selectedDoctor.error){var postData=angular.copy(scope.modelObjectMap);postData.doctor_id=scope.selectedDoctor.doctor_id,postData.Patient_id=scope.selectedPatient.Patient_id,"add"===scope.mode.type&&PatientService.mdtInsertWaitingList(postData).then(function(response){"success"===response.status&&(toastr.success("Insert Successfully","Success"),initObject(),scope.isClose&&scope.closePopup())},function(error){console.log("Server Error")})}}}}}),angular.module("app.loggedIn.patient.claim.directive",[]).directive("patientClaim",function(PatientService,ClaimService,ClaimModel,ConfigService,toastr,Restangular,InsurerService,$cookieStore,CompanyService){return{restrict:"EA",scope:{options:"=",isClose:"@",params:"=",claim:"="},templateUrl:"modules/patient/directives/templates/claim.html",link:function(scope,element,attrs){var patient_id=scope.params.Patient_id;scope.$watch("patientId",function(newPatientId){}),scope.$watch("params.permission.edit",function(){scope.params.permission.edit===!0&&(scope.mode={type:"edit",text:"Edit Claim"},loadInit())});var loadInit=function(){scope.params.permission.edit===!0&&PatientService.getClaim(scope.params.permission.Claim_id).then(function(response){if("success"===response.status){angular.extend(scope.modelObjectMap,response.data);for(var key in scope.modelObjectMap)scope.modelObjectMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is"))&&(scope.modelObjectMap[key]=scope.modelObjectMap[key].toString()),-1!=key.indexOf("_date")&&(scope.modelObjectMap[key]=new Date(scope.modelObjectMap[key])))}})},getInsurerInfo=function(){PatientService.mdtById(patient_id).then(function(response){"success"===response.status&&(null!==response.data.company_id&&void 0!==response.data.company_id&&""!==response.data.company_id?CompanyService.mdtById(response.data.company_id).then(function(response2){null!==response2.data.Insurer&&void 0!==response2.data.Insurer&&""!==response2.data.Insurer?InsurerService.detail(response2.data.Insurer).then(function(insurerData){null!==insurerData.row&&void 0!==insurerData.row&&""!==insurerData.row?(scope.modelObjectMap.insurer_site=insurerData.row.id,scope.modelObjectMap.Insurer=insurerData.row.insurer_name):(scope.modelObjectMap.insurer_site="",scope.modelObjectMap.Insurer="")}):(scope.modelObjectMap.insurer_site="",scope.modelObjectMap.Insurer="")}):(scope.modelObjectMap.insurer_site="",scope.modelObjectMap.Insurer=""))})};if(getInsurerInfo(),scope.isClose)var idClose="#"+scope.isClose;angular.element(idClose).fadeIn(),scope.isSubmit=!1,scope.modelObjectMap=angular.copy(ClaimModel),scope.modelObjectMap.Patient_id=patient_id,scope.modelObjectMap.insurer_site=scope.insurerId,scope.mode={type:"add",text:"Add Claim"},scope.closePopup=function(){angular.element(idClose).fadeOut(),scope.params.permission.edit=!1,scope.mode={type:"add",text:"Add Claim"};var patientid=scope.modelObjectMap.Patient_id;scope.modelObjectMap={},scope.isSubmit=!1,scope.modelObjectMap.Patient_id=patientid,scope.modelObjectMap.insurer_site=scope.insurerId,scope.modelObjectMap.Claim_date=new Date,void 0===scope.params.addClaimShow?getInsurerInfo():scope.params.addClaimShow=!1},scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.claimForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));if("add"==option.type){postData.Created_by=$cookieStore.get("userInfo").id;var CAL_ID=11;console.log("ssaasas"),PatientService.insertClaim(postData,scope.modelObjectMap.Patient_id,CAL_ID).then(function(response){"success"===response.status&&(toastr.success("Added a new Claim","Success"),scope.modelObjectMap=angular.copy(ClaimModel),scope.isSubmit=!1,scope.claim=response.data,scope.modelObjectMap=angular.copy(ClaimModel),getInsurerInfo(),scope.modelObjectMap.Patient_id=patient_id,scope.modelObjectMap.Claim_date=new Date,scope.modelObjectMap.insurer_site=scope.insurerId)})}else postData.Last_updated_by=$cookieStore.get("userInfo").id,PatientService.editClaim(postData).then(function(response){"success"===response.status&&(toastr.success("Edited a new Claim","Success"),scope.isSubmit=!1,angular.element(idClose).fadeOut(),scope.params.permission.edit=!1,scope.mode={type:"add",text:"Add Claim"},scope.modelObjectMap=angular.copy(ClaimModel),getInsurerInfo(),scope.modelObjectMap.Patient_id=patient_id,scope.modelObjectMap.Claim_date=new Date,scope.modelObjectMap.insurer_site=scope.insurerId)})}}}}}),angular.module("app.loggedIn.patient.outside_referral.directive",[]).directive("patientOutsideReferral",function(PatientService,OutsideReferralModel){return{restrict:"EA",scope:{data:"@",options:"="},templateUrl:"modules/patient/directives/templates/outside_referral.html",link:function(scope,element,attrs){if(scope.data)var data=scope.$eval(scope.data);scope.isSubmit=!1,scope.modelObjectMap=angular.copy(OutsideReferralModel),scope.mode={type:"add",text:"Add Outside Referral"},scope.modelObjectMap.Patient_id=data.Patient_id,scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.outsideReferralForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?PatientService.insertClaim(postData).then(function(response){"success"===response.status&&(toastr.success("Added a new Claim","Success"),scope.modelObjectMap=angular.copy(ClaimModel),scope.modelObjectMap.Patient_id=data.Patient_id,scope.isSubmit=!1)}):PatientService.editClaim(postData).then(function(response){"success"===response.status&&(toastr.success("Edited a new Claim","Success"),loadInit(),scope.isSubmit=!1)})}}}}}),angular.module("app.loggedIn.patient.search.directive",[]).directive("patientSearch",function(PatientService){return{restrict:"EA",scope:{clickRow:"&",isClose:"@"},templateUrl:"modules/patient/directives/templates/search.html",link:function(scope,element,attrs){if(scope.list={},scope.isClose)var idClose="#"+scope.isClose;scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"First_name",value:""},{type:"text",name:"Sur_name",value:""}],select:["Patient_id","First_name","Sur_name","company_id"]},scope.closePopup=function(){angular.element(idClose).fadeOut()};var loadList=function(){PatientService.mdtSearch(scope.params).then(function(response){"success"===response.status&&(scope.list=response)},function(error){alert("Error Server")})};loadList(),scope.refreshList=function(){loadList()},scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}).directive("patientSearchByCompany",function(PatientService){return{restrict:"EA",scope:{clickRow:"&",isClose:"@",companyId:"="},templateUrl:"modules/patient/directives/templates/search.html",link:function(scope,element,attrs){if(scope.list={},scope.isClose)var idClose="#"+scope.isClose;scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"First_name",value:""},{type:"text",name:"Sur_name",value:""},{type:"text",name:"company_id",value:0}],select:["Patient_id","First_name","Sur_name","company_id"]},scope.$watch("companyId",function(companyId){console.log(companyId),scope.params.filters[2].value=companyId,scope.refreshList()}),scope.closePopup=function(){angular.element(idClose).fadeOut()};var loadList=function(){PatientService.mdtSearch(scope.params).then(function(response){"success"===response.status&&(scope.list=response)},function(error){alert("Error Server")})};scope.refreshList=function(){loadList()},scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.patient.companies.directive",[]).directive("patientCompanies",function(PatientService,OutsideReferralModel,toastr){return{restrict:"EA",scope:{data:"@"},template:'<my-data-table options="data_options" rowclass="set_row_class" rowclick="row_click">',controller:function($scope){var data=$scope.$eval($scope.data);if(data&&data.Patient_id){var active_item=null;$scope.set_row_class=function(item){return"active"==item.active&&(active_item=item),"active"==item.active?"success":""},$scope.row_click=function(item){if(item.id!=active_item.id){var yes=confirm("Set this company active for patient ??? ");yes&&PatientService.update({Patient_id:data.Patient_id,company_id:item.id}).then(function(response){"success"==response.status&&(item.active="active",active_item.active="inactive",toastr.success("Save Successfully!!!","Success")),console.log(response)})}},$scope.data_options={api:"api/erm/v2/patients/companies",method:"post",columns:[{field:"companies.id",is_hide:!0},{field:"Company_name",label:"Company Name"},{field:"Industry"},{field:"Addr",label:"Address"},{field:"Country",db_field:"companies.Country"},{field:"active",label:"Active",is_hide:!0,not_submit:!0}],search:{Patient_id:data.Patient_id}}}}}}),angular.module("app.loggedIn.patient.ngthumb.directive",[]).directive("ngThumb",["$window",function($window){var helper={support:!(!$window.FileReader||!$window.CanvasRenderingContext2D),isFile:function(item){return angular.isObject(item)&&item instanceof $window.File},isImage:function(file){var type="|"+file.type.slice(file.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(type)}};return{restrict:"A",template:"<canvas/>",link:function(scope,element,attributes){function onLoadFile(event){var img=new Image;img.onload=onLoadImage,img.src=event.target.result}function onLoadImage(){var width=params.width||this.width/this.height*params.height,height=params.height||this.height/this.width*params.width;canvas.attr({width:width,height:height}),canvas[0].getContext("2d").drawImage(this,0,0,width,height)}if(helper.support){var params=scope.$eval(attributes.ngThumb);if(helper.isFile(params.file)&&helper.isImage(params.file)){var canvas=element.find("canvas"),reader=new FileReader;reader.onload=onLoadFile,reader.readAsDataURL(params.file)}}}}}]),angular.module("app.loggedIn.patient.controller",["app.loggedIn.patient.list.controller","app.loggedIn.patient.home.controller","app.loggedIn.patient.search.controller","app.loggedIn.patient.action.controller","app.loggedIn.patient.booking.controller","app.loggedIn.patient.detail.controller","app.loggedIn.patient.recall.controller","app.loggedIn.patient.outside_referrals.controller","app.loggedIn.patient.referrals.controller","app.loggedIn.patient.appointment.controller","app.loggedIn.patient.companies.controller","app.loggedIn.patient.workcover.controller","app.loggedIn.patient.itemsheet.controller","app.loggedIn.patient.invoices.controller","app.loggedIn.patient.invoice_detail.controller","app.loggedIn.patient.appt.controller","app.loggedIn.patient.apptdoc.controller","app.loggedIn.patient.checkin.controller","app.loggedIn.patient.detail.master.controller"]).controller("PatientController",function($state,$scope,sysServiceService,DoctorService,$cookieStore,toastr,ConfigService,PatientService,MODE_ROW,$stateParams,mdtAppointmentService,rlobService){var patient_id=$scope.patient_id=$stateParams.patient_id;$scope.cal_id=$stateParams.cal_id,$scope.search={},$scope.search.Patient_id=$scope.patient_id,$scope.patientBarVer={},$scope.patientBarVer.version="zip",$scope.$on("$stateChangeStart",function(e,toState,toParams,fromState,fromParams){toState.name.indexOf("loggedIn.patient")>-1&&($scope.patientBarVer.version="zip")}),$scope.patient_detail_modules=[{wrap:0,name:"Patient",color:"blue-soft",desc:"Info",icon:"fa fa-user",state:"loggedIn.patient.detail"},{wrap:0,name:"Companies",color:"red-soft",desc:"Total: 0",icon:"fa fa-building",state:"loggedIn.patient.company"},{wrap:0,name:"Claim",color:"green-soft",desc:"Available",icon:"fa fa-newspaper-o",state:"loggedIn.patient.claim.list"},{wrap:0,name:"Alert",color:"green-soft",desc:"Available",icon:"fa fa-newspaper-o",state:"loggedIn.patient.alert.list({patientId:"+$stateParams.patient_id+", calId:"+$stateParams.cal_id+"})"},{wrap:0,name:"Referral",color:"purple-soft",desc:"Total: 0",icon:"fa fa-envelope-o",state:"loggedIn.patient.outreferral.list({patientId:"+$stateParams.patient_id+", calId:"+$stateParams.cal_id+"})"},{wrap:1,name:"Consultation",icon:"fa fa-user-md",color:"purple-soft",desc:"",state:"loggedIn.patient.consult({patient_id:"+$stateParams.patient_id+", cal_id:"+$stateParams.cal_id+"})"},{wrap:0,name:"Problem List",color:"red-soft",icon:"fa fa-exclamation-triangle",state:"loggedIn.patient.problem_list"},{wrap:0,name:"Allergy list",color:"green-soft",icon:"fa fa-exclamation-triangle",state:"loggedIn.patient.allergy.list"}],$scope.patient_apt_modules=[{wrap:1,name:"ItemSheet",icon:"fa fa-bookmark-o",color:"blue-soft",desc:"Info",state:"loggedIn.patient.itemsheet"},{wrap:0,name:"Invoices",icon:"fa fa-money",color:"red-soft",desc:"Total: 0",state:"loggedIn.patient.invoices"},{wrap:1,name:"Appointment List",icon:"fa fa-repeat",color:"green-soft",desc:"Total: 0",state:"loggedIn.patient.appt"},{wrap:1,name:"Recall",color:"blue-soft",desc:"Recall",icon:"fa fa-repeat",state:"loggedIn.patient.recall"}],$scope.current_patient={},$scope.getPatientInfo=function(){PatientService.mdtById($scope.patient_id).then(function(response){$scope.current_patient=response.data,$scope.current_patient.company=response.company;for(var key in $scope.current_patient)$scope.current_patient[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is"))&&($scope.current_patient[key]=$scope.current_patient[key].toString()),(-1!=key.indexOf("_date")||-1!=key.indexOf("DOB")||-1!=key.indexOf("Exp"))&&($scope.current_patient[key]=new Date($scope.current_patient[key])));$scope.current_patient.Title=parseInt($scope.current_patient.Title),-1!=$stateParams.cal_id&&mdtAppointmentService.byId($scope.cal_id).then(function(response){"error"==response.status?toastr.error("Error Get Detail","Error"):($scope.current_patient.Site_name=response.data.site.Site_name,$scope.current_patient.FROM_TIME=response.data.FROM_TIME)})})},$scope.getPatientInfo(),$scope.setListAllergy=function(){PatientService.getListAllergyinPatient($scope.search).then(function(data){"success"==data.status&&($scope.listAllergyinPAtient=data.list)})},$scope.setListAllergy(),$scope.searchObject={doctor_id:0,limit:5,offset:0,maxSize:5,currentPage:1,data:{First_name:"",Sur_name:"",Middle_name:"",Post_code:null}},$scope.rows=MODE_ROW,$scope.modelObject={Title:"Mr",First_name:"",Sur_name:"",Middle_name:"",Known_as:"",Address1:"",Address2:"",Post_code:null,Country:"AU",DOB:"",Sex:"Male",Home_phone:null,Work_phone:null,Mobile:null,No_SMS:"0",Account_type:"",Account_holder:"",Account_Seft:null,Medicare_no:null,Ref:null,Exp_medicare:"",Private_fund_id:"",MemberShip_no:null,UPI:null,HCC_Pension_No:null,Exp_pension:"",DVA_No:null,Balance:null,Pays_Gap_Only:"1",Email:"",Suburb:"",Alias_First_name:"",Alias_Sur_name:"",Phone_ext:null},$scope.mode="search",$scope.getClinicalDepts=function(){var user_id=$cookieStore.get("userInfo").id;PatientService.getDoctorInfoByUserId(user_id).then(function(data){"success"==data.status&&($scope.doctorId=data.data.doctor_id,$scope.clinicalDeptId=data.data.CLINICAL_DEPT_ID,sysServiceService.byClinicalDepartment($scope.clinicalDeptId).then(function(response){$scope.options.clinical_depts=response.data}))})},$scope.getClinicalDepts(),$scope.apptDate=new Date,$scope.submitCalendar=function(){if($scope.isSubmit=!0,!$scope.appointForm.$invalid){var from_time_part=moment($scope.from_time,"HHmm").format("HH:mm"),to_time_part=moment($scope.to_time,"HHmm").format("HH:mm");if("Invalid date"===moment($scope.from_time,"HHmm").format("HH:mm"))return void toastr.error("From time format error");if("Invalid date"===moment($scope.to_time,"HHmm").format("HH:mm"))return void toastr.error("To time format error");var from_time=moment($scope.apptDate).format("YYYY-MM-DD")+" "+from_time_part+":00",to_time=moment($scope.apptDate).format("YYYY-MM-DD")+" "+to_time_part+":00",postData={FROM_TIME:from_time,TO_TIME:to_time,SITE_ID:$scope.site_id,DOCTOR_ID:$scope.doctorId,CLINICAL_DEPT_ID:$scope.clinicalDeptId,SERVICE_ID:$scope.service_Id};DoctorService.addCalendar(postData).then(function(response){toastr.success("Add successfully !!!"),$scope.cal_id=response.data,rlobService.addApptPatient($scope.patient_id,response.data).then(function(data){"success"==data.status&&(angular.element("#popupNewAppoint").modal("hide"),angular.element("#popupNewAppoint").on("hidden.bs.modal",function(e){initObject(),$scope.changeAppt({CAL_ID:$scope.cal_id})}))})},function(err){})}},$scope.newAppoint=function(){angular.element("#popupNewAppoint").modal("show")},$scope.changeAppt=function(item){$state.go("loggedIn.patient.consult",{patient_id:patient_id,cal_id:item.CAL_ID})};var initObject=function(){$scope.appt_params={id:$scope.cal_id,permission:{edit:!0}},PatientService.getAppointments(patient_id).then(function(response){$scope.list_appt=response.data.appointments;var current_appt=null;angular.forEach($scope.list_appt,function(item){item.CAL_ID==$scope.cal_id&&(current_appt=item)})},function(error){})};initObject()}),angular.module("app.loggedIn.patient.list.controller",[]).controller("PatientListController",function($scope,$state,$cookieStore,PatientService,DoctorService){$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.list=[],$scope.reset=function(){$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.loadList()},$scope.loadList=function(){DoctorService.getByUserId($cookieStore.get("userInfo").id).then(function(data){data&&($scope.searchObjectMap.doctor_id=data.doctor_id,PatientService.search($scope.searchObjectMap).then(function(response){$scope.list=response}))})},$scope.loadList(),$scope.setPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.loadList()},$scope.goToTimetableDetail=function(list){$cookieStore.put("patientTempInfo",list),$state.go("loggedIn.patient.booking")}}),angular.module("app.loggedIn.patient.appointment.controller",[]).controller("PatientAppointmentController",function($scope,DoctorService,TimetableModel,$state,toastr,$stateParams,PatientService,ConfigService,ReceptionistService,OutreferralModel,AlertModel){var patient_id=$scope.patient_id=$stateParams.patient_id;$scope.cal_id=$stateParams.cal_id,$scope.dataAlert=[];var alertPostData={Patient_id:$stateParams.patient_id,CAL_ID:$stateParams.cal_id,page:1,limit:10,offset:0,max_size:5,name:"",description:"",Creation_date:"desc",isenable:""};AlertModel.listFollowPatient(alertPostData).then(function(response){_.forEach(response.data,function(id){$scope.dataAlert.push(id.name)})},function(error){});var outPostData={patient_id:$scope.patient_id,CAL_ID:$scope.cal_id};OutreferralModel.checkPatientCalendar(outPostData).then(function(response){0===response.data&&1===response.service.IS_REFERRAL&&($scope.warning_refferal=!0)},function(error){}),$scope.changeAppt=function(item){$state.go("loggedIn.patient.appointment",{patient_id:patient_id,cal_id:item.CAL_ID})},$scope.classAppt=function(item){switch(item.APP_TYPE){case"ChangePersonInCharge":return"badge-danger";case"NotYet":case"Billing":return"badge-warning";case"Done":return"badge-success";default:return"badge-default"}}}),angular.module("app.loggedIn.patient.companies.controller",[]).controller("PatientCompaniesController",function($scope,$state,$stateParams,toastr,PatientService){$scope.current_patient={};var patient_id=$stateParams.patient_id;$scope.patient={Patient_id:patient_id},$scope.updateCompany=function(company){PatientService.update({Patient_id:$scope.patient.Patient_id,company_id:company.id}).then(function(data){"success"==data.status&&(toastr.success("Save Successfully!!!","Success"),$scope.reloadpage()),console.log(data)})},$scope.company_search_options={api:"api/erm/v2/companies/search",method:"post",columns:[{field:"id",is_hide:!0},{field:"Company_name",label:"Company Name"},{field:"Industry"}],use_filters:!0,filters:{Company_name:{type:"text"},Industry:{type:"text"}}},$scope.chooseCompany=function(item){console.log(item),$scope.updateCompany(item)},$scope.show_company_form=!1,$scope.show_company_search=!1,$scope.openCompanySearch=function(){$scope.show_company_search=!0},$scope.closeCompanySearch=function(){$scope.show_company_search=!1},$scope.openCompanyForm=function(){$scope.show_company_form=!0},$scope.closeCompanyForm=function(){$scope.show_company_form=!1}}),angular.module("app.loggedIn.patient.recall.controller",[]).controller("PatientRecallController",function($scope,$state,$stateParams,$cookieStore,PatientService,DoctorService,ConfigService){var patient_id=$stateParams.patient_id,recall_panel={};$scope.recall_opt={api:"api/erm/v2/patients/recall_search",scope:recall_panel,method:"post",columns:[{field:"recall_id",is_hide:!0},{field:"notes",label:"Document Name"},{field:"transaction_date",label:"Transaction Date",type:"custom",fn:function(item){return item.transaction_date?ConfigService.getCommonDateDefault(item.transaction_date):""}},{field:"recall_date",label:"Recall Date",type:"custom",fn:function(item){return item.recall_date?ConfigService.getCommonDateDefault(item.recall_date):""}},{field:"recall_period",label:"Recall Period",type:"custom",fn:function(item){return item.recall_period<=1?item.recall_period+" month":item.recall_period+" months"}},{field:"remind_before",label:"Remind Before",type:"custom",fn:function(item){return item.remind_before<=1?item.remind_before+" month":item.remind_before+" months"}}],search:{patient_id:patient_id}};var userInfo=$cookieStore.get("userInfo");$scope.params_add={permission:{create:!0,edit:!1},patient_id:patient_id,created_by:userInfo.id},$scope.params_edit={permission:{create:!1,edit:!0},id:0,last_updated_by:userInfo.id},$scope.addForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1}},$scope.actionCenter={updateRecall:function(){}},$scope.rowClick=function(item){$scope.params_edit.id=item.recall_id,$scope.actionCenter.updateRecall(),$scope.editForm.open()},$scope.actionSuccess=function(){$scope.addForm.close(),$scope.editForm.close(),recall_panel.reload()},$scope.editForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1}}}),angular.module("app.loggedIn.patient.invoices.controller",[]).controller("PatientInvoicesController",function($scope,$state,toastr,$modal,$stateParams,PatientService,ConfigService){var patient_id=$stateParams.patient_id;$scope.patient_id=patient_id;var cal_id=$stateParams.cal_id;$scope.cal_id=cal_id,$scope.invoicePanel={},$scope.invoiceClick=function(item){item.cal_id?$state.go("loggedIn.patient.invoice_detail",{header_id:item.header_id}):$modal.open({templateUrl:"popupEditManualInvoice",controller:function($scope,$modalInstance,options,item){$scope.options=options,$scope.addmanual={success:"",headerdata:item},$scope.$watch("addmanual.success",function(response){1==response&&$modalInstance.close({status:"success",data:response})}),$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{options:function(){return $scope.options},item:function(){return item}},size:"lg"}).result.then(function(response){"success"==response.status&&$scope.invoicePanel.reload()})},$scope.invoiceClass=function(item){return{warning:"approach"==item.STATUS,success:"done"==item.STATUS,danger:"enter"==item.STATUS||null==item.STATUS,selected:item.cal_id==cal_id}},$scope.invoiceOption={api:"api/erm/v2/invoice/search",method:"post",scope:$scope.invoicePanel,columns:[{field:"header_id",order:"DESC",is_hide:!0},{field:"cal_id",is_hide:!0},{field:"STATUS",is_hide:!0},{field:"Patient_id",label:"Patient",type:"custom",fn:function(item){return item.patient?item.patient.First_name:void 0}},{field:"SOURCE_ID",label:"Bill to",type:"custom",fn:function(item){return item.cal_id?item.Insurer_id?item.insurer?"Insurer:"+item.insurer.insurer_name:null:item.Company_id?item.company?"Company:"+item.company.Company_name:null:item.patient?"Patient:"+item.patient.First_name+" "+item.patient.Sur_name:null:item.FEE_GROUP_TYPE==itemConst.feeGroupType.private_fund.value?item.insurer?itemConst.feeGroupType.private_fund.value+": "+item.insurer.insurer_name:null:item.feeGroup?item.feeGroup.FEE_GROUP_TYPE+": "+item.feeGroup.FEE_GROUP_NAME:null}},{field:"cal_id",label:"Invoice type",type:"custom",fn:function(item){return item.cal_id?"Auto":"Manual"}},{field:"cal_id",label:"From Time",type:"custom",fn:function(item){return item.appointment?ConfigService.getCommonDatetime(item.appointment.FROM_TIME):null}},{field:"cal_id",label:"To Time",type:"custom",fn:function(item){return item.appointment?ConfigService.getCommonDatetime(item.appointment.TO_TIME):null}},{field:"Insurer_id",label:"Insurer",type:"custom",fn:function(item){return item.insurer?item.insurer.insurer_name:void 0}},{field:"DOCTOR_ID",label:"Doctor",type:"custom",fn:function(item){return item.doctor?item.doctor.NAME:void 0}},{field:"SITE_ID",label:"Site",type:"custom",fn:function(item){return item.site?item.site.Site_name:void 0}},{field:"SERVICE_ID",label:"Service",type:"custom",fn:function(item){return item.service?item.service.SERVICE_NAME:void 0}},{field:"CREATION_DATE",label:"Created Date",type:"custom",fn:function(item){return ConfigService.getCommonDatetime(item.CREATION_DATE)}}],search:{patient_id:patient_id,cal_id:-1}},$scope.showAddFormInvoice=function(){$modal.open({templateUrl:"popupAddManualInvoice",controller:function($scope,$modalInstance,options,patient_id){$scope.options=options,$scope.addmanual={success:"",patient_id:patient_id},$scope.$watch("addmanual.success",function(response){1==response&&$modalInstance.close({status:"success",data:response})}),$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{options:function(){return $scope.options},patient_id:function(){return $stateParams.patient_id}},size:"lg"}).result.then(function(response){"success"==response.status&&($scope.invoicePanel.reload(),toastr.success("Add Manual Invoice Success !"))})},$scope.addFormInvoice={open:function(){$modal.open({templateUrl:"popupAddInvoice",controller:function($scope,$modalInstance,options,patient_id,cal_id){$scope.options=options,$scope.patient_id=patient_id,$scope.cal_id=cal_id,$scope.success=function(){$modalInstance.close({status:"success"})}},size:"lg",resolve:{options:function(){return $scope.options},patient_id:function(){return $stateParams.patient_id},cal_id:function(){return $stateParams.cal_id}}}).result.then(function(data){"success"==data.status&&($scope.invoicePanel.reload(),toastr.success("Save successfully!","Success!"))})}}}),angular.module("app.loggedIn.patient.invoice_detail.controller",[]).controller("PatientInvoiceDetailController",function($scope,$state,$stateParams,toastr,PatientService,ConfigService){var header_id=$stateParams.header_id;$scope.invoiceOpt={permission:{edit:!0},id:header_id},$scope.invoiceSave=function(){PatientService.invoiceSave(header_id).then(function(response){toastr.success("Save successfully !!!","Success")})},PatientService.invoiceDetail(header_id).then(function(response){$scope.invoice=response.data,$scope.invoice.lines=$scope.invoice.lines.filter(function(item){return 1==item.IS_ENABLE});for(var i=0,len=$scope.invoice.lines.length;len>i;++i){var line=$scope.invoice.lines[i];$scope.invoice.AMOUNT+=line.AMOUNT}})}),angular.module("app.loggedIn.patient.home.controller",[]).controller("PatientHomeController",function($scope,$state){}),angular.module("app.loggedIn.patient.search.controller",[]).controller("PatientSearchController",function($scope,ConfigService,PatientService){$scope.search_map={limit:10,offset:0,maxSize:5,currentPage:1,data:{Title:"",First_name:"",Middle_name:"",Sur_name:"",DOB:""},ORDER_BY:"Sur_name ASC"},$scope.list={},$scope.loadList=function(){PatientService.getByOption({search:$scope.search}).then(function(data){for(var i=0,len=data.list.length;len>i;++i)data.list[i].DOB&&(data.list[i].DOB=ConfigService.getCommonDate(data.list[i].DOB));$scope.list.results=data.list})};var init=function(){$scope.search=angular.copy($scope.search_map),$scope.sexIndex=[{code:"Female"},{code:"Male"}],$scope.pagingIndex=[{code:10},{code:20},{code:50}],$scope.loadList(),PatientService.getTotals().then(function(data){$scope.list.count=data.count})};init(),$scope.setPage=function(){$scope.search.offset=($scope.search.currentPage-1)*$scope.search.limit,$scope.loadList()}}),angular.module("app.loggedIn.patient.add.controller",[]).controller("PatientAddController",function($scope,$state,toastr,ConfigService,PatientService,items){items.scope,$scope.patientObj={Title:"",First_name:"",Sur_name:"",Middle_name:"",Known_as:"",Address1:"",Address2:"",Post_code:"",Country:"Australia",DOB:"",Sex:"",Home_phone:"",Work_phone:"",Mobile:"",No_SMS:1,Account_type:"",Account_holder:"",Account_Seft:"",Medicare_no:"",Ref:"",Exp_medicare:"",Private_fund_id:"",MemberShip_no:"",UPI:"",HCC_Pension_No:"",Exp_pension:"",DVA_No:"",Balance:"",Pays_Gap_Only:1,Email:"",Suburb:"",Alias_First_name:"",Alias_Sur_name:"",Phone_ext:""},$scope.initForm=function(resetCall){resetCall&&resetCall(),$scope.titleIndex=ConfigService.get_title_name(),$scope.countryIndex=ConfigService.get_country_list(),$scope.sexIndex=ConfigService.get_sex_list(),$scope.smsIndex=$scope.payGapIndex=ConfigService.get_yes_no_opt(),PatientService.listAccType().then(function(data){return"success"!=data.status?void alert("error"):void($scope.accTypeIndex=data.list)}),PatientService.listPrvFund().then(function(data){return"success"!=data.status?void alert("error"):void($scope.fundIndex=data.list)})};var reset=function(){$scope.patient=angular.copy($scope.patientObj),$scope.isSubmit=!1};$scope.reset=reset;var init=function(){$scope.formMode="Add",reset(),$scope.initForm(reset)};$scope.submit=function(patientForm){return $scope.isSubmit=!0,patientForm.$invalid?void toastr.error("Please Check Your Information!","Error"):void PatientService.insertPatient({patient:$scope.patient}).then(function(data){return"success"!=data.status?void toastr.error("Cannot Insert!","Error"):(reset(),void toastr.success("Insert Successfully !!!","Success"))})},init()}),angular.module("app.loggedIn.patient.action.controller",[]).controller("PatientActionController",function($scope,$modalInstance,toastr,ConfigService,PatientService,ReceptionistService,DoctorService,items){$scope.mode="search",$scope.modelObject={Title:"Mr",First_name:"",Sur_name:"",Middle_name:"",
Known_as:"",Address1:"",Address2:"",Post_code:null,Country:"AU",DOB:"",Sex:"Male",Home_phone:null,Work_phone:null,Mobile:null,No_SMS:"0",Account_type:"",Account_holder:"",Account_Seft:null,Medicare_no:null,Ref:null,Exp_medicare:"",Private_fund_id:"",MemberShip_no:null,UPI:null,HCC_Pension_No:null,Exp_pension:"",DVA_No:null,Balance:null,Pays_Gap_Only:"1",Email:"",Suburb:"",Alias_First_name:"",Alias_Sur_name:"",Phone_ext:null},$scope.options={titles:ConfigService.title_option(),sexes:ConfigService.sex_option(),sms:ConfigService.yes_no_option(),countries:ConfigService.country_option(),gaps:ConfigService.yes_no_option()},$scope.step=1,$scope.isSubmit=!1;var reset=function(){$scope.step=1,$scope.modelObjectMap=angular.copy($scope.modelObject)};$scope.nextStep=function(form){switch($scope.isSubmit=!0,$scope.step){case 1:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.step++,$scope.isSubmit=!1);break;case 2:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.step++,$scope.isSubmit=!1);break;case 3:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.modelObjectMap.DOB=ConfigService.getCommonDateDatabase($scope.modelObjectMap.DOB),$scope.modelObjectMap.Exp_medicare=ConfigService.getCommonDateDatabase($scope.modelObjectMap.Exp_medicare),$scope.modelObjectMap.Exp_pension=ConfigService.getCommonDateDatabase($scope.modelObjectMap.Exp_pension),null!==items.bookingObject.Patient_id?PatientService.updatePatient({patient:$scope.modelObjectMap}).then(function(data){return"success"!=data.status?void toastr.error("Cannot Insert!","Error"):(reset(),toastr.success("Edit Successfully !!!","Success"),void $modalInstance.close({patientId:items.patient.Patient_id}))}):PatientService.insertPatient({patient:$scope.modelObjectMap}).then(function(data){return"success"!=data.status?void toastr.error("Cannot Insert!","Error"):(reset(),$scope.modelObjectBookingMap.Patient_id=data.data.Patient_id,ReceptionistService.booking($scope.modelObjectBookingMap).then(function(data){$modalInstance.close("OK")}),void toastr.success("Insert Successfully !!!","Success"))}),$scope.isSubmit=!1)}},$scope.backStep=function(){$scope.step>1&&$scope.step--},$scope.modelObjectMap={};var init=function(){angular.extend($scope.modelObject,items.patient),$scope.modelObjectMap=angular.copy($scope.modelObject),items.patient&&($scope.modelObjectMap.DOB=ConfigService.convertToDate(items.patient.DOB),$scope.modelObjectMap.Exp_medicare=ConfigService.convertToDate(items.patient.Exp_medicare),$scope.modelObjectMap.Exp_pension=ConfigService.convertToDate(items.patient.Exp_pension),$scope.modelObjectMap.Home_phone=parseInt($scope.modelObjectMap.Home_phone),$scope.modelObjectMap.Work_phone=parseInt($scope.modelObjectMap.Work_phone),$scope.modelObjectMap.Mobile=parseInt($scope.modelObjectMap.Mobile),$scope.modelObjectMap.Account_Seft=parseInt($scope.modelObjectMap.Account_Seft),$scope.modelObjectMap.MemberShip_no=parseInt($scope.modelObjectMap.MemberShip_no),$scope.modelObjectMap.HCC_Pension_No=parseInt($scope.modelObjectMap.HCC_Pension_No),$scope.modelObjectMap.UPI=parseInt($scope.modelObjectMap.UPI),$scope.modelObjectMap.DVA_No=parseInt($scope.modelObjectMap.DVA_No),$scope.modelObjectMap.Balance=parseInt($scope.modelObjectMap.Balance),$scope.modelObjectMap.Ref=parseInt($scope.modelObjectMap.Ref),$scope.modelObjectMap.Post_code=parseInt($scope.modelObjectMap.Post_code)),PatientService.listAccType().then(function(data){return"success"!=data.status?void alert("error"):void($scope.accTypeIndex=data.list)}),PatientService.listPrvFund().then(function(data){return"success"!=data.status?void alert("error"):void($scope.fundIndex=data.list)})};init(),$scope.search_map={limit:10,offset:0,maxSize:5,currentPage:1,data:{Title:"",First_name:"",Middle_name:"",Sur_name:"",DOB:""},ORDER_BY:"Sur_name ASC"},$scope.list={},$scope.loadList=function(){PatientService.getByOption({search:$scope.search}).then(function(data){for(var i=0,len=data.list.length;len>i;++i)data.list[i].DOB&&(data.list[i].DOB=ConfigService.getCommonDate(data.list[i].DOB));$scope.list.results=data.list})};var initSearch=function(){$scope.search=angular.copy($scope.search_map),$scope.sexIndex=[{code:"Female"},{code:"Male"}],$scope.pagingIndex=[{code:10},{code:20},{code:50}],$scope.loadList(),PatientService.getTotals().then(function(data){$scope.list.count=data.count})};initSearch(),$scope.setPage=function(){$scope.search.offset=($scope.search.currentPage-1)*$scope.search.limit,$scope.loadList()},$scope.goToBooking=function(list){$scope.modelObjectBookingMap.Patient_id=list.Patient_id,ReceptionistService.booking($scope.modelObjectBookingMap).then(function(data){$modalInstance.close("OK")})},$scope.modelObjectBooking=items.bookingObject,$scope.modelObjectBookingMap={},angular.extend($scope.options,items.options),ReceptionistService.getById(items.cal_id).then(function(response){angular.extend($scope.modelObjectBooking,response),$scope.modelObjectBookingMap=angular.copy($scope.modelObjectBooking),DoctorService.getById($scope.modelObjectBookingMap.DOCTOR_ID).then(function(doctor){$scope.modelObjectBookingMap.DOCTOR_NAME=doctor.NAME});for(var i=0;i<items.options.redimedsites.length;i++)items.options.redimedsites[i].id===$scope.modelObjectBookingMap.SITE_ID&&($scope.modelObjectBookingMap.SITE_NAME=items.options.redimedsites[i].Site_name);for(var i=0;i<items.options.dept.length;i++)items.options.dept[i].CLINICAL_DEPT_ID===$scope.modelObjectBookingMap.CLINICAL_DEPT_ID&&($scope.modelObjectBookingMap.CLINICAL_DEPT_NAME=items.options.dept[i].CLINICAL_DEPT_NAME);ConfigService.system_service_by_clinical($scope.modelObjectBookingMap.CLINICAL_DEPT_ID).then(function(list){items.options.services=list}),null!==response.Patient_id&&PatientService.getPatient(response.Patient_id).then(function(data){$scope.modelObjectBookingMap.PATIENT=data.data[0]}),items.data.from_time_map?($scope.modelObjectBookingMap.from_time_map=items.data.from_time_map,$scope.modelObjectBookingMap.to_time_map=items.data.to_time_map):($scope.modelObjectBookingMap.from_time=items.data.from_time,$scope.modelObjectBookingMap.from_time_map=ConfigService.convertToTimeString(items.data.from_time),$scope.modelObjectBookingMap.to_time=items.data.to_time,$scope.modelObjectBookingMap.to_time_map=ConfigService.convertToTimeString(items.data.to_time))})}),angular.module("app.loggedIn.patient.booking.controller",[]).controller("PatientBookingController",function($scope,$state,$cookieStore,ReceptionistService,ConfigService,PatientService,toastr){$scope.modelObjectBookingMap={},$scope.bookingPatientInfo={};var init=function(){$scope.bookingPatientInfo=$cookieStore.get("patientBookingInfo").data,$scope.bookingPatientInfo.datepicker=ConfigService.getCommonDateDefault($scope.bookingPatientInfo.datepicker),ReceptionistService.getById($cookieStore.get("patientBookingInfo").cal_id).then(function(data){angular.extend($scope.modelObjectBookingMap,data),ConfigService.system_service_by_clinical($scope.modelObjectBookingMap.CLINICAL_DEPT_ID).then(function(list){$scope.options.services=list,$scope.modelObjectBookingMap.SERVICE_ID=list[0].SERVICE_ID,$scope.modelObjectBookingMap.ACC_TYPE=$scope.options.acc_types[0].code,$scope.modelObjectBookingMap.APP_TYPE=$scope.options.app_types[0].code,$scope.modelObjectBookingMap.bill_to="1",$scope.modelObjectBookingMap.ARR_TIME="00:00",$scope.modelObjectBookingMap.ATTEND_TIME="00:00"})})};init(),$scope.getActive=function(state){return state===$state.current.name?"active":""},$scope.step=1,$scope.label_step="Next",$scope.prevStep=function(){$scope.step>1&&($scope.label_step="Next",$scope.step--)},$scope.nextStep=function(){switch($scope.step){case 1:$scope.step=2,$scope.label_step="";break;case 2:$state.go("loggedIn.patient.booking.search")}},$scope.list=[],$scope.loadList=function(){PatientService.getByOption({search:$scope.search}).then(function(data){for(var i=0,len=data.list.length;len>i;++i)data.list[i].DOB&&(data.list[i].DOB=ConfigService.getCommonDate(data.list[i].DOB));$scope.list.results=data.list})};var initSearch=function(){$scope.search=angular.copy($scope.searchObject),$scope.sexIndex=[{code:"Female"},{code:"Male"}],$scope.pagingIndex=[{code:5},{code:10},{code:20},{code:50}],$scope.loadList(),PatientService.getTotals().then(function(data){$scope.list.count=data.count})};initSearch(),$scope.setPage=function(){$scope.search.offset=($scope.search.currentPage-1)*$scope.search.limit,$scope.loadList()},$scope.goToBooking=function(list){$scope.modelObjectBookingMap.Patient_id=list.Patient_id,ReceptionistService.booking($scope.modelObjectBookingMap).then(function(data){$state.go("loggedIn.receptionist.appointment")})};var init=function(){$scope.modelObjectMap=angular.copy($scope.modelObject)};init(),$scope.insert_step=1,$scope.isSubmit=!1;var reset=function(){$scope.insert_step=1,$scope.modelObjectMap=angular.copy($scope.modelObject)};$scope.insertNextStep=function(form){switch($scope.isSubmit=!0,$scope.insert_step){case 1:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.insert_step++,$scope.isSubmit=!1);break;case 2:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.insert_step++,$scope.isSubmit=!1);break;case 3:form.$invalid?toastr.error("You got errors to fix","Error"):($scope.modelObjectMap.DOB=ConfigService.getCommonDateDatabase($scope.modelObjectMap.DOB),$scope.modelObjectMap.Exp_medicare=ConfigService.getCommonDateDatabase($scope.modelObjectMap.Exp_medicare),$scope.modelObjectMap.Exp_pension=ConfigService.getCommonDateDatabase($scope.modelObjectMap.Exp_pension),PatientService.insertPatient({patient:$scope.modelObjectMap}).then(function(data){return"success"!=data.status?void toastr.error("Cannot Insert!","Error"):(reset(),$scope.modelObjectBookingMap.Patient_id=data.data.Patient_id,ReceptionistService.booking($scope.modelObjectBookingMap).then(function(data){$state.go("loggedIn.receptionist.appointment")}),void toastr.success("Insert Successfully !!!","Success"))}),$scope.isSubmit=!1)}},$scope.insertBackStep=function(){$scope.insert_step>1&&$scope.insert_step--}}),angular.module("app.loggedIn.patient.detail.controller",[]).controller("PatientDetailController",function($scope,$state,$stateParams,PatientService,FileUploader){$scope.current_patient={},$scope.patientBarVer&&($scope.patientBarVer.version="null"),$scope.actionCenter={runWhenFinish:function(){$scope.getPatientInfo()}},$scope.params={permission:{create:!1,edit:!0},id:$stateParams.patient_id}}),angular.module("app.loggedIn.patient.detail.master.controller",[]).controller("PatientDetailMasterController",function($scope,$stateParams,$state,$modal,sysStateService,PatientService,ConfigService,toastr,PatientModel,FileUploader,$timeout,CompanyModel,InsurerService){$scope.avt_path="";var uploader=$scope.uploader=new FileUploader({url:"/api/erm/v2/patient/upload_avt",autoUpload:!1,removeAfterUpload:!0,onAfterAddingFile:function(item){var arr=item.file.name.split("."),ext=arr[arr.length-1];"jpg"===ext||"jpeg"===ext||"png"===ext?this.queue.length>1&&this.queue.splice(0,1):(toastr.error("Only jpg, jpeg and png accepted","Invalid format!"),this.queue=[])},onCompleteItem:function(item,response,status,headers){"success"===response.status&&response.isEditMode===!0&&($scope.avt_path=response.img_path,console.log("replace success",$scope.avt_path),clickAction())}});if($stateParams.patient_id&&(uploader.formData[0]={patient_id:$stateParams.patient_id,file_name:(new Date).getTime(),editMode:!0}),$scope.openUploader=function(){$timeout(function(){$("#patient_photo_upload").click()},100)},$scope.isClose)var idClose="#"+$scope.isClose;$scope.loadState=function(){null!==$scope.modelObjectMap.Country&&sysStateService.list($scope.modelObjectMap.Country).then(function(response){$scope.options.states=response.data})},$scope.verifiedMedicare=function(){if(!isNaN(parseFloat($scope.modelObjectMap.Medicare_no))&&isFinite($scope.modelObjectMap.Medicare_no)&&10===$scope.modelObjectMap.Medicare_no.toString().length){var dob="";if(null!==$scope.modelObjectMap.DOB){var time=new Date($scope.modelObjectMap.DOB),date=time.getDate().toString();10>date&&(date="0"+date);var month=(time.getMonth()+1).toString();10>month&&(month="0"+month);var year=time.getFullYear().toString();dob=date+month+year}var options={firstName:$scope.modelObjectMap.First_name,lastName:$scope.modelObjectMap.Sur_name,dob:dob,medicareNo:$scope.modelObjectMap.Medicare_no.toString(),refNo:$scope.modelObjectMap.Ref.toString()};PatientService.mdtVerifiedMedicare(options).then(function(response){$scope.isMedicare="success"==response.status?!0:!1})}},$scope.changeAdd=function(){var string=$scope.modelObjectMap.Address1;if(null!=string){var arr=string.split(",");4==arr.length&&($scope.modelObjectMap.Surburb=arr[1].trim(),$scope.modelObjectMap.State=arr[2].trim())}};var initObject=function(){$scope.isMedicare=!1,$scope.isSubmit=!1,$scope.accordion={oneAtATime:!1,main_address:!0,main_medicare:!0,main_medicare_disabled:!0,main_one:!0,main_two:!0},$scope.selectedCompany={Company_name:"Select Company"},$scope.modelObjectMap=angular.copy(PatientModel),$scope.params.permission.edit===!0&&PatientService.mdtById($scope.params.id).then(function(response){if("success"===response.status){angular.extend($scope.modelObjectMap,response.data),console.log("this is modelObjectMap",$scope.modelObjectMap);for(var key in $scope.modelObjectMap)$scope.modelObjectMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("No_")||-1!=key.indexOf("Diabetic")||-1!=key.indexOf("Inactive")||-1!=key.indexOf("Deceased")||-1!=key.indexOf("Gradudate_"))&&($scope.modelObjectMap[key]=$scope.modelObjectMap[key].toString()),(-1!=key.indexOf("_date")||-1!=key.indexOf("DOB")||-1!=key.indexOf("Exp"))&&($scope.modelObjectMap[key]=new Date($scope.modelObjectMap[key]))),$scope.modelObjectMap.avatar&&""!==$scope.modelObjectMap.avatar?$scope.avt_path=$scope.modelObjectMap.avatar:$scope.modelObjectMap.Sex&&""!==$scope.modelObjectMap.Sex?("0"===$scope.modelObjectMap.Sex&&($scope.avt_path="img/patient/avt/male_default.png"),"1"===$scope.modelObjectMap.Sex&&($scope.avt_path="img/patient/avt/female_default.png")):$scope.avt_path="img/patient/avt/male_default.png";console.log("this is init avt_path",$scope.avt_path),$scope.verifiedMedicare(),$scope.modelObjectMap.Country="Australia",$scope.loadState(),angular.extend($scope.selectedCompany,response.company),$scope.selectedCompany.insurer=response.insurer}}),$scope.params.permission.create===!0&&($scope.modelObjectMap.Country="Australia",$scope.modelObjectMap.Sex=0,$scope.loadState())};initObject();var companyModel=$scope.selectedCompany,idPatientDetailCompany="#PatientDetailCompany";$scope.clickCompany=function(){$modal.open({templateUrl:"dialogCompanyList",controller:function($scope,$modalInstance){$scope.actionCenter={createAdd:!0,goToStateAddCompany:function(){$modalInstance.dismiss("cancel"),$modal.open({templateUrl:"dialogAddCompany",controller:function($scope,$modalInstance){$scope.actionCenter={saveModal:function(Company_name,Company_id){companyModel.id=Company_id,companyModel.Company_name=Company_name,InsurerService.oneFollowCompany({company_id:Company_id}).then(function(response){companyModel.insurer={insurer_name:"No Insurer"},null!==response.data.insurer_name&&(companyModel.insurer.insurer_name=response.data.insurer_name),$modalInstance.dismiss("cancel")},function(error){})},closeModal:function(){$modalInstance.dismiss("cancel")}}},size:"lg"})}},$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){row&&($scope.selectedCompany.id=row.id,$scope.selectedCompany.Company_name=row.Company_name,InsurerService.oneFollowCompany({company_id:row.id}).then(function(response){$scope.selectedCompany.insurer={insurer_name:"No Insurer"},null!==response.data.insurer_name&&($scope.selectedCompany.insurer.insurer_name=response.data.insurer_name)},function(error){}))})},$scope.selectCompany=function(row){angular.element(idPatientDetailCompany).fadeOut(),angular.extend($scope.selectedCompany,row)},$scope.closePopup=function(){angular.element(idClose).fadeOut()};var clickAction=function(){if($scope.isSubmit=!0,$scope.accordion.main_one=!0,$scope.accordion.main_two=!0,!$scope.patientForm.$invalid){var postData=angular.copy($scope.modelObjectMap);postData.company_id=$scope.selectedCompany.id;for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));console.log("this is avt_path before edit",$scope.avt_path),"img/patient/avt/male_default.png"!==$scope.avt_path&&"img/patient/avt/female_default.png"!==$scope.avt_path?(console.log("run here",$scope.avt_path),postData.avatar=$scope.avt_path):postData.avatar="",$scope.params.permission.edit===!0?PatientService.mdtEdit(postData).then(function(response){return"success"!=response.status?void toastr.error("Cannot Update!","Error"):(toastr.success("Updated Patient Successfully !!!","Success"),$scope.actionCenter&&$scope.actionCenter.runWhenFinish&&$scope.actionCenter.runWhenFinish(),initObject(),void($scope.isClose&&$scope.closePopup()))}):(console.log("postData",postData),PatientService.checkPatietnInfo(postData.First_name,postData.Sur_name,postData.Middle_name,postData.DOB).then(function(data){if("success"==data.status)console.log("aaaaaaaaaaaaaaaa",data.data),toastr.error("Patient already exists","Error");else if("fail"==data.status){if(uploader.queue.length>0){var upload_file_name=(new Date).getTime()+"-"+uploader.queue[0].file.name;postData.avatar="img/patient/avt/"+upload_file_name}"undefined"!=typeof $scope.params.permission.calendar&&$scope.params.permission.calendar===!0&&(postData.CAL_ID=$scope.params.CAL_ID),PatientService.mdtAdd(postData).then(function(data){return"success"!=data.status?void toastr.error("Cannot Insert!","Error"):(toastr.success("Insert Patient Successfully !!!","Success"),$scope.actionCenter&&$scope.actionCenter.runWhenFinish&&$scope.actionCenter.runWhenFinish(data.data),uploader.queue.length>0&&(uploader.queue[0].formData[0]={patient_id:data.data.Patient_id,file_name:upload_file_name,editMode:!1},uploader.uploadItem(uploader.queue[0])),$scope.params.isAtAllPatient!==!0&&($scope.patient={},$scope.patient.Patient_name=$scope.modelObjectMap.First_name+" "+$scope.modelObjectMap.Sur_name,$scope.patient.Patient_id=data.data.Patient_id),initObject(),CompanyModel.insertPatientCompanies(postData.company_id,data.data.Patient_id),$scope.isClose&&$scope.closePopup(),$scope.onsuccess=data.data,void($scope.patient=data.data))})}else toastr.error("Patient already exists","Error")}))}};$scope.buttonclick=function(){$scope.params.permission.edit===!0&&uploader.queue.length>0?uploader.uploadItem(uploader.queue[0]):clickAction()},$scope.removeUpload=function(){uploader.queue=[]}}).directive("googleplace",function(){return{require:"ngModel",restrict:"A",scope:{},link:function(scope,element,attrs,model){var options={types:[],componentRestrictions:{country:"au"}};scope.gPlace=new google.maps.places.Autocomplete(element[0],options),google.maps.event.addListener(scope.gPlace,"place_changed",function(){scope.Place=scope.gPlace.getPlace(),scope.$apply(function(){model.$setViewValue(element.val())})})}}}),angular.module("app.loggedIn.patient.workcover.controller",[]).controller("PatientWorkcoverController",function($scope,$state,$stateParams,localStorageService,PatientService){localStorageService.set("patientTempInfo",{Patient_id:$stateParams.patient_id}),localStorageService.set("apptTempInfo",{CAL_ID:$stateParams.cal_id});var patient_id=$stateParams.patient_id,cal_id=$stateParams.cal_id;$scope.navigator={add_first:function(){$state.go("loggedIn.waworkcover.first",{patient_id:patient_id,action:"add",cal_id:cal_id,wc_id:0})},add_progress:function(){$state.go("loggedIn.waworkcover.progress",{patient_id:patient_id,action:"add",cal_id:cal_id,wc_id:0})},add_final:function(){$state.go("loggedIn.waworkcover.final",{patient_id:patient_id,action:"add",cal_id:cal_id,ass_id:0})},add_general:function(){$state.go("loggedIn.waworkcover.general",{patient_id:patient_id,action:"add",cal_id:cal_id,ass_id:0})}},$scope.first_opt=PatientService.workcoverSearchOpt("first",patient_id),$scope.progress_opt=PatientService.workcoverSearchOpt("progress",patient_id),$scope.final_opt=PatientService.workcoverSearchOpt("final",patient_id),$scope.general_opt=PatientService.workcoverSearchOpt("general",patient_id)}),angular.module("app.loggedIn.patient.referrals.controller",[]).controller("PatientReferralsController",function($scope,$state,DoctorService){var item_type_options=[{code:"Service",label:"Service"},{code:"Goods",label:"Goods"}];$scope.data_options={columns:[{field:"id",is_hide:!0},{field:"Company_name",label:"Company Name"},{field:"Industry"}],use_filters:!1,filters:{ITEM_CODE:{type:"number"},ITEM_NAME:{type:"text"},ITEM_TYPE:{type:"dropdown",values:item_type_options}},api:"api/erm/v2/companies/search"}}),angular.module("app.loggedIn.patient.outside_referrals.controller",[]).controller("PatientOutsideReferralsController",function($scope,$state,$stateParams){$scope.params_add={permission:{create:!0,edit:!1}},$scope.params_edit={permission:{create:!1,edit:!0},id:0},$scope.module_id={outside_referral:"OutsideReferralModule",outside_referral_edit:"OutsideReferralEditModule"},$scope.add=function(){angular.element("#"+$scope.module_id.outside_referral).fadeIn()},$scope.getRow=function(row){$scope.params_edit.id=row.id,angular.element("#"+$scope.module_id.outside_referral_edit).fadeIn()},$scope.$watch("itemUpdate",function(newUpdate,oldUpdate){"undefined"!=typeof newUpdate&&newUpdate&&($state.go("loggedIn.patient.outside_referral",{patient_id:$stateParams.patient_id},{reload:!0}),$scope.itemUpdate=!1)})}),angular.module("app.loggedIn.patient.itemsheet.controller",[]).controller("PatientItemSheetController",function($filter,$scope,$stateParams,ReceptionistService,PatientService,toastr,InvoiceService){var arrGetBy=$filter("arrGetBy");$scope.appointment={CAL_ID:$stateParams.cal_id,Patient_id:$stateParams.patient_id},$scope.items_search_panel={},$scope.deptItems=null,$scope.apptItems=[],$scope.extraItems=[];var isInDeptItems=function(item_id){for(var i=0,len=$scope.deptItems.length;len>i;++i)for(var cat=$scope.deptItems[i],j=0,len2=cat.items.length;len2>j;++j){var t_item=cat.items[j];if(item_id==t_item.ITEM_ID)return t_item}return!1};$scope.invoiceHeaderInfo=null,PatientService.initInvoice($scope.appointment.Patient_id,$scope.appointment.CAL_ID).then(function(data){InvoiceService.selectInvoiceHeaderBySession($scope.appointment.Patient_id,$scope.appointment.CAL_ID).then(function(data){"success"==data.status?$scope.invoiceHeaderInfo=data.data:(alert("Get Invoice Header Error."),exlog.logErr(data))},function(err){alert("Get Invoice Header Error."),exlog.logErr(err)})},function(err){alert("Init Invoice Error."),exlog.logErr(err)}),ReceptionistService.apptDetail($scope.appointment.CAL_ID).then(function(response){return"success"===response.status?(delete response.data.Patient_id,angular.extend($scope.appointment,response.data),PatientService.getDeptItems($scope.appointment.CLINICAL_DEPT_ID)):void 0}).then(function(response){return"success"===response.status?($scope.deptItems=response.data.filter(function(item){return item.clnDeptItemList.ISENABLE}),InvoiceService.selectInvoiceLinesBySession($scope.appointment.Patient_id,$scope.appointment.CAL_ID)):void 0}).then(function(response){if("success"===response.status){$scope.apptItems=response.data;var item_id_list=[];return angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,function(item,key){item.PRICE=0,item.TIME_SPENT=0,item.QUANTITY=1,item_id_list.push(item.ITEM_ID)})}),angular.forEach($scope.apptItems,function(item){var t_item=isInDeptItems(item.ITEM_ID);t_item?(t_item.QUANTITY=item.QUANTITY,t_item.TIME_SPENT=item.TIME_SPENT,t_item.PRICE=item.PRICE,t_item.checked=1===item.IS_ENABLE?"1":"0",t_item.inserted="1"===t_item.checked):($scope.extraItems.push(item),item_id_list.push(item.ITEM_ID),item.checked=1===item.IS_ENABLE?"1":"0",item.inserted="1"===item.checked)}),ReceptionistService.itemFeeAppt($scope.appointment.SERVICE_ID,item_id_list)}}).then(function(response){if(response&&response.list){var list_fee=response.list;angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,function(item,key){var t_item=arrGetBy(list_fee,"CLN_ITEM_ID",item.ITEM_ID);t_item&&t_item.SCHEDULE_FEE>0&&(item.PRICE=t_item.SCHEDULE_FEE,item.disable_fee=!0)})}),angular.forEach($scope.extraItems,function(item,key){var t_item=arrGetBy(list_fee,"CLN_ITEM_ID",item.ITEM_ID);t_item&&t_item.SCHEDULE_FEE>0&&(item.PRICE=t_item.SCHEDULE_FEE,item.disable_fee=!0)})}}),$scope.itemOptions={click:function(item){"dept_item"!=item.type&&"extra_item"!=item.type&&($scope.extraItems.push(item),item.QUANTITY=1,item.TIME_SPENT=0,item.checked="1",ReceptionistService.itemFeeAppt($scope.appointment.SERVICE_ID,[item.ITEM_ID]).then(function(response){response.list.length>0?(item.PRICE=response.list[0].SCHEDULE_FEE,item.disable_fee=!0):(item.PRICE=0,item.disable_fee=!1)}))},"class":function(item){if(isInDeptItems(item.ITEM_ID))return item.type="dept_item","danger";var t_item=arrGetBy($scope.extraItems,"ITEM_ID",item.ITEM_ID);return t_item?(item.type="extra_item","info"):void 0},options:{api:"api/erm/v2/items/search",method:"post",scope:$scope.items_search_panel,columns:[{field:"ITEM_ID",is_hide:!0},{field:"ITEM_CODE",label:"Item Code",width:"10%"},{field:"ITEM_NAME",label:"Item Name"},{field:"TAX_ID",label:"Tax Id",is_hide:!0},{field:"TAX_CODE",label:"Tax code"},{field:"TAX_RATE",label:"Tax rate"}],use_filters:!0,filters:{ITEM_CODE:{type:"text"},ITEM_NAME:{type:"text"}}}},$scope.itemSearch={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1}},$scope.updateItems=function(){var insertArr=[],fnInsertArr=function(item){var t={HEADER_ID:$scope.invoiceHeaderInfo.header_id,ITEM_ID:item.ITEM_ID,PRICE:item.PRICE,QUANTITY:item.QUANTITY,AMOUNT:item.PRICE*item.QUANTITY,TAX_ID:item.TAX_ID,TAX_CODE:item.TAX_CODE,TAX_RATE:item.TAX_RATE,TAX_AMOUNT:item.PRICE*item.QUANTITY*(item.TAX_RATE?item.TAX_RATE:0),TIME_SPENT:item.TIME_SPENT?item.TIME_SPENT:0,IS_ENABLE:"1"==item.checked?1:0};insertArr.push(t)};angular.forEach($scope.deptItems,function(cat,key){angular.forEach(cat.items,fnInsertArr)}),angular.forEach($scope.extraItems,fnInsertArr);var postData={invoiceHeaderId:$scope.invoiceHeaderInfo.header_id,listLine:insertArr};InvoiceService.saveInvoiceLineSheet(postData).then(function(data){"success"==data.status?toastr.success("Save invoice item success."):(data.status="non-data")?toastr.warning("No invoice item."):toastr.error("Save invoice item error.")},function(err){toastr.error("Save invoice item error.")})}}),angular.module("app.loggedIn.patient.appt.controller",[]).controller("PatientApptListController",function($scope,$state,$modal,$filter,toastr,$stateParams,DoctorService,PatientService,ReceptionistService,ConfigService){var patient_id=$stateParams.patient_id,cal_id=$stateParams.cal_id,arrGetBy=$filter("arrGetBy"),get_list_services=function(){ConfigService.system_service_by_clinical($scope.modelObjectMap.dept).then(function(response){$scope.opt_services=response,$scope.opt_services.length>0&&($scope.modelObjectMap.service=$scope.opt_services[0].SERVICE_ID)})},getRecallAppt=function(){PatientService.getRecallAppointments(patient_id).then(function(response){$scope.appt_list=response.data,angular.forEach($scope.appt_list,function(item){item.appointment.FROM_TIME=ConfigService.getCommonDatetime(item.appointment.FROM_TIME)})})},getRecallApptNew=function(){var postData={Patient_id:$stateParams.patient_id,CAL_ID:$stateParams.cal_id};PatientService.getRecallAppointmentsNew(postData).then(function(response){$scope.appt_listNew=response.data,angular.forEach($scope.appt_listNew,function(item){item.FROM_TIME=ConfigService.getCommonDatetime(item.FROM_TIME),item.TO_TIME=ConfigService.getCommonDatetime(item.TO_TIME)})})};getRecallApptNew(),PatientService.get(patient_id).then(function(response){"success"==response.status&&($scope.patient=response.data,$scope.patient.Patient_name=$scope.patient.First_name+" "+$scope.patient.Sur_name)}),ReceptionistService.apptDetail(cal_id).then(function(response){return"success"===response.status&&(delete response.data.Patient_id,angular.extend($scope.appointment,response.data),$scope.modelObjectMap.site=$scope.appointment.SITE_ID,$scope.modelObjectMap.dept=$scope.appointment.CLINICAL_DEPT_ID,$scope.refreshAppointment(),get_list_services()),PatientService.getApptClaim(patient_id,cal_id)}).then(function(response){console.log(response.data),"success"===response.status&&response.data.length>0&&($scope.appointment.Claim_id=response.data[0].Claim_id),console.log($scope.appointment)});var open=function(){$modal.open({templateUrl:"NewCall",size:"lg",controller:function($scope,$modalInstance){$scope.refresh=!1,$scope.$watch("refresh",function(refresh){refresh&&$modalInstance.close("success")})}}).result.then(function(success){success&&getRecallApptNew()})};$scope.formRecall={open:function(){open()}},$scope.bookingPatient=function(data,calIndex,doctorIndex){console.log(data);var cal_id=data.cals[doctorIndex];if(data.doctors[doctorIndex],!cal_id)return void toastr.error("Cannot recall this !!! ","Error");var yes=confirm("Do you want to recall at "+data.from_time_map+" "+ConfigService.getCommonDatetime($scope.modelObjectMap.datepicker)+" with "+$scope.options.doctors[doctorIndex].NAME);if(yes){var patients=data.patients[doctorIndex],p={Patient_id:$scope.patient.Patient_id,Patient_name:$scope.patient.Patient_name};if(""==patients&&(patients=[]),0==patients.length||0==patients[0].Patient_id)patients[0]=p;else{var t_item=arrGetBy(patients,"Patient_id",p.Patient_id);if(t_item)return void toastr.error("Cannot Recall again !!!","Error");patients.push(p)}var str_patients=JSON.stringify(patients),optionMap={CAL_ID:cal_id,SERVICE_ID:$scope.modelObjectMap.service,Patient_id:patient_id,PATIENTS:str_patients};console.log(optionMap),ReceptionistService.booking(optionMap).then(function(response){if("success"===response.status){if(toastr.success("Recall Successful !!!","Success"),$scope.formRecall.close(),$scope.appointment.Claim_id){var item={Claim_id:$scope.appointment.Claim_id,CAL_ID:cal_id,Patient_id:patient_id};PatientService.insertApptClaim(item).then(function(response){console.log(response),"success"===response.status})}getRecallAppt()}})}}}),angular.module("app.loggedIn.patient.apptdoc.controller",[]).controller("PatientApptDocController",function($scope,$stateParams,$timeout,FileUploader,ConfigService,PatientService,toastr){var patient_id=$stateParams.patient_id,cal_id=$stateParams.cal_id,download_api="https://"+location.host+"/api/erm/v2/apptdoc/download?id=";$scope.info_upload={total_size:0,progress_percent:0,pre_progress_percent:0};var uploader=$scope.uploader=new FileUploader({url:"/api/erm/v2/apptdoc/upload",autoUpload:!1,removeAfterUpload:!0,onSuccessItem:function(item,response,status,headers){var uploaded_percent=100*item.file.size/$scope.info_upload.total_size;$scope.info_upload.pre_progress_percent+=uploaded_percent,console.log($scope.info_upload.pre_progress_percent)},onProgressItem:function(item,progress){var uploaded_size=progress*item.file.size/100,uploaded_percent=100*uploaded_size/$scope.info_upload.total_size;$scope.info_upload.progress_percent=$scope.info_upload.pre_progress_percent+uploaded_percent},onCompleteAll:function(res){$scope.document_panel.reload(),$scope.info_upload={total_size:0,progress_percent:0,pre_progress_percent:0},toastr.success("Upload complete!","Complete!"),$scope.documentFileSuccess.runWhenFinish()},onAfterAddingAll:function(items){angular.forEach(items,function(f){$scope.info_upload.total_size+=f.file.size}),$scope.info_upload.step_size=$scope.info_upload.total_size/100,console.log("This is upload files",uploader)}});uploader.formData[0]={patient_id:patient_id,cal_id:cal_id},
$scope.openUploader=function(){$timeout(function(){$("#appt_doc_upload").click()},100)},$scope.document_panel={},$scope.docSelected=function(item){window.open(download_api+item.id)},$scope.docs={select:0,"class":function(doc){return{selected:doc.cal_id==cal_id}},scope:$scope.document_panel,options:{api:"api/erm/v2/apptdoc/search",method:"post",scope:$scope.document_panel,columns:[{field:"id",is_hide:!0},{field:"cal_id",label:"Date",width:"20%",type:"custom",fn:function(item){return item.appointment?moment(item.appointment.FROM_TIME).format("DD-MM-YYYY - hh:mm"):""}},{field:"document_name",label:"Document Name",width:"70%"}],use_filters:!0,filters:{document_name:{type:"text"},cal_id:{type:"dropdown",values:[{label:"Appointment",code:cal_id},{label:"All"}]}},search:{patient_id:$stateParams.patient_id},use_actions:!0,actions:[{"class":"fa fa-times",title:"Delete",callback:function(item){PatientService.deleteFile(item.id).then(function(res){"success"===res.status&&(toastr.success("Delete file success!","Success!"),$scope.document_panel.reload())})}},{"class":"fa fa-download",title:"Donwload",callback:function(item){console.log(item),window.open(download_api+item.id)}}]}}}),angular.module("app.loggedIn.patient.listall.controller",[]).controller("PatientListAllController",function(CompanyModel,$scope,$state){$scope.patient_panel={},$scope.patients={select:0,"class":function(patient){return{selected:patient.ID==$scope.patients.select}},scope:$scope.patient_panel,options:{api:"api/erm/v2/patient/search",method:"post",scope:$scope.patient_panel,columns:[{field:"Patient_id",is_hide:!0},{field:"First_name",label:"First name"},{field:"Sur_name",label:"Last name"},{field:"Address1",label:"Address"},{field:"Post_code",label:"Post Code"}],use_filters:!0,filters:{First_name:{type:"text"},Sur_name:{type:"text"},Address1:{type:"text"},Post_code:{type:"text"}}}},$scope.actionCenter={runWhenFinish:function(){$scope.patientAddForm.close(),$scope.patient_panel.reload()}},$scope.patientAddForm={params:{permission:{edit:!1,create:!0}},is_show:!1,open:function(){$scope.patientAddForm.params.isAtAllPatient=!0,this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&alert("okokok"),$scope.patient_panel.reload()}},$scope.rowClick=function(item){var postData={datetime:moment().format("YYYY-MM-DD hh:mm:ss"),patient_id:item.Patient_id};CompanyModel.getFromTime(postData).then(function(response){-1==response.data?$state.go("loggedIn.patient.detail",{patient_id:item.Patient_id,cal_id:-1}):$state.go("loggedIn.patient.consult",{patient_id:item.Patient_id,cal_id:response.data.CAL_ID})},function(error){})},$scope.patientEditForm={params:{permission:{edit:!0,create:!1}},is_show:!1,open:function(patient_id){$scope.patientEditForm.params.id=patient_id,console.log($scope.patientEditForm.params),this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.patient_panel.reload()}}}),angular.module("app.loggedIn.patient.checkin.controller",[]).controller("PatientCheckinController",function(socket,$scope,ConfigService,PatientService,toastr,$state){$scope.showPatientResult=!1,$scope.showAppointmentOfId=null,$scope.patient_panel={},$scope.appointment_panel={},$scope.patientSearch={},$scope.patients={show:function(searchInfo){$scope.patients.options.search=searchInfo,$scope.patient_panel.reload()},reset:function(){$scope.patients.options.search={First_name:null,Sur_name:null,DOB:null},$scope.patient_panel.reload()},"class":function(patient){},scope:$scope.patient_panel,options:{api:"api/erm/v2/patient/checkin_search",method:"post",scope:$scope.patient_panel,columns:[{field:"Patient_id",label:"ID"},{field:"First_name",label:"First name"},{field:"Sur_name",label:"Last name"},{field:"DOB",label:"Date Of Birth",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.DOB)}},{type:"button",btnlabel:"Appointment",btnfn:function(item){$scope.appointments.show(item.Patient_id),$scope.patientInfoCalendar&&($scope.patientInfoCalendar.Patient_id=item.Patient_id,console.log($scope.patientInfoCalendar),$scope.bottomNewBooking=!0)}}],not_load:!0}},$scope.appointments={show:function(patient_id){$scope.appointments.options.search={Patient_id:patient_id},$scope.appointment_panel.reload()},reset:function(){$scope.appointments.options.search={Patient_id:null},$scope.appointment_panel.reload()},"class":function(appointment){return{}},scope:$scope.appointment_panel,options:{api:"api/erm/v2/appt/appt_by_id",method:"post",scope:$scope.appointment_panel,columns:[{field:"CAL_ID",is_hide:!0},{field:"Patient_id",is_hide:!0},{field:"appointment",label:"Appointment time",type:"custom",fn:function(item){return ConfigService.getCommonDatetime(item.appointment.FROM_TIME)}},{field:"appt_status",label:"Appointment Status",type:"custom",fn:function(item){return ptnConst.apptStatusDisplay[item.appt_status]}},{type:"button",btnlabel:"Check In",btnfn:function(item){console.log("id neeeeee",item.appointment.DOCTOR_ID),PatientService.checkIn(item.CAL_ID,item.Patient_id).then(function(result){"success"!==result.status?toastr.error("Check-in error!","Error"):(socket.emit("notifyReceptionist"),socket.emit("notifyDoctor",item.appointment.DOCTOR_ID),toastr.success("Checked In!","Success!"),$scope.appointment_panel.reload())})},disfn:function(item){return item.appt_status!=ptnConst.apptStatus.booking.value?!0:!1}}],not_load:!0}},$scope.searchClick=function(){if($scope.isSubmit=!0,!$scope.sysservicesForm.$invalid)if($scope.patientSearch.First_name||$scope.patientSearch.Sur_name||$scope.patientSearch.DOB){var searchData={First_name:$scope.patientSearch.First_name,Sur_name:$scope.patientSearch.Sur_name,DOB:$scope.patientSearch.DOB};""===searchData.First_name&&(searchData.First_name=void 0),""===searchData.Sur_name&&(searchData.Sur_name=void 0),""===searchData.DOB&&(searchData.DOB=void 0),searchData.DOB&&(searchData.DOB=ConfigService.getCommonDate(searchData.DOB)),$scope.patients.show(searchData)}else toastr.error("Please provide at least 1 information!","Error!")},$scope.resetClick=function(){$scope.isSubmit=!0,$scope.sysservicesForm.$invalid||($scope.appointments.reset(),$scope.patients.reset(),$scope.patientSearch={})},$scope.goToNewBooking=function(){$scope.patientInfoCalendar?(console.log($scope.patientInfoCalendar.Patient_id),$state.go("webpatient.booking")):toastr.error("No information available on the patient","Error")}}),angular.module("app.loggedIn.patient.makecall.directive",[]).directive("makecallService",function(PatientService,$modal,$timeout,$state,$stateParams,$cookieStore,$modal,toastr,AppointmentModel,mdtRedimedsitesService,mdtDeptService,ConfigService){return{restrict:"EA",templateUrl:"modules/patient/directives/templates/makecall.html",scope:{options:"=",refresh:"="},link:function(scope,elem,attrs){scope.extendMinutes=function(hour,minute){hour=scope.convertToSeconds(hour);var seconds=hour+60*minute,sec_num=parseInt(seconds,10),hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-3600*hours)/60);10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes);var time=hours+":"+minutes;return time},scope.convertToSeconds=function(time){var hour=parseInt(time.substring(0,2)),minute=parseInt(time.substring(3));return 3600*hour+60*minute},scope.differentTimeHours=function(hourOne,hourSecond){return 0!==hourSecond?(hourOne=scope.convertToSeconds(hourOne),hourSecond=scope.convertToSeconds(hourSecond),(hourSecond-hourOne)/60):0};var search={datepicker:moment().format("DD/MM/YYYY"),site_id:1,clinical_dept_id:""},loadSite=function(){mdtRedimedsitesService.list().then(function(response){scope.site.list=response.data},function(error){})},loadClinical=function(){mdtDeptService.listAll().then(function(response){scope.clinicalDept.list=response.data},function(error){})},load=function(){var postData=angular.copy(scope.appointment.search);postData.datepicker=ConfigService.convertToDB(postData.datepicker),scope.appointment.list=[],AppointmentModel.load(postData).then(function(response){scope.doctor.headers=response.doctors;var doctor_array_temp=[];_.forEach(response.doctors,function(doctor){doctor_array_temp.push({DOCTOR_ID:doctor.DOCTOR_ID,left:0})});var min_calendar=9999;_.forEach(response.data,function(data){var flagTheme=-1,flagPatient=-1,i=0;if(_.forEach(scope.appointment.list,function(list){list.FROM_TIME===data.FROM_TIME&&_.forEach(list.cals,function(cal){return cal===data.CAL_ID?void(flagPatient=i):void(flagTheme=i)}),i++}),data.Patient_id&&-1===flagPatient&&(flagPatient=1e3),-1!==flagPatient)if(1e3!==flagPatient){var doctor_row=0;scope.appointment.list[flagPatient].cals.push(data.CAL_ID),_.forEach(response.doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[flagPatient].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,outreferral:data.outreferral,DOCTOR_ID:data.DOCTOR_ID}),void(scope.appointment.list[flagPatient].doctors[doctor_row].PATIENTS="ok")):void doctor_row++})}else{var temp_index=0,flagIndex=!1;if(_.forEach(scope.appointment.list,function(list){data.FROM_TIME===list.FROM_TIME&&_.forEach(list.doctors,function(doc){if(doc.DOCTOR_ID===data.DOCTOR_ID){if("###"===doc.PATIENTS){var doctor_row=0;return scope.appointment.list[temp_index].cals.push(data.CAL_ID),_.forEach(response.doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[temp_index].doctors[doctor_row].CAL_ID=data.CAL_ID,scope.appointment.list[temp_index].doctors[doctor_row].SERVICE_COLOR=data.SERVICE_COLOR,scope.appointment.list[temp_index].doctors[doctor_row].patients=[],scope.appointment.list[temp_index].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),scope.appointment.list[temp_index].doctors[doctor_row].PATIENTS="ok",void(scope.appointment.list[temp_index].doctors[doctor_row].IS_REFERRAL=data.IS_REFERRAL)):void doctor_row++}),void(flagIndex=!0)}var doctor_row=0;return scope.appointment.list[temp_index].cals.push(data.CAL_ID),_.forEach(response.doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[temp_index].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),void(scope.appointment.list[temp_index].doctors[doctor_row].PATIENTS="ok")):void doctor_row++}),void(flagIndex=!0)}}),temp_index++}),!flagIndex){var doctors=[];_.forEach(response.doctors,function(doctor){doctors.push(doctor.DOCTOR_ID===data.DOCTOR_ID?{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,SERVICE_ID:data.SERVICE_ID,CAL_ID:data.CAL_ID,IS_REFERRAL:data.IS_REFERRAL,SERVICE_COLOR:data.SERVICE_COLOR,PATIENTS:"MESS_SYS_010",patients:[],CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID}:{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,PATIENTS:"###"})});var doctor_row=0;_.forEach(doctors,function(doctor){doctor.DOCTOR_ID===data.DOCTOR_ID&&(doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),doctors[doctor_row].PATIENTS="ok"),doctor_row++});var cal=[];cal.push(data.CAL_ID);var object={FROM_TIME:data.FROM_TIME,TO_TIME:data.TO_TIME,cals:cal,doctors:doctors};scope.appointment.list.push(object)}}else if(-1!==flagTheme){var doctor_row=0;_.forEach(scope.appointment.list[flagTheme].doctors,function(doctor){return doctor.DOCTOR_ID===data.DOCTOR_ID?(scope.appointment.list[flagTheme].doctors[doctor_row].patients=[],scope.appointment.list[flagTheme].cals.push(data.CAL_ID),null!==data.Patient_id&&scope.appointment.list[flagTheme].doctors[doctor_row].patients.push({Patient_id:data.Patient_id,First_name:data.First_name,Sur_name:data.Sur_name,Outreferral:data.outreferral}),scope.appointment.list[flagTheme].doctors[doctor_row].PATIENTS="MESS_SYS_010",scope.appointment.list[flagTheme].doctors[doctor_row].SERVICE_ID=data.SERVICE_ID,scope.appointment.list[flagTheme].doctors[doctor_row].CAL_ID=data.CAL_ID,scope.appointment.list[flagTheme].doctors[doctor_row].SERVICE_COLOR=data.SERVICE_COLOR,scope.appointment.list[flagTheme].doctors[doctor_row].IS_REFERRAL=data.IS_REFERRAL,scope.appointment.list[flagTheme].doctors[doctor_row].CLINICAL_DEPT_ID=data.CLINICAL_DEPT_ID,void(scope.appointment.list[flagTheme].doctors[doctor_row].patients.length>0&&(scope.appointment.list[flagTheme].doctors[doctor_row].PATIENTS="ok"))):void doctor_row++})}else{var doctors=[];_.forEach(response.doctors,function(doctor){doctors.push(doctor.DOCTOR_ID===data.DOCTOR_ID?{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,SERVICE_ID:data.SERVICE_ID,CAL_ID:data.CAL_ID,IS_REFERRAL:data.IS_REFERRAL,SERVICE_COLOR:data.SERVICE_COLOR,PATIENTS:"MESS_SYS_010",patients:[],CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID}:{DOCTOR_ID:doctor.DOCTOR_ID,DOCTOR_NAME:doctor.NAME,PATIENTS:"###"})});var differentTimeHours=scope.differentTimeHours(data.FROM_TIME,data.TO_TIME);min_calendar>=differentTimeHours&&(min_calendar=differentTimeHours);var i=0;_.forEach(doctor_array_temp,function(doctor){doctor.DOCTOR_ID===data.DOCTOR_ID&&(doctor_array_temp[i].left=scope.differentTimeHours(data.FROM_TIME,data.TO_TIME)),i++});var cal=[];cal.push(data.CAL_ID);var object={FROM_TIME:data.FROM_TIME,TO_TIME:data.TO_TIME,cals:cal,SERVICE_ID:data.SERVICE_ID,CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID,doctors:doctors};scope.appointment.list.push(object)}}),scope.appointment.new_list=[];var i=0;if(scope.appointment.list.length>0)var begin_from_time=scope.appointment.list[0].FROM_TIME;_.forEach(scope.appointment.list,function(list){if("undefined"!=typeof scope.appointment.list[i+1])var begin_to_time=scope.appointment.list[i+1].FROM_TIME;else var begin_to_time=scope.extendMinutes(begin_from_time,45);var diff=scope.differentTimeHours(begin_from_time,begin_to_time);scope.appointment.new_list.push(scope.appointment.list[i]);var new_list_length=scope.appointment.new_list.length,j=0;_.forEach(scope.appointment.new_list[new_list_length-1].doctors,function(doctor){scope.appointment.new_list[new_list_length-1].doctors[j].border="yes",j++});for(var diff_i=15;diff-15>=diff_i;diff_i+=15){var from_time=scope.extendMinutes(scope.appointment.list[i].FROM_TIME,diff_i);begin_from_time=from_time;var temp_doctors=angular.copy(scope.appointment.list[i].doctors),doc_i=0;_.forEach(temp_doctors,function(doctor){temp_doctors[doc_i].PATIENTS="###",doc_i++}),scope.appointment.new_list.push({FROM_TIME:from_time,doctors:temp_doctors})}begin_from_time=scope.extendMinutes(begin_from_time,15),i++}),scope.appointment.list=angular.copy(scope.appointment.new_list);var i=0;_.forEach(scope.appointment.list,function(list){var j=0;_.forEach(list.doctors,function(doctor){var k=0;_.forEach(doctor_array_temp,function(temp){doctor.DOCTOR_ID===temp.DOCTOR_ID&&("###"!==doctor.PATIENTS?(doctor_array_temp[k].left_temp=doctor_array_temp[k].left-15,doctor_array_temp[k].color=scope.appointment.list[i].doctors[j].SERVICE_COLOR,0===doctor_array_temp[k].left_temp&&(scope.appointment.list[i].doctors[j].height="35px")):doctor_array_temp[k].left_temp>0&&(scope.appointment.list[i].doctors[j].SERVICE_COLOR=doctor_array_temp[k].color,doctor_array_temp[k].left_temp-=15,0===doctor_array_temp[k].left_temp&&(scope.appointment.list[i].doctors[j].height="35px"))),k++}),j++}),i++});var i=0;_.forEach(scope.appointment.list,function(list){var j=0;_.forEach(list.doctors,function(doctor){"undefined"!=typeof scope.appointment.list[i].doctors[j].patients&&scope.appointment.list[i].doctors[j].patients.length>1&&"ok"===scope.appointment.list[i].doctors[j].PATIENTS&&(scope.appointment.list[i].doctors[j].height="auto"),j++}),i++})},function(error){})},onOrder=function(data){var postData={Patient_id:$stateParams.patient_id,CAL_ID:data};PatientService.Add_CAL(postData).then(function(response){scope.refresh=!0},function(error){})};scope.site={list:[],load:function(){loadSite()}},scope.doctor={headers:[]},scope.appointment={list:[],onOrder:function(data){onOrder(data)},search:angular.copy(search),load:function(){load()}},scope.clinicalDept={list:[],load:function(){loadClinical()}},scope.site.load(),scope.clinicalDept.load(),scope.appointment.load()}}}),angular.module("app.loggedIn.patient.claim",["app.loggedIn.patient.claim.controllers","app.loggedIn.patient.claim.services"]).config(function($stateProvider){}),angular.module("app.loggedIn.patient.claim.services",[]).factory("ClaimService",function(Restangular){var claimService={},mdtApi=Restangular.all("api/meditek/v1/patient/claim");return claimService.search=function(options){var funcApi=mdtApi.all("search");return funcApi.post(options)},claimService.add=function(params){var funcApi=mdtApi.all("add");return funcApi.post(params)},claimService}),angular.module("app.loggedIn.patient.claim.controllers",["app.loggedIn.patient.claim.list.controller"]).controller("ClaimController",function($scope){}),angular.module("app.loggedIn.patient.claim.list.controller",[]).controller("ClaimListController",function($scope,$stateParams,ClaimService,toastr){var idClaimDetailAdd="#PopupClaimDetailAdd";$scope.claim_params={permission:{edit:!1},isOpenFirst:!1,Patient_id:$stateParams.patient_id},$scope.list={},$scope.$watch("claim",function(newClaim){"undefined"!=typeof newClaim&&(loadList(),angular.element(idClaimDetailAdd).fadeOut())}),$scope.params={pagination:{limit:10,offset:0,current_page:1,max_size:5},filters:[{type:"select",name:"Patient_id",value:$stateParams.patient_id},{type:"select",name:"Claim_no",value:""},{type:"text",name:"Injury_name",value:""},{type:"text",name:"Location",value:""}],select:["Claim_id","Patient_id","Claim_no","Injury_name","Location"]};var loadList=function(){ClaimService.search($scope.params).then(function(response){"success"===response.status&&($scope.list=response)},function(error){console.log("Error Server")})};loadList(),$scope.refreshList=function(){loadList()},$scope.setPage=function(){$scope.params.pagination.offset=($scope.params.pagination.current_page-1)*$scope.params.pagination.limit,loadList()},$scope.openPopup=function(option){$scope.claim_params.isOpenFirst=!0,"add"===option.type&&$scope.claim_params.isOpenFirst===!0&&angular.element(idClaimDetailAdd).fadeIn()},$scope.clickRow=function(claimData){$scope.claim_params.isOpenFirst=!0,$scope.claim_params.permission.edit!==!0&&($scope.claim_params={permission:{edit:!0,Claim_id:claimData.row.Claim_id}}),($scope.claim_params.isOpenFirst=!0)&&angular.element(idClaimDetailAdd).fadeIn()},$scope.$watch("claim_params.permission.edit",function(editMode){editMode!==!0&&loadList()})}),angular.module("app.loggedIn.patient.problem",["app.loggedIn.patient.problem.list.controller","app.loggedIn.patient.problem.directive","app.loggedIn.patient.problem.service"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.problem_list",{url:"/problem",views:{"main-content":{templateUrl:"modules/problem/views/list.html",controller:"ProblemListController"}}})}),angular.module("app.loggedIn.problem.controller",["app.loggedIn.problem.list.controller"]).controller("ProblemController",function(){}),angular.module("app.loggedIn.patient.problem.list.controller",[]).controller("ProblemListController",function($scope,$stateParams,ConfigService){$scope.problem_panel={},console.log("this is patient id",$stateParams),$scope.problem={select:0,scope:$scope.problem_panel,options:{api:"api/erm/v2/problem/search",method:"post",scope:$scope.problem_panel,columns:[{field:"Problem_id",is_hide:!0},{field:"Notes",label:"Problem description"},{field:"From_date",label:"From",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.From_date)}},{field:"To_date",label:"To",type:"custom",fn:function(item){return ConfigService.getCommonDateDefault(item.To_date)}}],search:{Patient_id:$stateParams.patient_id},use_filters:!0,filters:{Notes:{type:"text"}},use_actions:!0,actions:[{"class":"fa fa-info",title:"Edit",callback:function(item){console.log("this is selected item",item),$scope.problem.id=item.Problem_id,$scope.problemEditForm.open()}}]}},$scope.problemAddForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.problem_panel.reload(),$scope.problemAddForm.close()}},$scope.problemEditForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.problem_panel.reload(),$scope.problemEditForm.close()}}}),angular.module("app.loggedIn.patient.problem.directive",["app.loggedIn.patient.problem.detail.directive"]),angular.module("app.loggedIn.patient.problem.detail.directive",[]).directive("problemDetail",function(ProblemModel,ProblemService,ConfigService,toastr,$stateParams){return{restrict:"EA",scope:{data:"@",options:"=",onsuccess:"=onsuccess"},templateUrl:"modules/problem/directives/templates/detail.html",link:function(scope,element,attrs){var patient_id=$stateParams.patient_id,loadData=function(id){ProblemService.detail(id).then(function(data){angular.extend(scope.modelObjectMap,data.data),ConfigService.autoConvertData(scope.modelObjectMap)})};if(scope.modelObjectMap=angular.copy(ProblemModel),scope.mode={type:"add",text:"Add problem"},scope.modelObjectMap.From_date=new Date,scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit problem"})}var addProcess=function(postData){postData.Patient_id=patient_id,ProblemService.insert(postData).then(function(response){"success"===response.status&&(toastr.success("Problem added","Success"),scope.modelObjectMap=angular.copy(ProblemModel),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})},editProcess=function(postData){ProblemService.update(postData).then(function(response){"success"===response.status&&(toastr.success("Edit problem Successfully","Success"),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.patient.problem.service",[]).factory("ProblemService",function(Restangular,ConfigService,$state){var instanceService={},v2_api=Restangular.all("api/erm/v2");return instanceService.insert=function(postData){var detailApi=v2_api.all("problem/insert");return detailApi.post(postData)},instanceService.detail=function(postData){var detailApi=v2_api.all("problem/detail");return detailApi.post({ID:postData})},instanceService.update=function(postData){var detailApi=v2_api.all("problem/update");return detailApi.post(postData)},instanceService}),angular.module("app.loggedIn.receptionist",["app.loggedIn.receptionist.controller","app.loggedIn.receptionist.services","app.loggedIn.receptionist.directives"]).config(function($stateProvider){$stateProvider.state("loggedIn.receptionist",{"abstract":!0,templateUrl:"modules/receptionist/views/structure.html",controller:"ReceptionistController"}).state("loggedIn.receptionist.home",{url:"/receptionist/home",views:{"main-content":{templateUrl:"modules/receptionist/views/home.html",controller:"ReceptionistHomeController"}}})}),angular.module("app.loggedIn.receptionist.services",[]).service("receptionStileService",function(){var receptionStile=null;this.getreceptionStile=function(){return receptionStile},this.setreceptionStile=function(site){receptionStile=JSON.parse(JSON.stringify(site))}}).factory("ReceptionistService",function(Restangular){var receptionistService={},ermApi=Restangular.all("api/erm"),restfulAPI=Restangular.all("api/restful");receptionistService.getAppointmentList=function(options){return ermApi.all("appointment/get").post(options)},receptionistService.getAppointmentOverview=function(options){return ermApi.all("appointment/overview").post(options)},receptionistService.booking=function(options){return ermApi.all("appointment/booking").post(options)},receptionistService.getById=function(id){return ermApi.all("appointment/getById").post({booking_id:id})},receptionistService.deleteBooking=function(options){return ermApi.all("appointment/delete").post(options)},receptionistService.updateBooking=function(options){return ermApi.all("appointment/update").post(options)},receptionistService.updateStatus=function(options){return ermApi.all("appointment/updateStatus").post(options)},receptionistService.apptDetail=function(cal_id){return ermApi.one("v2/appt/detail").get({id:cal_id})},receptionistService.getItemAppt=function(appt_id,patient_id){return ermApi.all("v1/appointment/get_items").post({appt_id:appt_id,patient_id:patient_id})},receptionistService.itemFeeAppt=function(service_id,list_id){return ermApi.all("v2/appt/item_fee_appt").post({service_id:service_id,list_id:list_id})},receptionistService.getReferral=function(appt_id,patient_id){return restfulAPI.one("Referral").get({CAL_ID:appt_id,patient_id:patient_id})};var receptionistApi=Restangular.all("api/receptionist");return receptionistService.getAppointmentByDate=function(date,site){return receptionistApi.all("appointment/getByDate").post({date:date,siteId:site})},receptionistService.getProgressAppt=function(date,site){return receptionistApi.all("appointment/progress").post({date:date,siteId:site})},receptionistService.updateAppointment=function(from,to,state){return receptionistApi.all("appointment/update").post({fromAppt:from,toAppt:to,state:state})},receptionistService.getSite=function(){return receptionistApi.one("getSites").get()},receptionistService}),angular.module("app.loggedIn.receptionist.directives",[]),angular.module("app.loggedIn.receptionist.controller",["app.loggedIn.receptionist.home.controller"]).controller("ReceptionistController",function($scope,ConfigService,ReceptionistService){}),angular.module("app.loggedIn.receptionist.home.controller",[]).controller("ReceptionistHomeController",function(AppointmentModel,$scope,$filter,$state,$timeout,$modal,socket,$cookieStore,toastr,ConfigService,DoctorService,ReceptionistService,PatientService,localStorageService,sysServiceService,receptionStileService,AppointmentModel){function getAppt(date,site){var d=moment(date).format("YYYY-MM-DD");$scope.upcomingAppt=[],$scope.progressAppt=[],$scope.completeAppt=[],$scope.injuryAppt=[],$scope.checkedAppt=[],loadAlertCenter(site),ReceptionistService.getAppointmentByDate(d,site).then(function(rs){"success"==rs.status.toLowerCase()&&($scope.upcomingAppt=rs.upcoming,$scope.completeAppt=rs.completed,$scope.injuryAppt=rs.injury,$scope.checkedAppt=rs.checkedIn,ReceptionistService.getProgressAppt(d,site).then(function(rs){"success"==rs.status.toLowerCase()&&($scope.progressAppt=rs.data)}))})}$scope.apptDate=new Date,$scope.apptSite=receptionStileService.getreceptionStile(),$scope.upcomingAppt=[],$scope.progressAppt=[],$scope.completeAppt=[],$scope.injuryAppt=[],$scope.checkedAppt=[],$scope.undoArr=[],$scope.fromAppt={},$scope.startCheckedTime=null,$scope.servicedata={},$scope.getServiceColor=function(){AppointmentModel.getServiceColor("data").then(function(response){$scope.servicedata=response.data},function(error){})},$scope.getServiceColor(),ReceptionistService.getSite().then(function(rs){"success"==rs.status?$scope.siteList=rs.data:toastr.error("Site Error!")}),$scope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){receptionStileService.setreceptionStile($scope.apptSite)}),$scope.clickArrow=function(){$scope.alertCenter.arrow=!$scope.alertCenter.arrow,$scope.alertCenter.arrow?(angular.element("#alert-center").css({display:"none"}),angular.element(".un_arrow").css({right:0})):(angular.element("#alert-center").css({display:"block"}),angular.element(".un_arrow").css({right:"225px"}))};var loadAlertCenter=function(site){date=moment(new Date).format("YYYY-MM-DD");var postData={datepicker:date,site_id:site};$scope.alertCenter.list=[],AppointmentModel.alertSiteCenter(postData).then(function(response){_.forEach(response.data,function(row){var flag=-1,i=0;if(_.forEach($scope.alertCenter.list,function(list){return list.Patient_id===row.Patient_id?void(flag=i):void i++}),-1!==flag){if(row.ALERT_ID){var alert_flag=!0;if(_.forEach($scope.alertCenter.list[flag].alert,function(alert){alert.id===row.ALERT_ID&&(alert_flag=!1)}),alert_flag){var object={id:row.ALERT_ID,name:row.ALERT_NAME};$scope.alertCenter.list[flag].alert.push(object)}var cal_flag=!0,i=0;if(_.forEach($scope.alertCenter.list[flag].cal,function(cal){cal.CAL_ID===row.CAL_ID&&(cal_flag=!1)}),cal_flag&&($scope.alertCenter.list[flag].test=row.IS_REFERRAL,$scope.alertCenter.list[flag].cal.push({IS_REFERRAL:row.IS_REFERRAL,CAL_ID:row.CAL_ID,FROM_TIME:row.FROM_TIME,TO_TIME:row.TO_TIME,OUTREFERRAL:"no",DOCTOR_ID:row.DOCTOR_ID}),row.outreferral_id)){var cal_length=$scope.alertCenter.list[flag].cal.length;$scope.alertCenter.list[flag].cal[cal_length-1].OUTREFERRAL="yes"}}}else{var object={Patient_id:row.Patient_id,First_name:row.First_name,Sur_name:row.Sur_name,alert:[],cal:[]};row.ALERT_ID&&object.alert.push({id:row.ALERT_ID,name:row.ALERT_NAME}),row.CAL_ID&&(object.test=row.IS_REFERRAL,object.cal.push({IS_REFERRAL:row.IS_REFERRAL,DOCTOR_ID:row.DOCTOR_ID,CAL_ID:row.CAL_ID,FROM_TIME:row.FROM_TIME,TO_TIME:row.TO_TIME,OUTREFERRAL:"no"}),row.outreferral_id&&(object.cal[0].OUTREFERRAL="yes")),$scope.alertCenter.list.push(object)}})},function(error){})};$scope.alertCenter={load:function(){loadAlertCenter()},list:[],arrow:!1},loadAlertCenter(-1),$scope.getAppointment=function(){null==$scope.apptSite?(toastr.warning("Please Choose Site!"),$scope.upcomingAppt=[],$scope.progressAppt=[],$scope.completeAppt=[],$scope.injuryAppt=[],$scope.checkedAppt=[]):getAppt($scope.apptDate,$scope.apptSite)},getAppt($scope.apptDate,$scope.apptSite),$scope.openMap=function(){var modalInstance=$modal.open({templateUrl:"modules/receptionist/views/modals/modalMap.html",controller:"InjuryMapController",size:"lg"});modalInstance.result.then(function(){getAppt($scope.apptDate,$scope.apptSite)},function(){getAppt($scope.apptDate,$scope.apptSite)})},$scope.doctorSetting=function(){var modalInstance=$modal.open({templateUrl:"modules/receptionist/views/modals/settingModal.html",controller:"DoctorSettingController",size:"lg"});modalInstance.result.then(function(){getAppt($scope.apptDate,$scope.apptSite),socket.emit("notifyReceptionist")},function(){getAppt($scope.apptDate,$scope.apptSite),socket.emit("notifyReceptionist")})},$scope.changeAppt=function(appt,status){swal({title:"Are You Sure To Update This Appointment?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0,closeOnCancel:!0},function(){ReceptionistService.updateAppointment(appt,appt,status).then(function(rs){"success"==rs.status&&(toastr.success("Update Appointment Success!"),socket.emit("notifyReceptionist"))}),getAppt($scope.apptDate,$scope.apptSite)})},$scope.dragAppt=function(event,ui,data){$scope.fromAppt=angular.copy(data)},$scope.dropAppt=function(event,ui,doctor){$scope.fromAppt&&swal({title:"Are You Sure To Set This Appointment?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0,closeOnCancel:!0},function(isConfirm){isConfirm?ReceptionistService.updateAppointment($scope.fromAppt,doctor,"progress").then(function(rs){"success"==rs.status&&(toastr.success("Update Appointment Success!"),socket.emit("notifyDoctor",doctor.doctor_id),socket.emit("notifyPatient",$scope.fromAppt.appt_id),socket.emit("notifyReceptionist"),$scope.undoArr=[],$scope.undoArr.push($scope.fromAppt)),getAppt($scope.apptDate,$scope.apptSite)}):getAppt($scope.apptDate,$scope.apptSite)})},socket.on("receiveNotifyReceptionist",function(){
getAppt($scope.apptDate,$scope.apptSite)}),$scope.undoAction=function(){$scope.undoArr.length>0&&(console.log($scope.undoArr[0]),swal({title:"Are You Sure To Undo Action?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0,closeOnCancel:!0},function(){ReceptionistService.updateAppointment($scope.undoArr[0],$scope.undoArr[0],"undo").then(function(rs){"success"==rs.status&&(toastr.success("Undo Action Success!"),$scope.undoArr=[])}),getAppt($scope.apptDate,$scope.apptSite)}))}}),angular.module("app.loggedIn.rlob.controller",[]).controller("rlobController",function($scope,$http,$state,$window,$q,$stateParams,FileUploader,$cookieStore,$interval){$scope.bookingType=rlobConstant.bookingType.REDiLEGAL.name,$scope.bookingTypeObj=rlobConstant.bookingType.REDiLEGAL,$scope.contactDetails.splice(0),$scope.contactDetails.push({label:"",content:$scope.bookingTypeObj.display}),$scope.contactDetails.push({label:"Phone :",content:"(08) 9230 0900"}),$scope.contactDetails.push({label:"Email :",content:"medicolegal@redimed.com.au"}),$scope.have_redilegal_components.value=1,$scope.updateDailyNotificationRlobBooking()}),angular.module("app.loggedIn.vaccinob.controller",[]).controller("vaccinobController",function($scope,$http,$state,$window,$q,$stateParams,FileUploader,$cookieStore,$interval){$scope.bookingType=rlobConstant.bookingType.Vaccination.name,$scope.contactDetails.push({label:"",content:$scope.bookingType})});var rlobHelper={setSlimCroll:function(selector){$(selector).slimscroll({})}},rlobConstant={bookingStatus:{confirmed:"Confirmed",arrived:"Arrived",notArrived:"Not Arrived",completed:"Completed",cancel:"Cancel",lateCancellation:"Late Cancellation"},bellType:{changeStatus:"Change Booking Status",result:"Result",message:"Message",changeCalendar:"Change Appointment Calendar",notification:"Notification"},letterType:{result:"Result"},notificationType:{bell:"bell",letter:"letter"},bookingType:{REDiLEGAL:{alias:"rlob",name:"REDiLEGAL",display:"Medico-Legal"},Vaccination:{alias:"vaccinob",name:"Vaccination",display:"Vaccination"}},notifyJsColor:{warning:"warning",danger:"danger",success:"success"},documentStatus:{noDocuments:{value:"No documents",display:"Not Received"},notConfirmed:{value:"Not confirmed",display:"Not confirmed"},checked:{value:"Checked",display:"Received"}},documentStatusFilter:{noDocuments:{value:"No documents",display:"Not Received"},checked:{value:"Checked",display:"Received"}},documentStatusDisplay:{"No documents":"Not received","Not confirmed":"Not confirmed",Checked:"Received"},documentStatusSummaryStyleClass:{notConfirmed:"booking-item document-status-not-confirmed",checked:"booking-item document-status-checked",noDocuments:"booking-item document-status-no-documents"},notificationAppearance:{once:"ONCE",whenAccess:"WHEN ACCESS"},userType:{admin:1,redimed:2,company:3,doctor:4,nurse:5,driver:6,assistant:7},registerStatus:{PENDING:{value:"PENDING",display:"Pending",style:"success"},APPROVE:{value:"APPROVE",display:"Approve",style:""},REJECT:{value:"REJECT",display:"Reject",style:"warning"}},msgPopupType:{success:"success",error:"error"}},exlog={alert:function(){for(var str="",i=0;i<arguments.length;i++)str=str+JSON.stringify(arguments[i])+"  |  ";alert(str.slice(0,str.length-4))},log:function(){console.log("%c----------------------TANNV BEGIN LOG------------------------","background: #ABC7E9; color: #141B76");for(var i=0;i<arguments.length;i++)console.log("%c"+JSON.stringify(arguments[i]),"background: #ABC7E9; color: #141B76");console.log("%c----------------------TANNV END LOG--------------------------","background: #ABC7E9; color: #141B76")},logErr:function(){console.log("%c----------------------TANNV ERROR BEGIN LOG------------------------","background: #D4B1B1; color: red");for(var i=0;i<arguments.length;i++)console.log("%c"+JSON.stringify(arguments[i]),"background: #D4B1B1; color: red");console.log("%c-----------------------TANNV ERROR END LOG-------------------------","background: #D4B1B1; color: red")}},rlobDate={daysOfWeek:[{value:0,alias:"sun",display:"Sunday"},{value:1,alias:"mon",display:"Monday"},{value:2,alias:"tue",display:"Tueday"},{value:3,alias:"wed",display:"Wednesday"},{value:4,alias:"thu",display:"Thursday"},{value:5,alias:"fri",display:"Friday"},{value:6,alias:"sat",display:"Saturday"}],getDateStartWeek:function(date){var dayValue=date.getDay();return moment(date).add(1-dayValue,"days")},getDateEndWeek:function(date){var dayValue=date.getDay();return moment(date).add(6-dayValue,"days")}},rlobLang={rlobHeader:"Medico-Legal Online Booking"},rlobMsg={popup:function(header,type,content){$("#rlob-global-msg-popup .rlob-global-msg-popup-header").text(header),type==rlobConstant.msgPopupType.success&&($("#rlob-global-msg-popup .rlob-global-msg-popup-success").show(),$("#rlob-global-msg-popup .rlob-global-msg-popup-error").hide(),$("#rlob-global-msg-popup .rlob-global-msg-popup-success .rlob-global-msg-popup-content").text(content)),type==rlobConstant.msgPopupType.error&&($("#rlob-global-msg-popup .rlob-global-msg-popup-error").show(),$("#rlob-global-msg-popup .rlob-global-msg-popup-success").hide(),$("#rlob-global-msg-popup .rlob-global-msg-popup-error .rlob-global-msg-popup-content").text(content)),$("#rlob-global-msg-popup").modal({show:!0,backdrop:"static"})}},rlobScrollTo=function(selector,offeset){var el=$(selector),pos=el&&el.size()>0?el.offset().top:0;el&&($("body").hasClass("page-header-fixed")&&(pos-=$(".page-header").height()),pos+=offeset?offeset:-1*el.height()),$("html,body").animate({scrollTop:pos},"slow")};angular.module("app.loggedIn.rlob.directive",["app.calendar.mobile.controller"]).directive("noticeRepeatFinish",function(){return function(scope,element,attrs){scope.$last&&scope.collapseAll()}}).directive("mytable",["$timeout",function($timeout){return{restrict:"E",template:'<table width="100%" class="table table-hover table-striped" id="sample_editable_1"><thead><tr style="border-color: white"><th></th><th></th><th></th><th></th><th></th></tr><tr style="background-color: #585858; color: white"><th>ClaimNo</th><th>Surname</th><th>Type</th><th>Booking Date</th><th>Appointment Date</th></tr></thead><tr ng-repeat="booking in data"><td>{{booking.CLAIM_NO}}</td><td>{{booking.WRK_SURNAME}}</td><td>{{booking.Rl_TYPE_NAME}}</td><td>{{parseDate(booking.BOOKING_DATE)}}</td><td>{{parseDate(booking.APPOINTMENT_DATE)}}</td></tr></table>',controller:"rlob_bookingListController",link:function(scope,element,attrs,ctr){$timeout(function(){TableEditable.init();var initPickers=function(){$(".date-picker").rlobdatepicker({rtl:Metronic.isRTL(),autoclose:!0,format:"dd/mm/yyyy"})};initPickers()},0)}}}]).directive("rlobDialog",function(){return{restrict:"E",transclude:!0,scope:{dialogClass:"@",header:"=",status:"=",msg:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_msg_dialog_template.html"}}).directive("rlobOrderBy",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{fieldName:"@",rlobModel:"=",startupDirect:"@",currentFieldSort:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_orderby_template.html",controller:function($scope){$scope.direct=angular.copy($scope.startupDirect),$scope.changeDirect=function(direct,fieldName){$scope.currentFieldSort=angular.copy(fieldName),$scope.direct=direct,$scope.rlobModel=$scope.fieldName+" "+$scope.direct}}}}).directive("rlobBookingDetail",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedBooking:"=",bookingType:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_booking_detail_template.html",controller:function($scope){function codeAddress(){var address=$scope.selectedBooking.Site_addr;geocoder.geocode({address:address},function(results,status){status==google.maps.GeocoderStatus.OK?(map.setCenter(results[0].geometry.location),new google.maps.Marker({map:map,position:results[0].geometry.location})):alert("Geocode was not successful for the following reason: "+status)})}var geocoder,map;geocoder=new google.maps.Geocoder;var latlng=new google.maps.LatLng(-34.397,150.644),mapOptions={zoom:16,center:latlng};map=new google.maps.Map(document.getElementById("map-canvas"),mapOptions),$scope.$watch("selectedBooking",function(newValue,oldValue){$scope.selectedBooking&&codeAddress()})}}}).directive("rlobBookingDetailCompact",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedBooking:"=",bookingType:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_booking_detail_template-compact.html",controller:function($scope){$scope.panelAccordion={status1:!0,status2:!0,status3:!0,status4:!0}}}}).directive("rlobBookingDetailPrint",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedBooking:"=",bookingType:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_booking_detail_template_print.html",controller:function($scope){function codeAddress(){var address1=$scope.selectedBooking.Site_addr;GMaps.geocode({address:address1,callback:function(results,status){if("OK"==status){latlng1=results[0].geometry.location;var url=GMaps.staticMapURL({lat:latlng1.lat(),lng:latlng1.lng(),markers:[{lat:latlng1.lat(),lng:latlng1.lng()}]});url=url.replace("http://","https://"),$("#imgMapPrint").attr("src",url)}}})}$scope.dateValue=new Date,$scope.$watch("selectedBooking",function(newValue,oldValue){$scope.selectedBooking&&codeAddress()})}}}).directive("rlobUpload",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedBooking:"=",isAdminUpload:"=",filesUpdateFlag:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_upload_template.html",controller:function($scope,$http,$cookieStore,FileUploader,rlobService){$scope.loginInfo=$cookieStore.get("userInfo");var uploader=$scope.uploader=new FileUploader({url:"/api/rlob/rl_booking_files/upload"});uploader.filters.push({name:"customFilter",fn:function(item,options){return this.queue.length<10}}),uploader.onWhenAddingFileFailed=function(item,filter,options){console.info("onWhenAddingFileFailed",item,filter,options)},uploader.onAfterAddingFile=function(fileItem){console.info("onAfterAddingFile",fileItem)},uploader.onAfterAddingAll=function(addedFileItems){console.info("onAfterAddingAll",addedFileItems)},uploader.onBeforeUploadItem=function(item){console.info("onBeforeUploadItem",item)},uploader.onProgressItem=function(fileItem,progress){console.info("onProgressItem",fileItem,progress)},uploader.onProgressAll=function(progress){console.info("onProgressAll",progress)},uploader.onSuccessItem=function(fileItem,response,status,headers){console.info("onSuccessItem",fileItem,response,status,headers)},uploader.onErrorItem=function(fileItem,response,status,headers){console.info("onErrorItem",fileItem,response,status,headers)},uploader.onCancelItem=function(fileItem,response,status,headers){console.info("onCancelItem",fileItem,response,status,headers)},uploader.onCompleteItem=function(fileItem,response,status,headers){console.info("onCompleteItem",fileItem,response,status,headers)},uploader.onCompleteAll=function(){$scope.filesUpdateFlag=void 0!=$scope.filesUpdateFlag?$scope.filesUpdateFlag+1:1,console.info("onCompleteAll")},console.info("uploader",uploader),$scope.$watch("selectedBooking",function(newValue,oldValue){$scope.selectedBooking&&(uploader.clearQueue(),uploader.formData[0]={},uploader.formData[0].booking_id=$scope.selectedBooking.BOOKING_ID,uploader.formData[0].company_id=$scope.loginInfo.company_id,uploader.formData[0].worker_name=$scope.selectedBooking.WRK_SURNAME,$scope.isAdminUpload||(uploader.formData[0].isClientDownLoad=0))}),$scope.$watch("selectedBooking.WRK_SURNAME",function(newValue,oldValue){$scope.selectedBooking&&(uploader.clearQueue(),uploader.formData[0]={},uploader.formData[0].booking_id=$scope.selectedBooking.BOOKING_ID,uploader.formData[0].company_id=$scope.loginInfo.company_id,uploader.formData[0].worker_name=$scope.selectedBooking.WRK_SURNAME,$scope.isAdminUpload||(uploader.formData[0].isClientDownLoad=0))})}}}).directive("rlobFileDownload",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{bookingType:"=",selectedBooking:"=",isAdminGetFiles:"=",filesUpdateFlag:"=",numberOfDocs:"=",dialogStyleClass:"@"},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_download_file_template.html",controller:function($scope,$http,rlobService){function getFilesUpload(){$http({method:"GET",url:"/api/rlob/rl_bookings/admin/get-files-by-booking-id",params:{bookingId:$scope.selectedBooking.BOOKING_ID,isAdminGetFiles:$scope.isAdminGetFiles}}).success(function(data){"success"==data.status&&($scope.files=data.data,$scope.numberOfDocs=data.data.length)})}void 0===$scope.numberOfDocs&&($scope.numberOfDocs=0),$scope.letterType=rlobConstant.letterType,$scope.notificationType=rlobConstant.notificationType,$scope.rlob_add_notification=rlobService.add_notification,$scope.$watch("selectedBooking",function(newValue,oldValue){$scope.selectedBooking&&getFilesUpload()}),$scope.$watch("filesUpdateFlag",function(newValue,oldValue){$scope.selectedBooking&&getFilesUpload()}),$scope.rlob_change_booking_file_role=function(assId,refId,fileId,role){function handle(mapUrl){$scope.showMsgDialog=function(styleClass,header,status,content){$scope.msgHeader=header,$scope.msgStatus=status,$scope.msgContent=content,$(styleClass).modal({show:!0,backdrop:"static"})},$scope.showNotificationPopup=rlobService.showNotificationPopup,$http({method:"POST",url:"/api/rlob/rl_booking_files/change-role-download",data:{fileId:fileId,role:role,siteAddress:siteAddress,mapUrl:mapUrl}}).success(function(data){"success"==data.status&&(1==role&&$scope.rlob_add_notification(assId,refId,$scope.bookingType,$scope.letterType.result,$scope.notificationType.letter,""),getFilesUpload())}).error(function(data){})["finally"](function(){})}var mapUrl=null,siteAddress=null;$scope.selectedBooking&&$scope.selectedBooking.Site_addr?(siteAddress=$scope.selectedBooking.Site_addr,GMaps.geocode({address:siteAddress,callback:function(results,status){"OK"==status?(latlng1=results[0].geometry.location,mapUrl=GMaps.staticMapURL({lat:latlng1.lat(),lng:latlng1.lng(),markers:[{lat:latlng1.lat(),lng:latlng1.lng()}]}),handle(mapUrl)):handle(mapUrl)}})):handle(mapUrl)},$scope.showDialogSetResult=function(){$scope.filesClone=angular.copy($scope.files),$("."+$scope.dialogStyleClass).modal({show:!0,backdrop:"static"})},$scope.setListResultFiles=function(){for(var listResult=[],i=0;i<$scope.filesClone.length;i++){var item=$scope.filesClone[i];1==item.isClientDownLoad&&listResult.push(item)}listResult.length>0?rlobService.rlobBookingFile.setListResultFiles(listResult).then(function(data){"success"==data.status?(rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"send file result success"),$scope.rlob_add_notification(listResult[0].ASS_ID,listResult[0].BOOKING_ID,$scope.bookingType,$scope.letterType.result,$scope.notificationType.letter,""),getFilesUpload()):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Set list result files fail.")},function(err){rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Set list result files fail.")}).then(function(){$("."+$scope.dialogStyleClass).modal("hide")}):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"No files chosen.")},$scope.unselectAllFileResult=function(){rlobService.rlobBookingFile.unselectAllFileResult($scope.selectedBooking.BOOKING_ID).then(function(data){"success"==data.status?(rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Unselect all result files success."),getFilesUpload()):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Unselect all result files fail.")},function(err){rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Unselect all result files fail.")}).then(function(){$("."+$scope.dialogStyleClass).modal("hide")})}}}}).directive("rlobChooseAppointmentCalendarDialog",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{bookingType:"=",usingForDialogFlag:"=",selectedAppointmentCalendar:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_choose_appointment_calendar_template.html",controller:function($scope,$http,$stateParams,Mailto,$cookieStore,$window,rlobService,$timeout,bookingService){$scope.loginInfo=$cookieStore.get("userInfo"),$scope.updateMailtoLink=function(){console.log($cookieStore.get("companyInfo"));var Company_name="[Name of Company]";$cookieStore.get("companyInfo")&&($scope.companyInfo=$cookieStore.get("companyInfo"),Company_name=$scope.companyInfo.Company_name),$scope.mailTemplate={REDiLEGAL:{label:"Please contact us to make an appointment",recepient:"medicolegal@redimed.com.au",options:{subject:Company_name+" - Request Booking",body:" I would like to make a booking for       \n Claim Number:                            \n Injured Workers's Name:                  \n Contact Number:                          \n Address:                                 \n Date of Birth:                           \n Date of Injury:                          \n Description of Injury:                   \n Location of Appointment:                 \n Timeframe for Appointment:               \n\n Please note that this booking is not confirmed in our system until approved by REDIMED."}},Vaccination:{label:"Please contact us to make an appointment",recepient:"",options:{subject:Company_name+" - Request Booking",body:"Please booking for me..."}}},"REDiLEGAL"==$scope.bookingType?$scope.mailtoLink=Mailto.url($scope.mailTemplate.REDiLEGAL.recepient,$scope.mailTemplate.REDiLEGAL.options):"Vaccination"==$scope.bookingType&&($scope.mailtoLink=Mailto.url($scope.mailTemplate.Vaccination.recepient,$scope.mailTemplate.Vaccination.options)),$scope.sendEmail=function(){$window.location.href=$scope.mailtoLink}},$scope.updateMailtoLink(),$scope.selectedFilter={locationSelected:{},rltypeSelected:{},clnSpecialitySelected:{},doctorSelected:{},var1:{}},$scope.selectedFilter.var1="REDiLEGAL"==$scope.bookingType?moment().add(14,"day"):moment();var initPickers=function(){$(".date-picker").rlobdatepicker({rtl:Metronic.isRTL(),autoclose:!0})};initPickers();var datePaginatorChanged=function(date){$scope.selectedFilter.var1=date,$scope.updateAppoinmentsList()};new MyDatePaginator("#rlob-datepaginator-choice",$scope.selectedFilter.var1,datePaginatorChanged),$("#rlob-datepaginator-choice").on("changeMonth",function(){$timeout(function(){$scope.updateAppoinmentsList()},200)}),$scope.getLocationsFilter=function(){$http({method:"GET",url:"/api/rlob/redimedsites/list",params:{bookingType:$scope.bookingType}}).success(function(data){$scope.locationsFilter=data}).error(function(data){console.log("error")})["finally"](function(){})},$scope.getLocationsFilter(),$scope.getRlTypesFilter=function(){$http({method:"GET",url:"/api/rlob/rl_types/list",params:{sourceType:$scope.bookingType}}).success(function(data){$scope.rltypesFilter=data,"Vaccination"==$scope.bookingType&&($scope.selectedFilter.rltypeSelected=data[0],$scope.getSpecialitiesFilter())}).error(function(data){console.log("error")})["finally"](function(){})},$scope.getRlTypesFilter(),$scope.rlTypesFilterChange=function(rlTypeId){$scope.updateAppoinmentsList()},$scope.getSpecialitiesFilter=function(){$http({method:"GET",url:"/api/rlob/cln_specialties/list",params:{sourceType:$scope.bookingType}}).success(function(data){"success"==data.status&&($scope.specialitiesFilter=data.data),"Vaccination"==$scope.bookingType&&($scope.selectedFilter.clnSpecialitySelected=$scope.specialitiesFilter[0],$scope.getDoctorsFilter())}).error(function(data){console.log("error")})["finally"](function(){})},$scope.getSpecialitiesFilter(),$scope.specialitiesChange=function(){$scope.updateAppoinmentsList()},$scope.getDoctorsFilter=function(){$http({method:"GET",url:"/api/rlob/doctors/get-doctors-for-source-type",params:{sourceType:$scope.bookingType}}).success(function(data){"success"==data.status&&($scope.doctorsFilter=data.data),"Vaccination"==$scope.bookingType&&($scope.selectedFilter.doctorSelected=$scope.doctorsFilter[0],$scope.updateAppoinmentsList())}).error(function(data){console.log("error")})["finally"](function(){})},$scope.getDoctorsFilter(),$scope.getListDateAppoinment=function(rlTypeId,specialtyName,doctorId,locationId,var1){for(var listItemDate=angular.element(".rlobdatepicker-days").find("table tbody tr td").not(".new").not(".old"),getMonth=angular.element(".rlobdatepicker-days").find("table thead tr .rlobdatepicker-switch"),i=0;i<listItemDate.length;i++)$scope.startItemDate=moment(angular.element(listItemDate[0]).text()+" "+angular.element(getMonth).text()).format("YYYY/MM/DD"),$scope.endItemDate=moment(angular.element(listItemDate[listItemDate.length-1]).text()+" "+angular.element(getMonth).text()).format("YYYY/MM/DD");rlobService.getListDateAppoinmentCalendar(rlTypeId,specialtyName,doctorId,locationId,$scope.startItemDate,$scope.endItemDate,$scope.bookingType).then(function(data){if("success"==data.status){for(var itemDate={},i=0;i<data.data.length;i++)itemDate[moment(data.data[i].APPOINTMENT_DATE).format("D")]=moment(data.data[i].APPOINTMENT_DATE).format("D");for(var i=0;i<listItemDate.length;i++)angular.element(listItemDate[i]).hasClass("setColorDatePicker")&&angular.element(listItemDate[i]).removeClass("setColorDatePicker"),itemDate[angular.element(listItemDate[i]).text()]&&(angular.element(listItemDate[i]).hasClass("today")||angular.element(listItemDate[i]).hasClass("active")||angular.element(listItemDate[i]).addClass("setColorDatePicker"))}else alert("error get list date")});var startDate=angular.copy(var1).subtract("days",30).format("YYYY/MM/DD"),endDate=angular.copy(var1).add("days",30).format("YYYY/MM/DD");rlobService.getListDateAppoinmentCalendar(rlTypeId,specialtyName,doctorId,locationId,startDate,endDate,$scope.bookingType).then(function(data){if("success"==data.status){for(var listItem=angular.element("#rlob-datepaginator-choice").find("ul li a"),listDate={},i=0;i<data.data.length;i++)listDate[moment(data.data[i].APPOINTMENT_DATE).format("DD-MM-YYYY")]=moment(data.data[i].APPOINTMENT_DATE).format("DD-MM-YYYY");for(var i=0;i<listItem.length;i++)angular.element(listItem[i]).hasClass("setColorDatePicker")&&angular.element(listItem[i]).removeClass("setColorDatePicker"),null!=listItem[i].getAttribute("data-moment")&&listDate[listItem[i].getAttribute("data-moment")]&&(angular.element(listItem[i]).hasClass("dp-item dp-selected")||angular.element(listItem[i]).addClass("setColorDatePicker"),$(".dp-selected").unbind(),$(".dp-selected").click($scope.updateAppoinmentsList))}})},$scope.updateAppoinmentsList=function(){var rlTypeId=$scope.selectedFilter.rltypeSelected&&$scope.selectedFilter.rltypeSelected.RL_TYPE_ID?$scope.selectedFilter.rltypeSelected.RL_TYPE_ID:"%",specialtyName=$scope.selectedFilter.clnSpecialitySelected&&$scope.selectedFilter.clnSpecialitySelected.Specialties_name?$scope.selectedFilter.clnSpecialitySelected.Specialties_name:"%",doctorId=$scope.selectedFilter.doctorSelected&&$scope.selectedFilter.doctorSelected.doctor_id?$scope.selectedFilter.doctorSelected.doctor_id:"%",locationId=$scope.selectedFilter.locationSelected&&$scope.selectedFilter.locationSelected.id?$scope.selectedFilter.locationSelected.id:"%",fromTime=$scope.selectedFilter.var1.format("YYYY/MM/DD");$scope.getListDateAppoinment(rlTypeId,specialtyName,doctorId,locationId,$scope.selectedFilter.var1),$http({method:"GET",url:"/api/rlob/appointment-calendar/get-appointment-calendar",params:{RL_TYPE_ID:rlTypeId,Specialties_name:specialtyName,DOCTOR_ID:doctorId,SITE_ID:locationId,FROM_TIME:fromTime,sourceType:$scope.bookingType}}).success(function(data){for(var temp={TYPE_ITEMS:[]},i=0;i<data.length;i++)temp[data[i].RL_TYPE_ID]||(temp[data[i].RL_TYPE_ID]={DOCTOR_ITEMS:[]},temp.TYPE_ITEMS.push({RL_TYPE_ID:data[i].RL_TYPE_ID,Rl_TYPE_NAME:data[i].Rl_TYPE_NAME})),temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID]||(temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID]={LOCATION_ITEMS:[]},temp[data[i].RL_TYPE_ID].DOCTOR_ITEMS.push({DOCTOR_ID:data[i].DOCTOR_ID,DOCTOR_NAME:data[i].NAME})),temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID]||(temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID]={APPOINTMENT_ITEMS:[]},temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID].LOCATION_ITEMS.push({SITE_ID:data[i].SITE_ID,SITE_NAME:data[i].Site_name})),temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID][data[i].CAL_ID]||(temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID][data[i].CAL_ID]={SPEC_ITEMS:[]},temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID].APPOINTMENT_ITEMS.push({CAL_ID:data[i].CAL_ID,APPOINTMENT_TIME:data[i].appointment_time,FROM_TIME:data[i].FROM_TIME,TO_TIME:data[i].TO_TIME,DOCTOR_ID:data[i].DOCTOR_ID,SITE_ID:data[i].SITE_ID})),temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID][data[i].CAL_ID][data[i].Specialties_id]||(temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID][data[i].CAL_ID][data[i].Specialties_id]={},temp[data[i].RL_TYPE_ID][data[i].DOCTOR_ID][data[i].SITE_ID][data[i].CAL_ID].SPEC_ITEMS.push({Specialties_id:data[i].Specialties_id,Specialties_name:data[i].Specialties_name}));for(var arr=[],i=0;i<temp.TYPE_ITEMS.length;i++){var type_item=temp.TYPE_ITEMS[i];type_item.DOCTOR_ITEMS=[];for(var j=0;j<temp[type_item.RL_TYPE_ID].DOCTOR_ITEMS.length;j++){var doctor_item=temp[type_item.RL_TYPE_ID].DOCTOR_ITEMS[j];doctor_item.SPECS={},doctor_item.SPECS_STR="",doctor_item.LOCATION_ITEMS=[],type_item.DOCTOR_ITEMS.push(doctor_item);for(var q=0;q<temp[type_item.RL_TYPE_ID][doctor_item.DOCTOR_ID].LOCATION_ITEMS.length;q++){var location_item=temp[type_item.RL_TYPE_ID][doctor_item.DOCTOR_ID].LOCATION_ITEMS[q];location_item.APPOINTMENT_ITEMS=[],doctor_item.LOCATION_ITEMS.push(location_item);for(var k=0;k<temp[type_item.RL_TYPE_ID][doctor_item.DOCTOR_ID][location_item.SITE_ID].APPOINTMENT_ITEMS.length;k++){var appointment_item=temp[type_item.RL_TYPE_ID][doctor_item.DOCTOR_ID][location_item.SITE_ID].APPOINTMENT_ITEMS[k];appointment_item.SPEC_ITEMS=[],location_item.APPOINTMENT_ITEMS.push(appointment_item);for(var l=0;l<temp[type_item.RL_TYPE_ID][doctor_item.DOCTOR_ID][location_item.SITE_ID][appointment_item.CAL_ID].SPEC_ITEMS.length;l++){var spec_item=temp[type_item.RL_TYPE_ID][doctor_item.DOCTOR_ID][location_item.SITE_ID][appointment_item.CAL_ID].SPEC_ITEMS[l];doctor_item.SPECS[spec_item.Specialties_name]||(doctor_item.SPECS[spec_item.Specialties_name]=spec_item.Specialties_name,doctor_item.SPECS_STR=doctor_item.SPECS_STR+spec_item.Specialties_name+"; "),appointment_item.SPEC_ITEMS.push(spec_item)}}}}arr.push(type_item)}$scope.appointmentsFilter=arr}).error(function(data){console.log("error")})["finally"](function(){})},$scope.$watch("usingForDialogFlag",function(newValue,oldValue){$scope.usingForDialogFlag&&($scope.updateCalendarPaginator(),$scope.updateAppoinmentsList())}),$scope.updateCalendarPaginator=function(){$scope.selectedFilter.var1=moment();var initPickers=function(){$(".date-picker").rlobdatepicker({rtl:Metronic.isRTL(),autoclose:!0})};initPickers();var datePaginatorChanged=function(date){$scope.selectedFilter.var1=date,$scope.updateAppoinmentsList()};new MyDatePaginator("#rlob-datepaginator-choice",$scope.selectedFilter.var1,datePaginatorChanged)},$scope.updateAppoinmentsList(),$scope.selectAppointmentCalendar=function(appointmentCalendar,RL_TYPE_ID,Specialties_id){appointmentCalendar.RL_TYPE_ID=RL_TYPE_ID,appointmentCalendar.Specialties_id=Specialties_id,$scope.selectedAppointmentCalendar=appointmentCalendar}}}}).directive("rlobChooseAppointmentMobileCalendar",function(){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{bookingType:"=",selectedAppointmentCalendar:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_choose_appointment_calendar_mobile_template.html",controller:"rlobCalendarMobileMasterController"}}).directive("rlobChooseAppointmentMobileCalendarPatient",function(){return{restrict:"E",required:["^ngModel"],scope:{bookingType:"=",selectedAppointmentCalendar:"=",patientInfoCalendar:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_choose_appointment_calendar_mobile_patient_template.html",controller:"rlobCalendarMobileMasterController"}}).directive("rlobBookingReport",function(){return{restrict:"E",transclude:!0,scope:{list:"=",listStatus:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_booking_report_template.html"}}).directive("rlobAdminLocalNotification",function(rlobService){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{actionCenter:"=",groupName:"@"},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_admin_local_notification_template.html",controller:function($scope,rlobService,$cookieStore,$window,Mailto,$q){$scope.listBookingNotification=[],$scope.bookingType=rlobConstant.bookingType.REDiLEGAL.name,$scope.localNotificationType={type1:{header:"Need To Change Status",alias:"passBookingNotChangeStatus"},type2:{header:"Waiting On Paperwork",alias:"upcommingBookingHaveNotDucment"},type3:{header:"Outstanding",alias:"passBookingHaveNotResult"}},$scope.documentStatusDisplay=rlobConstant.documentStatusDisplay,$scope.listPassBookingNotChangeStatus=[],$scope.getPassBookingNotChangeStatus=function(doctorId){rlobService.getPassBookingNotChangeStatus($scope.bookingType,doctorId).then(function(data){"success"==data.status&&($scope.listPassBookingNotChangeStatus=data.data)},function(error){})},$scope.updatePassBookingNotChangeStatus=function(doctorId){rlobService.getPassBookingNotChangeStatus($scope.bookingType,doctorId).then(function(data){"success"==data.status&&($scope.listPassBookingNotChangeStatus=data.data,$scope.listBookingNotification=$scope.listPassBookingNotChangeStatus)},function(error){})},$scope.listUpcommingBookingWaitingPaperwork=[],$scope.getListUpcommingBookingWaitingPaperwork=function(doctorId){rlobService.getListUpcommingBookingWaitingPaperwork($scope.bookingType,doctorId).then(function(data){console.log(data),"success"==data.status&&($scope.listUpcommingBookingWaitingPaperwork=data.data)},function(error){})},$scope.updateListUpcommingBookingWaitingPaperwork=function(doctorId){rlobService.getListUpcommingBookingWaitingPaperwork($scope.bookingType,doctorId).then(function(data){console.log(data),"success"==data.status&&($scope.listUpcommingBookingWaitingPaperwork=data.data,$scope.listBookingNotification=$scope.listUpcommingBookingWaitingPaperwork)},function(error){})},$scope.listBookingOutstandingNotification=[],$scope.getListBookingOutstandingNotification=function(doctorId){rlobService.getListBookingOutstandingNotification($scope.bookingType,doctorId).then(function(data){"success"==data.status&&($scope.listBookingOutstandingNotification=data.data)},function(error){})},$scope.updateListBookingOutstandingNotification=function(doctorId){rlobService.getListBookingOutstandingNotification($scope.bookingType,doctorId).then(function(data){"success"==data.status&&($scope.listBookingOutstandingNotification=data.data,$scope.listBookingNotification=$scope.listBookingOutstandingNotification)},function(error){})},$scope.currentNotificationType=null,$scope.showListBookingNotification=function(notificationType){switch($scope.currentNotificationType=notificationType,notificationType){case $scope.localNotificationType.type1.alias:$scope.listBookingNotification=$scope.listPassBookingNotChangeStatus,$scope.listBookingNotificationHeader=$scope.localNotificationType.type1.header;break;case $scope.localNotificationType.type2.alias:$scope.listBookingNotification=$scope.listUpcommingBookingWaitingPaperwork,$scope.listBookingNotificationHeader=$scope.localNotificationType.type2.header;break;case $scope.localNotificationType.type3.alias:$scope.listBookingNotification=$scope.listBookingOutstandingNotification,$scope.listBookingNotificationHeader=$scope.localNotificationType.type3.header}$("#list_booking_admin_local_notification").modal({
show:!0,backdrop:"static"})},$scope.documentStatusChangedFlag=0,$scope.$watch("documentStatusChangedFlag",function(newValue,oldValue){$scope.documentStatusChangedFlag&&$scope.updateListUpcommingBookingWaitingPaperwork()}),$("#list_booking_admin_local_notification").on("hidden.bs.modal",function(e){$scope.actionCenter[$scope.groupName].runWhenChanged()}),$scope.updateAdminLocalNotification=function(){var doctorId=$scope.doctorInfo?$scope.doctorInfo.doctor_id:null;$scope.getPassBookingNotChangeStatus(doctorId),$scope.getListUpcommingBookingWaitingPaperwork(doctorId),$scope.getListBookingOutstandingNotification(doctorId)},$scope.userInfo=$cookieStore.get("userInfo"),$scope.doctorInfo=null,$scope.getDoctorInfoByUserId=function(){var deferred=$q.defer();return rlobService.getDoctorInfoByUserId($scope.userInfo.id).then(function(data){"success"==data.status&&($scope.doctorInfo=data.data)},function(err){console.log("Khong the lay thong tin doctor")}).then(function(){deferred.resolve()}),deferred.promise},$scope.userInfo.user_type==rlobConstant.userType.doctor?$scope.getDoctorInfoByUserId().then($scope.updateAdminLocalNotification):$scope.updateAdminLocalNotification(),$scope.actionCenter.scheduleList.rlobUpdateAdminLocalNotification=$scope.updateAdminLocalNotification,$scope.setSlimCroll=function(selector){$(selector).slimscroll({})},$scope.$watch("listBookingNotification",function(oldValue,newValue){$scope.selectedBooking&&($scope.selectedBooking=void 0)}),$scope.setSelectedBooking=function(bookingId){rlobService.getBookingById(bookingId).then(function(data){"success"==data.status&&($scope.selectedBooking=data.data)},function(error){})},$scope.isAdminGetFiles=!0,$scope.isAdminUpload=!0,$scope.accordionStatus={status1:!0},$scope.newsletter=function(){$scope.emailContent="{Title} Redimed Medico-Legal Newsletter\n\n{Title} News\nSection for us to easily update\n{Title} Appointment Availability\nSection for us to easily update\nContact Medico-Legal Department at Redimed on (08) 9230 0900 or log to the online booking system link\n",rlobService.listMailUserOnlineBooking().then(function(data){if("success"==data.status){var recepient=data.data,options={subject:"Medico-Legal Newsletter",body:$scope.emailContent,bcc:recepient};console.log(recepient),$scope.mailtoLink=Mailto.url("",options),$window.location.href=$scope.mailtoLink}})}}}}).directive("rlobChangeBookingStatus",function(rlobService){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedBooking:"=",bookingStatusChangedFlag:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_booking_change_status_template.html",controller:function($scope){$scope.bookingStatus=rlobConstant.bookingStatus,$scope.bookingStatusDisplay=rlobConstant.bookingStatusDisplay,$scope.rlob_change_status=function(assId,bookingId,bookingType,status){$scope.selectedBooking.STATUS==$scope.bookingStatus.cancel?rlobService.selectAppointment($scope.selectedBooking.CAL_ID).then(function(data){null===data.data.NOTES?rlobService.undoCancelBooking($scope.selectedBooking.CAL_ID,$scope.selectedBooking.PATIENT_ID).then(function(data){"success"==data.status?rlobService.changeBookingStatus(bookingId,status).then(function(data){if("success"==data.status){$scope.selectedBooking.STATUS=status,$scope.bookingStatusChangedFlag||($scope.bookingStatusChangedFlag=0),$scope.bookingStatusChangedFlag=$scope.bookingStatusChangedFlag+1;var refId=bookingId;rlobService.add_notification(assId,refId,bookingType,rlobConstant.bellType.changeStatus,rlobConstant.notificationType.bell,status),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Change booking status success.")}else rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change booking status fail.")}):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change booking status fail.")}):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change booking status fail.")}):status==$scope.bookingStatus.cancel?rlobService.cancelBooking($scope.selectedBooking.CAL_ID,$scope.selectedBooking.PATIENT_ID).then(function(data){"success"==data.status?rlobService.changeBookingStatus(bookingId,status).then(function(data){if("success"==data.status){$scope.selectedBooking.STATUS=status,$scope.bookingStatusChangedFlag||($scope.bookingStatusChangedFlag=0),$scope.bookingStatusChangedFlag=$scope.bookingStatusChangedFlag+1;var refId=bookingId;rlobService.add_notification(assId,refId,bookingType,rlobConstant.bellType.changeStatus,rlobConstant.notificationType.bell,status),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Change booking status success.")}else rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change booking status fail.")}):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change booking status fail.")}):rlobService.changeBookingStatus(bookingId,status).then(function(data){if("success"==data.status){$scope.selectedBooking.STATUS=status,$scope.bookingStatusChangedFlag||($scope.bookingStatusChangedFlag=0),$scope.bookingStatusChangedFlag=$scope.bookingStatusChangedFlag+1;var refId=bookingId;rlobService.add_notification(assId,refId,bookingType,rlobConstant.bellType.changeStatus,rlobConstant.notificationType.bell,status),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Change booking status success.")}else rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change booking status fail.")})}}}}).directive("rlobChoosePeriod",function(rlobService){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{fromDate:"=",toDate:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_choose_period.html",controller:function($scope){$scope.showDialogChoose=function(){$scope.fromDate&&$scope.toDate&&($scope.FROM_DATE_TEMP=moment($scope.fromDate,"YYYY/MM/DD").toDate(),$scope.TO_DATE_TEMP=moment($scope.toDate,"YYYY/MM/DD").toDate()),$("#choose-period-dialog").modal({show:!0,backdrop:"static"})},$scope.$watch("[FROM_DATE_TEMP,TO_DATE_TEMP]",function(newValue,oldValue){$scope.FROM_DATE_TEMP&&$scope.TO_DATE_TEMP&&($scope.FROM_DATE_TEMP>$scope.TO_DATE_TEMP?($scope.localError=!0,$scope.hadForcused=!0):$scope.localError=!1)},!0),$scope.FROM_DATE_TEMP=null,$scope.TO_DATE_TEMP=null,$scope.localError=!1,$scope.periodDisplay="ALL",$scope.getPeriod=function(){if($scope.hadForcused=!0,!$scope.choosePeriodForm.$invalid&&null!=$scope.FROM_DATE_TEMP&&null!=$scope.TO_DATE_TEMP){if($scope.FROM_DATE_TEMP>$scope.TO_DATE_TEMP)return void($scope.localError=!0);$scope.localError=!1,$scope.fromDate=moment($scope.FROM_DATE_TEMP).format("YYYY/MM/DD"),$scope.toDate=moment($scope.TO_DATE_TEMP).format("YYYY/MM/DD"),$scope.periodDisplay=moment($scope.FROM_DATE_TEMP).format("DD/MM/YY")+"-"+moment($scope.TO_DATE_TEMP).format("DD/MM/YY"),$("#choose-period-dialog").modal("hide")}},$scope.resetDate=function(){$scope.FROM_DATE_TEMP=null,$scope.TO_DATE_TEMP=null,$scope.fromDate="",$scope.toDate="",$scope.localError=!1,$scope.hadForcused=!1,$scope.periodDisplay="ALL"},$scope.reset=function(){$scope.resetDate(),$("#choose-period-dialog").modal("hide")}}}}).directive("rlobChangeDocumentStatus",function(rlobService){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{selectedDocument:"=",documentStatusChangedFlag:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_document_change_status_template.html",controller:function($scope){$scope.documentStatus=rlobConstant.documentStatus,$scope.documentStatusDisplay=rlobConstant.documentStatusDisplay,$scope.rlob_document_change_status=function(bookingId,status){rlobService.changeDocumentStatus(bookingId,status).then(function(data){"success"==data.status&&($scope.selectedDocument.DOCUMENT_STATUS=status,$scope.documentStatusChangedFlag||($scope.documentStatusChangedFlag=0),$scope.documentStatusChangedFlag=$scope.documentStatusChangedFlag+1)})}}}}).directive("rlobSendClientMessage",function(rlobService){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{actionCenter:"=",selectedBooking:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_send_client_message.html",controller:function($scope,rlobService){$scope.showDialogSendBookingMessage=function(){$scope.bookingMessage={},$scope.bookingMessage.assId=$scope.selectedBooking.ASS_ID,$scope.bookingMessage.bookingId=$scope.selectedBooking.BOOKING_ID,$("#rlob-send-client-message").modal({show:!0,backdrop:"static"})},$scope.sendBookingMessage=function(){rlobService.add_notification($scope.bookingMessage.assId,$scope.bookingMessage.bookingId,rlobConstant.bookingType.REDiLEGAL.name,rlobConstant.bellType.message,rlobConstant.notificationType.bell,$scope.bookingMessage.message),$("#rlob-send-client-message").modal("hide")},rlobService.getListBookingMessages().then(function(data){"success"==data.status&&($scope.ListBookingMessages=data.data)}),$scope.check=function(data){$scope.bookingMessage.message=data},$scope.actionCenter.sendClientMessage=function(){$scope.showDialogSendBookingMessage()}}}}).directive("rlobChangeBookingCalendar",function(rlobService){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{actionCenter:"=",groupName:"@",selectedBooking:"=",currentUpdatingItem:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_change_booking_calendar.html",controller:function($scope,rlobService){$scope.bookingType=rlobConstant.bookingType.REDiLEGAL.name,$scope.currentUpdatingItem.bookingId=null,$scope.currentUpdatingItem.calId=null,$scope.currentUpdatingItem.appointmentDateTime=null,$scope.currentUpdatingItem.newAppoimentDateTime=null,$scope.currentUpdatingItem.bookingIdChangeSuccess=null,$scope.currentUpdatingItem.assId=null,$scope.currentUpdatingItem.newCalId=null,$("#rlob_change_booking_calendar_dialog").on("shown.bs.modal",function(e){$scope.usingForDialogFlag||($scope.usingForDialogFlag=0),$scope.usingForDialogFlag=$scope.usingForDialogFlag+1}),$scope.actionCenter[$scope.groupName].showDialog=function(){$("#rlob_change_booking_calendar_dialog").modal({show:!0,backdrop:"static"}),$scope.currentUpdatingItem.bookingId=$scope.selectedBooking.BOOKING_ID,$scope.currentUpdatingItem.calId=$scope.selectedBooking.CAL_ID,$scope.currentUpdatingItem.appointmentDateTime=$scope.selectedBooking.APPOINTMENT_DATE,$scope.currentUpdatingItem.assId=$scope.selectedBooking.ASS_ID},$scope.$watch("selectedAppointmentCalendar",function(oldValue,newValue){if($scope.selectedAppointmentCalendar){var handlePeriodInfo={doctorId:$scope.selectedAppointmentCalendar.DOCTOR_ID,siteId:$scope.selectedAppointmentCalendar.SITE_ID,selectedAppFromTime:$scope.selectedAppointmentCalendar.FROM_TIME,rlTypeId:$scope.selectedAppointmentCalendar.RL_TYPE_ID,oldCalId:$scope.currentUpdatingItem.calId};rlobService.core.checkPeriodTimeToBooking(handlePeriodInfo).then(function(data){"success"==data.status?$scope.changeAppointmentCalendar($scope.selectedAppointmentCalendar.CAL_ID,$scope.selectedAppointmentCalendar.FROM_TIME,$scope.selectedAppointmentCalendar.DOCTOR_ID,$scope.selectedAppointmentCalendar.SITE_ID,$scope.selectedAppointmentCalendar.RL_TYPE_ID,$scope.selectedAppointmentCalendar.Specialties_id):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Not enough time.")},function(err){rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Check fail.")})}}),$scope.changeAppointmentCalendar=function(newCalId,newAppointmentDateTime,doctorId,siteId,rlTypeId,specialityId){var actionInfo={oldCalId:$scope.selectedBooking.CAL_ID,newCalId:newCalId,patientId:$scope.selectedBooking.PATIENT_ID,doctorId:doctorId,siteId:siteId,appointmentDate:newAppointmentDateTime,rlTypeId:rlTypeId,specialtyId:specialityId,bookingId:$scope.currentUpdatingItem.bookingId};rlobService.core.changeBookingCalendar(actionInfo).then(function(data){if("success"==data.status){$("#rlob_change_booking_calendar_dialog").modal("hide"),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Change appointment calendar success."),$scope.currentUpdatingItem.newAppoimentDateTime=newAppointmentDateTime,$scope.currentUpdatingItem.bookingIdChangeSuccess=$scope.currentUpdatingItem.bookingId,$scope.currentUpdatingItem.newCalId=newCalId;var mapUrl=null,siteAddress=$scope.selectedBooking.Site_addr,bookingId=$scope.selectedBooking.BOOKING_ID;GMaps.geocode({address:siteAddress,callback:function(results,status){"OK"==status?(latlng1=results[0].geometry.location,mapUrl=GMaps.staticMapURL({lat:latlng1.lat(),lng:latlng1.lng(),markers:[{lat:latlng1.lat(),lng:latlng1.lng()}]}),handle()):handle()}});var handle=function(){rlobService.core.rescheduleConfirmEmail(bookingId,siteAddress,mapUrl)};$scope.actionCenter[$scope.groupName].runWhenSuccess()}else rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change fail.")},function(err){rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Change fail.")})}}}}).directive("rlobInlineMessage",function(rlobService){return{restrict:"E",transclude:!0,required:["^ngModel"],scope:{message:"@",type:"="},templateUrl:"modules/rediLegalOnlineBooking/directives/rlob_fade_in_out_template.html",controller:function($scope){angular.element(".rlob_fade_in_out").fadeIn(2e3)}}}).directive("showErrors",function($timeout,showErrorsConfig){var getShowSuccess,linkFn;return getShowSuccess=function(options){var showSuccess;return showSuccess=showErrorsConfig.showSuccess,options&&null!=options.showSuccess&&(showSuccess=options.showSuccess),showSuccess},linkFn=function(scope,el,attrs,formCtrl){var blurred,inputEl,inputName,inputNgEl,options,showSuccess,toggleClasses;if(blurred=!1,options=scope.$eval(attrs.showErrors),showSuccess=getShowSuccess(options),inputEl=el[0].querySelector("[name]"),inputNgEl=angular.element(inputEl),inputName=inputNgEl.attr("name"),!inputName)throw"show-errors element has no child input elements with a 'name' attribute";return inputNgEl.bind("blur",function(){return blurred=!0,toggleClasses(formCtrl[inputName].$invalid)}),scope.$watch(function(){return formCtrl[inputName]&&formCtrl[inputName].$invalid},function(invalid){return blurred?toggleClasses(invalid):void 0}),scope.$on("show-errors-check-validity",function(){return toggleClasses(formCtrl[inputName].$invalid)}),scope.$on("show-errors-reset",function(){return $timeout(function(){return el.removeClass("has-error"),el.removeClass("has-success"),blurred=!1},0,!1)}),toggleClasses=function(invalid){return el.toggleClass("has-error",invalid),showSuccess?el.toggleClass("has-success",!invalid):void 0}},{restrict:"A",require:"^form",compile:function(elem,attrs){if(!elem.hasClass("form-group"))throw"show-errors element does not have the 'form-group' class";return linkFn}}}).provider("showErrorsConfig",function(){var _showSuccess;_showSuccess=!1,this.showSuccess=function(showSuccess){return _showSuccess=showSuccess},this.$get=function(){return{showSuccess:_showSuccess}}}),angular.module("app.loggedIn.rlob.services",[]).service("appointmentCalendarService",function(){var selectedAppointmentCalendar={};this.setSelectedAppointmentCalendar=function(appointment){selectedAppointmentCalendar=appointment},this.getSelectedAppointmentCalendar=function(){return selectedAppointmentCalendar}}).service("bookingService",function(){var selectedInfo={},bookingInfo={},bookingList=[],registerInfo={},bookingInfoReuse=null,bookingBehalfInfo=null,currentBookingUpdating=null;this.getRegisterInfo=function(){return registerInfo},this.setRegisterInfo=function(b){registerInfo=JSON.parse(JSON.stringify(b))},this.getSelectedInfo=function(){return selectedInfo},this.getBookingInfo=function(){return bookingInfo},this.setBookingInfo=function(b){bookingInfo=JSON.parse(JSON.stringify(b))},this.getBookingList=function(){return bookingList},this.setBookingInfoReuse=function(booking){bookingInfoReuse=angular.copy(booking)},this.getBookingInfoResuse=function(){return bookingInfoReuse},this.setBookingBehalfInfo=function(b){bookingBehalfInfo=b},this.getBookingBehalfInfo=function(){return bookingBehalfInfo},this.setCurrentBookingUpdating=function(booking){currentBookingUpdating=booking},this.getCurrentBookingUpdating=function(){return currentBookingUpdating}}).factory("timeoutService",function(){var timeoutService={};return timeoutService}).factory("rlobService",function(Restangular,$http,$q){var rlobService={},api=Restangular.all("api");return rlobService.bookingInfoPaperless={id:null},rlobService.getRlTypeList=function(sourceType){var result=api.one("rlob/rl_types/list");return result.get({sourceType:sourceType})},rlobService.getBookingById=function(bookingId){var booking=api.all("rlob/rl_bookings/get-booking-by-id");return booking.post({bookingId:bookingId})},rlobService.changeBookingStatus=function(bookingId,status){var result=api.all("rlob/rl_bookings/lob-change-status");return result.post({bookingId:bookingId,status:status})},rlobService.changeDocumentStatus=function(bookingId,status){var result=api.all("rlob/rl_bookings/lob-change-documents-status");return result.post({bookingId:bookingId,status:status})},rlobService.getCountReportUpcommingBookings=function(bookingType,doctorId,filterInfo){var TotalBookings=api.all("rlob/rl_bookings/admin/report-1/count-report-upcomming-bookings");return TotalBookings.post({bookingType:bookingType,doctorId:doctorId,filterInfo:filterInfo})},rlobService.getItemsOfPageReportUpcommingBookings=function(info){var getItemsBookings=api.all("rlob/rl_bookings/admin/report-1/get-items-of-paging-report-upcomming-bookings");return getItemsBookings.post({currentPage:info.currentPage,itemsPerPage:info.itemsPerPage,bookingType:info.bookingType,doctorId:info.doctorId,filterInfo:info.filterInfo})},rlobService.getCountReportOutstandingBookings=function(bookingType,doctorId,filterInfo){var TotalBookings=api.all("rlob/rl_bookings/admin/report-2/count-report-outstanding-bookings");return TotalBookings.post({bookingType:bookingType,doctorId:doctorId,filterInfo:filterInfo})},rlobService.getItemsOfPageReportOutstandingBookings=function(info){var getItemsBookings=api.all("rlob/rl_bookings/admin/report-2/get-items-of-paging-report-outstanding-bookings");return getItemsBookings.post({currentPage:info.currentPage,itemsPerPage:info.itemsPerPage,bookingType:info.bookingType,doctorId:info.doctorId,filterInfo:info.filterInfo})},rlobService.getListBookingMessages=function(){var getListMessages=api.one("rlob/rl_messages/getListMessages");return getListMessages.get()},rlobService.addNewBookingMessages=function(messageContent){var addNewMessages=api.one("rlob/rl_messages/addNewMessages");return addNewMessages.get({messageContent:messageContent})},rlobService.changeIsenableMessage=function(ID){var changeMessages=api.one("rlob/rl_messages/changeIsenableMessages");return changeMessages.get({ID:ID})},rlobService.updateBookingMessage=function(ID,CONTENTS){var changeMessages=api.one("rlob/rl_messages/updateMessages");return changeMessages.get({ID:ID,CONTENTS:CONTENTS})},rlobService.getListDateAppoinmentCalendar=function(rlTypeId,specialtyName,doctorId,locationId,startDate,endDate,bookingType){var result=api.one("rlob/appointment-calendar/get-list-date-appointment-calendar");return result.get({RL_TYPE_ID:rlTypeId,Specialties_name:specialtyName,DOCTOR_ID:doctorId,SITE_ID:locationId,STARTDATE:startDate,ENDDATE:endDate,sourceType:bookingType})},rlobService.addNewFromAms6=function(info){var addAMS6=api.all("rlob/rl_form_ams6/addNewFormAms6");return addAMS6.post({info:info})},rlobService.updateFromAms6=function(info){var addAMS6=api.all("rlob/rl_form_ams6/rl_form_ams6_update");return addAMS6.post({info:info})},rlobService.getBookingDoctorCompany=function(BOOKING_ID){var getBooking=api.one("rlob/rl_form_ams6/get_booking_doctor_company");return getBooking.get({BOOKING_ID:BOOKING_ID})},rlobService.checkBookingInFormAms6=function(BOOKING_ID){var getMAS6=api.one("rlob/rl_form_ams6/select_Item_rl_form_ams6_bookingid");return getMAS6.get({BOOKING_ID:BOOKING_ID})},rlobService.addNewFromAms5=function(info){var addAMS5=api.all("rlob/rl_form_ams5/addNewFormAms5");return addAMS5.post({info:info})},rlobService.updateFromAms5=function(info){var addAMS5=api.all("rlob/rl_form_ams5/rl_form_ams5_update");return addAMS5.post({info:info})},rlobService.checkBookingInFormAms5=function(BOOKING_ID){var getMAS6=api.one("rlob/rl_form_ams5/select_Item_rl_form_ams5_bookingid");return getMAS6.get({BOOKING_ID:BOOKING_ID})},rlobService.addApptPatient=function(Patient_id,CAL_ID){var Patient=api.all("rlob/cln_appt_patients/add");return Patient.post({Patient_id:Patient_id,CAL_ID:CAL_ID})},rlobService.updatePatientIdBooking=function(BOOKING_ID,PATIENT_ID){var result=api.all("rlob/rl_bookings/update-patient-booking");return result.post({BOOKING_ID:BOOKING_ID,PATIENT_ID:PATIENT_ID})},rlobService.selectAppointment=function(CAL_ID){var Patient=api.one("restful/Appointment/"+CAL_ID);return Patient.get()},rlobService.cancelBooking=function(CAL_ID,PATIENT_ID){var result=api.all("rlob/rl_bookings/cancel-booking");return result.post({CAL_ID:CAL_ID,PATIENT_ID:PATIENT_ID})},rlobService.undoCancelBooking=function(CAL_ID,PATIENT_ID){var result=api.all("rlob/rl_bookings/undo-cancel-booking");return result.post({CAL_ID:CAL_ID,PATIENT_ID:PATIENT_ID})},rlobService.getlistRlType=function(){var result=api.one("rlob/rl_types/get-list-rltype");return result.get()},rlobService.updateRlTypes=function(TYPEID,TYPENAME,SOURCETYPE,ISENABLE){var result=api.all("rlob/rl_types/update-rltype");return result.post({TYPEID:TYPEID,TYPENAME:TYPENAME,SOURCETYPE:SOURCETYPE,ISENABLE:ISENABLE})},rlobService.insertRlTypes=function(TYPENAME,SOURCETYPE){var result=api.all("rlob/rl_types/insert-rltype");return result.post({TYPENAME:TYPENAME,SOURCETYPE:SOURCETYPE})},rlobService.getListSpecialties=function(){var result=api.one("rlob/cln_specialties/get-list-specialties");return result.get()},rlobService.updateSpecialties=function(SPECIALTIESID,SPECIALTIESNAME,SPECIALTIESTYPE,ISENABLE){var result=api.all("rlob/cln_specialties/update-specialties");return result.post({SPECIALTIESID:SPECIALTIESID,SPECIALTIESNAME:SPECIALTIESNAME,SPECIALTIESTYPE:SPECIALTIESTYPE,ISENABLE:ISENABLE})},rlobService.insertSpecialties=function(SPECIALTIESNAME,SPECIALTIESTYPE){var result=api.all("rlob/cln_specialties/edit-specialties");return result.post({SPECIALTIESNAME:SPECIALTIESNAME,SPECIALTIESTYPE:SPECIALTIESTYPE})},rlobService.insertEmergency=function(info){var result=api.all("rlob/sponsor/insert-emergency");return result.post({info:info})},rlobService.insertNonEmergency=function(info){var result=api.all("rlob/sponsor/insert-nonemergency");return result.post({info:info})},rlobService.listMailUserOnlineBooking=function(){var result=api.one("rlob/rl_bookings/admin/list-mail-user-online-booking");return result.get()},rlobService.listDoctorReport=function(){var result=api.one("rlob/rl_bookings/admin/report/list-doctor-report");return result.get()},rlobService.listLocationReport=function(){var result=api.one("rlob/rl_bookings/admin/report/list-location-report");return result.get()},rlobService.ListDoctorMobile=function(date){var result=api.all("rlob/doctors/get-doctors-for-source-type-not-service-mobile");return result.post({date:date})},rlobService.ListLocationMobile=function(date){var result=api.all("rlob/redimedsites/list-location-not-service");return result.post({date:date})},rlobService.getPassBookingNotChangeStatus=function(bookingType,doctorId){var result=api.one("rlob/rl_bookings/admin/get-pass-booking-not-change-status");return result.get({bookingType:bookingType,doctorId:doctorId})},rlobService.getListUpcommingBookingWaitingPaperwork=function(bookingType,doctorId){var result=api.one("rlob/rl_bookings/admin/get-list-upcomming-booking-waiting-paperwork");return result.get({bookingType:bookingType,doctorId:doctorId})},rlobService.getListBookingOutstandingNotification=function(bookingType,doctorId){var result=api.one("rlob/rl_bookings/admin/list-booking-outstanding-notification");return result.get({bookingType:bookingType,doctorId:doctorId})},rlobService.getCountReportArchiveBooking=function(bookingType,doctorId,searchKeys){var result=api.all("rlob/rl_bookings/admin/report-3/get-count-archive-booking");return result.post({bookingType:bookingType,doctorId:doctorId,searchKeys:searchKeys})},rlobService.getItemsOfPageReportArchiveBooking=function(info){var result=api.all("rlob/rl_bookings/admin/report-3/get-items-of-page-archive-booking");return result.post({bookingType:info.bookingType,doctorId:info.doctorId,pageIndex:info.pageIndex,itemsPerPage:info.itemsPerPage,searchKeys:info.searchKeys})},rlobService.getDocumentStatusSummary=function(fromDate,toDate){var result=api.one("rlob/rl_bookings/admin/get-document-status-summary");return result.get({fromDate:fromDate,toDate:toDate})},rlobService.add_notification=function(assId,refId,sourceName,bellType,notificationType,content){var deferred=$q.defer(),promise=deferred.promise;promise.then(function(data){var msg="";notificationType==rlobConstant.notificationType.letter?msg="["+rlobConstant.bookingType[sourceName].display+"] - "+data.Rl_TYPE_NAME+" - "+data.WRK_SURNAME+" - "+(sourceName==rlobConstant.bookingType.REDiLEGAL.name?data.CLAIM_NO:"")+(sourceName==rlobConstant.bookingType.Vaccination.name?data.EMPLOYEE_NUMBER:"")+" - "+moment(data.APPOINTMENT_DATE).format("HH:mm DD/MM/YYYY"):notificationType==rlobConstant.notificationType.bell&&(msg=moment(data.APPOINTMENT_DATE).format("HH:mm DD/MM/YYYY")+" - "+data.Rl_TYPE_NAME+" - "+data.WRK_SURNAME+" - "+data.WRK_OTHERNAMES+" - "+data.CLAIM_NO+" - "+bellType+(void 0!=content&&null!=content&&""!=content?":"+content:"")),$http({method:"POST",url:"/api/rlob/sys_user_notifications/add-notification",data:{assId:assId,refId:refId,sourceName:sourceName,type:notificationType,msg:msg}}).success(function(data){"success"==data.status}).error(function(data){})["finally"](function(){})},function(reason){}),$http({method:"POST",url:"/api/rlob/rl_bookings/get-booking-by-id",data:{bookingId:refId}}).success(function(data){"success"==data.status?deferred.resolve(data.data):alert("data not exist!")}).error(function(data){console.log("error")})["finally"](function(){})},rlobService.showNotificationPopup=function(styleClass,msg,notifyColor){$(styleClass).notify({message:{text:msg},type:notifyColor}).show()},rlobService.checkNotificationExist=function(bookingId,bookingType,appearance){var result=api.one("rlob/sys_user_notifications/check-notification-exist");return result.get({bookingType:bookingType,bookingId:bookingId,appearance:appearance})},rlobService.recreateNotification=function(bookingId,appearance){var result=api.one("rlob/sys_user_notifications/recreate-notification");return result.get({bookingId:bookingId,appearance:appearance})},rlobService.insertNewUser=function(newUser){var result=api.all("rlob/register/insert-new-user");return result.post({newUser:newUser})},rlobService.getUsersList=function(searchInfo){var result=api.all("rlob/register/list-redilegal-users");return result.post({searchInfo:searchInfo})},rlobService.updateRedilegalUserStatus=function(redilegalUserName,status){var result=api.all("rlob/register/update-redilegal-user-status");return result.post({redilegalUserName:redilegalUserName,status:status})},rlobService.updateUserInfo=function(updateInfo){var result=api.all("rlob/register/update-user-info");return result.post({updateInfo:updateInfo})},rlobService.getUpcommingBookingHaveNotDocumentToNotificationCustomer=function(bookingType){var result=api.one("rlob/rl_bookings/get-upcomming-booking-have-not-document-to-notification-customer");return result.get({bookingType:bookingType})},rlobService.getStates=function(nation){var result=api.one("rlob/register/get-states");return result.get({nation:nation})},rlobService.getDoctorInfoByUserId=function(userId){var result=api.one("rlob/doctors/get-doctors-info-by-userid");return result.get({userId:userId})},rlobService.core={getListAppointmentAfterTime:function(doctorId,siteId,selectedAppFromTime){var result=api.all("rlob/core/get-list-appointment-after-time");return result.post({doctorId:doctorId,siteId:siteId,selectedAppFromTime:selectedAppFromTime})},handlePeriodTimeAppointmentCalendar:function(doctorId,siteId,selectedAppFromTime,rlTypeId){var result=api.all("rlob/core/handle-periodtime-appointment-calendar");return result.post({doctorId:doctorId,siteId:siteId,selectedAppFromTime:selectedAppFromTime,rlTypeId:rlTypeId})},saveBookingInfo:function(bookingInfo){var result=api.all("rlob/core/save-booking-info");return result.post({bookingInfo:bookingInfo})},checkPeriodTimeToBooking:function(handlePeriodInfo){var result=api.all("rlob/core/check-period-time-to-booking");return result.post({handlePeriodInfo:handlePeriodInfo})},changeBookingCalendar:function(actionInfo){var result=api.all("rlob/core/handle-change-booking-calendar");return result.post({actionInfo:actionInfo})},rescheduleConfirmEmail:function(bookingId,siteAddress,mapUrl){var result=api.all("rlob/core/reschedule-confirm-email");return result.post({bookingId:bookingId,siteAddress:siteAddress,mapUrl:mapUrl})}},rlobService.rlobBookingFile={setListResultFiles:function(listResult){var result=api.all("rlob/core/set-list-result-files");return result.post({listResult:listResult})},unselectAllFileResult:function(bookingId){var result=api.all("rlob/core/unselect-all-file-result");return result.post({bookingId:bookingId})}},rlobService}),angular.module("app.loggedIn.rlob",["app.loggedIn.rlob.controller","app.loggedIn.rlob.booking.controller","app.loggedIn.rlob.list.controller","app.loggedIn.rlob.patientDetail.controller","app.loggedIn.rlob.adminBookingList.controller","app.loggedIn.rlob.bookingDetail.controller","app.loggedIn.rlob.services","app.loggedIn.rlob.directive","app.loggedIn.rlob.adminBookingReport.controller","app.loggedIn.rlob.adminBookingReport.type3.controller","app.loggedIn.rlob.adminBookingReport.type1.controller","app.loggedIn.rlob.adminBookingReport.type2.controller","app.loggedIn.rlob.adminDocumentStatusSummary.controller","app.loggedIn.rlob.adminBookingMessages.controller","app.loggedIn.rlob.paperless.controller","app.loggedIn.rlob.paperless.ams6.controller","app.loggedIn.rlob.paperless.ams5.controller","app.loggedIn.rlob.rltype.controller","app.loggedIn.rlob.specialties.controller","app.loggedIn.rlob.redilegalUsersListController.controller","app.loggedIn.rlob.bookingBehalf.controller","app.loggedIn.rlob.SpecialistsProfiles.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.rlob",{url:"/rlob",templateUrl:"modules/rediLegalOnlineBooking/views/rlob.html",controller:"rlobController"}).state("loggedIn.rlob.contactus",{url:"/contactus",templateUrl:"modules/rediLegalOnlineBooking/views/contactus.html"}).state("loggedIn.rlob.rlob_booking",{url:"/booking",templateUrl:"modules/rediLegalOnlineBooking/views/booking.html",controller:"rlob_bookingController"}).state("loggedIn.rlob.rlob_patient_detail",{url:"/booking/patient-detail",templateUrl:"/modules/rediLegalOnlineBooking/views/patient-detail.html",controller:"rlob_patientDetailController"}).state("loggedIn.rlob.rlob_admin_booking_list",{url:"/booking/admin-booking-list",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-booking-list.html",controller:"rlob_admin_bookingListController"}).state("loggedIn.rlob.rlob_booking_list",{url:"/booking/list",templateUrl:"/modules/rediLegalOnlineBooking/views/booking-list.html",controller:"rlob_bookingListController"}).state("loggedIn.rlob.rlob_booking_detail",{url:"/booking/booking-detail/:bookingId",templateUrl:"/modules/rediLegalOnlineBooking/views/booking-detail.html",controller:"rlob_bookingDetailController"}).state("loggedIn.rlob.rlob_booking_report",{url:"/booking/report",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-booking-report.html",controller:"rlob_admin_bookingReportController"}).state("loggedIn.rlob.rlob_booking_report.type3",{url:"/type3",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-booking-report-type3.html",controller:"rlob_admin_bookingReport_type3Controller"
}).state("loggedIn.rlob.rlob_booking_report.type1",{url:"/type1",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-booking-report-type1.html",controller:"rlob_admin_bookingReport_type1Controller"}).state("loggedIn.rlob.rlob_booking_report.type2",{url:"/type2",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-booking-report-type2.html",controller:"rlob_admin_bookingReport_type2Controller"}).state("loggedIn.rlob.rlob_document_status_summary",{url:"/booking/document-status-summary",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-document-status-summary.html",controller:"rlob_admin_documentStatusSummaryController"}).state("loggedIn.rlob.rlob_booking_messages",{url:"/booking/messages",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-booking-messages.html",controller:"rlob_admin_bookingMessagesController"}).state("loggedIn.rlob.paperless",{url:"/booking/paperless",templateUrl:"/modules/rediLegalOnlineBooking/views/paperless.html",controller:"rlob_paperlessController"}).state("loggedIn.rlob.paperless.ams6",{url:"/ams6",templateUrl:"/modules/rediLegalOnlineBooking/views/paperless/ams6.html",controller:"rlob_paperless_ams6Controller"}).state("loggedIn.rlob.paperless.ams5",{url:"/ams5",templateUrl:"/modules/rediLegalOnlineBooking/views/paperless/ams5.html",controller:"rlob_paperless_ams5Controller"}).state("loggedIn.rlob.rltype",{url:"/type",templateUrl:"/modules/rediLegalOnlineBooking/views/rltype.html",controller:"rlob_rltypeController"}).state("loggedIn.rlob.specialties",{url:"/specialties",templateUrl:"/modules/rediLegalOnlineBooking/views/specialties.html",controller:"rlob_specialtiesController"}).state("loggedIn.rlob.rlob_admin_redilegalUsersList",{url:"/users-list",templateUrl:"/modules/rediLegalOnlineBooking/views/redilegalUsersList.html",controller:"rlob_admin_redilegalUsersListController"}).state("loggedIn.rlob.rlob_admin_bookingBehalf",{url:"/booking-behalf",templateUrl:"/modules/rediLegalOnlineBooking/views/bookingBehalf.html",controller:"rlob_admin_bookingBehalfController"}).state("loggedIn.rlob.rlob_specialists_profiles",{url:"/specialists-profiles",templateUrl:"/modules/rediLegalOnlineBooking/views/specialists-profiles.html",controller:"rlob_specialists_profilesController"})}),angular.module("app.loggedIn.rlob.adminBookingReport.controller",[]).controller("rlob_admin_bookingReportController",function($scope,$http,$cookieStore,$q,$state,rlobService,bookingService){$scope.currentReport={},$scope.status="Confirmed",$scope.loginInfo=$cookieStore.get("userInfo"),$scope.documentStatusDisplay=rlobConstant.documentStatusDisplay,$scope.actionCenter={},$scope.actionCenter.changeBookingCalendar={},$scope.actionCenter.adminReport={},$scope.actionCenter.scheduleList=$scope.scheduleList,$scope.actionCenter.adminLocalNotification={},$scope.reportType={report1:"report1",report2:"report2",report3:"report3"},$scope.gotoReport=function(reportType){switch(reportType){case $scope.reportType.report1:$state.go("loggedIn.rlob.rlob_booking_report.type1");break;case $scope.reportType.report2:$state.go("loggedIn.rlob.rlob_booking_report.type2");break;case $scope.reportType.report3:$state.go("loggedIn.rlob.rlob_booking_report.type3")}},$scope.selectedBooking=null,$scope.isAdminGetFiles=!0,$scope.accordionStatus={status1:!0},$scope.isAdminUpload=!0,$scope.removeSelectedBooking=function(){$scope.selectedBooking=void 0},$scope.setSelectedBooking=function(bookingId){rlobService.getBookingById(bookingId).then(function(data){"success"==data.status?$scope.selectedBooking=data.data:rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Cannot get booking info!")},function(error){rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Cannot get booking info!")})},$scope.documentStatusChangedFlag=0,$scope.bookingStatusChangedFlag=0,$scope.copyBooking=function(){var bookingBehalfInfo={ASS_SURNAME:$scope.selectedBooking.ASS_SURNAME,ASS_OTHERNAMES:$scope.selectedBooking.ASS_OTHERNAMES,ASS_CONTACT_NO:$scope.selectedBooking.ASS_CONTACT_NO,ASS_EMAIL:$scope.selectedBooking.ASS_EMAIL,ASS_ID:$scope.selectedBooking.ASS_ID,COMPANY_ID:$scope.selectedBooking.COMPANY_ID};bookingService.setBookingBehalfInfo(bookingBehalfInfo),bookingService.setBookingInfoReuse($scope.selectedBooking),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Please choose appointment calendar!"),$state.go("loggedIn.rlob.rlob_booking")},$scope.currentUpdatingItem={bookingId:null,calId:null,appointmentDateTime:null,newAppoimentDateTime:null,bookingIdChangeSuccess:null,assId:null,newCalId:null},$scope.actionCenter.changeBookingCalendar.runWhenSuccess=function(){switch($scope.currentReport.name){case $scope.reportType.report1:$scope.actionCenter.adminReport.reloadReport1();break;case $scope.reportType.report2:$scope.actionCenter.adminReport.reloadReport2();break;case $scope.reportType.report3:$scope.actionCenter.adminReport.reloadReport3()}},$scope.actionCenter.adminLocalNotification.runWhenChanged=function(){switch($scope.currentReport.name){case $scope.reportType.report1:$scope.actionCenter.adminReport.reloadReport1();break;case $scope.reportType.report2:$scope.actionCenter.adminReport.reloadReport2();break;case $scope.reportType.report3:$scope.actionCenter.adminReport.reloadReport3()}}}),angular.module("app.loggedIn.rlob.adminBookingMessages.controller",[]).controller("rlob_admin_bookingMessagesController",function($scope,rlobService,toastr){$scope.editMessageContent="",$scope.setListMessagess=function(){rlobService.getListBookingMessages().then(function(data){"success"==data.status&&($scope.ListBookingMessages=data.data)})},$scope.setListMessagess(),$scope.showModalAddNew=function(){$("#addNewModal").modal("show")},$scope.submitAddNewMessage=function(){rlobService.addNewBookingMessages($scope.messageContent).then(function(data){"success"==data.status?($scope.setListMessagess(),$scope.messageContent="",$("#addNewModal").modal("hide"),toastr.success("Add Message Successfully!","Success")):($("#addNewModal").modal("hide"),toastr.error("Add Message Failed!","Error"))})},$scope.changeIsenableBookingMessage=function(ID){rlobService.changeIsenableMessage(ID).then(function(data){"success"==data.status?($scope.setListMessagess(),toastr.success("Delete Successfully!","Success")):toastr.error("Delete Failed!","Error")})},$scope.editBookingMessage=function(ID,CONTENTS){$scope.editMessageID=ID,$scope.editMessageContent=CONTENTS,$("#editModal").modal("show")},$scope.submitEditMessage=function(){rlobService.updateBookingMessage($scope.editMessageID,$scope.editMessageContent).then(function(data){"success"==data.status?($scope.setListMessagess(),$("#editModal").modal("hide"),toastr.success("Edit Successfully!","Success")):($("#editModal").modal("hide"),toastr.error("Edit Failed!","Error"))})}}),angular.module("app.loggedIn.rlob.adminBookingReport.type3.controller",[]).controller("rlob_admin_bookingReport_type3Controller",function($scope,$http,$cookieStore,$q,rlobService){$scope.removeSelectedBooking(),$scope.currentReport.name="report3",$scope.status="Confirmed",$scope.bookingStatus=rlobConstant.bookingStatus,$scope.documentStatus=rlobConstant.documentStatusFilter,$scope.rlTypeList=[],rlobService.getRlTypeList($scope.bookingType).then(function(data){$scope.rlTypeList=data}),$scope.doctorList=[],rlobService.listDoctorReport().then(function(data){"success"==data.status&&($scope.doctorList=data.data)}),$scope.locationList=[],rlobService.listLocationReport().then(function(data){"success"==data.status&&($scope.locationList=data.data)}),$scope.listArchiveBookings=[],$scope.getReportArchiveBooking=function(doctorId){rlobService.getReportArchiveBooking($scope.bookingType,doctorId).then(function(data){"success"==data.status&&($scope.listArchiveBookings=data.data)},function(error){})},$scope.currentPage=1,$scope.searchKeys={doctor:"",location:"",surname:"",rltype:"",fromAppointmentDate:"",toAppointmentDate:"",bookingStatus:"",documentStatus:""},$scope.initPagingReportArchiveBooking=function(doctorId){$scope.removeSelectedBooking(),$scope.searchKeys.rltype=$scope.rlTypeSelected&&$scope.rlTypeSelected.Rl_TYPE_NAME?$scope.rlTypeSelected.Rl_TYPE_NAME:"",$scope.searchKeys.location=$scope.locationSelected&&$scope.locationSelected.Site_name?$scope.locationSelected.Site_name:"",$scope.searchKeys.doctor=$scope.doctorSelected&&$scope.doctorSelected.NAME?$scope.doctorSelected.NAME:"",rlobService.getCountReportArchiveBooking($scope.bookingType,doctorId,$scope.searchKeys).then(function(data){return $scope.totalItems=data.data.count_archive_bookings,$scope.itemsPerPage=10,$scope.maxSize=10,$scope.currentPage=1,{bookingType:$scope.bookingType,doctorId:doctorId,pageIndex:$scope.currentPage,itemsPerPage:$scope.itemsPerPage,searchKeys:$scope.searchKeys}}).then(rlobService.getItemsOfPageReportArchiveBooking).then(function(data){$scope.listArchiveBookings="success"==data.status?data.data:""})},$scope.pagingHandlerArchiveBooking=function(){$scope.removeSelectedBooking();var info={bookingType:$scope.bookingType,doctorId:$scope.doctorId,pageIndex:$scope.currentPage,itemsPerPage:$scope.itemsPerPage,searchKeys:$scope.searchKeys};rlobService.getCountReportArchiveBooking(info.bookingType,info.doctorId,info.searchKeys).then(function(data){return $scope.totalItems=data.data.count_archive_bookings,console.log($scope.totalItems),info}).then(rlobService.getItemsOfPageReportArchiveBooking).then(function(data){"success"==data.status&&($scope.listArchiveBookings=data.data)})},$scope.$watch("[searchKeys.fromAppointmentDate,searchKeys.toAppointmentDate]",function(newValue,oldValue){$scope.initPagingReportArchiveBooking($scope.doctorId)},!0),$scope.userInfo=$cookieStore.get("userInfo"),$scope.doctorInfo=null,$scope.doctorId=null,$scope.getDoctorInfoByUserId=function(){var deferred=$q.defer();return rlobService.getDoctorInfoByUserId($scope.userInfo.id).then(function(data){"success"==data.status&&($scope.doctorInfo=data.data,$scope.doctorId=$scope.doctorInfo?$scope.doctorInfo.doctor_id:null)},function(err){console.log("Loi lay thong tin doctor")}).then(function(){deferred.resolve()}),deferred.promise},$scope.getDoctorInfoByUserId().then(function(){$scope.initPagingReportArchiveBooking($scope.doctorId)}),$scope.actionCenter.adminReport.reloadReport3=function(){$scope.initPagingReportArchiveBooking()}}),angular.module("app.loggedIn.rlob.adminBookingReport.type1.controller",[]).controller("rlob_admin_bookingReport_type1Controller",function($scope,$http,$cookieStore,$q,rlobService){$scope.removeSelectedBooking(),$scope.currentReport.name="report1",$scope.status="Confirmed",$scope.bookingStatus=rlobConstant.bookingStatus,$scope.documentStatus=rlobConstant.documentStatusFilter,$scope.rlTypeList=[],rlobService.getRlTypeList($scope.bookingType).then(function(data){$scope.rlTypeList=data}),$scope.doctorList=[],rlobService.listDoctorReport().then(function(data){"success"==data.status&&($scope.doctorList=data.data)}),$scope.locationList=[],rlobService.listLocationReport().then(function(data){"success"==data.status&&($scope.locationList=data.data)}),$scope.filterInfo={Doctor:"",Surname:"",Type:"",Location:"",FromAppointmentDate:"",ToAppointmentDate:"",bookingStatus:"",documentStatus:""},$scope.initPagingReportUpcommingBooking=function(){$scope.removeSelectedBooking(),$scope.filterInfo.Type=$scope.rlTypeSelected&&$scope.rlTypeSelected.Rl_TYPE_NAME?$scope.rlTypeSelected.Rl_TYPE_NAME:"",$scope.filterInfo.Location=$scope.locationSelected&&$scope.locationSelected.Site_name?$scope.locationSelected.Site_name:"",$scope.filterInfo.Doctor=$scope.doctorSelected&&$scope.doctorSelected.NAME?$scope.doctorSelected.NAME:"",rlobService.getCountReportUpcommingBookings($scope.bookingType,$scope.doctorId,$scope.filterInfo).then(function(data){return $scope.totalItemsReport1=data.data.count_upcomming_bookings,$scope.itemsPerPageReport1=10,$scope.currentPageReport1=1,$scope.maxSizeReport1=10,{bookingType:$scope.bookingType,doctorId:$scope.doctorId,currentPage:$scope.currentPageReport1,itemsPerPage:$scope.itemsPerPageReport1,filterInfo:$scope.filterInfo}}).then(rlobService.getItemsOfPageReportUpcommingBookings).then(function(data){if("success"==data.status){for(var i=0;i<data.data.length;i++)data.data[i].DOCUMENT_STATUS==$scope.documentStatus.checked.value?data.data[i].style_class="info":data.data[i].DOCUMENT_STATUS==$scope.documentStatus.noDocuments.value&&(data.data[i].style_class="danger");$scope.listUpcommingBookings=data.data}else $scope.listUpcommingBookings=""})},$scope.pagingHandlerUpcommingBooking=function(){var info={bookingType:$scope.bookingType,doctorId:$scope.doctorId,currentPage:$scope.currentPageReport1,itemsPerPage:$scope.itemsPerPageReport1,filterInfo:$scope.filterInfo};rlobService.getCountReportUpcommingBookings(info.bookingType,info.doctorId,$scope.filterInfo).then(function(data){return $scope.totalItemsReport1=data.data.count_upcomming_bookings,info}).then(rlobService.getItemsOfPageReportUpcommingBookings).then(function(data){if("success"==data.status){for(var i=0;i<data.data.length;i++)data.data[i].DOCUMENT_STATUS==$scope.documentStatus.checked.value?data.data[i].style_class="info":data.data[i].DOCUMENT_STATUS==$scope.documentStatus.noDocuments.value&&(data.data[i].style_class="danger");$scope.listUpcommingBookings=data.data}})},$scope.$watch("[filterInfo.FromAppointmentDate,filterInfo.ToAppointmentDate]",function(newValue,oldValue){$scope.initPagingReportUpcommingBooking()},!0),$scope.userInfo=$cookieStore.get("userInfo"),$scope.doctorInfo=null,$scope.doctorId=null,$scope.getDoctorInfoByUserId=function(){var deferred=$q.defer();return rlobService.getDoctorInfoByUserId($scope.userInfo.id).then(function(data){"success"==data.status&&($scope.doctorInfo=data.data,$scope.doctorId=$scope.doctorInfo?$scope.doctorInfo.doctor_id:null)},function(err){console.log("Loi lay thong tin doctor")}).then(function(){deferred.resolve()}),deferred.promise},$scope.getDoctorInfoByUserId().then(function(){$scope.initPagingReportUpcommingBooking()}),$scope.actionCenter.adminReport.reloadReport1=function(){$scope.initPagingReportUpcommingBooking()}}),angular.module("app.loggedIn.rlob.adminBookingReport.type2.controller",[]).controller("rlob_admin_bookingReport_type2Controller",function($scope,$http,$cookieStore,$q,rlobService){$scope.removeSelectedBooking(),$scope.currentReport.name="report2",$scope.status="Confirmed",$scope.bookingStatus=rlobConstant.bookingStatus,$scope.documentStatus=rlobConstant.documentStatusFilter,$scope.rlTypeList=[],rlobService.getRlTypeList($scope.bookingType).then(function(data){$scope.rlTypeList=data}),$scope.doctorList=[],rlobService.listDoctorReport().then(function(data){"success"==data.status&&($scope.doctorList=data.data)}),$scope.locationList=[],rlobService.listLocationReport().then(function(data){"success"==data.status&&($scope.locationList=data.data)}),$scope.filterInfo1={Surname:"",Location:"",Type:"",Doctor:"",employeeNumber:"",FromAppointmentDate:"",ToAppointmentDate:"",bookingStatus:"",documentStatus:""},$scope.initPagingReportOutstandingBooking=function(){$scope.removeSelectedBooking(),$scope.filterInfo1.Type=$scope.rlTypeSelected&&$scope.rlTypeSelected.Rl_TYPE_NAME?$scope.rlTypeSelected.Rl_TYPE_NAME:"",$scope.filterInfo1.Location=$scope.locationSelected&&$scope.locationSelected.Site_name?$scope.locationSelected.Site_name:"",$scope.filterInfo1.Doctor=$scope.doctorSelected&&$scope.doctorSelected.NAME?$scope.doctorSelected.NAME:"",rlobService.getCountReportOutstandingBookings($scope.bookingType,$scope.doctorId,$scope.filterInfo1).then(function(data){return $scope.totalItemsReport2=data.data.count_outstanding_bookings,$scope.itemsPerPageReport2=10,$scope.maxSizeReport2=10,$scope.currentPageReport2=1,{bookingType:$scope.bookingType,doctorId:$scope.doctorId,currentPage:$scope.currentPageReport2,itemsPerPage:$scope.itemsPerPageReport2,filterInfo:$scope.filterInfo1}}).then(rlobService.getItemsOfPageReportOutstandingBookings).then(function(data){$scope.listOutstandingBookings="success"==data.status?data.data:""})},$scope.pagingHandlerOutstandingBooking=function(){var info={bookingType:$scope.bookingType,doctorId:$scope.doctorId,currentPage:$scope.currentPageReport2,itemsPerPage:$scope.itemsPerPageReport2,filterInfo:$scope.filterInfo1};rlobService.getCountReportOutstandingBookings(info.bookingType,info.doctorId,$scope.filterInfo1).then(function(data){return $scope.totalItemsReport2=data.data.count_outstanding_bookings,info}).then(rlobService.getItemsOfPageReportOutstandingBookings).then(function(data){"success"==data.status&&($scope.listOutstandingBookings=data.data)})},$scope.$watch("[filterInfo1.FromAppointmentDate,filterInfo1.ToAppointmentDate]",function(newValue,oldValue){$scope.initPagingReportOutstandingBooking()},!0),$scope.userInfo=$cookieStore.get("userInfo"),$scope.doctorInfo=null,$scope.doctorId=null,$scope.getDoctorInfoByUserId=function(){var deferred=$q.defer();return rlobService.getDoctorInfoByUserId($scope.userInfo.id).then(function(data){"success"==data.status&&($scope.doctorInfo=data.data,$scope.doctorId=$scope.doctorInfo?$scope.doctorInfo.doctor_id:null)},function(err){console.log("Loi lay thong tin doctor")}).then(function(){deferred.resolve()}),deferred.promise},$scope.getDoctorInfoByUserId().then(function(){$scope.initPagingReportOutstandingBooking()}),$scope.actionCenter.adminReport.reloadReport2=function(){$scope.initPagingReportOutstandingBooking()}}),angular.module("app.loggedIn.rlob.patientDetail.controller",[]).controller("rlob_patientDetailController",function($scope,$state,$http,$cookieStore,bookingService,appointmentCalendarService,FileUploader,Mailto,$location,$window,rlobService,PatientModel,ClaimModel){function codeAddress(){var address=selectedInfo.locationSelected.Site_addr;geocoder.geocode({address:address},function(results,status){status==google.maps.GeocoderStatus.OK?(map.setCenter(results[0].geometry.location),new google.maps.Marker({map:map,position:results[0].geometry.location})):alert("Geocode was not successful for the following reason: "+status)})}if($scope.selectedAppointmentCalendar=appointmentCalendarService.getSelectedAppointmentCalendar(),void 0===$scope.selectedAppointmentCalendar.CAL_ID||null===$scope.selectedAppointmentCalendar.CAL_ID||""===$scope.selectedAppointmentCalendar.CAL_ID)return void $state.go("loggedIn.home");var bookingInfoReuse=bookingService.getBookingInfoResuse();$scope.isCopyBooking=0,bookingInfoReuse?($scope.isCopyBooking=1,$scope.newBooking={CLAIM_NO:bookingInfoReuse.CLAIM_NO,WRK_SURNAME:bookingInfoReuse.WRK_SURNAME,WRK_OTHERNAMES:bookingInfoReuse.WRK_OTHERNAMES,WRK_EMAIL:bookingInfoReuse.WRK_EMAIL,WRK_CONTACT_NO:bookingInfoReuse.WRK_CONTACT_NO,DESC_INJURY:bookingInfoReuse.DESC_INJURY,COMPANY_ID:bookingInfoReuse.COMPANY_ID},$scope.WRK_DOB_TEMP=new Date(bookingInfoReuse.WRK_DOB),$scope.WRK_DATE_OF_INJURY_TEMP=new Date(bookingInfoReuse.WRK_DATE_OF_INJURY),bookingService.setBookingInfoReuse(null)):$scope.newBooking={},$scope.selectedAppointmentCalendar=appointmentCalendarService.getSelectedAppointmentCalendar(),angular.copy(PatientModel),angular.copy(ClaimModel),$scope.loginInfo=$cookieStore.get("userInfo");var bookingBehalfInfo=angular.copy(bookingService.getBookingBehalfInfo());null!=bookingBehalfInfo?($scope.newBooking.ASS_ID=bookingBehalfInfo.ASS_ID,$scope.newBooking.ASS_SURNAME=bookingBehalfInfo.ASS_SURNAME,$scope.newBooking.ASS_OTHERNAMES=bookingBehalfInfo.ASS_OTHERNAMES,$scope.newBooking.ASS_CONTACT_NO=bookingBehalfInfo.ASS_CONTACT_NO,$scope.newBooking.ASS_EMAIL=bookingBehalfInfo.ASS_EMAIL,$scope.newBooking.COMPANY_ID=bookingBehalfInfo.COMPANY_ID,bookingService.setBookingBehalfInfo(null)):($scope.newBooking.ASS_ID=$scope.loginInfo.id,$scope.newBooking.ASS_SURNAME=$scope.loginInfo.Booking_Person,$scope.newBooking.ASS_OTHERNAMES=$scope.loginInfo.Booking_Person,$scope.newBooking.ASS_CONTACT_NO=$scope.loginInfo.Contact_number,$scope.newBooking.ASS_EMAIL=$scope.loginInfo.Contact_email),$scope.companyId=null,$scope.companyId=null!==$scope.newBooking.COMPANY_ID&&void 0!==$scope.newBooking.COMPANY_ID?$scope.newBooking.COMPANY_ID:$scope.loginInfo.company_id,$http({method:"POST",url:"/api/company/info",data:{comId:$scope.companyId}}).success(function(data){$scope.companyInfo=data}).error(function(data){$scope.companyInfo={id:null,Company_name:"[Name of Company]"}})["finally"](function(){}),$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){$scope.minDate=$scope.minDate?null:new Date},$scope.toggleMin(),$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.openedDateOfInjury=!1,$scope.opened=!0},$scope.openDateOfInjury=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!1,$scope.openedDateOfInjury=!0},$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.formats=["d/M/yyyy","dd/MM/yyyy","dd/MMMM/yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0],$scope.bookingSuccess=!1,$scope.isSaving=!1;var selectedInfo=bookingService.getSelectedInfo();$scope.booking_detail={};var locationId=$scope.selectedAppointmentCalendar.SITE_ID;$http({method:"POST",url:"/api/redimedsite/info",data:{id:locationId}}).success(function(data){selectedInfo.locationSelected=data,$scope.booking_detail.address=selectedInfo.locationSelected.Site_addr,codeAddress()}).error(function(data){alert("Cannot get location info.")})["finally"](function(){});var doctorid=$scope.selectedAppointmentCalendar.DOCTOR_ID;$http({method:"GET",url:"/api/rlob/doctors/get-doctors-by-id",params:{doctorId:doctorid}}).success(function(data){"success"==data.status&&(selectedInfo.doctorSelected=data.data,$scope.booking_detail.doctor_name=selectedInfo.doctorSelected.NAME)}).error(function(data){alert("Cannot get doctor info.")})["finally"](function(){});var cal_id=$scope.selectedAppointmentCalendar.CAL_ID;$http({method:"GET",url:"/api/rlob/appointment-calendar/get-by-id",params:{calId:cal_id}}).success(function(data){"success"==data.status&&(selectedInfo.selectedAppointment=data.data,$scope.from_time=moment(new Date(selectedInfo.selectedAppointment.FROM_TIME)),$scope.booking_detail.date=$scope.from_time.format("DD/MM/YYYY"),$scope.booking_detail.time=$scope.from_time.format("HH:mm"))}).error(function(data){alert("Cannot get appointment info.")})["finally"](function(){});var rlTypeId=$scope.selectedAppointmentCalendar.RL_TYPE_ID;$http({method:"GET",url:"/api/rlob/rl_types/get-rltype-by-id",params:{rlTypeId:rlTypeId}}).success(function(data){"success"==data.status&&(selectedInfo.rltypeSelected=data.data,$scope.booking_detail.type=selectedInfo.rltypeSelected.Rl_TYPE_NAME)}).error(function(data){alert("Cannot get rlType info.")})["finally"](function(){});var specialityId=$scope.selectedAppointmentCalendar.Specialties_id;$http({method:"GET",url:"/api/rlob/cln_specialties/get-speciality-by-id",params:{specialityId:specialityId}}).success(function(data){"success"==data.status&&(selectedInfo.clnSpecialitySelected=data.data)}).error(function(data){alert("Cannot get specialty of doctor.")})["finally"](function(){});var geocoder,map;geocoder=new google.maps.Geocoder;var latlng=new google.maps.LatLng(-34.397,150.644),mapOptions={zoom:16,center:latlng};map=new google.maps.Map(document.getElementById("map-canvas"),mapOptions),$scope.newBooking.BOOKING_ID=2e4,$http({method:"GET",url:"/api/rlob/rl_bookings/get-new-key"}).success(function(data){$scope.newBooking.BOOKING_ID=data.key}).error(function(data){alert("Cannot create booking key.")})["finally"](function(){}),$scope.scrollTo=function(el,offeset){var pos=el&&el.size()>0?el.offset().top:0;el&&($("body").hasClass("page-header-fixed")&&(pos-=$(".page-header").height()),pos+=offeset?offeset:-1*el.height()),$("html,body").animate({scrollTop:pos},"slow")},$scope.showMsgDialog=function(styleClass,header,status,content){$scope.msgHeader=header,$scope.msgStatus=status,$scope.msgContent=content,$(styleClass).modal({show:!0,backdrop:"static"})},$scope.sendConfirmEmail=function(){var mapUrl=null,siteAddress=selectedInfo.locationSelected.Site_addr;GMaps.geocode({address:siteAddress,callback:function(results,status){"OK"==status?(latlng1=results[0].geometry.location,mapUrl=GMaps.staticMapURL({lat:latlng1.lat(),lng:latlng1.lng(),markers:[{lat:latlng1.lat(),lng:latlng1.lng()}]}),handle()):handle()}});var handle=function(){$http({method:"POST",url:"/api/rlob/rl_bookings/admin/send-comfirm-email",data:{bookingId:$scope.newBooking.BOOKING_ID,siteAddress:siteAddress,mapUrl:mapUrl,isCopyBooking:$scope.isCopyBooking}}).success(function(data){console.log("success"==data.status?"Send email confirm success!":"Send email confirm fail!")}).error(function(data){})["finally"](function(){})}},$scope.isSaving=!1,$scope.save=function(){if(!$scope.companyInfo.id)return void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Create booking fail because the company is unknown!");if(void 0==selectedInfo.rltypeSelected.RL_TYPE_ID||null==selectedInfo.rltypeSelected.RL_TYPE_ID||""==selectedInfo.rltypeSelected.RL_TYPE_ID)return void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Create booking fail because the type of injury is unknown!");if(void 0==selectedInfo.clnSpecialitySelected.Specialties_id||null==selectedInfo.clnSpecialitySelected.Specialties_id||""==selectedInfo.clnSpecialitySelected.Specialties_id)return void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Create booking fail because the doctor's specialties is unknown!");if(void 0==selectedInfo.doctorSelected.doctor_id||null==selectedInfo.doctorSelected.doctor_id||""==selectedInfo.doctorSelected.doctor_id)return void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Create booking fail because the doctor's name is unknown!");if(void 0==selectedInfo.locationSelected.id||null==selectedInfo.locationSelected.id||""==selectedInfo.locationSelected.id)return void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Create booking fail because the site is unknown!");if(void 0==cal_id||null==cal_id||""==cal_id)return void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Create booking fail because the appointment calendar is not selected!");if($scope.$broadcast("show-errors-check-validity"),$scope.bookingForm.$invalid)return $scope.hadForcused=!0,$(".errorSummary").show(),void $scope.scrollTo($(".errorSummary"),-200);$scope.mailBodyData={requestBy:$scope.loginInfo.FIRST_NAME?$scope.loginInfo.FIRST_NAME:"",company:$scope.companyInfo.Company_name?$scope.companyInfo.Company_name:"",time:$scope.from_time.format("HH:mm"),date:$scope.from_time.format("DD/MM/YYYY"),typeOfAppointment:$scope.bookingTypeObj.display,doctor:selectedInfo.doctorSelected.NAME?selectedInfo.doctorSelected.NAME:"",address:selectedInfo.locationSelected.Site_addr?selectedInfo.locationSelected.Site_addr:"",isContactPatient:$scope.newBooking.ISCONTACTPATIENT?$scope.newBooking.ISCONTACTPATIENT:"",notes:$scope.newBooking.NOTES?$scope.newBooking.NOTES:"",claimNumber:$scope.newBooking.CLAIM_NO?$scope.newBooking.CLAIM_NO:"",wrkName:$scope.newBooking.WRK_SURNAME?$scope.newBooking.WRK_SURNAME:"",wrkDOB:moment($scope.WRK_DOB_TEMP).format("DD/MM/YYYY"),wrkContactNo:$scope.newBooking.WRK_CONTACT_NO?$scope.newBooking.WRK_CONTACT_NO:"",injuryDesc:$scope.newBooking.DESC_INJURY?$scope.newBooking.DESC_INJURY:""},$scope.emailContent="The below appointment has been requested by "+$scope.mailBodyData.requestBy+" from "+$scope.mailBodyData.company+".\n\nAppointment Details:\n\nDate: "+$scope.mailBodyData.date+"\nTime: "+$scope.mailBodyData.time+"\nType of appointment: "+selectedInfo.rltypeSelected.Rl_TYPE_NAME+"\nDoctor: "+$scope.mailBodyData.doctor+"\nAddress: "+$scope.mailBodyData.address+"\nNotes: "+$scope.mailBodyData.notes+" \n\nPatient information:\n\nClaim number: "+$scope.mailBodyData.claimNumber+"\nName: "+$scope.mailBodyData.wrkName+"\nDate of Birth: "+$scope.mailBodyData.wrkDOB+"\nContact number: "+$scope.mailBodyData.wrkContactNo+" \nInjury description: "+$scope.mailBodyData.injuryDesc+"\n";var recepient="medicolegal@redimed.com.au",options={subject:"Medico-Legal Paperwork "+$scope.mailBodyData.wrkName,body:$scope.emailContent};$scope.mailtoLink=Mailto.url(recepient,options),$scope.newBooking.BOOKING_DATE=moment().format("YYYY-MM-DD HH:mm"),$scope.newBooking.APPOINTMENT_DATE=$scope.from_time.format("YYYY-MM-DD HH:mm"),$scope.newBooking.COMPANY_ID=$scope.companyInfo.id,$scope.newBooking.RL_TYPE_ID=selectedInfo.rltypeSelected.RL_TYPE_ID,$scope.newBooking.SPECIALITY_ID=selectedInfo.clnSpecialitySelected.Specialties_id,$scope.newBooking.DOCTOR_ID=selectedInfo.doctorSelected.doctor_id,$scope.newBooking.SITE_ID=selectedInfo.locationSelected.id,$scope.newBooking.CAL_ID=cal_id,$scope.newBooking.refered_date_string=$scope.from_time.format("ddd DD/MM/YYYY HH-mm")+" "+selectedInfo.locationSelected.Site_name,$scope.newBooking.STATUS="Confirmed",$scope.newBooking.BOOKING_TYPE=$scope.bookingType,void 0!=$scope.WRK_DOB_TEMP&&null!=$scope.WRK_DOB_TEMP&&($scope.newBooking.WRK_DOB=moment($scope.WRK_DOB_TEMP).format("YYYY-MM-DD")),void 0!=$scope.WRK_DATE_OF_INJURY_TEMP&&null!=$scope.WRK_DATE_OF_INJURY_TEMP&&($scope.newBooking.WRK_DATE_OF_INJURY=moment($scope.WRK_DATE_OF_INJURY_TEMP).format("YYYY-MM-DD")),$scope.showDialogAddSuccess=function(){$("#lob-client-add-booking-success").modal({show:!0,backdrop:"static"})},$scope.uploadDocument=function(){$("#lob-client-add-booking-success").modal("hide"),$("#lob-client-send-document-dialog").modal("hide"),$("#lob-client-upload-dialog").modal({show:!0,backdrop:"static"})},$scope.sendEmail=function(){$window.location.href=$scope.mailtoLink,$("#lob-client-add-booking-success").modal("hide"),$("#lob-client-send-document-dialog").modal("hide")},$scope.showDialogSendDocument=function(){$("#lob-client-send-document-dialog").modal({show:!0,backdrop:"static"})},rlobService.core.saveBookingInfo($scope.newBooking).then(function(data){if("success"==data.status){$scope.scrollTo($(".bookingSuccess"),-200),bookingService.setBookingInfo($scope.newBooking),$scope.isSaving=!0,$scope.bookingSuccess=!0,$scope.showDialogAddSuccess(),$scope.getAppointmentCalendarUpcoming(),$scope.sendConfirmEmail();for(var i=0;i<data.data.length;i++)JSON.stringify(data.data[i])}else{var error=JSON.stringify(data.error);$scope.showMsgDialog(".patient-detail-msg-dialog","Fail","fail","Create booking fail. "+error)}},function(err){$scope.showMsgDialog(".patient-detail-msg-dialog","Fail","fail","Create booking fail. Server error!")})},$scope.filesUpdateFlag=0,$scope.$watch("filesUpdateFlag",function(newValue,oldValue){$scope.filesUpdateFlag&&$scope.filesUpdateFlag>0&&rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Upload documents success!")})}),angular.module("app.loggedIn.rlob.adminBookingList.controller",[]).controller("rlob_admin_bookingListController",function($scope,$http,$state,$window,$q,$stateParams,FileUploader,$cookieStore,$interval,rlobService,Mailto,bookingService){$scope.haveNodeFile=!1,$scope.isAdminUpload=!0,$scope.isAdminGetFiles=!0,$scope.accordionStatus={status1:!0},$scope.documentStatus=rlobConstant.documentStatusFilter,$scope.documentStatusDisplay=rlobConstant.documentStatusDisplay,$scope.actionCenter={},$scope.actionCenter.changeBookingCalendar={},$scope.actionCenter.scheduleList=$scope.scheduleList,$scope.actionCenter.adminLocalNotification={},$scope.newAppointmentPositionFlag=!1,$scope.scrollTo=function(el,offeset){var pos=el&&el.size()>0?el.offset().top:0;el&&($("body").hasClass("page-header-fixed")&&(pos-=$(".page-header").height()),pos+=offeset?offeset:-1*el.height()),$("html,body").animate({scrollTop:pos},"slow")},$scope.status=!1,$scope.sourceName=$scope.bookingType,$scope.notificationType=rlobConstant.notificationType,$scope.bellType=rlobConstant.bellType,$scope.mydata=[],$scope.parseBookingList=function(data){$scope.mydata=[];var dateMaker={};dateMaker.DATE_ITEMS=[];
for(var i=0;i<data.length;i++){var item=data[i];if(dateMaker[item.APPOINTMENT_DATE]||(dateMaker[item.APPOINTMENT_DATE]={DOCTOR_ITEMS:[]},dateMaker.DATE_ITEMS.push({APPOINTMENT_DATETIME:item.APPOINTMENT_DATETIME,APPOINTMENT_DATE:item.APPOINTMENT_DATE,DISPLAY:"["+item.APPOINTMENT_DATE+"]",style_class:"lob_admin_date_node"})),dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID]||(dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID]={BOOKING_ITEMS:[]},dateMaker[item.APPOINTMENT_DATE].DOCTOR_ITEMS.push({DOCTOR_ID:item.DOCTOR_ID,NAME:item.NAME,DISPLAY:"["+item.NAME+"]",style_class:"lob_admin_doctor_node"})),!dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID][item.BOOKING_ID]){dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID][item.BOOKING_ID]={BOOKING_FILE_ITEMS:[]};var styleClass="";item.DOCUMENT_STATUS==$scope.documentStatus.checked.value?styleClass="rlob_document_status_checked":item.DOCUMENT_STATUS==$scope.documentStatus.noDocuments.value&&(styleClass="rlob_document_status_no_document"),dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID].BOOKING_ITEMS.push({APPOINTMENT_TIME:item.APPOINTMENT_TIME,APPOINTMENT_DATETIME:item.APPOINTMENT_DATETIME,CAL_ID:item.CAL_ID,ASS_ID:item.ASS_ID,BOOKING_ID:item.BOOKING_ID,Company_name:item.Company_name,WRK_SURNAME:item.WRK_SURNAME,STATUS:item.STATUS,DISPLAY:"["+item.APPOINTMENT_TIME+" - "+item.Site_name+"] - ["+item.WRK_OTHERNAMES+" "+item.WRK_SURNAME+"] - ["+item.ASS_OTHERNAMES+" - "+item.Company_name+"]",DISPLAY1:"- Site: "+item.Site_name,DISPLAY2:"- Patient: "+item.WRK_SURNAME,DISPLAY3:"- Company: "+item.Company_name,DOCUMENT_STATUS:item.DOCUMENT_STATUS,style_class:styleClass})}$scope.haveNodeFile&&(null==item.FILE_ID||dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID][item.BOOKING_ID][item.FILE_ID]||(dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID][item.BOOKING_ID][item.FILE_ID]={},dateMaker[item.APPOINTMENT_DATE][item.DOCTOR_ID][item.BOOKING_ID].BOOKING_FILE_ITEMS.push({PARENT_ID:item.BOOKING_ID,ASS_ID:item.ASS_ID,FILE_ID:item.FILE_ID,FILE_NAME:item.FILE_NAME,FILE_PATH:item.FILE_PATH,isClientDownLoad:item.isClientDownLoad,DISPLAY:item.FILE_NAME,style_class:"lob_admin_booking_file_node"})))}for(var i=0;i<dateMaker.DATE_ITEMS.length;i++){var date_item=dateMaker.DATE_ITEMS[i],node={APPOINTMENT_DATETIME:date_item.APPOINTMENT_DATETIME,APPOINTMENT_DATE:date_item.APPOINTMENT_DATE,DISPLAY:date_item.DISPLAY,nodes:[],style_class:"lob_admin_date_node",IS_DATE_ITEM:"1"};node.nodes=dateMaker[date_item.APPOINTMENT_DATE].DOCTOR_ITEMS;for(var j=0;j<dateMaker[date_item.APPOINTMENT_DATE].DOCTOR_ITEMS.length;j++){var doctor_item=dateMaker[date_item.APPOINTMENT_DATE].DOCTOR_ITEMS[j];if(node.nodes[j].nodes=[],node.nodes[j].nodes=dateMaker[date_item.APPOINTMENT_DATE][doctor_item.DOCTOR_ID].BOOKING_ITEMS,$scope.haveNodeFile)for(var k=0;k<dateMaker[date_item.APPOINTMENT_DATE][doctor_item.DOCTOR_ID].BOOKING_ITEMS.length;k++){var booking_item=dateMaker[date_item.APPOINTMENT_DATE][doctor_item.DOCTOR_ID].BOOKING_ITEMS[k];node.nodes[j].nodes[k].nodes=[],node.nodes[j].nodes[k].nodes=dateMaker[date_item.APPOINTMENT_DATE][doctor_item.DOCTOR_ID][booking_item.BOOKING_ID].BOOKING_FILE_ITEMS}}$scope.mydata.push(node)}$scope.newAppointmentPositionFlag&&$scope.goToNewAppoinmentPosition()},$scope.lobAdminSearch={fromDateKey:moment().toDate(),toDateKey:moment().add(30,"d").toDate(),doctorKey:"",workerKey:"",documentStatusKey:{}},$scope.filterBooking=function(){var fromDate=moment($scope.lobAdminSearch.fromDateKey),toDate=moment($scope.lobAdminSearch.toDateKey),doctorKey=$scope.lobAdminSearch.doctorKey,workerKey=$scope.lobAdminSearch.workerKey,documentStatusKey=$scope.lobAdminSearch.documentStatusKey.value;$http({method:"GET",url:"/api/rlob/rl_bookings/admin/filter-booking",params:{fromDateKey:fromDate.format("YYYY-MM-DD"),toDateKey:toDate.format("YYYY-MM-DD"),doctorKey:doctorKey,workerKey:workerKey,documentStatusKey:documentStatusKey,doctorId:$scope.doctorInfo?$scope.doctorInfo.doctor_id:null,bookingType:$scope.bookingType}}).success(function(data){data.length<=0&&($scope.showDetailPanel=!1),$scope.parseBookingList(data)}).error(function(data){console.log("error")})["finally"](function(){})},$scope.remove=function(scope){scope.remove()},$scope.toggle=function(scope){scope.toggle()},$scope.moveLastToTheBegginig=function(){var a=$scope.data.pop();$scope.data.splice(0,0,a)},$scope.newSubItem=function(scope){var nodeData=scope.$modelValue;nodeData.nodes.push({FILE_ID:item.FILE_ID,FILE_NAME:item.FILE_NAME,FILE_PATH:item.FILE_PATH,isClientDownLoad:item.isClientDownLoad,DISPLAY:item.FILE_NAME,style_class:"lob_admin_booking_file_node"})},$scope.collapseAll=function(){$scope.$broadcast("collapseAll")},$scope.expandAll=function(){$scope.$broadcast("expandAll")},$scope.message="Right click triggered",$scope.panels=[{name:"Panel 1"},{name:"Panel 2"},{name:"Panel 3"}],$scope.addPanel=function(){$scope.panels.push({name:"Panel "+($scope.panels.length+1)})},$scope.onRightClick=function(msg){console.log(msg)},$scope.recreatePanels=function(){$scope.panels=angular.copy($scope.panels),console.log($scope.panels)},$scope.getTimeString=function(datetime){var d=moment(new Date(datetime));return d.format("HH-mm")},$scope.getShortDateString=function(datetime){var d=moment(new Date(datetime));return d.format("DD/MM/YYYY")},$scope.showBookingDetailDialog=function(bookingId){$http({method:"POST",url:"/api/rlob/rl_bookings/get-booking-by-id",data:{bookingId:bookingId}}).success(function(data){"success"==data.status?($scope.selectedBooking=data.data,$("#view-detail-booking-dialog").modal({show:!0,backdrop:"static"})):alert("data not exist!")}).error(function(data){console.log("error")})["finally"](function(){})},$scope.lob_download_file=function(fileId){$window.location.href="/api/download/lob/document/"+fileId},$scope.show_lob_upload_file_dialog=function(bookingId,scope){$http({method:"POST",url:"/api/rlob/rl_bookings/get-booking-by-id",data:{bookingId:bookingId}}).success(function(data){"success"==data.status?($scope.selectedBooking=data.data,$("#lob-upload-file-dialog").modal({show:!0,backdrop:"static"}),$scope.currentNode=scope.$modelValue):alert("data not exist!")}).error(function(data){console.log("error")})["finally"](function(){})},$scope.showMsgDialog=function(styleClass,header,status,content){$scope.msgHeader=header,$scope.msgStatus=status,$scope.msgContent=content,$(styleClass).modal({show:!0,backdrop:"static"})},$scope.rlob_add_notification=$scope.add_notification,$scope.bookingStatus=rlobConstant.bookingStatus,$scope.lob_change_status=function(assId,bookingId,status,scope,calID,patientID){rlobService.getBookingById(bookingId).then(function(data){return"success"==data.status?(data.data.DOCUMENT_STATUS==$scope.documentStatus.checked.value?data.data.style_class="rlob_document_status_checked":data.data.DOCUMENT_STATUS==$scope.documentStatus.noDocuments.value&&(data.data.style_class="rlob_document_status_no_document"),$scope.selectedBooking=data.data,{status:"success"}):{status:"fail"}}).then(function(data){"success"==data.status&&(console.log($scope.selectedBooking),$scope.selectedBooking.STATUS==$scope.bookingStatus.cancel?rlobService.selectAppointment($scope.selectedBooking.CAL_ID).then(function(data){null===data.data.NOTES?($scope.selectedBooking.WRK_OTHERNAMES+" "+$scope.selectedBooking.WRK_SURNAME,rlobService.undoCancelBooking(calID,patientID).then(function(data){"success"==data.status?rlobService.changeBookingStatus(bookingId,status).then(function(data){if("success"==data.status){scope.$modelValue.STATUS=status,$scope.selectedBooking.STATUS=status;var refId=bookingId;$scope.rlob_add_notification(assId,refId,$scope.sourceName,$scope.bellType.changeStatus,$scope.notificationType.bell,status),angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","success","Changing status to ["+status+"] success!")}else angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","fail","Changing status to ["+status+"] fail!")}):(angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","fail","Changing status to ["+status+"] fail!"))})):(angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","fail","Changing status to ["+status+"] fail!"))}):status==$scope.bookingStatus.cancel?rlobService.cancelBooking(calID,patientID).then(function(data){"success"==data.status?rlobService.changeBookingStatus(bookingId,status).then(function(data){if("success"==data.status){scope.$modelValue.STATUS=status,$scope.selectedBooking.STATUS=status;var refId=bookingId;$scope.rlob_add_notification(assId,refId,$scope.sourceName,$scope.bellType.changeStatus,$scope.notificationType.bell,status),angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","success","Changing status to ["+status+"] success!")}else angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","fail","Changing status to ["+status+"] fail!")}):(angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","fail","Changing status to ["+status+"] fail!"))}):rlobService.changeBookingStatus(bookingId,status).then(function(data){if("success"==data.status){scope.$modelValue.STATUS=status,$scope.selectedBooking.STATUS=status;var refId=bookingId;$scope.rlob_add_notification(assId,refId,$scope.sourceName,$scope.bellType.changeStatus,$scope.notificationType.bell,status),angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","success","Changing status to ["+status+"] success!")}else angular.element("#bookingstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Booking Status","fail","Changing status to ["+status+"] fail!")}))})},$scope.lob_change_booking_file_role=function(assId,fileId,role,scope){$http({method:"POST",url:"/api/rlob/rl_booking_files/change-role-download",data:{fileId:fileId,role:role}}).success(function(data){if("success"==data.status){scope.$modelValue.isClientDownLoad=role,$scope.showMsgDialog(".lob-msg-dialog","Authority downloads","success","Changing success! Customer"+(1==role?" can ":" cannot ")+"download this file");var refId=scope.$modelValue.PARENT_ID;1==role&&$scope.rlob_add_notification(assId,refId,$scope.sourceName,$scope.bellType.result,$scope.notificationType.letter,"")}else $scope.showMsgDialog(".lob-msg-dialog","Authority downloads","fail","Changing fail!")}).error(function(data){$scope.showMsgDialog(".lob-msg-dialog","Authority downloads","fail","Changing fail!")})["finally"](function(){})},$scope.currentUpdatingItem={bookingId:null,calId:null,appointmentDateTime:null,newAppoimentDateTime:null,bookingIdChangeSuccess:null,assId:null,newCalId:null},$scope.actionCenter.changeBookingCalendar.runWhenSuccess=function(){$scope.currentUpdatingItem.newAppoimentDateTime>=$scope.currentUpdatingItem.appointmentDateTime?($scope.lobAdminSearch.fromDateKey=moment(new Date($scope.currentUpdatingItem.appointmentDateTime)),$scope.lobAdminSearch.toDateKey=moment(new Date($scope.currentUpdatingItem.newAppoimentDateTime))):($scope.lobAdminSearch.fromDateKey=moment(new Date($scope.currentUpdatingItem.newAppoimentDateTime)),$scope.lobAdminSearch.toDateKey=moment(new Date($scope.currentUpdatingItem.appointmentDateTime))),$http({method:"GET",url:"/api/rlob/appointment-calendar/check-same-doctor",params:{calId1:$scope.currentUpdatingItem.calId,calId2:$scope.currentUpdatingItem.newCalId}}).success(function(data){"success"==data.status&&(data.data>1&&($scope.lobAdminSearch.doctorKey=null),$scope.rlob_add_notification($scope.currentUpdatingItem.assId,$scope.currentUpdatingItem.bookingId,$scope.sourceName,$scope.bellType.changeCalendar,$scope.notificationType.bell,""))}).error(function(data){console.log("error")})["finally"](function(){$scope.newAppointmentPositionFlag=!0,$scope.filterBooking()})},$scope.goToNewAppoinmentPosition=function(){$scope.currentUpdatingItem.newAppoimentDateTime>=$scope.currentUpdatingItem.appointmentDateTime?$scope.scrollTo($("#rlob_admin_begin_page"),-200):$scope.scrollTo($("#rlob_admin_end_page"),100),$scope.newAppointmentPositionFlag=!1},$scope.newPosition="new-position",$scope.selectedFilter={locationSelected:{},rltypeSelected:{},clnSpecialitySelected:{},doctorSelected:{},var1:{}},$scope.showDetailPanel=!1,$scope.currentNodeBooking={},$scope.getBookingDetailWhenClick=function(bookingId,scope){$scope.currentNodeBooking=scope,$scope.showDetailPanel=!0,$http({method:"POST",url:"/api/rlob/rl_bookings/get-booking-by-id",data:{bookingId:bookingId}}).success(function(data){"success"==data.status?($scope.selectedBooking=data.data,$scope.scrollTo($(".detailPanel"),-200)):alert("data not exist!")}).error(function(data){console.log("error")})["finally"](function(){})},$scope.getBookingDetailWhenCursor=function(bookingId,scope){$scope.currentNodeBooking=scope,bookingId&&rlobService.getBookingById(bookingId).then(function(data){"success"==data.status&&(data.data.DOCUMENT_STATUS==$scope.documentStatus.checked.value?data.data.style_class="rlob_document_status_checked":data.data.DOCUMENT_STATUS==$scope.documentStatus.noDocuments.value&&(data.data.style_class="rlob_document_status_no_document"),$scope.showDetailPanel=!0,$scope.selectedBooking=data.data)})},$scope.bookingstatusfadeIn=function(){angular.element("#bookingstatus").fadeIn()},$scope.bookingstatusfadeOut=function(){angular.element("#bookingstatus").fadeOut()},$scope.documentstatusfadeOut=function(){angular.element("#documentstatus").fadeOut()},$scope.documentstatusfadeIn=function(){angular.element("#documentstatus").fadeIn()},$scope.rlob_document_change_status=function(bookingId,status){rlobService.changeDocumentStatus(bookingId,status).then(function(data){if("success"==data.status){var styleClass="";status==$scope.documentStatus.checked.value?styleClass="rlob_document_status_checked":status==$scope.documentStatus.noDocuments.value&&(styleClass="rlob_document_status_no_document"),$scope.selectedBooking.DOCUMENT_STATUS=status,$scope.selectedBooking.style_class=styleClass,angular.element("#documentstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Documents Status","success","Changing status to ["+status+"] success!"),$scope.currentNodeBooking.$modelValue.style_class=styleClass}else angular.element("#documentstatus").fadeOut(),$scope.showMsgDialog(".lob-msg-dialog","Change Documents Status","fail","Changing status to ["+status+"] fail!")})},$scope.$watch("selectedBooking.BOOKING_ID",function(newValue,oldValue){newValue!==oldValue&&(angular.element("#documentstatus").fadeOut(),angular.element("#bookingstatus").fadeOut())}),$scope.setBookingIdInPaperless=function(BookingID){return null!=BookingID&&""!=BookingID?(rlobService.bookingInfoPaperless.id=BookingID,void $state.go("loggedIn.rlob.paperless")):void alert("Khong ton tai Booking ID")},$scope.copyBooking=function(){var bookingBehalfInfo={ASS_SURNAME:$scope.selectedBooking.ASS_SURNAME,ASS_OTHERNAMES:$scope.selectedBooking.ASS_OTHERNAMES,ASS_CONTACT_NO:$scope.selectedBooking.ASS_CONTACT_NO,ASS_EMAIL:$scope.selectedBooking.ASS_EMAIL,ASS_ID:$scope.selectedBooking.ASS_ID,COMPANY_ID:$scope.selectedBooking.COMPANY_ID};bookingService.setBookingBehalfInfo(bookingBehalfInfo),bookingService.setBookingInfoReuse($scope.selectedBooking),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Please choose appointment calendar!"),$state.go("loggedIn.rlob.rlob_booking")},$scope.actionCenter.adminLocalNotification.runWhenChanged=function(){$scope.filterBooking()},$scope.userInfo=$cookieStore.get("userInfo"),$scope.doctorInfo=null,$scope.getDoctorInfoByUserId=function(){var deferred=$q.defer();return rlobService.getDoctorInfoByUserId($scope.userInfo.id).then(function(data){"success"==data.status&&($scope.doctorInfo=data.data)},function(err){console.log("Khong the lay thong tin doctor")}).then(function(){deferred.resolve()}),deferred.promise},$scope.userInfo.user_type==rlobConstant.userType.doctor?$scope.getDoctorInfoByUserId().then($scope.filterBooking):$scope.filterBooking()}),angular.module("app.loggedIn.rlob.bookingDetail.controller",[]).controller("rlob_bookingDetailController",function($scope,$http,$state,$stateParams,$cookieStore){$scope.isCanUpload=!1,$scope.isAdminGetFiles=!0,$scope.isAdminUpload=!0,$scope.loginInfo=$cookieStore.get("userInfo"),$scope.bookingStatus=rlobConstant.bookingStatus,$http({method:"POST",url:"/api/rlob/rl_bookings/get-booking-by-id",data:{bookingId:$stateParams.bookingId,userId:$scope.loginInfo.id}}).success(function(data){"success"==data.status?($scope.selectedBooking=data.data,$("#view-detail-booking-dialog").modal({show:!0,backdrop:"static"})):alert("data not exist!")}).error(function(data){console.log("error")})}),angular.module("app.loggedIn.vaccinob",["app.loggedIn.vaccinob.controller","app.loggedIn.rlob.booking.controller","app.loggedIn.rlob.list.controller","app.loggedIn.rlob.patientDetail.controller","app.loggedIn.rlob.adminBookingList.controller","app.loggedIn.rlob.bookingDetail.controller","app.loggedIn.rlob.services","app.loggedIn.rlob.directive"]).config(function($stateProvider){$stateProvider.state("loggedIn.vaccinob",{url:"/vaccinob",templateUrl:"modules/rediLegalOnlineBooking/views/vaccinob.html",controller:"vaccinobController"}).state("loggedIn.vaccinob.vaccinob_booking",{url:"/booking",templateUrl:"modules/rediLegalOnlineBooking/views/booking.html",controller:"rlob_bookingController"}).state("loggedIn.vaccinob.vaccinob_patient_detail",{url:"/booking/patient-detail",templateUrl:"/modules/rediLegalOnlineBooking/views/patient-detail.html",controller:"rlob_patientDetailController"}).state("loggedIn.vaccinob.vaccinob_booking_list",{url:"/booking/list",templateUrl:"/modules/rediLegalOnlineBooking/views/booking-list.html",controller:"rlob_bookingListController"}).state("loggedIn.vaccinob.vaccinob_admin_booking_list",{url:"/booking/admin-booking-list",templateUrl:"/modules/rediLegalOnlineBooking/views/admin-booking-list.html",controller:"rlob_admin_bookingListController"}).state("loggedIn.vaccinob.vaccinob_booking_detail",{url:"/booking/booking-detail/:bookingId",templateUrl:"/modules/rediLegalOnlineBooking/views/booking-detail.html",controller:"rlob_bookingDetailController"})});var TableEditable=function(){var handleTable=function(){var table=$("#sample_editable_1");table.dataTable({bFilter:!0,lengthMenu:[[5,15,20,-1],[5,15,20,"All"]],pageLength:10,language:{lengthMenu:" _MENU_ records"},columnDefs:[{orderable:!1,targets:[1,2]},{searchable:!1}],order:[[0,"desc"]]}).columnFilter({sPlaceHolder:"head:before",aoColumns:[{type:"text"},{type:"text"},{type:"select"},{type:"date-range"},{type:"date-range"}]})};return{init:function(){handleTable()}}}();angular.module("app.loggedIn.rlob.list.controller",[]).controller("rlob_bookingListController",function($scope,$http,$state,$stateParams,$cookieStore,FileUploader,rlobService,$window,Mailto,bookingService){$scope.isCanUpload=!0,$scope.loginInfo=$cookieStore.get("userInfo"),$scope.bookingStatus=rlobConstant.bookingStatus,$scope.documentStatus=rlobConstant.documentStatusFilter,$scope.documentStatusDisplay=rlobConstant.documentStatusDisplay,$scope.actionCenter={},$scope.actionCenter.changeBookingCalendar={},$scope.sizePageList=[{value:10,display:"10 Rows"},{value:20,display:"20 Rows"},{value:30,display:"30 Rows"},{value:40,display:"40 Rows"},{value:50,display:"50 Rows"},{value:60,display:"60 Rows"},{value:70,display:"70 Rows"},{value:80,display:"80 Rows"},{value:90,display:"90 Rows"},{value:100,display:"100 Rows"}],$scope.rl_types=[],$http({method:"GET",url:"/api/rlob/rl_types/list",params:{sourceType:$scope.bookingType}}).success(function(data){$scope.rl_types=data}).error(function(data){console.log("error")})["finally"](function(){}),$scope.goToBookingDetail=function(l){return $scope.isClickActionMenu?void($scope.isClickActionMenu=!1):void $http({method:"POST",url:"/api/rlob/rl_bookings/get-booking-by-id",data:{bookingId:l.BOOKING_ID,userId:$scope.loginInfo.id}}).success(function(data){"success"==data.status?($scope.selectedBooking=data.data,$("#view-detail-booking-dialog").modal({show:!0,backdrop:"static"})):alert("data not exist!")}).error(function(data){console.log("error")})},$scope.searchInfoMap={currentPage:1,itemsPerPage:$scope.sizePageList[0].value,totalItems:"",maxSize:15,claimNo:"",surname:"",firstName:"",fullName:"",type:"",appointmentDateFromTemp:"",appointmentDateFrom:"",appointmentDateToTemp:"",appointmentDateTo:"",bookingStatus:"",documentStatus:"",orderBy:"APPOINTMENT_DATE DESC"},$scope.list=[],$scope.pagingHandle=function(){$scope.searchInfo.appointmentDateFrom=$scope.searchInfo.appointmentDateFromTemp?moment($scope.searchInfo.appointmentDateFromTemp).format("YYYY/MM/DD"):null,$scope.searchInfo.appointmentDateTo=$scope.searchInfo.appointmentDateToTemp?moment($scope.searchInfo.appointmentDateToTemp).format("YYYY/MM/DD"):null,$http.post("/api/rlob/rl_bookings/list-bookings-for-customer",{searchInfo:$scope.searchInfo}).then(function(response){"success"==response.data.status?($scope.list=response.data.data.list,$scope.searchInfo.totalItems=response.data.data.totalItems):$scope.list=[]})},$scope.searchHandle=function(){$scope.searchInfo.currentPage=1,$scope.pagingHandle()},$scope.reset=function(){$scope.searchInfo=angular.copy($scope.searchInfoMap),$scope.pagingHandle()},$scope.sortDirect="NO_SORT",$scope.sortable={APPOINTMENT_DATE:"DESC",BOOKING_DATE:"NO_SORT"},$scope.currentFieldSort="APPOINTMENT_DATE",$scope.sortBy=function(){$scope.searchHandle()},$scope.$watch("[searchInfo.appointmentDateFromTemp,searchInfo.appointmentDateToTemp]",function(newValue,oldValue){$scope.searchInfo&&$scope.searchHandle()},!0),$scope.searchInfo=angular.copy($scope.searchInfoMap),$scope.searchHandle(),$scope.isClickActionMenu=!1,$scope.clickActionMenu=function(bookingId){$scope.isClickActionMenu=!0,rlobService.getBookingById(bookingId).then(function(data){"success"==data.status&&($scope.selectedBooking=data.data)})},$scope.printContent=function(){var printable=document.getElementsByClassName("printable");$(printable[0]).printArea()},$scope.downloadResult=function(bookingId){$window.location.href="/api/download/structure/attach-file/"+$scope.bookingType+"/"+bookingId},$scope.$watch("selectedBooking",function(newValue,oldValue){newValue!=oldValue&&$scope.updateMailTo(newValue)}),$scope.showDialogSendDocument=function(){$("#view-detail-booking-dialog").modal("hide"),$("#lob-client-send-document-dialog").modal({show:!0,backdrop:"static"})},$scope.uploadDocument=function(){$("#lob-client-send-document-dialog").modal("hide"),$("#lob-client-upload-dialog").modal({show:!0,backdrop:"static"})},$scope.updateMailTo=function(data){$scope.mailBodyData={requestBy:$scope.loginInfo.user_name?$scope.loginInfo.user_name:"",company:data.Company_name?data.Company_name:"",time:moment(new Date(data.APPOINTMENT_DATE)).format("HH:mm"),date:moment(new Date(data.APPOINTMENT_DATE)).format("DD/MM/YYYY"),typeOfAppointment:data.BOOKING_TYPE,doctor:data.NAME?data.NAME:"",address:data.Site_addr?data.Site_addr:"",isContactPatient:data.ISCONTACTPATIENT?data.ISCONTACTPATIENT:"",notes:data.NOTES?data.NOTES:"",claimNumber:data.CLAIM_NO?data.CLAIM_NO:"",wrkName:data.WRK_SURNAME?data.WRK_SURNAME:"",wrkDOB:moment(data.WRK_DOB).format("DD/MM/YYYY"),wrkContactNo:data.WRK_CONTACT_NO?data.WRK_CONTACT_NO:"",injuryDesc:data.DESC_INJURY?data.DESC_INJURY:""},$scope.emailContent="The below appointment has been requested by "+$scope.mailBodyData.requestBy+" from "+$scope.mailBodyData.company+".\n\nAppointment Details:\n\nDate: "+$scope.mailBodyData.date+"\nTime: "+$scope.mailBodyData.time+"\nType of appointment: "+$scope.mailBodyData.Rl_TYPE_NAME+"\nDoctor: "+$scope.mailBodyData.doctor+"\nAddress: "+$scope.mailBodyData.address+"\nNotes: "+$scope.mailBodyData.notes+" \n\nPatient information:\n\nClaim number: "+$scope.mailBodyData.claimNumber+"\nName: "+$scope.mailBodyData.wrkName+"\nDate of Birth: "+$scope.mailBodyData.wrkDOB+"\nContact number: "+$scope.mailBodyData.wrkContactNo+" \nInjury description: "+$scope.mailBodyData.injuryDesc+"\n";var recepient="medicolegal@redimed.com.au",options={subject:"Medico-Legal Paperwork "+$scope.mailBodyData.wrkName,body:$scope.emailContent};$scope.mailtoLink=Mailto.url(recepient,options)},$scope.sendEmail=function(){console.log($scope.mailtoLink),$window.location.href=$scope.mailtoLink,$("#lob-client-send-document-dialog").modal("hide")},$scope.reuseBookingInfo=function(){bookingService.setBookingInfoReuse($scope.selectedBooking),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Please choose appointment calendar!"),$state.go("loggedIn.rlob.rlob_booking")},$scope.cancelBooking=function(){var appTime=new Date($scope.selectedBooking.APPOINTMENT_DATE),currentTime=new Date;appTime>currentTime&&$scope.selectedBooking.STATUS==rlobConstant.bookingStatus.confirmed?rlobService.cancelBooking($scope.selectedBooking.CAL_ID,$scope.selectedBooking.PATIENT_ID).then(function(data){"success"==data.status?rlobService.changeBookingStatus($scope.selectedBooking.BOOKING_ID,rlobConstant.bookingStatus.cancel).then(function(data){"success"==data.status?($scope.selectedBooking.STATUS=rlobConstant.bookingStatus.cancel,rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Cancel booking success!"),$scope.pagingHandle()):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Cancel booking fail!")}):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Cancel booking fail!")}):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"You cannot cancel this booking!")},$scope.currentUpdatingItem={bookingId:null,calId:null,appointmentDateTime:null,newAppoimentDateTime:null,bookingIdChangeSuccess:null,assId:null,newCalId:null},$scope.actionCenter.changeBookingCalendar.runWhenSuccess=function(){$scope.searchHandle()}}),angular.module("app.loggedIn.rlob.adminDocumentStatusSummary.controller",[]).controller("rlob_admin_documentStatusSummaryController",function($scope,$http,$cookieStore,$q,$state,rlobService){$scope.listDaysOfWeek={},$scope.listHoursInDay={},$scope.listDays={};var dateStartWeek=rlobDate.getDateStartWeek(new Date),dateEndWeek=rlobDate.getDateEndWeek(new Date);$scope.nextWeek=function(){dateStartWeek=dateStartWeek.add(7,"days"),dateEndWeek=dateEndWeek.add(7,"days"),$scope.getDocumentStatusSummaryInWeek(dateStartWeek,dateEndWeek)},$scope.previousWeek=function(){dateStartWeek=dateStartWeek.subtract(7,"days"),dateEndWeek=dateEndWeek.subtract(7,"days"),$scope.getDocumentStatusSummaryInWeek(dateStartWeek,dateEndWeek)},$scope.datesDisplay="",$scope.numberOfBooking=0,$scope.getDocumentStatusSummaryInWeek=function(dateStart,dateEnd){$scope.listDaysOfWeek={},$scope.listHoursInDay={},$scope.listDays={},$scope.datesDisplay=dateStart.format("DD/MM/YYYY")+"-"+dateEnd.format("DD/MM/YYYY"),rlobService.getDocumentStatusSummary(dateStart.format("YYYY/MM/DD"),dateEnd.format("YYYY/MM/DD")).then(function(data){if($scope.numberOfBooking=0,"success"==data.status){$scope.numberOfBooking=data.data.length;for(var i=0;i<data.data.length;i++){var item=data.data[i],appointmentDate=new Date(data.data[i].APPOINTMENT_DATE),dayValue=appointmentDate.getDay();$scope.listDaysOfWeek[rlobDate.daysOfWeek[dayValue].value]||($scope.listDaysOfWeek[rlobDate.daysOfWeek[dayValue].value]=rlobDate.daysOfWeek[dayValue]),$scope.listHoursInDay[moment(appointmentDate).format("HH:mm")]||($scope.listHoursInDay[moment(appointmentDate).format("HH:mm")]={})}for(var i=0;i<data.data.length;i++){var item=data.data[i],appointmentDate=new Date(data.data[i].APPOINTMENT_DATE),dayValue=appointmentDate.getDay();$scope.listDays[rlobDate.daysOfWeek[dayValue].value]||($scope.listDays[rlobDate.daysOfWeek[dayValue].value]={DISPLAY:rlobDate.daysOfWeek[dayValue].display,LIST:angular.copy($scope.listHoursInDay)}),$scope.listDays[rlobDate.daysOfWeek[dayValue].value].LIST[moment(appointmentDate).format("HH:mm")]||($scope.listDays[rlobDate.daysOfWeek[dayValue].value].LIST[moment(appointmentDate).format("HH:mm")]={});var styleClass="";switch(item.DOCUMENT_STATUS){case rlobConstant.documentStatus.notConfirmed.value:styleClass=rlobConstant.documentStatusSummaryStyleClass.notConfirmed;break;case rlobConstant.documentStatus.checked.value:styleClass=rlobConstant.documentStatusSummaryStyleClass.checked;break;case rlobConstant.documentStatus.noDocuments.value:styleClass=rlobConstant.documentStatusSummaryStyleClass.noDocuments}$scope.listDays[rlobDate.daysOfWeek[dayValue].value].LIST[moment(appointmentDate).format("HH:mm")][item.BOOKING_ID]||($scope.listDays[rlobDate.daysOfWeek[dayValue].value].LIST[moment(appointmentDate).format("HH:mm")][item.BOOKING_ID]={BOOKING_ID:item.BOOKING_ID,WRK_SURNAME:item.WRK_SURNAME,DOCUMENT_STATUS:item.DOCUMENT_STATUS,STYLE_CLASS:styleClass})}}})},$scope.getDocumentStatusSummaryInWeek(dateStartWeek,dateEndWeek),$scope.isAdminGetFiles=!0,$scope.accordionStatus={status1:!0},$scope.isAdminUpload=!0,$scope.getBookingDetail=function(bookingId){rlobService.getBookingById(bookingId).then(function(data){"success"==data.status&&($scope.selectedBooking=data.data,$("#rlob-booking-detail-popup").modal({show:!0,backdrop:"static"}))},function(err){})},$("#rlob-booking-detail-popup").on("hide.bs.modal",function(e){$scope.getDocumentStatusSummaryInWeek(dateStartWeek,dateEndWeek)})});var kiss={concat:function(){for(var str="",i=0;i<arguments.length;i++)str+=arguments[i];return str},msToTimer:function(num){var timerItem={x:null,hour:null,minute:null,second:null,display:null};timerItem.x=num,timerItem.hour=Math.floor(timerItem.x/3600);var temp=timerItem.x%3600;timerItem.minute=Math.floor(temp/60);var temp=timerItem.x%60;timerItem.second=temp;var pad=function(num,size){var s="000000000"+num;return s.substr(s.length-size)};return timerItem.display=pad(timerItem.hour,2)+":"+pad(timerItem.minute,2)+":"+pad(timerItem.second,2),timerItem}};angular.module("app.kiss.timer.directive",[]).directive("kissTimer",function($interval){return{restrict:"E",scope:{startSessionTime:"=",returnValue:"="},templateUrl:"modules/kissModule/directives/templates/kissTimer.html",link:function($scope,element,attrs){var run=function(){var startSessionTime=moment(new Date($scope.startSessionTime)),currentTime=moment(),x=currentTime.diff(startSessionTime,"seconds"),timerItem={x:null,hour:null,minute:null,second:null};timerItem.x=x,timerItem.hour=Math.floor(timerItem.x/3600);var temp=timerItem.x%3600;timerItem.minute=Math.floor(temp/60);var temp=timerItem.x%60;timerItem.second=temp;var pad=function(num,size){var s="000000000"+num;return s.substr(s.length-size)},updateTime=function(){timerItem.hour=Math.floor(timerItem.x/3600);var temp=timerItem.x%3600;timerItem.minute=Math.floor(temp/60);var temp=timerItem.x%60;timerItem.second=temp,timerItem.x=timerItem.x+1,$scope.returnValue=pad(timerItem.hour,2)+":"+pad(timerItem.minute,2)+":"+pad(timerItem.second,2)};$scope.timer=$interval(updateTime,1e3)};$scope.$watch("startSessionTime",function(newValue,oldValue){$scope.startSessionTime&&("close"!=$scope.startSessionTime?run():$interval.cancel($scope.timer))}),element.on("$destroy",function(){$interval.cancel($scope.timer)})}}}),angular.module("app.loggedIn.rlob.paperless.controller",[]).controller("rlob_paperlessController",function($scope,rlobService,$cookieStore,$state){$scope.userType=rlobConstant.userType,$scope.loginInfo=$cookieStore.get("userInfo").user_type,console.log($scope.loginInfo),$scope.isDoctor=!0,$scope.loginInfo==$scope.userType.doctor&&($scope.isDoctor=!1),$scope.isAdmin=!0,$scope.loginInfo==$scope.userType.admin&&($scope.isAdmin=!1),$scope.isAssistant=!0,$scope.loginInfo==$scope.userType.assistant&&($scope.isAssistant=!1),console.log($scope.userType.doctor)}),angular.module("app.loggedIn.rlob.paperless.ams6.controller",[]).controller("rlob_paperless_ams6Controller",function($scope,rlobService,toastr,ConfigService){
rlobService.checkBookingInFormAms6(rlobService.bookingInfoPaperless.id).then(function(data){"update"==data.status&&($scope.update=!0,$scope.info=data.data,$scope.info.WRK_DATE_OF_BIRTH_TEMP=null!=data.data.WRK_DATE_OF_BIRTH?new Date(data.data.WRK_DATE_OF_BIRTH):null,$scope.info.WRK_DATE_OF_INJURI_TEMP=null!=data.data.WRK_DATE_OF_INJURI?new Date(data.data.WRK_DATE_OF_INJURI):null,$scope.info.DATE_ASSESS_TEMP=null!=data.data.DATE_ASSESS?new Date(data.data.DATE_ASSESS):null,$scope.info.DT_DATE_TEMP=null!=data.data.DT_DATE?new Date(data.data.DT_DATE):new Date,console.log("update a6:"+$scope.update),console.log($scope.info),$scope.isSaving=!0),"insert"==data.status&&($scope.insert=!0,rlobService.getBookingDoctorCompany(rlobService.bookingInfoPaperless.id).then(function(data){"success"==data.status&&($scope.info.WRK_NAME=data.data.WRK_SURNAME+" "+data.data.WRK_OTHERNAMES,$scope.info.WRK_PHONE=data.data.WRK_PHONE,$scope.info.WRK_EMAIL=data.data.WRK_EMAIL,$scope.info.WRK_DATE_OF_BIRTH_TEMP=null!=data.data.WRK_DATE_OF_BIRTH?new Date(data.data.WRK_DATE_OF_BIRTH):null,$scope.info.WRK_DATE_OF_INJURI_TEMP=null!=data.data.WRK_DATE_OF_INJURI?new Date(data.data.WRK_DATE_OF_INJURI):null,$scope.info.EMP_ORGANISATION_NAME=data.data.EMP_ORGANISATION_NAME,$scope.info.EMP_POSTCODE=data.data.EMP_POSTCODE,$scope.info.EMP_ADDRESS_1=data.data.EMP_ADDRESS_1,$scope.info.EMP_EMAIL=data.data.EMP_EMAIL,$scope.info.EMP_PHONE=data.data.EMP_PHONE,$scope.info.DT_NAME=data.data.DT_NAME,$scope.info.DT_ADDRESS_1=data.data.DT_ADDRESS_1,$scope.info.DT_EMAIL=data.data.DT_EMAIL,$scope.info.DT_PHONE=data.data.DT_PHONE,$scope.info.DT_SIGNATURE=data.data.DT_SIGNATURE,$scope.info.DT_DATE_TEMP=new Date,console.log($scope.info))}),$scope.isSaving=!1,console.log("insert a6:"+$scope.insert))}),$scope.info={AMS6_ID:null,BOOKING_ID:rlobService.bookingInfoPaperless.id,WRK_NAME:null,WRK_ADDRESS_1:null,WRK_ADDRESS_2:null,WRK_POSTCODE:null,WRK_DATE_OF_BIRTH_TEMP:null,WRK_DATE_OF_BIRTH:null,WRK_DATE_OF_INJURI:null,WRK_DATE_OF_INJURI_TEMP:null,WRK_INSURER_CLAIM_NUMBER:null,WRK_DESCRIPTION_OF_INJURI:null,WRK_PHONE:null,WRK_EMAIL:null,WRK_WORKCOVER_WA_CLAIM_NUMBER:null,COMPANIES_ID:null,EMP_ORGANISATION_NAME:null,EMP_CONTACT_PERSON:null,EMP_ADDRESS_1:null,EMP_ADDRESS_2:null,EMP_POSTCODE:null,EMP_PHONE:null,EMP_EMAIL:null,EMP_NAME_OF_INSURER:null,EMP_WORKCOVER_MUNBER:null,PURPOSE_OF_THE_ASSESSMENT:null,DATE_ASSESS:null,DATE_ASSESS_TEMP:null,INJURY_ASSESSMENT:null,DOCTOR_ID:null,DT_DATE_TEMP:null,DT_DATE:null,DT_SIGNATURE:null,DT_NAME:null,DT_ADDRESS_1:null,DT_ADDRESS_2:null,DT_POSTCODE:null,DT_PHONE:null,DT_EMAIL:null,ISENABLE:null},$scope.scrollTo=function(el,offeset){var pos=el&&el.size()>0?el.offset().top:0;el&&($("body").hasClass("page-header-fixed")&&(pos-=$(".page-header").height()),pos+=offeset?offeset:-1*el.height()),$("html,body").animate({scrollTop:pos},"slow")};var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.DT_SIGNATURE=tempSignature},$scope.clearClick=function(){$scope.info.DT_SIGNATURE=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.DT_SIGNATURE},$scope.addNewFormAMS6=function(info){$scope.$broadcast("show-errors-check-validity"),$scope.FormAms6.$valid?(1==$scope.update&&($scope.info.WRK_DATE_OF_BIRTH=null!=info.WRK_DATE_OF_BIRTH_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_BIRTH_TEMP):null,$scope.info.WRK_DATE_OF_INJURI=null!=info.WRK_DATE_OF_INJURI_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_INJURI_TEMP):null,$scope.info.DATE_ASSESS=null!=info.DATE_ASSESS_TEMP?ConfigService.getCommonDate(info.DATE_ASSESS_TEMP):null,$scope.info.DT_DATE=null!=info.DT_DATE_TEMP?ConfigService.getCommonDate(info.DT_DATE_TEMP):null,console.log($scope.info),null!=info.BOOKING_ID&&""!=info.BOOKING_ID?rlobService.updateFromAms6(info).then(function(data){"success"==data.status?(toastr.success("Update Success!","Success"),$scope.isSaving=!0,$scope.scrollTo($("#bodydata']"),-200)):toastr.error("Update Failed!","Error")}):toastr.error("Not Booking Id!","Error")),1==$scope.insert&&($scope.info.WRK_DATE_OF_BIRTH=null!=info.WRK_DATE_OF_BIRTH_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_BIRTH_TEMP):null,$scope.info.WRK_DATE_OF_INJURI=null!=info.WRK_DATE_OF_INJURI_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_INJURI_TEMP):null,$scope.info.DATE_ASSESS=null!=info.DATE_ASSESS_TEMP?ConfigService.getCommonDate(info.DATE_ASSESS_TEMP):null,$scope.info.DT_DATE=null!=info.DT_DATE_TEMP?ConfigService.getCommonDate(info.DT_DATE_TEMP):null,console.log($scope.info),null!=info.BOOKING_ID&&""!=info.BOOKING_ID?rlobService.addNewFromAms6(info).then(function(data){"success"==data.status?(toastr.success("Insert Success!","Success"),$scope.isSaving=!0,$scope.info.AMS6_ID=data.data,console.log($scope.info),$scope.scrollTo($("#bodydata]"),-200)):toastr.error("Insert Failed!","Error")}):toastr.error("Not Booking Id!","Error"))):($scope.hadForcused=!0,$(".errorSummaryAms6").show())},$scope.edit=!1,$scope.editFormAms6=function(){$scope.isSaving=!1,$scope.edit=!0},$scope.updateFormAMS6=function(info){$scope.$broadcast("show-errors-check-validity"),$scope.FormAms6.$valid?($scope.info.WRK_DATE_OF_BIRTH=null!=info.WRK_DATE_OF_BIRTH_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_BIRTH_TEMP):null,$scope.info.WRK_DATE_OF_INJURI=null!=info.WRK_DATE_OF_INJURI_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_INJURI_TEMP):null,$scope.info.DATE_ASSESS=null!=info.DATE_ASSESS_TEMP?ConfigService.getCommonDate(info.DATE_ASSESS_TEMP):null,$scope.info.DT_DATE=null!=info.DT_DATE_TEMP?ConfigService.getCommonDate(info.DT_DATE_TEMP):null,console.log($scope.info),console.log(info),null!=info.BOOKING_ID&&""!=info.BOOKING_ID?rlobService.updateFromAms6(info).then(function(data){"success"==data.status?(toastr.success("Edit Success!","Success"),$scope.isSaving=!0,$scope.scrollTo($("#bodydata"),-200)):toastr.error("Edit Failed!","Error")}):toastr.error("Not Booking Id!","Error")):($scope.hadForcused=!0,$(".errorSummaryAms6").show())},$scope.goToName=function(name){$scope.scrollTo($("[name='"+name+"']"),-200)},$scope.cancelFormAms6=function(){$scope.isSaving=!0}}),angular.module("app.loggedIn.rlob.paperless.ams5.controller",[]).controller("rlob_paperless_ams5Controller",function($scope,rlobService,toastr,ConfigService){rlobService.checkBookingInFormAms5(rlobService.bookingInfoPaperless.id).then(function(data){"update"==data.status&&($scope.updateAMS5=!0,$scope.info=data.data,$scope.info.WRK_DATE_OF_BIRTH_TEMP=null!=data.data.WRK_DATE_OF_BIRTH?new Date(data.data.WRK_DATE_OF_BIRTH):null,$scope.info.WRK_DATE_OF_INJURI_TEMP=null!=data.data.WRK_DATE_OF_INJURI?new Date(data.data.WRK_DATE_OF_INJURI):null,$scope.info.EX_DATE_TEMP=null!=data.data.EX_DATE?new Date(data.data.EX_DATE):null,$scope.info.DT_DATE_TEMP=null!=data.data.DT_DATE?new Date(data.data.DT_DATE):new Date,console.log(data.data),console.log("update a5:"+$scope.updateAMS5),console.log($scope.info),$scope.isSaving=!0),"insert"==data.status&&($scope.insertAMS5=!0,rlobService.getBookingDoctorCompany(rlobService.bookingInfoPaperless.id).then(function(data){"success"==data.status&&(console.log(data.data),$scope.info.WRK_NAME=data.data.WRK_SURNAME+" "+data.data.WRK_OTHERNAMES,$scope.info.WRK_DATE_OF_BIRTH_TEMP=null!=data.data.WRK_DATE_OF_BIRTH?new Date(data.data.WRK_DATE_OF_BIRTH):null,$scope.info.WRK_DATE_OF_INJURI_TEMP=null!=data.data.WRK_DATE_OF_INJURI?new Date(data.data.WRK_DATE_OF_INJURI):null,$scope.info.WRK_PHONE=data.data.WRK_PHONE,$scope.info.WRK_EMAIL=data.data.WRK_EMAIL,$scope.info.EMP_ORGANISATION_NAME=data.data.EMP_ORGANISATION_NAME,$scope.info.EMP_POSTCODE=data.data.EMP_POSTCODE,$scope.info.EMP_ADDRESS_1=data.data.EMP_ADDRESS_1,$scope.info.EMP_EMAIL=data.data.EMP_EMAIL,$scope.info.EMP_PHONE=data.data.EMP_PHONE,$scope.info.DT_NAME=data.data.DT_NAME,$scope.info.DT_ADDRESS_1=data.data.DT_ADDRESS_1,$scope.info.DT_EMAIL=data.data.DT_EMAIL,$scope.info.DT_PHONE=data.data.DT_PHONE,$scope.info.DT_SIGNATURE=data.data.DT_SIGNATURE,$scope.info.DT_DATE_TEMP=new Date,console.log($scope.info))}),$scope.isSaving=!1,console.log("insert a5:"+$scope.insertAMS5))}),$scope.info={AMS5_ID:null,BOOKING_ID:rlobService.bookingInfoPaperless.id,WRK_NAME:null,WRK_ADDRESS_2:null,WRK_ADDRESS_1:null,WRK_POSTCODE:null,WRK_DATE_OF_BIRTH_TEMP:null,WRK_DATE_OF_BIRTH:null,WRK_DATE_OF_INJURI_TEMP:null,WRK_DATE_OF_INJURI:null,WRK_INSURER_CLAIM_NUMBER:null,WRK_DESCRIPTION_OF_INJURI:null,WRK_PHONE:null,WRK_EMAIL:null,WRK_WORKCOVER_WA_CLAIM_NUMBER:null,COMPANIES_ID:null,EMP_ORGANISATION_NAME:null,EMP_CONTACT_PERSON:null,EMP_ADDRESS_1:null,EMP_ADDRESS_2:null,EMP_POSTCODE:null,EMP_PHONE:null,EMP_EMAIL:null,EMP_NAME_OF_INSURER:null,EMP_WORKCOVER_MUNBER:null,PURPOSE_OF_THE_ASSESSMENT:null,EX_DATE_TEMP:null,EX_DATE:null,EXL_NAME:null,EXL_ADDRESS_1:null,EXL_ADDRESS_2:null,EXL_POSTCODE:null,REPORTS_AND_DOCUMENTS:null,NARRATIVE_HISTORY:null,DIAGNOSIS_AND_STUDIES:null,DIAGNOSIS_AND_IMPAIRMENTS:null,PROPORTION_OF_PERMANENT_IMPAIRMENT:null,INJURY_ASSESSMENT:null,DOCTOR_ID:null,DT_DATE_TEMP:null,DT_DATE:null,DT_SIGNATURE:null,DT_NAME:null,DT_ADDRESS_1:null,DT_ADDRESS_2:null,DT_POSTCODE:null,DT_PHONE:null,DT_EMAIL:null},$scope.scrollTo=function(el,offeset){var pos=el&&el.size()>0?el.offset().top:0;el&&($("body").hasClass("page-header-fixed")&&(pos-=$(".page-header").height()),pos+=offeset?offeset:-1*el.height()),$("html,body").animate({scrollTop:pos},"slow")};var tempSignature;$scope.isSignature=!1,$scope.showSignature=function(){$scope.isSignature=!$scope.isSignature},$scope.cancelClick=function(){$scope.isSignature=!$scope.isSignature,$scope.info.DT_SIGNATURE=tempSignature},$scope.clearClick=function(){$scope.info.DT_SIGNATURE=""},$scope.okClick=function(){$scope.isSignature=!$scope.isSignature,tempSignature=$scope.info.DT_SIGNATURE},$scope.addNewFormAMS5=function(info){$scope.$broadcast("show-errors-check-validity"),$scope.FormAms5.$valid?(1==$scope.updateAMS5&&($scope.info.WRK_DATE_OF_BIRTH=null!=info.WRK_DATE_OF_BIRTH_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_BIRTH_TEMP):null,$scope.info.WRK_DATE_OF_INJURI=null!=info.WRK_DATE_OF_INJURI_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_INJURI_TEMP):null,$scope.info.EX_DATE=null!=info.EX_DATE_TEMP?ConfigService.getCommonDate(info.EX_DATE_TEMP):null,$scope.info.DT_DATE=null!=info.DT_DATE_TEMP?ConfigService.getCommonDate(info.DT_DATE_TEMP):null,console.log($scope.info),null!=info.BOOKING_ID&&""!=info.BOOKING_ID?rlobService.updateFromAms5(info).then(function(data){"success"==data.status?(toastr.success("Update Success!","Success"),$scope.isSaving=!0,$scope.scrollTo($("#bodydata"),-200)):toastr.error("Update Failed!","Error")}):toastr.error("Not Booking Id!","Error")),1==$scope.insertAMS5&&($scope.info.WRK_DATE_OF_BIRTH=null!=info.WRK_DATE_OF_BIRTH_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_BIRTH_TEMP):null,$scope.info.WRK_DATE_OF_INJURI=null!=info.WRK_DATE_OF_INJURI_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_INJURI_TEMP):null,$scope.info.EX_DATE=null!=info.EX_DATE_TEMP?ConfigService.getCommonDate(info.EX_DATE_TEMP):null,$scope.info.DT_DATE=null!=info.DT_DATE_TEMP?ConfigService.getCommonDate(info.DT_DATE_TEMP):null,console.log($scope.info),null!=info.BOOKING_ID&&""!=info.BOOKING_ID?rlobService.addNewFromAms5(info).then(function(data){"success"==data.status?(toastr.success("Insert Success!","Success"),$scope.isSaving=!0,$scope.info.AMS5_ID=data.data,console.log($scope.info),$scope.scrollTo($("#bodydata"),-200)):toastr.error("Insert Failed!","Error")}):toastr.error("Not Booking Id!","Error"))):($scope.hadForcused=!0,$(".errorSummaryAms5").show())},$scope.edit=!1,$scope.editFormAms5=function(){$scope.isSaving=!1,$scope.edit=!0},$scope.updateFormAMS5=function(info){$scope.$broadcast("show-errors-check-validity"),$scope.FormAms5.$valid?($scope.info.WRK_DATE_OF_BIRTH=null!=info.WRK_DATE_OF_BIRTH_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_BIRTH_TEMP):null,$scope.info.WRK_DATE_OF_INJURI=null!=info.WRK_DATE_OF_INJURI_TEMP?ConfigService.getCommonDate(info.WRK_DATE_OF_INJURI_TEMP):null,$scope.info.EX_DATE=null!=info.EX_DATE_TEMP?ConfigService.getCommonDate(info.EX_DATE_TEMP):null,$scope.info.DT_DATE=null!=info.DT_DATE_TEMP?ConfigService.getCommonDate(info.DT_DATE_TEMP):null,console.log($scope.info),console.log(info),null!=info.BOOKING_ID&&""!=info.BOOKING_ID?rlobService.updateFromAms5(info).then(function(data){"success"==data.status?(toastr.success("Edit Success!","Success"),$scope.isSaving=!0,$scope.scrollTo($("#bodydata"),-200)):toastr.error("Edit Failed!","Error")}):toastr.error("Not Booking Id!","Error")):($scope.hadForcused=!0,$(".errorSummaryAms5").show())},$scope.goToName=function(name){$scope.scrollTo($("[name='"+name+"']"),-200)},$scope.cancelFormAms5=function(){$scope.isSaving=!0}}),angular.module("app.loggedIn.rlob.rltype.controller",[]).controller("rlob_rltypeController",function($scope,rlobService,toastr){$scope.bookingType=rlobConstant.bookingType,$scope.setListRltype=function(){rlobService.getlistRlType().then(function(data){"success"==data.status&&($scope.listRlType=data.data)})},$scope.setListRltype(),$scope.showPopupAddNewType=function(){$scope.name=null,$scope.sourceName=null,$("#rlob-type-insert-popup").modal({show:!0,backdrop:"static"})},$scope.insertRlType=function(name,sourceName){rlobService.insertRlTypes(name,sourceName).then(function(data){"success"==data.status&&($scope.setListRltype(),$("#rlob-type-insert-popup").modal("hide"),toastr.success("Insert Success!","Success")),"fail"==data.status&&($("#rlob-type-insert-popup").modal("hide"),toastr.error("Insert Failed!","Error"))})},$scope.showPopupEditType=function(type){$scope.name=type.Rl_TYPE_NAME,$scope.sourceName=type.SOURCE_TYPE,$scope.enable=type.ISENABLE,$scope.idType=type.RL_TYPE_ID,$("#rlob-type-edit-popup").modal({show:!0,backdrop:"static"})},$scope.updateRltype=function(idType,name,sourceName,enable){rlobService.updateRlTypes(idType,name,sourceName,enable).then(function(data){"success"==data.status&&($scope.setListRltype(),$("#rlob-type-edit-popup").modal("hide"),toastr.success("Update Success!","Success")),"fail"==data.status&&($("#rlob-type-edit-popup").modal("hide"),toastr.error("Update Failed!","Error"))})}}),angular.module("app.loggedIn.rlob.specialties.controller",[]).controller("rlob_specialtiesController",function($scope,rlobService,toastr){$scope.setListSpecialties=function(){rlobService.getListSpecialties().then(function(data){"success"==data.status&&($scope.listSpecialties=data.data)})},$scope.setListSpecialtiesType=function(){rlobService.getlistRlType().then(function(data){"success"==data.status&&($scope.listSpecialtiesType=data.data)})},$scope.setListSpecialties(),$scope.showPopupAddNewSpecialties=function(){$scope.specialtiesName=null,$scope.specialtiesType=null,$scope.setListSpecialtiesType(),$("#rlob-specialties-insert-popup").modal({show:!0,backdrop:"static"})},$scope.insertSpecialties=function(specialtiesName,specialtiesType){rlobService.insertSpecialties(specialtiesName,specialtiesType).then(function(data){"success"==data.status&&($scope.setListSpecialties(),$("#rlob-specialties-insert-popup").modal("hide"),toastr.success("Insert Success!","Success")),"fail"==data.status&&($("#rlob-specialties-insert-popup").modal("hide"),toastr.error("Insert Failed!","Error"))})},$scope.showPopupEditSpecialties=function(specialties){$scope.specialtiesId=specialties.Specialties_id,$scope.specialtiesName=specialties.Specialties_name,$scope.specialtiesType=specialties.RL_TYPE_ID,$scope.enable=specialties.Isenable,$scope.setListSpecialtiesType(),$("#rlob-specialties-edit-popup").modal({show:!0,backdrop:"static"})},$scope.updateSpecialties=function(specialtiesId,specialtiesName,specialtiesType,enable){rlobService.updateSpecialties(specialtiesId,specialtiesName,specialtiesType,enable).then(function(data){"success"==data.status&&($scope.setListSpecialties(),$("#rlob-specialties-edit-popup").modal("hide"),toastr.success("Update Success!","Success")),"fail"==data.status&&($("#rlob-specialties-edit-popup").modal("hide"),toastr.error("Update Failed!","Error"))})}}),angular.module("app.sponsor1.controller",[]).controller("rlobSponsor1Controller",function($scope){}),angular.module("app.calendar.mobile.controller",[]).controller("rlobCalendarMobileMasterController",function(socket,$modal,$scope,toastr,$http,$stateParams,Mailto,$cookieStore,$window,rlobService,$timeout,ConfigService,$state){$scope.loginInfo=$cookieStore.get("userInfo"),$scope.selectedFilter={locationSelected:{},rltypeSelected:{},clnSpecialitySelected:{},doctorSelected:{},var1:moment(new Date).format("DD/MM/YYYY")},console.log($scope.selectedFilter.var1),$("#daydatepicker").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"dd/mm/yy",onSelect:function(date){$scope.selectedFilter.var1=date,console.log($scope.selectedFilter.var1),$scope.updateAppoinmentsList(),$scope.getLocationsFilter(),$scope.getDoctorsFilter()}}),$scope.getLocationsFilter=function(){var date=new Date(moment($scope.selectedFilter.var1,"DD-MM-YYYY HH:mm Z"));rlobService.ListLocationMobile(date).then(function(data){"success"==data.status&&($scope.locationsFilter=data.data)})},$scope.getLocationsFilter(),$scope.getDoctorsFilter=function(){var date=new Date(moment($scope.selectedFilter.var1,"DD-MM-YYYY HH:mm Z"));rlobService.ListDoctorMobile(date).then(function(data){"success"==data.status&&($scope.doctorsFilter=data.data)})},$scope.getDoctorsFilter(),$scope.updateAppoinmentsList=function(){var doctorId=$scope.selectedFilter.doctorSelected&&$scope.selectedFilter.doctorSelected.doctor_id?$scope.selectedFilter.doctorSelected.doctor_id:"%",locationId=$scope.selectedFilter.locationSelected&&$scope.selectedFilter.locationSelected.id?$scope.selectedFilter.locationSelected.id:"%",fromTime=$scope.selectedFilter.var1.split("/").reverse().join("-");$http({method:"GET",url:"/api/rlob/appointment-calendar/get-appointment-calendar-not-service",params:{DOCTOR_ID:doctorId,SITE_ID:locationId,FROM_TIME:fromTime}}).success(function(data){for(var temp={DOCTOR_ITEMS:[]},i=0;i<data.length;i++)temp[data[i].DOCTOR_ID]||(temp[data[i].DOCTOR_ID]={LOCATION_ITEMS:[]},temp.DOCTOR_ITEMS.push({DOCTOR_ID:data[i].DOCTOR_ID,DOCTOR_NAME:data[i].NAME})),temp[data[i].DOCTOR_ID][data[i].SITE_ID]||(temp[data[i].DOCTOR_ID][data[i].SITE_ID]={APPOINTMENT_ITEMS:[]},temp[data[i].DOCTOR_ID].LOCATION_ITEMS.push({SITE_ID:data[i].SITE_ID,SITE_NAME:data[i].Site_name})),temp[data[i].DOCTOR_ID][data[i].SITE_ID][data[i].CAL_ID]||(temp[data[i].DOCTOR_ID][data[i].SITE_ID][data[i].CAL_ID]={},temp[data[i].DOCTOR_ID][data[i].SITE_ID].APPOINTMENT_ITEMS.push({CAL_ID:data[i].CAL_ID,APPOINTMENT_TIME:data[i].appointment_time,FROM_TIME:data[i].FROM_TIME,DOCTOR_ID:data[i].DOCTOR_ID,SITE_ID:data[i].SITE_ID,DOCTOR_NAME:data[i].NAME,SITE_NAME:data[i].Site_name}));for(var arr=[],i=0;i<temp.DOCTOR_ITEMS.length;i++){var doctor_item=temp.DOCTOR_ITEMS[i];doctor_item.LOCATION_ITEMS=[];for(var j=0;j<temp[doctor_item.DOCTOR_ID].LOCATION_ITEMS.length;j++){var location_item=temp[doctor_item.DOCTOR_ID].LOCATION_ITEMS[j];location_item.APPOINTMENT_ITEMS=[],doctor_item.LOCATION_ITEMS.push(location_item);for(var k=0;k<temp[doctor_item.DOCTOR_ID][location_item.SITE_ID].APPOINTMENT_ITEMS.length;k++){var appointment_item=temp[doctor_item.DOCTOR_ID][location_item.SITE_ID].APPOINTMENT_ITEMS[k];location_item.APPOINTMENT_ITEMS.push(appointment_item)}}arr.push(doctor_item)}$scope.appointmentsFilter=arr}).error(function(data){console.log("error")})["finally"](function(){})},$scope.updateAppoinmentsList(),$scope.CAL_ID=null,$scope.selectAppointmentCalendar=function(appointmentCalendar){$scope.selectedAppointmentCalendar=appointmentCalendar,$scope.CAL_ID=appointmentCalendar.CAL_ID,$scope.updateAppoinmentsList()},$scope.submitCalendar=function(){$scope.patientInfoCalendar.Patient_id?$scope.selectedAppointmentCalendar?rlobService.addApptPatient($scope.patientInfoCalendar.Patient_id,$scope.selectedAppointmentCalendar.CAL_ID).then(function(data){"success"==data.status?(socket.emit("notifyReceptionist"),socket.emit("notifyDoctor",$scope.selectedAppointmentCalendar.DOCTOR_ID),angular.element("#popupBookingSuccess").modal("show")):toastr.error("Booking fail!","Error")}):toastr.error("Booking not yet selected","Error"):toastr.error("No information available on the patient","Error")},$scope.closePopupBookingSuccess=function(){angular.element("#popupBookingSuccess").modal("hide"),angular.element("#popupBookingSuccess").on("hidden.bs.modal",function(e){$state.go("security.portalPatient")})}}),angular.module("app.sponsor1.emergency.controller",[]).controller("rlobEmergencyController",function($scope,FileUploader,rlobService,toastr,$http){$scope.geoLocation=function(){var map=new GMaps({div:"#map",lat:0,lng:0});GMaps.geolocate({success:function(position){$scope.Lng=position.coords.longitude,$scope.Lat=position.coords.latitude,console.log($scope.Lat),console.log($scope.Lng),map.setCenter($scope.Lat,$scope.Lng),map.addMarker({lat:$scope.Lat,lng:$scope.Lng,icon:"http://www.icon100.com/up/4144/32/102-map-marker.png"}),$http.get("https://maps.googleapis.com/maps/api/geocode/json?latlng="+$scope.Lat+","+$scope.Lng+"&sensor=true").then(function(data){$scope.address=data.data.results[0].formatted_address,console.log(data.data)}),angular.element("#map").css("opacity","1"),angular.element("#dob-confix").css("margin-top","0px")},error:function(error){alert("Geolocation failed: "+error.message)},not_supported:function(){alert("Your browser does not support geolocation")}})};var uploader=$scope.uploader=new FileUploader;console.log($scope.uploader);var uploader=$scope.uploader=new FileUploader({url:"/api/rlob/sponsor/upload"});uploader.filters.push({name:"customFilter",fn:function(item,options){return this.queue.length<10}}),uploader.onWhenAddingFileFailed=function(item,filter,options){},uploader.onAfterAddingFile=function(fileItem){},uploader.onAfterAddingAll=function(addedFileItems){},uploader.onBeforeUploadItem=function(item){},uploader.onProgressItem=function(fileItem,progress){},uploader.onProgressAll=function(progress){},uploader.onSuccessItem=function(fileItem,response,status,headers){},uploader.onErrorItem=function(fileItem,response,status,headers){},uploader.onCancelItem=function(fileItem,response,status,headers){},uploader.onCompleteItem=function(fileItem,response,status,headers){},uploader.onCompleteAll=function(){},$scope.scrollTo=function(el,offeset){var pos=el&&el.size()>0?el.offset().top:0;el&&($("body").hasClass("page-header-fixed")&&(pos-=$(".page-header").height()),pos+=offeset?offeset:-1*el.height()),$("html,body").animate({scrollTop:pos},0)},console.info("uploader",uploader),$scope.insertEmergency=function(){$scope.$broadcast("show-errors-check-validity"),$scope.gender?(angular.element("#label-gender").css("display","none"),$scope.FormEmergency.$valid&&($scope.info={FIRSTNAME:$scope.fristname,LASTNAME:$scope.lastname,GENDER:$scope.gender,DOB:moment($scope.dob).format("YYYY/MM/DD"),ADD:$scope.address,CONTACT_NO:$scope.contactus,MEDICARE_NO:$scope.medicareno,MEDICARE_REF:$scope.medicareref,LONGITUDE:$scope.Lng,LATITUDE:$scope.Lat,INJURY:$scope.injury},rlobService.insertEmergency($scope.info).then(function(data){if("success"==data.status){toastr.success("Booking Success!","Success");for(var i=0;i<uploader.queue.length;i++){var item=uploader.queue[i];item.formData[i]={},item.formData[i].sponsor_id=data.data}uploader.uploadAll(),angular.element("#form-config").css("display","none"),angular.element("#data-success").css("display","block"),$scope.scrollTo($(".logo"))}else toastr.error("Booking Failed!","Error")}))):(angular.element("#label-gender").css("display","block"),$scope.scrollTo($(".logo")))},$scope.updateMap=function(){var map=new GMaps({div:"#map",lat:0,lng:0});map.removeMarker(),GMaps.geocode({address:$scope.address,callback:function(results,status){if("OK"==status){var latlng=results[0].geometry.location;map.setCenter(latlng.lat(),latlng.lng()),$scope.Lat=latlng.lat(),$scope.Lng=latlng.lng(),map.addMarker({lat:$scope.Lat,lng:$scope.Lng,icon:"http://www.icon100.com/up/4144/32/102-map-marker.png",infoWindow:{content:"<p>"+$scope.address+"</p>"}}),angular.element("#map").css("opacity","1"),angular.element("#dob-confix").css("margin-top","0px")}}})},$scope.setColorMedicareRef=function(){null!=$scope.medicareref&&""!=$scope.medicareref?$("#medicareref-confix").addClass("color-label"):$("#medicareref-confix").removeClass("color-label")},$scope.setColorMedicareNo=function(){null!=$scope.medicareno&&""!=$scope.medicareno?$("#medicareno-confix").addClass("color-label"):$("#medicareno-confix").removeClass("color-label")}}),angular.module("app.sponsor1.nonemergency.controller",[]).controller("rlobNonEmergencyController",function($scope,rlobService,$window,toastr){$scope.bookingType=rlobConstant.bookingType.REDiLEGAL.name,$scope.scrollTo=function(el,offeset){var pos=el&&el.size()>0?el.offset().top:0;el&&($("body").hasClass("page-header-fixed")&&(pos-=$(".page-header").height()),pos+=offeset?offeset:-1*el.height()),$("html,body").animate({scrollTop:pos},0)},$scope.showCalendar=function(){angular.element("#form-data").css("display","none"),angular.element("#caledar-data").css("display","block"),$scope.scrollTo($(".logo"))},$scope.showFormData=function(){angular.element("#form-data").css("display","block"),angular.element("#caledar-data").css("display","none"),$scope.scrollTo($(".logo"))},$scope.insertNonEmergency=function(){$scope.$broadcast("show-errors-check-validity"),$scope.gender?angular.element("#label-gender").css("display","none"):(angular.element("#label-gender").css("display","block"),$scope.showFormData()),$scope.FormNonemergency.$valid?($scope.info={FIRSTNAME:$scope.fristname,LASTNAME:$scope.lastname,GENDER:$scope.gender,DOB:moment($scope.dob).format("YYYY/MM/DD"),CONTACT_NO:$scope.contactus,MEDICARE_NO:$scope.medicareno,MEDICARE_REF:$scope.medicareref,INJURY:$scope.injury,LONGITUDE:$scope.Lng,LATITUDE:$scope.Lat,CAL_ID:$scope.selectedAppointmentCalendar.CAL_ID},console.log($scope.info),rlobService.insertNonEmergency($scope.info).then(function(data){"success"==data.status?(angular.element("#caledar-data").css("display","none"),angular.element("#data-success").css("display","block"),toastr.success("Booking Success!","Success")):toastr.error("Booking Failed!","Error")})):$scope.showFormData()},$scope.setColorMedicareRef=function(){null!=$scope.medicareref&&""!=$scope.medicareref?$("#medicareref-confix").addClass("color-label"):$("#medicareref-confix").removeClass("color-label")},$scope.setColorMedicareNo=function(){null!=$scope.medicareno&&""!=$scope.medicareno?$("#medicareno-confix").addClass("color-label"):$("#medicareno-confix").removeClass("color-label")}}),angular.module("app.rlobRegister.controller",[]).controller("rlobRegisterController",function($scope,$state,$cookieStore,SecurityService,rlobService,toastr,bookingService){$scope.user=bookingService.getRegisterInfo(),$scope.user.isAccessReportOnline=1,$scope.regexEmail=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,$scope.register=function(){$scope.$broadcast("show-errors-check-validity"),$scope.user.username=$scope.user.email;var checkuser="";$scope.showClickedValidation=!0,$scope.registerForm.$invalid?toastr.error("Please check form.","Error"):SecurityService.checkUserName($scope.user.username).then(function(data){checkuser=data}).then(function(){if(checkuser.length>0)$scope.showClickedValidation=!0,toastr.error("Username already exists","Error");else{$scope.user.fname=$scope.user.fname.charAt(0).toUpperCase()+$scope.user.fname.substr(1),$scope.user.lname=$scope.user.lname.charAt(0).toUpperCase()+$scope.user.lname.substr(1);var user={fullName:$scope.user.fname+" "+$scope.user.lname,email:$scope.user.email,userName:$scope.user.username,password:$scope.user.password,phone:$scope.user.phone,companyTemp:$scope.user.companyTemp,companyState:$scope.user.companyState,isAccessReportOnline:$scope.user.isAccessReportOnline?$scope.user.isAccessReportOnline:0,fname:$scope.user.fname,lname:$scope.user.lname};rlobService.insertNewUser(user).then(function(data){if("success"==data.status){toastr.success("Register Success!","Success"),angular.element("#form-data").css("display","none"),angular.element("#data-success").css("display","block");for(var i=0;i<$scope.stateList.length;i++)$scope.user.companyState==$scope.stateList[i].id&&($scope.companyStateName=$scope.stateList[i].State);bookingService.setRegisterInfo({})}else toastr.error("Register Failed!","Error")})}})},$scope.stateList=[],rlobService.getStates("Australia").then(function(data){$scope.stateList="success"==data.status?data.data:[]})}),angular.module("app.loggedIn.rlob.redilegalUsersListController.controller",[]).controller("rlob_admin_redilegalUsersListController",function($scope,rlobService,SecurityService,toastr){$scope.registerStatus=rlobConstant.registerStatus,$scope.sizePageList=[{value:10,display:"10 Rows"},{value:20,display:"20 Rows"},{value:30,display:"30 Rows"},{value:40,display:"40 Rows"},{value:50,display:"50 Rows"},{value:60,display:"60 Rows"},{value:70,display:"70 Rows"},{value:80,display:"80 Rows"},{value:90,display:"90 Rows"},{value:100,display:"100 Rows"}],$scope.searchInfoMap={currentPage:1,itemsPerPage:$scope.sizePageList[0].value,totalItems:"",maxSize:15,emailKey:"",nameKey:"",companyKey:"",statusKey:""},$scope.usersList=[],$scope.pagingHandle=function(){rlobService.getUsersList($scope.searchInfo).then(function(data){"success"==data.status?($scope.usersList=data.data.list,$scope.searchInfo.totalItems=data.data.totalItems,console.log($scope.usersList)):$scope.usersList=[]},function(err){$scope.usersList=[]})},$scope.searchHandle=function(){$scope.searchInfo.currentPage=1,$scope.pagingHandle()},$scope.reset=function(){$scope.searchInfo=angular.copy($scope.searchInfoMap),$scope.pagingHandle()},$scope.searchInfo=angular.copy($scope.searchInfoMap),$scope.searchHandle(),$scope.selectedItem={},$scope.editItem={},$scope.setSelectedItem=function(item){$scope.selectedItem=item,$scope.editItem=angular.copy($scope.selectedItem)},$scope.updateRedilegalUserStatus=function(user_name,status){return null==$scope.selectedItem.Company_name&&status!=rlobConstant.registerStatus.REJECT.value?void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Please reselect the infomation of company!"):void rlobService.updateRedilegalUserStatus(user_name,status).then(function(data){"success"==data.status?(rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Update status success!"),$scope.selectedItem.MEDICO_LEGAL_REGISTER_STATUS=status):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Update status fail!")},function(err){rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Update status fail!")})},$scope.companyList=[],SecurityService.company().then(function(response){$scope.companyList=response}),$scope.stateList=[],rlobService.getStates("Australia").then(function(data){$scope.stateList="success"==data.status?data.data:[]}),$scope.$watch("editItem.company_id",function(newValue,oldValue){if($scope.editItem.company_id)for(var i=0;i<$scope.companyList.length;i++){var item=$scope.companyList[i];if(item.id==$scope.editItem.company_id)return void($scope.editItem.Company_name=item.Company_name)}}),$scope.showViewAndUpdateDialog=function(){$("#rlob-view-edit-user").modal({show:!0,backdrop:"static"})},$scope.updateUser=function(){return null==$scope.editItem.Company_name&&$scope.editItem.MEDICO_LEGAL_REGISTER_STATUS!=rlobConstant.registerStatus.REJECT.value?void rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Please reselect the infomation of company!"):($scope.showClickedValidation=!0,void($scope.editForm.$invalid?toastr.error("Please check form.","Error"):(rlobService.updateUserInfo($scope.editItem).then(function(data){
"success"==data.status?(angular.extend($scope.selectedItem,$scope.editItem),rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.success,"Update success!")):rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Update fail!")},function(err){rlobMsg.popup(rlobLang.rlobHeader,rlobConstant.msgPopupType.error,"Update fail!")}),$("#rlob-view-edit-user").modal("hide"))))}}),angular.module("app.loggedIn.rlob.bookingBehalf.controller",[]).controller("rlob_admin_bookingBehalfController",function($scope,$state,rlobService,bookingService){$scope.registerStatus=rlobConstant.registerStatus,$scope.sizePageList=[{value:10,display:"10 Rows"},{value:20,display:"20 Rows"},{value:30,display:"30 Rows"},{value:40,display:"40 Rows"},{value:50,display:"50 Rows"},{value:60,display:"60 Rows"},{value:70,display:"70 Rows"},{value:80,display:"80 Rows"},{value:90,display:"90 Rows"},{value:100,display:"100 Rows"}],$scope.searchInfoMap={currentPage:1,itemsPerPage:$scope.sizePageList[0].value,totalItems:"",maxSize:15,emailKey:"",nameKey:"",companyKey:"",statusKey:rlobConstant.registerStatus.APPROVE.value},$scope.usersList=[],$scope.pagingHandle=function(){rlobService.getUsersList($scope.searchInfo).then(function(data){"success"==data.status?($scope.usersList=data.data.list,$scope.searchInfo.totalItems=data.data.totalItems):$scope.usersList=[]},function(err){$scope.usersList=[]})},$scope.searchHandle=function(){$scope.searchInfo.currentPage=1,$scope.pagingHandle()},$scope.reset=function(){$scope.searchInfo=angular.copy($scope.searchInfoMap),$scope.pagingHandle()},$scope.searchInfo=angular.copy($scope.searchInfoMap),$scope.searchHandle(),$scope.makeBooking=function(user){var bookingBehalfInfo={ASS_SURNAME:user.Booking_Person,ASS_OTHERNAMES:user.Booking_Person,ASS_CONTACT_NO:user.Contact_number,ASS_EMAIL:user.Contact_email,ASS_ID:user.id,COMPANY_ID:user.company_id};bookingService.setBookingBehalfInfo(bookingBehalfInfo),$state.go("loggedIn.rlob.rlob_booking")}}),angular.module("app.loggedIn.rlob.SpecialistsProfiles.controller",[]).controller("rlob_specialists_profilesController",function(){}),angular.module("app.loggedIn.referral",["app.loggedIn.referral.controller","app.loggedIn.referral.directives","app.loggedIn.referral.services"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.referral",{"abstract":!0,views:{"main-content@loggedIn.patient":{templateUrl:"modules/referral/views/structure.html",controller:"ReferralController"}}}).state("loggedIn.patient.referral.list",{url:"/referral",views:{"main-content":{templateUrl:"modules/referral/views/referral-list.html",controller:"ReferralListController"}}})}),angular.module("app.loggedIn.referral.directives",["app.loggedIn.referral.detail.directive"]),angular.module("app.loggedIn.referral.detail.directive",[]).directive("referralDetail",function(ReferralModel,ReferralService,DoctorService,ConfigService,toastr,$stateParams){return{restrict:"EA",scope:{data:"@",options:"=",onsuccess:"=onsuccess"},templateUrl:"modules/referral/directives/templates/detail.html",link:function(scope,element,attrs){var loadData=function(id){ReferralService.referralDetail(id).then(function(data){angular.extend(scope.modelObjectMap,data.data),ConfigService.autoConvertData(scope.modelObjectMap)})};if(scope.modelObjectMap=angular.copy(ReferralModel),scope.mode={type:"add",text:"Add referral"},scope.modelObjectMap.APPOINTMENT_DATE=new Date,scope.data){var data=scope.$eval(scope.data);data.id&&(loadData(data.id),scope.mode={type:"edit",text:"Edit referral"})}var addProcess=function(postData){postData.Patient_id=$stateParams.patient_id,postData.CAL_ID=$stateParams.cal_id,ReferralService.referralInsert(postData).then(function(response){"success"===response.status&&(toastr.success("Added a referral","Success"),scope.modelObjectMap=angular.copy(ReferralModel),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})},editProcess=function(postData){postData.id,delete postData.id,ReferralService.referralUpdate(postData).then(function(response){"success"===response.status&&(toastr.success("Edit referral Successfully","Success"),scope.isSubmit=!1,scope.onsuccess&&scope.onsuccess(response))})};scope.clickAction=function(option){if("view"!=option.type&&(scope.isSubmit=!0,!scope.mainForm.$invalid)){var postData=angular.copy(scope.modelObjectMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));"add"==option.type?addProcess(postData):"edit"==option.type&&editProcess(postData)}}}}}),angular.module("app.loggedIn.referral.controller",["app.loggedIn.referral.list.controller"]).controller("ReferralController",function(){}),angular.module("app.loggedIn.referral.list.controller",[]).controller("ReferralListController",function($scope,$stateParams){$scope.referral_panel={},$scope.referral={},$scope.referrals={select:0,"class":function(referral){return{selected:referral.ID==$scope.referral.select}},scope:$scope.referral_panel,options:{api:"api/erm/v2/referral/search",method:"post",scope:$scope.referral_panel,columns:[{field:"ID",is_hide:!0},{field:"CAL_ID",label:"Calendar ID",width:"10%"},{field:"CLINICAL_DETAILS",label:"Clinical details",width:"40%"},{field:"REQUESTING_PRACTITIONER",label:"Requesting practitioner",width:"40%"}],use_filters:!0,filters:{CAL_ID:{type:"text"},CLINICAL_DETAILS:{type:"text"},REQUESTING_PRACTITIONER:{type:"text"}},search:{Patient_id:$stateParams.patient_id},use_actions:!0,actions:[{"class":"fa fa-info",title:"Edit",callback:function(item){console.log("this is selected item",item),$scope.referral.id=item.ID,$scope.referralEditForm.open()}},{"class":"fa fa-print",title:"Print",callback:function(item){console.log("this is selected item",item),alert(item),window.open("http://testapp.redimed.com.au:3003/RedimedJavaREST/api/document/referral/"+item.ID)}}]}},$scope.referralAddForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.referral_panel.reload(),$scope.referralAddForm.close()}},$scope.loadDataAddMakeReferral.load=function(){$scope.referral_panel.reload()},$scope.referralEditForm={is_show:!1,open:function(){this.is_show=!0},close:function(){this.is_show=!1},success:function(response){"success"==response.status&&$scope.referral_panel.reload(),$scope.referralEditForm.close()}}}),angular.module("app.loggedIn.referral.services",[]).factory("ReferralService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/erm/");return mdtService.referralInsert=function(postData){var detailApi=mdtApi.all("v2/referral/insert");return detailApi.post(postData)},mdtService.referralDetail=function(postData){var detailApi=mdtApi.all("v2/referral/detail");return detailApi.post({ID:postData})},mdtService.referralUpdate=function(postData){var detailApi=mdtApi.all("v2/referral/update");return detailApi.post(postData)},mdtService}),angular.module("app.loggedIn.script.include",["app.loggedIn.script.list.controller","app.loggedIn.script.model","app.loggedIn.script.add.controller","app.loggedIn.script.edit.controller","app.loggedIn.script.directive.list","app.loggedIn.script.directive.add","app.loggedIn.script.directive.edit"]),angular.module("app.loggedIn.script",["app.loggedIn.script.include"]).config(function($stateProvider){$stateProvider.state("loggedIn.patient.script",{url:"/script",views:{"main-content":{templateUrl:"modules/script/views/list.html",controller:"ScriptListController"}}}).state("loggedIn.patient.script.add",{url:"/add",views:{"@loggedIn":{templateUrl:"modules/script/views/add.html",controller:"ScriptAddController"}}}).state("loggedIn.patient.script.edit",{url:"/edit/:scriptId",views:{"@loggedIn":{templateUrl:"modules/script/views/edit.html",controller:"ScriptEditController"}}})}),angular.module("app.loggedIn.script.list.controller",[]).controller("ScriptListController",function($scope,$state){}),angular.module("app.loggedIn.script.add.controller",[]).controller("ScriptAddController",function($scope,$state,$modalInstance,medicare){$scope.scriptadd={success:!1,medicare:medicare},console.log("_________",medicare),$scope.$watch("scriptadd.success",function(success){success&&$modalInstance.close($scope.scriptadd)})}),angular.module("app.loggedIn.script.edit.controller",[]).controller("ScriptEditController",function($scope,$state,$modalInstance,ID,medicare){$scope.scriptedit={success:!1,ID:ID,medicare:medicare},$scope.$watch("scriptedit.success",function(success){success&&$modalInstance.close($scope.scriptedit)})}),angular.module("app.loggedIn.script.model",[]).factory("ScriptModel",function(Restangular){var mainModel={},mainApi=Restangular.all("api/meditek/v1/script/");return mainModel.list=function(data){var instanceApi=mainApi.all("list");return instanceApi.post({data:data})},mainModel.add=function(data){var instanceApi=mainApi.all("add");return instanceApi.post({data:data})},mainModel.edit=function(data){var instanceApi=mainApi.all("edit");return instanceApi.post({data:data})},mainModel.listMedicationInScript=function(id){var instanceApi=mainApi.all("list-medication-in-script");return instanceApi.post({id:id})},mainModel.remove=function(data){var instanceApi=mainApi.all("remove");return instanceApi.post({data:data})},mainModel.byid=function(data){var instanceApi=mainApi.all("byid");return instanceApi.post({data:data})},mainModel.postDisable=function(data){var instanceApi=mainApi.all("disable");return instanceApi.post({data:data})},mainModel.postSing=function(data){var instanceApi=mainApi.all("signature");return instanceApi.post({data:data})},mainModel.postScriptHead=function(data){var instanceApi=mainApi.all("addScriptHead");return instanceApi.post({data:data})},mainModel.listpostHead=function(data,datar){var instanceApi=mainApi.all("listscriptHead");return instanceApi.post({data:data,datar:datar})},mainModel.editHead=function(data,datar){var instanceApi=mainApi.all("editcriptHead");return instanceApi.post({data:data,datar:datar})},mainModel}),angular.module("app.loggedIn.script.directive.list",[]).directive("scriptList",function(ScriptModel,PatientService,$modal,$filter,$stateParams,$state,toastr){return{restrict:"EA",templateUrl:"modules/script/directives/templates/list.html",scope:{options:"=",limit:"@",medicare:"="},link:function(scope,ele,attrs){var search={page:1,limit:5,offset:0,max_size:5,Patient_id:$stateParams.patient_id,CAL_ID:$stateParams.cal_id},load=function(){ScriptModel.list(search).then(function(response){scope.script.list=response.data,scope.script.count=response.count},function(error){})},onSearch=function(option){switch(option.field){case"scriptNum":scope.script.search.scriptNum=option.value;break;case"medication_name":scope.script.search.medication_name=option.value}scope.script.load()},remove=function(id){var modalInstance=$modal.open({templateUrl:"notifyToRemove",controller:function($scope,id,$modalInstance){$scope.ok=function(){$modalInstance.close(id)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},size:"sm",resolve:{id:function(){return id}}});modalInstance.result.then(function(id){id&&ScriptModel.remove(id).then(function(deleted){toastr.success("Deleted Successfully"),scope.script.load()},function(error){})})};scope.Scripts=function(type,index){"new"==type&&$modal.open({templateUrl:"notifyToAdd",controller:function($scope,$modalInstance,medicare){$scope.medicare=medicare,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.success={runWhenFinish:function(){$modalInstance.dismiss({status:"success"})}}},size:"lg",resolve:{medicare:function(){return scope.medicare}}}).result.then(function(response){},function(response){"success"==response.status&&scope.script.load()}),"edit"==type&&$modal.open({templateUrl:"notifyToEdit",controller:function($scope,$modalInstance,medicare,idScript){$scope.medicare=medicare,$scope.idScript=idScript,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.success={runWhenFinish:function(){$modalInstance.dismiss({status:"success"})}}},size:"lg",resolve:{idScript:function(){return index},medicare:function(){return scope.medicare}}}).result.then(function(response){},function(response){"success"==response.status&&scope.script.load()})};var disable=function(row){ScriptModel.postDisable(row).then(function(response){scope.script.load()},function(error){})};scope.setPage=function(page){scope.script.search.offset=(page-1)*scope.script.search.limit,scope.script.load()},scope.script={search:search,dialog:{remove:function(id){remove(id)}},loading:!1,list:[],count:0,error:"",disable:function(row){disable(row)},load:function(){load()},onSearch:function(option){onSearch(option)}},scope.script.load()}}}),angular.module("app.loggedIn.script.directive.add",[]).directive("scriptAdd",function(ScriptModel,PatientService,OutreferralModel,AppointmentModel,ConfigService,toastr,$cookieStore,$filter,$state,$stateParams,$modal){return{restrict:"EA",templateUrl:"modules/script/directives/templates/add.html",scope:{options:"=",success:"=",medicare:"="},link:function(scope,ele,attrs){var user_id=$cookieStore.get("userInfo").id,submitScript=function(){ConfigService.beforeSave(scope.script.errors),scope.script.errors=[],ScriptModel.add(scope.script.info).then(function(response){toastr.success("Add Successfully"),"success"==data.status&&scope.success&&scope.success.runWhenFinish()},function(error){scope.script.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.script.errors)})},getPatientInfo=function(){PatientService.getP($stateParams.patient_id).then(function(response){scope.patientData.info=response.data[0]},function(error){})};scope.patientData={info:{},getPatientInfo:function(){getPatientInfo()}};var getDoctorname=function(){OutreferralModel.DotorFromUserId(user_id).then(function(response){scope.script.info.prescriber=response.data[0].NAME,scope.script.info.doctorSign=response.data[0].Signature},function(error){})};scope.script={getDoctorname:function(){getDoctorname()},submitScript:function(params){submitScript(params)},errors:[],info:{ID:null,Patient_id:$stateParams.patient_id,CAL_ID:$stateParams.cal_id,prescriber:"",scriptNum:null,isRefNo:0,EntitlementNo:"",isSafety:0,isConcessional:0,isPBS:0,isRPBS:0,isBrand:0,MedicareNo:null,doctorSign:"",doctordate:moment().format("DD/MM/YYYY"),patientSign:"",patientDate:moment().format("DD/MM/YYYY"),agentAddress:"",medicare:[]}},scope.medicare&&(scope.script.info.medicare=angular.copy(scope.medicare)),scope.patientData.getPatientInfo(),scope.script.getDoctorname()}}}),angular.module("app.loggedIn.script.directive.edit",[]).directive("scriptEdit",function(ScriptModel,PatientService,ConfigService,$cookieStore,$filter,$state,$stateParams,toastr){return{restrict:"EA",templateUrl:"modules/script/directives/templates/edit.html",scope:{options:"=",success:"=",id:"=",medicare:"="},controller:function($scope){var getPatientInfo=($cookieStore.get("userInfo").id,function(){PatientService.getP($stateParams.patient_id).then(function(response){$scope.patientData.info=response.data[0]},function(error){})});$scope.patientData={info:{},getPatientInfo:function(){getPatientInfo()}};var loadInfo=function(){ScriptModel.byid($scope.id).then(function(response){response.data.doctordate=moment(response.data.doctordate).format("DD/MM/YYYY"),response.data.patientDate=moment(response.data.patientDate).format("DD/MM/YYYY"),$scope.scriptData.info=response.data,$scope.medicare&&($scope.scriptData.info.medicare=angular.copy($scope.medicare),ScriptModel.listMedicationInScript($scope.id).then(function(data){if("success"==data.status){var medicareInScript=[];_.forEach(data.data,function(item){medicareInScript[item.id_medicare]=item.id_medicare}),_.forEach($scope.scriptData.info.medicare,function(item){medicareInScript[item.id]&&(item.Checked=1)})}}))},function(error){})},saveScript=function(){ConfigService.beforeSave($scope.scriptData.errors),$scope.scriptData.errors=[],console.log("$scope.scriptData.info",$scope.scriptData.info),ScriptModel.add($scope.scriptData.info).then(function(response){toastr.success("Edited Successfully"),"success"==data.status&&$scope.success&&$scope.success.runWhenFinish()},function(error){$scope.scriptData.errors=angular.copy(error.data.errors),ConfigService.beforeError($scope.scriptData.errors)})};$scope.scriptData={saveScript:function(){saveScript()},errors:[],loadInfo:function(){loadInfo()},info:{ID:$scope.id,Patient_id:$stateParams.patient_id,CAL_ID:$stateParams.cal_id,prescriber:"",scriptNum:0,isRefNo:0,EntitlementNo:"",isSafety:0,isConcessional:0,isPBS:0,isRPBS:0,isBrand:0,pharmacist:"",doctorSign:"",doctordate:"",patientSign:"",patientDate:"",medicare:[]}},$scope.patientData.getPatientInfo(),$scope.scriptData.loadInfo()}}}),angular.module("app.security",["app.security.controller","app.security.services","app.webpatient.controller"]).config(function($stateProvider){$stateProvider.state("security",{"abstract":!1,views:{root:{templateUrl:"modules/security/views/structure.html",controller:"SecurityController"}}}).state("security.login",{url:"/login",views:{"main-content":{templateUrl:"modules/security/views/login.html",controller:"SecurityLoginController"}}}).state("security.forgot",{url:"/forgot",views:{"main-content":{templateUrl:"modules/security/views/forgot.html",controller:"SecurityForgotController"}}}).state("security.term",{url:"/terms",views:{"main-content":{templateUrl:"modules/security/views/terms.html",controller:"SecurityTermsController"}}}).state("security.rlobRegister",{url:"/rlob-register",views:{"main-content":{templateUrl:"/modules/rediLegalOnlineBooking/views/register.html",controller:"rlobRegisterController"}}}).state("security.rlobSponsor",{url:"/rlob-sponsor",views:{"main-content":{templateUrl:"/modules/rediLegalOnlineBooking/views/mobile/sponsor1.html",controller:"rlobSponsor1Controller"}}}).state("security.rlobSponsor.emergency",{url:"/emergency",templateUrl:"/modules/rediLegalOnlineBooking/views/mobile/emergency.html",controller:"rlobEmergencyController"}).state("security.rlobSponsor.nonemergency",{url:"/nonemergency",templateUrl:"/modules/rediLegalOnlineBooking/views/mobile/nonemergency.html",controller:"rlobNonEmergencyController"}).state("security.redirect",{url:"/redirect/:userId/:patient_id",views:{"main-content":{template:"<div> Waitting </div>",controller:"SecurityRedirectController"}}}).state("security.portalPatient",{url:"/portal-patient",views:{"main-content":{templateUrl:"/modules/security/views/portal-patient.html"}}}).state("webpatient",{"abstract":!1,views:{root:{templateUrl:"modules/security/views/web-patient.html",controller:"WebPatientController"}}}).state("webpatient.checkin",{url:"/portal-patient/web-checkin",templateUrl:"/modules/patient/views/web-checkin.html",controller:"PatientCheckinController"}).state("webpatient.register",{url:"/portal-patient/register",templateUrl:"/modules/patient/views/patient-register.html"}).state("webpatient.booking",{url:"/portal-patient/booking",templateUrl:"/modules/rediLegalOnlineBooking/views/mobile/patient-booking.html"})}),angular.module("app.security.services",[]).factory("SecurityService",function(Restangular){var securityService={},securityApi=Restangular.all("api"),restfulApi=Restangular.all("api/restful");return securityService.getSocket=function(socket){return restfulApi.one("User").get({SOCKET:socket})},securityService.login=function(options){var loginApi=securityApi.all("users/login");return loginApi.post(options)},securityService.company=function(){var companyList=securityApi.one("company/list");return companyList.get()},securityService.regNewUser=function(user){var userList=securityApi.all("users/insert");return userList.post({user:user,isReg:!0})},securityService.checkEmail=function(email){var emailCheck=securityApi.one("users/checkEmail");return emailCheck.get({email:email})},securityService.checkUserName=function(username){var usernameCheck=securityApi.one("users/checkUser");return usernameCheck.get({user_name:username})},securityService.forgotPass=function(email){var forgotMail=securityApi.one("users/forgotPassword");return forgotMail.get({email:email})},securityService}),angular.module("app.security.controller",["app.security.login.controller","app.security.forgot.controller","app.security.register.controller","app.security.redirect.controller","app.security.terms.controller"]).controller("SecurityController",function($scope){$scope.modelUser={username:"",password:"",remember:!1,isAgree:!1}}),angular.module("app.webpatient.controller",[]).controller("WebPatientController",function($scope,ConfigService,$state){$scope.modelObject={Title:"Mr",First_name:"",Sur_name:"",Middle_name:"",Known_as:"",Address1:"",Address2:"",Post_code:null,Country:"AU",DOB:"",Sex:"Male",Home_phone:null,Work_phone:null,Mobile:null,No_SMS:"0",Account_type:"",Account_holder:"",Account_Seft:null,Medicare_no:null,Ref:null,Exp_medicare:"",Private_fund_id:"",MemberShip_no:null,UPI:null,HCC_Pension_No:null,Exp_pension:"",DVA_No:null,Balance:null,Pays_Gap_Only:"1",Email:"",Suburb:"",Alias_First_name:"",Alias_Sur_name:"",Phone_ext:null},$scope.options={};var loadOptionsApi=function(){ConfigService.countries_option().then(function(response){"success"===response.status&&($scope.options.countries=response.data)}),ConfigService.title_option().then(function(response){"success"===response.status&&($scope.options.titles=response.data)}),ConfigService.account_type_option().then(function(response){"success"===response.status&&($scope.options.account_types=response.list)}),ConfigService.private_type_option().then(function(response){"success"===response.status&&($scope.options.private_types=response.list)})};loadOptionsApi(),$scope.params={permission:{create:!0,edit:!1}},$scope.patientInfoCalendar={},$scope.actionCenter={runWhenFinish:function(patienInfo){patienInfo&&($scope.patientInfoCalendar=patienInfo,console.log($scope.patientInfoCalendar),$state.go("webpatient.booking"),console.log(patienInfo))}}}),angular.module("app.security.login.controller",[]).controller("SecurityLoginController",function($http,$scope,$state,$modal,$cookieStore,localStorageService,SecurityService,toastr,UserService,ConfigService,DoctorService,socket){$scope.showClickedValidation=!1,$scope.isLogging=!1,$scope.modelUser={username:null,password:null,isRemember:!1},socket.removeAllListeners(),$scope.login=function(){$scope.showClickedValidation=!0,$scope.loginForm.$invalid?toastr.error("Please Input Your Username And Password!","Error"):SecurityService.login($scope.modelUser).then(function(response){if("success"==response.status.toLowerCase()){if("undefined"!=typeof response.userInfo){socket.emit("updateSocketLogin",response.userInfo.id),$cookieStore.put("userInfo",response.userInfo),$cookieStore.put("isRemember",$scope.modelUser.isRemember),"undefined"!=typeof response.companyInfo&&$cookieStore.put("companyInfo",response.companyInfo),$cookieStore.put("token",response.token);var gotoFunction=function(){null!=response.userInfo.function_id?UserService.getFunction(response.userInfo.function_id).then(function(data){if("undefined"!=typeof data.definition){var rs=data.definition.split("(");if(null!=rs[0])if(null!=rs[1]){var r=rs[1].split(")"),params=eval("("+r[0]+")");$state.go(rs[0],params,{location:"replace",reload:!0})}else $state.go(rs[0],{location:"replace",reload:!0})}else $state.go("loggedIn.home",null,{location:"replace",reload:!0})}):$state.go("loggedIn.home",null,{location:"replace",reload:!0})};"Doctor"==response.userInfo.UserType.user_type?DoctorService.getByUserId(response.userInfo.id).then(function(data){data&&$cookieStore.put("doctorInfo",{doctor_id:data.doctor_id,NAME:data.NAME,Provider_no:data.Provider_no,CLINICAL_DEPT_ID:data.CLINICAL_DEPT_ID}),gotoFunction()},function(err){gotoFunction()}):gotoFunction()}}else toastr.error(response.message),response.check&&socket.emit("forceLogin",$scope.modelUser.username)})}}).controller("ConfirmLoginController",function($scope,$filter,$state,$modalInstance,SecurityService,UserService,toastr,socket){$scope.acceptLogin=!1,$scope.cancelLogin=function(){$scope.acceptLogin=!1,$modalInstance.close($scope.acceptLogin)},$scope.acceptLogin=function(){$scope.acceptLogin=!0,$modalInstance.close($scope.acceptLogin)}}),angular.module("app.security.terms.controller",[]).controller("SecurityTermsController",function($scope,$cookieStore,$state){var from=$cookieStore.get("fromState"),params={};console.log(from),$scope.changeState=function(){$state.go(from.fromState.name,params,{location:"replace",reload:!1})}}),angular.module("app.security.forgot.controller",[]).controller("SecurityForgotController",function($scope,toastr,$state,SecurityService){$scope.forgotPass=function(){$scope.showClickedValidation=!0,$scope.forgetForm.$invalid?toastr.error("Please input email.","Error"):SecurityService.forgotPass($scope.email).then(function(data){"success"==data.status?(toastr.success("Change Password Success","Success"),$state.go("loggedIn.home")):toastr.error("Change Password Fail","Fail")},function(err){toastr.error("Change Password Fail","Fail")})}}),angular.module("app.security.register.controller",[]).controller("SecurityRegisterController",function($scope,$state,$cookieStore,SecurityService,toastr){$scope.register=function(){var checkmail="",checkuser="";$scope.showClickedValidation=!0,$scope.registerForm.$invalid?toastr.error("Please check form.","Error"):SecurityService.checkEmail($scope.user.email).then(function(data){checkmail=data}).then(function(){checkmail.length>0?(console.log(checkmail.length),$scope.showClickedValidation=!0,toastr.error("Email da Ton Tai","Error"),$scope.check=!0):SecurityService.checkUserName($scope.user.username).then(function(data){checkuser=data}).then(function(){if(checkuser.length>0)console.log(checkuser),$scope.showClickedValidation=!0,toastr.error("Username da Ton Tai","Error");else{var user={Booking_Person:$scope.user.fname+$scope.user.lname,Contact_email:$scope.user.email,user_name:$scope.user.username,password:$scope.user.password,Contact_number:$scope.user.phone,company_id:$scope.user.companyId};console.log(user),SecurityService.regNewUser(user).then(function(data){console.log(data),toastr.success("Register Success!","Success"),$state.go("loggedIn.home")})}})})},$scope.companyList=[],SecurityService.company().then(function(response){$scope.companyList=response})}),angular.module("app.security.redirect.controller",[]).controller("SecurityRedirectController",function($scope,$state,$location,socket,$stateParams,$location,$cookieStore,SecurityService,UserService){var userId=$stateParams.userId,patient_id=$stateParams.patient_id;UserService.getUserInfo(userId).then(function(data){data&&(delete data.img,$cookieStore.put("userInfo",data),socket.emit("mobileConnect",data.id),$state.go("loggedIn.patient.appointment",{cal_id:0,patient_id:patient_id}))})}),angular.module("app.lockscreen.controller",[]).controller("lockscreenController",function($scope,$rootScope,$state,$cookieStore,SecurityService,UserService,toastr,$window,socket,$location,$rootScope){var userInfo,from=$cookieStore.get("fromState"),isLocking=!0,params={};$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){console.log("this is state change to",toState),isLocking===!0&&("security.login"!==toState.name&&"call"!==toState.name?(event.preventDefault(),toastr.error("Please provide your password to unlock the system!","Password required!")):isLocking=!1)}),(null!=from.fromParams||"undefined"!=typeof from.fromParams)&&angular.forEach(from.fromParams,function(value,key){params[key]=value}),null==$cookieStore.get("userInfo")||"undefined"==typeof $cookieStore.get("userInfo")?$state.go("security.login"):userInfo=$cookieStore.get("userInfo"),$scope.modelUser={username:userInfo.user_name,password:null},UserService.getUserInfo(userInfo.id).then(function(data){$scope.img=data.img}),$scope.name=userInfo.Booking_Person,$scope.email=userInfo.Contact_email,$scope.notUser=function(){socket.emit("logout",$cookieStore.get("userInfo").user_name,$cookieStore.get("userInfo").id,$cookieStore.get("userInfo").UserType.user_type),$cookieStore.remove("userInfo"),$cookieStore.remove("companyInfo"),$cookieStore.remove("doctorInfo"),$state.go("security.login",null,{location:"replace",reload:!0}),socket.removeAllListeners()},$scope.returnHome=function(lockForm){$scope.showClickedValidation=!0,lockForm.$invalid?toastr.error("Please Check Your Password!","Error"):(SecurityService.login($scope.modelUser).then(function(response){console.log(response),null!=response&&"success"==response.status?(isLocking=!1,$state.go(from.fromState.name,params,{location:"replace",reload:!0})):toastr.error("Wrong Username Or Password!","Error")}),function(error){toastr.error("Wrong Username Or Password!","Error")})}}),angular.module("app.loggedIn.syscountry",["app.loggedIn.syscountry.directives","app.loggedIn.syscountry.services"]),angular.module("app.loggedIn.syscountry.services",[]).factory("sysCountryService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/syscountry/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.syscountry.directives",["app.loggedIn.syscountry.detail.directive","app.loggedIn.syscountry.search.directive"]),angular.module("app.loggedIn.syscountry.detail.directive",[]).directive("syscountryDetail",function(sysCountryModel,ConfigService,sysCountryService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/syscountry/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&sysCountryService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.sysCountryMap,response.data);for(var key in scope.sysCountryMap)scope.sysCountryMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.sysCountryMap[key]=scope.sysCountryMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.sysCountryMap[key]=new Date(scope.sysCountryMap[key])))}),scope.sysCountryMap=angular.copy(sysCountryModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.syscountryForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.sysCountryMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?sysCountryService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(sysCountryService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.syscountry.search.directive",[]).directive("syscountrySearch",function(sysCountryService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/syscountry/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"Country_name",value:""},{type:"text",name:"Isenable",value:""},{type:"text",name:"Created_by",value:""}],select:["Country_name","Isenable","Created_by"]}},loadList=function(){sysCountryService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),
scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.sysqualification",["app.loggedIn.sysqualification.directives","app.loggedIn.sysqualification.services"]),angular.module("app.loggedIn.sysqualification.services",[]).factory("sysQualificationService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/sysqualification/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.sysqualification.directives",["app.loggedIn.sysqualification.detail.directive","app.loggedIn.sysqualification.search.directive"]),angular.module("app.loggedIn.sysqualification.detail.directive",[]).directive("sysqualificationDetail",function(sysQualificationModel,ConfigService,sysQualificationService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/sysqualification/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&sysQualificationService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.sysQualificationMap,response.data);for(var key in scope.sysQualificationMap)scope.sysQualificationMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.sysQualificationMap[key]=scope.sysQualificationMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.sysQualificationMap[key]=new Date(scope.sysQualificationMap[key])))}),scope.sysQualificationMap=angular.copy(sysQualificationModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.sysqualificationForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.sysQualificationMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?sysQualificationService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(sysQualificationService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.sysqualification.search.directive",[]).directive("sysqualificationSearch",function(sysQualificationService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/sysqualification/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"name",value:""},{type:"text",name:"Isenable",value:""},{type:"text",name:"Created_by",value:""}],select:["name","Isenable","Created_by"]}},loadList=function(){sysQualificationService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.sysrltypes",["app.loggedIn.sysrltypes.directives","app.loggedIn.sysrltypes.services"]),angular.module("app.loggedIn.sysrltypes.services",[]).factory("sysrlTypesService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/sysrltypes/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.sysrltypes.directives",["app.loggedIn.sysrltypes.detail.directive","app.loggedIn.sysrltypes.search.directive"]),angular.module("app.loggedIn.sysrltypes.detail.directive",[]).directive("sysrltypesDetail",function(sysrlTypesModel,ConfigService,sysrlTypesService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/sysrltypes/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&sysrlTypesService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.sysrlTypesMap,response.data);for(var key in scope.sysrlTypesMap)scope.sysrlTypesMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.sysrlTypesMap[key]=scope.sysrlTypesMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.sysrlTypesMap[key]=new Date(scope.sysrlTypesMap[key])))}),scope.sysrlTypesMap=angular.copy(sysrlTypesModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.sysrltypesForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.sysrlTypesMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?sysrlTypesService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(sysrlTypesService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.sysrltypes.search.directive",[]).directive("sysrltypesSearch",function(sysrlTypesService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/sysrltypes/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"Rl_TYPE_NAME",value:""},{type:"text",name:"ISENABLE",value:""},{type:"text",name:"Created_by",value:""}],select:["Rl_TYPE_NAME","ISENABLE","Created_by"]}},loadList=function(){sysrlTypesService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.sysservice",["app.loggedIn.sysservice.directives","app.loggedIn.sysservice.services"]),angular.module("app.loggedIn.sysservice.services",[]).factory("sysServiceService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/sysservice/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService.byClinicalDepartment=function(dept_id){var funcApi=mdtApi.all("byClinicalDepartment");return funcApi.post({dept_id:dept_id})},mdtService}),angular.module("app.loggedIn.sysservice.directives",["app.loggedIn.sysservice.detail.directive","app.loggedIn.sysservice.search.directive"]),angular.module("app.loggedIn.sysservice.detail.directive",[]).directive("sysserviceDetail",function(sysServiceModel,ConfigService,sysServiceService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/sysservice/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&sysServiceService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.sysServiceMap,response.data);for(var key in scope.sysServiceMap)scope.sysServiceMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.sysServiceMap[key]=scope.sysServiceMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.sysServiceMap[key]=new Date(scope.sysServiceMap[key])))}),scope.sysServiceMap=angular.copy(sysServiceModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.sysserviceForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.sysServiceMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?sysServiceService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(sysServiceService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.sysservice.search.directive",[]).directive("sysserviceSearch",function(sysServiceService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/sysservice/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"SERVICE_NAME",value:""},{type:"text",name:"DESCRIPTION",value:""},{type:"text",name:"Isenable",value:""}],select:["SERVICE_NAME","DESCRIPTION","Isenable"]}},loadList=function(){sysServiceService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.sysservices",["app.loggedIn.sysservices.directives","app.loggedIn.sysservices.services","app.loggedIn.sysservices.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.sysservices",{"abstract":!0,templateUrl:"modules/sysservices/views/structure.html",controller:"SysServicesController"}).state("loggedIn.sysservices.list",{url:"/services",views:{"main-content":{templateUrl:"modules/sysservices/views/serviceslist.html",controller:"SysServicesListController"}}}).state("loggedIn.sysservices.add",{url:"/services/add",views:{"main-content":{templateUrl:"modules/sysservices/views/serviceadd.html",controller:"SysServicesAddController"}}})}),angular.module("app.loggedIn.sysservices.services",[]).factory("SysServicesService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/sysservices/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.sysservices.directives",["app.loggedIn.sysservices.detail.directive","app.loggedIn.sysservices.search.directive"]),angular.module("app.loggedIn.sysservices.detail.directive",[]).directive("sysservicesDetail",function($cookieStore,SysServicesModel,ConfigService,SysServicesService,toastr){return{restrict:"EA",scope:{options:"=",params:"=",isAction:"="},templateUrl:"modules/sysservices/directives/templates/detail.html",link:function(scope,element,attrs){scope.$watch("params.permission",function(){scope.params.permission.edit===!0&&(console.log("changed"),init())});var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&SysServicesService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.SysServicesMap,response.data);for(var key in scope.SysServicesMap)scope.SysServicesMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.SysServicesMap[key]=scope.SysServicesMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.SysServicesMap[key]=new Date(scope.SysServicesMap[key])))}),scope.SysServicesMap=angular.copy(SysServicesModel)};init(),scope.cancelUpdate=function(){scope.SysServicesMap={},scope.params.permission.edit=!1,scope.params.permission.create=!0},scope.clickAction=function(){if(scope.isSubmit=!0,scope.sysservicesForm.$invalid)toastr.error("You got some fields left","Error");else{var uID=$cookieStore.get("userInfo").id,postData=angular.copy(scope.SysServicesMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?(postData.Last_updated_by=uID,console.log(postData),SysServicesService.edit(scope.params.id,postData).then(function(response){"error"==response.status?toastr.error("Error Get Detail","Error"):(toastr.success("Edit Successfully !!!","Success"),scope.isAction="edit",scope.SysServicesMap={},scope.params.permission.edit=!1,scope.params.permission.create=!0,init())})):(postData.Created_by=uID,SysServicesService.add(postData).then(function(data){"error"==data.status?toastr.error("Cannot Insert","Error"):(toastr.success("Insert Successfully !!!","Success"),scope.isAction="add",init())}),init())}}}}}),angular.module("app.loggedIn.sysservices.search.directive",[]).directive("sysservicesSearch",function(SysServicesService,toastr){return{restrict:"EA",scope:{clickRow:"&",isLoad:"="},templateUrl:"modules/sysservices/directives/templates/search.html",link:function(scope,element,attrs){scope.$watch("isLoad",function(newIsLoad){console.log("changed"),newIsLoad===!0&&(init(),loadList(),scope.isLoad=!1)});var init=function(){scope.list={},scope.params={pagination:{limit:100,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"SERVICE_NAME",value:""},{type:"text",name:"DESCRIPTION",value:""},{type:"text",name:"SERVICE_COLOR",value:""}],select:["SERVICE_ID","FEE_TYPE_ID","SERVICE_NAME","DESCRIPTION","SERVICE_COLOR","IS_REFERRAL","Isenable","IS_BOOKABLE"]}},loadList=function(){SysServicesService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.sysservices.controller",["app.loggedIn.sysservices.list.controller"]).controller("SysServicesController",function($scope,toastr){}),angular.module("app.loggedIn.sysservices.list.controller",[]).controller("SysServicesListController",function($scope,localStorageService){$scope.params={permission:{create:!0,edit:!1}},$scope.isAction="",$scope.isLoad=!1,$scope.$watch("isAction",function(newAction){console.log("isActionChnaged"),"add"===newAction&&($scope.isLoad=!0,$scope.isAction=""),"edit"===newAction&&($scope.isLoad=!0,$scope.isAction="")}),$scope.getRow=function(row){$scope.params={permission:{create:!1,edit:!0},id:row.SERVICE_ID}}}),angular.module("app.loggedIn.sysstate",["app.loggedIn.sysstate.directives","app.loggedIn.sysstate.services"]),angular.module("app.loggedIn.sysstate.services",[]).factory("sysStateService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/sysstate/");return mdtService.list=function(country_name){var funcApi=mdtApi.all("list");return funcApi.post({country_name:country_name})},mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.sysstate.directives",["app.loggedIn.sysstate.detail.directive","app.loggedIn.sysstate.search.directive"]),angular.module("app.loggedIn.sysstate.detail.directive",[]).directive("sysstateDetail",function(sysStateModel,ConfigService,sysStateService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/sysstate/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&sysStateService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.sysStateMap,response.data);for(var key in scope.sysStateMap)scope.sysStateMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.sysStateMap[key]=scope.sysStateMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.sysStateMap[key]=new Date(scope.sysStateMap[key])))}),scope.sysStateMap=angular.copy(sysStateModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.sysstateForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.sysStateMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?sysStateService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(sysStateService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.sysstate.search.directive",[]).directive("sysstateSearch",function(sysStateService,toastr){return{restrict:"EA",scope:{clickRow:"&"},templateUrl:"modules/sysstate/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"State",value:""},{type:"text",name:"Country_name",value:""},{type:"text",name:"Isenable",value:""}],select:["State","Country_name","Isenable"]}},loadList=function(){sysStateService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.systitle",["app.loggedIn.systitle.directives","app.loggedIn.systitle.services"]),angular.module("app.loggedIn.systitle.services",[]).factory("sysTitleService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/systitle/");return mdtService.add=function(postData){var funcApi=mdtApi.all("add");return funcApi.post({add_data:postData})},mdtService.edit=function(id,postData){var funcApi=mdtApi.all("edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.byId=function(id){var funcApi=mdtApi.all("byId");return funcApi.post({detail_id:id})},mdtService.search=function(option){var funcApi=mdtApi.all("search");return funcApi.post(option)},mdtService}),angular.module("app.loggedIn.systitle.directives",["app.loggedIn.systitle.detail.directive","app.loggedIn.systitle.search.directive"]),angular.module("app.loggedIn.systitle.detail.directive",[]).directive("systitleDetail",function(sysTitleModel,ConfigService,sysTitleService,toastr){return{restrict:"EA",scope:{options:"=",params:"="},templateUrl:"modules/systitle/directives/templates/detail.html",link:function(scope,element,attrs){var init=function(){scope.isSubmit=!1,scope.params.permission.edit===!0&&sysTitleService.byId(scope.params.id).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),angular.extend(scope.sysTitleMap,response.data);for(var key in scope.sysTitleMap)scope.sysTitleMap[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.sysTitleMap[key]=scope.sysTitleMap[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE"))&&(scope.sysTitleMap[key]=new Date(scope.sysTitleMap[key])))}),scope.sysTitleMap=angular.copy(sysTitleModel)};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.systitleForm.$invalid)toastr.error("You got some fields left","Error");else{var postData=angular.copy(scope.sysTitleMap);for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.permission.edit===!0?sysTitleService.edit(scope.params.id,postData).then(function(response){"error"==response.status&&toastr.error("Error Get Detail","Error"),init(),toastr.success("Edit Successfully !!!","Success")}):(sysTitleService.add(postData).then(function(data){"error"==data.status&&toastr.error("Cannot Insert","Error"),toastr.success("Insert Successfully !!!","Success"),init()}),init())}}}}}),angular.module("app.loggedIn.systitle.search.directive",[]).directive("systitleSearch",function(sysTitleService,toastr){return{restrict:"EA",scope:{clickRow:"="},templateUrl:"modules/systitle/directives/templates/search.html",link:function(scope,element,attrs){var init=function(){scope.list={},scope.params={pagination:{limit:5,offset:0,current_page:1,max_size:3},filters:[{type:"text",name:"name",value:""},{type:"text",name:"Isenable",value:""},{type:"text",name:"Created_by",value:""}],select:["name","Isenable","Created_by"]}},loadList=function(){sysTitleService.search(scope.params).then(function(response){"error"===response.status&&toastr.error("Cannot get Seacrh","Error"),scope.list=response})};init(),loadList(),scope.setPage=function(){scope.params.pagination.offset=(scope.params.pagination.current_page-1)*scope.params.pagination.limit,loadList()}}}}),angular.module("app.loggedIn.telehealth",["app.loggedIn.telehealth.formController","app.loggedIn.telehealth.services"]).config(function($stateProvider){$stateProvider.state("loggedIn.telehealthForm",{url:"/telehealth/form",templateUrl:"modules/telehealth/views/patientForm.html",controller:"TelehealthFormController"})}),angular.module("app.loggedIn.telehealth.formController",[]).controller("TelehealthFormController",function($scope,$rootScope,$http,TelehealthService){var initPickers=function(){$(".date-picker").datepicker({rtl:Metronic.isRTL(),autoclose:!0}).on("changeDate",function(evn){})};initPickers()}),angular.module("app.loggedIn.telehealth.services",[]).factory("TelehealthService",function(Restangular){var telehealthService={};return telehealthService}),angular.module("app.loggedIn.template",["app.loggedIn.template.include"]).config(function($stateProvider){$stateProvider.state("loggedIn.template",{url:"/template",templateUrl:"modules/template/views/list.html",controller:"TemplateListController"}).state("loggedIn.template_add",{url:"/template/add",templateUrl:"modules/template/views/add.html",controller:"TemplateAddController"}).state("loggedIn.template_write",{url:"/template/write/:id",templateUrl:"modules/template/views/write.html",controller:"TemplateWriteController"}).state("loggedIn.template_edit",{url:"/template/edit/:id",templateUrl:"modules/template/views/edit.html",controller:"TemplateEditController"}).state("loggedIn.patient.template",{url:"/template",views:{"main-content":{templateUrl:"modules/template/views/patient_list.html",controller:"TemplatePatientListController"}}}).state("loggedIn.patient.template_add",{url:"/template/add",views:{"main-content":{templateUrl:"modules/template/views/patient_add.html",controller:"TemplatePatientAddController"}}})}),angular.module("app.loggedIn.template.include",["app.loggedIn.template.controllers.list","app.loggedIn.template.controllers.patient_list","app.loggedIn.template.controllers.patient_add","app.loggedIn.template.controllers.add","app.loggedIn.template.controllers.edit","app.loggedIn.template.controllers.write","app.loggedIn.template.model","app.loggedIn.template.directives.list","app.loggedIn.template.directives.patient_list","app.loggedIn.template.directives.patient_write","app.loggedIn.template.directives.patient_add","app.loggedIn.template.directives.patient_edit","app.loggedIn.template.directives.add","app.loggedIn.template.directives.edit","app.loggedIn.template.directives.write"]),angular.module("app.loggedIn.template.model",[]).factory("TemplateModel",function(Restangular,$http){var instanceService={},appApi=Restangular.all("api/meditek/v1/template");return instanceService.add=function(data){var detailApi=appApi.all("add");return detailApi.post({data:data})},instanceService.update=function(data){var detailApi=appApi.all("update");return detailApi.post({data:data})},instanceService.list=function(data){var detailApi=appApi.all("list");return detailApi.post({data:data})},instanceService.one=function(data){var detailApi=appApi.all("one");return detailApi.post({data:data})},instanceService["delete"]=function(data){var detailApi=appApi.all("delete");return detailApi.post({data:data})},instanceService.write=function(data){var detailApi=appApi.all("write");return detailApi.post({data:data})},instanceService.download=function(data){return"http://testapp.redimed.com.au:3003/RedimedJavaREST/api/document/template/"+data.id},instanceService}),angular.module("app.loggedIn.template.controllers.list",[]).controller("TemplateListController",function($scope,$modal,toastr){}),angular.module("app.loggedIn.template.directives.list",[]).directive("templateList",function($modal,$http,$state,$cookieStore,TemplateModel,toastr,PatientService){return{restrict:"EA",scope:{limit:"=",reload:"="},templateUrl:"modules/template/directives/templates/list.html",link:function(scope,elem,attrs){scope.removeList=function(list){var modalInstance=$modal.open({templateUrl:"removeTemplate",controller:function($scope,$modalInstance){$scope.clickNo=function(){$modalInstance.dismiss("cancel")},$scope.clickYes=function(){$modalInstance.close("success")}}});modalInstance.result.then(function(response){response&&TemplateModel["delete"]({id:list.id}).then(function(){load()})})},scope.goToAdd=function(){$state.go("loggedIn.template_add")},scope.goToWrite=function(list){$state.go("loggedIn.template_write",{id:list.id})},scope.goToEdit=function(list){$state.go("loggedIn.template_edit",{id:list.id})};var load=function(){TemplateModel.list({}).then(function(response){scope.template.list=response.data},function(error){})};scope.template={list:[]},load()}}}),angular.module("app.loggedIn.template.controllers.patient_list",[]).controller("TemplatePatientListController",function($scope,$modal,toastr){}),angular.module("app.loggedIn.template.directives.patient_list",[]).directive("templatePatientList",function($modal,$modal,$state,$cookieStore,TemplateModel,toastr,PatientService){return{restrict:"EA",scope:{patientId:"=",calId:"=",success:"="},templateUrl:"modules/template/directives/templates/patient_list.html",link:function(scope,elem,attrs){scope.goToWrite=function(list){var modalInstance=$modal.open({templateUrl:"writeTemplateDialog",size:"lg",controller:function($scope,$modalInstance,patientId,calId){$scope.patient_id=patientId,$scope.cal_id=calId,$scope.success=null,$scope.template_id=list.id,$scope.$watch("success",function(success){success&&$modalInstance.close(success)})},resolve:{patientId:function(){return scope.patientId},calId:function(){return scope.calId}}});modalInstance.result.then(function(result){console.log(result),scope.success=result})},scope.goToEdit=function(list){var modalInstance=$modal.open({templateUrl:"editTemplateDialog",size:"lg",controller:function($scope,$modalInstance,patientId,calId){$scope.patient_id=patientId,$scope.cal_id=calId,$scope.success=!1,$scope.template_id=list.id,$scope.$watch("success",function(success){success&&$modalInstance.close("success")})},resolve:{patientId:function(){return scope.patientId},calId:function(){return scope.calId}}});modalInstance.result.then(function(result){"success"===result&&load()})},scope.goToAdd=function(){var modalInstance=$modal.open({templateUrl:"addTemplateDialog",size:"lg",controller:function($scope,$modalInstance,patientId,calId){$scope.patient_id=patientId,$scope.cal_id=calId,$scope.success=!1,$scope.$watch("success",function(success){success&&$modalInstance.close("success")})},resolve:{patientId:function(){return scope.patientId},calId:function(){return scope.calId}}});modalInstance.result.then(function(result){"success"===result&&load()})},scope.removeList=function(list){var modalInstance=$modal.open({templateUrl:"removeTemplate",controller:function($scope,$modalInstance){$scope.clickNo=function(){$modalInstance.dismiss("cancel")},$scope.clickYes=function(){$modalInstance.close("success")}}});modalInstance.result.then(function(response){response&&TemplateModel["delete"]({id:list.id}).then(function(){load()})})};var load=function(){TemplateModel.list({}).then(function(response){scope.template.list=response.data},function(error){})};scope.template={list:[]},load()}}}),angular.module("app.loggedIn.template.controllers.patient_add",[]).controller("TemplatePatientAddController",function($scope,$modal,toastr){}),angular.module("app.loggedIn.template.directives.patient_add",[]).directive("templatePatientAdd",function($modal,$cookieStore,$state,TemplateModel,toastr,PatientService){return{restrict:"EA",scope:{patientId:"=",calId:"=",success:"="},templateUrl:"modules/template/directives/templates/patient_add.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,patientLoad=function(patient_id){PatientService.get(patient_id).then(function(response){scope.patient.one=response.data},function(error){})};scope.patient={one:null,load:function(patient_id){patientLoad(patient_id)}},scope.$watch("patientId",function(patientId){"undefined"!=typeof patientId&&scope.patient.load(patientId)});var element=$("#editor");element.wysiwyg({toolbar:"top",buttons:{bold:{title:"Bold (Ctrl+B)",image:"",hotkey:"b"},italic:{title:"Italic (Ctrl+I)",image:"",hotkey:"i"},underline:{title:"Underline (Ctrl+U)",image:"",hotkey:"u"},insertimage:{title:"Insert image",image:"",showselection:!0},fontsize:{title:"Size",image:"",popup:function($popup,$button){for(var list_fontsizes=[],i=8;11>=i;++i)list_fontsizes.push(i+"px");for(var i=12;28>=i;i+=2)list_fontsizes.push(i+"px");list_fontsizes.push("36px"),list_fontsizes.push("48px"),list_fontsizes.push("72px");var $list=$("<div/>").addClass("wysiwyg-plugin-list").attr("unselectable","on");$.each(list_fontsizes,function(index,size){var $link=$("<a/>").attr("href","#").html(size).click(function(event){return $(element).wysiwyg("shell").fontSize(7).closePopup(),$(element).wysiwyg("container").find("font[size=7]").removeAttr("size").css("font-size",size),
event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$popup.append($list)}},fontname:{title:"Font",image:"",popup:function($popup,$button){var list_fontnames={"Arial, Helvetica":"Arial,Helvetica",Verdana:"Verdana,Geneva",Georgia:"Georgia","Courier New":"Courier New,Courier","Times New Roman":"Times New Roman,Times"},$list=$("<div/>").addClass("wysiwyg-plugin-list").attr("unselectable","on");$.each(list_fontnames,function(name,font){var $link=$("<a/>").attr("href","#").css("font-family",font).html(name).click(function(event){return $(element).wysiwyg("shell").fontName(font).closePopup(),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$popup.append($list)},showselection:!1},strikethrough:{title:"Strikethrough (Ctrl+S)",image:"",hotkey:"s"},forecolor:{title:"Text color",image:""},highlight:{title:"Background color",image:""},alignleft:{title:"Left",image:"",showselection:!1},aligncenter:{title:"Center",image:"",showselection:!1},alignright:{title:"Right",image:"",showselection:!1},alignjustify:{title:"Justify",image:"",showselection:!1},subscript:{title:"Subscript",image:"",showselection:!0},superscript:{title:"Superscript",image:"",showselection:!0},indent:{title:"Indent",image:"",showselection:!1},outdent:{title:"Outdent",image:"",showselection:!1},orderedList:{title:"Ordered list",image:"",showselection:!1},unorderedList:{title:"Unordered list",image:"",showselection:!1},removeformat:{title:"Remove format",image:""}},selectImage:"Click or drop image",placeholderUrl:"http://sasa",maxImageSize:[600,200],forceImageUpload:!1,submit:{title:"Submit",image:""},onAutocomplete:function(tyed,key,character,shiftKey,altKey,ctrlKey,metaKey){if(0==tyed.indexOf("<")){var fields={First_name:"First_name",Sur_name:"Sur_name",Middle_name:"Middle_name",Address1:"Address1",Surburb:"Surburb",Post_code:"Post_code",Home_phone:"Home_phone",Work_phone:"Work_phone",Mobile:"Mobile",Phone_ext:"Phone_ext",Medicare_no:"Medicare_no",Ref:"Ref",Exp_medicare:"Exp_medicare"},field_r=[];for(var key in fields)field_r.push(key);var $list=$("<div/>").addClass("wysiwyg-plugin-list").attr("unselectable","on");if($.each(fields,function(index,field){var $link=$("<a/>").attr("href","javascript:void(0)").text(field).click(function(event){var html="."+field,editor=$(element).wysiwyg("shell");return editor.expandSelection(tyed.length,0).insertHTML(html),editor.closePopup().getElement().focus(),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$list.children().length){if(13==key)return $list.children(":first").click(),!1;if(character||8==key)return $list}}}}),scope.form={name:null},scope.save=function(){var html=element.wysiwyg("shell").getHTML(),postData={name:scope.form.name,content:html,user_id:user_id};TemplateModel.add(postData).then(function(response){scope.success=!0},function(error){})}}}}),angular.module("app.loggedIn.template.directives.patient_write",[]).directive("templatePatientWrite",function($modal,$window,$cookieStore,$state,$stateParams,$timeout,TemplateModel,toastr,PatientService){return{restrict:"EA",scope:{id:"=",patientId:"=",calId:"=",success:"="},templateUrl:"modules/template/directives/templates/patient_write.html",link:function(scope,elem,attrs){scope.exportPDF=function(){var content=$("#writeTemplate").html();content=content.replace(/&nbsp;&nbsp;/g,"</input>"),content=content.replace(/test/g,"</img>"),content=content.replace(/<br>/g,"<br/>"),console.log("%%%%%%%%%%%%%%%%%%%%%%: ",content),TemplateModel.write({name:scope.template.one.name,content:content}).then(function(response){$window.open(TemplateModel.download({id:response.data.id}))},function(error){})};var patientLoad=function(patient_id){PatientService.getP(patient_id).then(function(response){scope.patient.one=response.data,loadTemplate(scope.id)},function(error){})};scope.patient={one:null,load:function(patient_id){patientLoad(patient_id)}},scope.$watch("patientId",function(patientId){"undefined"!=typeof patientId&&scope.patient.load(patientId)});var loadTemplate=function(id){TemplateModel.one({id:id}).then(function(response){scope.template.one=response.data[0];for(var content=scope.template.one.content,new_content="";-1!==content.indexOf("{#input");){var index_first=content.indexOf("{#input"),index_last=content.indexOf("#}"),string_change=content.substring(index_first+2,index_last),split_string_change=string_change.split("."),new_string_change="";if(1===split_string_change.length)new_string_change='<input class="custom-input-template" value="" placeholder="Please fill in">&nbsp;&nbsp;';else for(var field=split_string_change[1],i=0;i<scope.patient.one.length;i++)for(var key in scope.patient.one[i])if(key===field){new_string_change=scope.patient.one[i][key];break}new_content+=content.substring(0,index_last+2),new_content=new_content.replace("{#"+string_change+"#}",new_string_change),content=content.substring(index_last+2,content.length)}new_content+=content,$("#writeTemplate").html(new_content),$(".custom-input-template").on("input",function(e){$(this).attr("size",e.target.value.length),$(this).attr("value",e.target.value)})})};scope.template={one:null},scope.patient.load()}}}),angular.module("app.loggedIn.template.directives.patient_edit",[]).directive("templatePatientEdit",function($modal,$cookieStore,$state,$stateParams,TemplateModel,toastr,PatientService){return{restrict:"EA",scope:{id:"=",patientId:"=",calId:"=",success:"="},templateUrl:"modules/template/directives/templates/patient_edit.html",link:function(scope,elem,attrs){var patientLoad=($cookieStore.get("userInfo").id,function(patient_id){PatientService.get(patient_id).then(function(response){scope.patient.one=response.data},function(error){})});scope.patient={one:null,load:function(patient_id){patientLoad(patient_id)}},scope.$watch("patientId",function(patientId){"undefined"!=typeof patientId&&scope.patient.load(patientId)});var element=$("#editor");element.wysiwyg({toolbar:"top",forceImageUpload:!0,onImageUpload:function(insert_image){console.log("###############: ",insert_image)},buttons:{bold:{title:"Bold (Ctrl+B)",image:"",hotkey:"b"},italic:{title:"Italic (Ctrl+I)",image:"",hotkey:"i"},underline:{title:"Underline (Ctrl+U)",image:"",hotkey:"u"},insertimage:{title:"Insert image",image:"",showselection:!0},fontname:{title:"Font",image:"",popup:function($popup,$button){var list_fontnames={"Arial, Helvetica":"Arial,Helvetica",Verdana:"Verdana,Geneva",Georgia:"Georgia","Courier New":"Courier New,Courier","Times New Roman":"Times New Roman,Times"},$list=$("<div/>").addClass("wysiwyg-plugin-list").attr("unselectable","on");$.each(list_fontnames,function(name,font){var $link=$("<a/>").attr("href","#").css("font-family",font).html(name).click(function(event){return $(element).wysiwyg("shell").fontName(font).closePopup(),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$popup.append($list)},showselection:!1},fontsize:{title:"Size",image:"",popup:function($popup,$button){for(var list_fontsizes=[],i=8;11>=i;++i)list_fontsizes.push(i+"px");for(var i=12;28>=i;i+=2)list_fontsizes.push(i+"px");list_fontsizes.push("36px"),list_fontsizes.push("48px"),list_fontsizes.push("72px");var $list=$("<div/>").addClass("wysiwyg-plugin-list").attr("unselectable","on");$.each(list_fontsizes,function(index,size){var $link=$("<a/>").attr("href","#").html(size).click(function(event){return $(element).wysiwyg("shell").fontSize(7).closePopup(),$(element).wysiwyg("container").find("font[size=7]").removeAttr("size").css("font-size",size),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$popup.append($list)}},strikethrough:{title:"Strikethrough (Ctrl+S)",image:"",hotkey:"s"},forecolor:{title:"Text color",image:""},highlight:{title:"Background color",image:""},alignleft:{title:"Left",image:"",showselection:!1},aligncenter:{title:"Center",image:"",showselection:!1},alignright:{title:"Right",image:"",showselection:!1},alignjustify:{title:"Justify",image:"",showselection:!1},subscript:{title:"Subscript",image:"",showselection:!0},superscript:{title:"Superscript",image:"",showselection:!0},indent:{title:"Indent",image:"",showselection:!1},outdent:{title:"Outdent",image:"",showselection:!1},orderedList:{title:"Ordered list",image:"",showselection:!1},unorderedList:{title:"Unordered list",image:"",showselection:!1},removeformat:{title:"Remove format",image:""}},selectImage:"Click or drop image",placeholderUrl:"http://sasa",maxImageSize:[600,200],forceImageUpload:!1,submit:{title:"Submit",image:""},onAutocomplete:function(tyed,key,character,shiftKey,altKey,ctrlKey,metaKey){if(0==tyed.indexOf("<")){var fields={First_name:"First_name",Sur_name:"Sur_name",Middle_name:"Middle_name",Address1:"Address1",Surburb:"Surburb",Post_code:"Post_code",Home_phone:"Home_phone",Work_phone:"Work_phone",Mobile:"Mobile",Phone_ext:"Phone_ext",Medicare_no:"Medicare_no",Ref:"Ref",Exp_medicare:"Exp_medicare"},field_r=[];for(var key in fields)field_r.push(key);var $list=$("<div/>").addClass("wysiwyg-plugin-list").attr("unselectable","on");if($.each(fields,function(index,field){var $link=$("<a/>").attr("href","javascript:void(0)").text(field).click(function(event){var html="."+field,editor=$(element).wysiwyg("shell");return editor.expandSelection(tyed.length,0).insertHTML(html),editor.closePopup().getElement().focus(),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$list.children().length){if(13==key)return $list.children(":first").click(),!1;if(character||8==key)return $list}}}}),scope.form={name:null},scope.save=function(){var html=element.wysiwyg("shell").getHTML(),postData={name:scope.form.name,content:html,id:scope.id};TemplateModel.update(postData).then(function(response){scope.success=!0},function(error){})};var loadTemplate=function(){TemplateModel.one({id:scope.id}).then(function(response){scope.form=response.data[0],element.wysiwyg("shell").setHTML(scope.form.content)})};scope.$watch("id",function(id){"undefined"!=typeof id&&loadTemplate()})}}}),angular.module("app.loggedIn.template.controllers.add",[]).controller("TemplateAddController",function($scope,$modal,toastr){}),angular.module("app.loggedIn.template.directives.add",[]).directive("templateAdd",function($modal,$cookieStore,$state,TemplateModel,toastr){return{restrict:"EA",scope:{},templateUrl:"modules/template/directives/templates/add.html",link:function(scope,elem,attrs){var user_id=$cookieStore.get("userInfo").id,quill=new Quill("#editor",{modules:{authorship:{authorId:"advanced",enabled:!0},"link-tooltip":!0,"image-tooltip":!0,"multi-cursor":!0},theme:"snow"});quill.addModule("toolbar",{container:"#toolbar"}),scope.form={name:null},scope.save=function(){var html=quill.getHTML(),postData={name:scope.form.name,content:html,user_id:user_id};TemplateModel.add(postData).then(function(response){$state.go("loggedIn.template")},function(error){})}}}}),angular.module("app.loggedIn.template.controllers.write",[]).controller("TemplateWriteController",function($scope,$modal,toastr){}),angular.module("app.loggedIn.template.directives.write",[]).directive("templateWrite",function($modal,$cookieStore,$state,$stateParams,$timeout,TemplateModel,toastr,PatientService){return{restrict:"EA",scope:{},templateUrl:"modules/template/directives/templates/write.html",link:function(scope,elem,attrs){scope.savePDF=function(){var doc=new jsPDF;doc.fromHTML($("#writeTemplate").get(0),15,15,{width:170}),doc.save("test.pdf")};var patientLoad=function(patient_id){PatientService.getP(patient_id).then(function(response){scope.patient.one=response.data,loadTemplate(),console.log("**************** ",scope.patient.one)},function(error){})};if(scope.patient={one:null,load:function(patient_id){patientLoad(patient_id)}},$cookieStore.get("template_patient_id")){var patient_id=$cookieStore.get("template_patient_id");scope.patient.load(patient_id)}var loadTemplate=function(){console.log("%%%%%%%%%%%%%%%%% ",scope.patient.one),TemplateModel.one({id:$stateParams.id}).then(function(response){scope.template.one=response.data[0];for(var content=scope.template.one.content,new_content="";-1!==content.indexOf("{#input");){var index_first=content.indexOf("{#input"),index_last=content.indexOf("#}"),string_change=content.substring(index_first+2,index_last),split_string_change=string_change.split("."),new_string_change="";if(1===split_string_change.length)new_string_change='<input class="custom-input-template" placeholder="Please fill in"/>';else{var field=split_string_change[1];for(var key in scope.patient.one)if(key===field){new_string_change=scope.patient.one[key];break}}new_content+=content.substring(0,index_last+2),new_content=new_content.replace("{#"+string_change+"#}",new_string_change),content=content.substring(index_last+2,content.length)}$("#writeTemplate").html(new_content),$(".custom-input-template").on("input",function(e){$(this).attr("size",e.target.value.length)})})};scope.template={one:null},scope.patient.load()}}}),angular.module("app.loggedIn.template.controllers.edit",[]).controller("TemplateEditController",function($scope,$modal,toastr){}),angular.module("app.loggedIn.template.directives.edit",[]).directive("templateEdit",function($modal,$cookieStore,$state,$stateParams,TemplateModel,toastr,PatientService){return{restrict:"EA",scope:{},templateUrl:"modules/template/directives/templates/edit.html",link:function(scope,elem,attrs){var quill=($cookieStore.get("userInfo").id,new Quill("#editor",{modules:{"link-tooltip":!0,"image-tooltip":!0,"multi-cursor":!0},theme:"snow"}));quill.addModule("toolbar",{container:"#toolbar"}),scope.form={name:null},scope.save=function(){var html=quill.getHTML(),postData={name:scope.form.name,content:html,id:$stateParams.id};TemplateModel.update(postData).then(function(response){$state.go("loggedIn.template")},function(error){})};var loadTemplate=function(){TemplateModel.one({id:$stateParams.id}).then(function(response){scope.form=response.data[0],quill.setHTML(scope.form.content)})};loadTemplate()}}}),angular.module("app.loggedIn.timetable",["app.loggedIn.timetable.include"]),angular.module("app.loggedIn.timetable.include",["app.loggedIn.timetable.directives.calendar","app.loggedIn.timetable.dialogs.addDay","app.loggedIn.timetable.dialogs.editDay","app.loggedIn.timetable.dialogs.addSite","app.loggedIn.timetable.model"]),angular.module("app.loggedIn.timetable.directives.calendar",[]).directive("timetableCalendar",function(TimetableModel,$modal,$stateParams,mdtDoctorService,sysServiceService,toastr){return{restrict:"EA",templateUrl:"modules/timetable/directives/templates/calendar.html",link:function(scope,elem,attrs){scope.weekDisplay={0:"Weekly",1:"Week 1",2:"Week 2",3:"Week 3",4:"Week 4"};var load=function(){TimetableModel.list({doctor_id:$stateParams.doctorId}).then(function(response){scope.timetable.list=response.data,scope.displayInRow={};for(var i=0;i<scope.timetable.list.length;i++){var item=scope.timetable.list[i];scope.displayInRow[item.day_of_week_value]||(scope.displayInRow[item.day_of_week_value]={value:item.cal_header_df_id,services:{}}),scope.displayInRow[item.day_of_week_value].services[item.service_id]||(scope.displayInRow[item.day_of_week_value].services[item.service_id]=item.cal_header_df_id)}scope.site.load()},function(error){})},siteLoad=function(){TimetableModel.siteList({doctor_id:$stateParams.doctorId}).then(function(response){var i=0;_.forEach(scope.timetable.list,function(timetable_row){scope.timetable.list[i].site=[],_.forEach(response.data,function(site_row){site_row.cal_header_df_id===timetable_row.cal_header_df_id&&scope.timetable.list[i].site.push(site_row)}),i++})},function(error){})},addDay=function(){var modalInstance=$modal.open({templateUrl:"modules/timetable/dialogs/templates/addDay.html",controller:"TimetableCalendarAddDayDialog",size:"lg",resolve:{services:function(){return scope.service.list},doctor:function(){return scope.doctor.item}}});modalInstance.result.then(function(status){"add"===status&&scope.timetable.load()})},doctorLoad=function(){mdtDoctorService.byId($stateParams.doctorId).then(function(response){scope.doctor.item=response.data,serviceLoad(response.data.CLINICAL_DEPT_ID)},function(error){})},serviceLoad=function(clinical_dept_id){sysServiceService.byClinicalDepartment(clinical_dept_id).then(function(response){scope.service.list=response.data})},addSite=function(row){var modalInstance=$modal.open({templateUrl:"modules/timetable/dialogs/templates/addSite.html",controller:"TimetableCalendarAddSiteDialog",size:"lg",resolve:{row:function(){return row},doctor:function(){return scope.doctor.item}}});modalInstance.result.then(function(status){"add"===status&&scope.timetable.load()})},saveTimetable=function(row){var postData=angular.copy(row);switch(postData.day_of_Week_code=null,postData.day_of_Week){case"Monday":postData.day_of_Week_code=1;break;case"Tuesday":postData.day_of_Week_code=2;break;case"Wednesday":postData.day_of_Week_code=3;break;case"Thursday":postData.day_of_Week_code=4;break;case"Friday":postData.day_of_Week_code=5;break;case"Saturday":postData.day_of_Week_code=6}postData.clinical_dept_id=scope.doctor.item.CLINICAL_DEPT_ID,postData.appt_interval=row.appt_interval,TimetableModel.createTimetable(postData).then(function(response){toastr.success("success"==response.status?"Timetable is created":"Create timetable fail.")},function(error){toastr.error("Create timetable fail.")})},editTimetable=function(row){$modal.open({templateUrl:"modules/timetable/dialogs/templates/editDay.html",controller:"TimetableCalendarEditDayDialog",size:"lg",resolve:{row:function(){return row},services:function(){return scope.service.list},doctor:function(){return scope.doctor.item}}}).result.then(function(response){"success"===response&&scope.timetable.load()})},openTimetable=function(row){row.clinical_dept_id=scope.doctor.item.CLINICAL_DEPT_ID;var modalInstance=$modal.open({templateUrl:"notifyToSaveTimetable",controller:function($scope,row,$modalInstance){$scope.bookedList=[],TimetableModel.beforeGenerateCalendar(row).then(function(data){"success"==data.status?$scope.bookedList=data.data:toastr.error("Error when check data.")},function(err){toastr.error("Error when check data.")}),$scope.ok=function(){$modalInstance.close(row)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},resolve:{row:function(){return row}}});modalInstance.result.then(function(row){row&&scope.timetable.saveTimetable(row)})},removeDay=function(row){var modalInstance=$modal.open({templateUrl:"notifyToRemoveDay",controller:function($scope,row,$modalInstance){$scope.ok=function(){$modalInstance.close(row)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},size:"sm",resolve:{row:function(){return row}}});modalInstance.result.then(function(row){row&&TimetableModel.remove(row).then(function(response){toastr.success("Remove Day Successfully"),scope.timetable.load()},function(error){})})},removeSite=function(id){var modalInstance=$modal.open({templateUrl:"notifyToRemoveSite",controller:function($scope,id,$modalInstance){$scope.ok=function(){$modalInstance.close(id)},$scope.cancel=function(){$modalInstance.dismiss("cancel")}},size:"sm",resolve:{id:function(){return id}}});modalInstance.result.then(function(id){id&&TimetableModel.siteRemove({id:id}).then(function(response){"success"==response.status?(toastr.success("Remove Successfully."),scope.timetable.load()):toastr.error("Remove fail.")},function(error){toastr.error("Remove fail.")})})};scope.timetable={load:function(){load()},dialog:{removeDay:function(row){removeDay(row)},openTimetable:function(row){openTimetable(row)},editTimetable:function(row){editTimetable(row)},addDay:function(){addDay()}},list:[],form:{day_of_Week:"",SERVICE_ID:null,from_time:"",to_time:"",from_date:null,to_date:null,description:""},saveTimetable:function(row){saveTimetable(row)}},scope.site={load:function(){siteLoad()},dialog:{addSite:function(row){addSite(row)},removeSite:function(id){removeSite(id)}}},scope.doctor={load:function(){doctorLoad()},item:{}},scope.service={list:[],load:function(){serviceLoad()}},scope.timetable.load(),scope.doctor.load(),scope.service.load()}}}),angular.module("app.loggedIn.timetable.dialogs.addDay",[]).controller("TimetableCalendarAddDayDialog",function($scope,$cookieStore,$stateParams,$modalInstance,services,doctor,TimetableModel,ConfigService,toastr){var user_id=$cookieStore.get("userInfo").id,day_of_week=[{value:"Monday"},{value:"Tuesday"},{value:"Wednesday"},{value:"Thursday"},{value:"Friday"},{value:"Saturday"}],save=function(){ConfigService.beforeSave($scope.timetable.errors),$scope.timetable.errors=[];var postData=angular.copy($scope.timetable.form);postData.Creation_date=postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.Created_by=postData.Last_updated_by=user_id,postData.isenable=1,postData.from_date=ConfigService.convertToDB(postData.from_date),postData.to_date=ConfigService.convertToDB(postData.to_date),postData.from_time=ConfigService.convertToHHMM(postData.from_time),postData.to_time=ConfigService.convertToHHMM(postData.to_time),postData.doctor_id=$stateParams.doctorId,TimetableModel.add(postData).then(function(response){toastr.success("Added Successfully"),$modalInstance.close("add")},function(error){$scope.timetable.errors=angular.copy(error.data.errors),ConfigService.beforeError($scope.timetable.errors)})};$scope.timetable={options:{DAY_OF_WEEK:day_of_week,services:services},form:{day_of_Week:"",SERVICE_ID:null,from_time:"",to_time:"",from_date:null,to_date:null,description:"",appt_interval:doctor.Appt_interval},errors:[],save:function(){save()}}}),angular.module("app.loggedIn.timetable.dialogs.editDay",[]).controller("TimetableCalendarEditDayDialog",function($scope,$cookieStore,$stateParams,$modalInstance,services,doctor,row,TimetableModel,ConfigService,toastr){var user_id=$cookieStore.get("userInfo").id,day_of_week=[{value:"Monday"},{value:"Tuesday"},{value:"Wednesday"},{value:"Thursday"},{value:"Friday"},{value:"Saturday"}],save=function(){ConfigService.beforeSave($scope.timetable.errors),$scope.timetable.errors=[];var postData=angular.copy($scope.timetable.form);postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.Created_by=postData.Last_updated_by=user_id,postData.isenable=1,postData.from_time=ConfigService.convertToHHMM(postData.from_time),postData.to_time=ConfigService.convertToHHMM(postData.to_time),postData.from_date=ConfigService.convertToDB(postData.from_date),postData.to_date=ConfigService.convertToDB(postData.to_date),postData.doctor_id=$stateParams.doctorId,TimetableModel.edit(postData).then(function(response){toastr.success("Edit Successfully"),$modalInstance.close("success")},function(error){$scope.timetable.errors=angular.copy(error.data.errors),ConfigService.beforeError($scope.timetable.errors)})},load=function(){TimetableModel.one({cal_header_df_id:row.cal_header_df_id}).then(function(response){angular.extend($scope.timetable.form,response.data),$scope.timetable.form.from_date=ConfigService.convertToDate($scope.timetable.form.from_date),$scope.timetable.form.to_date=ConfigService.convertToDate($scope.timetable.form.to_date),$scope.timetable.form.from_time=ConfigService.convertHHMMToInt($scope.timetable.form.from_time),$scope.timetable.form.to_time=ConfigService.convertHHMMToInt($scope.timetable.form.to_time),delete $scope.timetable.form.Creation_date},function(error){})};$scope.timetable={load:function(){load()},options:{DAY_OF_WEEK:day_of_week,services:services},form:{day_of_Week:"",service_id:null,from_time:"",to_time:"",from_date:null,to_date:null,description:"",appt_interval:doctor.Appt_interval},errors:[],save:function(){save()}},$scope.timetable.load()}),angular.module("app.loggedIn.timetable.dialogs.addSite",[]).controller("TimetableCalendarAddSiteDialog",function($scope,$cookieStore,$stateParams,$modalInstance,row,doctor,toastr,TimetableModel,ConfigService){var user_id=$cookieStore.get("userInfo").id,weeks=[{code:0,value:"Weekly"},{code:1,value:"Week 1"},{code:2,value:"Week 2"},{code:3,value:"Week 3"},{code:4,value:"Week 4"}],save=function(){ConfigService.beforeSave($scope.site.errors);var postData=angular.copy($scope.site.form);postData.Creation_date=postData.Last_update_date=moment().format("YYYY-MM-DD"),postData.Created_by=postData.Last_updated_by=user_id,postData.isenable=1,postData.doctor_id=$stateParams.doctorId,postData.cal_header_df_id=row.cal_header_df_id,TimetableModel.siteAdd(postData).then(function(response){toastr.success("Added Successfully"),$modalInstance.close("add")},function(error){$scope.site.errors=angular.copy(error.data.errors),ConfigService.beforeError($scope.site.errors)})};$scope.site={options:{weeks:weeks,sites:[]},form:{cal_header_df_id:null,week_ord_of_month:null,site_id:null,description:""},errors:[],save:function(){save()}};var loadOptions=function(){TimetableModel.redimedsiteList({CLINICAL_DEPT_ID:doctor.CLINICAL_DEPT_ID}).then(function(response){$scope.site.options.sites=response.data},function(error){})};loadOptions()}),angular.module("app.loggedIn.timetable.model",[]).factory("TimetableModel",function(Restangular){var instanceService={},appApi=Restangular.all("api/meditek/v1/timetable"),redimedApi=Restangular.all("api/meditek/v1/redimedsite");return instanceService.list=function(data){var detailApi=appApi.all("list");return detailApi.post({data:data})},instanceService.one=function(data){var detailApi=appApi.all("one");return detailApi.post({data:data})},instanceService.siteList=function(data){var detailApi=appApi.all("siteList");return detailApi.post({data:data})},instanceService.siteAdd=function(data){var detailApi=appApi.all("siteAdd");return detailApi.post({data:data})},instanceService.siteRemove=function(data){var detailApi=appApi.all("siteRemove");return detailApi.post({data:data})},instanceService.remove=function(data){var detailApi=appApi.all("remove");return detailApi.post({data:data})},instanceService.add=function(data){var detailApi=appApi.all("add");return detailApi.post({data:data})},instanceService.edit=function(data){var detailApi=appApi.all("edit");return detailApi.post({data:data})},instanceService.redimedsiteList=function(data){var detailApi=redimedApi.all("list");return detailApi.post({data:data})},instanceService.createTimetable=function(data){var detailApi=appApi.all("createTimetable");return detailApi.post({data:data})},instanceService.beforeGenerateCalendar=function(data){var detailApi=appApi.all("beforeGenerateCalendar");return detailApi.post({data:data})},instanceService.deleteAllCalendarInDate=function(data){var detailApi=appApi.all("deleteAllCalendarInDate");return detailApi.post({data:data})},instanceService.beforeDeleteAllCalendarInDate=function(data){var detailApi=appApi.all("beforeDeleteAllCalendarInDate");return detailApi.post({data:data})},instanceService.deleteSelectedCalendar=function(calId){var detailApi=appApi.all("deleteSelectedCalendar");return detailApi.post({calId:calId})},instanceService.beforeDeleteSelectedCalendar=function(calId){var detailApi=appApi.all("beforeDeleteSelectedCalendar");return detailApi.post({calId:calId})},instanceService.getAllCalendarInDate=function(data){var detailApi=appApi.all("getAllCalendarInDate");return detailApi.post({data:data})},instanceService.updateServiceInDate=function(data){var detailApi=appApi.all("updateServiceInDate");return detailApi.post({data:data})},instanceService}),angular.module("app.loggedIn.treeApprove.controllers",["app.loggedIn.treeApprove.listSystem.controller","app.loggedIn.treeApprove.detail.controller","app.loggedIn.treeApprove.listDepartment.controller"]),angular.module("app.loggedIn.treeApprove.detail.controller",[]).controller("DetailTree",function($scope,$modal,$cookieStore,TreeApproveService,localStorageService,toastr,$state){$scope.treeData=[],$scope.loadTree=function(){var IdTree=localStorageService.get("IdTree");IdTree.userId=$cookieStore.get("userInfo").id,TreeApproveService.LoadTreeApprove(IdTree).then(function(response){"fail"===response.status?toastr.error("Loading fail!","Error"):"findFound"===response.status||"findNull"===response.status?angular.forEach(response.result,function(nodeOfTree,index){$scope.treeData.push({id:nodeOfTree.NODE_ID,name:nodeOfTree.NODE_CODE||null,FROM_VALUE:nodeOfTree.FROM_VALUE,TO_VALUE:nodeOfTree.TO_VALUE,ISVALUE:nodeOfTree.ISVALUE,GROUP_ID:nodeOfTree.GROUP_ID,GROUP_TYPE:nodeOfTree.GROUP_TYPE,parent:void 0===nodeOfTree.TO_NODE_ID||null===nodeOfTree.TO_NODE_ID||""===nodeOfTree.TO_NODE_ID?0:nodeOfTree.TO_NODE_ID,decription:nodeOfTree.DECRIPTION||null,seq:nodeOfTree.seq})}):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error")),$scope.org_chart($scope.treeData)})};var dialogTree=function(nodeInfo){var modalInstance=$modal.open({templateUrl:"AddNode",controller:function($scope,$modalInstance,TreeApproveService){$scope.getReturnedValue=function(value){value&&$modalInstance.close({status:"addCancel",result:[]})},"addNew"===nodeInfo.status?($scope.isNew=!0,$scope.NodeIdEdit=null):"edit"===nodeInfo.status&&($scope.isNew=!1,$scope.NodeIdEdit=nodeInfo.node),$scope.getInfo=function(value){$scope.isNew===!0?(value.userId=$cookieStore.get("userInfo").id,value.seq=nodeInfo.node.seq+1,value.parent=nodeInfo.node.id,value.GROUP_ID=localStorageService.get("IdTree").GROUP_ID,value.GROUP_TYPE=localStorageService.get("IdFunction"),TreeApproveService.InsertNode(value).then(function(response){$modalInstance.close("success"===response.status?{status:"addSuccess",result:response.result}:"fail"===response.status?{status:"addFail",result:response.result}:"error"===response.status?{status:"addError",result:response.result}:{status:"addCatch",result:response.result})})):$scope.isNew===!1&&(value.userId=$cookieStore.get("userInfo").id,TreeApproveService.UpdateNode(value).then(function(response){$modalInstance.close("fail"===response.status?{status:"editFail",result:[]}:"success"===response.status?{status:"editSuccess",result:response.result}:{status:"editError",result:[]})}))}},size:"md"});modalInstance.result.then(function(data){if("addSuccess"===data.status){var treeData=[];angular.forEach(data.result,function(nodeOfTree,index){treeData.push({id:nodeOfTree.NODE_ID,name:nodeOfTree.NODE_CODE||null,FROM_VALUE:nodeOfTree.FROM_VALUE,TO_VALUE:nodeOfTree.TO_VALUE,ISVALUE:nodeOfTree.ISVALUE,GROUP_ID:nodeOfTree.GROUP_ID,GROUP_TYPE:nodeOfTree.GROUP_TYPE,parent:void 0===nodeOfTree.TO_NODE_ID||null===nodeOfTree.TO_NODE_ID||""===nodeOfTree.TO_NODE_ID?0:nodeOfTree.TO_NODE_ID,decription:nodeOfTree.DECRIPTION||null,seq:nodeOfTree.seq||-1})}),$scope.org_chart(treeData),toastr.success("Add new node success!","Success")}else if("addFail"===data.status)toastr.error("Add node fail!","Error");else if("addError"===data.status)toastr.error("Add node error!","Error");else if("addCatch"===data.status)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","500");else if("editFail"===data.status)toastr.error("Update node fail!","Error");else if("editError"===data.status)$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","500");else if("editSuccess"===data.status){var treeData=[];angular.forEach(data.result,function(nodeOfTree,index){treeData.push({id:nodeOfTree.NODE_ID,name:nodeOfTree.NODE_CODE||null,FROM_VALUE:nodeOfTree.FROM_VALUE,TO_VALUE:nodeOfTree.TO_VALUE,ISVALUE:nodeOfTree.ISVALUE,GROUP_ID:nodeOfTree.GROUP_ID,GROUP_TYPE:nodeOfTree.GROUP_TYPE,parent:void 0===nodeOfTree.TO_NODE_ID||null===nodeOfTree.TO_NODE_ID||""===nodeOfTree.TO_NODE_ID?0:nodeOfTree.TO_NODE_ID,decription:nodeOfTree.DECRIPTION||null,seq:nodeOfTree.seq||-1})}),$scope.org_chart(treeData),toastr.success("Update node success!","Success")}})};$scope.org_chart=function(data){org_chart=$("#orgChart").orgChart({data:data,showControls:!0,allowEdit:!1,onAddNode:function(node){dialogTree({status:"addNew",node:node.data})},onDeleteNode:function(node){swal({title:"Are you sure?",type:"warning",showCancelButton:!0,
confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){0!==node.data.parent?$scope.deleteNode(node):toastr.error("Can not delete root!","Fail")})},onClickNode:function(node){dialogTree({status:"edit",node:node.data.id})}})},$scope.deleteNode=function(node){var info={GROUP_ID:node.data.GROUP_ID,NODE_ID:node.data.id};TreeApproveService.DeleteNode(info).then(function(response){if("success"===response.status){var treeData=[];angular.forEach(response.result,function(nodeOfTree,index){treeData.push({id:nodeOfTree.NODE_ID,name:nodeOfTree.NODE_CODE||null,FROM_VALUE:nodeOfTree.FROM_VALUE,TO_VALUE:nodeOfTree.TO_VALUE,ISVALUE:nodeOfTree.ISVALUE,GROUP_ID:nodeOfTree.GROUP_ID,GROUP_TYPE:nodeOfTree.GROUP_TYPE,parent:void 0===nodeOfTree.TO_NODE_ID||null===nodeOfTree.TO_NODE_ID||""===nodeOfTree.TO_NODE_ID?0:nodeOfTree.TO_NODE_ID,decription:nodeOfTree.DECRIPTION||null,seq:nodeOfTree.seq||-1})}),$scope.org_chart(treeData),toastr.success("Delete node success!","Success")}else"fail"===response.status&&toastr.error("Delete node fail!","Error")})},$scope.loadTree()}),angular.module("app.loggedIn.treeApprove",["app.loggedIn.treeApprove.controllers","app.loggedIn.treeApprove.directives","app.loggedIn.treeApprove.service"]).config(function($stateProvider){$stateProvider.state("loggedIn.treeApprove",{url:"/tree-approve","abstract":!0,templateUrl:"/modules/treeApprove/views/structure.html"}).state("loggedIn.treeApprove.ListFunction",{url:"/list-function",views:{"main-content":{templateUrl:"modules/treeApprove/views/ListFunction.html",controller:"ListFunctionController"}}}).state("loggedIn.treeApprove.ListTree",{url:"/list-tree",views:{"main-content":{templateUrl:"modules/treeApprove/views/ListTree.html",controller:"ListTreeController"}}}).state("loggedIn.treeApprove.DetailTree",{url:"/detail-tree",views:{"main-content":{templateUrl:"modules/treeApprove/views/DetailTree.html",controller:"DetailTree"}}})}),angular.module("app.loggedIn.treeApprove.listDepartment.controller",[]).controller("ListTreeController",function($scope,MODE_ROW,localStorageService,$state,TreeApproveService,$modal,$cookieStore,toastr){$scope.info={},$scope.setPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.loadList()},$scope.reset=function(){$scope.searchObjectMap=angular.copy($scope.searchDepartmentsObject),$scope.loadList()},$scope.loadList=function(idInput){"DESC"===idInput?$scope.searchObjectMap.order="DESC":"ASC"===idInput&&($scope.searchObjectMap.order="ASC"),TreeApproveService.LoadTree($scope.searchObjectMap).then(function(response){"fail"!==response[status]?$scope.list=response:($scope.list=response,toastr.error("Loading fail!","Error"))}),$(idInput).focus()};var init=function(){$scope.searchObject={limit:10,offset:0,maxSize:5,currentPage:1,data:{NAME:"",Email:"",phone:null}},$scope.rows=MODE_ROW,$scope.searchDepartmentsObject={limit:10,offset:0,maxSize:5,currentPage:1,order:"DESC",GROUP_TYPE:localStorageService.get("IdFunction"),data:{GROUP_NAME:""}},$scope.searchObjectMap=angular.copy($scope.searchDepartmentsObject),$scope.list={},$scope.loadList(),$scope.dateOptions={formatYear:"yy",startingDay:1}};init(),$scope.goTotreeApproveDetail=function(IdTree){localStorageService.set("IdTree",IdTree),$state.go("loggedIn.treeApprove.DetailTree")},$scope.DeleteTree=function(groupId){swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){TreeApproveService.DeleteTree(groupId).then(function(response){"success"===response.status?($scope.loadList(),toastr.success("Delete success!","Success")):"fail"===response.status?toastr.error("Delete fail!","Error"):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})})},$scope.EditTree=function(IdTree){DialogTree(IdTree)},$scope.AddTree=function(){DialogTree(null)};var DialogTree=function(groupId){var modalInstance=$modal.open({templateUrl:"AddTree",controller:function($scope,$modalInstance,TreeApproveService,localStorageService,$cookieStore){$scope.getReturnedValue=function(value){if(value){var data=[{status:"cancel",result:[]}];$modalInstance.close(data)}},$scope.getInfo=function(value){value.userId=$cookieStore.get("userInfo").id,value.GROUP_TYPE=localStorageService.get("IdFunction"),$scope.isNew===!0?TreeApproveService.InsertTree(value).then(function(responsive){if("fail"===responsive.status)toastr.error("Add new tree fail!","Error");else if("success"===responsive.status){var data=[{status:"success",result:responsive.result}];$modalInstance.close(data),toastr.success("Add new tree success!","Success")}else $state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not responsive!","Error")}):$scope.isNew===!1&&TreeApproveService.UpdateTree(value).then(function(responsive){if("fail"===responsive.status)toastr.error("Update tree fail!","Error");else if("success"===responsive.status){var data=[{status:"success",result:responsive.result}];$modalInstance.close(data),toastr.success("Update tree success!","Success")}else $state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not responsive!","Error")})},null===groupId?($scope.isNew=!0,$scope.TreeIdEdit=null):($scope.isNew=!1,$scope.TreeIdEdit=groupId)},size:"md"});modalInstance.result.then(function(data){"success"===data[0].status&&($scope.list.result=data[0].result)})}}),angular.module("app.loggedIn.treeApprove.listSystem.controller",[]).controller("ListFunctionController",function($scope,MODE_ROW,TreeApproveService,localStorageService,$state,$modal,$cookieStore,toastr){$scope.info={},$scope.setPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.loadList()},$scope.reset=function(){$scope.searchObjectMap=angular.copy($scope.searchSystemsObject),$scope.loadList()},$scope.loadList=function(idInput){$scope.list.loading=!0,"ASC"===idInput&&($scope.searchObjectMap.order="ASC"),"DESC"===idInput&&($scope.searchObjectMap.order="DESC"),TreeApproveService.LoadFunction($scope.searchObjectMap).then(function(response){"fail"!==response[status]?$scope.list=response:($scope.list=response,toastr.error("Loading fail"))}),$scope.list.loading=!1,$(idInput).focus()},$scope.goToTree=function(IdFunction){localStorageService.set("IdFunction",IdFunction),$state.go("loggedIn.treeApprove.ListTree")},$scope.DeleteFunction=function(typeId){swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){TreeApproveService.DeleteFunction(typeId).then(function(response){"success"===response.status?($scope.loadList(),toastr.success("Delete success!","Success")):"fail"===response.status?toastr.error("Delete fail!","Error"):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not reponse!","Error"))})})},$scope.EditFunction=function(typeId){DialogFunction(typeId)},$scope.AddFunction=function(){DialogFunction(null)};var init=function(){$scope.searchObject={limit:10,offset:0,maxSize:5,currentPage:1,data:{NAME:"",Email:"",phone:null}},$scope.rows=MODE_ROW,$scope.searchSystemsObject={limit:10,offset:0,maxSize:5,order:"DESC",currentPage:1,data:{TYPE_NAME:""}},$scope.searchObjectMap=angular.copy($scope.searchSystemsObject),$scope.list={},$scope.list.loading=!1,$scope.loadList(),$scope.dateOptions={formatYear:"yy",startingDay:1}};init();var DialogFunction=function(typeId){var modalInstance=$modal.open({templateUrl:"AddFunction",controller:function($scope,$modalInstance,TreeApproveService,localStorageService){$scope.getReturnedValue=function(value){if(value){var data=[{status:"cancel",result:null}];$modalInstance.close(data)}},null===typeId?($scope.isNew=!0,$scope.FunctionIdEdit=null):($scope.isNew=!1,$scope.FunctionIdEdit=typeId),$scope.getInfo=function(value){value.userId=$cookieStore.get("userInfo").id,$scope.isNew===!0?TreeApproveService.InsertFunction(value).then(function(responsive){"error"===responsive.status?($modalInstance.close(),toastr.error("Add function fail!","Error")):"success"===responsive.status?($modalInstance.close(),$state.go("loggedIn.treeApprove.ListFunction",null,{reload:!0}),toastr.success("Add function success!","success")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not responsive!","Error"))}):$scope.isNew===!1&&TreeApproveService.UpdateFunction(value).then(function(responsive){"error"===responsive.status?($modalInstance.close(),toastr.error("Update function fail!","Error")):"success"===responsive.status?($modalInstance.close(),$state.go("loggedIn.treeApprove.ListFunction",null,{reload:!0}),toastr.success("Update function success!","success")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not responsive!","Error"))})}},size:"md"});modalInstance.result.then(function(data){$scope.loadList()})}}),angular.module("app.loggedIn.treeApprove.AddNode.directive",[]).directive("addNode",function(TreeApproveService,toastr,$state){return{restrict:"EA",require:"ngModel",scope:{onCancel:"&",onSave:"&",ngModel:"="},link:function(scope,element,attrs){scope.$watch("ngModel",function(newModel){null!==newModel?(scope.addOrUpdateTitle="Update Node",scope.addOrUpdateButton="Update",TreeApproveService.LoadOneNode(newModel).then(function(response){"error"===response.status?toastr.error("Loading error!","Error"):"fail"===response.status?toastr.error("Loading fail!","Fail"):"success"===response.status?scope.info=angular.copy(response.result):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not reponse!","Error"))})):(scope.addOrUpdateTitle="Add Node",scope.addOrUpdateButton="Add")})},templateUrl:"modules/treeApprove/directives/templates/AddNode.html"}}),angular.module("app.loggedIn.treeApprove.AddSystem.directive",[]).directive("addFunction",function(TreeApproveService,toastr,$state){return{restrict:"EA",require:"ngModel",scope:{onCancel:"&",onSave:"&",ngModel:"="},link:function(scope,element,attrs){scope.$watch("ngModel",function(newModel){scope.info={},null!==newModel?(scope.addOrUpdateTitle="Update Function",scope.addOrUpdateButton="Update",TreeApproveService.LoadOneFunction(newModel).then(function(response){"success"===response.status?(scope.info=response.result,scope.info.oldName=scope.info.TYPE_NAME):"fail"===response.status?($state.go("loggedIn.treeApprove.ListFunction",null,{reload:!0}),toastr.error("Loading fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})):(scope.addOrUpdateTitle="Add Function",scope.addOrUpdateButton="Add")})},templateUrl:"modules/treeApprove/directives/templates/AddFunction.html"}}),angular.module("app.loggedIn.treeApprove.AddDepartment.directive",[]).directive("addTree",function(TreeApproveService,$state,toastr){return{restrict:"EA",require:"ngModel",scope:{onCancel:"&",onSave:"&",ngModel:"="},link:function(scope,element,attrs){scope.$watch("ngModel",function(newModel){null!==newModel?(scope.addOrUpdateTitle="Update Tree",scope.addOrUpdateButton="Update",TreeApproveService.LoadOneTree(newModel).then(function(response){"success"===response.status?scope.info=response.result:"fail"===response.status?toastr.error("Loading fail!","Error"):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})):(scope.addOrUpdateTitle="Add Tree",scope.addOrUpdateButton="Add")}),TreeApproveService.LoadCompany().then(function(responsive){scope.companies=responsive.company,TreeApproveService.LoadSite().then(function(responsive){scope.sites=responsive.redimedSite})})},templateUrl:"modules/treeApprove/directives/templates/AddTree.html"}}),angular.module("app.loggedIn.treeApprove.directives",["app.loggedIn.treeApprove.AddNode.directive","app.loggedIn.treeApprove.AddSystem.directive","app.loggedIn.treeApprove.AddDepartment.directive"]),angular.module("app.loggedIn.treeApprove.service",[]).factory("TreeApproveService",function(Restangular){var TreeApproveService={},api=Restangular.all("api");return TreeApproveService.LoadFunction=function(searchObjPost){var LoadFunction=api.all("treeApprove/post-function-list");return LoadFunction.post({searchObj:searchObjPost})},TreeApproveService.DeleteFunction=function(FunctionIdPost,index){var DeleteFunction=api.all("treeApprove/post-function-delete");return DeleteFunction.post({info:FunctionIdPost})},TreeApproveService.InsertFunction=function(systemPost){var InsertFunction=api.all("treeApprove/post-function-insert");return InsertFunction.post({info:systemPost})},TreeApproveService.LoadOneFunction=function(idPost){var LoadOneFunction=api.all("treeApprove/post-function-one");return LoadOneFunction.post({info:idPost})},TreeApproveService.UpdateFunction=function(idPost){var UpdateFunction=api.all("treeApprove/post-function-update");return UpdateFunction.post({info:idPost})},TreeApproveService.LoadTreeApprove=function(infoPost){var LoadTreeApprove=api.all("treeApprove/get-function-tree");return LoadTreeApprove.post({info:infoPost})},TreeApproveService.DeleteTree=function(idPost){var DeleteTree=api.all("treeApprove/post-tree-delete");return DeleteTree.post({info:idPost})},TreeApproveService.LoadTree=function(TreeCodePost){var LoadTree=api.all("treeApprove/post-tree-list");return LoadTree.post({searchObj:TreeCodePost})},TreeApproveService.LoadOneTree=function(idPost){var LoadOneTree=api.all("treeApprove/post-tree-one");return LoadOneTree.post({info:idPost})},TreeApproveService.UpdateTree=function(infoPost){var UpdateTree=api.all("treeApprove/post-tree-update");return UpdateTree.post({info:infoPost})},TreeApproveService.LoadCompany=function(){var LoadCompany=api.one("treeApprove/get-company-list");return LoadCompany.get({})},TreeApproveService.LoadSite=function(){var LoadSite=api.one("treeApprove/get-site-list");return LoadSite.get({})},TreeApproveService.InsertTree=function(departmentPost){var InsertTree=api.all("treeApprove/post-tree-insert");return InsertTree.post({info:departmentPost})},TreeApproveService.InsertNode=function(nodePost){var InsertNode=api.all("treeApprove/post-node-insert");return InsertNode.post({info:nodePost})},TreeApproveService.UpdateNode=function(nodePost){var UpdateNode=api.all("treeApprove/post-node-update");return UpdateNode.post({info:nodePost})},TreeApproveService.LoadOneNode=function(nodePost){var LoadOneNode=api.all("treeApprove/post-node-one");return LoadOneNode.post({info:nodePost})},TreeApproveService.DeleteNode=function(nodePost){var DeleteNode=api.all("treeApprove/post-node-delete");return DeleteNode.post({info:nodePost})},TreeApproveService}),angular.module("app.loggedIn.user",["app.loggedIn.user.services","app.loggedIn.user.profile.controller","app.loggedIn.user.type.controller"]).config(function($stateProvider){$stateProvider.state("loggedIn.userProfile",{url:"/users/profile",templateUrl:"modules/user/views/profile.html",controller:"UserProfileController"}).state("loggedIn.userType",{url:"/usersType",templateUrl:"modules/user/views/userType.html",controller:"UserTypeController"})}),angular.module("app.loggedIn.user.services",[]).factory("UserService",function(Restangular){var userService={},userApi=Restangular.all("api"),mdtUserApi=Restangular.all("api/meditek/v1/user/");return userService.all=function(){var funcApi=mdtUserApi.one("all");return funcApi.get()},userService.doctorAssistant=function(){return userApi.one("users/assistant").get()},userService.detail=function(username){var detailApi=userApi.one("users/loggedin");return detailApi.get()},userService.menu=function(id){var menuApi=userApi.all("menu/side");return menuApi.post({id:id,isWeb:!0})},userService.getFunction=function(id){var a=userApi.all("function/id");return a.post({id:id})},userService.getCompany=function(){var comp=userApi.one("company/list");return comp.get()},userService.updateProfile=function(info){var edit=userApi.all("users/editProfile");return edit.post({info:info})},userService.getUserInfo=function(id){var info=userApi.all("users/id");return info.post({id:id})},userService.getUserType=function(){return userApi.one("users/type").get()},userService.updateUserType=function(info){return userApi.all("users/type/edit").post({info:info})},userService.deleteUserType=function(id){return userApi.all("users/type/delete").post({id:id})},userService.insertUserType=function(info){return userApi.all("users/type/insert").post({info:info})},userService.getUserTypeMenu=function(id){return userApi.all("users/type/menu").post({id:id})},userService.insertUserTypeMenu=function(info){return userApi.all("users/type/menu/insert").post({info:info})},userService.updateUserTypeMenu=function(info,id,type_id){return userApi.all("users/type/menu/edit").post({info:info,id:id,typeId:type_id})},userService.deleteUserTypeMenu=function(id){return userApi.all("users/type/menu/delete").post({id:id})},userService.getOnlineUsers=function(){return userApi.one("im/getOnlineUsers").get()},userService}),angular.module("app.loggedIn.user.profile.controller",[]).controller("UserProfileController",function($scope,$modal,$filter,FileUploader,UserService,$http,toastr,$cookieStore){var userInfo=null,companyInfo=null;$scope.isCompany=!1,void 0!=$cookieStore.get("userInfo")&&(userInfo=$cookieStore.get("userInfo")),void 0!=$cookieStore.get("companyInfo")&&(companyInfo=$cookieStore.get("companyInfo")),$scope.detail="Company"==userInfo.UserType.user_type?{id:userInfo.id,img:null,company_id:companyInfo.id,Booking_Person:userInfo.Booking_Person,Contact_number:userInfo.Contact_number,Contact_email:userInfo.Contact_email,result_email:userInfo.result_email,invoiceemail:userInfo.invoiceemail,userLegal:userInfo.MEDICO_LEGAL_REGISTER_STATUS,isAccessReportOnline:userInfo.IS_ACCESS_REPORTS_ONLINE}:{id:userInfo.id,img:null,Booking_Person:userInfo.Booking_Person,Contact_number:userInfo.Contact_number,Contact_email:userInfo.Contact_email},UserService.getUserInfo(userInfo.id).then(function(data){$scope.detail.img=data.img}),UserService.getCompany().then(function(data){$scope.companyList=data}),"Company"==userInfo.UserType.user_type?($scope.isCompany=!0,$scope.info={name:userInfo.Booking_Person,username:userInfo.user_name,phone:userInfo.Contact_number,email:userInfo.Contact_email,userType:userInfo.UserType.user_type,companyName:companyInfo.Company_name,companyIndustry:companyInfo.Industry,companyAddr:companyInfo.Addr,companyState:companyInfo.State}):($scope.isCompany=!1,$scope.info={name:userInfo.Booking_Person,username:userInfo.user_name,phone:userInfo.Contact_number,email:userInfo.Contact_email,userType:userInfo.UserType.user_type}),$scope.updateUserProfile=function(userForm){UserService.updateProfile($scope.detail).then(function(data){"success"===data.status?toastr.success("Edit Successfully!","Success"):toastr.error("Edit Failed!","Error")})},$scope.changeUserPassword=function(){$modal.open({templateUrl:"modules/user/views/changePassModal.html",controller:"UserChangePassController",size:"md",resolve:{userId:function(){return userInfo.id}}})}}).controller("UserChangePassController",function($scope,$filter,$state,$modalInstance,OnlineBookingService,userId,toastr){$scope.info={oldPass:null,newPass:null,id:userId},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.okClick=function(changePassForm){$scope.showClickedValidation=!0,changePassForm.$invalid?toastr.error("Please Input All Required Information!","Error"):swal({title:"Confirm",text:"Are You Sure Want To Change Your Password?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){OnlineBookingService.changeUserPassword($scope.info).then(function(data){"success"===data.status?(toastr.success("Change Password Successfully","Success"),$modalInstance.dismiss("cancel")):"error"===data.status&&toastr.error("Change Password Failed","Error")})})}}),angular.module("app.loggedIn.user.type.controller",[]).controller("UserTypeController",function($scope,$modal,$state,$filter,ngTableParams,UserService,MenuService,$http,toastr){$scope.data=[],$scope.data1=[],$scope.selectedId=null,$scope.tableParams2=new ngTableParams({page:1,count:25},{total:$scope.data1.length,getData:function($defer,params){var orderedData=params.sorting()?$filter("orderBy")($scope.data1,params.orderBy()):$scope.data1;orderedData=params.filter()?$filter("filter")(orderedData,params.filter()):orderedData,params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}}),UserService.getUserType().then(function(data){$scope.data=data,$scope.tableParams=new ngTableParams({page:1,count:10},{total:$scope.data.length,getData:function($defer,params){var orderedData=params.sorting()?$filter("orderBy")($scope.data,params.orderBy()):$scope.data;orderedData=params.filter()?$filter("filter")(orderedData,params.filter()):orderedData,params.total(orderedData.length),$defer.resolve(orderedData.slice((params.page()-1)*params.count(),params.page()*params.count()))}})}),$scope.loadMenu=function(m){MenuService.menuRootList().then(function(data){return $scope.menuList=data})},$scope.showMenu=function(m){$scope.selectedId=m.ID,$scope.selectedType=m.user_type,$scope.data1=[],UserService.getUserTypeMenu(m.ID).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})},$scope.updateType=function(m){var info={id:m.ID,user_type:m.user_type};UserService.updateUserType(info).then(function(data){"success"==data.status?toastr.success("Edit Successfully!","Success"):toastr.error("Edit Failed!","Error")})},$scope.deleteType=function(m){UserService.deleteUserType(m.ID).then(function(data){"success"==data.status?(toastr.success("Delete Successfully!","Success"),UserService.getUserType().then(function(data){$scope.data=data,$scope.$watch("data",function(data){$scope.tableParams.reload()})})):toastr.error("Delete Failed!","Error")})},$scope.addNewType=function(){var modalInstance=$modal.open({templateUrl:"modules/user/views/insertTypeModal.html",controller:"InsertTypeController",size:"md"});modalInstance.result.then(function(){UserService.getUserType().then(function(data){$scope.data=data,$scope.$watch("data",function(data){$scope.tableParams.reload()})})})},$scope.addNewMenu=function(){var modalInstance=$modal.open({templateUrl:"modules/user/views/newTypeMenuModal.html",controller:"NewTypeMenuController",size:"md",resolve:{typeId:function(){return $scope.selectedId}}});modalInstance.result.then(function(){UserService.getUserTypeMenu($scope.selectedId).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})})},$scope.updateMenu=function(m){var info={menu_id:m.menu_id,isEnable:m.isEnable};UserService.updateUserTypeMenu(info,m.id,m.type_id).then(function(data){"success"==data.status?(toastr.success("Edit Successfully!","Success"),UserService.getUserTypeMenu($scope.selectedId).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})):toastr.error("Edit Failed!","Error")})},$scope.deleteMenu=function(id){UserService.deleteUserTypeMenu(id).then(function(data){"success"==data.status?(toastr.success("Delete Successfully!","Success"),UserService.getUserTypeMenu($scope.selectedId).then(function(data){$scope.data1=data,$scope.$watch("data1",function(data){$scope.tableParams2.reload()})})):toastr.error("Delete Failed!","Error")})}}).controller("InsertTypeController",function($scope,$modalInstance,$state,$filter,UserService,toastr){$scope.info={user_type:null},$scope.cancel=function(){$modalInstance.close()},$scope.submit=function(){$scope.showClickedValidation=!0,$scope.userTypeForm.$invalid?toastr.error("Please Enter Required Information!","Error"):UserService.insertUserType($scope.info).then(function(data){"success"==data.status?(toastr.success("Insert Successfully!","Success"),$modalInstance.close()):toastr.success("Insert Failed!","Error")})}}).controller("NewTypeMenuController",function($scope,$modalInstance,$state,$filter,UserService,MenuService,toastr,typeId){$scope.info={menu_id:null,isEnable:"1",type_id:typeId},$scope.cancel=function(){$modalInstance.close()},MenuService.menuRootList().then(function(data){$scope.menuList=data}),$scope.submit=function(){$scope.showClickedValidation=!0,$scope.userTypeForm.$invalid?toastr.error("Please Enter Required Information!","Error"):UserService.insertUserTypeMenu($scope.info).then(function(data){"success"==data.status?(toastr.success("Insert Successfully!","Success"),$modalInstance.close()):toastr.success("Insert Failed!","Error")})}}),angular.module("app.loggedIn.waitingList",["app.loggedIn.waitingList.include"]),angular.module("app.loggedIn.waitingList.include",["app.loggedIn.waitingList.models","app.loggedIn.waitingList.directives.add","app.loggedIn.waitingList.directives.list"]),angular.module("app.loggedIn.waitingList.models",[]).factory("WaitingListModel",function(Restangular){var mainModel={},mainApi=Restangular.all("api/meditek/v1/waitingList");return mainModel.add=function(data){var instanceApi=mainApi.all("add");return instanceApi.post({data:data})},mainModel.list=function(data){var instanceApi=mainApi.all("list");return instanceApi.post({data:data})},mainModel.remove=function(data){var instanceApi=mainApi.all("remove");return instanceApi.post({data:data})},mainModel.remove=function(data){var instanceApi=mainApi.all("remove");return instanceApi.post({data:data})},mainModel.getPatientFromId=function(data){var instanceApi=mainApi.all("getPatientFromId");return instanceApi.post({data:data})},mainModel}),angular.module("app.loggedIn.waitingList.directives.add",[]).directive("waitingListAdd",function($modal,WaitingListModel,ConfigService,$cookieStore,OutreferralModel,PatientService){return{restrict:"EA",scope:{success:"=",doctorId:"=",patientId:"="},templateUrl:"modules/waitingList/directives/templates/add.html",link:function(scope,elem,attrs){scope.priorities=[{key:"high",value:"High"},{key:"normal",value:"Normal"},{key:"low",value:"Low"}];var user_id=$cookieStore.get("userInfo").id,model={doctor_id:null,Patient_id:null,priority:null,reason:null,Created_by:user_id};scope.$watch("doctorId",function(doctorId){if("undefined"!=typeof doctorId){var postData=doctorId;OutreferralModel.DotorFromDoctorId(postData).then(function(response){scope.waitingList.model.doctor_id=response.data[0].doctor_id,scope.doctor.name=response.data[0].NAME},function(error){})}}),scope.$watch("patientId",function(patientId){"undefined"!=typeof patientId&&WaitingListModel.getPatientFromId(patientId).then(function(response){scope.waitingList.model.Patient_id=response.data[0].Patient_id,scope.patient.name=response.data[0].First_name+" "+response.data[0].Sur_name},function(error){})});var doctorSelect=function(){$modal.open({templateUrl:"selectDoctorDialog",size:"lg",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.waitingList.model.doctor_id=row.doctor_id,scope.doctor.name=row.NAME})},patientSelect=function(){$modal.open({templateUrl:"selectPatientDialog",size:"lg",controller:function($scope,$modalInstance){$scope.clickRow=function(row){$modalInstance.close(row)}}}).result.then(function(row){scope.waitingList.model.Patient_id=row.Patient_id,scope.patient.name=row.First_name+" "+row.Sur_name})};scope.doctor={name:"Select doctor",dialog:{select:function(){doctorSelect()}}},scope.patient={name:"Select patient",dialog:{select:function(){patientSelect()}}};var save=function(){ConfigService.beforeSave(scope.waitingList.errors);var postData=angular.copy(scope.waitingList.model);postData.Creation_date=moment().format("YYYY-MM-DD"),WaitingListModel.add(postData).then(function(response){scope.success=!0},function(error){scope.waitingList.errors=angular.copy(error.data.errors),ConfigService.beforeError(scope.waitingList.errors)})};scope.waitingList={model:angular.copy(model),save:function(){save()}}}}}),angular.module("app.loggedIn.waitingList.directives.list",[]).directive("waitingListList",function($modal,WaitingListModel,ConfigService,$cookieStore,OutreferralModel){return{restrict:"EA",scope:{success:"=",doctorId:"=",clickRow:"&"},templateUrl:"modules/waitingList/directives/templates/list.html",link:function(scope,elem,attrs){var load=function(){WaitingListModel.list().then(function(response){scope.waitingList.list=response.data},function(error){})};scope.waitingList={list:[],load:function(){load()}},scope.waitingList.load()}}}),angular.module("app.loggedIn.waworkcover",["app.loggedIn.waworkcover.controller","app.loggedIn.waworkcover.directive","app.loggedIn.waworkcover.service"]).config(function($stateProvider){$stateProvider.state("loggedIn.waworkcover",{"abstract":!0,templateUrl:"modules/waworkcover/views/structure.html",controller:"WaWorkCoverController"}).state("loggedIn.waworkcover.first",{url:"/wa/workcover/:patient_id/:cal_id/first/:action/:wc_id",views:{"main-content":{templateUrl:"modules/waworkcover/views/first.html",controller:"WaWorkCoverFirstController"}}}).state("loggedIn.waworkcover.progress",{url:"/wa/workcover/:patient_id/:cal_id/progress/:action/:wc_id",views:{"main-content":{templateUrl:"modules/waworkcover/views/progress.html",controller:"WaWorkCoverProgressController"}}}).state("loggedIn.waworkcover.final",{url:"/wa/workcover/:patient_id/:cal_id/final/:action/:wc_id",views:{"main-content":{templateUrl:"modules/waworkcover/views/final.html",controller:"WaWorkCoverFinalController"}}}).state("loggedIn.waworkcover.general",{url:"/wa/workcover/:patient_id/:cal_id/general/:action/:wc_id",views:{"main-content":{templateUrl:"modules/waWorkCover/views/general.html",controller:"WaWorkCoverGeneralController"}}})}),angular.module("app.loggedIn.waworkcover.directive",["app.loggedIn.waworkcover.first.directive","app.loggedIn.waworkcover.progress.directive","app.loggedIn.waworkcover.final.directive","app.loggedIn.waworkcover.general.directive"]),angular.module("app.loggedIn.waworkcover.final.directive",[]).directive("workCoverFinal",function(DocumentService,DoctorService,ReceptionistService,ConfigService,PatientService,toastr,WaWorkCoverService,$state,$cookieStore,CompanyService){return{restrict:"EA",scope:{data:"@",params:"="},templateUrl:"modules/waWorkCover/directives/templates/final.html",link:function(scope,element,attrs){var init=function(){scope.oneAtATime=!1,scope.isSubmit=!1,scope.wafinal={examDate:new Date},PatientService.mdtById(scope.params.patientInfo).then(function(res){"success"===res.status&&""!==res.data&&null!==res.data&&void 0!==res.data&&(scope.patient=res.data,scope.patient.DOB=new Date(scope.patient.DOB),void 0!==scope.patient.company_id&&null!==scope.patient.company_id&&""!==scope.patient.company_id&&CompanyService.mdtById(scope.patient.company_id).then(function(res2){"success"===res2.status&&void 0!==res.data&&null!==res.data&&""!==res.data&&(scope.company=res2.data)}))});var userInfo=$cookieStore.get("userInfo"),apptInfo={user_id:userInfo.id};DocumentService.getDoctor(apptInfo).then(function(result){"error"===result.status?toastr.error("Unexpected error!","Error"):"no doctor"===result.status?toastr.error("The account treating this workcover have no doctor link with it","Error!"):(console.log("this is doctor",result),scope.doctor=result.data[0])}),scope.params.edit===!0&&scope.params.workcover&&WaWorkCoverService.finaldetail(scope.params.workcover).then(function(res){if(res.data){scope.wafinal=res.data;for(var key in scope.wafinal)scope.wafinal[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.wafinal[key]=scope.wafinal[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE")||-1!=key.indexOf("reviewOn")||-1!=key.indexOf("From")||-1!=key.indexOf("To"))&&(scope.wafinal[key]=new Date(scope.wafinal[key])))}})};init(),scope.clearSignature=function(){scope.wafinal.signature=""},scope.clickAction=function(){if(scope.isSubmit=!0,
scope.wafinalform.$invalid)toastr.error("Please fix the red field!","Invalid information");else{var postData=angular.copy(scope.wafinal);postData.cal_id=scope.params.apptInfo,postData.patient_id=scope.params.patientInfo;for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.edit===!1?(postData.Created_by=$cookieStore.get("userInfo").id,WaWorkCoverService.finaladd(postData).then(function(result){console.log("this is insert result",result),"success"===result.status?(toastr.success("Add successfully!","Success!"),$state.go("loggedIn.patient.workcover",{patient_id:scope.params.patientInfo,cal_id:scope.params.apptInfo})):toastr.error("Unexpected Error!","Error!")})):WaWorkCoverService.finaledit(postData.id,postData).then(function(result){"success"===result.status?toastr.success("Edit successfully!","Success!"):toastr.error("Unexpected Error!","Error!")})}},scope.printAssessment=function(){var printId=scope.wafinal.id;WaWorkCoverService.finalprint(printId).then(function(result){})},scope.$watch("wafinal.isFullCapacity",function(fullCapa){"1"!==fullCapa&&(scope.wafinal.fullCapaFrom=null,scope.wafinal.isRequireTreat=null)}),scope.$watch("wafinal.isCapacityForWork",function(isCapacityForWork){"1"!==isCapacityForWork&&(scope.wafinal.capaFrom=null,scope.wafinal.capaHours=null,scope.wafinal.capaDays=null,scope.wafinal.isLiftUp=null,scope.wafinal.isStandUp=null,scope.wafinal.isSitUp=null,scope.wafinal.isWalkUp=null,scope.wafinal.liftUpKg=null,scope.wafinal.standUpMins=null,scope.wafinal.sitUpMins=null,scope.wafinal.walkUpMeter=null,scope.wafinal.isWorkBelow=null,scope.wafinal.capaCmt=null)}),scope.$watch("wafinal.isLiftUp",function(isLiftUp){"1"!==isLiftUp&&(scope.wafinal.liftUpKg=null)}),scope.$watch("wafinal.liftUpKg",function(liftUpKg){scope.wafinal.isLiftUp=void 0!==liftUpKg&&null!==liftUpKg&&""!==liftUpKg?"1":"0"}),scope.$watch("wafinal.isSitUp",function(isSitUp){"1"!==isSitUp&&(scope.wafinal.sitUpMins=null)}),scope.$watch("wafinal.sitUpMins",function(sitUpMins){scope.wafinal.isSitUp=void 0!==sitUpMins&&null!==sitUpMins&&""!==sitUpMins?"1":"0"}),scope.$watch("wafinal.isStandUp",function(isStandUp){"1"!==isStandUp&&(scope.wafinal.standUpMins=null)}),scope.$watch("wafinal.standUpMins",function(standUpMins){scope.wafinal.isStandUp=void 0!==standUpMins&&null!==standUpMins&&""!==standUpMins?"1":"0"}),scope.$watch("wafinal.isWalkUp",function(isWalkUp){"1"!==isWalkUp&&(scope.wafinal.walkUpMeter=null)}),scope.$watch("wafinal.walkUpMeter",function(walkUpMeter){scope.wafinal.isWalkUp=void 0!==walkUpMeter&&null!==walkUpMeter&&""!==walkUpMeter?"1":"0"})}}}),angular.module("app.loggedIn.waworkcover.first.directive",[]).directive("workCoverFirst",function(DocumentService,DoctorService,ReceptionistService,ConfigService,PatientService,toastr,WaWorkCoverService,$state,$cookieStore,CompanyService){return{restrict:"EA",scope:{data:"@",params:"="},templateUrl:"modules/waWorkCover/directives/templates/first.html",link:function(scope,element,attrs){scope.isTakeSignatureFromInjury=!1;var init=function(){scope.oneAtATime=!1,scope.isSubmit=!1,scope.wafirst={examDate:new Date},PatientService.mdtById(scope.params.patientInfo).then(function(res){"success"===res.status&&""!==res.data&&null!==res.data&&void 0!==res.data&&(scope.patient=res.data,scope.patient.DOB=new Date(scope.patient.DOB),void 0!==scope.patient.company_id&&null!==scope.patient.company_id&&""!==scope.patient.company_id&&CompanyService.mdtById(scope.patient.company_id).then(function(res2){"success"===res2.status&&void 0!==res.data&&null!==res.data&&""!==res.data&&(scope.company=res2.data)}))}),console.log(scope.params),WaWorkCoverService.firstGetInjury(scope.params.patientInfo,scope.params.apptInfo).then(function(result){console.log("this is result",result),0!==result.data.length&&(scope.isTakeSignatureFromInjury=!0,scope.wafirst.signature=result.data[0].signature)});var userInfo=$cookieStore.get("userInfo"),apptInfo={user_id:userInfo.id};DocumentService.getDoctor(apptInfo).then(function(result){"error"===result.status?toastr.error("Unexpected error!","Error"):"no doctor"===result.status?toastr.error("The account treating this workcover have no doctor link with it","Error!"):(console.log("this is doctor",result),scope.doctor=result.data[0])}),scope.params.edit===!0&&scope.params.workcover&&WaWorkCoverService.firstdetail(scope.params.workcover).then(function(res){if(res.data){scope.wafirst=res.data;for(var key in scope.wafirst)scope.wafirst[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.wafirst[key]=scope.wafirst[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE")||-1!=key.indexOf("reviewOn")||-1!=key.indexOf("From")||-1!=key.indexOf("To"))&&(scope.wafirst[key]=new Date(scope.wafirst[key])))}})};init(),scope.clearSignature=function(){scope.wafirst.signature=""},scope.clickAction=function(){if(scope.isSubmit=!0,scope.wafirstform.$invalid)toastr.error("Please fix the red field!","Invalid information");else{var postData=angular.copy(scope.wafirst);postData.cal_id=scope.params.apptInfo,postData.patient_id=scope.params.patientInfo;for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.edit===!1?(postData.Created_by=$cookieStore.get("userInfo").id,WaWorkCoverService.firstadd(postData).then(function(result){console.log("this is insert result",result),"success"===result.status?(toastr.success("Add successfully!","Success!"),$state.go("loggedIn.patient.workcover",{patient_id:scope.params.patientInfo,cal_id:scope.params.apptInfo})):toastr.error("Unexpected Error!","Error!")})):WaWorkCoverService.firstedit(postData.Ass_id,postData).then(function(result){"success"===result.status?toastr.success("Edit successfully!","Success!"):toastr.error("Unexpected Error!","Error!")})}},scope.printAssessment=function(){var printId=scope.wafirst.Ass_id;WaWorkCoverService.firstprint(printId).then(function(result){})},scope.$watch("wafirst.isFullCapacity",function(fullCapa){"1"!==fullCapa&&(scope.wafirst.fullCapaFrom=null,scope.wafirst.isRequireTreat=null)}),scope.$watch("wafirst.isSomeCapacity",function(someCapa){"1"!==someCapa&&(scope.wafirst.someCapaFrom=null,scope.wafirst.someCapaTo=null,scope.wafirst.isPreDuties=null,scope.wafirst.isModiDuties=null,scope.wafirst.isWorkModifi=null,scope.wafirst.isPreHours=null,scope.wafirst.isModiHours=null)}),scope.$watch("wafirst.isModiHours",function(isModi){"1"!==isModi&&(scope.wafirst.modiHrs=null,scope.wafirst.modiDays=null)}),scope.$watch("wafirst.modiHrs",function(modiHrs){void 0!==modiHrs&&null!==modiHrs&&""!==modiHrs&&void 0!==scope.wafirst.modiDays&&null!==scope.wafirst.modiDays&&""!==scope.wafirst.modiDays&&"1"!==scope.wafirst.isModiHours&&(scope.wafirst.isModiHours="1")}),scope.$watch("wafirst.modiDays",function(modiDays){void 0!==modiDays&&null!==modiDays&&""!==modiDays&&void 0!==scope.wafirst.modiHrs&&null!==scope.wafirst.modiHrs&&""!==scope.wafirst.modiHrs&&"1"!==scope.wafirst.isModiHours&&(scope.wafirst.isModiHours="1")}),scope.$watch("wafirst.isNoCapacity",function(noCapa){"1"!==noCapa&&(scope.wafirst.noCapaFrom=null,scope.wafirst.noCapaTo=null)}),scope.$watch("wafirst.isLiftUp",function(isLiftUp){"1"!==isLiftUp&&(scope.wafirst.liftUpKg=null)}),scope.$watch("wafirst.liftUpKg",function(liftUpKg){scope.wafirst.isLiftUp=void 0!==liftUpKg&&null!==liftUpKg&&""!==liftUpKg?"1":"0"}),scope.$watch("wafirst.isSitUp",function(isSitUp){"1"!==isSitUp&&(scope.wafirst.sitUpMins=null)}),scope.$watch("wafirst.sitUpMins",function(sitUpMins){scope.wafirst.isSitUp=void 0!==sitUpMins&&null!==sitUpMins&&""!==sitUpMins?"1":"0"}),scope.$watch("wafirst.isStandUp",function(isStandUp){"1"!==isStandUp&&(scope.wafirst.standUpMins=null)}),scope.$watch("wafirst.standUpMins",function(standUpMins){scope.wafirst.isStandUp=void 0!==standUpMins&&null!==standUpMins&&""!==standUpMins?"1":"0"}),scope.$watch("wafirst.isWalkUp",function(isWalkUp){"1"!==isWalkUp&&(scope.wafirst.walkUpMeter=null)}),scope.$watch("wafirst.walkUpMeter",function(walkUpMeter){scope.wafirst.isWalkUp=void 0!==walkUpMeter&&null!==walkUpMeter&&""!==walkUpMeter?"1":"0"}),scope.$watch("wafirst.isReview",function(isReview){"1"!==isReview&&(scope.wafirst.reviewOn=null)}),scope.$watch("wafirst.reviewOn",function(reviewOn){void 0!==reviewOn&&null!==reviewOn&&""!==reviewOn&&(scope.wafirst.isReview="1")})}}}),angular.module("app.loggedIn.waworkcover.progress.directive",[]).directive("workCoverProgress",function(DocumentService,DoctorService,ReceptionistService,ConfigService,PatientService,toastr,WaWorkCoverService,$cookieStore,$state,CompanyService){return{restrict:"EA",scope:{data:"@",params:"="},templateUrl:"modules/waWorkCover/directives/templates/progress.html",link:function(scope,element,attrs){var init=function(){scope.oneAtATime=!1,scope.isSubmit=!1,scope.waprogress={examDate:new Date},PatientService.mdtById(scope.params.patientInfo).then(function(res){"success"===res.status&&""!==res.data&&null!==res.data&&void 0!==res.data&&(scope.patient=res.data,scope.patient.DOB=new Date(scope.patient.DOB),void 0!==scope.patient.company_id&&null!==scope.patient.company_id&&""!==scope.patient.company_id&&CompanyService.mdtById(scope.patient.company_id).then(function(res2){"success"===res2.status&&void 0!==res.data&&null!==res.data&&""!==res.data&&(scope.company=res2.data)}))});var userInfo=$cookieStore.get("userInfo"),apptInfo={user_id:userInfo.id};DocumentService.getDoctor(apptInfo).then(function(result){"error"===result.status?toastr.error("Unexpected error!","Error"):"no doctor"===result.status?toastr.error("The account treating this workcover have no doctor link with it","Error!"):(console.log("this is doctor",result),scope.doctor=result.data[0])}),scope.params.edit===!0&&scope.params.workcover&&WaWorkCoverService.progressdetail(scope.params.workcover).then(function(res){if("success"===res.status&&res.data){scope.waprogress=res.data;for(var key in scope.waprogress)scope.waprogress[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.waprogress[key]=scope.waprogress[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE")||-1!=key.indexOf("reviewOn")||-1!=key.indexOf("From")||-1!=key.indexOf("To"))&&(scope.waprogress[key]=new Date(scope.waprogress[key])))}})};init(),scope.clearSignature=function(){scope.waprogress.signature=""},scope.clickAction=function(){if(scope.isSubmit=!0,scope.waprogressform.$invalid)toastr.error("Please fix the red field!","Invalid information");else{var postData=angular.copy(scope.waprogress);postData.cal_id=scope.params.apptInfo,postData.patient_id=scope.params.patientInfo;for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.edit===!1?(postData.Created_by=$cookieStore.get("userInfo").id,WaWorkCoverService.progressadd(postData).then(function(result){console.log("this is insert result",result),"success"===result.status?(toastr.success("Add successfully!","Success!"),$state.go("loggedIn.patient.workcover",{patient_id:scope.params.patientInfo,cal_id:scope.params.apptInfo})):toastr.error("Unexpected Error!","Error!")})):WaWorkCoverService.progressedit(postData.progress_id,postData).then(function(result){"success"===result.status?toastr.success("Edit successfully!","Success!"):toastr.error("Unexpected Error!","Error!")})}},scope.printAssessment=function(){var printId=scope.waprogress.progress_id;WaWorkCoverService.progressprint(printId).then(function(result){})},scope.$watch("waprogress.isFullCapacity",function(fullCapa){"1"!==fullCapa&&(scope.waprogress.fullCapaFrom=null,scope.waprogress.isRequireTreat=null)}),scope.$watch("waprogress.isSomeCapacity",function(someCapa){"1"!==someCapa&&(scope.waprogress.someCapaFrom=null,scope.waprogress.someCapaTo=null,scope.waprogress.isPreDuties=null,scope.waprogress.isModiDuties=null,scope.waprogress.isWorkModifi=null,scope.waprogress.isPreHours=null,scope.waprogress.isModiHours=null)}),scope.$watch("waprogress.isModiHours",function(isModi){"1"!==isModi&&(scope.waprogress.modiHrs=null,scope.waprogress.modiDays=null)}),scope.$watch("waprogress.modiHrs",function(modiHrs){void 0!==modiHrs&&null!==modiHrs&&""!==modiHrs&&void 0!==scope.waprogress.modiDays&&null!==scope.waprogress.modiDays&&""!==scope.waprogress.modiDays&&"1"!==scope.waprogress.isModiHours&&(scope.waprogress.isModiHours="1")}),scope.$watch("waprogress.modiDays",function(modiDays){void 0!==modiDays&&null!==modiDays&&""!==modiDays&&void 0!==scope.waprogress.modiHrs&&null!==scope.waprogress.modiHrs&&""!==scope.waprogress.modiHrs&&"1"!==scope.waprogress.isModiHours&&(scope.waprogress.isModiHours="1")}),scope.$watch("waprogress.isNoCapacity",function(noCapa){"1"!==noCapa&&(scope.waprogress.noCapaFrom=null,scope.waprogress.noCapaTo=null)}),scope.$watch("waprogress.isLiftUp",function(isLiftUp){"1"!==isLiftUp&&(scope.waprogress.liftUpKg=null)}),scope.$watch("waprogress.liftUpKg",function(liftUpKg){scope.waprogress.isLiftUp=void 0!==liftUpKg&&null!==liftUpKg&&""!==liftUpKg?"1":"0"}),scope.$watch("waprogress.isSitUp",function(isSitUp){"1"!==isSitUp&&(scope.waprogress.sitUpMins=null)}),scope.$watch("waprogress.sitUpMins",function(sitUpMins){scope.waprogress.isSitUp=void 0!==sitUpMins&&null!==sitUpMins&&""!==sitUpMins?"1":"0"}),scope.$watch("waprogress.isStandUp",function(isStandUp){"1"!==isStandUp&&(scope.waprogress.standUpMins=null)}),scope.$watch("waprogress.standUpMins",function(standUpMins){scope.waprogress.isStandUp=void 0!==standUpMins&&null!==standUpMins&&""!==standUpMins?"1":"0"}),scope.$watch("waprogress.isWalkUp",function(isWalkUp){"1"!==isWalkUp&&(scope.waprogress.walkUpMeter=null)}),scope.$watch("waprogress.walkUpMeter",function(walkUpMeter){scope.waprogress.isWalkUp=void 0!==walkUpMeter&&null!==walkUpMeter&&""!==walkUpMeter?"1":"0"}),scope.$watch("waprogress.activities_1",function(activities_1){(null===activities_1||void 0===activities_1||""===activities_1)&&(scope.waprogress.outcome_1=null,scope.waprogress.isRequired_1=null)}),scope.$watch("waprogress.activities_2",function(activities_2){(null===activities_2||void 0===activities_2||""===activities_2)&&(scope.waprogress.outcome_2=null,scope.waprogress.isRequired_2=null)}),scope.$watch("waprogress.activities_3",function(activities_3){(null===activities_3||void 0===activities_3||""===activities_3)&&(scope.waprogress.outcome_3=null,scope.waprogress.isRequired_3=null)}),scope.$watch("waprogress.activities_4",function(activities_4){(null===activities_4||void 0===activities_4||""===activities_4)&&(scope.waprogress.outcome_4=null,scope.waprogress.isRequired_4=null)}),scope.$watch("waprogress.activities_5",function(activities_5){(null===activities_5||void 0===activities_5||""===activities_5)&&(scope.waprogress.outcome_5=null,scope.waprogress.isRequired_5=null)}),scope.$watch("waprogress.activities_6",function(activities_6){(null===activities_6||void 0===activities_6||""===activities_6)&&(scope.waprogress.outcome_6=null,scope.waprogress.isRequired_6=null)}),scope.$watch("waprogress.isReview",function(isReview){"1"!==isReview&&(scope.waprogress.reviewOn=null)}),scope.$watch("waprogress.reviewOn",function(reviewOn){void 0!==reviewOn&&null!==reviewOn&&""!==reviewOn&&(scope.waprogress.isReview="1")})}}}),angular.module("app.loggedIn.waworkcover.general.directive",[]).directive("workCoverGeneral",function(DocumentService,PatientService,InsurerService,ReceptionistService,WaWorkCoverService,DoctorService,ConfigService,$state,$cookieStore,toastr,CompanyService){return{restrict:"EA",scope:{data:"@",params:"="},templateUrl:"modules/waWorkCover/directives/templates/general.html",link:function(scope,element,attrs){var init=function(){scope.oneAtATime=!1,scope.isOpen=!0,scope.isSubmit=!1,scope.generalwc={examDate:new Date},PatientService.mdtById(scope.params.patientInfo).then(function(res){"success"===res.status&&res.data&&(scope.patient=res.data,scope.patient.fullname=scope.patient.First_name,scope.patient.Middle_name&&(scope.patient.fullname=scope.patient.fullname+" "+scope.patient.Middle_name),scope.patient.fullname=scope.patient.fullname+" "+scope.patient.Sur_name,scope.patient.DOB=new Date(scope.patient.DOB),scope.patient.company_id&&CompanyService.mdtById(scope.patient.company_id).then(function(res2){"success"===res2.status&&res2.data&&(scope.companyInfo=res2.data,scope.companyInfo.Insurer&&InsurerService.detail(scope.companyInfo.Insurer).then(function(res3){"success"===res3.status&&res3.row&&(scope.insurer=res3.row)}))}))});var userInfo=$cookieStore.get("userInfo"),apptInfo={user_id:userInfo.id};DocumentService.getDoctor(apptInfo).then(function(result){"error"===result.status?toastr.error("Unexpected error!","Error"):"no doctor"===result.status?toastr.error("The account treating this workcover have no doctor link with it","Error!"):(console.log("this is doctor",result),scope.doctor=result.data[0])}),scope.params.edit===!0&&scope.params.workcover&&WaWorkCoverService.generaldetail(scope.params.workcover).then(function(res){if(res.data){scope.generalwc=res.data;for(var key in scope.generalwc)scope.generalwc[key]&&((-1!=key.indexOf("is")||-1!=key.indexOf("Is")||-1!=key.indexOf("IS"))&&(scope.generalwc[key]=scope.generalwc[key].toString()),(-1!=key.indexOf("date")||-1!=key.indexOf("Date")||-1!=key.indexOf("DATE")||-1!=key.indexOf("reviewOn")||-1!=key.indexOf("From")||-1!=key.indexOf("To"))&&(scope.generalwc[key]=new Date(scope.generalwc[key])))}})};init(),scope.clickAction=function(){if(scope.isSubmit=!0,scope.generalform.$invalid)toastr.error("Please fix the red field!","Invalid information");else{var postData=angular.copy(scope.generalwc);postData.cal_id=scope.params.apptInfo,postData.patient_id=scope.params.patientInfo;for(var key in postData)postData[key]instanceof Date&&(postData[key]=ConfigService.getCommonDate(postData[key]));scope.params.edit===!1?(postData.Created_by=$cookieStore.get("userInfo").id,WaWorkCoverService.generaladd(postData).then(function(result){"success"===result.status?(toastr.success("Add successfully!","Success!"),$state.go("loggedIn.patient.workcover",{patient_id:scope.params.patientInfo,cal_id:scope.params.apptInfo})):toastr.error("Unexpected error!","Error!")})):WaWorkCoverService.generaledit(postData.id,postData).then(function(result){"success"===result.status?toastr.success("Edit successfully!","Success!"):toastr.error("Unexpected Error!","Error!")})}}}}}),angular.module("app.loggedIn.waworkcover.controller",["app.loggedIn.waworkcover.first.controller","app.loggedIn.waworkcover.progress.controller","app.loggedIn.waworkcover.final.controller","app.loggedIn.waworkcover.general.controller"]).controller("WaWorkCoverController",function(){}),angular.module("app.loggedIn.waworkcover.final.controller",[]).controller("WaWorkCoverFinalController",function($scope,$stateParams){var patientInfo=$stateParams.patient_id,apptInfo=$stateParams.cal_id,editMode=!1,wc_id=$stateParams.wc_id;editMode="edit"!==$stateParams.action?!1:!0,$scope.params={edit:editMode,patientInfo:patientInfo,apptInfo:apptInfo,workcover:wc_id}}),angular.module("app.loggedIn.waworkcover.first.controller",[]).controller("WaWorkCoverFirstController",function($scope,$stateParams){var patientInfo=$stateParams.patient_id,apptInfo=$stateParams.cal_id,editMode=!1,wc_id=$stateParams.wc_id;editMode="edit"!==$stateParams.action?!1:!0,$scope.params={edit:editMode,patientInfo:patientInfo,apptInfo:apptInfo,workcover:wc_id}}),angular.module("app.loggedIn.waworkcover.progress.controller",[]).controller("WaWorkCoverProgressController",function($scope,$stateParams){var patientInfo=$stateParams.patient_id,apptInfo=$stateParams.cal_id,editMode=!1,wc_id=$stateParams.wc_id;editMode="edit"!==$stateParams.action?!1:!0,$scope.params={edit:editMode,patientInfo:patientInfo,apptInfo:apptInfo,workcover:wc_id}}),angular.module("app.loggedIn.waworkcover.general.controller",[]).controller("WaWorkCoverGeneralController",function($scope,$stateParams){var patientInfo=$stateParams.patient_id,apptInfo=$stateParams.cal_id,editMode=!1,wc_id=$stateParams.wc_id;editMode="edit"!==$stateParams.action?!1:!0,$scope.params={edit:editMode,patientInfo:patientInfo,apptInfo:apptInfo,workcover:wc_id}}),angular.module("app.loggedIn.waworkcover.service",[]).factory("WaWorkCoverService",function(Restangular){var mdtService={},mdtApi=Restangular.all("api/meditek/v1/");return mdtService.firstadd=function(postData){var funcApi=mdtApi.all("wa/workcover/first/add");return funcApi.post({add_data:postData})},mdtService.firstsearch=function(option){var funcApi=mdtApi.all("wa/workcover/first/search");return funcApi.post(option)},mdtService.firstdetail=function(wc_id){var funcApi=mdtApi.all("wa/workcover/first/detail");return funcApi.post({ID:wc_id})},mdtService.firstedit=function(id,postData){var funcApi=mdtApi.all("wa/workcover/first/edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.firstGetInjury=function(patient_id,cal_id){var funcApi=mdtApi.all("wa/workcover/first/getinjury");return funcApi.post({patient_id:patient_id,cal_id:cal_id})},mdtService.firstprint=function(id){var funcApi=mdtApi.one("wa/workcover/first/print/"+id);return funcApi.get()},mdtService.progressadd=function(postData){var funcApi=mdtApi.all("wa/workcover/progress/add");return funcApi.post({add_data:postData})},mdtService.progresssearch=function(option){var funcApi=mdtApi.all("wa/workcover/progress/search");return funcApi.post(option)},mdtService.progressedit=function(id,postData){var funcApi=mdtApi.all("wa/workcover/progress/edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.progressdetail=function(wc_id){var funcApi=mdtApi.all("wa/workcover/progress/detail");return funcApi.post({ID:wc_id})},mdtService.progressprint=function(id){var funcApi=mdtApi.one("wa/workcover/progress/print/"+id);return funcApi.get()},mdtService.finaladd=function(postData){var funcApi=mdtApi.all("wa/workcover/final/add");return funcApi.post({add_data:postData})},mdtService.finalsearch=function(option){var funcApi=mdtApi.all("wa/workcover/final/search");return funcApi.post(option)},mdtService.finaledit=function(id,postData){var funcApi=mdtApi.all("wa/workcover/final/edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.finaldetail=function(wc_id){var funcApi=mdtApi.all("wa/workcover/final/detail");return funcApi.post({ID:wc_id})},mdtService.finalprint=function(id){var funcApi=mdtApi.one("wa/workcover/final/print/"+id);return funcApi.get()},mdtService.generaladd=function(postData){var funcApi=mdtApi.all("wa/workcover/general/add");return funcApi.post(postData)},mdtService.generaledit=function(id,postData){var funcApi=mdtApi.all("wa/workcover/general/edit");return funcApi.post({edit_data:postData,edit_id:id})},mdtService.generaldetail=function(wc_id){var funcApi=mdtApi.all("wa/workcover/general/detail");return funcApi.post({ID:wc_id})},mdtService}),angular.module("app.loggedIn.timesheet.create.controller",[]).controller("TimesheetCreateController",function($rootScope,ConfigService,$scope,$stateParams,$cookieStore,$filter,$modal,calendarHelper,moment,StaffService,$state,toastr,FileUploader,$timeout){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.info={},$scope.info.time_temp=0,$scope.info.time_charge=0,$scope.tasks||($scope.tasks=[]),$scope.info||($scope.info={}),$scope.itemList=[],$scope.calendarDay=new Date,$scope.info.userID=$cookieStore.get("userInfo").id;var startWeek,endWeek;$scope.task={order:null,task:null,date:null,department_code_id:null,location_id:null,activity_id:null,time_charge:null,time_temp:0,isInputItem:!1,isBillable:!1,item:[]},$scope.CheckTimeInLieu=function(){var info={date:new Date,userId:void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null};StaffService.CheckTimeInLieu(info).then(function(response){if("error"===response.status)toastr.error("Check Time in Lieu fail!","Fail");else if("success"===response.status){var timeInLieu=response.time_in_lieu,hours=parseInt(timeInLieu/60),minutes=timeInLieu%60;10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes);var notification="You have "+hours+" hours "+minutes+" minutes for Time in Lieu!";swal(notification)}else $state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error")})},$scope.ChangeTimeCharge=function(){var sum=0,sumInLieu=0;angular.forEach($scope.tasks,function(data,index){$scope.tasks[index].time_temp=StaffService.ConvertShowToFull(data.time_charge),null!==data.time_charge&&void 0!==data.time_charge&&"delete"!==data.isAction&&null!==data.activity_id&&""!==data.time_charge&&0!==data.time_charge.length&&(sum+=parseInt(StaffService.ConvertShowToFull(data.time_charge))),void 0!==data.item&&null!==data.item&&0!==data.length&&angular.forEach(data.item,function(value,index){void 0!==value&&null!==value&&22==value.ITEM_ID&&"delete"!==value.isAction&&""!==value.time_charge&&0!==value.time_charge.length&&(sumInLieu+=StaffService.ConvertShowToFull(value.time_charge))})}),$scope.info.time_in_lieuFull=sumInLieu,$scope.info.time_temp=sum,$scope.info.time_charge=StaffService.ConvertFromFullToShow(sum),0===sum&&($scope.info.time_charge=null)},$scope.ChangeActivity=function(activity_id,index){if($scope.tasks[index].time_charge=null,$scope.tasks[index].time_temp=null,$scope.tasks[index].item=[],$scope.tasks[index].task=null,5===activity_id)if(6===$scope.tasks[index].date.getDay()||0===$scope.tasks[index].date.getDay()){var item={};item.isAction="insert",item.time_temp=0,item.totalUnits=0,item.ratio=0,item.time_charge="0000",item.ITEM_ID=18,item.ITEM_NAME="Weekend Leave",$scope.tasks[index].item.push(item),$scope.tasks[index].time_charge="0000",$scope.tasks[index].time_temp=0,$scope.tasks[index].notPopup=!0}else $scope.tasks[index].notPopup=!1;else $scope.tasks[index].notPopup=!1;$scope.ChangeTimeCharge()},$scope.GetWeekNumber=function(date){var d=new Date(+date);d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo};var info={date:new Date,userId:void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null};StaffService.CheckTimeInLieu(info).then(function(response){"error"===response.status?toastr.error("Check Time in Lieu fail!","Fail"):"success"===response.status?$scope.info.time_in_lieuHas=response.time_in_lieu:($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))}),$scope.CheckTaskWeek=function(date){startWeek=$filter("date")(date,"yyyy-MM-dd"),$scope.info.startWeek=startWeek,StaffService.CheckTaskWeek($scope.info).then(function(response){"fail"===response.status||"error"===response.status?toastr.error("Error","Error"):"no"!==response.data?($scope.tasks=[],angular.forEach(response.data,function(data){data.isEdit=!0,$scope.tasks.push(data)})):$scope.CreateDataNewTimesheet()})},$scope.CreateDataNewTimesheet=function(){$scope.orgiTask=angular.copy($scope.tasks),$scope.tasks=[],$scope.viewWeek=calendarHelper.getWeekView(date,!0),angular.forEach($scope.viewWeek.columns,function(data,index){$scope.task={order:$scope.orgiTask[index].order,task:$scope.orgiTask[index].task,date:data.dateChosen,department_code_id:$scope.orgiTask[index].department_code_id,location_id:$scope.orgiTask[index].location_id,activity_id:$scope.orgiTask[index].activity_id,time_charge:$scope.orgiTask[index].time_charge,isInputItem:$scope.orgiTask[index].isInputItem,isBillable:$scope.orgiTask[index].isBillable,isParent:$scope.orgiTask[index].isParent,item:$scope.orgiTask[index].item},$scope.tasks.push($scope.task)})},$scope.CheckFirstTaskWeek=function(){$scope.tasks=[],StaffService.CheckFirstTaskWeek($scope.info).then(function(response){"error"===response.status?toastr.error("Error","Error"):($scope.isEdit=!1,"success"===response.status?$scope.nextDay=moment(response.maxDate).add(7,"day").toDate():"no maxDate"===response.status&&($scope.nextDay=moment($scope.calendarDay).add(7,"day").toDate()),$scope.viewWeek=calendarHelper.getWeekView($scope.nextDay,!0),angular.forEach($scope.viewWeek.columns,function(data,index){$scope.task={order:index+1,task:null,date:data.dateChosen,department_code_id:null,location_id:null,activity_id:null,time_charge:null,isInputItem:!1,isBillable:!1,isParent:1,item:[]},$scope.tasks.push($scope.task)})),void 0!==$scope.tasks&&null!==$scope.tasks&&0!==$scope.tasks.length&&void 0!==$scope.tasks[0]&&($scope.dateWeekFrom=$filter("date")($scope.tasks[0].date,"dd/MM/yyyy")),$scope.SetValueDefaultWeekend()})},$scope.SetValueDefaultWeekend=function(){if(void 0!==$scope.tasks&&null!==$scope.tasks&&0!==$scope.tasks.length&&void 0!==$scope.tasks[$scope.tasks.length-1]&&void 0!==$scope.tasks[$scope.tasks.length-2]){if($scope.tasks[$scope.tasks.length-1].activity_id=5,$scope.tasks[$scope.tasks.length-2].activity_id=5,void 0!==$scope.tasks[$scope.tasks.length-1].item&&null!==$scope.tasks[$scope.tasks.length-1].item){var item={};item.isAction="insert",item.time_temp=0,item.totalUnits=0,item.ratio=0,item.time_charge="0000",item.ITEM_ID=18,item.ITEM_NAME="Weekend Leave",$scope.tasks[$scope.tasks.length-1].item.push(item),$scope.tasks[$scope.tasks.length-1].time_charge="0000",$scope.tasks[$scope.tasks.length-1].time_temp=0,$scope.tasks[$scope.tasks.length-1].notPopup=!0}if(void 0!==$scope.tasks[$scope.tasks.length-2].item&&null!==$scope.tasks[$scope.tasks.length-2].item){var item={};item.isAction="insert",item.time_temp=0,item.totalUnits=0,item.ratio=0,item.time_charge="0000",item.ITEM_ID=18,item.ITEM_NAME="Weekend Leave",$scope.tasks[$scope.tasks.length-2].item.push(item),$scope.tasks[$scope.tasks.length-2].time_charge="0000",$scope.tasks[$scope.tasks.length-2].time_temp=0,$scope.tasks[$scope.tasks.length-2].notPopup=!0}}},$scope.AssignDataTimesheet=function(dataTimesheet){angular.forEach(dataTimesheet.data,function(data,indexData){data.item=[],data.isEdit=!0,data.time_temp=data.time_charge,data.isAction="update",null!==data.time_charge&&(data.time_charge=StaffService.ConvertFromFullToShow(data.time_charge)),angular.forEach(dataTimesheet.item,function(item){void 0!==dataTimesheet.item&&dataTimesheet.item[0]&&void 0!==dataTimesheet.item[0].task_status_id&&($scope.checkStatus=dataTimesheet.item[0].task_status_id,$scope.afterStatusID=dataTimesheet.item[0].after_status_id),data.tasks_id===item.tasks_id&&null!==item.ITEM_ID&&0===item.deleted&&(item.isAction="update",item.time_temp=item.time_charge,item.deleted=item.deleted,item.totalUnits=item.units,item.ratio=item.ratio,item.task_id=item.task_id,item.time_charge=StaffService.ConvertFromFullToShow(item.time_charge),item.fileUpload=[],angular.forEach(dataTimesheet.file,function(valueFile,indexFile){valueFile.tasks_id===item.tasks_id&&valueFile.ITEM_ID===item.ITEM_ID&&item.fileUpload.push({file_name:valueFile.file_name,file_id:valueFile.file_id,isAction:"update"})}),data.item.push(item))}),$scope.tasks.push(data),$scope.ChangeTimeCharge()})},$scope.LoadOldTimesheet=function(){var info={idWeek:$stateParams.id,userId:$cookieStore.get("userInfo").id};StaffService.ShowEdit(info).then(function(response){void 0!==response.data&&void 0!==response.data[0]&&void 0!==response.data[0].date&&($scope.dateStart=response.data[0].date),"fail"==response.status?angular.forEach(response.data,function(data){data.item=[],data.isEdit=!0,data.time_temp=data.time_charge,data.isAction="update",null!==data.time_charge&&(data.time_charge=StaffService.ConvertFromFullToShow(data.time_charge)),$scope.tasks.push(data),$scope.ChangeTimeCharge()}):"success"===response.status?($scope.uploader=new FileUploader({url:"/api/TimeSheet/post-upload-file",method:"POST",autoUpload:!0,formData:[{userId:$cookieStore.get("userInfo").id}],isHTML5:!0,isUploading:!0}),$scope.AssignDataTimesheet(response)):"error"===response.status&&($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load fail!","Error"))})},$scope.LoadInfo=function(){
$scope.tasks.loading=!0,StaffService.GetDepartmentLocationActivity().then(function(response){"fail"==response.status||"error"==response.status?toastr.error("Error","Error"):($scope.departments=response.department,$scope.locations=response.location,$scope.activities=response.activity,$stateParams.id?($scope.isEdit=!0,$scope.LoadOldTimesheet()):($scope.isEdit=!1,$scope.CheckFirstTaskWeek()))}),$scope.tasks.loading=!1},$scope.LoadTypeOfContrack=function(){var USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null;StaffService.LoadContract(USER_ID).then(function(contruct){"success"===contruct.status&&void 0!==contruct.result[0]&&void 0!==contruct.result[0].TypeOfContruct?$scope.TypeOfContruct=contruct.result[0].TypeOfContruct:toastr.error("User not type of contruct!, Please notification Admin","Error")})},$scope.LoadTypeOfContrack(),$scope.LoadInfo(),$scope.AddRow=function(index,date){for(var j=0,i=index;i<$scope.tasks.length;i++)$scope.tasks[i].date==date&&j++;task={order:1+j,task:null,date:date,department_code_id:null,location_id:null,activity_id:null,time_charge:null,isEdit:!1,isInputItem:!1,isBillable:!1,isAction:"insert",item:[]},$scope.tasks.splice(index+j,0,task),angular.forEach($scope.tasks,function(data,index){$scope.tasks[index].order=index+1})};var dateFrom;$scope.ChangeDate=function(){dateFrom=new Date($scope.dateWeekFrom.substr(6,4),$scope.dateWeekFrom.substr(3,2)-1,$scope.dateWeekFrom.substr(0,2)),$scope.CheckTaskWeek(dateFrom)},$scope.DelTask=function(index,order){1!=order&&swal({title:"Are you sure delete this row?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){if("insert"==$scope.tasks[index].isAction)$scope.tasks.splice(index,1),angular.forEach($scope.tasks,function(data,index){$scope.tasks[index].order=index+1});else if("update"==$scope.tasks[index].isAction){$scope.tasks[index].isAction="delete";for(var i=index+1;i<$scope.tasks.length;i++)$scope.tasks[i].order-=1}$scope.ChangeTimeCharge()})},$scope.ActionTimesheet=function(status,formValid){$scope.info.time_temp<2280&&"Full-time"===$scope.TypeOfContruct&&1!==status?toastr.warning("Please check time charge(>=38)","Error"):$scope.info.time_in_lieuFull>$scope.info.time_in_lieuHas&&1!==status?toastr.warning("Please check time in lieu use larger time in lieu you have!","Fail"):formValid.$invalid?toastr.error("Please Input All Required Information!","Error"):$scope.isEdit===!1?$scope.AddAllTask(status):$scope.isEdit===!0&&$scope.EditTask(status)},$scope.AddAllTask=function(status){startWeek=$filter("date")($scope.viewWeek.startWeek,"yyyy-MM-dd"),endWeek=$filter("date")($scope.viewWeek.endWeek,"yyyy-MM-dd"),$scope.info.startWeek=startWeek,$scope.info.endWeek=endWeek,$scope.info.statusID=status,$scope.info.weekNo=$scope.GetWeekNumber($scope.viewWeek.startWeek),StaffService.AddAllTask($scope.tasks,$scope.info).then(function(response){"success"==response.status?(toastr.success("success","Success"),$state.go("loggedIn.timesheetHome.timesheetHistory",null,{reload:!0})):toastr.error("Error","Error")})},$scope.EditTask=function(status){$scope.info.idWeek=$stateParams.id,$scope.info.statusID=status,StaffService.EditTask($scope.tasks,$scope.info).then(function(response){"success"==response.status?(toastr.success("Update Timesheet success!","Success"),$state.go("loggedIn.timesheetHome.timesheetHistory",null,{reload:!0})):toastr.error("Update Timesheet fail!","Error")})},$scope.ChooseItem=function(task,uploader,statusEdit,taskIndex){if(void 0!==task&&1===task.activity_id){void 0!==$scope.locations&&null!==$scope.locations&&0!==$scope.locations.length&&angular.forEach($scope.locations,function(location,index){location.location_id===task.location_id&&(task.locationName=location.NAME)}),void 0!==$scope.departments&&null!==$scope.departments&&0!==$scope.departments.length&&angular.forEach($scope.departments,function(department,index){$scope.departments[index].departmentid===task.department_code_id&&(task.departmentName=$scope.departments[index].departmentName)});var modalInstance=$modal.open({templateUrl:"ItemCode",controller:function($scope){$scope.items=angular.copy(task),$scope.ClickCancel=function(){modalInstance.close({type:"cancel"})},$scope.ClickSave=function(info,formValid){if(formValid.$invalid===!0)toastr.warning("Please Input All Required Information!","Error");else{if(void 0!==info&&null!==info)for(var i=0;i<info.length;i++)info[i].time_temp=StaffService.ConvertShowToFull(info[i].time_charge);modalInstance.close({type:"ok",value:info})}}},size:"lg"});modalInstance.result.then(function(obj){if("ok"==obj.type){var list=[];if(list=obj.value,task.item=list,list.length>0){for(var t=[],c=0,i=0;i<list.length;i++)"delete"!==list[i].isAction&&list[i].show===!0&&(t.push(list[i].ITEM_ID),c+=StaffService.ConvertShowToFull(list[i].time_charge));task.task=t.join(" , "),task.time_charge=StaffService.ConvertFromFullToShow(c),task.time_temp=c,$scope.ChangeTimeCharge()}else task.task=null,task.time_charge=null,$scope.ChangeTimeCharge()}})}else if(void 0!==task){void 0!==$scope.locations&&null!==$scope.locations&&0!==$scope.locations.length&&angular.forEach($scope.locations,function(location,index){location.location_id===task.location_id&&(task.locationName=location.NAME)}),void 0!==$scope.departments&&null!==$scope.departments&&0!==$scope.departments.length&&angular.forEach($scope.departments,function(department,index){$scope.departments[index].departmentid===task.department_code_id&&(task.departmentName=$scope.departments[index].departmentName)});var modalInstanceAC=$modal.open({templateUrl:"ActivityDetail",controller:function($scope){$scope.activities=angular.copy(task),$scope.activities.uploader=uploader,$scope.activities.taskIndex=taskIndex,statusEdit===!0&&($scope.activities.id_task_week=$stateParams.id),$scope.ClickCancel=function(){modalInstanceAC.close({type:"cancel"})},$scope.ClickSave=function(info,formValid,upload){if(formValid.$invalid===!0)toastr.warning("Please Input All Required Information!","Error");else{if(void 0!==info&&null!==info)for(var i=0;i<info.length;i++)info[i].time_temp=StaffService.ConvertShowToFull(info[i].time_charge);modalInstanceAC.close({type:"ok",value:info,valueUpload:upload})}}},size:"lg"});modalInstanceAC.result.then(function(obj){if("ok"==obj.type){var list=[];if(list=obj.value,task.item=list,list.length>0){for(var t=[],c=0,i=0;i<list.length;i++)"delete"!==list[i].isAction&&list[i].show===!0&&(t.push(list[i].ITEM_NAME),c+=StaffService.ConvertShowToFull(list[i].time_charge));task.task=t.join(" , "),task.time_charge=StaffService.ConvertFromFullToShow(c),task.time_temp=c,$scope.ChangeTimeCharge()}else task.task=null,task.time_charge=null,$scope.ChangeTimeCharge()}})}},$scope.SetCalendarToToday=function(){$scope.calendarDay=new Date},$scope.toggle=function($event,field,event){$event.preventDefault(),$event.stopPropagation(),event[field]=!event[field]},StaffService.ShowWeek($scope.info.userID)}),angular.module("app.loggedIn.timesheet.view.controller",[]).controller("TimesheetViewController",function($rootScope,$scope,MODE_ROW,$filter,$cookieStore,ConfigService,$modal,calendarHelper,moment,StaffService,$state,toastr){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.listStatus=[{code:1,name:"Awaiting for Submit"},{code:2,name:"Submitted"},{code:3,name:"Approved"},{code:4,name:"Rejected"},{code:5,name:"Re-submitted"}],$scope.SetPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.LoadList()},$scope.Reset=function(){$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.LoadList(),$scope.dateWeekFrom=null},$scope.LoadList=function(){StaffService.GetAllTaskAMonth($scope.searchObjectMap).then(function(response){"error"==response.status?toastr.error("Error","Error"):"no task"==response.status?$scope.list=response:$scope.list=response})},$scope.GetFortMatTimeCharge=function(val){return StaffService.GetFortMatTimeCharge(val)},$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo};var Init=function(){$scope.rows=MODE_ROW,$scope.searchObject={limit:10,offset:0,maxSize:5,currentPage:1,userID:void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,week_no:null,order:{0:"DESC"},select:{"time_tasks_week.task_status_id":null}},$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.list={},$scope.LoadList()};Init(),$scope.ChangeDate=function(dateValue){var dateFrom=new Date(dateValue.substr(6,4),dateValue.substr(3,2)-1,dateValue.substr(0,2));$scope.searchObjectMap.week_no=$scope.GetWeekNumber(dateFrom),$scope.searchObjectMap.dateFrom=dateFrom,$scope.LoadList()},$scope.tasks||($scope.tasks=[]),$scope.isEdit=!1,$scope.task={order:null,task:null,date:null,department_code_id:null,location_id:null,activity_id:null,time_charge:null},$scope.calendarDay=new Date,$scope.OrderWeek=function(type){"desc"==type?($scope.list.result=$filter("orderBy")($scope.list.result,"week_no",!0),$scope.isAsc=!1):($scope.list.result=$filter("orderBy")($scope.list.result,"week_no",!1),$scope.isAsc=!0)},$scope.ChooseItem=function(task){$modal.open({templateUrl:"modules/TimeSheet/views/itemModal.html",controller:"ItemController",size:"md"})},$scope.View=function(item){$modal.open({templateUrl:"modules/TimeSheet/views/viewTimesheetByHour.html",controller:"ViewTimesheetByHourController",size:"lg",resolve:{infoWeek:function(){return item}}})},$scope.ClickAsc=function(){$scope.searchObjectMap.order[0]="ASC",$scope.LoadList()},$scope.ClickDesc=function(){$scope.searchObjectMap.order[0]="DESC",$scope.LoadList()},StaffService.ShowWeek()}).controller("ViewDetailController",function($rootScope,$modalInstance,$modal,$scope,$cookieStore,$filter,ConfigService,calendarHelper,moment,StaffService,$state,toastr,infoWeek){$scope.tasks||($scope.tasks=[]),$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo};var info={date:new Date,userId:void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null};$scope.CheckTimeInLieu=function(info){StaffService.CheckTimeInLieu(info).then(function(response){if("error"===response.status)toastr.error("Check Time in Lieu fail!","Fail");else if("success"===response.status){var timeInLieu=0;angular.forEach(response.result,function(data,index){timeInLieu+=data.time_in_lieu}),$scope.time_in_lieuHas=timeInLieu}else $state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error")})},$scope.CheckTimeInLieu(info),$scope.GetDay=function(day){var date=new Date(day);return 0===date.getDay()?7:date.getDay()},$scope.week=infoWeek,$scope.GetFortMatTimeCharge=function(val){return StaffService.GetFortMatTimeCharge(val)},$scope.CancelClick=function(){$modalInstance.close()},$scope.OkClick=function(){$modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetCreate",{id:infoWeek.task_week_id})},$scope.SubmitOnView=function(info){$scope.week.time_charge<2280?toastr.warning("Please check time charge(>=38)","Error"):$scope.time_in_lieuChoose>$scope.time_in_lieuHas?toastr.warning("Please check time in lieu use larger time in lieu you have!","Fail"):(info.status=0,"Awaiting for Submit"==info.STATUS?info.status=2:"Rejected"==info.STATUS&&(info.status=5),StaffService.SubmitOnView(info).then(function(response){"error"===response.status?(toastr.error("Submit fail!","Error"),$modalInstance.close()):"success"===response.status&&($modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetHistory",null,{reload:!0}),toastr.success("Submit success","Success"))}))},$scope.LoadInfo=function(idTaskWeek){$scope.tasks.loading=!0,StaffService.GetTask(idTaskWeek).then(function(response){if("fail"==response.status||"error"==response.status)toastr.error("Error","Error");else if("success"==response.status){var result=response.data;void 0!==result&&void 0!==result[0]&&($scope.ID_WEEK=result[0].tasks_week_id,$scope.STATUS=result[0].STATUS,$scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,$scope.after_status_id=result[0].after_status_id,$scope.time_in_lieuChoose=result[0].time_in_lieuChoose,$scope.submitOnView={},$scope.submitOnView.STATUS=$scope.STATUS,$scope.submitOnView.ID_WEEK=$scope.ID_WEEK,$scope.submitOnView.USER_ID=$scope.USER_ID,$scope.employee_name=null===result[0].FirstName||""===result[0].FirstName?null===result[0].LastName||""===result[0].LastName?" ":result[0].LastName:result[0].FirstName+" "+(null===result[0].LastName||""===result[0].LastName?" ":result[0].LastName)),$scope.one=!0,$scope.Title="Timesheet Detail",$scope.tasks=_.filter(response.data,function(data){return data.date==infoWeek.date}),angular.forEach($scope.tasks,function(valueTask,indexTask){$scope.tasks[indexTask].files=[],angular.forEach(response.file,function(valueFile,indexFile){valueTask.tasks_id===valueFile.tasks_id&&valueTask.ITEM_ID===valueFile.ITEM_ID&&$scope.tasks[indexTask].files.push({file_id:valueFile.file_id,file_name:valueFile.file_name})})})}}),$scope.tasks.loading=!1},$scope.LoadInfo(infoWeek.task_week_id),$scope.ChooseItem=function(item){$modal.open({templateUrl:"modules/TimeSheet/views/itemModal.html",controller:"ItemController",size:"lg",resolve:{itemArr:function(){var arr=[];return arr=item,arr.length>0?arr:null},isView:function(){return!0}}})}}).controller("ViewTimesheetByHourController",function($rootScope,$modalInstance,$modal,$scope,$cookieStore,$filter,ConfigService,calendarHelper,moment,StaffService,$state,toastr,infoWeek){$scope.tasks||($scope.tasks=[]),$scope.info||($scope.info={}),$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.CheckTimeInLieu=function(info){StaffService.CheckTimeInLieu(info).then(function(response){if("error"===response.status)toastr.error("Check Time in Lieu fail!","Fail");else if("success"===response.status){var timeInLieu=0;angular.forEach(response.result,function(data,index){timeInLieu+=data.time_in_lieu}),$scope.time_in_lieuHas=timeInLieu}else $state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error")})};var info={date:new Date,userId:void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null};$scope.CheckTimeInLieu(info),$scope.GetFortMatTimeCharge=function(val){return StaffService.GetFortMatTimeCharge(val)},$scope.ClickCancel=function(){$modalInstance.close()},$scope.SubmitOnView=function(value){$scope.week.time_charge<2280?toastr.warning("Please check time charge(>=38)","Error"):$scope.time_in_lieuChoose>$scope.time_in_lieuHas?toastr.warning("Please check time in lieu use larger time in lieu you have!","Fail"):(value.status=0,"Awaiting for Submit"==value.STATUS?value.status=2:"Rejected"==value.STATUS&&(value.status=5),StaffService.SubmitOnView(value).then(function(response){"error"===response.status?(toastr.error("Submit fail!","Error"),$modalInstance.close()):"success"===response.status&&($modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetHistory",null,{reload:!0}),toastr.success("Submit success","Success"))}))},$scope.OkClick=function(){$modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetCreate",{id:infoWeek.task_week_id})},$scope.week=infoWeek,$scope.LoadInfo=function(){$scope.tasks.loading=!0,StaffService.ShowDetailDate(infoWeek.task_week_id).then(function(response){if("fail"==response.status||"error"==response.status)toastr.error("Error","Error");else if("success"==response.status){var result=response.data;void 0!==result&&void 0!==result[0]&&($scope.STATUS=result[0].status,$scope.ID_WEEK=result[0].tasks_week_id,$scope.time_in_lieuChoose=result[0].time_in_lieuChoose,$scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,$scope.submitOnView={},$scope.submitOnView.STATUS=$scope.STATUS,$scope.submitOnView.ID_WEEK=$scope.ID_WEEK,$scope.submitOnView.USER_ID=$scope.USER_ID,$scope.afterStatusID=result[0].after_status_id,$scope.employee_name=null===result[0].FirstName||""===result[0].FirstName?null===result[0].LastName||""===result[0].LastName?" ":result[0].LastName:result[0].FirstName+" "+(null===result[0].LastName||""===result[0].LastName?" ":result[0].LastName));var arrayDate=[];angular.forEach(response.data,function(valueData,indexData){var isFoundDate=!1;angular.forEach(arrayDate,function(valueDate,indexDate){valueData.date===valueDate.date&&(isFoundDate=!0)}),isFoundDate===!1&&arrayDate.push({date:valueData.date})}),angular.forEach(arrayDate,function(valueDate,indexDate){var timeChargeDate=0;arrayDate[indexDate].timeActivity=[{time_charge:0},{time_charge:0},{time_charge:0},{time_charge:0},{time_charge:0}],angular.forEach(response.data,function(valueData,indexData){var time_charge=void 0!==valueData.time_charge&&null!==valueData.time_charge?valueData.time_charge:0;valueData.date===valueDate.date&&(timeChargeDate+=time_charge,arrayDate[indexDate].timeActivity[valueData.activity_id-1].time_charge+=time_charge)}),arrayDate[indexDate].time_charge_date=timeChargeDate}),$scope.tasks=angular.copy(arrayDate)}}),$scope.tasks.loading=!1},$scope.LoadInfo(),$scope.ViewDetailDate=function(infoWeek,date){$modal.open({templateUrl:"modules/TimeSheet/views/viewDetail.html",controller:"ViewDetailController",size:"lg",resolve:{infoWeek:function(){return infoWeek.date=date,infoWeek}}})}}),angular.module("app.loggedIn.staff.service",[]).factory("StaffService",function(Restangular,MIN_TO_DEC){var service={},api=Restangular.all("api");return service.AddAllTask=function(allTaskPost,infoPost){var addAllTask=api.all("staff/addAllTask");return addAllTask.post({allTask:allTaskPost,info:infoPost})},service.GetAllTaskAMonth=function(searchPost){var getAllTaskAMonth=api.all("staff/getAllTaskAMonth");return getAllTaskAMonth.post({search:searchPost})},service.SubmitOnView=function(infoPost){var SubmitOnView=api.all("staff/SubmitOnView");return SubmitOnView.post({info:infoPost})},service.EditTask=function(task,infoPost){var editTask=api.all("staff/editTask");return editTask.post({allTask:task,info:infoPost})},service.CheckTimeInLieu=function(infoPost){var CheckTimeInLieu=api.all("staff/checktime");return CheckTimeInLieu.post({info:infoPost})},service.GetTask=function(idWeekPost){var getTask=api.all("staff/getTask");return getTask.post({idWeek:idWeekPost})},service.GetDepartmentLocationActivity=function(){var getDepartmentLocation=api.one("staff/getDepartmentLocation");return getDepartmentLocation.get()},service.CheckFirstTaskWeek=function(infoPost){var checkFirstTaskWeek=api.all("staff/checkFirstTaskWeek");return checkFirstTaskWeek.post({info:infoPost})},service.CheckTaskWeek=function(infoPost){var checkTaskWeek=api.all("staff/checkTaskWeek");return checkTaskWeek.post({info:infoPost})},service.ShowEdit=function(infoPost){var showEdit=api.all("staff/showEdit");return showEdit.post({info:infoPost})},service.ShowDetailDate=function(infoPost){var showDetailDate=api.all("staff/showDetailDate");return showDetailDate.post({info:infoPost})},service.SetTaskList=function(){return api.one("staff/task/getList").get()},service.LoadContract=function(USER_ID){var LoadContract=api.all("staff/get-contract");return LoadContract.post({ID:USER_ID})},service.ConvertShowToFull=function(time_charge){if(void 0===time_charge||null===time_charge||isNaN(time_charge)||0===time_charge||0===time_charge.length)return 0;var hours=0,minutes=0;return hours=parseInt(time_charge.toString().substring(0,time_charge.toString().length-2)),minutes=parseInt(time_charge.toString().substring(time_charge.toString().length-2,time_charge.toString().length)),parseInt(60*hours)+parseInt(minutes)},service.ConvertFromFullToShow=function(time_charge){if(void 0!==time_charge&&null!==time_charge){var hours=parseInt(time_charge/60),minutes=parseInt(time_charge%60);return 10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes),hours.toString()+minutes.toString()}},service.GetFortMatTimeCharge=function(time_charge){if(void 0!==time_charge&&null!==time_charge&&0!==time_charge){var hours=parseInt(time_charge/60),minutes=parseInt(time_charge%60);return 10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes),hours+":"+minutes}return"-"},service.ShowWeek=function(userID){var startDate,endDate,checkMonth=api.all("staff/checkMonth"),array=[],info={};new Date,info.userID=userID;var date=new Date;info.month=date.getMonth(),info.year=date.getFullYear(),checkMonth.post({info:info}).then(function(response){angular.forEach(response.tasks,function(data){var temp=new Date(data.date),monthTemp=1*temp.getMonth()+1,tempDate=temp.getDate();10>tempDate&&(tempDate="0"+tempDate),10>monthTemp&&(monthTemp="0"+monthTemp),array.push(temp.getFullYear()+"-"+monthTemp+"-"+tempDate)});var selectCurrentWeek=function(){window.setTimeout(function(){$(".ui-weekpicker").find(".ui-datepicker-current-day a").addClass("ui-state-active").removeClass("ui-state-default")},1)},setDates=function(input){var $input=$(input),date=$input.datepicker("getDate"),firstDay=$input.datepicker("option","firstDay");if($input.datepicker("option","dateFormat","dd/mm/yy"),$input.datepicker("option","firstDay",1),null!==date){var dayAdjustment=date.getDay()-firstDay;0>dayAdjustment&&(dayAdjustment+=7),startDate=new Date(date.getFullYear(),date.getMonth(),date.getDate()-dayAdjustment),endDate=new Date(date.getFullYear(),date.getMonth(),date.getDate()-dayAdjustment+6),$input.datepicker("setDate",startDate)}},dateRunTimeSheet=new Date("2015-03-30");$(".week-picker").datepicker({beforeShow:function(){$("#ui-datepicker-div").addClass("ui-weekpicker"),selectCurrentWeek()},onClose:function(){$("#ui-datepicker-div").removeClass("ui-weekpicker")},minDate:dateRunTimeSheet,showOtherMonths:!0,selectOtherMonths:!0,onSelect:function(dateText,inst){setDates(this),selectCurrentWeek(),$(this).change()},beforeShowDay:function(date){var string=jQuery.datepicker.formatDate("yy-mm-dd",date),cssClass="";return date>=startDate&&endDate>=date&&(cssClass="ui-datepicker-current-day"),[-1==array.indexOf(string),cssClass]},onChangeMonthYear:function(year,month,inst){selectCurrentWeek()}}),setDates(".week-picker");var $calendarTR=$(".ui-weekpicker .ui-datepicker-calendar tr");$calendarTR.live("mousemove",function(){$(this).find("td a").addClass("ui-state-hover")}),$calendarTR.live("mouseleave",function(){$(this).find("td a").removeClass("ui-state-hover")})})},service}),angular.module("app.loggedIn.staff.calendar.directive",[]).directive("mwlCalendar",function(moment,calendarHelper){return{templateUrl:"modules/staff/directives/templates/main.html",restrict:"EA",scope:{events:"=calendarEvents",view:"=calendarView",viewWeek:"=calendarViewWeek",currentDay:"=calendarCurrentDay",preDay:"=calendarPreDay",nextDay:"=calendarNextDay",control:"=calendarControl",eventClick:"&calendarEventClick",autoOpen:"=calendarAutoOpen",useIsoWeek:"=calendarUseIsoWeek"},controller:function($scope){var self=this;$scope.useIsoWeek=!0,this.titleFunctions={},this.changeView=function(view,newDay){$scope.view=view,$scope.currentDay=newDay},$scope.control=$scope.control||{},$scope.control.prev=function(){$scope.currentDay=moment($scope.currentDay).subtract(3,"month").toDate(),$scope.preDay=moment($scope.preDay).subtract(3,"month").toDate(),$scope.nextDay=moment($scope.nextDay).subtract(3,"month").toDate()},$scope.control.next=function(){$scope.currentDay=moment($scope.currentDay).add(3,"month").toDate(),$scope.preDay=moment($scope.preDay).add(3,"month").toDate(),$scope.nextDay=moment($scope.nextDay).add(3,"month").toDate()},$scope.control.getTitle=function(day){return self.titleFunctions[$scope.view]?self.titleFunctions[$scope.view](day):""}}}}),angular.module("app.loggedIn.TimeSheet.Home.Controller",["app.loggedIn.TimeSheet.Home.Controller","app.loggedIn.TimeSheet.ApproveTask.Controller","app.loggedIn.TimeSheet.Report1.Controller","app.loggedIn.TimeSheet.Report2.Controller","app.loggedIn.TimeSheet.Report3.Controller","app.loggedIn.TimeSheet.Report4.Controller","app.loggedIn.TimeSheet.Report5.Controller","app.loggedIn.TimeSheet.Report6.Controller","app.loggedIn.TimeSheet.ReportOweLeave.Controller","app.loggedIn.TimeSheet.CreateLeave.Controller","app.loggedIn.TimeSheet.HistoryLeave.Controller","app.loggedIn.TimeSheet.ApproveLeave.Controller","angularFileUpload","app.loggedIn.timesheet.create.controller","app.loggedIn.timesheet.view.controller"]),angular.module("app.loggedIn.TimeSheet.Directives",["app.loggedIn.TimeSheet.ViewTask.Directive","app.loggedIn.TimeSheet.Time.Directive","app.loggedIn.TimeSheet.Detail.Directive","app.loggedIn.TimeSheet.Filter","app.loggedIn.TimeSheet.ItemCode.Directive","app.loggedIn.TimeSheet.Digits.Directive","app.loggedIn.TimeSheet.ActivityDetail.Directive","angularjs-dropdown-multiselect","app.loggedIn.TimeSheet.ViewLeave.Directive","app.loggedIn.TimeSheet.ApproveLeave.Directive","app.loggedIn.staff.calendar.directive","app.loggedIn.TimeSheet.formValidate.Directive"]),angular.module("app.loggedIn.TimeSheet.ItemCode.Directive",[]).directive("itemCode",function(TimeSheetService,$state,toastr,MODE_ROW,StaffService){return{restrict:"EA",required:"ngModel",scope:{onSave:"&",onCancel:"&",ngModel:"="},link:function(scope,elem,attrs){scope.$watch("ngModel",function(newModel,oldModel){scope.items=[],void 0!==newModel&&(scope.locationName=newModel.locationName,scope.departmentName=newModel.departmentName,void 0!==newModel.item&&0!==newModel.item.length&&angular.forEach(newModel.item,function(item,index){void 0!==item&&1!==item.deleted&&item.show!==!1&&scope.items.push(item)}),angular.forEach(scope.items,function(item,index){scope.items[index].show=!0}))}),scope.SetPage=function(){scope.searchObjectMap.offset=(scope.searchObjectMap.currentPage-1)*scope.searchObjectMap.limit,scope.LoadList()},scope.Reset=function(){scope.searchObjectMap=angular.copy(scope.searchObject),scope.LoadList()},scope.LoadList=function(){TimeSheetService.LoadItemCode(scope.searchObjectMap).then(function(response){"success"===response.status?(scope.list=response,angular.forEach(scope.list.result,function(value,index){scope.list.result[index].status=!1})):"error"===response.status?($state.go("loggedIn.timesheetHome.timesheetCreate",null,{reload:!0}),toastr.error("Loading fail!","Error")):($state.go("loggedIn.timesheetHome.timesheetCreate",null,{reload:!0}),toastr.error("Server not response!","Error"))})};var Init=function(){scope.searchObject={limit:10,offset:0,currentPage:1,maxSize:5,isBillable:!0,order:{"time_item_code.ITEM_ID":null},data:{"time_item_code.ITEM_ID":null,"time_item_code.ITEM_NAME":null}},scope.rows=MODE_ROW,scope.searchObjectMap=angular.copy(scope.searchObject),scope.list={},scope.LoadList()};Init(),scope.ItemCodeASC=function(){scope.searchObjectMap.order["time_item_code.ITEM_ID"]="ASC",scope.loadList()},scope.ItemCodeDESC=function(){scope.searchObjectMap.order["time_item_code.ITEM_ID"]="DESC",scope.LoadList()},scope.ChangeTimeCharge=function(index,ratio){void 0===ratio||null===ratio||""===ratio||isNaN(ratio)?scope.items[index].totalUnits=null:scope.items[index].totalUnits=ratio*scope.items[index].UNITS},scope.ClickShow=function(index){void 0!==scope.list&&void 0!==scope.list.result&&void 0!==scope.list.result[index]&&void 0!==scope.list.result[index].status&&(scope.list.result[index].status=!scope.list.result[index].status)},scope.isShow=!0,scope.ClickAdd=function(){scope.isShow=!0,angular.element("#itemCodeID").focus()},scope.AddItem=function(ITEM_ID,ITEM_NAME,UNITS){if(scope.isShow===!0){var check=!1;angular.forEach(scope.items,function(item,index){item.ITEM_ID===ITEM_ID&&item.show===!0&&(toastr.warning("Item exist in list selected!","Fail"),check=!0)}),check===!1&&(scope.items.push({ITEM_ID:ITEM_ID,ITEM_NAME:ITEM_NAME,UNITS:UNITS,isAction:"insert",status:!1,show:!0}),scope.isDisabled=!1,scope.isShow=!1)}else toastr.warning("Not found row empty to insert!","Fail")},scope.ClickShowSelected=function(index){void 0!==scope.items&&void 0!==scope.items[index]&&void 0!==scope.items[index].status&&(scope.items[index].status=!scope.items[index].status)},scope.DeleteItem=function(index){swal({title:"Do you want to delete this Task / Item?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){"update"===scope.items[index].isAction?(scope.items[index].isAction="delete",scope.items[index].show=!1):"insert"===scope.items[index].isAction&&scope.items.splice(index,1);var count=0;angular.forEach(scope.items,function(item,index){item.show===!0&&++count}),0===count&&(scope.isShow=!0)})}},templateUrl:"modules/TimeSheet/directives/templates/ItemCode.html"}}),angular.module("app.loggedIn.TimeSheet.Digits.Directive",[]).directive("onlyDigits",function(){return{require:"ngModel",restrict:"A",link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.push(function(inputValue){if(void 0==inputValue)return"";var transformedInput=inputValue.replace(/[^0-9]/g,"");return transformedInput!=inputValue&&(modelCtrl.$setViewValue(transformedInput),modelCtrl.$render()),transformedInput})}}}),angular.module("app.loggedIn.TimeSheet.ViewTask.Directive",[]).directive("viewTask",function(toastr,$state,TimeSheetService,$modal,MIN_TO_DEC,StaffService,$cookieStore){return{restrict:"EA",require:"ngModel",scope:{onCancel:"&",onReject:"&",onApprove:"&",ngModel:"="},link:function(scope,element,attrs){scope.info={},scope.$watch("ngModel",function(newModel,oldModel){isNaN(newModel)?"reject"===newModel?(scope.info.isReject=!0,scope.info.isApprove=!1,$("commentsID").focus()):"chooseApprove"===newModel?(scope.info.isApprove=!0,scope.info.isReject=!1):"cancelOn"===newModel&&(scope.info.isReject=null,scope.info.isApprove=!1):(scope.info.idTaskWeek=newModel,scope.info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,scope.ViewApproved=function(idTimesheet){TimeSheetService.ViewApproved(idTimesheet).then(function(response){"error"===response.status?($state.go("loggedIn.timesheetHome.timesheetApprove",null,{reload:!0}),toastr.error("Loading fail!","Error")):"success"===response.status?(scope.list=response,scope.info.forPermission=scope.list.forPermission,angular.forEach(scope.list.result,function(timeDate,indexD){scope.list.result[indexD].AC=[],angular.forEach(scope.list.resultActivity,function(timeAC,indexAC){scope.list.resultActivity[indexAC].date===scope.list.result[indexD].date&&(scope.list.result[indexD].AC[scope.list.resultActivity[indexAC].activity_id]=scope.list.resultActivity[indexAC].sumAC)})}),scope.employee_name=null===scope.list.result[0].FirstName||""===scope.list.result[0].FirstName?null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName:scope.list.result[0].FirstName+" "+(null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName),scope.statusID=scope.list.result[0].task_status_id,4===scope.list.result[0].task_status_id&&(scope.info.hasReject=!0,scope.info.comments=scope.list.result[0].comments),scope.info.time_rest=scope.list.result[0].chargeWeek-2280,scope.info.time_restFull<0&&(scope.info.time_restFull=0),scope.info.time_in_lieu=null,scope.info.over_time=null,scope.info.TypeOfContruct=scope.list.result[0].TypeOfContruct):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},scope.ViewApproved(newModel))}),scope.CancelClick=function(){scope.info.isReject=1,scope.info.isApprove=1},scope.$watch("info.time_in_lieu",function(newTimeInLieu,oldTimeInLieu){void 0!==newTimeInLieu&&null!==newTimeInLieu&&(0===newTimeInLieu.length?(scope.info.time_in_lieu=null,scope.info.over_time=null):StaffService.ConvertShowToFull(newTimeInLieu)>scope.info.time_rest?(scope.info.time_in_lieu=null,
scope.info.over_time=null):(scope.info.time_in_lieuFull=StaffService.ConvertShowToFull(newTimeInLieu),scope.info.over_timeFull=scope.info.time_rest-scope.info.time_in_lieuFull,scope.info.over_time=StaffService.ConvertFromFullToShow(scope.info.over_timeFull)))}),scope.$watch("info.over_time",function(newOverTime,oldOverTime){void 0!==newOverTime&&null!==newOverTime&&(0===newOverTime.length?(scope.info.over_time=null,scope.info.time_in_lieu=null):StaffService.ConvertShowToFull(newOverTime)>scope.info.time_rest?(scope.info.time_in_lieu=null,scope.info.over_time=null):(scope.info.over_timeFull=StaffService.ConvertShowToFull(newOverTime),scope.info.time_in_lieuFull=scope.info.time_rest-scope.info.over_timeFull,scope.info.time_in_lieu=StaffService.ConvertFromFullToShow(scope.info.time_in_lieuFull)))});var DialogViewDetail=function(ID,DATE,detailType){var modalInstance=$modal.open({templateUrl:"ViewDetail",controller:function($scope){"all-date"===detailType?$scope.idView={ID:ID,STATUS:"all-date"}:"on-date"===detailType&&($scope.idView={ID:ID,DATE:DATE,STATUS:"on-date"}),$scope.ClickCancel=function(value){modalInstance.close()}},size:"lg"})};scope.ViewDetail=function(ID,DATE,detailType){DialogViewDetail(ID,DATE,detailType)}},templateUrl:"modules/TimeSheet/directives/templates/ViewTask.html"}}),angular.module("app.loggedIn.TimeSheet.Detail.Directive",[]).directive("viewTimesheet",function(TimeSheetService,toastr,$state){return{restrict:"EA",required:"ngModel",scope:{onCancel:"&",ngModel:"="},link:function(scope,elem,attrs){scope.$watch("ngModel",function(newModel,oldModel){void 0!==newModel&&"on-date"===newModel.STATUS&&(scope.Title="Timesheet Detail",scope.ViewOnDate=function(idTimesheet){TimeSheetService.ViewOnDate(idTimesheet).then(function(response){"success"===response.status?(scope.list=response,angular.forEach(scope.list.result,function(valueResult,indexResult){scope.list.result[indexResult].files=[],angular.forEach(response.file,function(valueFile,indexFile){valueFile.tasks_id===valueResult.tasks_id&&valueFile.ITEM_ID===valueResult.ITEM_ID&&scope.list.result[indexResult].files.push({file_id:valueFile.file_id,file_name:valueFile.file_name})})}),void 0!==scope.list.result[0]&&(scope.employee_name=null===scope.list.result[0].FirstName||""===scope.list.result[0].FirstName?null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName:scope.list.result[0].FirstName+" "+(null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName))):"error"===response.status?toastr.error("Loadding fail!","Error"):($state("loggedIn.TimeSheetHome.ApproveTask",null,{reload:!0}),toastr.error("Server not response!","Error"))})},scope.ViewOnDate(newModel))})},templateUrl:"modules/TimeSheet/directives/templates/Detail.html"}}),angular.module("app.loggedIn.TimeSheet.ActivityDetail.Directive",[]).directive("activityDetail",function(TimeSheetService,$state,toastr,MODE_ROW,StaffService,FileUploader,$cookieStore,$timeout,$window,$modal,$location){return{restrict:"EA",required:"ngModel",scope:{onSave:"&",onCancel:"&",ngModel:"="},link:function(scope,elem,attrs){scope.$watch("ngModel",function(newModel,oldModel){scope.items=[],void 0!==newModel&&(scope.locationName=newModel.locationName,scope.departmentName=newModel.departmentName,void 0!==newModel.item&&0!==newModel.item.length&&angular.forEach(newModel.item,function(item,index){void 0!==item&&1!==item.deleted&&item.show!==!1&&scope.items.push(item)}),angular.forEach(scope.items,function(item,index){scope.items[index].show=!0}),scope.ACTIVITY_ID=newModel.activity_id,void 0!==newModel.taskIndex&&(scope.taskIndex=newModel.taskIndex)),scope.SetPage=function(){scope.searchObjectMap.offset=(scope.searchObjectMap.currentPage-1)*scope.searchObjectMap.limit,scope.LoadList()},scope.Reset=function(){scope.searchObjectMap=angular.copy(scope.searchObject),scope.LoadList()},scope.LoadList=function(){TimeSheetService.LoadItemCode(scope.searchObjectMap).then(function(response){"success"===response.status?(scope.list=response,angular.forEach(scope.list.result,function(value,index){scope.list.result[index].status=!1})):"error"===response.status?($state.go("loggedIn.timesheetHome.timesheetCreate",null,{reload:!0}),toastr.error("Loading fail!","Error")):($state.go("loggedIn.timesheetHome.timesheetCreate",null,{reload:!0}),toastr.error("Server not response!","Error"))})};var Init=function(){scope.searchObject={limit:10,offset:0,currentPage:1,maxSize:5,isBillable:!1,activity_id:scope.ACTIVITY_ID,order:{"time_item_code.ITEM_ID":null},data:{"time_item_code.ITEM_ID":null,"time_item_code.ITEM_NAME":null}},scope.rows=MODE_ROW,scope.searchObjectMap=angular.copy(scope.searchObject),scope.list={},scope.LoadList()};Init(),scope.ItemCodeASC=function(){scope.searchObjectMap.order["time_item_code.ITEM_ID"]="ASC",scope.LoadList()},scope.ItemCodeDESC=function(){scope.searchObjectMap.order["time_item_code.ITEM_ID"]="DESC",scope.LoadList()},scope.ChangeTimeCharge=function(index,ratio){void 0===ratio||null===ratio||""===ratio||isNaN(ratio)?scope.items[index].totalUnits=null:scope.items[index].totalUnits=ratio*scope.items[index].UNITS},scope.ClickShow=function(index){void 0!==scope.list&&void 0!==scope.list.result&&void 0!==scope.list.result[index]&&void 0!==scope.list.result[index].status&&(scope.list.result[index].status=!scope.list.result[index].status)},scope.isShow=!0,scope.ClickAdd=function(){scope.isShow=!0,angular.element("#itemCodeID").focus()},scope.AddItem=function(ITEM_ID,ITEM_NAME,UNITS){if(scope.isShow===!0){var check=!1;angular.forEach(scope.items,function(item,index){item.ITEM_ID===ITEM_ID&&item.show===!0&&(toastr.warning("Item exist in list selected!","Fail"),check=!0)}),check===!1&&(scope.items.push({ITEM_ID:ITEM_ID,ITEM_NAME:ITEM_NAME,UNITS:UNITS,isAction:"insert",status:!1,totalUnits:1,ratio:1,show:!0}),scope.isDisabled=!1,scope.isShow=!1)}else toastr.warning("Not found row empty to insert!","Fail")},scope.ClickShowSelected=function(index){void 0!==scope.items&&void 0!==scope.items[index]&&void 0!==scope.items[index].status&&(scope.items[index].status=!scope.items[index].status)},scope.DeleteItem=function(index){swal({title:"Do you want to delete this Task / Item?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(){"update"===scope.items[index].isAction?(scope.items[index].isAction="delete",scope.items[index].show=!1):"insert"===scope.items[index].isAction&&scope.items.splice(index,1);var count=0;angular.forEach(scope.items,function(item,index){item.show===!0&&++count}),0===count&&(scope.isShow=!0)})}}),scope.uploader=new FileUploader({url:"/api/TimeSheet/post-upload-file",method:"POST",autoUpload:!0,formData:[{userId:$cookieStore.get("userInfo").id}],isHTML5:!0,isUploading:!0}),scope.uploader.filters.push({name:"limitFile",fn:function(item,options){return this.queue.length<5}}),scope.uploader.filters.push({name:"limitSize",fn:function(item){return item.size/1048576<10}}),scope.RemoveItem=function(indexItem,indexFile,fileId){swal({title:"Are you sure detele this file!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(isConfirm){isConfirm&&(angular.forEach(scope.uploader.queue,function(value,index){value.file_id===fileId&&scope.uploader.removeFromQueue(index)}),scope.items[indexItem].fileUpload.splice(indexFile,1),TimeSheetService.DeleteFile(fileId).then(function(response){}))})},scope.uploader.onWhenAddingFileFailed=function(item,filter,options){"folder"===filter.name?swal({title:"Limit 5 file to upload.",type:"warning",confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0}):"queueLimit"===filter.name?swal({title:"The file you are trying to send exceeds the 10MB attachment limit.",type:"warning",confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0}):toastr.error("Upload file "+item.name+" fail!","Error")},scope.uploader.onAfterAddingAll=function(addedFileItems){if(angular.forEach(scope.items,function(value,index){void 0===value.taskIndex&&(scope.items[index].taskIndex=scope.taskIndex)}),scope.uploader.queue.length>0){angular.forEach(scope.uploader.queue,function(value,index){(void 0===value.taskIndex||void 0===value.itemId)&&(scope.uploader.queue[index].taskIndex=scope.taskIndex,scope.uploader.queue[index].itemId=scope.currentItemId)});var isFound=!1;angular.forEach(scope.uploader.queue,function(value,index){value.isUploading!==!0&&value.isUploaded!==!1||isFound!==!1||(isFound=!0,scope.progressTaskIndex=value.taskIndex,scope.progressItemId=value.itemId,scope.isUploading=!0)}),isFound===!1&&(scope.isUploading=!1)}},scope.uploader.onAfterAddingFile=function(fileItem){},scope.uploader.onBeforeUploadItem=function(item){},scope.uploader.onProgressItem=function(fileItem,progress){scope.fileNameProgress=fileItem.file.name,scope.progress=progress},scope.uploader.onProgressAll=function(progressAll){},scope.uploader.onSuccessItem=function(fileItem,response,status,headers){var isFound=!1;angular.forEach(scope.uploader.queue,function(value,index){value.isUploading!==!0&&value.isUploaded!==!1||isFound!==!1||(isFound=!0,scope.progressTaskIndex=value.taskIndex,scope.progressItemId=value.itemId,scope.isUploading=!0)}),scope.uploader.queue[scope.uploader.getIndexOfItem(fileItem)].file_id=response.file_id,isFound===!1&&(scope.isUploading=!1),angular.forEach(scope.items,function(valueItem,indexItem){void 0===scope.items[indexItem].fileUpload&&(scope.items[indexItem].fileUpload=[]),angular.forEach(scope.uploader.queue,function(valueFile,indexFile){if(valueItem.taskIndex===valueFile.taskIndex&&valueItem.ITEM_ID===valueFile.itemId&&void 0!==valueFile.file_id){var isFound2=!1;angular.forEach(scope.items[indexItem].fileUpload,function(valueCheck,indexCheck){valueCheck.file_id===valueFile.file_id&&(isFound2=!0)}),isFound2===!1&&"delete"!==valueItem.isAction&&scope.items[indexItem].fileUpload.push({file_name:valueFile.file.name,file_id:valueFile.file_id,isAction:"insert"})}})})},scope.GetStyleUpload=function(){if(0!==scope.uploader.queue.length){var check=!1;return angular.forEach(scope.uploader.queue,function(value,index){value.isUploading===!0&&(check=!0)}),check===!0?{width:"5%"}:{width:"2%"}}return{width:"2%"}},scope.ClickShowFile=function(itemIndex,itemId){$timeout(function(){document.getElementById("uploadTimesheet").click(),scope.clicked=!0,scope.currentItemId=itemId},0)}},templateUrl:"modules/TimeSheet/directives/templates/ActivityDetail.html"}}),angular.module("app.loggedIn.TimeSheet.Filter",[]).filter("customHours",function(){return function(time_charge){if(void 0!==time_charge&&null!==time_charge&&0!==time_charge){var hours=parseInt(time_charge/60),minutes=parseInt(time_charge%60);return 10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes),hours+":"+minutes}return"-"}}).filter("getDate",function(){return function(input){var DateInput=new Date(input.toString());return DateInput.getDay()}}).filter("readMore",function(){return function(input){return void 0!==input&&null!==input&&""!==input?{check:input.length>150,value:input.substring(0,150)}:""}}).filter("readMoreSelected",function(){return function(input){return void 0!==input&&null!==input&&""!==input?{check:input.length>35,value:input.substring(0,35)}:""}}).filter("readMoreUpload",function(){return function(input){return void 0!==input&&null!==input&&""!==input?{check:input.length>20,value:input.substring(0,10)+"..."+input.substr(input.length-5,input.length-1)}:""}}).filter("customTotalHours",function(){return function(input){return void 0!==input&&null!==input&&""!==input&&0!==input&&0!==input.length?input.toString().substring(0,input.toString().length-2).concat(":",input.toString().substring(input.toString().length-2,input.toString())):"__:__"}}).filter("customTotalHoursAll",function(){return function(input){return void 0!==input&&null!==input&&""!==input&&0!==input&&0!==input.length?input.toString().substring(0,input.toString().length-2).concat(":",input.toString().substring(input.toString().length-2,input.toString())):"00:00"}}),angular.module("app.loggedIn.TimeSheet.Time.Directive",[]).directive("timeCharge",function(StaffService){return{restrict:"EA",require:"ngModel",scope:{ngModel:"=",formValidate:"=",requireValidate:"="},link:function(scope,elem,attrs,ctrls,ngModel){scope.$watch("ngModel",function(newModel,oldModel){if(void 0!==newModel&&null!==newModel&&""!==newModel&&parseInt(newModel.toString().substr(newModel.toString().length-2,2))>59&&(scope.ngModel=StaffService.convertFromFullToShow(StaffService.convertShowToFull(newModel)).toString()),void 0!==scope.ngModel&&null!==scope.ngModel&&""!==scope.ngModel&&0!==scope.ngModel&&0!==scope.ngModel.length){for(var result="",i=0;i<scope.ngModel.toString().length-2;i++)result+="9";result+=":99",attrs.$set("uiMask",result)}else"99:99"!==attrs.uiMask&&attrs.$set("uiMask","99:99");var ObjectError={required:"Field is required!",mask:"Field is invalid!"},isError=!1,keyErrorOut="";angular.forEach(scope.formValidate,function(valueError,keyErrorIn){valueError===!0&&(isError=!0,keyErrorOut=keyErrorIn)}),isError===!0?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHtml:!0,content:ObjectError[keyErrorOut]})):void 0!==newModel&&null!==newModel&&0===newModel.length?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHtml:!0,content:ObjectError.required})):(elem.hasClass("tooltipstered")&&(angular.element(elem).tooltipster("destroy"),angular.element(elem).removeAttr("title")),elem.css("border-color","#ECECEC"))})}}}).directive("timeChargeleave",function(StaffService){return{restrict:"EA",require:"ngModel",scope:{ngModel:"=",formValidate:"=",requireValidate:"="},link:function(scope,elem,attrs,ctrls,ngModel){scope.$watch("ngModel",function(newModel,oldModel){if(void 0!==newModel&&null!==newModel&&""!==newModel&&0!==newModel.length&&parseInt(newModel.toString().substr(newModel.toString().length-2,2))>59&&(scope.ngModel=StaffService.convertFromFullToShow(StaffService.convertShowToFull(newModel)).toString()),void 0!==newModel&&null!==newModel&&""!==newModel&&0!==newModel.length&&0!==newModel){for(var result="",i=0;i<newModel.toString().length-2;i++)result+="9";result+=":99",attrs.$set("uiMask",result)}else"99:99"!==attrs.uiMask&&attrs.$set("uiMask","99:99");void 0!==scope.requireValidate&&null!==scope.requireValidate&&""!==scope.requireValidate&&0!==scope.requireValidate.length&&attrs.$set("required",!0);var ObjectError={required:"Field is required!",mask:"Field is invalid!"},isError=!1,keyErrorOut="";angular.forEach(scope.formValidate,function(valueError,keyErrorIn){valueError===!0&&(isError=!0,keyErrorOut=keyErrorIn)}),isError===!0?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHtml:!0,content:ObjectError[keyErrorOut]})):(elem.hasClass("tooltipstered")&&(angular.element(elem).tooltipster("destroy"),angular.element(elem).removeAttr("title")),elem.css("border-color","#ECECEC"))}),scope.$watch("requireValidate",function(newModelRequired,oldModelRequired){void 0!==newModelRequired&&null!==newModelRequired&&0!==newModelRequired.length?attrs.required!==!0&&attrs.$set("required",!0):attrs.$set("required",!1);var ObjectError={required:"Field is required!",mask:"Field is invalid!"},isError=!1,keyErrorOut="";angular.forEach(scope.formValidate,function(valueError,keyErrorIn){valueError===!0&&(isError=!0,keyErrorOut=keyErrorIn)}),isError===!0?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHtml:!0,content:ObjectError[keyErrorOut]})):(elem.hasClass("tooltipstered")&&(angular.element(elem).tooltipster("destroy"),angular.element(elem).removeAttr("title")),elem.css("border-color","#ECECEC"))})}}}).directive("timeChargenon",function(StaffService){return{restrict:"EA",require:"ngModel",scope:{ngModel:"=",formValidate:"=",requireValidate:"="},link:function(scope,elem,attrs,ctrls,ngModel){scope.$watch("ngModel",function(newModel,oldModel){if(void 0!==newModel&&null!==newModel&&""!==newModel&&" "!==newModel&&parseInt(newModel.toString().substr(newModel.toString().length-2,2))>59&&(scope.ngModel=StaffService.convertFromFullToShow(StaffService.convertShowToFull(newModel)).toString()),void 0!==scope.ngModel&&null!==scope.ngModel&&""!==scope.ngModel&&0!==scope.ngModel&&0!==scope.ngModel.length&&" "!==scope.ngModel){for(var result="",i=0;i<scope.ngModel.toString().length-2;i++)result+="9";result+=":99",attrs.$set("uiMask",result)}else"999:99"!==attrs.uiMask&&attrs.$set("uiMask","999:99");void 0!==scope.requireValidate&&null!==scope.requireValidate&&""!==scope.requireValidate&&0!==scope.requireValidate.length&&attrs.$set("required",!0);var ObjectError={required:"Field is required!",mask:"Field is invalid!"},isError=!1,keyErrorOut="";angular.forEach(scope.formValidate,function(valueError,keyErrorIn){valueError===!0&&(isError=!0,keyErrorOut=keyErrorIn)}),isError===!0?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHtml:!0,content:ObjectError[keyErrorOut]})):(elem.hasClass("tooltipstered")&&(angular.element(elem).tooltipster("destroy"),angular.element(elem).removeAttr("title")),elem.css("border-color","#ECECEC"))}),scope.$watch("requireValidate",function(newModelRequired,oldModelRequired){void 0!==newModelRequired&&null!==newModelRequired&&0!==newModelRequired.length?attrs.required!==!0&&attrs.$set("required",!0):attrs.$set("required",!1);var ObjectError={required:"Field is required!",mask:"Field is invalid!"},isError=!1,keyErrorOut="";angular.forEach(scope.formValidate,function(valueError,keyErrorIn){valueError===!0&&(isError=!0,keyErrorOut=keyErrorIn)}),isError===!0?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHtml:!0,content:ObjectError[keyErrorOut]})):(elem.hasClass("tooltipstered")&&(angular.element(elem).tooltipster("destroy"),angular.element(elem).removeAttr("title")),elem.css("border-color","#ECECEC"))})}}}),angular.module("app.loggedIn.TimeSheet.Service",[]).factory("TimeSheetService",function(Restangular){var TimeSheetService={},api=Restangular.all("api");return TimeSheetService.LoadTaskApproved=function(searchObjPost){var LoadTaskApproved=api.all("TimeSheet/post-list-approved");return LoadTaskApproved.post({searchObj:searchObjPost})},TimeSheetService.ViewApproved=function(idPost){var ViewApproved=api.all("TimeSheet/post-one-approved");return ViewApproved.post({info:idPost})},TimeSheetService.LoadTimeSheetApprove=function(searchObjPost){var LoadTimeSheetApprove=api.all("TimeSheet/post-list-approve");return LoadTimeSheetApprove.post({searchObj:searchObjPost})},TimeSheetService.RejectTaskWeek=function(infoPost){var RejectTaskWeek=api.all("TimeSheet/post-reject-taskweek");return RejectTaskWeek.post({info:infoPost})},TimeSheetService.ApproveTaskWeek=function(infoPost){var ApproveTaskWeek=api.all("TimeSheet/post-approve-taskweek");return ApproveTaskWeek.post({info:infoPost})},TimeSheetService.LoadRole=function(idPost){var LoadRole=api.all("TimeSheet/post-role-one");return LoadRole.post({USER_ID:idPost})},TimeSheetService.ViewItem=function(taskIdPost){var ViewItem=api.all("TimeSheet/post-item-list");return ViewItem.post({taskID:taskIdPost})},TimeSheetService.ViewOnDate=function(infoPost){var ViewOnDate=api.all("TimeSheet/post-detail-one");return ViewOnDate.post({info:infoPost})},TimeSheetService.ViewAllDate=function(infoPost){var ViewAllDate=api.all("TimeSheet/post-detail-all");return ViewAllDate.post({info:infoPost})},TimeSheetService.LoadItemCode=function(searchObjPost){var LoadItemCode=api.all("TimeSheet/post-itemcode-list");return LoadItemCode.post({searchObj:searchObjPost})},TimeSheetService.LoadDeptReport=function(idPost){var LoadDeptReport=api.all("TimeSheet/post-list-deptRP");return LoadDeptReport.post({USER_ID:idPost})},TimeSheetService.LoadEmpReport=function(listDeptPost){var LoadEmpReport=api.all("TimeSheet/post-list-empRP");return LoadEmpReport.post({listDept:listDeptPost})},TimeSheetService.LoadReportOnActualWorking=function(infoPost){var LoadReportOnActualWorking=api.all("TimeSheet/post-actual-working");return LoadReportOnActualWorking.post({info:infoPost})},TimeSheetService.SendMailTimeSheet=function(infoPost){var sendMailTimeSheet=api.all("TimeSheet/post-send-mail");return sendMailTimeSheet.post({info:infoPost})},TimeSheetService.LoadInfoEmployee=function(idPost){var LoadInfoEmployee=api.all("TimeSheet/post-info-employee");return LoadInfoEmployee.post({USER_ID:idPost})},TimeSheetService.LoadTypeLeave=function(){var LoadTypeLeave=api.one("TimeSheet/get-type-leave");return LoadTypeLeave.get({})},TimeSheetService.CreateLeaveForm=function(infoPost){var CreateLeaveForm=api.all("TimeSheet/post-leave-form");return CreateLeaveForm.post({info:infoPost})},TimeSheetService.LoadHistoryLeave=function(searchObjPost){var LoadHistoryLeave=api.all("TimeSheet/post-history-leave");return LoadHistoryLeave.post({searchObj:searchObjPost})},TimeSheetService.ViewLeave=function(infoPost){var ViewLeave=api.all("TimeSheet/post-view-leave");return ViewLeave.post({info:infoPost})},TimeSheetService.SubmitOnViewLeave=function(infoPost){var SubmitOnViewLeave=api.all("TimeSheet/post-submit-view");return SubmitOnViewLeave.post({info:infoPost})},TimeSheetService.LoadLeaveEdit=function(infoPost){var LoadLeaveEdit=api.all("TimeSheet/post-load-edit");return LoadLeaveEdit.post({info:infoPost})},TimeSheetService.UpdateLeave=function(infoPost){var UpdateLeave=api.all("TimeSheet/post-update-leave");return UpdateLeave.post({info:infoPost})},TimeSheetService.LoadLeaveApprove=function(infoPost){var LoadLeaveApprove=api.all("TimeSheet/post-list-leave");return LoadLeaveApprove.post({info:infoPost})},TimeSheetService.ApproveLeave=function(infoPost){var ApproveLeave=api.all("TimeSheet/post-approve-leave");return ApproveLeave.post({info:infoPost})},TimeSheetService.RejectLeave=function(infoPost){var RejectLeave=api.all("TimeSheet/post-reject-leave");return RejectLeave.post({info:infoPost})},TimeSheetService.CheckLeave=function(idPost){var CheckLeave=api.all("TimeSheet/post-check-leave");return CheckLeave.post({USER_ID:idPost})},TimeSheetService.LoadReportOweLeave=function(infoPost){var LoadReportOweLeave=api.all("TimeSheet/post-owe-leave");return LoadReportOweLeave.post({info:infoPost})},TimeSheetService.LoadReportTimeInLieu=function(infoPost){var LoadReportTimeInLieu=api.all("TimeSheet/post-time-inlieu");return LoadReportTimeInLieu.post({info:infoPost})},TimeSheetService.LoadReportItemNumber=function(infoPost){var LoadReportItemNumber=api.all("TimeSheet/post-item-number");return LoadReportItemNumber.post({info:infoPost})},TimeSheetService.LoadReportUtilizationRatioSumary=function(infoPost){var LoadReportUtilizationRatioSumary=api.all("TimeSheet/post-utilization-sumary");return LoadReportUtilizationRatioSumary.post({info:infoPost})},TimeSheetService.LoadReportUtilizationRatioDetail=function(infoPost){var LoadReportUtilizationRatioDetail=api.all("TimeSheet/post-utilization-detail");return LoadReportUtilizationRatioDetail.post({info:infoPost})},TimeSheetService.DeleteFile=function(fileIdPost){var DeleteFile=api.all("TimeSheet/post-del-file");return DeleteFile.post({fileId:fileIdPost})},TimeSheetService}),angular.module("app.loggedIn.TimeSheet.Report1.Controller",[]).controller("Report1Controller",function($scope,localStorageService,StaffService,TimeSheetService,$cookieStore,toastr,$state,$filter){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.position=localStorageService.get("position"),$scope.listDepartmentChoose=[],$scope.listEmployeeChoose=[],$scope.listDept=[],$scope.listEmp=[],$scope.isHavedata=0,$scope.LoadEmp=function(listNew){void 0!==listNew&&null!==listNew&&0!==listNew.length&&TimeSheetService.LoadEmpReport(listNew).then(function(response){if("success"===response.status){var arrayEmp=[];angular.forEach(response.result,function(emp,index){arrayEmp.push({id:emp.Employee_ID,label:emp.FirstName+" "+emp.LastName})}),$scope.listEmp=angular.copy(arrayEmp),$scope.listEmployeeChoose=[]}else"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading employee fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.ChangeEmp=function(list){if(0!==$scope.listEmployeeChoose.length){$scope.isHavedata=1;var info={};info.listEMP=angular.copy($scope.listEmployeeChoose),info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,info.listDept=angular.copy($scope.listDepartmentChoose),TimeSheetService.LoadReportTimeInLieu(info).then(function(response){"success"===response.status?$scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null:"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading reports fail!","Error")):"null"===response.status?($scope.isHavedata=0,toastr.error("No Data!!!!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},$scope.LoadDeptReport=function(userId){TimeSheetService.LoadDeptReport(userId).then(function(response){"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load Department fail!","Error")):"success"===response.status?$scope.listDept=response.result:($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.LoadDeptReport($cookieStore.get("userInfo").id),$scope.translationTextDept={},$scope.translationTextDept={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Department Selected",selectionOf:"/",nameAddon:"Director"===$scope.position?"Departments":"Department",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Department--",dynamicButtonTextSuffix:"Department Selected"},$scope.searchDept={enableSearch:!0},$scope.searchEmp={enableSearch:!0},$scope.translationTextEmp={},$scope.translationTextEmp={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Employee Selected",selectionOf:"/",nameAddon:"Director"===$scope.position||"Head of Dept."===$scope.position?"Employees":"Employee",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Employee--",dynamicButtonTextSuffix:"Employee Selected"}}),angular.module("app.loggedIn.TimeSheet.Report2.Controller",[]).controller("Report2Controller",function($scope,localStorageService,StaffService,TimeSheetService,$cookieStore,toastr,$state,$filter){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.position=localStorageService.get("position"),$scope.listDepartmentChoose=[],$scope.listEmployeeChoose=[],$scope.listDept=[],$scope.listEmp=[],$scope.isHavedata=0,$scope.LoadEmp=function(listNew){void 0!==listNew&&null!==listNew&&0!==listNew.length&&(listNew[0].isStaff=$scope.isStaff,listNew[0].USER_ID=$cookieStore.get("userInfo").id,TimeSheetService.LoadEmpReport(listNew).then(function(response){if("success"===response.status){var arrayEmp=[];angular.forEach(response.result,function(emp,index){arrayEmp.push({id:emp.Employee_ID,label:emp.FirstName+" "+emp.LastName})}),$scope.listEmp=angular.copy(arrayEmp),$scope.listEmployeeChoose=[]}else"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading employee fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))}))},$scope.ChangeDate=function(){$scope.ChangeEmp($scope.listEmployeeChoose)},$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.ChangeEmp=function(list){if(void 0!==$scope.dateWeekFrom&&null!==$scope.dateWeekFrom&&""!==$scope.dateWeekFrom&&void 0!==$scope.dateWeekTo&&null!==$scope.dateWeekTo&&""!==$scope.dateWeekTo&&0!==$scope.listEmployeeChoose.length){$scope.isHavedata=1;var info={},weekNoFrom=$scope.dateWeekFrom,weekNoTo=$scope.dateWeekTo;info.weekNoFrom=$scope.GetWeekNumber(weekNoFrom),info.weekNoTo=$scope.GetWeekNumber(weekNoTo),info.listEMP=angular.copy($scope.listEmployeeChoose),info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,info.weekFrom=$scope.dateWeekFrom,info.weekTo=$scope.dateWeekTo,info.listDept=$scope.listDepartmentChoose,info.weekNoFrom=$scope.GetWeekNumber(weekNoFrom),TimeSheetService.LoadReportUtilizationRatioDetail(info).then(function(response){"success"===response.status?$scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null:"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading reports fail!","Error")):"null"===response.status?($scope.isHavedata=0,toastr.error("No Data!!!!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},$scope.LoadDeptReport=function(userId){TimeSheetService.LoadDeptReport(userId).then(function(response){"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load Department fail!","Error")):"success"===response.status?($scope.listDept=response.result,$scope.isStaff=response.isStaff):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.LoadDeptReport($cookieStore.get("userInfo").id),$scope.translationTextDept={},$scope.translationTextDept={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Department Selected",selectionOf:"/",nameAddon:"Director"===$scope.position?"Departments":"Department",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Department--",dynamicButtonTextSuffix:"Department Selected"},$scope.searchDept={enableSearch:!0},$scope.searchEmp={enableSearch:!0},$scope.translationTextEmp={},$scope.translationTextEmp={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Employee Selected",selectionOf:"/",nameAddon:"Director"===$scope.position||"Head of Dept."===$scope.position?"Employees":"Employee",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Employee--",dynamicButtonTextSuffix:"Employee Selected"}}),angular.module("app.loggedIn.TimeSheet.Report3.Controller",[]).controller("Report3Controller",function($scope,localStorageService,StaffService,TimeSheetService,$cookieStore,toastr,$state,$filter){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.position=localStorageService.get("position"),$scope.listDepartmentChoose=[],$scope.listEmployeeChoose=[],$scope.listDept=[],$scope.listEmp=[],$scope.isHavedata=0,$scope.LoadEmp=function(listNew){void 0!==listNew&&null!==listNew&&0!==listNew.length&&(listNew[0].isStaff=$scope.isStaff,listNew[0].USER_ID=$cookieStore.get("userInfo").id,TimeSheetService.LoadEmpReport(listNew).then(function(response){if("success"===response.status){var arrayEmp=[];angular.forEach(response.result,function(emp,index){arrayEmp.push({id:emp.Employee_ID,label:emp.FirstName+" "+emp.LastName})}),$scope.listEmp=angular.copy(arrayEmp),$scope.listEmployeeChoose=[]}else"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading employee fail!","Error")):($state.go("loggedIn.home",null,{
reload:!0}),toastr.error("Server not response!","Error"))}))},$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.ChangeDate=function(){$scope.ChangeEmp($scope.listEmployeeChoose)},$scope.ChangeEmp=function(list){if(void 0!==$scope.dateWeekFrom&&null!==$scope.dateWeekFrom&&""!==$scope.dateWeekFrom&&void 0!==$scope.dateWeekTo&&null!==$scope.dateWeekTo&&""!==$scope.dateWeekTo&&0!==$scope.listEmployeeChoose.length){$scope.isHavedata=1;var info={},weekNoFrom=$scope.dateWeekFrom,weekNoTo=$scope.dateWeekTo;info.weekNoFrom=$scope.GetWeekNumber(weekNoFrom),info.weekNoTo=$scope.GetWeekNumber(weekNoTo),info.listEMP=angular.copy($scope.listEmployeeChoose),info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,info.weekFrom=$scope.dateWeekFrom,info.weekTo=$scope.dateWeekTo,info.listDept=$scope.listDepartmentChoose,info.weekNoFrom=$scope.GetWeekNumber(weekNoFrom),TimeSheetService.LoadReportUtilizationRatioSumary(info).then(function(response){"success"===response.status?$scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null:"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading reports fail!","Error")):"null"===response.status?($scope.isHavedata=0,toastr.error("No Data!!!!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},$scope.LoadDeptReport=function(userId){TimeSheetService.LoadDeptReport(userId).then(function(response){"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load Department fail!","Error")):"success"===response.status?($scope.listDept=response.result,$scope.isStaff=response.isStaff):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.LoadDeptReport($cookieStore.get("userInfo").id),$scope.translationTextDept={},$scope.translationTextDept={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Department Selected",selectionOf:"/",nameAddon:"Director"===$scope.position?"Departments":"Department",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Department--",dynamicButtonTextSuffix:"Department Selected"},$scope.searchDept={enableSearch:!0},$scope.searchEmp={enableSearch:!0},$scope.translationTextEmp={},$scope.translationTextEmp={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Employee Selected",selectionOf:"/",nameAddon:"Director"===$scope.position||"Head of Dept."===$scope.position?"Employees":"Employee",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Employee--",dynamicButtonTextSuffix:"Employee Selected"}}),angular.module("app.loggedIn.TimeSheet.Report4.Controller",[]).controller("Report4Controller",function($scope,localStorageService,StaffService,TimeSheetService,$cookieStore,toastr,$state,$filter){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.position=localStorageService.get("position"),$scope.listDepartmentChoose=[],$scope.listEmployeeChoose=[],$scope.listDept=[],$scope.listEmp=[],$scope.LoadEmp=function(listNew){void 0!==listNew&&null!==listNew&&0!==listNew.length?TimeSheetService.LoadEmpReport(listNew).then(function(response){if("success"===response.status){var arrayEmp=[];angular.forEach(response.result,function(emp,index){arrayEmp.push({id:emp.Employee_ID,label:emp.FirstName+" "+emp.LastName})}),$scope.listEmp=angular.copy(arrayEmp),$scope.listEmployeeChoose=[]}else"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading employee fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))}):$scope.listEmployeeChoose=[]},$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.ChangeDate=function(){$scope.ChangeEmp($scope.listEmployeeChoose)},$scope.ChangeEmp=function(list){if(void 0!==$scope.dateWeekFrom&&null!==$scope.dateWeekFrom&&""!==$scope.dateWeekFrom&&void 0!==$scope.dateWeekTo&&null!==$scope.dateWeekTo&&""!==$scope.dateWeekTo&&0!==$scope.listEmployeeChoose.length){var info={};$scope.dateWeekFrom,$scope.dateWeekTo,info.listEMP=angular.copy($scope.listEmployeeChoose),info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,info.dateWeekFrom=$scope.dateWeekFrom,info.dateWeekTo=$scope.dateWeekTo,info.listDept=$scope.listDepartmentChoose,TimeSheetService.LoadReportOnActualWorking(info).then(function(response){"success"===response.status?($scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,$scope.disabledPrint=!1):"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading reports fail!","Error")):"dataNull"===response.status?(toastr.error("Not data!","Error"),$scope.disabledPrint=!0):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},$scope.LoadDeptReport=function(userId){TimeSheetService.LoadDeptReport(userId).then(function(response){"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load Department fail!","Error")):"success"===response.status?$scope.listDept=response.result:($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.LoadDeptReport($cookieStore.get("userInfo").id),$scope.translationTextDept={},$scope.translationTextDept={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Department Selected",selectionOf:"/",nameAddon:"Director"===$scope.position?"Departments":"Department",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Department--",dynamicButtonTextSuffix:"Department Selected"},$scope.searchDept={enableSearch:!0},$scope.searchEmp={enableSearch:!0},$scope.translationTextEmp={},$scope.translationTextEmp={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Employee Selected",selectionOf:"/",nameAddon:"Director"===$scope.position||"Head of Dept."===$scope.position?"Employees":"Employee",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Employee--",dynamicButtonTextSuffix:"Employee Selected"}}),angular.module("app.loggedIn.TimeSheet.Report5.Controller",[]).controller("Report5Controller",function($scope,localStorageService,StaffService,TimeSheetService,$cookieStore,toastr,$state,$filter){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.position=localStorageService.get("position"),$scope.listDepartmentChoose=[],$scope.listEmployeeChoose=[],$scope.listDept=[],$scope.listEmp=[],$scope.LoadEmp=function(listNew){void 0!==listNew&&null!==listNew&&0!==listNew.length?TimeSheetService.LoadEmpReport(listNew).then(function(response){if("success"===response.status){var arrayEmp=[];angular.forEach(response.result,function(emp,index){arrayEmp.push({id:emp.Employee_ID,label:emp.FirstName+" "+emp.LastName})}),$scope.listEmp=angular.copy(arrayEmp),$scope.listEmployeeChoose=[]}else"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading employee fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))}):$scope.listEmployeeChoose=[]},$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.ChangeDate=function(){$scope.ChangeEmp($scope.listEmployeeChoose)},$scope.ChangeEmp=function(list){if(void 0!==$scope.dateWeekFrom&&null!==$scope.dateWeekFrom&&""!==$scope.dateWeekFrom&&void 0!==$scope.dateWeekTo&&null!==$scope.dateWeekTo&&""!==$scope.dateWeekTo&&0!==$scope.listEmployeeChoose.length){var info={};$scope.dateWeekFrom,$scope.dateWeekTo,info.listEMP=angular.copy($scope.listEmployeeChoose),info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,info.dateWeekFrom=$scope.dateWeekFrom,info.dateWeekTo=$scope.dateWeekTo,info.listDept=$scope.listDepartmentChoose,TimeSheetService.LoadReportOnActualWorking(info).then(function(response){"success"===response.status?$scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null:"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading reports fail!","Error")):"dataNull"===response.status?(toastr.error("Not data!","Error"),$scope.disabledPrint=!0):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},$scope.LoadDeptReport=function(userId){TimeSheetService.LoadDeptReport(userId).then(function(response){"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load Department fail!","Error")):"success"===response.status?$scope.listDept=response.result:($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.LoadDeptReport($cookieStore.get("userInfo").id),$scope.translationTextDept={},$scope.translationTextDept={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Department Selected",selectionOf:"/",nameAddon:"Director"===$scope.position?"Departments":"Department",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Department--",dynamicButtonTextSuffix:"Department Selected"},$scope.searchDept={enableSearch:!0},$scope.searchEmp={enableSearch:!0},$scope.translationTextEmp={},$scope.translationTextEmp={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Employee Selected",selectionOf:"/",nameAddon:"Director"===$scope.position||"Head of Dept."===$scope.position?"Employees":"Employee",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Employee--",dynamicButtonTextSuffix:"Employee Selected"}}),angular.module("app.loggedIn.TimeSheet.Report6.Controller",[]).controller("Report6Controller",function($scope,localStorageService,StaffService,TimeSheetService,$cookieStore,toastr,$state,$filter){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.position=localStorageService.get("position"),$scope.listDepartmentChoose=[],$scope.listEmployeeChoose=[],$scope.listDept=[],$scope.listEmp=[],$scope.LoadEmp=function(listNew){void 0!==listNew&&null!==listNew&&0!==listNew.length&&(listNew[0].isStaff=$scope.isStaff,listNew[0].USER_ID=$cookieStore.get("userInfo").id,TimeSheetService.LoadEmpReport(listNew).then(function(response){if("success"===response.status){var arrayEmp=[];angular.forEach(response.result,function(emp,index){arrayEmp.push({id:emp.Employee_ID,label:emp.FirstName+" "+emp.LastName})}),$scope.listEmp=angular.copy(arrayEmp),$scope.listEmployeeChoose=[]}else"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading employee fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))}))},$scope.GetWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.ChangeDate=function(){$scope.ChangeEmp($scope.listEmployeeChoose)},$scope.ChangeEmp=function(list){if(void 0!==$scope.dateWeekFrom&&null!==$scope.dateWeekFrom&&""!==$scope.dateWeekFrom&&void 0!==$scope.dateWeekTo&&null!==$scope.dateWeekTo&&""!==$scope.dateWeekTo&&0!==$scope.listEmployeeChoose.length){var info={};info.listEMP=angular.copy($scope.listEmployeeChoose),info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,info.dateWeekFrom=$scope.dateWeekFrom,info.dateWeekTo=$scope.dateWeekTo,info.listDept=angular.copy($scope.listDepartmentChoose),TimeSheetService.LoadReportItemNumber(info).then(function(response){"success"===response.status?($scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,$scope.disabledPrint=!1):"dataNull"===response.status?(toastr.error("Not data!","Error"),$scope.disabledPrint=!0):"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading reports fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},$scope.LoadDeptReport=function(userId){TimeSheetService.LoadDeptReport(userId).then(function(response){"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load Department fail!","Error")):"success"===response.status?($scope.listDept=response.result,$scope.isStaff=response.isStaff):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.LoadDeptReport($cookieStore.get("userInfo").id),$scope.translationTextDept={},$scope.translationTextDept={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Department Selected",selectionOf:"/",nameAddon:"Director"===$scope.position?"Departments":"Department",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Department--",dynamicButtonTextSuffix:"Department Selected"},$scope.searchDept={enableSearch:!0},$scope.searchEmp={enableSearch:!0},$scope.translationTextEmp={},$scope.translationTextEmp={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Employee Selected",selectionOf:"/",nameAddon:"Director"===$scope.position||"Head of Dept."===$scope.position?"Employees":"Employee",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Employee--",dynamicButtonTextSuffix:"Employee Selected"}}),angular.module("app.loggedIn.TimeSheet",["app.loggedIn.TimeSheet.Home.Controller","app.loggedIn.TimeSheet.Directives","app.loggedIn.TimeSheet.Service","app.loggedIn.staff.service"]).config(function($stateProvider){$stateProvider.state("loggedIn.timesheetHome",{"abstract":!0,url:"/timesheet",templateUrl:"modules/TimeSheet/views/structure.html"}).state("loggedIn.timesheetHome.timesheetApprove",{position:["Head of Dept.","Director"],url:"/approve-timesheet",views:{"main-content":{templateUrl:"modules/TimeSheet/views/ApproveTask.html",controller:"ApproveTask"}}}).state("loggedIn.timesheetHome.timesheetReport1",{url:"/report/time-in-lieu",views:{"main-content":{templateUrl:"modules/TimeSheet/views/Report1.html",controller:"Report1Controller"}}}).state("loggedIn.timesheetHome.timesheetReport2",{url:"/report/utilization-ratio-detail",views:{"main-content":{templateUrl:"modules/TimeSheet/views/Report2.html",controller:"Report2Controller"}}}).state("loggedIn.timesheetHome.timesheetReport3",{url:"/report/utilization-ratio-summary",views:{"main-content":{templateUrl:"modules/TimeSheet/views/Report3.html",controller:"Report3Controller"}}}).state("loggedIn.timesheetHome.timesheetReport4",{url:"/report/actual-working-hours",views:{"main-content":{templateUrl:"modules/TimeSheet/views/Report4.html",controller:"Report4Controller"}}}).state("loggedIn.timesheetHome.timesheetReport5",{url:"/report/actual-working-ratio",views:{"main-content":{templateUrl:"modules/TimeSheet/views/Report5.html",controller:"Report5Controller"}}}).state("loggedIn.timesheetHome.timesheetReport6",{url:"/report/item-number",views:{"main-content":{templateUrl:"modules/TimeSheet/views/Report6.html",controller:"Report6Controller"}}}).state("loggedIn.timesheetHome.leaveCreate",{position:["Staff","Head of Dept."],url:"/create-leave/:id",views:{"main-content":{templateUrl:"modules/TimeSheet/views/CreateLeave.html",controller:"CreateLeaveController"}}}).state("loggedIn.timesheetHome.leaveHistory",{position:["Staff","Head of Dept."],url:"/historry-leave",views:{"main-content":{templateUrl:"modules/TimeSheet/views/HistoryLeave.html",controller:"HistoryLeaveController"}}}).state("loggedIn.timesheetHome.leaveApprove",{position:["Head of Dept.","Director"],url:"/approve-leave",views:{"main-content":{templateUrl:"modules/TimeSheet/views/ApproveLeave.html",controller:"ApproveLeaveController"}}}).state("loggedIn.timesheetHome.leaveReportOwe",{position:["Head of Dept.","Director"],url:"/report/unsubmitted-leave-form",views:{"main-content":{templateUrl:"modules/TimeSheet/views/ReportOweLeave.html",controller:"ReportOweLeave"}}}).state("loggedIn.timesheetHome.timesheetHistory",{position:["Staff","Head of Dept."],url:"/view-timesheet",views:{"main-content":{templateUrl:"modules/TimeSheet/views/viewTimesheet.html",controller:"TimesheetViewController"}}}).state("loggedIn.timesheetHome.timesheetCreate",{position:["Staff","Head of Dept."],url:"/create-timesheet/:id",views:{"main-content":{templateUrl:"modules/TimeSheet/views/createTimesheet.html",controller:"TimesheetCreateController"}}})}),angular.module("app.loggedIn.TimeSheet.ApproveTask.Controller",[]).controller("ApproveTask",function($scope,$modal,TimeSheetService,toastr,$state,MODE_ROW,$cookieStore){$scope.listStatus=[{code:2,name:"Awaiting for Approve"},{code:3,name:"Approved"},{code:4,name:"Rejected"},{code:5,name:"Re-submitted"}],$scope.SetPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.LoadList()},$scope.Reset=function(){$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.LoadList()},$scope.LoadList=function(){TimeSheetService.LoadTimeSheetApprove($scope.searchObjectMap).then(function(response){"success"==response.status?$scope.list=response:"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})};var Init=function(){$scope.searchObject={offset:0,limit:10,currentPage:1,maxSize:5,USER_ID:$cookieStore.get("userInfo").id,order:{"time_tasks_week.date_submited":null,"time_tasks_week.week_no":"DESC"},select:{"time_tasks_week.week_no":null,"hr_employee.Employee_ID":null},data:{"hr_employee.Employee_Code":null},name:{nameEmployee:null}},$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.list={},$scope.rows=MODE_ROW,$scope.LoadList()};Init(),$scope.WeekNoASC=function(){$scope.searchObjectMap.order["time_tasks_week.date_submited"]=null,$scope.searchObjectMap.order["time_tasks_week.week_no"]="ASC",$scope.LoadList()},$scope.WeekNoDESC=function(){$scope.searchObjectMap.order["time_tasks_week.date_submited"]=null,$scope.searchObjectMap.order["time_tasks_week.week_no"]="DESC",$scope.LoadList()},$scope.DateSubmitedASC=function(){$scope.searchObjectMap.order["time_tasks_week.date_submited"]="ASC",$scope.searchObjectMap.order["time_tasks_week.week_no"]=null,$scope.LoadList()},$scope.DateSubmitedDESC=function(){$scope.searchObjectMap.order["time_tasks_week.date_submited"]="DESC",$scope.searchObjectMap.order["time_tasks_week.week_no"]=null,$scope.LoadList()};var dialogViewTask=function(idTaskWeek){var modalInstance=$modal.open({templateUrl:"ViewTask",controller:function($scope){$scope.infoTaskWeek=idTaskWeek,$scope.ClickCancel=function(info){void 0!==info.clickCancel&&null!==info.clickCancel||void 0!==info.isReject&&null!==info.isReject||info.isApprove===!0?$scope.infoTaskWeek="cancelOn":modalInstance.close({status:"cancel"})},$scope.ClickReject=function(info){void 0===info.isReject||null===info.isReject?$scope.infoTaskWeek="reject":info.isReject===!0&&TimeSheetService.RejectTaskWeek(info).then(function(response){"success"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetApprove",null,{reload:!0}),toastr.success("Reject success!","Success")):"error"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetApprove",null,{reload:!0}),toastr.error("Reject fail!","Error")):(modalInstance.close(),$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.ClickApprove=function(info){null!==info.time_rest&&0!=info.time_rest&&""!==info.time_rest&&info.isApprove!==!0?$scope.infoTaskWeek="chooseApprove":info.forPermission===!1?swal({title:"Warning!",text:"Please noted that the Leave Form has not yet been submitted/approved. Do you want to approve this Timesheet?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(isConfirm){isConfirm&&TimeSheetService.ApproveTaskWeek(info).then(function(response){"success"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetApprove",null,{reload:!0}),toastr.success("Approve success!","Success")):"error"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetApprove",null,{reload:!0}),toastr.error("Approve fail!","Error")):"error-erp"===response.status?(modalInstance.close(),swal("Enterprise Resource Planning system not response, Please try again!")):(modalInstance.close(),$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}):TimeSheetService.ApproveTaskWeek(info).then(function(response){"success"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetApprove",null,{reload:!0}),toastr.success("Approve success!","Success")):"error"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.timesheetApprove",null,{reload:!0}),toastr.error("Approve fail!","Error")):"error-erp"===response.status?(modalInstance.close(),swal("Enterprise Resource Planning system not response, Please try again!")):(modalInstance.close(),$state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},size:"lg"})};$scope.ViewTask=function(idTaskWeek){dialogViewTask(idTaskWeek)}}),angular.module("app.loggedIn.TimeSheet.CreateLeave.Controller",[]).controller("CreateLeaveController",function($scope,TimeSheetService,$cookieStore,$state,toastr,$modal,StaffService,$stateParams){if($scope.info={},$scope.dateOptions={formatYear:"yy",startingDate:1},$scope.LoadLeaveEdit=function(info){TimeSheetService.LoadLeaveEdit(info).then(function(response){"success"===response.status?(void 0!==response&&null!==response&&void 0!==response.resultLeave&&null!==response.resultLeave&&0!==response.resultLeave.length&&void 0!==response.resultLeave[0]&&null!==response.resultLeave[0]&&($scope.info=response.resultLeave[0],$scope.is_reject=response.resultLeave[0].is_reject,$scope.status_id=response.resultLeave[0].status_id,$scope.info.time_leave=StaffService.ConvertFromFullToShow($scope.info.time_leave)),$scope.info.infoTypeLeave=response.resultLeaveDetail,angular.forEach($scope.info.infoTypeLeave,function(leave,index){void 0===$scope.info.infoTypeLeave[index]||null===$scope.info.infoTypeLeave[index]||void 0===$scope.info.infoTypeLeave[index].time_leave||null===$scope.info.infoTypeLeave[index].time_leave||0===$scope.info.infoTypeLeave[index].time_leave||isNaN($scope.info.infoTypeLeave[index].time_leave)||($scope.info.infoTypeLeave[index].time_leave=StaffService.ConvertFromFullToShow($scope.info.infoTypeLeave[index].time_leave),0===index&&4===$scope.info.infoTypeLeave[index].time_leave.length&&0===$scope.info.standard&&($scope.info.infoTypeLeave[index].time_leave="0"+$scope.info.infoTypeLeave[index].time_leave))}),$scope.ChangeTime()):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load fail!","Error"))})},$scope.LoadLeaveAddNew=function(){void 0!==$cookieStore.get("userInfo")&&null!==$cookieStore.get("userInfo")&&void 0!==$cookieStore.get("userInfo").id&&null!==$cookieStore.get("userInfo").id?TimeSheetService.LoadInfoEmployee($cookieStore.get("userInfo").id).then(function(response){"success"===response.status?void 0!==response&&null!==response&&void 0!==response.resultEmployee&&null!==response.resultEmployee&&void 0!==response.resultEmployee[0]&&null!==response.resultEmployee[0]&&($scope.info=response.resultEmployee[0],$scope.info.standard=1,$scope.info.application_date=new Date,$scope.info.infoTypeLeave=angular.copy(response.resultTypeLeave)):"error"===response.status||0===response.result.length?($state.go("loggedIn.home",null,{reload:!0}),toastr("Load infomation employee fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr("Server not response!","Error"))}):($state.go("loggedIn.login",null,{reload:!0}),toastr.error("You not section!","Error"))},$scope.CreateLeaveForm=function(info){TimeSheetService.CreateLeaveForm(info).then(function(response){"success"===response.status?(toastr.success("Apply leave success!","Success"),$state.go("loggedIn.timesheetHome.leaveHistory",null,{reload:!0})):"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Apply leave fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.UpdateLeave=function(info){TimeSheetService.UpdateLeave(info).then(function(response){"success"===response.status?($state.go("loggedIn.timesheetHome.leaveHistory",null,{reload:!0}),toastr.success("Update leave success!","Success")):"error"===response.status?toastr.error("Update leave fail!","Error"):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$stateParams.id){$scope.isEdit=!0;var info={idLeave:$stateParams.id,userId:$cookieStore.get("userInfo").id};$scope.LoadLeaveEdit(info)}else $scope.isEdit=!1,$scope.LoadLeaveAddNew();$scope.ClickSendServer=function(statusID,formLeave){$scope.isRequired=1,formLeave.$invalid?toastr.error("Please Input All Required Information!","Error"):0===$scope.info.time_leave_real||void 0===$scope.info.time_leave||null===$scope.info.time_leave||0===$scope.info.time_leave.length?toastr.error("You must sign time leave!","Error"):void 0!==$scope.info.time_leave_real&&void 0!==$scope.info.standard&&($scope.info.time_leave_real>4560&&1===$scope.info.standard||$scope.info.time_leave_real<=4560&&0===$scope.info.standard)?toastr.warning("Please make sure you have chosen the right type of Leave Form (Standard/Non-Standard).","Warning"):($scope.info.statusID=statusID,$scope.info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,$scope.isEdit===!1?$scope.CreateLeaveForm($scope.info):$scope.isEdit===!0&&$scope.UpdateLeave($scope.info))},$scope.ChangeTime=function(){var total_time=0;angular.forEach($scope.info.infoTypeLeave,function(time,index){total_time+=StaffService.ConvertShowToFull($scope.info.infoTypeLeave[index].time_leave),$scope.info.infoTypeLeave[index].time_leave_real=StaffService.ConvertShowToFull($scope.info.infoTypeLeave[index].time_leave)}),$scope.info.time_leave=StaffService.ConvertFromFullToShow(total_time),$scope.info.time_leave_real=StaffService.ConvertShowToFull($scope.info.time_leave),0===total_time&&($scope.info.time_leave=null)},$scope.ClickStandardChange=function(standardID){1===standardID?void 0!==$scope.info.infoTypeLeave&&null!==$scope.info.infoTypeLeave&&void 0!==$scope.info.infoTypeLeave[0]&&null!==$scope.info.infoTypeLeave[0]&&void 0!==$scope.info.infoTypeLeave[0].time_leave&&null!==$scope.info.infoTypeLeave[0].time_leave&&5===$scope.info.infoTypeLeave[0].time_leave.length&&($scope.info.infoTypeLeave[0].time_leave=$scope.info.infoTypeLeave[0].time_leave.substr(1,$scope.info.infoTypeLeave[0].time_leave.length-1),$scope.ChangeTime()):0===standardID&&void 0!==$scope.info.infoTypeLeave&&null!==$scope.info.infoTypeLeave&&void 0!==$scope.info.infoTypeLeave[0]&&null!==$scope.info.infoTypeLeave[0]&&void 0!==$scope.info.infoTypeLeave[0].time_leave&&null!==$scope.info.infoTypeLeave[0].time_leave&&4===$scope.info.infoTypeLeave[0].time_leave.length&&($scope.info.infoTypeLeave[0].time_leave="0"+$scope.info.infoTypeLeave[0].time_leave,$scope.ChangeTime())},$scope.CheckLeaveExist=function(){void 0!==$scope.info.start_date&&null!==$scope.info.start_date&&0!==$scope.info.start_date.length&&void 0!==$scope.info.finish_date&&null!==$scope.info.finish_date&&0!==$scope.info.finish_date.length&&TimeSheetService.CheckLeave($cookieStore.get("userInfo").id).then(function(response){if("success"===response.status){var currentStartDate=moment(moment($scope.info.start_date).format("YYYY-MM-DD")).format("X"),currentFinishDate=moment(moment($scope.info.finish_date).format("YYYY-MM-DD")).format("X"),arrayTime=angular.copy(response.result);angular.forEach(arrayTime,function(timeRange,index){var startDate=moment(moment(timeRange.start_date).format("YYYY-MM-DD")).format("X"),finishDate=moment(moment(timeRange.finish_date).format("YYYY-MM-DD")).format("X");currentStartDate>=startDate&&finishDate>=currentStartDate&&finishDate>=currentFinishDate&&currentFinishDate>=startDate&&swal({title:"Time leave is exist!",text:"Do you want view history!",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes",closeOnConfirm:!0},function(isConfirm){isConfirm?$state.go("loggedIn.timesheetHome.leaveHistory",null,{reload:!0}):($scope.info.start_date=null,$scope.info.finish_date=null)})})}})}}),angular.module("app.loggedIn.TimeSheet.HistoryLeave.Controller",[]).controller("HistoryLeaveController",function($scope,TimeSheetService,$cookieStore,toastr,$state,MODE_ROW,$modal,$stateParams){$scope.Reset=function(){$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.LoadList()},$scope.SetPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.LoadList()},$scope.LoadList=function(){TimeSheetService.LoadHistoryLeave($scope.searchObjectMap).then(function(response){$scope.list=response,$scope.count=void 0!==response.count&&null!==response.count?response.count:0,$scope.listStatus=response.resultStatus})};var Init=function(){$scope.searchObject={limit:5,offset:0,currentPage:1,maxSize:5,USER_ID:void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,select:{"hr_leave.status_id":""},order:{0:"DESC"}},$scope.rows=MODE_ROW,$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.list={},$scope.LoadList()};Init(),$scope.View=function(id){var modalInstance=$modal.open({templateUrl:"ViewLeave",controller:function($scope){$scope.idView=id,$scope.ClickCancel=function(value){modalInstance.close()},$scope.SubmitOnViewLeave=function(statusID,leaveID){var info={statusID:statusID,leaveID:leaveID,userID:$cookieStore.get("userInfo").id};TimeSheetService.SubmitOnViewLeave(info).then(function(response){"success"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveHistory",null,{reload:!0}),toastr.success("Submit success!","Success")):"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Submit fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.ClickEdit=function(leaveID){modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveCreate",{id:leaveID})}},size:"lg"})},$scope.ClickAsc=function(){$scope.searchObjectMap.order[0]="ASC",$scope.LoadList()},$scope.ClickDesc=function(){$scope.searchObjectMap.order[0]="DESC",$scope.LoadList()},$scope.GetStyle=function(timeLeave){return timeLeave>=6e3?{"margin-right":"5px"}:void 0}}),angular.module("app.loggedIn.TimeSheet.ApproveLeave.Controller",[]).controller("ApproveLeaveController",function($scope,MODE_ROW,$modal,toastr,$state,TimeSheetService,$cookieStore){$scope.listStatus=[{code:2,name:"Awaiting for Approve"},{code:3,name:"Approved"},{code:4,name:"Rejected"},{code:5,name:"Re-submitted"}],$scope.SetPage=function(){$scope.searchObjectMap.offset=($scope.searchObjectMap.currentPage-1)*$scope.searchObjectMap.limit,$scope.LoadList()},$scope.Reset=function(){$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.LoadList()},$scope.LoadList=function(){TimeSheetService.LoadLeaveApprove($scope.searchObjectMap).then(function(response){"success"===response.status?($scope.list=response,$scope.count=response.count):"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading leave fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.ClickAsc=function(){$scope.searchObjectMap.order[0]="ASC",
$scope.LoadList()},$scope.ClickDesc=function(){$scope.searchObjectMap.order[0]="DESC",$scope.LoadList()},$scope.View=function(idView){var modalInstance=$modal.open({templateUrl:"ViewLeaveApprove",controller:function($scope){$scope.idView=idView,$scope.ClickCancel=function(value){void 0!==value&&null!==value&&value.isReject===!0?$scope.idView=value.leaveID:modalInstance.close()},$scope.ClickReject=function(info){void 0!==info&&null!==info&&info.isReject===!1?$scope.idView="clickReject":void 0!==info&&null!==info&&info.isReject===!0&&TimeSheetService.RejectLeave(info).then(function(response){"success"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveApprove",null,{reload:!0}),toastr.success("Reject leave success!","Success")):"error"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveApprove",null,{reload:!0}),toastr.error("Reject leave fail!","Error")):(modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveApprove",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.ClickApprove=function(info){TimeSheetService.ApproveLeave(info).then(function(response){"success"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveApprove",null,{reload:!0}),toastr.success("Approve leave success!","Success")):"error"===response.status?(modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveApprove",null,{reload:!0}),toastr.error("Approve leave fail!","Error")):(modalInstance.close(),$state.go("loggedIn.timesheetHome.leaveApprove",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},size:"lg"})};var Init=function(){$scope.searchObject={limit:5,offset:0,currentPage:1,maxSize:5,USER_ID:void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,search:{0:null},order:{0:"DESC"},select:{0:null}},$scope.searchObjectMap=angular.copy($scope.searchObject),$scope.list={},$scope.rows=MODE_ROW,$scope.LoadList()};Init(),$scope.GetStyle=function(timeLeave){return timeLeave>=6e3?{"margin-right":"5px"}:void 0}}),angular.module("app.loggedIn.TimeSheet.ViewLeave.Directive",[]).directive("viewLeave",function(TimeSheetService,$cookieStore){return{restrict:"EA",required:"ngModel",scope:{onCancel:"&",onEdit:"&",onSubmitagain:"&",ngModel:"="},link:function(scope,attrs,elem){scope.$watch("ngModel",function(newModel,oldModel){if(void 0!==newModel&&null!==newModel&&!isNaN(newModel)){scope.ViewLeave=function(info){TimeSheetService.ViewLeave(info).then(function(response){scope.list=response,void 0!==scope.list&&null!==scope.list&&void 0!==scope.list.result&&null!==scope.list.result&&void 0!==scope.list.result[0]&&null!==scope.list.result[0]&&(scope.employee_name=null===scope.list.result[0].FirstName||""===scope.list.result[0].FirstName?null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName:scope.list.result[0].FirstName+" "+(null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName),scope.statusID=scope.list.result[0].task_status_id,scope.is_reject=scope.list.result[0].is_reject)})};var info={leave_id:newModel,user_id:$cookieStore.get("userInfo").id};scope.ViewLeave(info)}}),scope.GetStyle=function(timeLeave){return timeLeave>=6e3?{"margin-right":"5px"}:void 0}},templateUrl:"modules/TimeSheet/directives/templates/ViewLeave.html"}}),angular.module("app.loggedIn.TimeSheet.ApproveLeave.Directive",[]).directive("viewLeaveapprove",function(TimeSheetService,$cookieStore){return{restrict:"EA",required:"ngModel",scope:{ngModel:"=",onCancel:"&",onReject:"&",onApprove:"&"},link:function(scope,elem,attrs){scope.info={},scope.$watch("ngModel",function(newModel,oldModel){if(void 0===newModel||null===newModel||isNaN(newModel))"clickReject"===newModel&&(scope.info.isReject=!0,scope.info.comments=null);else{scope.info.isReject=!1,scope.info.leaveID=newModel,scope.info.userID=$cookieStore.get("userInfo").id;var info={};info.leave_id=newModel,info.user_id=$cookieStore.get("userInfo").id,scope.ViewLeave=function(info){TimeSheetService.ViewLeave(info).then(function(response){scope.list=response,void 0!==scope.list&&null!==scope.list&&void 0!==scope.list.result&&null!==scope.list.result&&void 0!==scope.list.result[0]&&null!==scope.list.result[0]&&(scope.employee_name=null===scope.list.result[0].FirstName||""===scope.list.result[0].FirstName?null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName:scope.list.result[0].FirstName+" "+(null===scope.list.result[0].LastName||""===scope.list.result[0].LastName?" ":scope.list.result[0].LastName),scope.statusID=scope.list.result[0].task_status_id,scope.isPermiss=response.isPermiss)})},scope.ViewLeave(info)}}),scope.GetStyle=function(timeLeave){return timeLeave>=6e3?{"margin-right":"5px"}:void 0}},templateUrl:"modules/TimeSheet/directives/templates/ViewLeaveApprove.html"}}),angular.module("app.loggedIn.TimeSheet.ReportOweLeave.Controller",[]).controller("ReportOweLeave",function($scope,localStorageService,StaffService,TimeSheetService,$cookieStore,toastr,$state,$filter){$scope.dateOptions={formatYear:"yy",startingDay:1},$scope.position=localStorageService.get("position"),$scope.listDepartmentChoose=[],$scope.listEmployeeChoose=[],$scope.listDept=[],$scope.listEmp=[],$scope.isHavedata=0,$scope.LoadEmp=function(listNew){TimeSheetService.LoadEmpReport(listNew).then(function(response){if("success"===response.status){var arrayEmp=[];angular.forEach(response.result,function(emp,index){arrayEmp.push({id:emp.Employee_ID,label:emp.FirstName+" "+emp.LastName})}),$scope.listEmp=angular.copy(arrayEmp),$scope.listEmployeeChoose=[]}else"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading employee fail!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.getWeekNumber=function(d){d=new Date(+d),d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7));var yearStart=new Date(d.getFullYear(),0,1),weekNo=Math.ceil(((d-yearStart)/864e5+1)/7);return weekNo},$scope.changeEmp=function(list){if(void 0!==$scope.dateWeekFrom&&null!==$scope.dateWeekFrom&&""!==$scope.dateWeekFrom&&void 0!==$scope.dateWeekTo&&null!==$scope.dateWeekTo&&""!==$scope.dateWeekTo&&0!==$scope.listEmployeeChoose.length){$scope.isHavedata=1;var info={},weekNoFrom=$scope.dateWeekFrom,weekNoTo=$scope.dateWeekTo;info.weekNoFrom=$scope.GetWeekNumber(weekNoFrom),info.weekNoTo=$scope.GetWeekNumber(weekNoTo),info.listEMP=angular.copy($scope.listEmployeeChoose),info.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null,info.weekFrom=$scope.dateWeekFrom,info.weekTo=$scope.dateWeekTo,info.listDept=$scope.listDepartmentChoose,info.weekNoFrom=$scope.GetWeekNumber(weekNoFrom),TimeSheetService.LoadReportOweLeave(info).then(function(response){"success"===response.status?$scope.USER_ID=void 0!==$cookieStore.get("userInfo")?$cookieStore.get("userInfo").id:null:"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Loading reports fail!","Error")):"null"===response.status?($scope.isHavedata=0,toastr.error("No Data!!!!","Error")):($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})}},$scope.LoadDeptReport=function(userId){TimeSheetService.LoadDeptReport(userId).then(function(response){"error"===response.status?($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Load Department fail!","Error")):"success"===response.status?$scope.listDept=response.result:($state.go("loggedIn.home",null,{reload:!0}),toastr.error("Server not response!","Error"))})},$scope.LoadDeptReport($cookieStore.get("userInfo").id),$scope.translationTextDept={},$scope.translationTextDept={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Department Selected",selectionOf:"/",nameAddon:"Director"===$scope.position?"Departments":"Department",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Department--",dynamicButtonTextSuffix:"Department Selected"},$scope.searchDept={enableSearch:!0},$scope.searchEmp={enableSearch:!0},$scope.translationTextEmp={},$scope.translationTextEmp={checkAll:"Check All",uncheckAll:"Uncheck All",selectionCount:"Employee Selected",selectionOf:"/",nameAddon:"Director"===$scope.position||"Head of Dept."===$scope.position?"Employees":"Employee",searchPlaceholder:"Search...",buttonDefaultText:"--Choose Employee--",dynamicButtonTextSuffix:"Employee Selected"}}),angular.module("app.loggedIn.TimeSheet.formValidate.Directive",[]).directive("modelValidate",function(){return{restrict:"EA",require:"ngModel",scope:{ngModel:"=",modelValidate:"=",formValidate:"="},link:function(scope,elem,attrs){var notiError={maxlength:"Too long!",required:"Field is required!"};scope.$watch("modelValidate",function(newModel,oldModel){void 0!==newModel&&null!==newModel&&0!==newModel.length?attrs.$set("required",!0):attrs.$set("required",!1);var isErr=!1,indexErr=-1;angular.forEach(scope.formValidate,function(valueError,indexError){valueError===!0&&(isErr=!0,indexErr=indexError)}),isErr?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHTML:!0,content:notiError[indexErr]})):(elem.hasClass("tooltipstered")&&(angular.element(elem).tooltipster("destroy"),angular.element(elem).removeAttr("title")),elem.css("border-color","#ECECEC"))}),scope.$watch("ngModel",function(newModel,oldModel){var isErr=!1,indexErr=-1;angular.forEach(scope.formValidate,function(valueError,indexError){valueError===!0&&(isErr=!0,indexErr=indexError)}),isErr?(elem.css("border-color","#F3565D"),elem.hasClass("tooltipstered")&&angular.element(elem).tooltipster("destroy"),angular.element(elem).tooltipster({theme:"tooltip-error-theme",contentAsHTML:!0,content:notiError[indexErr]})):(elem.hasClass("tooltipstered")&&(angular.element(elem).tooltipster("destroy"),angular.element(elem).removeAttr("title")),elem.css("border-color","#ECECEC"))})}}});