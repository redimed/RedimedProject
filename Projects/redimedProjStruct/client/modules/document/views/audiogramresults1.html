<style>
    #modalSign .modal-dialog {
        width: 800px;
        height: 800px;
    }
</style>

<div class="caption">
    <div class="row">
        <div class="col-md-12 ">
            <a href="javascript:;" ng-click="submit()" class="btn green pull-right">Submit</a>
            <a href="javascript:;" class="btn btn-primary blue pull-right">Print PDF</a>
            <a href="javascript:;" class="btn btn-danger pull-right">Reset</a>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="caption">
        <div class="row">
            <div class="col-md-12 col-sm-12">
                <p style="font-size: xx-large;text-align: center;font-weight: bolder">
                    Audiogram 1
                </p>
            </div>
        </div>
    </div>
</div>

<div class="row">
<div class="col-md-12 col-sm-12">
<div class="portlet box grey-cascade">
<div class="portlet-title">
    <div class="caption">
        <i class="fa fa-gift"></i>TO RELEASE WORKCOVER WA
        AUDIOMETRIC TEST RESULTS
        FORM 406
    </div>
    <div class="tools">
        <a href="javascript:;" class="collapse">
        </a>
    </div>
</div>
<div class="portlet-body form">
<!-- BEGIN FORM-->
<form class="form-horizontal form-bordered">
<div class="row">
<div class="col-md-12 col-sm-12">
<div ng-repeat="section in listAUD1[0].section">
<div class="portlet-body form">
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">
                Section A - Details
            </label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-1 col-sm-1">
            <label class="control-label">Name:</label>
        </div>
        <div class="col-md-11 col-sm-11" style="text-align: left;">
            <label class="control-label">Minh Phuong</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-2">
            <label class="control-label" style="text-align: left;">Worker ID number:</label>
        </div>
        <div class="col-md-10 col-sm-10">
            <label class="control-label" style="text-align: left;"></label>
        </div>
    </div>
</div>
<hr/>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">Section B - Authorisation</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">I authorise the release of my WorkCover WA
                Audiometric test results to:</label>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-3">
            <label class="control-label" style="text-align: left;">Name of
                recipient:</label>
        </div>
        <div class="col-md-5 col-sm-7">
            <input type="text" class="form-control"/>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-3">
            <label class="control-label" style="text-align: left;">Location
                of test:</label>
        </div>
        <div class="col-md-10 col-sm-9">
            <label class="control-label">Belmont - 1 Frederick Street Belmont
                WA</label>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-3">
            <label class="control-label" style="text-align: left;">Date of tetst:</label>
        </div>
        <div class="col-md-3 col-sm-4">
            <input type="text" class="form-control col-md-12" name="dob" required
                   datepicker-popup="dd/MM/yyyy" data-ng-model="info.dob"
                   is-open="openDOB" ng-click="openDOB = true"
                   datepicker-options="dateOptions3" ng-required="true"
                   close-text="Close"/>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-3 col-sm-5">
            <label class="control-label" style="text-align: left;">Name of person conducting test:</label>
        </div>
        <div class="col-md-9 col-sm-7">
            <label class="control-label" style="text-align: left;">Pre-employment 1</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-2">
            <label class="control-label" style="text-align: left;">Please note:</label>
        </div>
        <div class="col-md-10 col-sm-10">
            <label class="control-label" style="text-align: left;">The release of audiometric
                test results is
                not compulsory. Signing of this form is at your discretion
                Approved Audiometric Officers to maintain a copy of this form.
                Audiologists please return completed form to:
                Noise Induced Hearing Loss WorkCover WA
                2 Bedbrook Place
                SHENTON PARK WA 6008
                Fax: (08) 9388 5550
                For further information:
                Phone: (08) 9388 5661</label>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-2">
            <label class="control-label">Signed:</label>
        </div>
        <div class="col-md-3 col-sm-3">
            <a href="javascript:;" id="signBtn" class="btn green">Sign</a>
        </div>
        <script type="text/javascript">
            $('#signBtn').click(function () {
                $('#modalSign').modal({
                    show: true
                });
            });

        </script>
    </div>
</div>
<div class="row">
    <div class="col-md-6 col-sm-6" style="margin-left:15px;">
        <img src="" id="signDisplay" ng-model="info.consentSign"
             style="width:300px;height: 150px;"/>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-2">
            <label class="control-label">Date:</label>
        </div>
        <div class="col-md-3 col-sm-3">
            <input type="text" class="form-control col-md-12" name="dob" required
                   datepicker-popup="dd/MM/yyyy" data-ng-model="info.dob"
                   is-open="openDOB1" ng-click="openDOB1 = true"
                   datepicker-options="dateOptions3" ng-required="true"
                   close-text="Close"/>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">Workers' Compensation and Injury Management
                Regulations 1982</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">Regulation 19F</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">Regulation 19F</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">(2) WorkCover WA shall, on the written request of
                the worker tested, communicate the results of an audiometric test delivered
                to it under clause 4(2) to any person specified by the worker in
                that request.</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">(3) A person who receives the results of an
                audiometric test under
                subregulation (2) shall ensure that the results of the test, and any information derived from
                those results are not
                communicated to any person other than the worker except at the written request of the worker
                tested</label>
        </div>
    </div>
</div>
<br/>
</div>
</div>
</div>
</div>
</form>
<!--END FORM-->
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-12 col-sm-12">
<div class="portlet box grey-cascade">
<div class="portlet-title">
    <div class="caption">
        <i class="fa fa-gift"></i>AUDIOGRAM RESULTS
        Form 411
    </div>
    <div class="tools">
        <a href="javascript:;" class="collapse">
        </a>
    </div>
</div>
<div class="portlet-body form">
<!-- BEGIN FORM-->
<form class="form-horizontal form-bordered">
<div class="row">
<div class="col-md-12 col-sm-12">
<div ng-repeat="section in listAUD1[0].section">
<div class="portlet-body form">
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label bold">Must be given to the worker within one
                month of the date of the test being completed</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">
                Section A - Details
            </label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-3">
            <label class="control-label" style="text-align: left;">Name:</label>
        </div>
        <div class="col-md-10 col-sm-9" style="text-align: left;">
            <label class="control-label" style="text-align: left;">Minh Phuong</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-10">
        <div class="col-md-2 col-sm-3">
            <label class="control-label" style="text-align: left;">Employer name:</label>
        </div>
        <div class="col-md-10 col-sm-9">
            <label class="control-label"></label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-3">
            <label class="control-label" style="text-align: left;">Tester name:</label>
        </div>
        <div class="col-md-10 col-sm-9">
            <label class="control-label" style="text-align: left;">Pre-employment 1</label>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-2 col-sm-3">
            <label class="control-label">Date:</label>
        </div>
        <div class="col-md-3 col-sm-3">
            <input type="text" class="form-control col-md-12" name="dob" required
                   datepicker-popup="dd/MM/yyyy" data-ng-model="info.dob"
                   is-open="openDOB2" ng-click="openDOB2 = true"
                   datepicker-options="dateOptions3" ng-required="true"
                   close-text="Close"/>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">Here are the results of your hearing test
                and what they mean.</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">What is an audiogram? An audiogram shows
                the softest level at which a person can hear a range of different
                pure tones.</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label bold">Here is your audiogram:</label>
        </div>
    </div>
</div>
<br/>

<div class="row">
    <div class="col-md-12 col-sm-12" style="text-align: center;">
        <div class="col-md-2 col-sm-3">
            <label class="control-label">Frequence (Hz)</label>
        </div>
        <div class="col-md-2 col-sm-3">
            <label class="control-label">Right Ear (dB)</label>
        </div>
        <div class="col-md-2 col-sm-3">
            <label class="control-label">Left Ear (dB)</label>
        </div>
    </div>
</div>
<div ng-repeat="line in section.line">
    <div class="row">
        <div class="col-md-12 col-sm-12">
            <div class="col-md-2 col-sm-3" style="text-align: center;">
                <label class="control-label">{{line.line_name}}</label>
            </div>
            <div class="col-md-2 col-sm-3">
                <input type="text" class="form-control" name=""
                       value="{{line.line_value_right}}"/>
            </div>
            <div class="col-md-2 col-sm-3">
                <input type="text" class="form-control" name=""
                       value="{{line.line_value_left}}"/>
            </div>
        </div>
    </div>
    <br/>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12" style="float: right;">
            <button ng-click="addData()">Draw</button>
            <!--<img src="/img/XepHinh.png" alt="" class="img-responsive" style="height: 600px;width: 60%;margin-left: 20%;"/>-->

            <canvas id="canvas" height="600px" width="600px" style="margin-left: 20%"></canvas>

        </div>
    </div>
</div>
<br/>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">The softest sounds that you responded to
                are marked 0 for the right ear an X for the left ear. These are your
                hearing threshold levels.</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">As a benchmark, normal hearing falls
                between 0 and 20 dB.</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">Degrees of hearing loss:</label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">
                Mild loss 25-45 dB
            </label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">
                Moderate loss50-65 dB
            </label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">
                Severe loss 70-90 dB <br/>
            </label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label">
                Profound loss 95 dB+
            </label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">
                All the major sounds of speech are contained within the audiogram range. The approximate volume and
                pitch of various speech sounds are shown on the audiogram above. This may give you an
                indication of the sounds you hear less clearly. </label>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 col-sm-12">
        <div class="col-md-12 col-sm-12">
            <label class="control-label" style="text-align: left;">
                You have three months from the date of receiving these results to notify WorkCover WA that you wish to
                disagree with the results. </label>
        </div>
    </div>
</div>
<br/>
</div>
</div>
</div>
</div>
</form>
</div>
</div>
</div>
</div>

<div id="modalSign" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">Signature</h4>
            </div>
            <div class="modal-body">
                <div id="signature"></div>
            </div>
            <div class="modal-footer">
                <a href="#" class="btn red" data-dismiss="modal">Cancel</a>
                <a href="javascript:;" id="resetSig" class="btn blue">Reset</a>
                <a href="javascript:;" id="okSig" class="btn green">OK</a>

            </div>
        </div>
    </div>
</div>
<script src="../../../theme/assets/global/plugins/jSignature/jSignature.min.noconflict.js"></script>

<script>
    (function ($) {
        $(document).ready(function () {

            $('#signDisplay').hide();
            var $sigdiv = $("#signature").jSignature({lineWidth: 2, width: 700, height: 500});

            $('#resetSig').on('click', function () {
                $sigdiv.jSignature('reset')
            });

            $('#okSig').on('click', function () {
                var data = $sigdiv.jSignature('getData')
                if (data != null) {
                    $('#signDisplay').attr("src", data);
                    $('#signDisplay').show();
                }

                $('#modalSign').modal('hide');

            });

        })
    })(jQuery)
</script>

<script type="text/javascript">
    (function ($) {
        $(document).ready(function () {
            var counter = 0;
            function AUD1Controller($scope) {
                alert('aaa');
                var canvas = document.getElementById('canvas');
                var context = canvas.getContext('2d');

                $scope.data = [

                ];

                $scope.addData = function() {

                    var id = 0;
                    if($scope.data.length > 0) {
                        id = $scope.data[$scope.data.length-1].id + 1;
                    }
                    var p = {id: id, x: 100, y: 100, amount: 6 };
                    $scope.data.push(p);
                    $scope.x = '';
                    $scope.y = '';
                    $scope.amount = '';
                    draw($scope.data);
                };

                $scope.removePoint = function(point) {
                    console.log(point);
                    for(var i=0; i<$scope.data.length; i++) {
                        if($scope.data[i].id === point.id) {
                            console.log("removing item at position: "+i);
                            $scope.data.splice(i, 1);
                        }
                    }

                    context.clearRect(0,0,600,400);
                    draw($scope.data);
                    console.log($scope.data);
                }

                function draw(data) {
                    for(var i=0; i<data.length; i++) {
                        drawDot(data[i]);
                        if(i > 0) {
                            drawLine(data[i], data[i-1]);
                        }
                    }
                }

                function drawDot(data) {
                    context.beginPath();
                    context.arc(data.x, data.y, data.amount, 0, 2*Math.PI, false);
                    context.fillStyle = "#ccddff";
                    context.fill();
                    context.lineWidth = 1;
                    context.strokeStyle = "#666666";
                    context.stroke();
                }

                function drawLine(data1, data2) {
                    context.beginPath();
                    context.moveTo(data1.x, data1.y);
                    context.lineTo(data2.x, data2.y);
                    context.strokeStyle = "black";
                    context.stroke();
                }

                // setup
                canvas.width = 600;
                canvas.height = 400;
                context.globalAlpha = 1.0;
                context.beginPath();
                draw($scope.data);
            }


        })
    })(jQuery)

</script>