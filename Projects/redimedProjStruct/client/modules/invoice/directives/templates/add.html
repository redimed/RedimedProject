<div class="portlet box">
	<!--<div class="portlet-title">
	    <div class="pull-right navbar-right">
            <button ng-click="clickAction()" class="btn btn-default"><i class="fa fa-save"></i> Save </button>
        </div>
	</div>-->
	<div class="portlet-body">
	<div class="row" style="margin-top: 15px;">
		<form name="patientForm" novalidate>
		<!--Patient_id-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label>Patient</label>	
				<div>
					<input disabled type="text" placeholder="Patient" class="form-control" 
						ng-model="InvoiceMap.patient.full_name" float-label>
				</div>
			</span>	
		</div>
		<!--Patient_id-->

		<!--Company_id-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label>Company</label>
				<input type="text" disabled placeholder="Company" ng-model="InvoiceMap.company.Company_name" 
					class="form-control">
			</span>	
		</div>
		<!--Company_id-->

		<!--Insurer_id-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label>Insurer</label>
				<input type="text" disabled placeholder="Insurer" ng-model="InvoiceMap.insurer.insurer_name" class="form-control">
			</span>	
		</div>
		<!--Insurer_id-->

		<!--SERVICE_ID-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label>Service</label>
				<select class="form-control" name="SERVICE_ID" id="SERVICE_ID"
					ng-model="InvoiceMap.SERVICE_ID"
					ng-options="item.SERVICE_ID as item.SERVICE_NAME for item in opt_services">
				</select>
			</span>	
		</div>
		<!--SERVICE_ID-->

		<div class="break-row"></div>

		<!--SITE_ID-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label>Site</label>
				<select class="form-control" name="SITE_ID"
					ng-model="InvoiceMap.SITE_ID"
					ng-options="item.id as item.Site_name for item in options.redimedsites">
				</select>
			</span>	
		</div>
		<!--SITE_ID-->

		<!--DEPT_ID-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label>Department</label>

				<select disabled class="form-control" name="DEPT_ID" id="DEPT_ID"
					ng-model="InvoiceMap.DEPT_ID"
					ng-options="item.CLINICAL_DEPT_ID as item.CLINICAL_DEPT_NAME for item in options.departments">
				</select>
			</span>	
		</div>
		<!--DEPT_ID-->

		<!--DOCTOR_ID-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label>Doctor</label>
				<div>
					<input type="text" disabled placeholder="Doctor"  ng-model="InvoiceMap.doctor.NAME" class="form-control">
				</div>
				<div style="position: absolute;right: 0;bottom: 0px;">
					<button style="height: 32px;width: 40px;margin-right: 0px;" class="btn btn-block" ng-click="doctorSearch.open()">
						<i class="fa fa-search"></i>
					</button>
				</div>
			</span>	
		</div>
		<!--DOCTOR_ID-->

		<div class="break-row"></div>

		<!--STATUS-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<span class="field extend-field">
				<label for="STATUS">Status</label>
				<select class="form-control" name="STATUS" id="STATUS"
					ng-model="InvoiceMap.STATUS"
					ng-options="item.code as item.label for item in options.invoice_status">
				</select>
			</span>	
		</div>
		<!--STATUS-->

		<!--claim_id-->
		<div class="col-md-3 col-sm-6 col-xs-12">
			<!-- <button class="btn btn-block green" ng-click="patientClaim.open()">
				<span ng-if="!InvoiceMap.claim_id">
					<i class="fa fa-search"></i> Choose Claim
				</span>
			</button> -->
			<span class="field extend-field">
				<label>Claim</label>
				<input ng-if="!InvoiceMap.claim_id" disabled type="text" value="No Claim" class="form-control" placeholder=".input-large">
				
				<input ng-if="InvoiceMap.claim_id" disabled type="text" ng-model="InvoiceMap.claim.Injury_name" class="form-control">

				<div style="position: absolute;bottom: 0;right: 0;" dropdown="">
					<button style="margin-right: 0px;height: 32px;" type="button" class="btn dropdown-toggle"  ng-disabled="disabled" ng-disabled="disabled" aria-haspopup="true" aria-expanded="false">Claim <i class="fa fa-angle-down"></i></button>
					<ul class="dropdown-menu" role="menu">
						<li><a ng-click="patientClaim.open()"><i class="fa fa-search"></i> Choose Claim </a></li>
						<li><a><i class="fa fa-times"></i> Remove Claim</a></li>
					</ul>
				</div>
			</span>
		</div>
		<!--claim_id-->
		
		<div class="col-md-12">
			<button ng-click="clickAction()" class="btn un-submit"><i class="fa fa-save"></i> Save </button>
		</div>

		</form>
	</div>
	</div>
</div>

<!-- INVOICE ITEMS -->
<div class="portlet box mporlet-black" ng-if="isHeaderOk()">
	<div class="portlet-title mporlet-titleblack">
	    <div class="caption">
	       Invoice Items
	    </div>
	    <div class="pull-right navbar-right">
            <button ng-click="itemSearch.open()" class="un_tn_btn un_tn_btn_pink">Choose Item </button>
        </div>
	</div>
	<div class="portlet-body">
		<table class="mdt-table">
			<tr>
				<th> Item No</th>
				<th> Item Name</th>
				<th> Time Spent </th>
				<th> Quantity </th>
				<th> Price </th>
				<th> Amount </th>
				<th> Tax Code </th>
				<th> Tax Rate </th>
				<th> Tax Amount </th>
				<th>Actions</th>
			</tr>
			<tr ng-repeat="item in InvoiceMap.lines">
				<td>{{item.ITEM_CODE}}</td>
				<td>{{item.ITEM_NAME}}</td>
				<td><input type="number" min="0" class="form-control" ng-model="item.TIME_SPENT" /></td>
				<td><input type="number" min="0" class="form-control" ng-model="item.QUANTITY" /></td>
				<td class="text-right" ng-if="item.has_price">${{item.PRICE}}</td>
				<td class="text-right" ng-if="!item.has_price">
					<input type="number" min="0" class="form-control" ng-model="item.PRICE" />
				</td>
				<td class="text-right">${{item.PRICE * item.QUANTITY}}</td>
				<td class="text-right">{{item.TAX_CODE}}</td>
				<td class="text-right">{{item.TAX_RATE}}</td>
				<td class="text-right">{{item.TAX_RATE?item.PRICE * item.QUANTITY * item.TAX_RATE:null}}</td>
				<!-- <td class="text-right"> -->
				<td>
					<div style="display:inline">
						<button style="float:left" class="un_tn_btn un_tn_btn_gray un_tn_btn_sm  un_tn_btn_zip" ng-click="removeInvoiceLine(item)">
							Remove
						</button>
					</div>
				</td>
			</tr>
			<tr>
				<td colspan="5"><strong> Total </strong></td>
				<td class="text-right">${{amountBill()}}</td>
			</tr>
		</table>

	</div>
</div>
<!-- END INVOICE ITEMS -->


<!-- POPUP PATIENT CLAIM -->
<script type="text/ng-template" id="popupSelectClaim">
	<style type="text/css">
          .modal.in .modal-dialog {
           margin-top:50px;
          }
    </style>
	<div class="modal-body">	
		<label class="un-label-popup-header-m un-bg-label-B41E46-m">Claim</label>
    	<my-data-table options="options" rowclick="rowClick"></my-data-table>
	</div>
</script>
 <!-- END POPUP PATIENT CLAIM  -->

<!-- POPUP DOCTOR SEARCH -->
<script type="text/ng-template" id="popupDoctorSearch">
	<style type="text/css">
          .modal.in .modal-dialog {
           margin-top:50px;
          }
    </style>
	<div class="modal-body">	
    	<mdtdoctor-search click-row="rowClick(row)"></mdtdoctor-search>
	</div>
</script>
 <!-- END POPUP DOCTOR SEARCH  -->


<!-- POPUP SEARCH-ITEM  -->
<script type="text/ng-template" id="popupChooseItem">
	<style type="text/css">
          .modal.in .modal-dialog {
           margin-top:50px;
          }
    </style>
	<div class="modal-body">	
		<label class="un-label-popup-header-m un-bg-label-B41E46-m">Choose Item</label>
    	<my-data-table options="itemSearchOption" rowclass="itemSearch.class" rowclick="rowClick"></my-data-table>
	</div>
</script>
 <!-- POPUP SEARCH-ITEM  -->
