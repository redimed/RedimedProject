<style type="text/css" class="ng-scope">
    .modal.in .modal-dialog {
        margin-top:50px;
    }
    .has-error .form-control {
        -webkit-box-shadow: none;
        box-shadow: none;
        border: 1px solid red;
    }
    .has-error .form-control:focus {
        -webkit-box-shadow: none;
        box-shadow: none;
        border: 1px solid red;
    }
</style>
<div class="modal-body">
    <div class="active">
        <a href="index.html#tab_1" data-toggle="tab">
            <label class="un-label-popup-header-m un-bg-label-B41E46-m">Injury Map</label>
        </a>
    </div>

    <div id="tab_1">
       <map style="height: 100%; width: 100%" center="current-location" zoom="7">
            <custom-control  id="refresh" position="TOP_RIGHT" index="1" on-click="refreshMap()">
                <div style="width: 75px;background-color: white;border-style: solid;border-width: 2px;cursor: pointer;text-align: center; margin-top: 5px">
                    Refresh Map
                </div>
            </custom-control>
            
            <div ng-repeat="d in driverMarker">
                <div ng-repeat="p in d.patientList">
                    <directions 
                        panel="directions-panel"
                        travel-mode="DRIVING"
                        origin="{{d.position}}"
                        destination="{{p.position}}">
                    </directions>
                </div>
            </div>
            
            
            <marker data-position="{{im.position}}" icon="{{im.icon}}" ng-repeat="im in injuryMarker" data-on-click="showInfoWindow(event, 'info')">
                <info-window max-width="500" id="info">
                    <div class="portlet grey-cascade box">
                        <div class="portlet-title">
                            <div class="caption ">
                                <span class="caption-subject uppercase">{{im.FullName}}</span>
                            </div>
                            <div class="actions">
                                <a  ng-click="showDetails(im.id)"  href="javascript:;" class="btn green btn-sm">
                                    <i class="fa fa-pencil"></i>&nbsp;&nbsp;
                                    Details </a>
                            </div>

                        </div>
                        <div class="portlet-body">
                        <div ng-non-bindable="">
                        <div class="row">
                            <div class="col-md-3"> <label class="bold">Pickup At</label></div>
                            <div class="col-md-9">
                                <label>{{im.pickupAddr}}</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3"> <label class="bold">Gender</label></div>
                            <div class="col-md-9">
                                <label>{{im.gender}}</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3"> <label class="bold">Injury Desc</label></div>
                            <div class="col-md-9">
                                <label>{{im.injuryDesc}}</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3"> <label class="bold">Status</label></div>
                            <div class="col-md-9">
                                <span ng-show="im.status == 'New'" class="label label-md label-success">New </span>
                                <span ng-show="im.status == 'Picking'" class="label label-md label-info">Waiting For Driver</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3"> <label class="bold">Driver</label></div>
                            <div class="col-md-9">
                                <label ng-show="im.status == 'Picking' || im.status == 'Picked'">{{im.driverUser}}</label>
                                <select ng-model="selectedDriver.driverId" ng-show="im.status == 'New'" ng-options="a.driverId as a.username for a in driverMarker | unique:'driverId'">
                                    <option value="">--Select Driver--</option>
                                </select>

                            </div>
                        </div>
                            <br/>
                        <div class="clearfix">
                            <a  ng-class="{disabled:selectedDriver.driverId == null}" ng-show="im.status == 'New'"  ng-click="allocateDriver(im)"  href="javascript:;" class="btn blue btn-block">
                                Send Notification </a>
                            </div>
                        </div>
                            </div>
                    </div>
                </info-window>
            </marker>
            <marker  data-position="{{d.position}}" icon="{{d.icon}}" ng-repeat="d in driverMarker" data-on-click="showInfoWindow(event, 'infoDriver')">
                <info-window max-width="500" id="infoDriver">
                    <div class="portlet red-flamingo box">
                        <div class="portlet-title">
                            <div class="caption ">
                                <span class="caption-subject uppercase">{{d.username}}</span>
                            </div>
                        </div>
                        <div class="portlet-body">
                    <div ng-non-bindable="">
                        <div class="row" >
                            <div class="col-md-5"> <label class="bold">Picking: </label></div>
                            <div class="col-md-7" >
                                <label>{{d.patientList.length}} Patient(s)</label>
                            </div>
                        </div>
                        <div class="row" ng-repeat="p in d.patientList">
                            <div class="col-md-2">{{$index + 1}}.</div>
                            <div class="col-md-10" >
                                <label>{{p.FullName}}</label>
                            </div>
                        </div>

                    </div>
                            </div>
                        </div>
                </info-window>
            </marker>
        </map>
    </div>

</div>
