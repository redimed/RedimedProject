<style>
</style>
<div class="page-bar">
    <ul class="page-breadcrumb">
        <li>
            <img src="/img/TimeSheet/time-sheet-icon.jpg" style="margin-top:-7px;">
            <a ui-sref="loggedIn.TimeSheetHome">e-Timesheets</a>
            <i class="fa fa-angle-right"></i>
        </li>
        <li>
            <a ui-sref="loggedIn.TimeSheetGroupUser">
                <span ng-hide='isEdit'>Create New Timesheet</span>
                <span ng-hide='!isEdit'>Edit Timesheet</span>
            </a>
            <i class="fa fa-angle-right"></i>
        </li>
    </ul>
</div>
<div class="portlet box blue-hoki">
    <div class="portlet-title">
        <div class="caption" style="font-size:14px;">
            <i class="fa fa-cogs"></i>
            <span ng-hide='isEdit'>Create New Timesheet</span>
            <span ng-hide='!isEdit'>Edit Timesheet</span>
        </div>
        <a class="btn pull-right btn-info btn-xs btn-circle" ng-click="checkTimeInLieu()" style="margin-top:10px;">Check Time in Lieu</a>
        <a class="btn pull-right btn-xs">
            <label for="weekFrom" style="color:white;margin-top:9px;">Week From</label>
            <input id="weekFrom" ng-hide='isEdit' class="week-picker" ng-model="dateWeekFrom" ng-change="changeDate()" style="color:black; font-weight:bold; font-size:13px;" />
            <input ng-disabled='isEdit' ng-show='isEdit' type="text" name="dob" ng-model="dateStart" datepicker-popup="dd-MM-yyyy" is-open="openDOB" ng-click="openDOB = true" datepicker-options="dateOptions3" close-text="Close" style="font-size:13px;color:black; font-weight:bold;font-family: 'inherit';" />
        </a>
    </div>
    <div class="portlet-body">
        <div class="table-dynamic">
            <center ng-show="tasks.loading"><i class="fa fa-spinner fa-spin fa-3x"></i>
            </center>
            <table class="responsive table table-bordered" ng-show="!tasks.loading">
                <thead ng-show="tasks!==null">
                    <tr>
                        <th>
                            <div class="th">
                            </div>
                        </th>
                        <th>
                            <div class="th">
                            </div>
                        </th>
                        <th>
                            <div class="th">
                                </span> Date
                            </div>
                        </th>
                        <th>
                            <div class="th">
                                </span> Activity
                            </div>
                        </th>
                        <th>
                            <div class="th">
                                </span> Location
                            </div>
                        </th>
                        <th>
                            <div class="th">
                                </span> Department
                            </div>
                        </th>
                        <th>
                            <div class="th">
                                </span> Input Item
                            </div>
                        </th>
                        <th>
                            <div class="th" style="width:100px;">
                                </span> Time Charge
                            </div>
                        </th>
                        <th>
                            <div class="th">
                                </span> Task/Comment
                            </div>
                        </th>
                        <th>
                            <div class="th">
                                </span> Item Codes
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-hide="task.isAction == 'delete'" ng-repeat="(key,task) in tasks track by $index">
                        <td style="vertical-align: middle">
                            <i ng-if="task.isParent === 1" class="fa fa-plus pointer" ng-click="addRow($index,task.date,task.tasks_week_id)" style="font-size: 15px;"></i>
                        </td>
                        <td style="vertical-align: middle">
                            <i ng-hide="task.isParent===1" ng-click="delTask($index,task.order)" class="fa fa-trash pointer" style="font-size: 15px;"></i>
                        </td>
                        <td style="vertical-align: middle">{{task.date | date : 'EEE, dd MMM'}}</td>
                        <td style="width: 16%">
                            <select style="font-size: 12px" ng-model="task.activity_id" class="form-control input-sm" ng-options="activity.activity_id as activity.NAME group by activity.type_name for activity in activities" ng-change="ChangeActivity(key)">
                                <option value="">--Select Activity--</option>
                            </select>
                        </td>
                        <td style="width: 12%">
                            <select style="font-size: 12px" ng-disabled='task.activity_id === 18 || task.activity_id === 15 || task.activity_id === 16 || 
                            task.activity_id === 17 || task.activity_id === 19' ng-model="task.location_id" class="form-control input-sm" ng-options="location.location_id as location.NAME for location in locations">
                                <option value="">--Select Location--</option>
                            </select>
                        </td>
                        <td style="width: 16%">
                            <select style="font-size: 12px" ng-disabled='task.activity_id === 18 || task.activity_id === 15 || task.activity_id === 16 || 
                            task.activity_id === 17 || task.activity_id === 19' ng-model="task.department_code_id" class="form-control input-sm" ng-options="department.departmentid as department.departmentName for department in departments">
                                <option value="">-Select Department Code--</option>
                            </select>
                        </td>
                        <td>
                            <input ng-disabled="task.activity_id != 1 || task.activity_id === 18" style="margin-left: 28px; margin-top:5px;" type="checkbox" class="checkbox center" ng-model="task.isInputItem" ng-true-value="1" ng-false-value="0" ng-checked="task.isInputItem==1" />
                        </td>
                        <td style="width: 2%" style="text-align: center">
                            <input type="text" ui-mask="99:99" name="time_charge" ng-model="task.time_charge" ng-change="changeTimeCharge()" style="font-style: 'normal';text-align: center;width: 100%" ng-disabled="task.activity_id === 18||task.isInputItem==1|| task.activity_id===null ||task.activity_id===undefined || task.activity_id===''" class="form-control input-sm">
                        </td>
                        <td style="width: 20%">
                            <input type="text" ng-disabled="task.isInputItem==1 || task.activity_id === 18 || task.activity_id === 15 || task.activity_id === 16 || 
                            task.activity_id === 17 || task.activity_id === 19" class="form-control input-sm" ng-model="task.task" />
                        </td>
                        <td style="text-align:center;">
                            <span ng-disabled="task.isInputItem==0 || task.activity_id === 18 || task.activity_id === 15 || task.activity_id === 16 || 
                            task.activity_id === 17 || task.activity_id === 19 || task.isInputItem!=1" ng-click="chooseItem(task)" class="btn btn-xs blue-dark" style="margin-left:5px;"><i class="fa fa-search"></i>&nbsp; Choose Item</span>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="7" style="vertical-align: middle">
                            <label class="bold pull-right" style="margin-top:5px;">Total Hour: </label>
                        </td>
                        <td>
                            <input disabled class="form-control input-sm" ui-mask="99:99" ng-model="info.time_charge" style="text-align:center;" />
                        </td>
                        <td colspan="2">
                        </td>
                    </tr>
                </tbody>
            </table>
            <footer class="table-footer">
                <!-- BUTTON -->
                <!-- BUTTON WHEN ADDNEW -->
                <!-- BUTTON WHEN EDIT -->
                <a class="btn btn-xs yellow pull-right" ng-show='!isEdit' ui-sref="loggedIn.TimeSheetHome" style="width:70px;">Cancel</a>
                <!-- END EDIT-->
                <a class="btn btn-xs yellow pull-right" ng-show='isEdit' ui-sref="loggedIn.timesheet.view" style="width:70px;">Cancel</a>
                <a class="btn btn-xs green pull-right" ng-show="(!isEdit || checkStatus===1) && afterStatusID!==4" ng-click="addAllTask(2)" style="width:70px;">Submit</a>
                <a class="btn btn-xs purple pull-right" ng-show="(isEdit && (checkStatus!==1 || (afterStatusID ===4 && checkStatus==1)))" ng-click="addAllTask(5)" style="width:70px;">Re-submit</a>
                <a class="btn btn-xs blue pull-right" ng-click="addAllTask(1)" style="width:70px;">Save</a>
                <!-- END ADDNEW-->
                <!-- END -->
            </footer>
        </div>
    </div>
</div>
<script type="text/ng-template" id="ViewTask">
    <view-task ng-model="idDept" on-cancel="clickCancel(return)" on-save="clickSave(return)"></view-task>
</script>
<script type="text/ng-template" id="ItemCode">
    <item-code ng-model="items" on-cancel="clickCancel(return)" on-save="clickSave(return,formValid)"></item-code>
</script>
